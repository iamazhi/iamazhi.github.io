(window.webpackJsonp=window.webpackJsonp||[]).push([["dx_r2i"],{dx_A2Ao:function(e,n,r){"use strict";var o,i=r("dx_lSNA"),c=r.n(i),a=r("dx_o0o1"),l=r.n(a),s=r("dx_J4zp"),u=r.n(s),d=r("dx_yXPU"),f=r.n(d),h=r("dx_lwsE"),p=r.n(h),v=r("dx_UtDZ"),g=r("dx_eSV8"),b=r("dx_s1qv"),y=r("dx_qx8A"),m=r.n(y),_=r("dx_oWrv");!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.CANCEL=1]="CANCEL",e[e.NOT_PERMISSION=2]="NOT_PERMISSION",e[e.FAILED=3]="FAILED",e[e.NOT_ALLOW=4]="NOT_ALLOW",e[e.SAME_USER=5]="SAME_USER",e[e.NOT_NEED_NOTIFICATION=6]="NOT_NEED_NOTIFICATION"}(o||(o={}));var k,O=r("dx_AAGW"),x=r("dx_UmoL");function E(e,n){var r=n.userId,o=n.fileToken;return function(e){return O.S.post("/mention/notify/",e,{headers:{"Content-Type":"application/json","Cache-Control":"no-cache,no-store"},baseURL:Object(x.q)()})}({to_user:[r],source:n.fileType,target:k.LARK,note_token:o,from_user:e})}!function(e){e[e.LARK=0]="LARK"}(k||(k={}));var S=r("dx_HhFT");r("dx_r7r3");function C(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function I(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?C(Object(r),!0).forEach((function(n){c()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var B=new function e(){var n=this;p()(this,e),this.token=void 0,this.fileType=void 0,this.undoneSharePromise=void 0,this.init=function(){n.token=Object(v.getToken)(),n.fileType=Object(v.selectCurrentSuiteType)(m.a.getState())},this.destroy=function(){n.undoneSharePromise=void 0},this.addMentionNotify=function(){var e=f()(l.a.mark((function e(r,i,c,a,s){var d,f,h,p,y,m,k,O,x,E,C,I,B,T,w;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=r.id,f=r.name,h=r.isCrossTenant,p=n.token,y=v.userHelper.getCurrentUser().get("id"),d!==y){e.next=5;break}return e.abrupt("return",{code:o.SAME_USER});case 5:return v.suiteUserManager.addUser(d),e.next=8,Promise.all([Object(v.checkUserNotNotify)(d),v.suiteUserManager.registerUserPermission(d,8e3)]);case 8:if(m=e.sent,k=u()(m,1),!k[0]){e.next=14;break}return Object(S.m)(f),e.abrupt("return",{code:o.NOT_ALLOW});case 14:if(O=i.model.zoneState.getContent().ops.find((function(e){var n;if(null===(n=e.attributes)||void 0===n?void 0:n[b.INLINE_COMPONENT_MARK]){var r=JSON.parse(e.attributes[b.INLINE_COMPONENT_MARK]).id;if(c===r)return!0}return!1}))){e.next=17;break}return e.abrupt("return",{code:o.CANCEL});case 17:if(n.checkUserHasReadPermission(d)){e.next=36;break}if(n.checkUserHasSharePermission()){e.next=22;break}return e.abrupt("return",{code:o.NOT_PERMISSION});case 22:if(x=i.editor,(E=i.model.zoneState.getEntities([[b.INLINE_COMPONENT_MARK,O.attributes[b.INLINE_COMPONENT_MARK]]])).length){e.next=26;break}return e.abrupt("return",{code:o.CANCEL});case 26:return C=x.rectModule.getRangeRect(E[0],i.model.zoneId),I=x.getRect(i.model.zoneId),e.next=30,Object(S.I)({left:C.left+I.left,top:C.top+I.top,bottom:I.bottom-C.bottom,width:C.width,right:C.right,height:C.height},d,f);case 30:if(e.sent){e.next=35;break}return e.abrupt("return",{code:o.CANCEL});case 35:s&&a||(n.undoneSharePromise=n.shareToOther(d));case 36:if(a){e.next=38;break}return e.abrupt("return",{code:o.NOT_NEED_NOTIFICATION});case 38:return B=n.shouldShowExternalConfirm(h)?Object(S.f)(f):s?Object(S.A)(d,f):Object(S.G)(f),e.next=41,Promise.race([B,Object(g.E)(_.Y)]);case 41:if(!e.sent){e.next=44;break}return e.abrupt("return",{code:o.CANCEL});case 44:if(e.prev=44,p===n.token){e.next=47;break}return e.abrupt("return",{code:o.FAILED});case 47:if(!s){e.next=53;break}return e.next=50,n.sendTodoNotify(d);case 50:e.t0=e.sent,e.next=56;break;case 53:return e.next=55,n.sendNotify(d);case 55:e.t0=e.sent;case 56:return T=e.t0,(null===(w=T.data)||void 0===w?void 0:w.mention_id)&&n.addMentionId(i,c,w.mention_id),e.abrupt("return",{code:o.SUCCESS});case 62:return e.prev=62,e.t1=e.catch(44),console.error(e.t1),e.abrupt("return",{code:o.FAILED});case 66:case"end":return e.stop()}}),e,null,[[44,62]])})));return function(n,r,o,i,c){return e.apply(this,arguments)}}(),this.addTaskMemberMentionNotify=function(){var e=f()(l.a.mark((function e(r,i){var c,a,s,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=r.id,a=r.name,s=v.userHelper.getCurrentUser().get("id"),c!==s){e.next=4;break}return e.abrupt("return",{code:o.SAME_USER});case 4:if(!n.checkUserNotAllowNotify()){e.next=8;break}return Object(S.m)(a),e.abrupt("return",{code:o.NOT_ALLOW});case 8:return v.suiteUserManager.addUser(c),e.next=11,v.suiteUserManager.registerUserPermission(c,8e3);case 11:if(u=i(c)){e.next=14;break}return e.abrupt("return",{code:o.CANCEL});case 14:if(!n.checkUserHasReadPermission(c)){e.next=17;break}return e.abrupt("return",{code:o.CANCEL});case 17:if(n.checkUserHasSharePermission()){e.next=20;break}return e.abrupt("return",{code:o.NOT_PERMISSION});case 20:return e.next=22,Object(S.I)(u,c,a);case 22:if(e.sent){e.next=25;break}return e.abrupt("return",{code:o.CANCEL});case 25:return n.undoneSharePromise=n.shareToOther(c),e.prev=26,e.next=29,n.undoneSharePromise;case 29:return e.abrupt("return",{code:o.SUCCESS});case 32:return e.prev=32,e.t0=e.catch(26),console.error(e.t0),e.abrupt("return",{code:o.FAILED});case 36:case"end":return e.stop()}}),e,null,[[26,32]])})));return function(n,r){return e.apply(this,arguments)}}(),this.addMentionId=function(e,n,r){var i=e.model.zoneState,c={start:{line:0,offset:0},end:{line:i.length(),offset:i.getLine(i.length()-1).length()}},a=i.getEntities(c,(function(e,r){if(e===b.INLINE_COMPONENT_MARK){var o=JSON.parse(r).id;return n===o}return!1}));if(!a.length)return{code:o.FAILED};var l=JSON.parse(a[0].attributes[b.INLINE_COMPONENT_MARK]);l.data.mention_id=r;var s=a[0],u=s.start,d=s.end,f=s.attributes;e.model.setAttributes({start:u,end:d},I(I({},f),{},{"inline-component":JSON.stringify(l)}))},this.sendTodoNotify=function(){var e=f()(l.a.mark((function e(r){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.shareEditToOther(r);case 2:return e.abrupt("return",n.sendNotify(r,!0));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),this.checkUserHasReadPermission=function(e){if(!v.selectDocUserPermission)return!1;var n=Object(v.selectDocUserPermission)(m.a.getState(),e);return n&&n[v.UserPermissionType.Readable]},this.checkUserHasSharePermission=function(){return!!v.selectCanInviteCollaborator&&Object(v.selectCanInviteCollaborator)(m.a.getState())},this.shouldShowExternalConfirm=function(e){var n=Object(v.getIsUserOwner)(),r=Object(v.getCurrentPermission)().externalAccess;return e&&!r&&n},this.sendNotify=function(){var e=f()(l.a.mark((function e(r,o){var i,c,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.fileType,c=n.token,a=n.undoneSharePromise,s=v.userHelper.getCurrentUser().get("id"),o||!a){e.next=5;break}return e.next=5,a;case 5:return e.abrupt("return",E(s,{fileType:i,fileToken:c,userId:r,source:"doc"}));case 6:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),this.shareToOther=function(){var e=f()(l.a.mark((function e(r){var o,i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.undoneSharePromise){e.next=3;break}return e.next=3,n.undoneSharePromise;case 3:return o=n.fileType,i=n.token,c=Object(v.getIsWikiV2SuitePage)()?Object(v.getCanInviteViewMemberPermType)():void 0,e.prev=5,e.next=8,Object(v.grantPermission)("READABLE",{fileType:o,fileToken:i,userId:r,noToast:!0,source:"docx",permType:c});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),console.error(e.t0);case 13:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(n){return e.apply(this,arguments)}}(),this.shareEditToOther=function(){var e=f()(l.a.mark((function e(r){var o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.fileType,i=n.token,e.prev=1,e.next=4,Object(v.grantPermission)("EDITABLE",{fileType:o,fileToken:i,userId:r,noToast:!0,source:"docx"});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(n){return e.apply(this,arguments)}}(),this.checkUserNotAllowNotify=function(){return!1}};n.S=B},dx_A3AG:function(e,n,r){"use strict";r.d(n,"Y",(function(){return i})),r.d(n,"Y5",(function(){return c})),r.d(n,"l",(function(){return a}));var o=r("dx_Uh2b");function i(e){return{type:o.R.ToggleCommentPanelShown,payload:e}}function c(e){return{type:o.R.ToggleShowCommentNumbers,payload:e}}function a(e){return{type:o.R.ToggleHelpPanelShown,payload:e}}},dx_A5O8:function(e,n,r){"use strict";var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_FBWK"),s=r("dx_UtDZ"),u=r("dx_yzqx"),d=r("dx_qx8A"),f=r.n(d),h=function(){function e(){var n=this;i()(this,e),this.showOpendocMask=function(e){n.isOpendoc&&Object(s.showOuterMask)(s.OPENDOC_API.closeImageViewer,Object(l.getAlphaColor)(Object(l.getThemeColorByToken)("N1000-FG"),.85),(function(){return e&&e.hide()}))},this.isOuterViewer=function(){return n.opendocImageConfig&&"outer"===n.opendocImageConfig.viewer},this.isNeedBlob=function(){return n.opendocImageConfig&&n.opendocImageConfig.needBlob},this.checkShouldRegisComment=function(){var e=!0;if(n.isOpendoc){var r=n.opendocCommentConfig;e=!(!r||!r.partial.enable)}return e},this.previewInOpendoc=function(e){Object(s.sendOpendocEvent)(s.OPENDOC_EVENT.IMAGE_VIEW,e)},this.hideOpendocMask=function(){n.isOpendoc&&Object(s.hideOuterMask)(s.OPENDOC_API.closeImageViewer)}}return a()(e,[{key:"isOpendoc",get:function(){return u.S.isOpendoc}},{key:"opendocImageConfig",get:function(){return(0,s.selectors.openDoc.getFeatureConfigSelector)(s.FEATURE.IMAGE)(f.a.getState())}},{key:"opendocContentConfig",get:function(){return(0,s.selectors.openDoc.getFeatureConfigSelector)(s.FEATURE.CONTENT)(f.a.getState())}},{key:"opendocCommentConfig",get:function(){return(0,s.selectors.openDoc.getFeatureConfigSelector)(s.FEATURE.COMMENT)(f.a.getState())}}]),e}();n.S=new h},dx_A7Ap:function(e,n,r){"use strict";r.d(n,"T",(function(){return _})),r.d(n,"i",(function(){return k})),r.d(n,"Q",(function(){return x})),r.d(n,"z",(function(){return C})),r.d(n,"M",(function(){return w}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_RIqP"),d=r.n(u),f=r("dx_QxNg"),h=r("dx_h6a8"),p=r("dx_r3ra"),v=r("dx_MoY1"),g=r("dx_FXIk"),b=r("dx_xWRc"),y=r("dx_B28d"),m=r("dx_F81q");function _(e,n){try{for(var r=e.getBlockModelByBlockIdNotCheck(n);null!=r&&r.parent;){if(r.type===y.B.QUOTE_CONTAINER)return r;r=r.parent}}catch(o){console.error("block model not found")}return null}function k(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.blockManager,o=e.condition,i=e.blockId,c=Array.isArray(i)?i:[i],a=[];return n?c.forEach((function(e){r.traverse(e,(function(e){var n=o(r.getBlockModelByBlockId(e));return!n&&a.push(e),n}))})):c.forEach((function(e){!o(r.getBlockModelByBlockId(e))&&a.push(e)})),a}function O(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=[],i=[];return n.forEach((function(n){n.type===y.B.QUOTE&&o.push(n),i.push.apply(i,d()(k({blockManager:e,blockId:n.id,condition:function(e){return y.N2.includes(e.type)}},r)))})),{oldQuoteBlock:o,notSupportBlockIds:i}}function x(e){return E.apply(this,arguments)}function E(){return(E=s()(i.a.mark((function e(n){var r,o,c,l,s,u,d,h,p,m,k,x,E,S,C,I,T,w,R,M,j,D;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.blockManager,o=n.block,c=n.beforeMove,l=n.isMultipleSelection,s=void 0!==l&&l,(u=(u=Array.isArray(o)?o:[o]).filter((function(e){return y.N2.includes(e.type)}))).length){e.next=6;break}return console.log("can not meet the conditions of entering QuoteContainer"),e.abrupt("return",[]);case 6:if((d=u[0].model).parent){e.next=9;break}return e.abrupt("return",[]);case 9:if(h=d.parent,p=d.position,!_(r,h.id)){e.next=12;break}return e.abrupt("return",[]);case 12:return m=r.createInitModel(y.B.QUOTE_CONTAINER),k=O(r,u,!s),x=k.oldQuoteBlock,E=k.notSupportBlockIds,S=E.map((function(e){return r.getRecordByBlockId(e).id})),C=Object(b.r)(u,s,!0),I=C.blockList,T=C.noInSelBlockList,w=I.map((function(e){return e.id})),R=Object(g.e)({parentBlockId:h.id,blockManager:r,blockSnapshot:m,position:p,transactionName:s?"enterQuoteContainerWithMultipleSelection":"enterQuoteContainer",childBlockIds:w,beforeInsert:function(e){c&&c(e),Object(v.y)(e,w,r),x.length&&x.forEach((function(n){return e.replace(n.record.id,["type"],y.B.TEXT)})),E.length&&(Object(v.y)(e,E,r),Object(v.t)(e,h.recordId,p,S)),Object(v.y)(e,T.map((function(e){return e.model}))),Object(v.t)(e,h.recordId,p+E.length,T.map((function(e){return e.model.recordId})))},mergeMode:f.f.SPLIT}),M=a()(R,2),j=M[0],D=M[1],e.next=20,D;case 20:return j&&B({blockId:j,blockManager:r}),e.abrupt("return",w);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){var n=e.transactionName,r=e.blockManager,o=e.parentBlockId,i=e.position,c=e.childBlockIds;r.applyTransaction(n,(function(e){var n=r.getRecordByBlockId(o);if(n){var a=n.id,l=c.map((function(e){var n=r.getRecordByBlockId(e);return n?n.id:(console.info("[Turninto] buildRelationship child record no exist"),null)})).filter(Boolean);Object(v.y)(e,c,r),Object(v.t)(e,a,i,l)}else console.info("[Turninto] buildRelationship parentRecord no exist")}))}function C(e){return I.apply(this,arguments)}function I(){return(I=s()(i.a.mark((function e(n){var r,o,c,a,l,s,u,d,f,g,m,k,O,x,E,C;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.blockManager,o=n.block,c=n.isMultipleSelection,a=void 0!==c&&c,l=Array.isArray(o)?o:[o],s=l.map((function(e){return e.id})),u=_(r,l[0].id),d=u.parent.id,f=[],l[0].type!==y.B.QUOTE_CONTAINER){e.next=12;break}return g=Object(p.t)(),m=function(){var e,n=0,o=0,i=r.applyTransaction("exitQuoteContainer",(function(i){var c=Object(h.flatten)(s.map((function(e){return r.getBlockModelByBlockId(e).children})));f=c.map((function(e){return e.id}));var a=c.map((function(e){return e.recordId}));Object(v.y)(i,f,r),e=u.parent,n=u.position,o=a.length,Object(v.t)(i,e.recordId,n,a)}));i.then((function(){g.resolve(e.children.slice(n,n+o).map((function(e){return e.id})))}),g.resolve)},e.next=11,B({blockId:l[0].id,blockManager:r,isDisappear:!1,onAnimationEnd:m});case 11:return e.abrupt("return",g.promise);case 12:return k=Object(b.r)(l,a,!0),O=k.blockList,x=k.noInSelBlockList,f=O.map((function(e){return e.id})),E=function(){S({transactionName:"retainQouteContainer",blockManager:r,parentBlockId:u.id,position:l[0].model.position,childBlockIds:x.map((function(e){return e.id}))}),S({transactionName:"moveOutQuoteContainer",blockManager:r,parentBlockId:d,position:u.position+1,childBlockIds:f})},(C=_(r,l[0].id))&&T(r,C.id,l),E(),e.abrupt("return",f);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){var n=e.blockId,r=e.blockManager,o=e.isDisappear,i=void 0===o||o,c=e.onAnimationEnd;return new Promise((function(e){var o=r.getBlockViewByBlockIdNotCheck(n),a=null===o||void 0===o?void 0:o.hostElement;if(a){var l=i?m.L:m.J;a.classList.add(l);a.addEventListener("animationend",(function n(){a&&(a.classList.remove(l),a.removeEventListener("animationend",n),c&&c(),e())}))}}))}function T(e,n,r){var o=e.getBlockModelByBlockId(n).children.map((function(e){return e.id})),i=!0;return o.forEach((function(e){r.find((function(n){return n.id===e}))||(i=!1)})),i}function w(e,n){var r;if(!e)return!1;var o=function(e,n){return!!_(n,e)}(e,n);if(!o)return!1;var i=n.getBlockModelByBlockId(e);return 1===(null===(r=i.parent)||void 0===r?void 0:r.children.length)&&i.previous===i.parent}},dx_A8lo:function(e,n,r){"use strict";r.d(n,"c",(function(){return T}));var o,i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_UtDZ"),u=r("dx_Wkzy"),d=r("dx_bWl7"),f=r("dx_B28d"),h=r("dx_OPAz"),p=r("dx_GLPm"),v=r("dx_IdzY"),g=r("dx_s1qv"),b=r("dx_bPy9");!function(e){e.Doc="doc",e.Sheet="sheet",e.Bitable="bitable",e.Mindnote="mindnote",e.Task="task"}(o||(o={}));var y=function(e,n){return e.getMentionInfo&&e.getMentionInfo(n)},m=function(e,n,r){var o=Array.from(r.allBlockModels).find((function(r){var o=r.record;return r.type===n&&o.snapshot.token.includes(e)}));return null===o||void 0===o?void 0:o.recordId},_=function(e,n){return Array.from(n.allBlockModels).find((function(n){return n.type===e}))},k={doc:function(e,n){var r=Array.from(n.allBlockModels).find((function(n){var r=n.record,o=n.type;return!(f.o.indexOf(o)<0)&&!!Object(b.w)(r.snapshot.text).get(v.x).ops.find((function(n){var r;if(null===(r=n.attributes)||void 0===r?void 0:r[g.INLINE_COMPONENT_MARK]){var o=Object(g.parseInlineComponentDataByNode)(n);if((null===o||void 0===o?void 0:o.type)===g.INLINE_COMPONENT_TYPE.USER&&o.data.mention_id===e)return!0}return!1}))})),i=null===r||void 0===r?void 0:r.recordId;if(i)return{recordId:i,type:o.Doc}},sheet:function(){var e=l()(c.a.mark((function e(n,r){var i,a,l,s,u,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((i=_("sheet",r))&&i.record.snapshot.token){e.next=4;break}return console.info("[message-mention/findMentionInfo/sheet] can't get sheetBlock"),e.abrupt("return");case 4:return a=Object(p.U)(i.record.snapshot.token),l=a.token,e.next=7,r.editorAPI.getService(h.H).getBridge(l);case 7:if(s=e.sent){e.next=11;break}return console.info("[message-mention/findMentionInfo/sheet] can't getBridge"),e.abrupt("return");case 11:return e.next=13,y(s,n);case 13:if(u=e.sent){e.next=17;break}return console.info("[message-mention/findMentionInfo/sheet] can't get mentionInfo"),e.abrupt("return");case 17:if(d=u&&m(u.sheetId,"sheet",r)){e.next=21;break}return console.info("[message-mention/findMentionInfo/sheet] can't get sheetBlockRecordId"),e.abrupt("return");case 21:return e.abrupt("return",{recordId:d,type:o.Sheet,sheetId:u.sheetId});case 22:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),bitable:function(){var e=l()(c.a.mark((function e(n,r,i){var a,l,s,f,h,p,v;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=_("bitable",r))&&a.record.snapshot.token){e.next=4;break}return console.info("[message-mention/findMentionInfo/bitable] can't get bitableBlock"),e.abrupt("return");case 4:if(l=Object(d.U)(a.record.snapshot.token),s=l.token,f=r.editorAPI.getService(u.x).getBridge(s)){e.next=9;break}return console.info("[message-mention/findMentionInfo/bitable] can't getBridge"),e.abrupt("return");case 9:if(h=i.tableId,p=f.getBlockToken(h),v=m(p,"bitable",r)){e.next=15;break}return console.info("[message-mention/findMentionInfo/bitable] can't getRecordId"),e.abrupt("return");case 15:return e.abrupt("return",{recordId:v,type:o.Bitable});case 16:case"end":return e.stop()}}),e)})));return function(n,r,o){return e.apply(this,arguments)}}(),mindnote:function(){var e=l()(c.a.mark((function e(n,r,i){var a,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i.mindnoteId,l=m(a,"mindnote",r)){e.next=5;break}return console.info("[message-mention/findMentionInfo/mindnote] can't getRecordId"),e.abrupt("return");case 5:return e.abrupt("return",{recordId:l,type:o.Mindnote});case 6:case"end":return e.stop()}}),e)})));return function(n,r,o){return e.apply(this,arguments)}}()},O=function(){var e=l()(c.a.mark((function e(n,r,i){var a,l,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.doc(n,i);case 2:if(!(a=e.sent)){e.next=5;break}return e.abrupt("return",a);case 5:return e.next=7,k.sheet(n,i);case 7:if(!(l=e.sent)){e.next=10;break}return e.abrupt("return",l);case 10:e.prev=10,s=JSON.parse(r.source_file_type||"{}"),e.next=18;break;case 14:return e.prev=14,e.t0=e.catch(10),console.error("[message-mention/findMentionInfoImpl] parse error:",e.t0),e.abrupt("return");case 18:console.info("[message-mention/findMentionInfoImpl] mentionId=".concat(n," type=").concat(s.type)),e.t1=s.type,e.next=e.t1===o.Bitable?22:e.t1===o.Mindnote?23:24;break;case 22:return e.abrupt("return",k.bitable(n,i,s));case 23:return e.abrupt("return",k.mindnote(n,i,s));case 24:return e.abrupt("return");case 25:case"end":return e.stop()}}),e,null,[[10,14]])})));return function(n,r,o){return e.apply(this,arguments)}}(),x=function(){var e=l()(c.a.mark((function e(n,r,o,i){var a,l,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O(n,r,o);case 2:return(a=e.sent)?(l=a.type,u=a.recordId,console.info("[message-mention/findMentionInfo/".concat(i,"] mentionId=").concat(n," type=").concat(l," recordId=").concat(Object(s.encryptTea)(u)))):console.info("[message-mention/findMentionInfo/".concat(i,"] fail: mentionId=").concat(n)),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(n,r,o,i){return e.apply(this,arguments)}}(),E=r("dx_U9rT"),S=function(e,n){var r=n.getBlockIdsByRecordId(e)[0];return n.layoutManager.getLayoutInfo(r).top},C=function(e){var n=$(e),r="docx-highlight-comment-mention";n.addClass(r).on("animationend",(function(){n.removeClass(r)}))},I=function(){var e=l()(c.a.mark((function e(n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=document.querySelector(".bear-web-x-container"),e.next=3,new Promise((function(e){$(r).animate({scrollTop:n},80,(function(){e()}))}));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),B=function(){var e=l()(c.a.mark((function e(n,r,i,a){var l,s,u,f,h,p,v,g,b,y,m,_,k,O,x,B,T,w;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=n.mentionId,s=n.type,u=n.recordId,f=n.mentionOffsetTop,h=n.extra,p=r.viewport,v=r.blockManager,console.info("[message-mention/scrollToMention/".concat(a,"] mentionId=").concat(l," type=").concat(s)),e.next=5,p.scrollToRecord(u);case 5:console.info("[message-mention/scrollToMention/".concat(a,"] mentionId=").concat(l," type=").concat(s," endToRecord")),g=S(u,v)-f,e.t0=s,e.next=e.t0===o.Doc?10:e.t0===o.Sheet?14:e.t0===o.Bitable?18:e.t0===o.Mindnote?45:60;break;case 10:return e.next=12,I(g);case 12:return C("a[data-mention-id='".concat(l,"']")),e.abrupt("return");case 14:return e.next=16,I(g);case 16:return C(".sheet-id-".concat(n.sheetId)),e.abrupt("return");case 18:if(b=v.getBlockIdsByRecordId(u)[0],p.isBlockInViewport(b)){e.next=23;break}return e.next=23,I(g);case 23:if(!(y=v.getRecord(u).snapshot.token)){e.next=42;break}return m=Object(d.U)(y).id,_=v.getBlockModelsByRecordId(u)[0],k=_.bridge,e.next=29,k.getIsBlockMount(m);case 29:return e.next=31,k.locateMention(m,l,h);case 31:if(O=e.sent){e.next=36;break}return console.info("[message-mention/scrollToMention/".concat(a,"] bitable can't get bitableMentionLocation")),i(),e.abrupt("return");case 36:if(!(x=O.top)){e.next=40;break}return e.next=40,I(g+x);case 40:e.next=44;break;case 42:console.info("[message-mention/scrollToMention/".concat(a,"] bitable can't get token")),i();case 44:return e.abrupt("return");case 45:return e.next=47,I(g);case 47:if(T=null===(B=v.editorAPI.getService(E.i).getDepLoader())||void 0===B?void 0:B.getBridge(),w=null===v||void 0===v?void 0:v.getBlockIdsByRecordId(u)[0],e.t1=!w||!T,e.t1){e.next=54;break}return e.next=53,T.hightlightMention(w,l);case 53:e.t1=!e.sent;case 54:if(!e.t1){e.next=58;break}i(),e.next=59;break;case 58:C('[data-record-id="'.concat(u,'"]'));case 59:case 60:return e.abrupt("return");case 61:case"end":return e.stop()}}),e)})));return function(n,r,o,i){return e.apply(this,arguments)}}(),T={find:x,scroll:B}},dx_ABby:function(e,n,r){"use strict";r.d(n,"z",(function(){return m})),r.d(n,"U",(function(){return _}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_N8Nu"),v=r("dx_TSYQ"),g=r.n(v),b=r("dx_IdzY");r("dx_LCTY");function y(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var m="".concat(b.I,"-todo-line-through"),_=function(e){s()(r,e);var n=y(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).name="TodoLineThrough",e}return a()(r,[{key:"match",value:function(e){return e===r.KEY}},{key:"render",value:function(e){var n=g()(e.class,"todo-line-through");return e.class=n,e.children}}]),r}(p.o);_.KEY=m},dx_ABiD:function(e,n,r){"use strict";r.d(n,"g",(function(){return o})),r.d(n,"ET",(function(){return l})),r.d(n,"C",(function(){return a})),r.d(n,"E",(function(){return s}));var o,i=r("dx_lwsE"),c=r.n(i);!function(e){e.REACT_COMPONENT_ERROR="react_component_error",e.DEV_OOPS="dev_oops",e.UNLOAD_BEFORE_LOADED="unload_before_loaded",e.FETCH_TREE_ERROR="fetch_tree_error",e.FETCH_INIT_INFO_ERROR="fetch_init_info_error",e.FETCH_CLIENTVAR_ERROR="fetch_clientvar_error",e.FETCH_CLIENTVAR_ERROR_PERM="fetch_clientvar_error_perm"}(o||(o={}));var a,l={DOCX_JS_LOADED:1,FETCH_DOCX_CLIENTVARS_START:2,RENDER_DOCX_FIRST_SCREEN_SUCCESS:10,FETCH_DOCX_CLIENTVARS_SUCCESS:3,RENDER_DOCX_ALLOW_EDIT:4,RENDER_DOCX_CLIENTVARS_ALL_DONE:11,RENDER_DOCX_HEADER_SUCCESS:5,FETCH_DOCX_CATALOGUE_SUCCESS:6,RENDER_DOCX_CATALOGUE_SUCCESS:7,FETCH_DOCX_COMMENT_SUCCESS:8,RENDER_DOCX_COMMENT_SUCCESS:9,WORKER_FETCH_DOCX_CLIENTVAR_FINISH:12,WORKER_FETCH_DOCX_CLIENTVAR_TO_MAIN_FINISH:13,RENDER_DOCX_FIRST_CLIENTVAR_SUCCESS:14,RENDER_DOCX_ALLOW_EDIT_WITH_SSR_CLEAN:15};!function(e){e[e.DOCX_JS_LOADED=0]="DOCX_JS_LOADED",e[e.FETCH_DOCX_CLIENTVARS_START=1]="FETCH_DOCX_CLIENTVARS_START",e[e.FETCH_DOCX_CLIENTVARS_SUCCESS=2]="FETCH_DOCX_CLIENTVARS_SUCCESS",e[e.RENDER_DOCX_ALLOW_EDIT=3]="RENDER_DOCX_ALLOW_EDIT",e[e.RENDER_DOCX_CLIENTVARS_ALL_DONE=4]="RENDER_DOCX_CLIENTVARS_ALL_DONE",e[e.RENDER_DOCX_HEADER_SUCCESS=5]="RENDER_DOCX_HEADER_SUCCESS",e[e.FETCH_DOCX_CATALOGUE_SUCCESS=6]="FETCH_DOCX_CATALOGUE_SUCCESS",e[e.RENDER_DOCX_CATALOGUE_SUCCESS=7]="RENDER_DOCX_CATALOGUE_SUCCESS",e[e.FETCH_DOCX_COMMENT_SUCCESS=8]="FETCH_DOCX_COMMENT_SUCCESS",e[e.RENDER_DOCX_COMMENT_SUCCESS=9]="RENDER_DOCX_COMMENT_SUCCESS",e[e.WORKER_FETCH_DOCX_CLIENTVAR_FINISH=10]="WORKER_FETCH_DOCX_CLIENTVAR_FINISH",e[e.WORKER_FETCH_DOCX_CLIENTVAR_TO_MAIN_FINISH=11]="WORKER_FETCH_DOCX_CLIENTVAR_TO_MAIN_FINISH",e[e.RENDER_DOCX_FIRST_CLIENTVAR_SUCCESS=12]="RENDER_DOCX_FIRST_CLIENTVAR_SUCCESS",e.RENDER_DOCX_FIRST_SCREEN_SUCCESS="RENDER_DOCX_FIRST_SCREEN_SUCCESS"}(a||(a={}));var s=function e(){c()(this,e)}},dx_ADkB:function(e,n,r){"use strict";r.d(n,"Y",(function(){return d})),r.d(n,"d",(function(){return f})),r.d(n,"k",(function(){return h}));var o=r("dx_UtDZ"),i=r("dx_xs2W"),c=r("dx_B28d"),a=r("dx_wexs"),l=r("dx_bUp7"),s=r("dx_UHze"),u=Object.values(l.C).map((function(e){return{type:e.type,patterns:e.patterns,disable:e.disable||!1}})),d=function(e){if(!e)return!1;if(Object(s.y)())return!0;var n=e.replace(/Code$/,""),r=!["larksuite.com","larksuite-staging.com"].some((function(e){var n;return(null===o.docsLocation||void 0===o.docsLocation||null===(n=o.docsLocation.hostname)||void 0===n?void 0:n.indexOf(e))>-1})),i=r&&a.x.includes(n),c=!r&&a.a.includes(n);return!i&&!c};function f(e){if(Object(i.t)(e)){var n=u.find((function(n){return n.patterns.find((function(n){return n.test(e)}))}));if(n&&!n.disable)return d(n.type)?n.type:void 0}}var h=function(e){if(e.type===c.B.IFRAME)return f(e.original_text)}},dx_AERA:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M9.166 14.993v-4.149H5.035v1.636a.417.417 0 01-.679.325l-3.088-2.47a.417.417 0 010-.65l3.088-2.47a.418.418 0 01.679.326v1.635h4.13V5.057H7.53a.417.417 0 01-.326-.678l2.47-3.086a.418.418 0 01.652 0l2.471 3.086a.417.417 0 01-.326.678h-1.636v4.119h4.13V7.54a.417.417 0 01.679-.326l3.088 2.47a.417.417 0 010 .65l-3.088 2.47a.417.417 0 01-.678-.325v-1.636h-4.13v4.15h1.635a.417.417 0 01.326.677l-2.47 3.086a.418.418 0 01-.653 0l-2.47-3.086a.417.417 0 01.326-.678h1.636z",fill:"currentColor"});n.S=function(e){return i.a.createElement("svg",c({width:20,height:20,viewBox:"0 0 20 20",fill:"none"},e),a)}},dx_AFvt:function(e,n,r){e.exports=r.p+"module/media/snapshot_bitable.4d33755d.png"},dx_AHmk:function(e,n,r){},dx_AIJo:function(e,n,r){"use strict";r.d(n,"b",(function(){return a})),r.d(n,"F",(function(){return l})),r.d(n,"z",(function(){return s})),r.d(n,"E",(function(){return u})),r.d(n,"K",(function(){return o})),r.d(n,"m",(function(){return i}));var o,i,c,a="abbreviation-data",l="clientside-abbreviation-data",s="abbreviation-id",u="abbreviation-hover";!function(e){e[e.Coincide=-1]="Coincide",e[e.Ignore=0]="Ignore",e[e.Visible=1]="Visible"}(o||(o={})),function(e){e[e.Default=0]="Default",e[e.Doc=1]="Doc",e[e.Chat=2]="Chat"}(i||(i={})),function(e){e.ignore="ignore",e.close="close",e.docClick="docClick"}(c||(c={}))},dx_AMht:function(e,n,r){"use strict";var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_vDqi"),h=r.n(f),p=r("dx_UtDZ"),v=r("dx_h6a8"),g=r("dx_yzqx"),b=r("dx_D8nn"),y=r("dx_qx8A"),m=r.n(y),_=function(){function e(){s()(this,e),this.lineEditable=void 0,this.larkApiHost={local:"localhost:4001",boe:"internal-api-lark-api.feishu-boe.cn",online:"internal-api-lark-api.feishu.cn"},this.lineEditable=!1,this.fetchLineEditableFg=this.fetchLineEditableFg.bind(this),b.S.on(b.p.COMMON.FETCH_MISS,this.fetchLineEditableFg)}return d()(e,[{key:"fetchLineEditableFg",value:function(){var e=a()(i.a.mark((function e(){var n,r,o,c,a,l,s,u,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n="",(r=m.a.getState())&&(c=Object(p.getToken)(),a=Object(p.suiteTypeNum)(),g.S.isMobile?(l="".concat(a,":").concat(c),s=r.entities.objs.get(l)):(l=c,s=r.entities.objs[l]),n=null===(o=s)||void 0===o?void 0:o.owner_id),n){e.next=6;break}return e.abrupt("return");case 6:return u=(u=Object(v.get)(window,"globalConfig.common.domain.lark_api",{}))===this.larkApiHost.local?this.larkApiHost.boe:u,e.next=10,h.a.get("https://".concat(u,"/settings/v3/?version=0.0.3&platform=web&user_id=").concat(n),{withCredentials:!1,ignoreInterceptors:!0});case 10:d=e.sent,this.lineEditable=!!d.data.data.lark_features.values["ccm.docx.line_edit_enable_fe"],e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log(e.t0,JSON.stringify(e.t0),"_____fetchLineEditableFg");case 17:case"end":return e.stop()}}),e,this,[[0,14]])})));return function(){return e.apply(this,arguments)}}()}]),e}();n.S=new _},dx_AOVQ:function(e,n,r){"use strict";r.d(n,"E",(function(){return Me}));var o=r("dx_yG8O"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_PJYZ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_Uyc2"),m=r.n(y),_=(r("dx_A1AB"),r("dx_Vvd7")),k=r("dx_TYsD"),O=r("dx_o0o1"),x=r.n(O),E=r("dx_yXPU"),S=r.n(E),C=r("dx_lSNA"),I=r.n(C),B=r("dx_QILm"),T=r.n(B),w=r("dx_iWIM"),R=r.n(w),M=r("dx_J4zp"),j=r.n(M),D=r("dx_QxNg"),A=r("dx_xjz2"),P=r("dx_ipPZ"),L=r("dx_UtDZ"),N=r("dx_h6a8"),F=r("dx_xlCA"),U=r("dx_DnxT"),H=r("dx_AAGW"),V=r("dx_LbJg"),W=r("dx_TTrq"),z=r("dx_Fimk");function G(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function K(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?G(Object(r),!0).forEach((function(n){I()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var q=function(){function e(n,r,o){var i=this;a()(this,e),this.normalThrottleEvents=n,this.customGroupLogMap=r,this.getCommonParams=o,this.bufferMap=new Map,this.throttleLog=Object(N.throttle)((function(){var e=i.bufferMap;i.bufferMap=new Map,e.forEach((function(e,n){var r,o=null===(r=i.customGroupLogMap)||void 0===r?void 0:r.get(n);o?o(e).forEach((function(e){i._teaLog(n,e)})):i._teaLog(n,{logs:e})}))}),2e3,{leading:!1,trailing:!0})}return s()(e,[{key:"getBuffer",value:function(e){var n=this.bufferMap.get(e);return n||(n=[],this.bufferMap.set(e,n)),n}},{key:"_teaLog",value:function(e,n){var r,o=null===(r=this.getCommonParams)||void 0===r?void 0:r.call(this),i=K(K({},n),o);Object(z.N)(e,i)}},{key:"log",value:function(e,n){var r;if(!this.normalThrottleEvents.has(e)&&!(null===(r=this.customGroupLogMap)||void 0===r?void 0:r.has(e)))return this._teaLog(e,n);var o=Object.assign({timestamp:Date.now()},n);this.getBuffer(e).push(o),this.throttleLog()}},{key:"encrypt",value:function(e){return Object(L.encryptTea)(e)}},{key:"destroy",value:function(){this.throttleLog.flush(),this.throttleLog.cancel()}}]),e}(),X=r("dx_CwnG"),Y=r("dx_B28d"),J=r("dx_lSlT"),Z=r("dx_oKt1"),Q=r("dx_Dtqr"),$=r("dx_W7Th"),ee=r("dx_D8nn");function te(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return L.IO.getInstance({initialTicket:"",autoConnect:e})}var ne=function(){L.EventEmitter.emit(L.EVENTS.PC.DOCS.SYNC_NOTE_META,{type:D.j.USER_CHANGES})},re=function(){L.EventEmitter.emit(L.EVENTS.PC.DOCS.SYNC_NOTE_META,{type:D.j.ACCEPT_COMMIT})},oe=r("dx_gFrY");function ie(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function ce(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ie(Object(r),!0).forEach((function(n){I()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ie(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ae(e){return Object(N.isFunction)(null===e||void 0===e?void 0:e.then)}var le=r("dx_GSgQ");function se(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var ue,de,fe,he,pe,ve,ge,be=le.g.isTextOdoiOp,ye=le.g.isEasysyncOp;function me(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function _e(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?me(Object(r),!0).forEach((function(n){I()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ke(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Oe,xe,Ee,Se,Ce,Ie=new Map([["ccm_front_recv_msg_info_dev",function(e){var n={};e.forEach((function(e){var r=e.cs_uuid;n[r]?(n[r].block_detail.push(e),n[r].set.add(e.block_id)):n[r]={block_detail:[e],set:new Set([e.block_id])}}));var r=[];return Object.entries(n).forEach((function(e){var n=j()(e,2),o=n[0],i=n[1],c=i.block_detail,a=i.set;r.push({cs_uuid:o,cs_block_num:a.size,message_type:"changeset",block_detail:c})})),r}]]),Be=function(){return{device_id:Object(X.M)(),member_id:"".concat(te().getMemberId())}},Te=new Set(["dev_sync_new_changes","dev_sync_emit_new_changes","dev_sync_ack","docx_collab_dev"]),we=(ue=Object(A.s)(oe.q),Oe="reFetchRoomMembers",de=function(){var e=arguments.length<=2?void 0:arguments[2],n=(e.get,e.set,e.writable,e.value),r=T()(e,["get","set","writable","value"]);if(!Object(N.isFunction)(n))return e;var o=new Map;return ce(ce({},r),{},{value:function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var c=r[0]||Oe,a=o.get(c);if(!a){var l=n.call.apply(n,[this].concat(r));return ae(l)?(o.set(c,!0),l.then((function(e){return o.delete(c),e})).catch((function(e){throw o.delete(c),e}))):console.error("should return an Promise")}}})},ue(fe=function(e){var n;return n=function(e){h()(r,e);var n=se(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).initSyncBuffer=function(){var n=function(n){var r=[];e.engineSyncBuffer.composedResult.forEach((function(e){n?e.id===n&&r.push(e):r.push(e)})),e.handleNewChanges(r)};e.engineSyncBuffer=Object(D.v)({logger:z.N,isActiveModeEnabled:true,checkIfEnable:function(){return!0},onEnterInactive:function(){e.sync.io.switchHeartbeatInactive(),e.sync.io.setEntityExternalInfo(e.sync.getWatchingIOEntities().map((function(e){return{entity:e,inactive:1}})))},onEnterActive:function(){e.sync.io.switchHeartbeatActive(),e.sync.io.setEntityExternalInfo(e.sync.getWatchingIOEntities().map((function(e){return{entity:e,inactive:0}})))},onSwitchToActiveMode:function(e){console.log("context",e)},clearBufferPool:function(n){e.engineSyncBuffer.bufferPool=e.engineSyncBuffer.bufferPool.filter((function(e){return e.id!==n})),e.engineSyncBuffer.composedResult=e.engineSyncBuffer.composedResult.filter((function(e){return e.id!==n})),0===e.engineSyncBuffer.composedResult.length&&(e.engineSyncBuffer.composedResult=void 0)},composeBuffer:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.forEach((function(e){for(var r=e.id,o=-1,i=n.length-1;i>=0;i--){if(n[i].id===r){o=i;break}}if(-1!==o)try{var c=n[o].ops.concat(e.ops),a=!1,l=!1;if(c.forEach((function(e){ye(e)?a=!0:be(e)&&(l=!0)})),a&&l)return void n.push(e);n[o].ops=Object(le.u)(n[o].ops,e.ops)}catch(s){console.error("sync buffer compose error!"),n.push(e)}else n.push(e)})),n},handleMessage:function(n){n.forEach((function(n){e.handleNewChanges(n)}))},handleMessageOnReActive:n,handleMessageOnActive:n},{isFullPipe:!1});var r=function(){e.membersSyncBuffer.bufferPool.forEach(e.processMemberChannelMessage)};e.membersSyncBuffer=Object(D.v)({isActiveModeEnabled:true,checkIfEnable:function(){return!0},handleMessage:function(n){n.forEach(e.processMemberChannelMessage)},handleMessageOnReActive:r,handleMessageOnActive:r},{isFullPipe:!0})},e.destroySyncBuffer=function(){e.engineSyncBuffer.destroy(),e.membersSyncBuffer.destroy()},e}return r}(e),n}((ge=function(e){h()(r,e);var n=ke(r);function r(){var e,o;a()(this,r);for(var c=arguments.length,l=new Array(c),s=0;s<c;s++)l[s]=arguments[s];return(o=n.call.apply(n,[this].concat(l))).isSynchronizing=!(null===Z.q||void 0===Z.q?void 0:Object(Z.q)()),i()(o,"model",pe,d()(o)),i()(o,"config",ve,d()(o)),o.flush=Object(N.throttle)((function(){Promise.resolve().then((function(){o.engineSyncBuffer.consume(),R()((e=d()(o),b()(r.prototype)),"flush",e).call(e)}))}),500,{leading:!1}),o.memberVersion=void 0,o.hooks=new D.Y(d()(o)),o.inited=!1,o.throttleTeaLogger=new q(Te,Ie,Be),o.handleMultiGeoMessage=function(e){var n=e.token;switch(e.status){case"201":P.multiGeoTipInstance.start(n);break;case"203":P.multiGeoTipInstance.end(n)}},o.handleMemberChannelEvent=function(e){switch(e.type){case D.j.USER_NEWINFO:case D.j.USER_LEAVE:case D.j.ROOM_MEMBERS:o.memberVersion=e.version,o.membersSyncBuffer.pipe(e);break;case"heartbeat":(Object(N.isUndefined)(o.memberVersion)||e.version>o.memberVersion)&&o.reFetchRoomMembers();break;case"refetch_member_list":L.memberHelper.getSuiteMembers(L.FILE_TYPE.DOCX,Object(W.B)(o.token)).length<150&&o.reFetchRoomMembers()}},o.processMemberChannelMessage=function(e){e.type===D.j.USER_NEWINFO?o.handleUserNewInfo(e):e.type===D.j.USER_LEAVE?o.handleUserLeave(e):e.type===D.j.ROOM_MEMBERS&&o.handleMembersMessage(e)},o.fetchMembersWhenMembersMissing=function(){L.memberHelper.checkIsMembersMissing("docx",o.token)&&o.reFetchRoomMembers()},o.handleUserNewInfo=function(e){var n=e.entities,r=e.token,o=T()(e,["entities","token"]),i=Object(N.get)(n,"users",{}),c=Object.assign(o,i[o.user_id],{count:n.users_count,color_id:L.userColorHelper.getUserColorId(o.user_id),token:Object(W.B)(r)});L.memberHelper.handleUserNewInfo("docx",c)},o.handleUserLeave=function(e){e.token=Object(W.B)(e.token),L.memberHelper.handleUserLeave("docx",e),ee.s.trigger(ee.p.COMMON.USER_LEAVE,[e]),o.fetchMembersWhenMembersMissing()},o.handleMembersMessage=function(e){var n=e.count;ee.s.trigger(ee.p.COMMON.UPDATE_MEMBERS,[e.members]),L.memberHelper.handleMembersMessage("docx",Object.assign(e,{token:Object(W.B)(o.token),members:o.assignMemberInfo(e,e.members),count:n}))},o.handleNewChangesExtra=function(e){var n=e.user_map;n&&F.n.applyNewChangesExtra(n),J.S.applyNewChangesExtra(e)},o.handleUserChanges=function(){ne()},o.handleAcceptMessage=function(e){o.engineSyncBuffer.consume(e);var n=o.handleAcceptCommit(e);o.flush(),re(),ee.s.trigger(ee.p.COMMON.ACCEPT_COMMIT,[e,n])},o.handleUpdateCursor=function(e){ee.s.trigger(ee.p.COMMON.UPDATE_CURSOR,[e])},o.canLeavePage=function(){return 0===o.getLocal().size&&0===o.getSubmitted().size},o.assignMemberInfo=function(e,n){var r=Object(N.get)(e,"entities.users",{}),o=Object.assign(n);return o.forEach((function(e){var n=e.suid||e.user_id;e=Object.assign(e,r[n],{color_id:L.userColorHelper.getUserColorId(n)})})),o},o.handleWillFetchMiss=function(e){o.sync.getHasCacheMissing()||(o.isSynchronizing=e),ee.s.emit(ee.p.COMMON.FETCH_MISS,e)},o.handleUserIgnoreAbbreviation=function(e){var n=e.token,r=e.ignore_list;$.g.onReceiveUserIgnoreListPush(n,r)},o.handleAllMissedApplied=function(){ee.s.emit(ee.p.COMMON.ALL_MISSED_APPLIED),o.isSynchronizing=!1},o}return s()(r,[{key:"reFetchRoomMembers",value:function(){var e=this,n=Object(W.B)(this.token);return L.memberHelper.fetchMemberInfos(this.getMemberId(),n,this.suiteType).then((function(n){e.setHeartbeatVersion("member_channel",n.data.version),e.handleMemberChannelEvent(_e({type:D.j.ROOM_MEMBERS},n.data))})).catch((function(e){throw console.log("fetchMemberInfos failed: ",e),e}))}},{key:"getMemberId",value:function(){return te().getMemberId().toString()}},{key:"init",value:function(e){if(this.inited)throw new Error("Failed to re-init collab");this.inited=!0;var n=this.config.get("token");R()(b()(r.prototype),"init",this).call(this,Object(N.merge)({collab:!Object(Q.C)(),io:te(),recordManager:this.getRecordManagerFacade(),axios:H.S,requestAPI:{USER_CHANGE:U.r.userChange,NEW_CHANGES:U.r.fetchMiss},fileToken:n,logger:this.throttleTeaLogger,options:{messageHandlerPacks:L.syncHelpers.getMessageHandlerPacks(),heartbeatsOptionMap:Object(L.getHeartbeatsOption)()},fetchMissMaxVersion:Object(L.getMinaConfig)("mobile_docx_pre_update_clientvar",{versionOverLimit:3e3}).versionOverLimit,proxyManager:this.getProxyManager()},e)),this.sync.off(D.T.UserChanges,this.handleUserChanges),this.sync.off(D.T.AcceptCommit,this.handleAcceptCommit),this.sync.off(D.T.MemberChannel,this.handleMemberChannelEvent),this.sync.off(D.T.UpdateCursor,this.handleUpdateCursor),this.sync.off(D.T.DataMigrate,this.handleMultiGeoMessage),this.sync.on(D.T.NewChangesExtra,this.handleNewChangesExtra),this.sync.on(D.T.UserChanges,this.handleUserChanges),this.sync.on(D.T.AcceptCommit,this.handleAcceptMessage),this.sync.on(D.T.MemberChannel,this.handleMemberChannelEvent),this.sync.on(D.T.UpdateCursor,this.handleUpdateCursor),this.sync.on(D.T.WillFetchMiss,this.handleWillFetchMiss),this.sync.on(D.T.UserIgnoreAbbreviation,this.handleUserIgnoreAbbreviation),this.sync.on(D.T.AllMissedApplied,this.handleAllMissedApplied),this.sync.on(D.T.DataMigrate,this.handleMultiGeoMessage),this.initSyncBuffer(),L.resourceGuard.addCanLeavePageHandler(this.canLeavePage),ee.s.emit(ee.p.COMMON.COLLAB_MODULE_INIT_FINISH)}},{key:"getProxyManager",value:function(){var e=this;if(Object(Z.q)())return{getIsReady:function(){return!!V.S.getRealTokenFromMemory(e.token)},getProxyTokenByOrigin:function(e){return V.S.getRealTokenFromMemory(e)},getOriginTokenByProxy:function(e){return V.S.getFakeTokenFromMemory(e)}}}},{key:"destroy",value:function(){this.inited&&(this.flush.flush(),R()(b()(r.prototype),"destroy",this).call(this),this.sync.off(D.T.NewChangesExtra,this.handleNewChangesExtra),this.sync.off(D.T.AcceptCommit,this.handleAcceptMessage),this.sync.off(D.T.MemberChannel,this.handleMemberChannelEvent),this.sync.off(D.T.UpdateCursor,this.handleUpdateCursor),this.sync.off(D.T.WillFetchMiss,this.handleWillFetchMiss),this.sync.off(D.T.UserIgnoreAbbreviation,this.handleUserIgnoreAbbreviation),this.sync.off(D.T.DataMigrate,this.handleMultiGeoMessage),this.destroySyncBuffer(),L.resourceGuard.removeCanLeavePageHandler(this.canLeavePage),L.userColorHelper.resetUserColor(),this.hooks.destroy(),P.multiGeoTipInstance.endAll())}},{key:"onSubmitted",value:function(e){this.hooks.addSubmittedOpsHandlers(e)}},{key:"sendMessage",value:function(){var e=S()(x.a.mark((function e(n){var r,o,i=arguments;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:{},o={type:"DOCX",data:_e({token:this.token,user_id:Object(N.get)(window,"User.id")},n),version:2},e.abrupt("return",this.sync.io.request(o,r));case 3:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"handleNewChangesMessage",value:function(e){if(this.isSelfChangeset(e))return this.handleSelfChangeset(e),void this.handleAcceptMessage(e.id);this.engineSyncBuffer.pipe(e),ee.s.trigger(ee.p.COMMON.NEW_CHANGES_MESSAGE,[e])}},{key:"handleNewChangesEnd",value:function(e){R()(b()(r.prototype),"handleNewChangesEnd",this).call(this,e),!this.isSynchronizing||this.sync.getIsFetching()||this.sync.getHasCacheMissing()||this.handleAllMissedApplied(),L.EventEmitter.emit(L.EVENTS.PC.DOCS.SYNC_NOTE_META,{type:D.j.NEW_CHANGES}),ee.N.trigger(ee.p.COMMON.NEW_CHANGES_END,[e])}},{key:"setHeartbeatVersion",value:function(e,n){this.sync.io.setHeartbeatVersion({type:this.suiteType,token:this.token},e,n)}},{key:"getRecordManagerFacade",value:function(){var e=this.model;return{hasRecord:function(n){return e.hasRecordByRecordId(n)},getRecord:function(n){return e.getRecordByRecordId(n)},registerRecords:function(n){return e.registerRecords(n)},applyTransaction:e.applyTransaction,onChange:function(n){var r=e.change$.subscribe(n);return function(){return r.unsubscribe()}},emitError:function(n){e.error$.next(n)},interceptRemoteChanges:function(n){e.interceptRemoteChange$.next({recordOps:n})}}}},{key:"makeBlankRecordSnapshot",value:function(){return{type:Y.B.BLANK}}},{key:"suiteType",get:function(){return L.NUM_SUITE_TYPE.DOCX.toString()}}]),r}(D.s),he=ge,pe=m()(he.prototype,"model",[_.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ve=m()(he.prototype,"config",[_.j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m()(he.prototype,"reFetchRoomMembers",[de],Object.getOwnPropertyDescriptor(he.prototype,"reFetchRoomMembers"),he.prototype),fe=he))||fe)||fe);function Re(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Me=Object(_.H)({providers:[we]})((Ce=function(e){h()(r,e);var n=Re(r);function r(){var e;a()(this,r);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return e=n.call.apply(n,[this].concat(c)),i()(e,"collab",Se,d()(e)),e}return s()(r,[{key:"init",value:function(){this.options.collab&&this.collab.init(this.options.collab)}},{key:"destroy",value:function(){this.collab.destroy()}}]),r}(_.G),Ee=Ce,Se=m()(Ee.prototype,"collab",[k.q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xe=Ee))||xe},dx_AOXH:function(e,n,r){"use strict";(function(t){r.d(n,"q",(function(){return M}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_yBmk"),p=r("dx_PcQO"),v=r("dx_TSYQ"),g=r.n(v),b=r("dx_cDcd"),y=r.n(b),m=r("dx_yzqx"),_=r("dx_hKul"),k=r("dx_CR0l"),O=r("dx_Z04Z"),x=r("dx_oftt"),E=r("dx_B28d"),S=r("dx_cGa6"),C=r("dx_AbAm"),I=r("dx_h0h1"),B=r("dx_T7To"),T=r("dx_yb0T"),w=r("dx_hCEt");r("dx_IZcR");function R(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var M=function(e){l()(r,e);var n=R(r);function r(){var e;o()(this,r);for(var i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).insertRange=null,e.minShouldRenderWidth=110,e.onAtUserButtonClick=function(){var n=e.props,r=n.blockManager,o=n.textBlock,i=o.model.zoneState.getModelText().length-1,c=e.insertRange||{zoneId:o.model.zoneId,start:i,len:0};o.model.setSelection(c,!0),setTimeout((function(){Object(O.m)({block:o,blockManager:r,range:o.model.getSelection().toPosition(),mentionOptions:{defaultActiveTab:x.n.USER,singleTab:!0,source:E.B.TODO}}),Object(_.M)(o.id,{actionType:k.e.CLICK_TODO_MENTION_PEOPLE_PANEL,target:"ccm_doc_reminder_panel_view"},{blockManager:r})}),100)},e.onAddReminderButtonClick=function(){var n=e.props,r=n.textBlock,o=n.blockManager,i=r.model.zoneState.getModelText().length,c=e.insertRange||{zoneId:r.model.zoneId,start:i-1,len:0};Object(I.G)(r,c,{openPopover:!0,focus:!0}),Object(_.M)(r.id,{actionType:k.e.CLICK_TODO_DOC_REMINDER_PANEL,target:"ccm_mention_panel_view"},{blockManager:o})},e.onTransToTaskClick=function(){var n=e.props,r=n.textBlock,o=n.blockManager;Object(_.M)(r.id,{actionType:k.e.CLICK_TODO_TURN_TASK,target:"none"},{blockManager:o}),Object(C.t)(r,o)},e.onButtonMouseDown=function(){var n=e.props.textBlock;e.insertRange=null,n.isFocus()&&(e.insertRange=n.model.getSelection().toPosition())},e}return c()(r,[{key:"renderAddReminder",value:function(){return y.a.createElement(p.Tooltip,{overlayClassName:g()({"reminder-toolbar-tooltip-hidden":!this.props.visible}),mouseEnterDelay:200,title:t("reminder.toolbar.reminder"),placement:"top",hideAction:["mouseLeave","click"]},y.a.createElement("span",{className:"add-reminder toolbar-btn",onClick:this.onAddReminderButtonClick,onMouseDown:this.onButtonMouseDown},y.a.createElement(T.S,null)))}},{key:"renderAddUser",value:function(){return y.a.createElement(p.Tooltip,{overlayClassName:g()({"reminder-toolbar-tooltip-hidden":!this.props.visible}),mouseEnterDelay:200,title:t("reminder.toolbar.user"),placement:"top",hideAction:["mouseLeave","click"]},y.a.createElement("span",{className:"add-user toolbar-btn",onClick:this.onAtUserButtonClick,onMouseDown:this.onButtonMouseDown},y.a.createElement(w.S,null)))}},{key:"renderToTask",value:function(){return m.S.isOpendoc?null:y.a.createElement(p.Tooltip,{overlayClassName:g()({"reminder-toolbar-tooltip-hidden":!this.props.visible}),mouseEnterDelay:200,title:t("LarkCCM_Tasks_CreateATask_Tooltip"),placement:"top",hideAction:["mouseLeave","click"]},y.a.createElement("span",{className:"to-task toolbar-btn",onClick:this.onTransToTaskClick},y.a.createElement(h.S,null)))}},{key:"render",value:function(){var e=g()({"docx-reminder-toolbar":!0,visible:this.props.visible,"docx-reminder-toolbar-checklist-style":Object(S.Q)()});return y.a.createElement("span",{className:e},Object(B.H)()?null:[this.renderAddUser(),this.renderAddReminder()],Object(S.Q)()&&this.props.containerWidth&&this.props.containerWidth>=this.minShouldRenderWidth?this.renderToTask():null)}}]),r}(y.a.Component)}).call(this,r("dx_E9Eu"))},dx_APSa:function(e,n,r){"use strict";r.d(n,"S",(function(){return u}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c),l=r("dx_xl9j"),s=r("dx_MiPk");r("dx_moZV");function u(e){var n=Object(c.useState)(!1),r=i()(n,2),o=r[0],u=r[1],d=e.blockManager,f=e.blockId,h=e.recordId,p=e.updateVisible,v=e.SelectionAPI;return o?a.a.createElement(l.S,{SelectionAPI:v,blockManager:d,blockId:f,recordId:h,updateVisible:p}):a.a.createElement(s.S,{blockManager:d,blockId:f,recordId:h,updateCanShowInput:u,updateVisible:p})}},dx_AYdr:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M6.188 8.25v8.25h6.875V8.25H6.186zm8.25-.688v9.702c0 .337-.288.611-.642.611H5.454c-.354 0-.641-.274-.641-.611V7.486c0-.337.287-.611.641-.611h8.296c.38 0 .688.308.688.688zm2.548-3.236a.685.685 0 01.201.487v8.593c0 .19-.153.344-.343.344h-.688a.344.344 0 01-.343-.344V5.5H9.28a.344.344 0 01-.344-.344V4.47c0-.19.154-.344.344-.344H16.5c.19 0 .362.077.486.201z",fill:"#646A73"});n.S=function(e){return i.a.createElement("svg",c({width:22,height:22,viewBox:"0 0 22 22",fill:"none"},e),a)}},dx_AaSx:function(e,n,r){"use strict";r.d(n,"w",(function(){return o})),r.d(n,"M",(function(){return i}));var o="equation-editor-popover",i="equation-katex-span"},dx_AbAm:function(e,n,r){"use strict";r.d(n,"y",(function(){return P})),r.d(n,"k",(function(){return L})),r.d(n,"P",(function(){return U})),r.d(n,"F",(function(){return z})),r.d(n,"w",(function(){return K})),r.d(n,"t",(function(){return X})),r.d(n,"J",(function(){return J}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_RIqP"),d=r.n(u),f=r("dx_lSNA"),h=r.n(f),p=r("dx_e4eN"),v=r("dx_M30o"),g=r("dx_alfx"),b=r("dx_cyoC"),y=r("dx_UtDZ"),m=r("dx_C7Cb"),_=r("dx_xlCA"),k=r("dx_MoY1"),O=r("dx_gDjg"),x=r("dx_QJ6a"),E=r("dx_FXIk"),S=r("dx_zghO"),C=r("dx_ppc6"),I=r("dx_B28d"),B=r("dx_s1qv"),T=r("dx_cGa6"),w=r("dx_MsqB"),R=r("dx_pzI1"),M=r("dx_mopU"),j=r("dx_cJcU"),D=r("dx_HlLk"),A=r("dx_Cg1F");function P(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=_.n.getCache(e);if(r||n)return{dataMetaBlockProps:JSON.stringify(Object(R.e)({avatar_url:(null===r||void 0===r?void 0:r.avatar_url)||"",cn_name:(null===r||void 0===r?void 0:r.name)||n||"",en_name:(null===r||void 0===r?void 0:r.en_name)||n||"",department:"",email:(null===r||void 0===r?void 0:r.email)||"",id:e,is_external:(null===r||void 0===r?void 0:r.is_external)||!1,type:y.TYPE_ENUM.USER,name:(null===r||void 0===r?void 0:r.name)||"",leaderName:""}))}}function L(e){var n=e.token,r=e.type,o=e.title,i=e.url;return{dataMetaBlockProps:JSON.stringify(Object(R.e)({type:r,link:i,url:i,token:n,title:o,is_cross_tenant:!1}))}}function N(e,n,r){var o,i=Object(g.Z)(e,n),c=new Set;return i.forEach((function(e){e.forEach((function(e){var n,i;if(" "===e.insert&&(null===e||void 0===e||null===(n=e.attributes)||void 0===n?void 0:n["inline-component"])){var a,l=e.attributes["inline-component"];try{a=JSON.parse(l)}catch(v){console.error("parse inline component mark fail in render, origin string is:",l,v)}if(!a)return;switch(a.type){case B.INLINE_COMPONENT_TYPE.USER:delete e.attributes["inline-component"];var s=a.data.uid;if(!r){c.add(s),delete e.attributes,e.insert="";break}r.includes(s)?(delete e.attributes,e.insert=""):e.attributes=P(a.data.uid);break;case B.INLINE_COMPONENT_TYPE.DOC:delete e.attributes["inline-component"];var u=a.data;e.attributes=L({token:u.token,type:u.file_type,title:Object(O.J)(u),url:u.raw_url});break;case B.INLINE_COMPONENT_TYPE.REMINDER:var d=a.data;delete e.attributes,o?e.insert="".concat(Object(M.a)(o)," "):(o=Object(M.c)({reminderId:"",expireTime:d.expire_time,isWholeDay:d.is_whole_day,shouldNotify:d.should_notify,notifyTime:d.notify_time}),e.insert="");break;case B.INLINE_COMPONENT_TYPE.FILE:var f=a.data;e.insert=f.name}}var p=null===e||void 0===e||null===(i=e.attributes)||void 0===i?void 0:i[x.e];p&&(e.attributes=h()({},b.Q.KEY,JSON.stringify({href:decodeURIComponent(p),linkId:Object(m.S)()})))}))})),{deltaSet:i.concat((new p.m).insertEnter({fixEnter:"true"})),dueTimeValue:o,assigneeIds:r||d()(c)}}function F(e){var n=Object(j.Z)({richContent:e.rich_summary,assignees:e.assignees_detail,dueTimeValue:{dueTime:e.due_time,dueTimezone:e.due_timezone,isAllDay:e.is_all_day,reminders:e.reminders},format:"docx"}),r=new v.q(h()({},n.zoneId,n));return Object(g.P)(r)}function U(e,n){return H.apply(this,arguments)}function H(){return(H=s()(i.a.mark((function e(n,r){var o,c,l,s,u,d,f,h,p;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.model,c=o.parent,l=o.record.snapshot,c){e.next=4;break}return e.abrupt("return");case 4:return s=F(n.model.taskData),u=r.createInitModel(I.B.TODO,{comments:l.comments,done:Object(A.G)(n.model.taskData),text:s}),d=Object(E.e)({parentBlockId:c.id,blockManager:r,blockSnapshot:u,childBlockIds:o.children.map((function(e){return e.id})),position:o.position,transactionName:"taskBlockTurnIntoTodo",beforeInsert:function(e){Object(k.y)(e,[o])}}),f=a()(d,2),h=f[0],p=f[1],e.next=9,p;case 9:return e.abrupt("return",h);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e,n){return W.apply(this,arguments)}function W(){return(W=s()(i.a.mark((function e(n,r){var o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=7;break}if(r.hasBlockViewByBlockId(n)){e.next=4;break}return e.next=4,r.layoutManager.renderNodeById(n);case 4:null===(c=r.getBlockViewByBlockIdNotCheck(n))||void 0===c||c.selectionAPI.removeAllSelection(),null===c||void 0===c||null===(o=c.editorInstance)||void 0===o||o.focusAtEnd();case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(e){return G.apply(this,arguments)}function G(){return(G=s()(i.a.mark((function e(n){var r,o,c,a,l,s,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.parentBlockId,o=n.insertPosition,c=n.blockManager,a=n.forceFocus,l=n.beforeInsert,r){e.next=3;break}return e.abrupt("return");case 3:if(s=c.getBlockModelByBlockIdNotCheck(r)){e.next=6;break}return e.abrupt("return");case 6:return u=c.createInitModel(I.B.TASK,{comments:[]}),e.next=9,c.applyTransaction("insert-task",(function(e){null===l||void 0===l||l(e),Object(k.l)(e,s.recordId,o,[u])}));case 9:if(!a){e.next=12;break}return e.next=12,V(s.children[o].id,c);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,n){return q.apply(this,arguments)}function q(){return(q=s()(i.a.mark((function e(n,r){var o,c,l,s,u,d,f,h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.model,c=r.createInitModel(I.B.TEXT),l=o.parent,s=o.position,u=Object(E.y)({parentBlockId:l.id,blockManager:r,blockSnapshot:c,position:s,getChildRecordIds:function(){return o.snapshot.children},transactionName:"replaceTaskToText",beforeInsert:function(e){Object(k.y)(e,[o])}},!0),d=a()(u,2),f=d[0],h=d[1],e.next=7,h;case 7:r.editorAPI.getService(C.S).setSelection([{id:f,type:S.j.TEXT,selection:{start:0,end:0}}]);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e,n,r){return Y.apply(this,arguments)}function Y(){return(Y=s()(i.a.mark((function e(n,r,o){var c,l,s,u,d,f,h,p,v,g,b,m,_,O,x,S,C,B,R,j,A,P,L,F;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=n.model,l=c.parent,s=c.record.snapshot,l){e.next=4;break}return e.abrupt("return");case 4:return u=(null===o||void 0===o?void 0:o.text)||s.text,d=Boolean(s.done),f=0===u.initialAttributedTexts.text[0].length,h=N(u.initialAttributedTexts,u.apool,null===o||void 0===o?void 0:o.assigneeIds),p=h.deltaSet,v=h.dueTimeValue,g=h.assigneeIds,b=Object(D.l)(p.get("0")),m=y.userHelper.getCurrentUser().get("id"),_=l.recordId,O=c.children.map((function(e){return e.recordId})),x=c.children.map((function(e){return e.id})),S=r.createInitModel(I.B.TASK,{comments:s.comments,task_id:"",status:w.TaskBlockStatus.New}),C=Object(E.e)({parentBlockId:l.id,blockManager:r,blockSnapshot:S,childBlockIds:Object(T.i)()?x:[],position:c.position,transactionName:"",beforeInsert:function(e){if(Object(k.y)(e,[c]),!Object(T.i)()&&O){var n=c.position;Object(k.t)(e,_,n,O)}}}),B=a()(C,2),R=B[0],j=B[1],e.next=17,j;case 17:if(!f){e.next=21;break}return e.next=20,V(R,r);case 20:case 30:return e.abrupt("return",R);case 21:return A=d?Date.now():0,P={guid:"",assignees_detail:g.map((function(e){return{assignee_id:e,completed_milli_time:A}})),followers_detail:[],creator_id:m,rich_summary:b,due_time:(null===v||void 0===v?void 0:v.dueTime)||0,is_all_day:(null===v||void 0===v?void 0:v.isAllDay)||!1,due_timezone:(null===v||void 0===v?void 0:v.dueTimezone)||Object(M.C)(),update_mill_time:0,is_deleted:!1,reminders:(null===v||void 0===v?void 0:v.reminders)||[],completed_milli_time:A,docx_editable:!0},r.getBlockModelByBlockId(R).taskModel.apply(P),L=r.getBlockViewByBlockId(R),(F=$(L.hostElement)).addClass("task-block-highlight").on("animationend",(function(){F.removeClass("task-block-highlight")})),e.next=30,V(R,r);case 31:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,n){return Z.apply(this,arguments)}function Z(){return(Z=s()(i.a.mark((function e(n,r){var o,c,a,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=y.userHelper.getCurrentUser().get("id"),c=n.map((function(e){return e.taskData.rich_summary})),a=[],l=new Map,e.next=6,r.applyTransaction("dereferTasks",(function(e){a=n.map((function(n){var o=n.model,i=o.parent.recordId,c=l.get(i)||i,a=o.record.id;e.removeChildren(c,[a]);var s=Object(k.l)(e,c,o.position,[r.createInitModel(I.B.TASK,{comments:[],task_id:"",status:w.TaskBlockStatus.New,children:[],folded:o.snapshot.folded})])[0];l.set(a,s);var u=o.snapshot.children.map((function(e){return l.get(e)||e}));return Object(E.V)(s,u,r,e),s}))}));case 6:a.forEach((function(e,n){var i={guid:"",assignees_detail:[],followers_detail:[],creator_id:o,rich_summary:c[n],due_time:0,is_all_day:!1,due_timezone:Object(M.C)(),update_mill_time:0,is_deleted:!1,reminders:[],completed_milli_time:0,docx_editable:!0};r.getBlockModelsByRecordId(e)[0].taskModel.apply(i)}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},dx_Aha1:function(e,n,r){},dx_Ai6r:function(e,n,r){"use strict";(function(t){r.d(n,"y",(function(){return B})),r.d(n,"s",(function(){return w})),r.d(n,"e",(function(){return R})),r.d(n,"R",(function(){return A})),r.d(n,"T",(function(){return V}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_QxNg"),l=r("dx_UtDZ"),s=r("dx_bUYd"),u=r("dx_YzVl"),d=r("dx_MoY1"),f=r("dx_yzqx"),h=r("dx_ukKW"),p=r("dx_E1yU"),v=r("dx_jBAU"),g=r("dx_DnxT"),b=r("dx_Bv2G"),y=r("dx_tP01"),m=r("dx_g0R0"),_=r("dx_B28d"),k=r("dx_e8ez"),O=r("dx_yaFe"),x=r("dx_QRvo"),E=r("dx_EjFk"),S=r("dx_HSkh"),C=r("dx_LSI4"),I=r("dx_mYvZ");function B(e){return T.apply(this,arguments)}function T(){return T=c()(o.a.mark((function e(n){var r,i,c,a,l,s=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},i=r.align,c=void 0===i?_.D.CENTER:i,e.next=4,E.J.getImageSize(n);case 4:return a=e.sent,l={src:"",token:"",mimeType:n.type,size:n.size,name:n.name,scale:1,width:a.width,height:a.height},e.abrupt("return",Object(C.h)({image:l,align:c}));case 7:case"end":return e.stop()}}),e)}))),T.apply(this,arguments)}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.align,r=void 0===n?_.D.CENTER:n,o={src:"",token:"",mimeType:"",name:"",size:0,scale:1,width:240,height:240};return Object(C.h)({image:o,align:r})}function R(e,n,r,o,i,c,a,l){return M.apply(this,arguments)}function M(){return(M=c()(o.a.mark((function e(n,r,i,c,l,s,f,h){var p,v,g,y,m,_;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e)}));case 2:if(n.hasBlockModelByBlockId(l)){e.next=5;break}return console.warn("uploading image block not found"),e.abrupt("return");case 5:return e.prev=5,p=i.collectorManager.get(l),v=n.getBlockViewByBlockId(l),g=v.record.id,e.prev=9,e.next=12,new Promise((function(e,n){var r=new FileReader;r.readAsDataURL(s),r.onload=function(){return e(r.result)},r.onerror=function(e){return n(e)}}));case 12:y=e.sent,v.setUploadBackground(y),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(9),console.warn("set uploading preview failed",e.t0);case 19:return p.logUploadImageStart(g,s.size,s.type,f),m=performance.now(),e.prev=21,e.next=24,r.uploadImage(s,g,(function(e,r){var o=n.getBlockViewsByRecordId(g)[0];o?o.setUploadProgress(e):r.cancelAll()}));case 24:_=e.sent,h&&h.scale&&(_.scale=h.scale),p.logUploadImageEnd({blockId:g,size:s.size,type:s.type,source:f,fileToken:_.token,isSuccess:!0,startTime:m}),e.next=33;break;case 29:throw e.prev=29,e.t1=e.catch(21),p.logUploadImageEnd({blockId:g,size:s.size,type:s.type,source:f,isSuccess:!1,startTime:m,errorMsg:e.t1}),e.t1;case 33:if(n.hasBlockModelByBlockId(l)){e.next=40;break}if(n.recordManager.hasRecord(g)){e.next=36;break}return e.abrupt("return");case 36:if(l=n.getBlockIdsByRecordId(g)[0]){e.next=39;break}return e.abrupt("return");case 39:v=n.getBlockViewByBlockId(l);case 40:return e.next=42,n.applyTransaction(c,(function(e){e.replace(g,["image"],_)}),{from:a.H.local,undoable:!1});case 42:n.editorAPI.getService(O.V).removeKey(g,window.URL.revokeObjectURL),e.next=54;break;case 45:if(e.prev=45,e.t2=e.catch(5),!n.hasBlockModelByBlockId(l)){e.next=53;break}return e.next=50,n.applyTransaction("removeImageUploadPlaceholder",(function(e){Object(d.y)(e,[l],n)}),{undoable:!1});case 50:if(e.t2.message!==b.g.USER_DRIVE.toString()&&e.t2.message!==b.g.USER_NO_DRIVE.toString()&&e.t2.message!==b.g.SPACE.toString()){e.next=52;break}return e.abrupt("return");case 52:Object(u.F)({type:"error",content:"".concat(t("common.upload_image_failed")," ").concat(String(e.t2.msg||""))});case 53:throw e.t2;case 54:case"end":return e.stop()}}),e,null,[[5,45],[9,16],[21,29]])})))).apply(this,arguments)}function j(e){return D.apply(this,arguments)}function D(){return(D=c()(o.a.mark((function e(n){var r,i,c,a,l,s,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.fileToken,i=n.blockManager,c=n.recordId,a=n.transactionName,l=n.needCopyImage,s=i.rootRecordId,u=r,!l){e.next=8;break}return e.next=6,v.S.resourceCopyTo([r],c,b.O.IMAGE,s);case 6:d=e.sent,u=d.data.succ_files[r];case 8:return e.next=10,i.applyTransaction(a,(function(e){e.replace(c,["image","token"],u)}),{undoable:!1});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return P.apply(this,arguments)}function P(){return(P=c()(o.a.mark((function e(n){var r,i,c,a,l,s,u,d,p,v,g,m,_,k,O,C,I,B,T,w;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.blockManager,i=n.imageManager,c=n.recordId,a=n.payload,l=n.onError,s=n.onFinally,u=a.driveToken,d=a.src,p=a.image,v=a.file,g=a.uuid,m=new E.J({pageToken:r.editorAPI.config.get("token")}),_=!1,e.prev=4,!p){e.next=12;break}return!0,e.next=9,j({fileToken:p.token,blockManager:r,recordId:c,transactionName:"replaceImageToken",needCopyImage:true});case 9:return e.abrupt("return");case 12:if(!u){e.next=18;break}return e.next=15,j({fileToken:u,blockManager:r,recordId:c,transactionName:"replaceImageToken2",needCopyImage:!0});case 15:return e.abrupt("return");case 18:if(!v){e.next=24;break}return e.next=21,N({blockManager:r,imageManager:i,recordId:c,file:v,imageUploader:m,source:x.Z.Paste});case 21:return e.abrupt("return");case 24:if(!d){e.next=41;break}if(!d.startsWith("file://")){e.next=27;break}throw new Error("[image] paste image failed, invalid source url which starts with file://");case 27:if(!Object(h.o)(d)){e.next=32;break}return k=Object(h.V)(d),e.next=31,N({blockManager:r,imageManager:i,recordId:c,file:k,imageUploader:m,source:x.Z.Paste});case 31:return e.abrupt("return");case 32:if(!f.S.isMobile||!d.startsWith("docsource://")){e.next=36;break}return O={src:d,uuid:g},C=new S.P(O,c,b.O.IMAGE,Object(y.m)(r)),e.abrupt("return",C.uploadFile((function(e){if(!e||e.code)throw new Error(null===e||void 0===e?void 0:e.message);j({fileToken:e.data.token,blockManager:r,recordId:c,transactionName:"flowbaseRecordOnPaste",needCopyImage:!0})})));case 36:return I=r.getBlockIdsByRecordId(c)[0],_=!0,e.next=40,U({blockManager:r,imageManager:i,blockId:I,recordId:c,src:d,imageUploader:m});case 40:return e.abrupt("return");case 41:e.next=53;break;case 43:if(e.prev=43,e.t0=e.catch(4),B=e.t0,T=r.getBlockIdsByRecordId(c)[0],!r.hasBlockModelByBlockId(T)){e.next=52;break}return w=r.getBlockModelByBlockId(T),e.next=51,r.applyTransaction("removeImageUploadPlaceholder",(function(e){w.parent&&e.removeChildren(w.parent.record.id,[c])}),{undoable:!1});case 51:!_&&L(d,B);case 52:l&&l(B);case 53:return e.prev=53,s&&s(),e.finish(53);case 56:case"end":return e.stop()}}),e,null,[[4,43,53,56]])})))).apply(this,arguments)}function L(e,n){n.code!==b.g.COPY_ATTACHMENT||f.S.isMobile?n.code!==b.g.USER_NO_DRIVE&&n.code!==b.g.USER_DRIVE||f.S.isMobile?n.code!==b.g.SPACE||f.S.isMobile?Object(k.l)(n)||(e&&e.startsWith("file://")?Object(s.h)({content:t("CreationDoc_DocX_Paste_FromLocalFailed_retry_toast"),errorContext:Object(m.G)(n,new Error("onPasteRecordAfterAccepted failed!"))}):Object(p.S)(t("etherpad.upload_failed"))||Object(s.h)({content:t("common.upload_image_failed"),errorContext:Object(m.G)(n,new Error("onPasteRecordAfterAccepted failed!"))})):l.showPicLimitDialog&&Object(l.showPicLimitDialog)(l.PicLimitType.STORAGE_SPACE,{type:l.StorageSpaceType.UPLOAD_FILE}):l.showUserLimitDialog&&Object(l.showUserLimitDialog)(b.O.IMAGE):l.showPicLimitDialog&&Object(l.showPicLimitDialog)(l.PicLimitType.STORAGE_SPACE,{type:l.StorageSpaceType.UPLOAD_FILE})}function N(e){return F.apply(this,arguments)}function F(){return(F=c()(o.a.mark((function e(n){var r,i,c,a,l,s,u,d,f,h,p;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.blockManager,i=n.file,c=n.imageUploader,a=n.imageManager,l=n.source,s=n.recordId,u=r.getBlockIdsByRecordId(s)[0],d=r.getBlockModelByBlockId(u).record.snapshot,f=d?d.image.scale:1,e.next=6,B(i);case 6:return(h=e.sent).image.scale=f,p={scale:f},e.next=11,r.applyTransaction("replaceImageInfo",(function(e){e.replace(s,["image"],h.image)}),{undoable:!1});case 11:return e.next=13,R(r,c,a,"uploadImageAtPlaceholder",u,i,l,p);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){return H.apply(this,arguments)}function H(){return H=c()(o.a.mark((function e(n){var r,i,s,u,d,f,p,v;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.blockManager,i=n.imageManager,s=n.blockId,u=n.recordId,d=n.src,f=n.imageUploader,p=r.getBlockViewByBlockIdNotCheck(s),Object(C.y)(d)){e.next=7;break}return e.next=5,Object(h.L)(d);case 5:v=e.sent,null===p||void 0===p||p.setExternalImageState(d,v);case 7:return e.abrupt("return",new Promise((function(e,n){i.externalSaver.addTask(s,u,d,function(){var i=c()(o.a.mark((function i(c,s){var d,h,v,b;return o.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(c===I.g.SUCCESS&&s){o.next=3;break}return n(new Error("[image] save external image fail")),o.abrupt("return");case 3:return d="/api".concat(g.r.downloadImage).concat(s,"?mount_node_token=").concat(u,"&mount_point=docx_image"),h=Object(l.prependAPI)(d,"drive_api"),o.next=7,f.downloadImage(h);case 7:return v=o.sent,o.next=10,B(v);case 10:return b=o.sent,Object.assign(b.image,{token:s}),o.next=14,r.applyTransaction("replaceImageInfoOnSuccess",(function(e){e.replace(u,["image"],b.image)}),{from:a.H.local,undoable:!1});case 14:null===p||void 0===p||p.loadImage(!0),null===p||void 0===p||p.hideExternalMask(),e();case 17:case"end":return o.stop()}}),i)})));return function(e,n){return i.apply(this,arguments)}}())})));case 8:case"end":return e.stop()}}),e)}))),H.apply(this,arguments)}function V(e,n,r){var o=r.image,i=r.driveToken,c=r.src;if(o){var a=o.token,l=o.width,s=o.height,u=o.mimeType,d=o.scale;null===e||void 0===e||e.setUploadBackground(Object(h.c)({fileId:a,recordId:n,width:l,height:s,scale:d,imageType:u}))}else(i&&c||f.S.isMobile&&c&&c.startsWith("docsource://"))&&(null===e||void 0===e||e.setUploadBackground(c))}}).call(this,r("dx_E9Eu"))},dx_AiiH:function(e,n,r){"use strict";(function(t){r.d(n,"Y",(function(){return ae}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_J4zp"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_PJYZ"),p=r.n(h),v=r("dx_iWIM"),g=r.n(v),b=r("dx_W7W2"),y=r.n(b),m=r("dx_a1gu"),_=r.n(m),k=r("dx_Nsbk"),O=r.n(k),x=r("dx_lSNA"),E=r.n(x),S=r("dx_PcQO"),C=r("dx_TSYQ"),I=r.n(C),B=r("dx_UtDZ"),T=r("dx_h6a8"),w=r("dx_cDcd"),R=r.n(w),M=r("dx_bdgK"),j=r("dx_C7Cb"),D=r("dx_yzqx"),A=r("dx_luPr"),P=r("dx_B28d"),L=r("dx_MGoZ"),N=r("dx_FvGq"),F=r("dx_og6C"),U=r("dx_Ogyw"),H=r("dx_N25N"),V=r("dx_D8nn"),W=r("dx_sNGG"),z=r("dx_Bs5u"),G=r("dx_UTG8"),K=r("dx_Udhu"),q=r("dx_xIqD"),X=r("dx_z2zF"),Y=r("dx_uFpl"),J=r("dx_Geeh"),Z=r("dx_rriR"),Q=r("dx_D2DF"),$=r("dx_CQNR"),ee=r("dx_ZeFe");r("dx_peiN");function te(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=O()(e);if(n){var i=O()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return _()(this,r)}}function ne(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function re(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ne(Object(r),!0).forEach((function(n){E()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var oe=[{label:t("CreationDoc_Docs_Block_CanViewAfter_Options"),value:ee.j.afterPoll},{label:t("CreationDoc_Docs_Block_CanViewBefore_Options"),value:ee.j.beforePoll}],ie=[{label:t("CreationDoc_Docs_Poll_Type_Open"),value:"0"},{label:t("CreationDoc_Docs_Poll_Type_Anon"),value:"1"}];function ce(e){var n=e.disabled,r=e.onClick,o=re({},e),i=Object(w.useCallback)((function(e){r&&(n||r(e))}),[n,r]);return delete o.onClick,o.style=re(re({},e.style||{}),{},{pointerEvents:n?"none":void 0}),R.a.createElement("div",{onClick:i},R.a.createElement(S.Button,o))}var ae=function(e){y()(r,e);var n=te(r);function r(){var e;u()(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=n.call.apply(n,[this].concat(a))).state={isEditing:!1,isPublish:!1,isAnonymous:e.record.snapshot.is_anonymous,isCurrentUserCreated:!1,publishLoading:!1,isSelected:!1,containerClipPath:"none"},e.ref=null,e.pollHeaderInputRef=null,e.layoutElement=null,e.pollFooterRef=R.a.createRef(),e.wrapperResizeObserver=null,e.isResizing=!1,e.resizingTimeout=null,e.cacheElementHeight=0,e.renderFinishNotifier=null,e.triggerWhenCreateNewPoll=function(){e.setState({isEditing:!0,isPublish:!1,cacheData:e.getDefaultCacheData(),isCurrentUserCreated:!0}),setTimeout((function(){e.focusInput()}))},e.getViewSnapshot=function(){return e.ref},e.handleBlockStructChange=function(){var n;null===(n=e.pollFooterRef.current)||void 0===n||n.resize()},e.handleMobileKeyboardChange=function(n){var r=n.keyboardType;if(n.isOpenKeyboard&&r!==K.F.PollInputFocus&&e.ref){var o=document.activeElement;if(o&&o.classList.contains("poll-input-textarea")&&e.ref.contains(o)){n.keyboardType=K.F.PollInputFocus;var i=e.props.recursionProps.rect.getBlockRect(e.id),c=o.closest(".poll-block-option__item");if(c){for(var a=0;c&&c!==e.ref;)a+=c.offsetTop,c=c.parentElement;var l=o.getBoundingClientRect(),s=l.x,u=l.height,d=l.left,f=l.right,h=l.width,p=i.top+a,v={x:s,y:p,height:u,top:p,bottom:p+u,left:d,right:f,width:h};Object(F.R)({rectInfo:v})}}}},e.setRef=function(n){var r,o;n||(null===(o=e.ref)||void 0===o||o.removeEventListener("keydown",e.handleKeyDown));e.ref=n,null===(r=e.ref)||void 0===r||r.addEventListener("keydown",e.handleKeyDown)},e.handleClickOutside=function(n){var r,o=p()(e).ref;if(e.state.isEditing&&o&&(null===(r=e.state.cacheData)||void 0===r?void 0:r.isPublish)){var i=n.target;o.contains(i)||(e.setState({isEditing:!1}),e.props.recursionProps.eventEmitter.emit(W.Y.HIGHLIGHT_UPDATE))}},e.getOptionProgress=function(n){var r=e.state.cacheData.optionMap,o=e.record.snapshot.option_ids.reduce((function(e,n){return r[n]?e+r[n].count:e}),0);return 0===o?0:Number((n/o*100).toFixed(1))},e.getIsOverMaxOptionLength=function(e){return e>=702},e.getOptionOrderTextByIndex=function(n){if(!e.getIsOverMaxOptionLength(n))return function e(n){return n<=26?String.fromCharCode(n+64):e(~~((n-1)/26))+e(n%26||26)}(n+1)},e.handleTitleChange=function(n){e.blockManager.applyTransaction("changePollTitle",(function(r){r.replace(e.record.id,["title"],n)}))},e.hasCurrentUserVote=function(){var n=q.T.getCurrentVotes(e.realRecordId);return n&&Object.entries(n).some((function(n){var r=l()(n,2),o=r[0],i=r[1];return e.record.snapshot.option_map[o]&&i.emojiId}))},e.handleOptionEmojiChange=function(n,r){var o={},i=e.props.record.snapshot.poll_type===ee.v.single;if(o[n]={emojiId:r},""!==r&&i&&e.props.record.snapshot.option_ids.forEach((function(e){e!==n&&(o[e]={emojiId:void 0})})),e.hasCurrentUserVote())e.requestVoteOptions(o);else{var c=e.state,a=c.localCurrentUser,l=c.cacheData,s=Object(T.cloneDeep)(l);a&&(s=Object.assign({},s,{currentUser:a}));var u=q.T.getCurrentUserIdByBlockId(e.realRecordId),d=q.T.getUpdatedVoteData(s,{block_id:e.realRecordId,token:"",type:"",operation:X.G.vote,user_count:s.userCount,user_choice:{user_id:u,avatar_url:s.currentUserAvatar,option_map:Object.keys(o).reduce((function(e,n){return re(re({},e),{},E()({},n,{emoji_id:o[n].emojiId}))}),{})}});e.setState({localCurrentUser:d.currentUser})}},e.requestVoteOptions=function(n){q.T.updatePollVote(e.realRecordId,n),e.setState({localCurrentUser:void 0})},e.handleFetchVotesData=function(){var n=c()(o.a.mark((function n(r){var i;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,q.T.getOptionVotesDetail({blockId:e.realRecordId,optionId:r});case 2:(i=n.sent)&&e.setState({cacheData:i});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.handleVote=function(n){n.stopPropagation();var r=e.state.localCurrentUser;if(r){var o=p()(e).realRecordId,i=q.T.getCurrentVotes(o);if(i){var c=Object.entries(r).reduce((function(e,n){var o=l()(n,2),c=o[0],a=o[1];if(!i[c])return e[c]=a,e;var s=r[c].emojiId;return s!==i[c].emojiId&&(e[c]={emojiId:s}),e}),{});Object.keys(c).length&&e.requestVoteOptions(c)}}else console.error("can not find local user select\uff01")},e.handleOptionTextChange=function(n,r){e.blockManager.applyTransaction("changePollOptionText",(function(o){o.replace(e.record.id,["option_map",n,"text"],r)}))},e.handleOptionRemove=function(n){var r=e.record.snapshot.option_ids.findIndex((function(e){return e===n}));r<0?console.error("\u627e\u4e0d\u5230\u9700\u8981 remove \u7684 option"):e.blockManager.applyTransaction("deletePollOption",(function(o){o.remove(e.record.id,["option_ids",r]),o.remove(e.record.id,["option_map",n])}))},e.handleWhenVisibleChange=function(n){e.record.snapshot.when_result_visible!==n&&e.blockManager.applyTransaction("changePollWhenResultVisible",(function(r){r.replace(e.record.id,["when_result_visible"],n)}))},e.getActualAnonymous=function(){var n=e.state,r=n.isAnonymous,o=n.isPublish,i=e.props.record.snapshot.is_anonymous;return o?r:i},e.handleIsAnonymousChange=function(n){var r=e.getActualAnonymous(),o="1"===n;r!==o&&e.blockManager.applyTransaction("changePollIsAnonymous",(function(n){n.replace(e.record.id,["is_anonymous"],o)}))},e.handlePublishButtonClick=function(){var n=c()(o.a.mark((function n(r){var i,c,a;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.stopPropagation(),e.setState({publishLoading:!0}),n.next=4,q.T.updatePollPublish(e.realRecordId);case 4:i=n.sent,(c=Object(T.cloneDeep)(e.state.cacheData)).isPublish=!0,a={isEditing:!1,isPublish:!0},i?e.handleVotesChange(i,!0):(c.isAnonymous=e.record.snapshot.is_anonymous,c.creatorId=B.userHelper.getCurrentUser().get("id"),a.cacheData=re({},c),a.isAnonymous=e.record.snapshot.is_anonymous),e.setState(re(re({},a),{},{publishLoading:!1})),e.props.recursionProps.eventEmitter.emit(W.Y.HIGHLIGHT_UPDATE);case 11:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.handleAddOption=function(){var n=c()(o.a.mark((function n(r){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return null===r||void 0===r||r.stopPropagation(),n.next=3,e.blockManager.applyTransaction("addPollOption",(function(n){var r=Object(j.S)(),o=e.record.snapshot.option_ids.length;n.insert(e.record.id,["option_ids",o],r),n.insert(e.record.id,["option_map",r],{id:r,text:G.InputPipe.createEmptyClientVars()})}));case 3:e.handleFocusLast();case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.handleEditClick=function(n){n.stopPropagation(),e.setState({isEditing:!0}),setTimeout((function(){e.focusInput()})),e.props.recursionProps.eventEmitter.emit(W.Y.HIGHLIGHT_UPDATE)},e.handleFocusLast=function(){var n,r="".concat(e.record.id,"-").concat(Q.h),o=document.querySelectorAll('textarea[name="'.concat(r,'"]')),i=o.item(o.length-1);null===i||void 0===i||null===(n=i.focus)||void 0===n||n.call(i)},e.handleFocusNext=function(n){var r;n.preventDefault(),n.stopPropagation();var o="".concat(e.record.id,"-").concat(Q.h),i=document.activeElement;if(i&&(null===(r=e.ref)||void 0===r?void 0:r.contains(i))){var c=Array.from(document.querySelectorAll('textarea[name="'.concat(o,'"]'))),a=c.findIndex((function(e){return e===i}));if(-1!==a){var l=c[Math.min(a+1,c.length-1)];l.focus&&l.focus()}if(a<0){var s,u=c[0];null===u||void 0===u||null===(s=u.focus)||void 0===s||s.call(u)}else a===c.length-1&&"Enter"===n.key&&"Enter"===n.code&&e.handleAddOption()}},e.handleFocusPrevious=function(n){var r;n.preventDefault(),n.stopPropagation();var o="".concat(e.record.id,"-").concat(Q.h),i=document.activeElement;if(i&&(null===(r=e.ref)||void 0===r?void 0:r.contains(i))){var c=Array.from(document.querySelectorAll('textarea[name="'.concat(o,'"]'))),a=c.findIndex((function(e){return e===i}))-1;if(a>-1){var l,s=c[a];null===s||void 0===s||null===(l=s.focus)||void 0===l||l.call(s)}else if(a<-1){var u,d=c[c.length-1];null===d||void 0===d||null===(u=d.focus)||void 0===u||u.call(d)}}},e.handleKeyDown=function(n){n.stopPropagation(),("Tab"===n.key&&"Tab"===n.code&&!n.shiftKey||"Enter"===n.key&&"Enter"===n.code)&&e.handleFocusNext(n),"Tab"===n.key&&"Tab"===n.code&&n.shiftKey&&e.handleFocusPrevious(n)},e.getShouldShowPollResult=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.hasCurrentUserVote(),r=e.state.isEditing;if(r)return!1;var o=e.props.record.snapshot.when_result_visible;if(e.props.recursionProps.isShortcut)return o===ee.j.beforePoll;if(o===ee.j.beforePoll)return!0;var i=q.T.getCurrentVotes(e.realRecordId);return!!i&&n},e.notifyNodeHeightChange=function(){e.model.isDestroyed||e.blockManager.layoutManager.notifyNodeHeightChange(e.id)},e.renderEditingConfig=function(){var n=e.getActualAnonymous(),r=e.state.cacheData.isPublish,o=e.state.isEditing,i=e.props.recursionProps.isHistory;return R.a.createElement("div",{className:"poll-block__editor",style:{height:o&&!i?268:0,display:o&&!i?"block":"none"}},R.a.createElement("div",{className:"poll-block__adder"},R.a.createElement("span",{className:"poll-block-adder__text",onClick:e.handleAddOption},"+ ",t("block.poll_add_option"))),R.a.createElement("hr",{className:"poll-block__line"}),R.a.createElement(Y.X,{title:t("CreationDoc_Docs_Poll_Type"),style:{marginBottom:20},disabled:r,options:ie,value:n?"1":"0",onChange:e.handleIsAnonymousChange}),R.a.createElement(Y.X,{title:"".concat(t("CreationDoc_Docs_Block_VotingResult_Title")),disabled:!1,options:oe,value:e.props.record.snapshot.when_result_visible,onChange:e.handleWhenVisibleChange}))},e.renderNotEditingFooterContent=function(){var n=e.state.localCurrentUser,r=e.state.cacheData,o=r.userCount,i=r.currentUser,c=e.hasCurrentUserVote(),a=e.getShouldShowPollResult(c),s=!0;if(n){var u=Object.values(i).filter((function(e){return e.emojiId})),d=Object.values(n).filter((function(e){return e.emojiId}));s=u.length===d.length&&(0===u.length||Object.entries(u).some((function(e){var n=l()(e,2),r=n[0];return n[1].emojiId===d[r].emojiId})))}return R.a.createElement(R.a.Fragment,null,a&&R.a.createElement("div",{className:"poll-block__count"},t("CreationDoc_Docs_Poll_Voted_Num",void 0,void 0,o.toString())),!c&&R.a.createElement(ce,{block:!0,color:"primary",disabled:s,className:"poll-block__button",onClick:e.handleVote},t("CreationDoc_Docs_Poll_Vote_Btn")))},e.handlePollBlockClick=function(n){var r,o;null===(r=(o=e.props).onBlockClick)||void 0===r||r.call(o,n)},e.getCurrentUserOptionEmoji=function(n){var r,o=e.state,i=o.cacheData;return(null===(r=(o.localCurrentUser||i.currentUser)[n])||void 0===r?void 0:r.emojiId)||""},e}return f()(r,[{key:"handleVotesError",value:function(){A.R.reportBlockLoadError({id:this.model.id,type:this.model.type})}},{key:"blockViewDidMount",value:function(){var e,n;g()(O()(r.prototype),"blockViewDidMount",this).call(this),null===(e=(n=this.props).onBlockReady)||void 0===e||e.call(n);var o=q.T.getCacheData(this.realRecordId);if(o&&this.handleVotesChange(o,!1),this.props.recursionProps.isPreview)if(this.props.recursionProps.isPresentationMode);else{var i=this.getDefaultCacheData();i.isPublish=!0,this.setState({isPublish:!0,cacheData:i})}else q.T.onVotesChange(this.realRecordId,this.blockManager,this.handleVotesChange.bind(this),this.handleVotesError.bind(this));document.addEventListener("mouseup",this.handleClickOutside),document.addEventListener("touchstart",this.handleClickOutside),V.s.on(V.p.MOBILE.COMMON.KEYBOARD_CHANGED,this.handleMobileKeyboardChange),this.blockManager.addListener(N.f,this.handleBlockStructChange),this.wrapperResizeObserver=new M.S(this.handleWrapperResize.bind(this)),this.layoutElement&&this.wrapperResizeObserver.observe(this.layoutElement)}},{key:"blockViewWillUnmount",value:function(){var e,n;g()(O()(r.prototype),"blockViewWillUnmount",this).call(this),document.removeEventListener("mouseup",this.handleClickOutside),document.removeEventListener("touchstart",this.handleClickOutside),null===(e=this.ref)||void 0===e||e.removeEventListener("keydown",this.handleKeyDown),V.s.off(V.p.MOBILE.COMMON.KEYBOARD_CHANGED,this.handleMobileKeyboardChange),this.blockManager.removeListener(N.f,this.handleBlockStructChange),null===(n=this.wrapperResizeObserver)||void 0===n||n.disconnect()}},{key:"handleVotesChange",value:function(e,n){var r=this.state.isPublish,o=e.isPublish,i=e.creatorId,c={cacheData:e,isPublish:o,isAnonymous:e.isAnonymous,isCurrentUserCreated:B.userHelper.getCurrentUser().get("id")===i};o||!c.isCurrentUserCreated||D.S.isMobile||(c.isEditing=!0),!r&&o&&(c.isEditing=!1),n&&(c.localCurrentUser=void 0),this.setState(c)}},{key:"resizeFinishPromise",value:function(){var e=this;return new Promise((function(n){var r=function r(){e.isResizing?setTimeout((function(){r()}),200):n()};setTimeout((function(){r()}),200)}))}},{key:"getIsRenderFinished",value:function(){return Boolean(this.state.cacheData)}},{key:"blockViewDidUpdate",value:function(){this.renderFinishNotifier&&this.getIsRenderFinished()&&(this.renderFinishNotifier.notify(),this.renderFinishNotifier=null)}},{key:"awaitRenderFinished",value:function(){if(this.getIsRenderFinished())return Promise.resolve();if(!this.renderFinishNotifier){var e,n=new Promise((function(n){e=n}));this.renderFinishNotifier={promise:n,notify:e}}return this.renderFinishNotifier.promise}},{key:"setHovered",value:function(e){if(this.hostElement)if(e){var n;if(this.hostElement.classList.contains("selected"))return;var r=L.l.getMaskDom();r.className="hovered-mask",r.style.backgroundColor="rgba(51, 112, 255, 0.1)",this.hostElement.classList.add("hovered"),null===(n=this.ref)||void 0===n||n.appendChild(r)}else{this.hostElement.classList.remove("hovered");var o=this.hostElement.querySelector(".hovered-mask");null===o||void 0===o||o.remove()}}},{key:"focusInput",value:function(){var e;null===(e=this.pollHeaderInputRef)||void 0===e||e.focus()}},{key:"getDefaultCacheData",value:function(){return{isPublish:!1,isAnonymous:this.props.record.snapshot.is_anonymous,optionMap:{},currentUser:{},currentUserAvatar:"",currentUserId:"",creatorId:B.userHelper.getCurrentUser().get("id"),userCount:0,voteCount:0,pollType:this.props.record.snapshot.poll_type}}},{key:"handleWrapperResize",value:function(e){var n,r=this;this.resizingTimeout&&(clearTimeout(this.resizingTimeout),this.resizingTimeout=null),this.isResizing=!0,null===(n=this.pollFooterRef.current)||void 0===n||n.resize(e);var o=e[0].target,i=null===o||void 0===o?void 0:o.clientWidth;if(0!==i){var c=o.clientHeight;c!==this.cacheElementHeight&&(this.notifyNodeHeightChange(),this.cacheElementHeight=c);var a="none";void 0===i||this.props.recursionProps.isPresentationMode||(a="polygon(-4px -4px, ".concat(i+4,"px -4px, ").concat(i+4,"px calc(100% + 4px), -4px calc(100% + 4px))")),this.setState({containerClipPath:a},(function(){r.resizingTimeout&&(clearTimeout(r.resizingTimeout),r.resizingTimeout=null),r.resizingTimeout=setTimeout((function(){r.isResizing=!1}),200)}))}else this.isResizing=!1}},{key:"setSelected",value:function(e){this.setState({isSelected:e})}},{key:"render",value:function(){var e,n=this,r=this.state,o=r.cacheData,i=r.isEditing,c=r.containerClipPath,a=r.publishLoading,l=r.isSelected,s=this.props.loadingComponent,u=this.props.record.snapshot,d=u.poll_type,f=u.title,h=u.option_ids,p=u.option_map,v=this.props.recursionProps,g=v.isHistory,b=v.isSSR,y=v.isPresentationMode,m=this.getActualAnonymous(),_=!D.S.isMobile&&this.editable,k=this.hasCurrentUserVote(),O=!g&&this.getShouldShowPollResult(k),x=!!this.props.recursionProps.isPreview,S=!i&&!!o&&!o.isPublish,C=!o,B=this.props.record.snapshot.title.initialAttributedTexts.text[0].length,T=this.shouldShowPublish,w=!g&&h.length>1,M=!g&&!y&&i;return R.a.createElement("div",{ref:function(e){n.layoutElement=e},className:I()("poll-block__layout",{"justify-left":this.alignType===P.D.LEFT,"justify-center":this.alignType===P.D.CENTER,"justify-right":this.alignType===P.D.RIGHT})},R.a.createElement("div",Object.assign({className:I()("poll-block__container",U.B,(e={},E()(e,H.X,D.S.isMobile),E()(e,"loading",C),E()(e,"selected",l),e)),style:{minWidth:D.S.isMobile||b?0:320,clipPath:c,WebkitClipPath:c,boxShadow:this.borderColor?"0 0 0 1px ".concat(this.borderColor):void 0},ref:this.setRef},C?null:{onClick:this.handlePollBlockClick}),C?s:R.a.createElement(R.a.Fragment,null,R.a.createElement(Z.Q,{ref:function(e){n.pollHeaderInputRef=e},recordId:this.record.id,canEdit:_,isAnonymous:m,pollType:d,defaultTitle:i?void 0:t("CreationDoc_Docs_Poll_Untitled"),value:f,onChange:this.handleTitleChange,editable:i,isHistory:g,unPublishVisible:!x&&S,onEditClick:this.handleEditClick}),R.a.createElement("div",{className:"poll-block__content"},R.a.createElement("div",{className:"poll-block__option"},h.map((function(e,r){var i=n.getOptionOrderTextByIndex(r);if(!i)return null;var c=p[e],a=c.text,l=c.id,s=o.optionMap[e]||{count:0,currentUserEmoji:void 0,votes:[]},u=s.count,f=s.votes;return R.a.createElement($.j,{recordId:n.record.id,className:I()("poll-block-option__item"),id:l,key:l,isCurrentUserVoted:k,voteResultVisible:O,isEdit:M,isAnonymous:m,isPublished:null===o||void 0===o?void 0:o.isPublish,isHistory:g,isMultiple:d===ee.v.multiple,progress:n.getOptionProgress(u),emojiId:n.getCurrentUserOptionEmoji(e),votes:f,text:a,order:i,disabled:!y&&(g||x||S),onEmojiChange:n.handleOptionEmojiChange,onTextChange:n.handleOptionTextChange,onRemove:n.handleOptionRemove,deleteButtonVisible:w,total:u,onFetchVotes:n.handleFetchVotesData})}))),this.renderEditingConfig()),R.a.createElement(J.A,{ref:this.pollFooterRef,pollBlockContainer:this.ref},!M&&!S&&!g&&!x&&this.renderNotEditingFooterContent(),T&&R.a.createElement(ce,{block:!0,disabled:!B,className:"poll-block__button",onClick:this.handlePublishButtonClick,loading:a},t("CreationDoc_Docs_Poll_Generate_Btn"))))))}},{key:"alignType",get:function(){var e=this.record.snapshot.align;return Object.values(P.D).includes(e)?e:P.D.LEFT}},{key:"realRecordId",get:function(){if(this.props.recursionProps.isHistory){var e=this.record.snapshot[z.B];if(e&&"string"===typeof e)return e}return this.record.id}},{key:"isBlockRendered",get:function(){return this.getIsRenderFinished()}},{key:"contentElement",get:function(){return this.hostElement.querySelector(".poll-block__container")}},{key:"shouldShowPublish",get:function(){var e=this.state,n=e.cacheData,r=e.isCurrentUserCreated,o=this.props.recursionProps,i=o.isHistory,c=o.isPresentationMode;return!i&&!c&&n&&!n.isPublish&&r&&!D.S.isMobile}},{key:"borderColor",get:function(){var e=this.props,n=e.syncCursorSelected,r=e.syncCursorBorderColor;return!this.state.isSelected&&n?r:void 0}}]),r}(L.l)}).call(this,r("dx_E9Eu"))},dx_Am54:function(e,n,r){"use strict";r.d(n,"S",(function(){return d}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r("dx_rQGm"),l=r("dx_D8nn"),s=r("dx_k7kY"),u=r("dx_Q4WO");function d(e,n){var r=n.blockManager,o=n.isDelayEnter,d=n.delayTime,f=void 0===d?500:d,h=n.selectionAPI,p=n.eventEmitter,v=n.hoverBlockManager,g=Object(c.useState)(!1),b=i()(g,2),y=b[0],m=b[1],_=Object(c.useState)(!0),k=i()(_,2),O=k[0],x=k[1],E=Object(c.useRef)(new DOMRect(0,0,0,0)),S=Object(c.useRef)(null),C=Object(c.useRef)({x:-1,y:-1}),I=Object(c.useCallback)((function(n){n?p.emit(a.V0):S.current&&(window.clearTimeout(S.current),S.current=null),e&&e.setHovered(n),m((function(e){return e===n||n||(l.X.hasEnteredPanel=!1,p.emit(a.s),C.current={x:-1,y:-1}),n}))}),[e,p]);Object(c.useEffect)((function(){null===v||void 0===v||v.update(e),I(!1)}),[I,e,v]);var B=Object(c.useCallback)((function(){r.dispatch("MENU_TRIGGER_ENTER",e);var n=function(){h.isFocus()||h.restoreFocus(),x(!1),p.emit(a.t,{blockId:null===e||void 0===e?void 0:e.id}),I(!0)};if(o){S.current&&(clearTimeout(S.current),S.current=null);var i=setTimeout(n,f);S.current=i}else n()}),[r,e,o,h,I,f,p]),T=Object(c.useCallback)((function(){o&&(clearTimeout(S.current),S.current=null),r.dispatch("MENU_TRIGGER_LEAVE"),x(!0);var e=document.querySelector(s.h);E.current=e?e.getBoundingClientRect():new DOMRect(0,0,0,0)}),[r,o]),w=Object(c.useCallback)((function(e){var n;if(y&&O&&!l.X.hasEnteredPanel&&!(null===(n=e.target)||void 0===n?void 0:n.closest(".overlay-wrapper"))){var r=E.current;if(!(e.x<=r.right&&e.x>=r.left&&e.y<=r.bottom&&e.y>=r.top)){var o=C.current;if(C.current={x:e.x,y:e.y},-1!==o.x||-1!==o.y){var i=e.x-o.x,c=e.y-o.y;Object(u.o)({orgX:o.x,orgY:o.y,dirX:i,dirY:c},{minX:r.left,minY:r.top,maxX:r.right,maxY:r.bottom})||I(!1)}}}}),[O,I,y]);return Object(c.useEffect)((function(){return document.documentElement.addEventListener("mousemove",w),function(){document.documentElement.removeEventListener("mousemove",w)}}),[w]),[y,I,B,T]}},dx_Ap6o:function(e,n,r){"use strict";r.d(n,"x",(function(){return s})),r.d(n,"X",(function(){return d}));var o=r("dx_TSYQ"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c),l=(r("dx_EfDq"),"docx-bookmark");function s(e){var n=e.title,r=e.icon,o=e.summary,c=e.url,s=e.onClick,d=e.display,f=e.shouldShowCover,h=i()("".concat(l,"-card"),{column:"column"===d});return a.a.createElement("div",{className:h,onClick:s},f&&a.a.createElement(u,e),a.a.createElement("div",{className:"".concat(l,"-info")},a.a.createElement("div",{className:"".concat(l,"-url-wrapper")},r&&a.a.createElement("span",{className:"".concat(l,"-icon"),style:{backgroundImage:"url(".concat(r,")")}}),a.a.createElement("span",{className:"".concat(l,"-url")},c)),a.a.createElement("div",{className:"".concat(l,"-detail")},a.a.createElement("span",{className:"".concat(l,"-title")},n),a.a.createElement("br",null),o&&a.a.createElement("span",{className:"".concat(l,"-summary")},o))))}function u(e){var n={};return e.shouldLoadCover&&(n.backgroundImage="url(".concat(e.cover_url,")")),e.cover_width&&e.cover_height&&(e.cover_width/e.cover_height>=.5?n.backgroundPositionY="center":n.backgroundPositionY="top"),a.a.createElement("div",{className:"".concat(l,"-cover"),style:n})}function d(e){var n=e.url;return a.a.createElement("div",{className:"".concat(l,"-card loading")},a.a.createElement("div",{className:"".concat(l,"-url-wrapper")},a.a.createElement("span",{className:"".concat(l,"-icon")}),a.a.createElement("span",{className:"".concat(l,"-url")},n)),a.a.createElement("div",{className:"".concat(l,"-skeleton-item"),style:{maxWidth:"350px"}}),a.a.createElement("div",{className:"".concat(l,"-skeleton-item")}),a.a.createElement("div",{className:"".concat(l,"-skeleton-item"),style:{maxWidth:"576px"}}))}},dx_ApwS:function(e,n,r){"use strict";r.d(n,"R",(function(){return me}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_RIqP"),v=r.n(p),g=r("dx_Vvd7"),b=r("dx_tt0H"),y=r("dx_N9dL"),m=r("dx_L0LN"),_=r("dx_y62y"),k=r("dx_lSNA"),O=r.n(k),x=r("dx_n4v0");function E(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function S(e,n){return Object(x.D)(function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?E(Object(r),!0).forEach((function(n){O()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({folded:!1},e),n)}var C=r("dx_B28d"),I=r("dx_KHvq");function B(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var T=function(e){s()(r,e);var n=B(r);function r(e){return i()(this,r),n.call(this,e)}return r}(I.H);function w(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}T.type=C.B.HEADING1;var R=function(e){s()(r,e);var n=w(r);function r(e){return i()(this,r),n.call(this,e)}return r}(I.H);function M(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}R.type=C.B.HEADING2;var j=function(e){s()(r,e);var n=M(r);function r(e){return i()(this,r),n.call(this,e)}return r}(I.H);function D(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}j.type=C.B.HEADING3;var A=function(e){s()(r,e);var n=D(r);function r(e){return i()(this,r),n.call(this,e)}return r}(I.H);function P(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}A.type=C.B.HEADING4;var L=function(e){s()(r,e);var n=P(r);function r(e){return i()(this,r),n.call(this,e)}return r}(I.H);function N(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}L.type=C.B.HEADING5;var F=function(e){s()(r,e);var n=N(r);function r(e){return i()(this,r),n.call(this,e)}return r}(I.H);function U(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}F.type=C.B.HEADING6;var H=function(e){s()(r,e);var n=U(r);function r(e){return i()(this,r),n.call(this,e)}return r}(I.H);function V(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}H.type=C.B.HEADING7;var W=function(e){s()(r,e);var n=V(r);function r(e){return i()(this,r),n.call(this,e)}return r}(I.H);function z(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}W.type=C.B.HEADING8;var G=function(e){s()(r,e);var n=z(r);function r(e){return i()(this,r),n.call(this,e)}return r}(I.H);G.type=C.B.HEADING9;var K,q=r("dx_xjz2"),X=r("dx_JXmB");function Y(e){if("UPDATE_ATTRIBUTE"!==e.action.type)return!0;var n=e.action,r=n.changedKey,o=n.newValue;if("folded"===r){var i=e.record,c=e.modelService.getBlockModelsByRecordId(i.id)[0];if(!c)return!1;if(!1===c.snapshot.folded&&!0===o&&!Object(X.e)(c))return!1}else if("type"===r){var a=e.record,l=e.modelService.getBlockModelsByRecordId(a.id)[0];if(!l)return!1;var s=l.type,u=parseInt(/heading(\d)/.exec(s)[1],10),d=/heading(\d)/.test(o)?parseInt(/heading(\d)/.exec(o)[1],10):null;if((null===d||u<d)&&!Object(X.U)(l))return!1}return!0}var J=Object(q.s)(b.U)(K=function e(n){i()(this,e),this.blockType=n,this.checkFunc=Y})||K,Z=r("dx_wvoI");function Q(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var $=function(e){s()(r,e);var n=Q(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).level=1,e}return a()(r,[{key:"placeholder",get:function(){return"H1"}}]),r}(Z.c);function ee(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var te=function(e){s()(r,e);var n=ee(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).level=2,e}return a()(r,[{key:"placeholder",get:function(){return"H2"}}]),r}(Z.c);function ne(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var re=function(e){s()(r,e);var n=ne(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).level=3,e}return a()(r,[{key:"placeholder",get:function(){return"H3"}}]),r}(Z.c);function oe(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var ie=function(e){s()(r,e);var n=oe(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).level=4,e}return a()(r,[{key:"placeholder",get:function(){return"H4"}}]),r}(Z.c);function ce(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var ae=function(e){s()(r,e);var n=ce(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).level=5,e}return a()(r,[{key:"placeholder",get:function(){return"H5"}}]),r}(Z.c);function le(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var se=function(e){s()(r,e);var n=le(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).level=6,e}return a()(r,[{key:"placeholder",get:function(){return"H6"}}]),r}(Z.c);function ue(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var de=function(e){s()(r,e);var n=ue(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).level=7,e}return a()(r,[{key:"placeholder",get:function(){return"H7"}}]),r}(Z.c);function fe(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var he=function(e){s()(r,e);var n=fe(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).level=8,e}return a()(r,[{key:"placeholder",get:function(){return"H8"}}]),r}(Z.c);function pe(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var ve,ge,be=function(e){s()(r,e);var n=pe(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).level=9,e}return a()(r,[{key:"placeholder",get:function(){return"H9"}}]),r}(Z.c);function ye(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var me=(ve=Object(g.H)({providers:[].concat(v()(_.f.map((function(e){return{provide:y.RecordSnapshotCreator,useValue:{type:e,create:function(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return S(n,r)}}}}))),v()(_.f.map((function(e){return{provide:b.U,useClass:J,args:[e]}}))))}),ve(ge=function(e){s()(r,e);var n=ye(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"blocks",get:function(){var e=this.options.getTextEditorOptions();return[[T,{viewCreator:$,options:e}],[R,{viewCreator:te,options:e}],[j,{viewCreator:re,options:e}],[A,{viewCreator:ie,options:e}],[L,{viewCreator:ae,options:e}],[F,{viewCreator:se,options:e}],[H,{viewCreator:de,options:e}],[W,{viewCreator:he,options:e}],[G,{viewCreator:be,options:e}]]}}]),r}(m.h))||ge)},dx_Ayao:function(e,n,r){"use strict";var o,i;r.d(n,"M",(function(){return o})),r.d(n,"K",(function(){return i})),function(e){e.WHOLE_COMMENT_CHANGE="WHOLE_COMMENT_CHANGE",e.HIGHLIGHT_WHOLE_COMMENT="HIGHLIGHT_WHOLE_COMMENT",e.COMMENT_READY="COMMENT_READY",e.ACTIVE_COMMENT_CHANGE_BEFORE_SCROLL="ACTIVE_COMMENT_CHANGE_BEFORE_SCROLL",e.ACTIVE_COMMENT_CHANGE="ACTIVE_COMMENT_CHANGE",e.HOVER_COMMENT_CHANGE="HOVER_COMMENT_CHANGE",e.RESOLVE_COMMENT="RESOLVE_COMMENT",e.DELETE_COMMENT="DELETE_COMMENT",e.ADDED_COMMENT="ADDED_COMMENT",e.ADDED_FALLBACK_COMMENT="ADDED_FALLBACK_COMMENT",e.DELETE_FALLBACK_COMMENT="DELETE_FALLBACK_COMMENT",e.ADD_TEMP_COMMENT="ADD_TEMP_COMMENT",e.UPDATE_COMMENT="UPDATE_COMMENT",e.CANCEL_ADD_COMMENT="CANCEL_ADD_COMMENT",e.REOPEN_COMMENT="REOPEN_COMMENT",e.COMMENT_POSITION_CHANGE="COMMENT_POSITION_CHANGE",e.COMMENT_POSITION_CHANGE_PC="COMMENT_POSITION_CHANGE_PC",e.ACTIVATE_COMMENT="ACTIVATE_COMMENT",e.DEACTIVATE_COMMENT="DEACTIVATE_COMMENT",e.START_NEW_DOC_COMMENT="START_NEW_DOC_COMMENT",e.THIRD_PARTY_COMMENT_LOADED="THIRD_PARTY_COMMENT_LOADED",e.JUMP_REPLY="JUMP_REPLY",e.FOLLOW_SCROLL_TOP_CHANGE="FOLLOW_SCROLL_TOP_CHANGE",e.COMMENT_TRANSACTION_APPLY="COMMENT_TRANSACTION_APPLY"}(o||(o={})),function(e){e.LOCAL="LOCAL",e.REMOTE="REMOTE"}(i||(i={}))},dx_B1B9:function(e,n,r){"use strict";var o,i,c=r("dx_lwsE"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_LzB7"),g=r("dx_yG8O"),b=r.n(g),y=r("dx_W8MJ"),m=r.n(y),_=r("dx_Uyc2"),k=r.n(_),O=(r("dx_A1AB"),r("dx_Xdvu")),x=r("dx_DP1I");function E(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var S,C=(o=function(){function e(){a()(this,e),b()(this,"editorContext",i,this),this.type=void 0}return m()(e,[{key:"apply",value:function(e){return this.editorContext.fold.findFoldedByBlock(e)||e}}]),e}(),i=k()(o.prototype,"editorContext",[O.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o),I=function(e){s()(r,e);var n=E(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).type=x.K.ON_FIRST_BLOCK_IN_PRE_ORDER,e}return r}(C),B=function(e){s()(r,e);var n=E(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).type=x.K.ON_LAST_BLOCK_IN_PRE_ORDER,e}return r}(C);function T(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var w=Object(p.H)({providers:[{provide:v.g,useClass:I},{provide:v.g,useClass:B}]})(S=function(e){s()(r,e);var n=T(r);function r(){return a()(this,r),n.apply(this,arguments)}return r}(p.G))||S;n.S=w},dx_B1Bt:function(e,n,r){"use strict";var o=r("dx_c3cO");r.d(n,"X",(function(){return o.X}));var i=r("dx_SkpS");r.d(n,"Z",(function(){return i.Z}));r("dx_JFWd"),r("dx_ZMwq")},dx_B4B2:function(e,n,r){"use strict";var o=r("dx_UXvI"),i=r("dx_cDcd");n.S=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2?arguments[2]:void 0,c=Object(i.useRef)(e);Object(i.useEffect)((function(){c.current=e}),[e]);var a=Object(i.useMemo)((function(){return Object(o.S)((function(){return c.current.apply(c,arguments)}),n,r)}),[]);return Object(i.useEffect)((function(){return function(){return a.cancel()}}),[a]),a}},dx_B6I0:function(e,n,r){"use strict";r.d(n,"o",(function(){return d}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_h6a8"),s=r("dx_D8nn"),u=function(){function e(n,r){i()(this,e),this.prev=n,this.current=r}return a()(e,[{key:"updateCurrentSelection",value:function(e){this.current=e}}]),e}(),d=function(){function e(){var n=this;i()(this,e),this.commentInteractionForbidden=!1,this.selectionInfo=null,this.selectionChangeCallback=null,this.triggerDebouncedSelectionChange=Object(l.debounce)((function(){var e;(n.commentInteractionForbidden=!1,n.selectionInfo)&&(null===(e=n.selectionChangeCallback)||void 0===e||e.call(n,n.selectionInfo.prev,n.selectionInfo.current),n.removeSelectionInfo())}),10,{leading:!1,trailing:!0}),this.handleSelectingTapStart=function(){n.triggerDebouncedSelectionChange.cancel(),n.commentInteractionForbidden=!0},this.handleSelectingTapStop=function(){n.triggerDebouncedSelectionChange()},this.handleSelectionChange=function(e,r){var o;n.commentInteractionForbidden?n.restoreSelection(e,r):null===(o=n.selectionChangeCallback)||void 0===o||o.call(n,e,r)}}return a()(e,[{key:"restoreSelection",value:function(e,n){this.selectionInfo?this.selectionInfo.updateCurrentSelection(n):this.selectionInfo=new u(e,n)}},{key:"removeSelectionInfo",value:function(){this.selectionInfo=null}},{key:"init",value:function(e){this.selectionChangeCallback=e,s.S.on(s.p.COMMON.SELECTING_TAP_START,this.handleSelectingTapStart),s.S.on(s.p.COMMON.SELECTING_TAP_STOP,this.handleSelectingTapStop)}},{key:"destroy",value:function(){s.S.off(s.p.COMMON.SELECTING_TAP_START,this.handleSelectingTapStart),s.S.off(s.p.COMMON.SELECTING_TAP_STOP,this.handleSelectingTapStop),this.removeSelectionInfo(),this.selectionChangeCallback=null,this.triggerDebouncedSelectionChange.cancel(),this.commentInteractionForbidden=!1}}]),e}()},dx_B8Bh:function(e,n,r){"use strict";r.d(n,"K",(function(){return i})),r.d(n,"s",(function(){return c})),r.d(n,"t",(function(){return a}));var o=r("dx_B28d"),i=function(e){return o.BM.includes(e)},c=7,a=1},dx_BB1U:function(e,n,r){"use strict";r.d(n,"C",(function(){return i})),r.d(n,"H",(function(){return c})),r.d(n,"c",(function(){return a})),r.d(n,"j",(function(){return l}));var o=r("dx_yzqx"),i=52,c=o.S.isIPad?10:80,a=30,l=8},dx_BBFf:function(e,n,r){"use strict";var o,i;r.d(n,"I",(function(){return i})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAIL_OFFLINE=1]="FAIL_OFFLINE",e[e.FAIL_COPY_TOKEN=2]="FAIL_COPY_TOKEN",e[e.FAIL_CLINET_PARAMSTYPE_ERROR=3]="FAIL_CLINET_PARAMSTYPE_ERROR",e[e.FAIL_UPLOAD_IMAGE=4]="FAIL_UPLOAD_IMAGE",e[e.FAIL_CONFLICT=5]="FAIL_CONFLICT",e[e.FAIL_UNKNOWN=6]="FAIL_UNKNOWN"}(o||(o={})),function(e){e.NORMAL="normal",e.PREVIEW="preview",e.HISTORY="history"}(i||(i={}))},dx_BBJ7:function(e,n,r){"use strict";r.d(n,"N",(function(){return g.N})),r.d(n,"y",(function(){return y})),r.d(n,"M",(function(){return k})),r.d(n,"a",(function(){return O})),r.d(n,"Y",(function(){return x}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_h6a8"),d=r("dx_cDcd"),f=r.n(d),h=r("dx_O4O8"),p=r.n(h),v=r("dx_D8nn"),g=r("dx_PCVy");var b="change",y=function(){function e(){a()(this,e),this.state={editMode:g.N.Mouse},this.emitter=new p.a}return s()(e,[{key:"getState",value:function(){return this.state}},{key:"setState",value:function(e){Object(u.isEqual)(e,this.state)||(this.state=e,this.emitter.emit(b,e))}},{key:"onStateChange",value:function(e){var n=this;return this.emitter.on(b,e),function(){n.emitter.off(b,e)}}}]),e}(),m=new y,_=Object(d.createContext)(m),k=_.Consumer,O=function(e){var n=e.children,r=Object(d.useMemo)((function(){return new y}),[]),o=Object(g.S)();return function(){var e=Object(d.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(n){v.X.mouseUp=!1;var r=n;v.S.emit(v.p.COMMON.GLOBAL_MOUSE_DOWN_EVENT,r,e)}}),[]),n=Object(d.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(n){v.X.mouseUp=!0;var r=n;v.S.emit(v.p.COMMON.GLOBAL_MOUSE_UP_EVENT,r,e)}}),[]),r=Object(d.useCallback)((function(e){e.target instanceof Text&&e.preventDefault()}),[]);Object(d.useEffect)((function(){var o=e(),i=n(),c=e(!0),a=n(!0);return document.addEventListener("mousedown",o),document.addEventListener("mouseup",i),document.addEventListener("mousedown",c,!0),document.addEventListener("mouseup",a,!0),document.addEventListener("dragstart",r),function(){document.removeEventListener("mousedown",o),document.removeEventListener("mouseup",i),document.removeEventListener("mousedown",c,!0),document.removeEventListener("mouseup",a,!0),document.removeEventListener("dragstart",r)}}),[e,n])}(),Object(d.useEffect)((function(){v.X.editMode=o,r.setState({editMode:o})}),[r,o]),f.a.createElement(_.Provider,{value:r},n)},x=function(e){var n=Object(d.useMemo)((function(){return e.getService(y,{optional:!0})||m}),[e]),r=Object(d.useState)(n.getState()),o=i()(r,2),c=o[0],a=o[1];return Object(d.useEffect)((function(){return n.onStateChange(a)}),[n]),c}},dx_BE1d:function(e,n,r){"use strict";r.d(n,"V",(function(){return E}));var o,i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_W7W2"),p=r.n(h),v=r("dx_a1gu"),g=r.n(v),b=r("dx_Nsbk"),y=r.n(b),m=r("dx_GLPm"),_=r("dx_KTtu"),k=r("dx_Dw4b"),O=r("dx_m0BX");function x(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=y()(e);if(n){var i=y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return g()(this,r)}}!function(e){e.GridHead="GridHead",e.GridBody="GridBody",e.KanbanCard="KanbanCard",e.GalleryCard="GalleryCard"}(o||(o={}));var E=function(e){p()(r,e);var n=x(r);function r(e){var o;u()(this,r),(o=n.call(this,e)).type=_.V.BitableBlock,o.cellId=void 0,o.bitableId=void 0,o.scrollManage=void 0,o.recordId=void 0,o.area=void 0,o.fieldId=void 0,o.row=void 0,o.col=void 0,o.bridge=void 0,o.scrollFn=void 0;var i=e.key,c=e.row,a=e.col,l=e.cellId,s=e.bitableId,d=e.recordId,f=e.area,h=e.fieldId,p=e.bridge,v=e.scrollFn,g=e.scrollManage;return o.key=i,o.row=c,o.col=a,o.area=f,o.cellId=l,o.fieldId=h,o.bridge=p,o.recordId=d,o.bitableId=s,o.scrollFn=v,o.scrollManage=g,o}return f()(r,[{key:"scrollIntoView",value:function(e,n,r,o){var i=this,a=this.blockId,s=this.bitableId,u=this.bridge,d=this.scrollFn,f=this.scrollManage,h=n.getRecordByBlockId(this.blockId).id;return e.scrollToRecord(h,l()(c.a.mark((function e(){var o,l,h,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u&&f){e.next=2;break}return e.abrupt("return");case 2:o=i.bridge.bitableManager.uiManager.getSearchItemPos(s,i),l=o.x,h=o.y,p=r.getBlockRect(a).top+Object(O.F)(n),Object(m.ak)(f,{x:l,y:h},1),d&&d(p);case 6:case"end":return e.stop()}}),e)}))))}},{key:"isReplaceable",get:function(){return!1}}]),r}(k.S)},dx_BEcL:function(e,n,r){"use strict";(function(t){r.d(n,"C",(function(){return j})),r.d(n,"J",(function(){return A})),r.d(n,"L",(function(){return L})),r.d(n,"k",(function(){return F})),r.d(n,"n",(function(){return H})),r.d(n,"c",(function(){return V})),r.d(n,"x",(function(){return z})),r.d(n,"O",(function(){return G})),r.d(n,"H",(function(){return X})),r.d(n,"u",(function(){return J})),r.d(n,"a",(function(){return Q})),r.d(n,"D",(function(){return ee}));var e=r("dx_RIqP"),o=r.n(e),i=r("dx_lSNA"),c=r.n(i),a=r("dx_o0o1"),l=r.n(a),s=r("dx_J4zp"),u=r.n(s),d=r("dx_yXPU"),f=r.n(d),h=r("dx_NOtv"),p=r("dx_XIp8"),v=r("dx_YzVl"),g=r("dx_MoY1"),b=r("dx_hKul"),y=r("dx_CR0l"),m=r("dx_B28d"),_=r("dx_Lkek"),k=r("dx_oQO4"),O=r("dx_NsKf"),x=r("dx_ZG9w"),E=r("dx_bbfH"),S=r("dx_QBqw"),C=r("dx_Rux1"),I=r("dx_IyNS");function B(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return T(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){function n(n){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}((function(e){throw e})),f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){function n(n){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}((function(e){l=!0,c=e})),f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function T(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function w(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function R(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?w(Object(r),!0).forEach((function(n){c()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var M=Object(h.debug)("tableActionHelper");function j(e){return D.apply(this,arguments)}function D(){return(D=f()(l.a.mark((function e(n){var r,o,i,c,a,s,u,d,f,h,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.block,o=n.blockManager,i=n.options,c=n.beforeInsert,a=o.getBlockModelByBlockId(r.id),s=null===a||void 0===a?void 0:a.parent,a&&s){e.next=6;break}return Object(v.F)({type:"error",content:t("toolbox.insert_fail"),dom:r.hostElement}),e.abrupt("return");case 6:return u="",d="",f=Object(C.E)(i),e.next=11,o.applyTransaction(E.i,(function(e){c&&c(e,r),u=e.create((function(n){var r="".concat(f.rows_id[0]).concat(f.columns_id[0]),o=f.rows_id.reduce((function(o,i){return f.columns_id.reduce((function(o,c){var a="".concat(i).concat(c),l=Object(_.n)(),s=Object(g.s)(e,n,l);o[a]={block_id:s,merge_info:E.d};var u=Object(O.u)({}),f=Object(g.s)(e,s,u);return e.replaceChildren(s,[f]),a===r&&(d=f),o}),o)}),{});return R(R({},f),{},{parent_id:s.recordId,cell_set:o})})),e.insertChildren(s.record.id,a.position,[u])}));case 11:(h=o.getBlockIdsByRecordId(d)[0])&&(p=o.getBlockViewByBlockId(h),Object(x.U)(p)&&p.model.setSelection({start:0,len:0},!0));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return P.apply(this,arguments)}function P(){return(P=f()(l.a.mark((function e(n){var r,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.blockManager,o=n.column_set,i=n.blockId,e.next=3,r.applyTransaction(E.u1,(function(e){var n=r.getRecordByBlockId(i);if(n){var c=n.snapshot.column_set,a=[];for(var l in c)c[l].column_width!==o[l].column_width&&(e.replace(n.id,["column_set",l,"column_width"],o[l].column_width),a.push(l));try{r.getBlockModelByBlockId(i).children.forEach((function(e){var n=Object(S.j)(e.cellId),o=u()(n,2)[1];a.includes(o)&&r.getBlockModelByBlockId(e.id).children.forEach((function(e){var n=r.getBlockViewByBlockId(e.id);null===n||void 0===n||n.onResize()}))}))}catch(s){console.error("updateTableColumnWidth catch error:",s)}}}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e){return N.apply(this,arguments)}function N(){return(N=f()(l.a.mark((function e(n){var r,o,i,c,a,s,d,f,h,p,v,g,m;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.blockManager,o=n.position,i=n.tableInfo,c=i.tableId,a=i.cellsLayout,s=n.lineType,d=n.collectParams,f=r.getRecordByBlockId(c)){e.next=4;break}return e.abrupt("return");case 4:return h=f.snapshot,M(".addTableLine: position=%d, lineType=%s, tableInfo=%o, tableSnapshot=%o",o,s,n.tableInfo,h),p=s===k.v.COLUMN,v=p?k.v.ROW:k.v.COLUMN,g=null===d||void 0===d?void 0:d.actionValue,Object(b.M)(c,{actionType:y.e.EDIT_TABLE_FRAME,actionValue:{value1:(null===g||void 0===g?void 0:g.value1)||(p?y.E.ADD_COLUMN:y.E.ADD_ROW),value2:null===g||void 0===g?void 0:g.value2}},Object.assign({blockManager:r},d||{})),e.next=12,r.applyTransaction(p?E.M:E.MZ,(function(e){var n=p?Object(S.H)():Object(S.b)(),r=!0;h["".concat(v,"s_id")].forEach((function(i,c){var l=p?c:o,d=p?o:c;if(o>0&&o<h["".concat(s,"s_id")].length){var v=a[l][d],g=Object(S.B)(v.sourceCellId,h),b=u()(g,2),y=b[0],_=b[1];if(p?_<o:y<o){var k=W(v.sourceCellId,h,a),O=s.slice(0,3);e.replace(f.id,["cell_set",v.sourceCellId,"merge_info","".concat(O,"_span")],k["".concat(O,"Span")]+1)}}var x=p?"".concat(i).concat(n):"".concat(n).concat(i),E=V(e,f.id,x),C=H(e,E);r&&(r=!1,m=C)})),p&&e.insert(f.id,["column_set",n],{column_width:E.ug}),e.insert(f.id,["".concat(s,"s_id"),o],n)}));case 12:return e.abrupt("return",m);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(e,n){return U.apply(this,arguments)}function U(){return(U=f()(l.a.mark((function e(n,r){var o,i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.getBlockModelByBlockId(r).snapshot,i=Object(I.y)(r,o),c=i.rowIds.length,e.next=5,L({blockManager:n,position:c,tableInfo:i,lineType:k.v.ROW});case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,n){var r=Object(g.s)(e,n,Object(O.u)({}));return e.replaceChildren(n,[r]),r}function V(e,n,r){var o=Object(g.s)(e,n,Object(_.n)()),i={block_id:o,merge_info:E.d};return e.insert(n,["cell_set",r],i),o}function W(e,n,r){var o=Object(S.j)(e),i=u()(o,2),c=i[0],a=i[1],l=n.rows_id.indexOf(c),s=n.columns_id.indexOf(a);return r[l][s]}var z=K,G=function(){var e=f()(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K(n,E.D);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();function K(e){return q.apply(this,arguments)}function q(){return q=f()(l.a.mark((function e(n){var r,o,i,a,s,d,f,h,v,m,_,k,O=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=O.length>1&&void 0!==O[1]?O[1]:E.m,o=n.blockManager,i=n.tableId,a=n.layoutInfo,s=n.target,d=n.collectParams,f=o.getRecordByBlockId(i)){e.next=5;break}return e.abrupt("return");case 5:return h=Object(p.S)(f.snapshot),v=r===E.m,m=v?E.D:E.m,_=r.slice(0,3),Object(b.M)(i,{actionType:y.e.EDIT_TABLE_FRAME,actionValue:{value1:v?y.E.DELETE_COLUMN:y.E.DELETE_ROW}},Object.assign({blockManager:o},d||{})),k=s.sort((function(e,n){return n-e})),e.next=13,o.applyTransaction(v?E.os:E.mH,(function(e){var n,l=[],d=h["".concat(m,"s_id")].slice(0).reverse(),p=B(k);try{var b=function(){var o=n.value;d.forEach((function(n,r){var i=d.length-r-1,c=v?i:o,s=v?o:i,u="".concat(h.rows_id[c]).concat(h.columns_id[s]),p=W(a[c][s].sourceCellId,h,a);p&&p["".concat(_,"Span")]>1&&!l.includes(p)&&l.push(p),e.remove(f.id,["cell_set",u])})),v&&e.remove(f.id,["column_set",h.columns_id[o]]),e.remove(f.id,["".concat(r,"s_id"),o])};for(p.s();!(n=p.n()).done;)b()}catch(E){p.e(E)}finally{p.f()}for(var y=function(){var n=x[O],r=n.cellId,o=n.rowSpan,i=n.colSpan,a=h.columns_id,l=Object(S.j)(r),d=u()(l,2),p=d[0],g=d[1],b=a.slice(a.indexOf(g),a.indexOf(g)+i),y=h.rows_id,m=y.slice(y.indexOf(p),y.indexOf(p)+o),k=v?a:y,E=s.map((function(e){return k[e]})),C=(v?b:m).filter((function(e){return!E.includes(e)}));if(C.length){var I=v?"".concat(p).concat(C[0]):"".concat(C[0]).concat(g);e.replace(f.id,["cell_set",I,"merge_info"],c()({row_span:o,col_span:i},"".concat(_,"_span"),C.length))}},O=0,x=l;O<x.length;O++)y();s.length===h["".concat(r,"s_id")].length&&Object(g.y)(e,[i],o)}),{undoNotSetSelection:!0});case 13:case"end":return e.stop()}}),e)}))),q.apply(this,arguments)}function X(e){return Y.apply(this,arguments)}function Y(){return(Y=f()(l.a.mark((function e(n){var r,i,c,a,s,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.tableId,i=n.blockManager,c=n.origin,a=n.range,s=i.getRecordByBlockId(r)){e.next=4;break}return e.abrupt("return");case 4:return d=s.snapshot,e.next=7,i.applyTransaction(E.u,(function(e){var n,r=d.rows_id.slice(c.row,c.row+a.rowSpan),l=d.columns_id.slice(c.col,c.col+a.colSpan),f="".concat(r[0]).concat(l[0]),h=d.cell_set[f].block_id,p=[],v=B(r);try{for(v.s();!(n=v.n()).done;){var b,y=n.value,_=B(l);try{for(_.s();!(b=_.n()).done;){var k=b.value,x="".concat(y).concat(k),S=d.cell_set[x].block_id,C=i.getRecord(S).snapshot.children.slice(0);x!==f&&(e.replace(s.id,["cell_set",x,"merge_info"],E.d),H(e,S));var I=!1;if(1===C.length&&i.recordManager.getRecord(C[0]).snapshot.type===m.B.TEXT){var T=i.getBlockModelsByRecordId(C[0]),w=u()(T,1)[0],R=i.getBlockViewByBlockId(w.id),M=!w.record.snapshot.children.length;I=R.model.isEmpty&&M}(C.length>1||!I)&&p.push.apply(p,o()(C))}}catch(j){_.e(j)}finally{_.f()}}}catch(j){v.e(j)}finally{v.f()}0===p.length?p.push(Object(g.s)(e,h,Object(O.u)({}))):p.forEach((function(n){e.replace(n,["parent_id"],h)})),e.replaceChildren(h,p),e.replace(s.id,["cell_set",f,"merge_info"],{col_span:l.length,row_span:r.length})}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e){return Z.apply(this,arguments)}function Z(){return(Z=f()(l.a.mark((function e(n){var r,o,i,c,a,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.tableId,o=n.blockManager,i=n.origin,c=n.range,a=o.getRecordByBlockId(r)){e.next=4;break}return e.abrupt("return");case 4:return s=a.snapshot,e.next=7,o.applyTransaction(E.T,(function(e){var n,r=s.rows_id.slice(i.row,i.row+c.rowSpan),o=s.columns_id.slice(i.col,i.col+c.colSpan),l=B(r);try{for(l.s();!(n=l.n()).done;){var u,d=n.value,f=B(o);try{for(f.s();!(u=f.n()).done;){var h=u.value,p="".concat(d).concat(h),v=s.cell_set[p].merge_info,g=v.col_span,b=v.row_span,y=s.cell_set[p].block_id,m=Object(S.T)(s).length;1===g&&1===b||e.replace(a.id,["cell_set",p,"merge_info"],E.d),m||H(e,y)}}catch(_){f.e(_)}finally{f.f()}}}catch(_){l.e(_)}finally{l.f()}}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Q(e){return $.apply(this,arguments)}function $(){return($=f()(l.a.mark((function e(n){var r,o,i,c,a,s,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.blockManager,o=n.cellRecordId,i=n.offset,c="",e.next=4,r.applyTransaction("createTextBlockInCell",(function(e){var n=Object(g.l)(e,o,i,[Object(O.u)({})]),r=u()(n,1);c=r[0]}));case 4:return a=r.getBlockIdsByRecordId(c),s=u()(a,1),d=s[0],e.abrupt("return",d);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ee=function e(n,r,o){var i=n.parentId;if(!i)return!1;var c=o.getBlockViewByBlockIdNotCheck(i);return!!c&&(c.type===m.B.TABLE&&c.id===r||e(c,r,o))}}).call(this,r("dx_E9Eu"))},dx_BH3T:function(e,n,r){"use strict";r.d(n,"Q",(function(){return a})),r.d(n,"iL",(function(){return l})),r.d(n,"i",(function(){return s})),r.d(n,"T",(function(){return u}));var o=r("dx_B28d"),i=new Set(o.h),c=new Set(o.U6);function a(e){return new Set(Object(o.q)()).has(e)}function l(e){return o.j.includes(e)}function s(e){return i.has(e)}function u(e){return c.has(e)}},dx_BLU6:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return G}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_cDf5"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_UtDZ"),p=r("dx_bUYd"),v=r("dx_rQGm"),g=r("dx_yzqx"),b=r("dx_D9db"),y=r("dx_k9kc"),m=r("dx_rldU"),_=r("dx_eSV8"),k=r("dx_Q4WO"),O=r("dx_B28d"),x=r("dx_ZG9w"),E=r("dx_acOG"),S=r("dx_j6ji"),C=r("dx_KFmR"),I=r("dx_FNDK"),B=r("dx_P58d"),T=r("dx_D8nn"),w=r("dx_EnrF"),R=r("dx_cQo6"),M=r("dx_Y27Y"),j=r("dx_tFZp"),D=r("dx_lXou"),A=r("dx_z36z"),P=r("dx_ffjs"),L=r("dx_ZTLK"),N=r("dx_LS0b"),F=r("dx_bkVC"),U=r("dx_HirW"),H=r("dx_Vkod"),V=r("dx_tsDa");function W(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return z(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return z(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function z(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var G=function(){function e(n){var r=this;u()(this,e),this.options=n,this.isInHistory=void 0,this.formats=[new j.S(this.options),new P.S(this.options),new A.S(this.options),new D.S(this.options),new L.S(this.options),new N.S(this.options)],this.selectedBlockSelection=void 0,this.getSelectedBlocks=function(){return r.options.selectionAPI.getSelection()},this.getSelectedBlocksWithoutCursor=function(){return r.options.selectionAPI.getSelectionWithoutCursor()},this.update=function(e){var n=e.copyable,o=e.editable;r.options.copyable=n,r.options.editable=o},this.getAuthorityCopyable=function(){return Object(h.getPermTypeAuthorityResult)(h.PermissionType.FILE_COPY)},this.handleCut=function(e){r.handleCopy(e,!0)},this.handleCopy=function(e){var n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(r.selectedBlockSelection&&(n=r.selectedBlockSelection,r.selectedBlockSelection=null),r.shouldHandleEvent&&!r.checkIsSelfCopyPermission(e))if(o&&!r.options.editable&&r.options.selectionAPI.isFocus())e.preventDefault();else{if(!1===r.copyable&&r.options.selectionAPI.isFocus())return Object(U.D)(),void e.preventDefault();if(!r.checkIsIgnoreTarget(e)){var i=r.getSelectedBlocks().map((function(e){var n=e.id;return r.blockManager.getBlockModelByBlockId(n).type}));Object(b.fB)(b.f.COPY,{ccm_copy_type:JSON.stringify(i)});var c=T.X.isTriggerredByClick,a=T.X.isTriggerredByMobileSwipe,s=function(){if(c||a){var e=[];return c&&(T.X.isTriggerredByClick=!1,e=T.X.selectedBlocks),a&&(T.X.isTriggerredByMobileSwipe=!1,e=r.options.selectionAPI.getSelection()),1===e.length?Object(k.B)(r.blockManager.getBlockViewByBlockId(e[0].id),r.blockManager,r.options.fold).map((function(e){return{id:e.id,type:B.j.BLOCK}})):e}return n?[n]:r.getSelectedBlocksWithoutCursor()}(),u=(s=Object(H.D)(s)).map((function(e){return e.id})),d=new Set(u),f=[];if(u.forEach((function(e){if(e!==r.rootBlockId){var n=r.options.blockManager.getBlockModelByBlockId(e),o=0;n.findDescendantAll((function(e){return d.has(e.id)||(d.add(e.id),f[o++]=e.id),!1})),u.push.apply(u,f),f.length=0}})),r.blockManager.layoutManager.renderNodeByIdSync(u),0!==(s=r.compatibleFileBlock(s)).length&&r.options.selectionAPI.isFocus()){if(o){var h,x=s.map((function(e){return r.blockManager.getBlockViewByBlockId(e.id)})),C=x.map((function(e){return e.type})),w=C.find((function(e){return[O.B.OBJECTIVE,O.B.KEY_RESULT].includes(e)})),M=r.blockManager.editorAPI.getService(E.N,{optional:!0});if(w||M&&!x.map((function(e){return r.blockManager.getBlockModelByBlockId(e.id)})).every((function(e){var n,r,o;return h=null===(n=e.parent)||void 0===n?void 0:n.record,M.canBlockEdit(null===(r=e.parent)||void 0===r?void 0:r.record,(null===(o=e.parent)||void 0===o?void 0:o.type)||"",{type:"DELETE_CHILD",index:e.position})})))return void(w||(e.preventDefault(),Object(S.A)({op_source:"keyboard",op_type:"cut",edit_type:"DELETE_CHILD",interceptedRecord:h})))}if(!0!==Object(U.lc)(s.filter((function(e){return e.id!==r.rootBlockId})),r.blockManager)){try{var j=s[s.length-1],A=s[0],P=r.blockManager.getBlockModelByBlockId(A.id),L=r.blockManager.getBlockModelByBlockId(j.id),N=P.previous,V=L.next,z=null,G=new R.S(e.clipboardData);G.resetDataBeforeSetData();var K=Object(I.m)(s);!g.S.isMobile&&Object(y.Fi)({actionObject:K?m.u.TEXT:m.u.BLOCK,source:c?y.G.web_menu_panel:y.G.content_page,blockManager:r.blockManager,actionType:y.F[o?"cut":"copy"],blocks:s,click:c?y.c.block_action:y.c.hotkey_action});var q=null,X=null;Object(F.S)();var Y,J=W(r.formats);try{var Z=function(){var n=Y.value;if(n.shouldCopy(s)){e.preventDefault();var i,c={},a=W(s);try{for(a.s();!(i=a.n()).done;){var u=i.value;c[u.id]=n.onCopyBlock(u)}}catch(p){a.e(p)}finally{a.f()}var d=n.onCopy?n.onCopy(c,o,s):c,f=r.replaceMediaSrc("object"===l()(d)?JSON.stringify(d):d);if(q&&X&&n instanceof D.S){var h=document.createElement("span");h.setAttribute(U.g,q),h.setAttribute(U.w,X),h.className=U.t,f+=h.outerHTML}G.setData(n.format,f),q=f,X=n.format,o&&n.onDelete&&(z?console.warn("\u91cd\u590d\u6267\u884c\u4e86\u526a\u5207\u7684\u5220\u9664\u903b\u8f91\uff01\u8bf7\u68c0\u67e5"):z=function(){return n.onDelete&&n.onDelete(s)})}};for(J.s();!(Y=J.n()).done;)Z()}catch(Q){J.e(Q)}finally{J.f()}z&&z(),((null===V||void 0===V?void 0:V.id)||(null===N||void 0===N?void 0:N.id))===(null===N||void 0===N?void 0:N.id)}catch(Q){return console.error(Q),void Object(_.n)("\u590d\u5236\u5931\u8d25\uff0c\u539f\u56e0".concat(Q))}T.S.emit(v.e,{operation_method:v.mu.KEYBOARD,source:"other",action:o?"cut":"copy",block_id:s[0].id,blockManager:r.blockManager})}else Object(p.v)({type:"error",content:t("CreationDoc_UnableToCopy_Rendering_toast")})}}}},this.copyBlockText=function(e){var n=r.blockManager.getBlockModelByBlockId(e);if(Object(x.i)(n)){var o=n.zoneState.totalWidth()-1;r.options.selectionAPI.setSelection([{type:B.j.TEXT,id:e,selection:{start:0,end:o}}]),r.selectedBlockSelection={type:B.j.TEXT,id:e,selection:{start:0,end:o}},r.options.selectionAPI.copySelectedBlocks()}},this.handlePaste=function(){var e=c()(o.a.mark((function e(n){var i,c,a,l,s,u,d,f,h,p,g,b,y,m,_,k,O;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.clipboardData&&r.options.editable&&r.shouldHandleEvent&&!r.checkIsSelfCopyPermission(n)&&!r.checkIsIgnoreTarget(n)){e.next=2;break}return e.abrupt("return");case 2:if(Object(C.L)(n)&&Object(C.l)(r.options.selectionAPI,r.options.blockManager.editorAPI.viewService)&&r.options.selectionAPI.emitSelectionChange(),i=r.getSelectedBlocks(),r.options.selectionAPI.isFocus()||Object(V.A)(r.blockManager,i.map((function(e){return e.id})))){e.next=6;break}return e.abrupt("return");case 6:if(0!==i.length&&r.options.selectionAPI.isFocus()){e.next=8;break}return e.abrupt("return");case 8:n.preventDefault(),c=new R.S(n.clipboardData),a=Object(U.F)(c,r.blockManager,i[0].id),l=a.applyFrom,s=a.pasteInSamePage,u=a.parseData,Object(F.Q)(l),d=W(r.formats),e.prev=13,d.s();case 15:if((f=d.n()).done){e.next=57;break}if(h=f.value,!(p=h.format===M.L.FILES&&n.clipboardData.files.length?n.clipboardData.files:c.getData(h.format))||!h.shouldPaste(i,p,n)){e.next=55;break}if(!(h instanceof D.S)){e.next=52;break}if(g=(new DOMParser).parseFromString('<div id="block-root">'.concat(Object(U.Aj)(p),"</div>"),"text/html"),!(b=g.querySelector(".".concat(U.t)))){e.next=47;break}y=b.getAttribute(U.g),m=b.getAttribute(U.w),_=W(r.formats),e.prev=26,_.s();case 28:if((k=_.n()).done){e.next=36;break}if((O=k.value).format!==m||!y){e.next=34;break}return e.next=33,O.onPaste(i,y,c);case 33:return e.abrupt("break",36);case 34:e.next=28;break;case 36:e.next=41;break;case 38:e.prev=38,e.t0=e.catch(26),_.e(e.t0);case 41:return e.prev=41,_.f(),e.finish(41);case 44:return e.abrupt("break",57);case 47:return e.next=49,h.onPaste(i,g,c);case 49:return e.abrupt("break",57);case 50:e.next=55;break;case 52:return e.next=54,h.onPaste(i,p,c,u);case 54:return e.abrupt("break",57);case 55:e.next=15;break;case 57:e.next=62;break;case 59:e.prev=59,e.t1=e.catch(13),d.e(e.t1);case 62:return e.prev=62,d.f(),e.finish(62);case 65:s?Object(F.v)():Object(F.O)(),T.S.emit(v.e,{operation_method:v.mu.KEYBOARD,source:"other",action:"paste",block_id:i[0].id,blockManager:r.blockManager});case 67:case"end":return e.stop()}}),e,null,[[13,59,62,65],[26,38,41,44]])})));return function(n){return e.apply(this,arguments)}}(),this.checkIsSelfCopyPermission=function(e){return!!e.target.closest(".isv-block-container")},this.checkIsIgnoreTarget=function(e){var n=e.target;return n.classList.contains("poll-input-textarea")||n.classList.contains("task-block-text-editor")},this.isInHistory=!!n.isHistory,document.addEventListener("copy",this.handleCopy,!0),document.addEventListener("cut",this.handleCut,!0),document.addEventListener("paste",this.handlePaste,!0)}return f()(e,[{key:"compatibleFileBlock",value:function(e){var n=this;return e.map((function(e){var r=n.options.blockManager.getBlockModelByBlockId(e.id).parent;return(null===r||void 0===r?void 0:r.type)===O.B.VIEW?{id:r.id,type:B.j.BLOCK}:e}))}},{key:"blockManager",get:function(){return this.options.blockManager}},{key:"shouldHandleEvent",get:function(){return this.isInHistory||!Object(w.P)()}},{key:"rootBlockId",get:function(){return this.blockManager.getRootBlockId()}},{key:"copyable",get:function(){return this.options.copyable&&this.getAuthorityCopyable()}}]),f()(e,[{key:"unmount",value:function(){document.removeEventListener("copy",this.handleCopy,!0),document.removeEventListener("cut",this.handleCut,!0),document.removeEventListener("paste",this.handlePaste,!0)}},{key:"getTextIns",value:function(e){var n=this.blockManager.getBlockModelByBlockId(e.id).children;return n&&n[0]?(e=this.blockManager.getBlockViewByBlockId(n[0].id),this.getTextIns(e)):e}},{key:"replaceMediaSrc",value:function(e){return e.replace(/<(?:img|iframe)[^>]*(data-no-request-)src=[^>]*>/g,(function(e,n){return e.replace(n,"")}))}}]),e}()}).call(this,r("dx_E9Eu"))},dx_BQEl:function(e,n,r){},dx_BTVV:function(e,n,r){"use strict";r.d(n,"U",(function(){return T})),r.d(n,"S",(function(){return R}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_QxNg"),b=r("dx_h6a8"),y=r("dx_cDcd"),m=r("dx_B28d"),_=r("dx_Vau3"),k=r("dx_r61a"),O=r("dx_S5Se"),x=r("dx_G6GV"),E=r("dx_fCRr"),S=r("dx_XlRC");function C(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return I(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function I(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function B(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var T=function(e,n){var r=e.action[n];return"string"===typeof r?r:Object(b.isObject)(r)?r.type:""},w=function(e,n,r){var o=e.action[n];return r.recordManager.hasRecord(o)?r.getRecord(o).snapshot.type:""},R=function(e){d()(r,e);var n=B(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"getEffect",value:function(){var e=this;return function(){Object(y.useEffect)((function(){var n,r=function(r){var o=r.recordOps,i=o.filter((function(n){return!!n.ops.find((function(n){return e.isModifySeq(n)||e.isTurnInto(n,m.B.ORDERED)}))})),c=o.filter((function(n){return!!n.ops.find((function(n){return e.isInsert(n,m.B.ORDERED)}))}));n=requestAnimationFrame((function(){i.forEach((function(n){var r=n.id,o=e.blockManager.getBlockIdsByRecordId(r)[0];o&&e.renumberOList(o)})),c.forEach((function(n){e.handleInsert(n)}))}))};return e.blockManager.recordManager.on(g.q.CHANGE,r),function(){e.blockManager.recordManager.off(g.q.CHANGE,r),n&&window.cancelAnimationFrame(n)}}),[]),Object(y.useEffect)((function(){var n=function(n){n.recordOps.filter((function(n){return!!n.ops.find((function(n){return e.isRemove(n,m.B.ORDERED)}))})).forEach((function(n){e.handleRemove(n)}))};return e.blockManager.recordManager.on(g.q.CHANGE,n),function(){e.blockManager.recordManager.off(g.q.CHANGE,n)}}),[]),Object(y.useEffect)((function(){var n=function(n){var r=n.recordOps,o=n.options;if(o.from===g.H.local&&!e.inUndoRedo){var i=e.getRecordOpsContext(r,o);if(!i)return;e.batchModifySeqIfNecessary(i)}};return e.blockManager.recordManager.on(g.q.CHANGE,n),function(){e.blockManager.recordManager.off(g.q.CHANGE,n)}}),[])}}},{key:"isTurnInto",value:function(e,n){if(!Object(g.bG)(e))return!1;var r=T(e,"od"),o=T(e,"oi");return r!==o&&[o,r].includes(n)}},{key:"isModifySeq",value:function(e){return"seq"===e.p[0]}},{key:"isInsert",value:function(e,n){return!!Object(g.X)(e)&&("children"===e.p[0]&&w(e,"li",this.blockManager)===n)}},{key:"isRemove",value:function(e,n){return!!Object(g.ZH)(e)&&("children"===e.p[0]&&w(e,"ld",this.blockManager)===n)}},{key:"getRecordOpsContext",value:function(e,n){var r=this,o=n.isInPaste,c=e.filter((function(e){return r.isTurnintoRecordOp(e)}));if(c.length){var a=c.map((function(e){return r.getTurnintoRecordOpType(e)}));return{recordOps:e,recordOpsType:E.l.TURNINTO,targetRecordOps:c,targetRecordOpTypes:a}}var l=e.filter((function(e){return r.isInsertRecordOp(e)})),s=e.filter((function(e){return r.isRemoveRecordOp(e)}));if(o)return{recordOps:e,recordOpsType:E.l.PASTE,targetRecordOps:[].concat(i()(l),i()(s)),targetRecordOpTypes:[].concat(i()(new Array(l.length).fill(E.R.INSERT)),i()(new Array(s.length).fill(E.R.REMOVE)))};if(l.length&&s.length){var u=Object(O.u)(l),d=Object(O.s)(s);if(u.length===d.length)return d.forEach((function(e){var n=e.action.ld,r=u.find((function(e){return e.action.li===n}));if(!r)return null})),{recordOps:e,recordOpsType:E.l.MOVE,targetRecordOps:[].concat(i()(l),i()(s)),targetRecordOpTypes:[].concat(i()(new Array(l.length).fill(E.R.INSERT)),i()(new Array(s.length).fill(E.R.REMOVE)))}}else{if(1===l.length)return{recordOps:e,recordOpsType:E.l.INSERT,targetRecordOps:l,targetRecordOpTypes:[E.R.INSERT]};if(1===s.length)return{recordOps:e,recordOpsType:E.l.REMOVE,targetRecordOps:s,targetRecordOpTypes:[E.R.REMOVE]}}return null}},{key:"isTurnintoRecordOp",value:function(e){var n=this;return e.ops.find((function(e){return n.isTurnInto(e,m.B.ORDERED)}))}},{key:"isInsertRecordOp",value:function(e){var n=this;return e.ops.find((function(e){return n.isInsert(e,m.B.ORDERED)}))}},{key:"isRemoveRecordOp",value:function(e){var n=this;return e.ops.find((function(e){return n.isRemove(e,m.B.ORDERED)}))}},{key:"getTurnintoRecordOpType",value:function(e){var n=this,r=e.ops.find((function(e){return n.isTurnInto(e,m.B.ORDERED)}));return T(r,"oi")===m.B.ORDERED?E.R.TURNINTO_INSERT:E.R.TURNINTO_REMOVE}},{key:"batchModifySeqIfNecessary",value:function(e){var n=this,r=e.recordOpsType,o=e.targetRecordOps,i=e.targetRecordOpTypes,c=new Map;switch(r){case E.l.TURNINTO:c=Object(x.B)(this.blockManager,o,i);break;case E.l.MOVE:c=Object(x.r)(this.blockManager,o,i);break;case E.l.INSERT:var a=o[0],l=Object(O.E)(this.blockManager,a);c=Object(x.v)(this.blockManager,a,l);break;case E.l.REMOVE:var s=o[0];c=Object(x.s)(this.blockManager,s);break;case E.l.PASTE:c=Object(x.f)(this.blockManager,o,i)}c.size&&Promise.resolve().then((function(){n.blockManager.applyTransaction("ordered:".concat(r,":modifySeq"),(function(e){c.forEach((function(r,o){var i=n.blockManager.getRecordByBlockId(o).id;n.blockManager.getRecord(i).get(["seq"])!==r&&e.replace(i,["seq"],r)}))}),{mergeMode:g.f.MERGE})}))}},{key:"renumberOList",value:function(e){var n=this.blockManager.getBlockModelByBlockIdNotCheck(e);if(n){var r=n.nextSibling,o=[];o=r&&Object(S.D)(r)&&Object(S.q)(r)?Object(S.Y)(this.blockManager,e,k.b.DOWN):Object(S.c)(this.blockManager,e,k.b.DOWN),this.blockManager.dispatch(k.O,[e],e);var i,c=C(o);try{for(c.s();!(i=c.n()).done;){var a=i.value;this.blockManager.dispatch(k.O,[a.blockId],a.blockId)}}catch(l){c.e(l)}finally{c.f()}}}},{key:"handleRemove",value:function(e){var n=this;Object(O.e)(this.blockManager,e).orderedBlockIds.forEach((function(e){n.renumberOList(e)}))}},{key:"handleInsert",value:function(e){var n=this;Object(O.Y)(this.blockManager,e).orderedBlockIds.forEach((function(e){n.renumberOList(e)}))}},{key:"inUndoRedo",get:function(){var e;return!!(null===(e=this.blockManager.recordManager.undoModule)||void 0===e?void 0:e.inUndoRedo)}}]),r}(_.A)},dx_BaTw:function(e,n,r){"use strict";r.d(n,"wd",(function(){return g})),r.d(n,"y",(function(){return b})),r.d(n,"i",(function(){return y})),r.d(n,"p",(function(){return m})),r.d(n,"h",(function(){return _})),r.d(n,"I",(function(){return k})),r.d(n,"Xl",(function(){return O})),r.d(n,"G",(function(){return x})),r.d(n,"T",(function(){return E})),r.d(n,"X",(function(){return S})),r.d(n,"pT",(function(){return C})),r.d(n,"w",(function(){return I})),r.d(n,"M",(function(){return B})),r.d(n,"f",(function(){return w})),r.d(n,"c",(function(){return R})),r.d(n,"X5",(function(){return M})),r.d(n,"t",(function(){return j})),r.d(n,"m",(function(){return D}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=(r("dx_lSNA"),r("dx_J4zp")),s=r.n(l),u=r("dx_UtDZ"),d=r("dx_h6a8"),f=r("dx_PQBD"),h=r("dx_z8zm"),p=r("dx_L6Lu"),v=r("dx_LA8U"),g=(r("dx_cmmV"),function(e){return function(e){return Array.isArray(e)?e:[e]}(e).map((function(e){return".".concat(e)}))});function b(e,n){Object.assign(e.style,n)}function y(e,n,r){return e.left<=n&&n<=e.right&&e.top<=r&&r<=e.bottom}var m=function(e,n){var r=e.className;r.includes(n)||(e.className="".concat(r," ").concat(n))},_=function(e,n){var r=e.className;r.includes(n)&&(e.className=r.replace(n,""))},k=function(e){return!e.previousSibling};function O(e,n){var r=365;if(n<=78)return 1;if(n<=r)return e<=r?1:r/e;var o=e/n*r;return o>r?r/e:o>=78?r/n:78/e}function x(e){var n=e.reduce((function(e,n,r){var o=s()(e,4),i=o[0],c=o[1],a=o[2],l=o[3],u=0===r,d=n.getBoundingClientRect(),f=d.width,h=d.top,p=d.bottom,v=d.left;if(f<=0){var g=parseInt(n.style.width,10)||0;g>i&&(i=g),c+=parseInt(n.style.height,10)||0}else f>i&&(i=f,c+=p-h);return u&&(a=h,l=v),[i,c,a,l]}),[0,0,0,0]),r=s()(n,4);return{width:r[0],height:r[1],top:r[2],left:r[3]}}function E(e,n){var r=n.x,o=n.y;return r&&o?0===e.left&&0===e.top?{x:0,y:0}:{x:e.left-r,y:e.top-o}:null}var S=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=n.getBoundingClientRect(),i=e.getBoundingClientRect(),c=Object(h.u)(u.store.getState()),a=c?Object(p.k)(n):1,l=c?Object(p.k)(e):1,s=(i.top*l-o.top*a)/r+n.scrollTop,d=(i.left*l-o.left*a)/r+n.scrollLeft,f=(d+i.width)/r,v=(s+i.height)/r;return{top:s,bottom:v,left:d,right:f,height:i.height/r,width:i.width/r}},C=function(e,n){return e.hostElement?S(e.hostElement,n):null},I=function(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!e.hasBlockViewByBlockId(n))return null;var i=e.getBlockViewByBlockId(n);return i.hostElement?S(i.hostElement,r,o):null};function B(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!e.hasBlockViewByBlockId(n))return null;var i=e.getBlockViewByBlockId(n);return i.contentElement?S(i.contentElement,r,o):null}var T=Object(d.debounce)((function(e,n,r,o){var i=o.getBlockViewByBlockId(e).hostElement;if(r.origin&&r.origin.includes(e)&&!n)return;(function(){var e=document.querySelectorAll(".drop-down-motion");document.querySelectorAll(".drop-up-motion").forEach((function(e){e.classList.remove("drop-up-motion")})),e.forEach((function(e){e.classList.add("drop-up-motion"),e.classList.remove("drop-down-motion")})),T.cancel()})(),i.classList.add("drop-down-motion")}),34);function w(e,n){var r,o,i=null;document.caretPositionFromPoint?(i=document.caretPositionFromPoint(e,n))&&(r=i.offsetNode,o=i.offset):document.caretRangeFromPoint&&(i=document.caretRangeFromPoint(e,n))&&(r=i.startContainer,o=i.startOffset);return{range:i,textNode:r,offset:o}}var R=function(){function e(n){var r=this;i()(this,e),this.e=n,this.allowResetSelection=!1,this.cancelTimer=0,this.handleMouseDown=function(){r.allowResetSelection=!0,r.debounceCancel(e.MOUSEDOWN_TO_MOUSEUP_MS)},this.handleMouseUp=function(){r.allowResetSelection&&r.debounceCancel(e.MOUSEUP_TO_CLICK_MS)},this.setEvents(!0)}return a()(e,[{key:"destroy",value:function(){this.setEvents(!1)}},{key:"setEvents",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=e?"addEventListener":"removeEventListener";this.e[n]("mousedown",this.handleMouseDown),this.e[n]("mouseup",this.handleMouseUp)}},{key:"debounceCancel",value:function(e){var n=this;clearTimeout(this.cancelTimer),this.cancelTimer=window.setTimeout((function(){n.cancelTimer=0,n.allowResetSelection=!1}),e)}}]),e}();function M(e,n,r){var o=document.createElement("div");o.id="img";var i=document.createElement("img");return i.src=e,n&&(i.style.width=n,o.style.width=n),r&&(i.style.height=r,o.style.height=r),o.appendChild(i),o}function j(e,n){return e.every((function(e){var r;if(!n(e))return!1;var o=!1;return(null===(r=e.children)||void 0===r?void 0:r.length)&&(o=!!e.findDescendant((function(e){return!n(e)}))),!o}))}function D(e){var n=e.model,r=e.fold.findClosestFoldsByBlock(n.id);if(r.length>0)return n;var o=function(e){var n=e.model,r=e.fold;if(!Object(v.l)(n.type)||!r.isFoldedOrFoldedBy(n.id))return null;var o=null,i=null,c=n.nextSibling,a=Object(f.V)(n.type);for(;c;){var l=Object(f.V)(c.type);if(Object(v.l)(c.type)&&a&&l&&l<=a)break;if(Object(v.l)(c.type)&&(i=c),r.isShow(c.id)){o=Object(v.l)(c.type)?i:c;break}c=c.nextSibling}return o}(e);return 0!==r.length||o?o||(null===n||void 0===n?void 0:n.nextSibling):null}R.MOUSEDOWN_TO_MOUSEUP_MS=200,R.MOUSEUP_TO_CLICK_MS=200},dx_Bait:function(e,n,r){"use strict";(function(e){r.d(n,"S",(function(){return K}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_RIqP"),a=r.n(c),l=r("dx_J4zp"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_QxNg"),g=r("dx_UtDZ"),b=r("dx_h6a8"),y=r("dx_PQBD"),m=r("dx_yzqx"),_=r("dx_ahlY"),k=r("dx_DbCN"),O=r("dx_imty"),x=r("dx_B28d"),E=r("dx_Jl0O"),S=r("dx_FvGq"),C=r("dx_EqZO"),I=r("dx_YjoZ"),B=r("dx_D8nn"),T=r("dx_Pa9M"),w=r("dx_ey54"),R=r("dx_k8kI"),M=r("dx_qx8A"),j=r.n(M),D=r("dx_L6LS"),A=r("dx_NMuw");r.d(n,"v",(function(){return A.v}));var P=r("dx_qcGr");function L(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function N(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?L(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function F(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return U(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function U(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var H=e.env.NODEJS,V=B.p.TRANSLATE,W=V.TRANSLATE_EVENT_DONE,z=V.TRANSLATE_EVENT_CLOSE,G=V.TRANSLATE_LANGUAGE_CHANGE,K=function(){function e(n){var r=this,o=n.blockManager,i=n.rect,c=n.scroller,l=n.eventEmitter,u=n.headingModule,f=n.lazyRecord,h=n.initialCatalogItems,y=n.initialHeadingRecords;d()(this,e),this.blockManager=void 0,this.rect=void 0,this.scroller=void 0,this.lazyRecord=void 0,this.hasNoSSRCatalogItemData=void 0,this.initialCatalogItemMap=new Map,this._headingMap=new Map,this._ssrHeadingMap=new Map,this.catalogueList=null,this.catalogueEvent=void 0,this.activeRecordId="",this.gridColumnIsDisplayBlock=!1,this.ignoreUpdateActiveTimer=0,this.isDataReady=!1,this.eventEmitter=void 0,this.initRecordMap=void 0,this.willUpdateRecord=new Set,this.headingModule=void 0,this.subs=void 0,this.insertingRecordIdSet=new Set,this.isChangePageTitle=!1,this.addInsertRecordIdSet=function(e,n){n.from===v.H.local&&(r.insertingRecordIdSet.add(e),setTimeout((function(){r.insertingRecordIdSet.delete(e)}),0))},this.handleBlockModelStructUpdate=function(e){var n=e.action,o=e.options;switch(n.type){case p.W.INSERT_CHILD:if(Object(I.C)()&&!r.isHeadingOrGrid(n.child.record))return;!H&&r.handleInit(n.child),r.handleChildrenInitRecursively(n.child.children,o),r.addInsertRecordIdSet(n.child.recordId,o);break;case p.W.REMOVE_CHILD:var i;if(r.insertingRecordIdSet.has(n.child.recordId))!r.isDataReady&&(null===(i=r.lazyRecord)||void 0===i?void 0:i.isPreEditableEnable())&&r.initialCatalogItemMap.delete(n.child.recordId);else r.handleDestroyByRecordId(n.child.recordId),r.handleChildrenDestroyRecursively(n.child.children);break;case p.W.CHANGE_CHILD_TYPE:r.handleBlockModelTypeChange(n.child,n.oldChild)}},this.handleInitialDataReady=function(){var e=r.blockManager.model.rootBlockModel;!H&&r.handleInit(e),r.handleChildrenInitRecursively(e.children)},this.handleBlockModelUpdate=function(e){r.handleUpdate(e.model)},this.handleBlockModelTypeChange=function(e,n){r.handleUpdate(e);var o=new Set;n.traverseInDepthFirstPreOrder((function(e){o.add(e.id)})),e.traverseInDepthFirstPreOrder((function(e){o.has(e.id)?(o.delete(e.id),r.handleUpdate(e)):r.handleInit(e)}));var i,c=r.blockManager.editorAPI.modelService,a=F(o);try{for(a.s();!(i=a.n()).done;){var l=i.value,s=c.getCacheRecordIdByBlockId(l);s&&r.handleDestroyByRecordId(s)}}catch(u){a.e(u)}finally{a.f()}},this.handleChildrenInitRecursively=function(e,n){var o,i=F(e);try{for(i.s();!(o=i.n()).done;){var c=o.value;!H&&r.handleInit(c),n&&r.addInsertRecordIdSet(c.recordId,n),r.handleChildrenInitRecursively(c.children,n)}}catch(a){i.e(a)}finally{i.f()}},this.handleChildrenDestroyRecursively=function(e){var n,o=F(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;r.handleDestroyByRecordId(i.recordId),r.handleChildrenDestroyRecursively(i.children)}}catch(c){o.e(c)}finally{o.f()}},this.isHeadingOrGrid=function(e){var n=r.getHeadingInfo(e).isHeading,o=e.get(["type"])||"";return n||o===x.B.GRID},this.handleInit=function(e){return r.initRecord(e.record)},this.handleDestroyByRecordId=function(e){r.willUpdateRecord.delete(e),r.batchUpdate(),r.removeHeadingMapData(e)},this.handleUpdate=function(e){r.willUpdateRecord.add(e.record.id),r.batchUpdate()},this.syncUpdate=function(){r.willUpdateRecord.forEach((function e(n){var o=r.blockManager.getRecord(n),i=r.getHeadingInfo(o),c=i.isHeading,l=i.sourceLevel;if(c){r.setHeadingMapData(o,l);var u=o.snapshot,d=u.type,f=u.children;d!==x.B.PAGE&&(null===f||void 0===f?void 0:f.length)>0&&f.forEach(e)}else{r.removeHeadingMapData(n);var h=!1;r.getHeadingInfoToMap().forEach((function(e){var i=e.positionPath,c=e.columnInfo,l=i.findIndex((function(e){return s()(e,2)[1]===n}));if(l>-1){var u=r.getPositionInfoForLegalContainer(o);if(u)if(u.positionPath.some((function(e,n){var r=s()(e,2),o=r[0],c=r[1];return o!==i[n][0]||c!==i[n][1]}))){e.positionPath=[].concat(a()(u.positionPath),a()(i.slice(l)));var d=c&&r.blockManager.getBlockIdsByRecordId(c.parentRecordId)[0],f=d&&l>=r.blockManager.getBlockModelByBlockId(d).depth;(!c||u.columnInfo||f)&&(e.columnInfo=u.columnInfo),h=!0}}})),h&&r.debounceUpdateCatalogueItems()}})),r.willUpdateRecord.clear()},this.batchUpdate=Object(b.debounce)(this.syncUpdate),this.getCalculateCatalogueItems=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;return n&&(r.initRecordMap=n),e.forEach((function(e){try{var n=r.getRecord(e);n&&r.initRecord(n)}catch(o){console.log("error:",o)}})),r.initRecordMap=null,r.calculateCatalogueItems()},this.updateRect=function(e){return e.map((function(e){return N(N({},e),{},{rect:r.getBlockRect(e.recordId)})}))},this.calculateCatalogueItems=function(){return Object(b.flow)((function(e){return Object(P.T)(e)}),(function(e){var n;return e.map((function(e){var o=e.columnInfo;return e.hightlightable=!0,!r.gridColumnIsDisplayBlock&&n&&o&&n.parentRecordId===o.parentRecordId&&o.position>n.position?e.hightlightable=!1:n=o,e}))}),(function(e){var n=new Set;e.forEach((function(e){return 0!==e.sourceLevel&&n.add(e.sourceLevel)}));var r=a()(n).sort();return e.map((function(e){return N(N({},e),{},{level:e.sourceLevel===A.z?1:r.indexOf(e.sourceLevel)+1})}))}),r.updateRect,(function(e){var n=1/0;return e.map((function(e){var r=e.level,o=e.folded,i=r>n,c=N(N({},e),{},{hidden:i});return i||(n=o?r:1/0),c}))}))(r.getHeadingInfoToMap())},this.calculateActiveCatalogue=function(e){return e?e.filter((function(e){return e.hightlightable})).find((function(e,n,o){var i=n+1;if(i>=o.length)return!0;var c=o[i];if(c){var a=Object(k.h)(r.scroller)-Object(_.y)();return Math.floor(c.rect.top-a)>A.j}return!1})):null},this.updateActiveCatalogue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.catalogueList;if(!r.ignoreUpdateActiveTimer){var n=r.calculateActiveCatalogue(e);n&&r.activeRecordId!==n.recordId&&(r.activeRecordId=n.recordId,r.catalogueEvent.updateActiveCatalogue(r.activeRecordId),m.S.isOpendoc&&Object(g.sendOpendocEvent)(g.OPENDOC_EVENT.CURR_ANCHOR,r.activeRecordId))}},this.throttleUpdateActiveCatalogue=Object(b.throttle)(this.updateActiveCatalogue,A.m,{trailing:!0}),this.throttleScrollUpdateActiveCatalogue=Object(b.throttle)((function(){r.catalogueList&&(r.catalogueList=r.updateRect(r.catalogueList)),r.updateActiveCatalogue()}),A.m,{trailing:!0}),this.updateCatalogueItems=function(){var e,n=r.isDataReady,o=Boolean(null===(e=r.lazyRecord)||void 0===e?void 0:e.isPreEditableEnable());if(n||!o||!r.hasNoSSRCatalogItemData){var i=r.calculateCatalogueItems();j.a.getState().appState.translate.status.translated&&i.forEach((function(e){e.text=r.headingModule.getHeadingText(e.recordId,!0)})),n?Object(b.isEqual)(i,r.catalogueList)||(r.catalogueList=i,r.notifyCatalogueUpdateAndUpdateActiveCatalogue(i)):o&&r.updateCatalogueBaseonInitialCatalogue(i)}},this.debounceUpdateCatalogueItems=Object(b.debounce)(this.updateCatalogueItems,A.m,{trailing:!0,maxWait:A.O}),this.handleScroll=function(){r.throttleScrollUpdateActiveCatalogue()},this.handleResize=function(e){var n=e.containerWidth;n!==e.preContainerWidth&&(r.gridColumnIsDisplayBlock=n<=600,r.debounceUpdateCatalogueItems())},this.handleForceActive=function(e){r.activeRecordId!==e&&(r.activeRecordId=e,r.catalogueEvent.updateActiveCatalogue(r.activeRecordId),r.ignoreUpdateActiveTimer&&window.clearTimeout(r.ignoreUpdateActiveTimer),r.ignoreUpdateActiveTimer=window.setTimeout((function(){r.ignoreUpdateActiveTimer=0}),A.O))},this.handleDataReady=function(){r.isDataReady=!0,r.initialCatalogItemMap.clear(),r.clearSSRHeadingInfoMap(),r.willUpdateRecord.size&&(r.batchUpdate.cancel(),r.syncUpdate()),r.debounceUpdateCatalogueItems()},this.blockManager=o,this.catalogueEvent=new D.S,this.scroller=c,this.rect=i,this.eventEmitter=l,this.headingModule=u,this.lazyRecord=f,this.hasNoSSRCatalogItemData=Object(b.isUndefined)(h)&&Object(b.isUndefined)(y);var O=[];this.hasNoSSRCatalogItemData||((null===h||void 0===h?void 0:h.length)&&(O=h),y&&(O=this.getCalculateCatalogueItems(Object.keys(y),y))),this.hasNoSSRCatalogItemData=void 0===h,this.initialCatalogItemMap=new Map(O.map((function(e){return r.addHeadingInfoToSSRMap(e),[e.recordId,e]}))),this.init()}return h()(e,[{key:"addHeadingInfoToSSRMap",value:function(e){var n=e.recordId,r=e.sourceLevel,o=e.text,i=e.folded,c=e.positionPath,a=e.columnInfo;this._ssrHeadingMap.set(n,{recordId:n,sourceLevel:r,text:o,folded:i,positionPath:c,columnInfo:a})}},{key:"addHeadingInfoToMap",value:function(e,n){this._ssrHeadingMap.set(e,n),this._headingMap.set(e,n)}},{key:"getHeadingInfoToMap",value:function(){var e;return!this.isDataReady&&(null===(e=this.lazyRecord)||void 0===e?void 0:e.isPreEditableEnable())?this._ssrHeadingMap:this._headingMap}},{key:"hasHeadingInfo",value:function(e){return this.getHeadingInfoToMap().has(e)}},{key:"removeHeadingInfo",value:function(e){this._ssrHeadingMap.delete(e),this._headingMap.delete(e)}},{key:"clearHeadingInfoMap",value:function(){this._headingMap.clear()}},{key:"clearSSRHeadingInfoMap",value:function(){this._ssrHeadingMap.clear()}},{key:"generateCatalogueDataForOpenDocx",value:function(){return this.generateCatalogueDataForOpenDocxByCatalogueItems(this.catalogueList||[])}},{key:"generateCatalogueDataForOpenDocxByCatalogueItems",value:function(e){var n=this;return e.map((function(e){var r=e.text,o=e.recordId,i=e.level;if(n.blockManager.getRecord(o).snapshot.type!==x.B.PAGE)return{anchor:o,indentLevel:i,text:r}})).filter((function(e){return!!e}))}},{key:"init",value:function(){this.scroller.addEventListener("scroll",this.handleScroll);var e=this.blockManager.modelService;this.subs=[e.initialDataReady$.subscribe(this.handleInitialDataReady),e.blockModelStructUpdate$.subscribe(this.handleBlockModelStructUpdate),e.blockModelUpdate$.subscribe(this.handleBlockModelUpdate)],this.blockManager.addListener(S.m,this.handleUpdate),this.blockManager.addListener(T.t.FORCE_UPDATE,this.handleUpdate),this.blockManager.addListener(w.G,this.handleResize),B.S.addListener(O.H.LocateBlockWithRecordId,this.handleForceActive),this.eventEmitter.on(C.R.CLIENTVAR_APPLY_ALL_DONE,this.handleDataReady),this.eventEmitter.on(R.w2,this.debounceUpdateCatalogueItems),B.S.on(W,this.debounceUpdateCatalogueItems),B.S.on(G,this.debounceUpdateCatalogueItems),B.S.on(z,this.debounceUpdateCatalogueItems),m.S.isOpendoc&&Object(g.registerOpendocApi)(g.OPENDOC_API.getDirectoryData,this.generateCatalogueDataForOpenDocx.bind(this))}},{key:"destroy",value:function(){var e;this.catalogueList=null,this.clearHeadingInfoMap(),this.clearSSRHeadingInfoMap(),this.insertingRecordIdSet.clear(),this.batchUpdate.cancel(),this.debounceUpdateCatalogueItems.cancel(),this.throttleUpdateActiveCatalogue.cancel(),this.scroller.removeEventListener("scroll",this.handleScroll),null===(e=this.subs)||void 0===e||e.forEach((function(e){return e.unsubscribe()})),this.subs=null,this.blockManager.removeListener(S.m,this.handleUpdate),this.blockManager.removeListener(T.t.FORCE_UPDATE,this.handleUpdate),this.blockManager.removeListener(w.G,this.handleResize),B.S.removeListener(O.H.LocateBlockWithRecordId,this.handleForceActive),this.ignoreUpdateActiveTimer=0,this.eventEmitter.off(C.R.CLIENTVAR_APPLY_ALL_DONE,this.handleDataReady),this.eventEmitter.off(R.w2,this.debounceUpdateCatalogueItems),B.S.off(W,this.debounceUpdateCatalogueItems),B.S.off(G,this.debounceUpdateCatalogueItems),B.S.off(z,this.debounceUpdateCatalogueItems)}},{key:"getHeadingInfo",value:function(e){var n={isHeading:!1,sourceLevel:0},r=e.get(["type"])||"",o=Object(y.V)(r);return o&&(n.isHeading=!0,n.sourceLevel=o),"page"===r&&(n.isHeading=!0,n.sourceLevel=A.z),n}},{key:"getPositionInfoForLegalContainer",value:function(e){var n,r=e,o=e.get(["parent_id"])?this.getRecord(e.get(["parent_id"])):null,i=[];do{if(null===o)i.unshift([0,null]);else{var c=o.get(["type"]);if(A.R.includes(c))return null;var a=o.get(["children"]),l=a?a.findIndex((function(e){return e===r.id})):0;i.unshift([l,o.id]),r.get(["type"])===x.B.GRID_COLUMN&&(n={position:l,parentRecordId:o.id}),r=o,o=o.get(["parent_id"])?this.getRecord(o.get(["parent_id"])):null}}while(null!==o&&o!==r);return{positionPath:i,columnInfo:n}}},{key:"removeHeadingMapData",value:function(e){var n,r=this.blockManager.getRecord(e).snapshot.type;!this.isDataReady&&(null===(n=this.lazyRecord)||void 0===n?void 0:n.isPreEditableEnable())&&this.initialCatalogItemMap.has(e)&&r!==x.B.PENDING&&this.initialCatalogItemMap.delete(e),this.hasHeadingInfo(e)&&(this.removeHeadingInfo(e),this.debounceUpdateCatalogueItems())}},{key:"setHeadingMapData",value:function(e,n){var r=this.headingModule.getHeadingText(e.id,!1,e);if(this.isChangePageTitle=n===A.z,r){var o=r.split("\n");o=o.filter((function(e){return e}));var i=o.join(" ");if(i){var c={recordId:e.id,sourceLevel:n,text:i,folded:e.get(["folded"]),positionPath:[]},a=this.getPositionInfoForLegalContainer(e);a?(c.positionPath=a.positionPath,c.columnInfo=a.columnInfo,this.addHeadingInfoToMap(e.id,c),this.debounceUpdateCatalogueItems.cancel(),this.debounceUpdateCatalogueItems()):this.removeHeadingMapData(e.id)}else this.removeHeadingMapData(e.id)}else this.removeHeadingMapData(e.id)}},{key:"initRecord",value:function(e){var n=this.getHeadingInfo(e),r=n.isHeading,o=n.sourceLevel;r&&(this.batchUpdate(),this.setHeadingMapData(e,o))}},{key:"getBlockRect",value:function(e){var n=this.blockManager.getBlockIdsByRecordId(e)[0];return this.blockManager.hasBlockModelByBlockId(n)&&this.rect.getBlockRect(n)||Object(E.b)()}},{key:"getRecord",value:function(e){if(this.initRecordMap){var n=this.initRecordMap[e];return e&&n?new v.R(e,n.data):null}return this.blockManager.recordManager.hasRecord(e)?this.blockManager.recordManager.getRecord(e):null}},{key:"notifyCatalogueUpdateAndUpdateActiveCatalogue",value:function(e){this.catalogueEvent.updateCatalogueItems(e),this.blockManager.dispatch(A.v.CATALOGUE_UPDATE,!1),this.throttleUpdateActiveCatalogue(e),m.S.isOpendoc&&!this.isChangePageTitle&&Object(g.sendOpendocEvent)(g.OPENDOC_EVENT.DIRECTORY_CHANGE,this.generateCatalogueDataForOpenDocxByCatalogueItems(e))}},{key:"updateCatalogueBaseonInitialCatalogue",value:function(e){for(var n=Array.from(this.initialCatalogItemMap.values()),r=new Map,o=0,i=n.length;o<i;o++){var c=n[o];r.set(c.recordId,o)}for(var l=e.length,s=l-1;s>=0;){var u=e[s].recordId,d=r.get(u);if("undefined"!==typeof d){var f=e.slice(s,l);n.splice.apply(n,[d,1].concat(a()(f))),l=s}s-=1}if(0!==l){var h=e.slice(s,l);n.unshift.apply(n,a()(h))}this.initialCatalogItemMap=new Map(n.map((function(e){return[e.recordId,e]}))),this.notifyCatalogueUpdateAndUpdateActiveCatalogue(n)}}]),e}()}).call(this,r("dx_o8ox"))},dx_Bapk:function(e,n,r){"use strict";r.d(n,"M",(function(){return l}));var o=r("dx_PcQO"),i=r("dx_cDcd"),c=r.n(i),a=r("dx_yzqx"),l=function(e){return c.a.createElement(o.Tooltip,Object.assign({disabled:a.S.isMobile},e))}},dx_BjZo:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return u}));var e=r("dx_cDcd"),o=r.n(e),i=r("dx_mvce"),c=(r("dx_KHyL"),r("dx_bQQe"));function a(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return l(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw c}}}}function l(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var s="docx-vc-recorder-block-place-holder";function u(){var e=o.a.useRef();return o.a.useEffect((function(){var n=e.current;if(n){var r=Object(i.J)((function(e){var n,r=a(e);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.contentRect.height<=130?o.target.classList.add("".concat(s,"-sm")):o.target.classList.remove("".concat(s,"-sm"))}}catch(i){r.e(i)}finally{r.f()}}));return r.observe(n),function(){r.unobserve(n),r.disconnect()}}}),[]),o.a.createElement("div",{className:s,ref:e},o.a.createElement("div",{className:"".concat(s,"-icon")},o.a.createElement(c.S,null)),o.a.createElement("div",{className:"".concat(s,"-text")},t("CreationDoc_Minutes_UnableToRecord_Subtitle")))}}).call(this,r("dx_E9Eu"))},dx_BmAg:function(e,n,r){"use strict";function o(e){return e.docx.comment.commentPanelShown}function i(e){return e.docx.comment.isCommentNumbersShow}function c(e){return e.docx.comment.helpPanelShown}r.d(n,"I",(function(){return o})),r.d(n,"j",(function(){return i})),r.d(n,"x",(function(){return c}))},dx_BrJR:function(e,n,r){"use strict";r.d(n,"B",(function(){return f})),r.d(n,"j",(function(){return h})),r.d(n,"e",(function(){return v})),r.d(n,"l",(function(){return g})),r.d(n,"w",(function(){return b})),r.d(n,"jU",(function(){return m})),r.d(n,"d",(function(){return _}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_yzqx"),a=r("dx_B28d"),l=r("dx_IdzY"),s=r("dx_ZG9w"),u=r("dx_eGDr"),d=[a.B.DIVIDER,a.B.TASK];function f(e){return"comment-id-".concat(e)}function h(e){var n="2px solid var(--Y200)",r=[".".concat(e,":not(.canvas-comment):not(.block-comment):not(.comment-inline-code-wrapper):not(.equation-leaf),\n    .").concat(e,".block-comment .block-inline-text {\n      border-bottom: ").concat(n,";\n      padding-bottom: 2px;\n      padding-top: 2px;\n      --abbreviation-border-image-source: var(--abbreviation-border-comment);\n      --abbreviation-hover-border-image-source: var(--abbreviation-border-comment-hover);\n    }"),".".concat(e,".block-comment:not(.comment-hl):not(.local-comment) .isv-block-container:after {\n      content: '';\n      position: absolute;\n      left: 0;\n      right: 0;\n      bottom: -4px;\n      height: 2px;\n      background: var(--ccmtoken-mindnote-highlightcolor-yellow);\n    }"),".".concat(e,".block-comment:not(.comment-hl):not(.local-comment) .poll-block__container:after {\n      content: '';\n      position: absolute;\n      left: 0;\n      right: 0;\n      bottom: -4px;\n      height: 2px;\n      background: var(--ccmtoken-mindnote-highlightcolor-yellow);\n    }"),".".concat(e,".block-comment:not(.comment-hl):not(.local-comment) > .task-block__container:after {\n      content: '';\n      position: absolute;\n      left: 0;\n      right: 0;\n      bottom: -1px;\n      height: 2px;\n      background: var(--ccmtoken-mindnote-highlightcolor-yellow);\n    }"),".".concat(e,".block-comment:not(.comment-hl):not(.local-comment) .docx-bookmark-wrapper:after {\n      content: '';\n      position: absolute;\n      left: 0;\n      right: 0;\n      bottom: -4px;\n      height: 2px;\n      background: var(--ccmtoken-mindnote-highlightcolor-yellow);\n    }")].concat(i()([".".concat(e,".block-comment")+":not(.image-block-comment):not(.view-block-comment):not(.file-block-comment):not(.isv-block-comment):not(.sheet-block-comment):not(.bitable-block-comment):not(.iframe-block-comment):not(.poll-block-comment):not(.task-block-comment):not(.bookmark-block-comment):not(.chat_card-block-comment)::after",".".concat(e,".block-comment .docx-file-block-container.docx-view-type-Card::after"),".".concat(e,".block-comment .docx-file-block-container.docx-view-type-Preview::after"),".".concat(e,".block-comment .spreadsheet::after"),".".concat(e,".block-comment .chat-card-inner:after"),".".concat(e,".block-comment .iframe-container::after"),".".concat(e,".block-comment .image-block-width-wrapper::after")].map((function(e){return"".concat(e," {\n      content: '';\n      position: absolute;\n      left: 0;\n      right: 0;\n      bottom: -3px;\n      height: 2px;\n      background: var(--ccmtoken-mindnote-highlightcolor-yellow);\n    }")}))),[" .".concat(e,".block-comment .bitable-block-container {\n      border-bottom: solid 2px var(--ccmtoken-mindnote-highlightcolor-yellow);\n    }"),".".concat(e,".block-comment .file-card::after,\n    .").concat(e,".block-comment .iframe-container::after {\n      bottom: -4px;\n    }"),".".concat(e,".block-comment .iframe-container::after {\n      left: -1px;\n      right: -1px;\n    }"),".".concat(e,".block-comment.divider-block-comment::after {\n      bottom: 50% !important;\n      transform: translateY(3px);\n      pointer-events: none;\n    }"),".comment-inline-code-wrapper.".concat(e," .inline-code {\n      border-bottom: ").concat(n,";\n      padding-bottom: 1px;\n    }"),".".concat(e,".equation-leaf:not(.comment-hl):not(.local-comment) .editor-kit-equation-view::after {\n      border-bottom: ").concat(n,";\n    }"),".grid-column-block .".concat(e,":not(.canvas-comment):not(.block-comment) {\n      padding-bottom: 1px;\n    }"),".table .table-cell-block .text-editor:not(.translated) span.abbreviation.".concat(e," {\n      border-image-slice: 2 3;\n      border-bottom-width: 2px !important;\n      border-image-source: var(--abbreviation-comment-table) !important;\n    }"),".table .table-cell-block .text-editor:not(.translated) span.abbreviation.".concat(e,":hover {\n      border-image-source: var(--abbreviation-comment-table-hover) !important;\n    }"),".table .table-cell-block .text-editor:not(.translated) span.abbreviation.comment-hl.".concat(e," {\n      border-image-source: var(--abbreviation-comment-table-highlight) !important;\n    }"),".table .table-cell-block .text-editor:not(.translated) span.abbreviation.comment-hl.".concat(e,":hover {\n      border-image-source: var(--abbreviation-comment-table-highlight-hover) !important;\n    }"),".grid-column-block .docx-todo-block span.".concat(e," {\n      padding-bottom: 1px !important;\n    }")]);return["body:not(.docx-screenshoting) .page-main .page-block","body:not(.docx-screenshoting) .presentation-mode.document .page-block"].reduce((function(e,n){return e.concat(r.map((function(e){return"".concat(n," ").concat(e)})))}),[])}function p(e,n,r,o){if(!(o<r)){var i=n(e[o]);if(0===(null===i||void 0===i?void 0:i.index))return i.index=o,i;var c=n(e[r]);if(0===(null===c||void 0===c?void 0:c.index))return c.index=r,c;for(;o-r>1;){var a=Math.floor((r+o)/2),l=n(e[a]);if(void 0===l)return;var s=l.index;if(0===s)return l.index=a,l;if(s<0)o=a;else{if(!(s>0)){var u=p(e,n,r,a-1);return u||(u=p(e,n,a+1,o)),u}r=a}}}}function v(e,n,r,o){var i=p(e,(function(e){var n=r.getBlockClientRect(e);if(!n)return{index:NaN};var i=n.top,c=n.height;return o<i?{index:-1}:o>i+c?{index:1}:{index:0}}),0,e.length-1);if(i){var c=e[i.index],l=n.getBlockModelByBlockId(c);if(!(l.type===a.B.GRID)){var s=l.children.map((function(e){return e.id})),u=s.length?v(s,n,r,o):void 0;return void 0!==u?u:c}}}function g(e){return e.type===a.B.CODE}var b=function e(n,r){var o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=n;if(i.type===a.B.PAGE||!i.props.parentId)return!1;var c=i.props.parentId,l=r.getBlockViewByBlockIdNotCheck(c);return!!l&&(l.type===a.B.CELL||(o?e(l,r):!![a.B.GRID,a.B.GRID_COLUMN,a.B.VIEW,a.B.QUOTE_CONTAINER].includes(l.type)&&e(l,r,!1)))},y=[a.B.CODE,a.B.OBJECTIVE,a.B.KEY_RESULT],m=function(e,n,r){if(Object(s.f)(e)){var o=e.model.isEmpty,i=null,c=e.model.zoneState.getContent().ops.every((function(e){if(e.attributes){var n=Object.keys(e.attributes).find((function(e){return e.startsWith("".concat(l.I,"comment-id-"))}));if(n)return i=n.slice("".concat(l.I,"comment-id-").length),!0}return!1})),a=b(e,n);return{shouldShowBtn:!o&&!c&&!y.includes(e.type)&&!a,tempCommentId:i}}if(d.some((function(n){return e.type===n}))&&!b(e,n)){var u=r.findTempCommentsByRecordId(e.record.id);return u.length>0?{shouldShowBtn:!1,tempCommentId:u[0]}:{shouldShowBtn:!0,tempCommentId:null}}return{shouldShowBtn:!1,tempCommentId:null}},_=function(e){for(var n=e,r=c.S.isLarkFeed?"comment-textarea":u.Z;n&&!(n instanceof Element);)n=n.parentElement;return!!n&&!!n.closest(".".concat(r))}},dx_Bs0J:function(e,n,r){"use strict";r.d(n,"o",(function(){return i}));var o=r("dx_cDcd"),i=r.n(o).a.createContext(null)},dx_Bs5u:function(e,n,r){"use strict";(function(t){r.d(n,"A",(function(){return e})),r.d(n,"B",(function(){return i})),r.d(n,"j",(function(){return c})),r.d(n,"w",(function(){return a})),r.d(n,"V",(function(){return l}));var e,o=r("dx_B28d");!function(e){e.add="__edit_add",e.del="__edit_del",e.change="__edit_change"}(e||(e={}));var i="__origin_id";function c(n,r){return e.add===n?t("history.edit_add",{},"",r):e.del===n?t("history.edit_del",{},"",r):e.change===n?t("history.edit_change",{},"",r):new Error("Invalid edit type")}var a=["folded","done","emoji_id","cover"],l=new Set([o.B.HEADING1,o.B.HEADING2,o.B.HEADING3,o.B.HEADING4,o.B.HEADING5,o.B.HEADING6,o.B.HEADING7,o.B.HEADING8,o.B.HEADING9,o.B.HEADINGN,o.B.TEXT,o.B.BULLET,o.B.ORDERED,o.B.REFERENCE,o.B.TODO,o.B.QUOTE])}).call(this,r("dx_E9Eu"))},dx_C1Ca:function(e,n,r){"use strict";var o;r.d(n,"q",(function(){return o})),function(e){e.preprocessData="preprocessData",e.beforeBlockDataApply="beforeBlockDataApply",e.onDataApply="onDataApply",e.onDataAccept="onDataAccept",e.afterBlockIdCreated="afterBlockIdCreated"}(o||(o={}))},dx_C3pj:function(e,n,r){"use strict";(function(t){r.d(n,"K",(function(){return c}));var e=r("dx_cDcd"),o=r.n(e),i=r("dx_xlCA");function c(e){var n=e.length,r=!1;return e.reduce((function(e,o,c){var a=i.n.getUserShowName(o.uid);return e.length>35&&!r&&c>0?(r=!0,e+="...".concat(t("reminder.popover.lastPeople",{},"","".concat(n-c)))):r?e:e+="".concat(a).concat(c!==n-1?t("CreationDoc_DocX_common_punctuation_comma"):"")}),t("reminder.popover.remind")+t("CreationDoc_DocX_common_punctuation_colon"))}n.S=function(e){var n=c(e.users);return o.a.createElement("p",{className:"user-text"},n)}}).call(this,r("dx_E9Eu"))},dx_C4C6:function(e,n,r){"use strict";function o(e){if(!e)return{seqNumber:"",seqPrefix:""};for(var n=e.split(".");n.length>1;){var r=n.pop();if(r)return{seqNumber:r,seqPrefix:"".concat(n.join("."),".")}}return{seqNumber:n[n.length-1],seqPrefix:""}}function i(e,n,r){if(!n||!r)return!1;var i=n.recordId,c=e.getOrderText(i),a=o(r),l=a.seqNumber,s=a.seqPrefix,u=o(c),d=u.seqNumber;return s===u.seqPrefix&&Number(l)===Number(d)+1}r.d(n,"y",(function(){return o})),r.d(n,"W",(function(){return i}))},dx_C5gi:function(e,n,r){"use strict";(function(t){var e,o,i,c,a,l=r("dx_o0o1"),s=r.n(l),u=r("dx_yXPU"),d=r.n(u),f=r("dx_yG8O"),h=r.n(f),p=r("dx_lwsE"),v=r.n(p),g=r("dx_W8MJ"),b=r.n(g),y=r("dx_PJYZ"),m=r.n(y),_=r("dx_iWIM"),k=r.n(_),O=r("dx_W7W2"),x=r.n(O),E=r("dx_a1gu"),S=r.n(E),C=r("dx_Nsbk"),I=r.n(C),B=r("dx_Uyc2"),T=r.n(B),w=(r("dx_A1AB"),r("dx_UtDZ")),R=r("dx_PQBD"),M=r("dx_B28d"),j=r("dx_NMQJ"),D=r("dx_U9rT"),A=r("dx_x1WV"),P=r("dx_LCSr");function L(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=I()(e);if(n){var i=I()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return S()(this,r)}}var N=(a=c=function(e){x()(r,e);var n=L(r);function r(e){var c;return v()(this,r),c=n.call(this,e),h()(c,"depLoader",o,m()(c)),h()(c,"blockManager",i,m()(c)),c.onDestroy=function(){var e=c.blockManager.getBlockViewByBlockIdNotCheck(c.id);null===e||void 0===e||e.unmount(!0)},c}return b()(r,[{key:"handleInternalPaste",value:function(){var e=d()(s.a.mark((function e(n){var r,o,i,c,a=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=null,e.t0=n.type,e.next="define"===e.t0?4:"nodes"===e.t0?6:8;break;case 4:return r=Object(P.O)(n.data),e.abrupt("break",9);case 6:return r={content:{nodes:n.data}},e.abrupt("break",9);case 8:return e.abrupt("break",9);case 9:if(o="",e.prev=10,!r){e.next=19;break}return i=JSON.stringify(r.content),c=this.depLoader.getDepLoader(),e.next=16,c.generateMindnoteToken(this.id,i,r.title);case 16:o=e.sent,e.next=20;break;case 19:throw new Error("mindmap data is null");case 20:e.next=26;break;case 22:return e.prev=22,e.t1=e.catch(10),Object(R.K)(this.modelService,this.id,t("common.operation_failed"),e.t1),e.abrupt("return");case 26:this.applyTransaction("updateMindmapBlock",(function(e){var n;try{n=a.modelService.getRecordByBlockId(a.id).id}catch(r){return void console.error("updateMindmapBlock error",r)}e.replace(n,["token"],o)}),{undoable:!1});case 27:case"end":return e.stop()}}),e,this,[[10,22]])})));return function(n){return e.apply(this,arguments)}}()},{key:"loadBridgeImpl",value:function(){return this.depLoader.getDepLoader().getBridge()}},{key:"handleCloneBlockByToken",value:function(){var e=d()(s.a.mark((function e(n){var r,o,i=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(w.isOnline)()){e.next=2;break}return e.abrupt("return",Object(R.K)(this.modelService,this.id,t("CreationDoc_Common_NetworkDisconnected_UnableToCreate")));case 2:return e.prev=2,r=this.depLoader.getDepLoader(),e.next=6,r.cloneMindnoteByToken(this.id,n);case 6:o=e.sent,this.applyTransaction("updateMindmapBlock",(function(e){var n;try{n=i.modelService.getRecordByBlockId(i.id).id}catch(r){return void console.error("updateMindmapBlock error",r)}e.replace(n,["token"],o)}),{undoable:!1}),e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(2),Object(R.K)(this.modelService,this.id,t("common.operation_failed"),e.t0),e.abrupt("return");case 14:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(n){return e.apply(this,arguments)}}()},{key:"onPasteRecordAfterApply",value:function(e){if(!Object(w.isOnline)())return k()(I()(r.prototype),"onPasteRecordAfterApply",this).call(this,e);var n=e.html,o=e.initData,i=e.token;try{if(o){var c={type:"define",data:o};return this.handleInternalPaste(c)}if(n){if(n.querySelector("[data-meta-block-props]")){var a,l=(null===(a=n.querySelector("[data-meta-block-props]"))||void 0===a?void 0:a.dataset.metaBlockProps)||"",s=JSON.parse(l).initData,u=void 0===s?"":s,d={type:"define",data:JSON.parse(unescape(u))};return this.handleInternalPaste(d)}var f=n.dataset.json||"",h=JSON.parse(decodeURIComponent(f));return this.handleInternalPaste(h)}if(i)return this.handleCloneBlockByToken(i)}catch(p){console.error("mindmap onPasteRecordAfterApply error",p),Object(R.K)(this.modelService,this.id,t("common.operation_failed"))}}},{key:"getText",value:function(){return"[".concat(t("mindnote.block_menu_item_name"),"]")}}]),r}(j.D),c.type=M.B.MINDMAP,e=a,o=T()(e.prototype,"depLoader",[D.i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=T()(e.prototype,"blockManager",[A.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e);n.S=N}).call(this,r("dx_E9Eu"))},dx_C5ob:function(e,n,r){},dx_C7nA:function(e,n,r){},dx_CH2c:function(e,n,r){"use strict";r.d(n,"c",(function(){return s}));var o=r("dx_cDcd"),i=r.n(o),c=r("dx_TSY5");function a(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return l(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw c}}}}function l(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function s(e){var n,r=e.text,o=[],l=0,s=a(Object(c.d)(r));try{for(s.s();!(n=s.n()).done;){var u=n.value;u-l>0&&o.push(i.a.createElement("span",null,r.substring(l,u))),o.push(i.a.createElement("span",{className:"auto-space"},r.substr(u,1))),l=u+1}}catch(d){s.e(d)}finally{s.f()}return r.length>l&&o.push(i.a.createElement("span",null,r.substring(l))),i.a.createElement(i.a.Fragment,null,o)}},dx_CMSf:function(e,n,r){"use strict";r.d(n,"p",(function(){return o}));var o=new(r("dx_wSgM").M)({hyperlink:{mark:!0,tailInherit:!1,refresh:!0}})},dx_CN0g:function(e,n,r){},dx_CQNR:function(e,n,r){"use strict";(function(t){r.d(n,"j",(function(){return M}));var e=r("dx_VkAN"),o=r.n(e),i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_J4zp"),u=r.n(s),d=r("dx_QILm"),f=r.n(d),h=r("dx_vF1F"),p=r("dx_OKGb"),v=r("dx_PcQO"),g=r("dx_TSYQ"),b=r.n(g),y=r("dx_cDcd"),m=r.n(y),_=r("dx_h74D"),k=r("dx_FUAQ"),O=r("dx_yzqx"),x=r("dx_TfZh"),E=r("dx_E2oU"),S=r("dx_IWVf"),C=r("dx_lUPZ"),I=r("dx_QbWy"),B=r("dx_U2Uz"),T=r("dx_Cgrk"),w=r("dx_eNHK");function R(){var e=o()(["\n                  .ud__popover-content {\n                    padding: 0;\n                    border: 0;\n                  }\n                "]);return R=function(){return e},e}var M=m.a.memo((function(e){var n=e.isCurrentUserVoted,r=e.isEdit,o=e.progress,i=void 0===o?0:o,a=e.isAnonymous,s=void 0===a||a,d=e.isPublished,g=void 0!==d&&d,M=e.isHistory,j=void 0!==M&&M,D=e.isMultiple,A=void 0!==D&&D,P=e.text,L=e.order,N=e.votes,F=void 0===N?[]:N,U=e.emojiId,H=e.onEmojiChange,V=e.onTextChange,W=e.onRemove,z=e.id,G=e.voteResultVisible,K=e.disabled,q=e.recordId,X=e.deleteButtonVisible,Y=e.total,J=e.onFetchVotes,Z=f()(e,["isCurrentUserVoted","isEdit","progress","isAnonymous","isPublished","isHistory","isMultiple","text","order","votes","emojiId","onEmojiChange","onTextChange","onRemove","id","voteResultVisible","disabled","recordId","deleteButtonVisible","total","onFetchVotes"]),Q=Object(y.useMemo)((function(){return G&&!K}),[G,K]),$=Object(_.useSelector)(E.L).get("id"),ee=Object(y.useMemo)((function(){var e=F.slice(0),n=e.findIndex((function(e){return e.userId===$}));if(n>=0){var r=e.splice(n,1),o=u()(r,1)[0];e.unshift(o)}return e}),[F,$]),te=Object(y.useRef)(null),ne=Object(y.useMemo)((function(){return!!U}),[U]),re=Object(x.S)(Object(y.useCallback)((function(e){null===H||void 0===H||H(z,e)}),[H,z]),150),oe=Object(y.useCallback)((function(e){e.stopPropagation(),e.preventDefault(),re(ne?I.h:I.y)}),[ne,re]),ie=m.a.useCallback((function(e){null===V||void 0===V||V(z,e)}),[z,V]),ce=Object(y.useCallback)((function(e){e.stopPropagation(),F.length?v.Dialog.info({title:t("block.poll_warning"),content:t("CreationDoc_Docs_Block_DeleteOption_Placeholder"),enableCancelButton:!0,onOk:function(){null===W||void 0===W||W(z)},okText:t("block.poll_confirm_ok"),cancelText:t("block.poll_confirm_cancel")}):null===W||void 0===W||W(z)}),[z,W,F]),ae=Object(y.useState)("".concat(q,"-option-toast")),le=u()(ae,1)[0],se=Object(y.useCallback)((function(){v.toast.warn({key:le,content:t("CreationDoc_Docs_Poll_CannotVote_Toast")})}),[le]),ue=function(e,n){var r;O.S.isBytedanceApp&&O.S.isMobile?(null===(r=window.getSelection())||void 0===r||r.removeAllRanges(),e.preventDefault(),e.stopPropagation(),k.S.getInstance().showAuthPanel({userId:n,userName:""})):e.stopPropagation()},de=Object(y.useCallback)(l()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===J||void 0===J?void 0:J(z);case 2:case"end":return e.stop()}}),e)}))),[J,z]),fe=!r&&ne;return m.a.createElement("div",Z,m.a.createElement("div",{style:{display:"flex"}},m.a.createElement("div",Object.assign({style:{flex:1,display:"flex",alignItems:"center",cursor:r||K?"unset":"pointer"}},r||K?null:{onClick:oe},j||g?null:{onClick:se}),m.a.createElement("div",{style:{flex:"1 1",position:"relative",overflow:"hidden",borderRadius:6}},m.a.createElement(C.I,{recordId:q,style:{color:fe?"var(--B600)":"",padding:r?"":"5px 12px"},className:b()("poll-option-input","poll-block-input__".concat(z),{disabled:K,checked:fe,voted:n}),focusedStyle:{backgroundColor:"transparent"},ref:te,showResult:Q,editable:r,placeholder:t("common.enter_placeholder"),value:j?void 0:P,onChange:ie,prefix:j?void 0:L,suffix:!j&&Q?m.a.createElement("div",{style:{display:"flex",alignItems:"center",color:fe?"var(--B600)":"var(--N600)"}},m.a.createElement("span",null,t("block.poll_x_votes",{},"","".concat(Y))),m.a.createElement("span",{style:{marginLeft:8}},t("CreationDoc_Docs_Poll_Voted_Percent",{},"",i.toFixed(1)))):null,suffixStyle:{marginLeft:20},maxLength:[I.Q,t("block.poll_option_exceeded",{},"","".concat(I.Q))]}),m.a.createElement(T.W,{progress:i,isShow:Q})),!r&&m.a.createElement("div",{style:{marginLeft:6,display:"flex",justifyContent:"center",alignItems:"center"}},s?m.a.createElement(B.y,{disabled:K,emojiId:j?"":U,onEmojiChange:re}):m.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:32,height:32}},A?m.a.createElement(v.Checkbox,{checked:!j&&ne,disabled:K}):m.a.createElement(C.C,{checked:!j&&ne,disabled:K})))),r&&m.a.createElement("div",{style:{marginLeft:6,display:"flex",justifyContent:"center",alignItems:"center",width:32}},X&&m.a.createElement(C.W,{onClick:ce,icon:m.a.createElement(p.S,{style:{fontSize:18,color:"var(--N600)"}})}))),m.a.createElement(w.R,{style:{marginTop:Q&&ee.length>0?8:""},votes:Q?ee:[],total:Y,onFetchVotes:de,renderVote:function(e){return s?m.a.createElement(S.D,{code:e.emojiId,size:24}):m.a.createElement("div",{style:{display:"flex",width:"100%",height:"100%",borderRadius:"50%",overflow:"hidden"}},m.a.createElement(C.z,Object.assign({trigger:"click",showArrow:!1,placement:"rightBottom",overlayClassName:Object(h.Z)(R()),overlayStyle:{borderRadius:8},content:m.a.createElement(S.n,{userId:e.userId})},O.S.isMobile?{visible:!1}:null),m.a.createElement(v.Avatar,{src:e.avatar,size:"small",style:{cursor:"pointer"},onClick:function(n){return ue(n,e.userId)},onTouchStart:function(n){return ue(n,e.userId)},onTouchEnd:function(n){return ue(n,e.userId)},onTouchMove:function(n){return ue(n,e.userId)},onMouseDown:function(n){return ue(n,e.userId)}})))}}))}))}).call(this,r("dx_E9Eu"))},dx_CR0l:function(e,n,r){"use strict";var o,i,c;r.d(n,"e",(function(){return o})),r.d(n,"w",(function(){return i})),r.d(n,"E",(function(){return c})),function(e){e.CLICK_TODO_MENTION_PEOPLE_PANEL="click_todo_mention_people_panel",e.CLICK_TODO_DOC_REMINDER_PANEL="click_todo_doc_reminder_panel",e.CLICK_TODO_STATUS="click_todo_status",e.CLICK_IMAGE_ZOOM="click_image_zoom",e.CLICK_FILE="click_file",e.CLICK_FILE_PREVIEW_BUTTON="click_file_preview_button",e.CLICK_FILE_DOWNLOAD="click_file_download",e.CLICK_WEB_BOOKMARK="click_web_bookmark",e.CLICK_CHAT_CARD="click_chat_card",e.CLICK_VOTE="click_vote",e.CLICK_RESULT_SHOW_OPTION="click_result_show_option",e.EDIT_VOTE_OPTION="edit_vote_option",e.CHANGE_ICON="change_icon",e.EDIT_TABLE_FRAME="edit_table_frame",e.CLICK_ADD_PANEL="click_add_panel",e.CLICK_EQUATION="click_equation",e.CLICK_OPEN_JIRA="click_open_jira",e.CLICK_INFORMATION_COLLECT="click_information_collect",e.CLICK_COLLECT_OPTION="click_collect_option",e.CHOOSE_COLLECT_STYLE="choose_collect_style",e.CLICK_HELPDESK="click_helpdesk",e.CLICK_TODO_TURN_TASK="click_todo_turn_task",e.CLICK_TASK_NO_COMPLETE_PERMISSION_TIP="click_task_no_complete_permission_tip"}(o||(o={})),function(e){e.OPEN="open",e.JOIN="join",e.CANCEL="cancel",e.CONFIRM="confirm"}(i||(i={})),function(e){e.ADD_COLUMN="add_column",e.ADD_ROW="add_row",e.DELETE_COLUMN="delete_column",e.DELETE_ROW="delete_row"}(c||(c={}))},dx_CU16:function(e,n,r){"use strict";r.d(n,"i",(function(){return d}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_av9k"),d=function(){function e(){var n=this;a()(this,e),this.titleDOMMap=new Map,this.titleWidthMap=new Map,this.setTitleRef=function(e,r){r?n.titleDOMMap.set(e,r):n.titleDOMMap.delete(e)}}return s()(e,[{key:"updateTitleWidthMap",value:function(e){var n=this,r=e.prevListData,o=e.newListData,i=e.prevFullData,c=e.newFullData.reduce((function(e,n){return e.set(n.recordId,!0),e}),new Map);i.forEach((function(e){c.has(e.recordId)||n.titleWidthMap.delete(e.recordId)})),this.getAddedOrChangedItems(r,o).forEach((function(e){var r=e.id,o=e.level,i=n.calcTitleWidth(n.titleDOMMap.get(r),o);n.titleWidthMap.set(r,i)}),0)}},{key:"getMaxTitleWidth",value:function(){return 0===this.titleWidthMap.size?0:Math.max.apply(Math,i()(Array.from(this.titleWidthMap.values())))}},{key:"getAddedOrChangedItems",value:function(e,n){var r=new Map(e.map((function(e){return[e.recordId,e]}))),o=[];return n.forEach((function(e){var n=r.get(e.recordId);n&&n.text===e.text&&n.level===e.level||o.push({id:e.recordId,level:e.level})})),o}},{key:"calcTitleWidth",value:function(e,n){return e.getBoundingClientRect().width+u.q*(n-1)}}]),e}()},dx_CYRP:function(e,n,r){"use strict";r.d(n,"v",(function(){return o})),r.d(n,"Y",(function(){return a}));var o,i=r("dx_UtDZ"),c=r("dx_jBAU");function a(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(i.getToken)();return c.S.copyCoverImage(e,n).then((function(e){return e}))}!function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAIL=1]="FAIL",e[e.FILE_DELETED=90003032]="FILE_DELETED",e[e.FILE_QUOTA_EXCEEDED=90003081]="FILE_QUOTA_EXCEEDED",e[e.ATTCHMENT_LIMITATION=90015407]="ATTCHMENT_LIMITATION"}(o||(o={}))},dx_CZKf:function(e,n,r){"use strict";var o;r.d(n,"i",(function(){return o})),function(e){e[e.NONE=-1]="NONE",e[e.Preset=1]="Preset",e[e.Customize=2]="Customize",e[e.Other=3]="Other"}(o||(o={}))},dx_Cg1F:function(e,n,r){"use strict";r.d(n,"E",(function(){return u})),r.d(n,"I",(function(){return d})),r.d(n,"D",(function(){return f})),r.d(n,"G",(function(){return h})),r.d(n,"x",(function(){return p})),r.d(n,"n",(function(){return g})),r.d(n,"i",(function(){return b})),r.d(n,"L",(function(){return y})),r.d(n,"g",(function(){return m})),r.d(n,"LC",(function(){return _}));var o=r("dx_UtDZ"),i=r("dx_h6a8"),c=r("dx_mopU");var a=r("dx_VQSE"),l=r("dx_Svtu");function s(e,n){return 0===Object(i.differenceWith)(e,n,i.isEqual).length&&0===Object(i.differenceWith)(n,e,i.isEqual).length}function u(e){var n;return function(e){var n,r=null===e||void 0===e?void 0:e.rich_text;return!r||0===(null===(n=r.element_ids)||void 0===n?void 0:n.length)}(e.rich_summary)&&0===(null===(n=e.assignees_detail)||void 0===n?void 0:n.length)&&0===e.due_time}function d(e,n){if(!e||!n)return Boolean(e)===Boolean(n);var r,o,c,l,u=["guid","creator_id","is_all_day","is_deleted","docx_editable","rrule"];return Object(i.isEqual)(Object(i.pick)(e,u),Object(i.pick)(n,u))&&Boolean(e.completed_milli_time)===Boolean(n.completed_milli_time)&&Object(a.V)(e.rich_summary,n.rich_summary)&&(c=e.assignees_detail,l=n.assignees_detail,s(c.map((function(e){return{id:e.assignee_id,isCompleted:Boolean(e.completed_milli_time)}})),l.map((function(e){return{id:e.assignee_id,isCompleted:Boolean(e.completed_milli_time)}}))))&&s(e.followers_detail,n.followers_detail)&&e.due_time===n.due_time&&(0===e.due_time||e.due_timezone===n.due_timezone)&&function(e,n){return e&&n?s(e.map((function(e){return{type:e.type,time:e.time}})),n.map((function(e){return{type:e.type,time:e.time}}))):Boolean(e)===Boolean(n)}(e.reminders,n.reminders)&&(r=e.source,o=n.source,r&&o?r.block_id===o.block_id&&r.docx_token===o.docx_token:Boolean(r)===Boolean(o))}function f(e){return{guid:"",creator_id:o.userHelper.getCurrentUser().get("id"),rich_summary:Object(l.X)(),due_time:0,is_all_day:!1,due_timezone:Object(c.C)(),completed_milli_time:0,update_mill_time:0,reminders:[],is_deleted:!1,assignees_detail:[],followers_detail:[],docx_editable:!0,source:e,rrule:""}}function h(e){return e.assignees_detail.length?e.assignees_detail.every((function(e){return Boolean(e.completed_milli_time)})):Boolean(e.completed_milli_time)}function p(e){return Boolean(e.completed_milli_time)}function v(e,n){n&&!e.completed_milli_time?e.completed_milli_time=Date.now():!n&&e.completed_milli_time&&(e.completed_milli_time=0)}function g(e,n,r){var o=Object(i.cloneDeep)(e);return o=o.filter((function(e){return e.assignee_id!==r})),n&&o.push({assignee_id:r,completed_milli_time:0}),o}function b(e,n,r){var o=Object(i.cloneDeep)(e);return o.filter((function(e){return e.assignee_id===r})).forEach((function(e){return v(e,n)})),o}function y(e,n){var r=Object(i.cloneDeep)(e);return r.assignees_detail.forEach((function(e){return v(e,n)})),r.completed_milli_time=n?Date.now():0,r}function m(e,n){var r=Object(i.cloneDeep)(e);return n.length&&(r.completed_milli_time=n.every((function(e){return Boolean(e.completed_milli_time)}))?Date.now():0),r.assignees_detail=n,r}function _(e){var n=Object(i.cloneDeep)(e),r=o.userHelper.getCurrentUser().get("id"),c=function(e,n){return e.followers_detail.some((function(e){return e.follower_id===n}))}(n,r);return n.followers_detail=n.followers_detail.filter((function(e){return e.follower_id!==r})),c||n.followers_detail.push({follower_id:r}),n}},dx_Cgns:function(e,n,r){"use strict";r.d(n,"m",(function(){return l})),r.d(n,"B",(function(){return s})),r.d(n,"X",(function(){return u})),r.d(n,"g",(function(){return d}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_UtDZ"),a=r("dx_n0nF"),l=function(){return c.urlHelper.parseQuery(window.location.search)},s=function(){c.urlHelper.cleanParamFromSearch(location.href,a.M),c.urlHelper.cleanParamFromSearch(location.href,a.i)},u=function(e){var n={};return e.forEach((function(e){var r=e.type,o=e.token,c=e.version;c.sort();var a=i()(c,2),l={block_type:r,block_token:o,from_ver:a[0],to_ver:a[1]};n[o]=l})),n},d=function(e){return e.map((function(e){return{type:e.type,token:e.token,version:e.versionList}}))}},dx_Cgrk:function(e,n,r){"use strict";r.d(n,"W",(function(){return d}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c),l=r("dx_bdgK"),s=r("dx_lUPZ"),u=r("dx_QbWy"),d=function(e){var n=e.progress,r=e.isShow,o=Object(c.useRef)(null),d=Object(c.useState)(0),f=i()(d,2),h=f[0],p=f[1],v=Object(c.useState)(0),g=i()(v,2),b=g[0],y=g[1],m=Object(c.useMemo)((function(){return 0===n?0:h*u.q}),[n,h]),_=Object(c.useMemo)((function(){if(0===n)return 0;if(100===n)return"100%";var e=b-12-m;return e<=0&&(e=0),0===e&&n>0?"".concat(n,"%"):e*(n/100)+6}),[n,b,m]),k=Object(c.useCallback)((function(){if(o.current){var e=o.current.parentElement,n=o.current.getBoundingClientRect().height,r=null===e||void 0===e?void 0:e.getBoundingClientRect().width;n&&p(n),r&&y(r)}}),[o]),O=Object(c.useRef)(null);return Object(c.useEffect)((function(){O.current=new l.S(k);var e=O.current,n=o.current;return n&&e.observe(n),k(),function(){n&&e.disconnect()}}),[k]),a.a.createElement(s.g,{ref:o,style:{width:_},showResult:r},a.a.createElement(s.V,{style:{width:m}}))}},dx_CkQe:function(e,n,r){"use strict";var o,i,c;r.d(n,"c",(function(){return o})),r.d(n,"F",(function(){return i})),r.d(n,"l",(function(){return c})),function(e){e.horizontal="horizontal",e.vertical="vertical"}(o||(o={})),function(e){e.MenuItemNormal="menuItemNormal",e.MenuItemWithSwitch="menuItemWithSwitch",e.MenuItemWithFlattenItems="submenuItemWithFlattenItems",e.SubmenuItemWithChildren="submenuItemWithChildren",e.SubmenuItemWithComponent="submenuItemWithComponent",e.Title="title",e.Divider="divider"}(i||(i={})),function(e){e.DisplaySubMenu="DisplaySubMenu",e.CreateNoOps="CreateNoOps",e.InsertBlock="InsertBlock",e.AlignLeft="AlignLeft",e.AlignCenter="AlignCenter",e.AlignRight="AlignRight",e.Bold="Bold",e.Strikethrough="Strikethrough",e.Italic="Italic",e.Underline="Underline",e.Comment="Comment",e.Cut="Cut",e.Copy="Copy",e.Delete="Delete",e.IncreaseIndentation="IncreaseIndentation",e.ReduceIndentation="ReduceIndentation",e.InlineCode="InlineCode",e.Link="Link",e.TextLink="TextLink",e.TableMergeCell="TableMergeCell",e.TableRemove="TableRemove",e.InlineView="InlineView",e.CardView="CardView",e.PreviewView="PreviewView",e.UpdateBlockColor="UpdateBlockColor",e.UpdateBlockHighlight="UpdateBlockHighlight",e.TurnIntoHeading="TurnIntoHeading",e.TurnIntoText="TurnIntoText",e.TurnIntoOrder="TurnIntoOrder",e.TurnIntoBullet="TurnIntoBullet",e.TurnIntoTodo="TurnIntoTodo",e.TurnIntoCode="TurnIntoCode",e.TurnIntoQuote="TurnIntoQuote",e.TurnIntoCallout="TurnIntoCallout"}(c||(c={}))},dx_CqjN:function(e,n,r){"use strict";r.d(n,"X",(function(){return l})),r.d(n,"q",(function(){return u})),r.d(n,"d",(function(){return d})),r.d(n,"j",(function(){return f})),r.d(n,"U",(function(){return h})),r.d(n,"i",(function(){return v})),r.d(n,"S",(function(){return g}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_h6a8"),a=r("dx_qHDV");function l(e){return!!(e&&"string"===typeof e.target&&a.R[e.type]&&a.y9[e.target])}function s(e){return!!e&&(!!e.type.startsWith("touch")&&e instanceof TouchEvent)}var u=function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return l(n)||n instanceof MouseEvent?n:s(n)?n.changedTouches[r]:e(n.nativeEvent,r)};function d(e){return e instanceof MouseEvent||s(e)?e:e.nativeEvent}function f(e){return"persist"in e&&e.persist(),e}function h(e){e.target instanceof Element&&e.target.setPointerCapture(e.pointerId)}var p=function e(n){var r=this;i()(this,e),this.props=n,this.touchStartTime=0,this.touchEndTime=0,this.contextMenuTime=0,this.startX=0,this.startY=0,this.newX=0,this.newY=0,this.movingDistanceX=0,this.movingDistanceY=0,this.firstTouchStartTime=0,this.firstTouchStartX=0,this.firstTouchStartY=0,this.longPressId=0,this.lastTouchEvent=null,this.clickCount=0,this.handleTouch=function(e,n){var o=e.type,i={touchstart:r.touchEventWrapper(r.handleTouchstart),touchmove:r.touchEventWrapper(r.handleTouchmove),touchend:r.touchEventWrapper(r.handleTouchend),mousedown:r.mouseEventWrapper(r.handleTouchstart),mousemove:r.mouseEventWrapper(r.handleTouchmove),mouseup:r.mouseEventWrapper(r.handleTouchend),contextmenu:r.mouseEventWrapper(r.handleContextMenu)}[o];i&&i(e,n)},this.onTouch=this.handleTouch,this.touchEventWrapper=function(e){return function(n,o){return r.recordLastTouchEvent(n),e(n,o)}},this.mouseEventWrapper=function(e){return function(n,o){if(!r.isSyntheticEvent(n))return e(n,o)}},this.isSyntheticEvent=function(e){if(r.lastTouchEvent&&e.timeStamp-r.lastTouchEvent.timeStamp<=200){var n=u(r.lastTouchEvent),o=n.clientX,i=n.clientY,c=u(e),a=c.clientX,l=c.clientY;if(Math.abs(o-a)<=25&&Math.abs(i-l)<=25)return!0}return!1},this.handleTouchstart=function(e,n){r.recordFirstTouch(e),r.touchStartTime=e.timeStamp;var o=u(e);r.startX=o.clientX,r.newX=o.clientX,r.startY=o.clientY,r.newY=o.clientY,r.movingDistanceX=0,r.movingDistanceY=0,r.handleLongPress(e,n)},this.handleTouchmove=function(e,n){r.recordMovingDistance(e)},this.handleTouchend=function(e,n){clearTimeout(r.longPressId);var o=r.props,i=o.onClick,c=o.onDoubleClick;(i||c)&&(r.touchEndTime=e.timeStamp,r.recordMovingDistance(e),c&&r.isValidDoubleClickDuration()&&r.isValidDoubleClickMove()&&1===r.clickCount?(c(e,n),r.firstTouchStartTime=0,r.firstTouchStartX=0,r.firstTouchStartY=0):i&&r.isValidClickDuration()&&r.isValidMove()&&0===r.clickCount&&i(e,n)),r.clickCount++,r.clearClickCount()},this.handleLongPress=function(n,o){var i=r.props,c=i.onLongPress,a=i.longPressDuration,l=void 0===a?e.DEFAULT_DURATION:a;c&&(window.clearTimeout(r.longPressId),f(n),r.longPressId=window.setTimeout((function(){r.isValidMove()&&c(n,o)}),l))},this.handleContextMenu=function(e,n){r.contextMenuTime=e.timeStamp;var o=r.props.onContextMenu;null===o||void 0===o||o(e,n)},this.recordFirstTouch=function(n){var o=r.props,i=o.doubleClickDuration,c=void 0===i?e.DEFAULT_DURATION:i;o.onDoubleClick&&n.timeStamp-r.touchStartTime<c&&(r.firstTouchStartTime=r.touchStartTime,r.firstTouchStartX=r.startX,r.firstTouchStartY=r.startY)},this.recordLastTouchEvent=function(e){e.type.startsWith("touch")&&(r.lastTouchEvent=e)},this.recordMovingDistance=function(e){var n=u(e);r.movingDistanceX+=Math.abs(n.clientX-r.newX),r.movingDistanceY+=Math.abs(n.clientY-r.newY),r.newX=n.clientX,r.newY=n.clientY},this.isValidMove=function(){var n=r.props.movingDistance,o=void 0===n?e.DEFAULT_MOVING_DELTA:n;return r.movingDistanceX<=o&&r.movingDistanceY<=o},this.isValidDoubleClickMove=function(){var n=r.props.movingDistance,o=void 0===n?e.DEFAULT_MOVING_DELTA:n;return Math.abs(r.firstTouchStartX-r.startX)<=o&&Math.abs(r.firstTouchStartY-r.startY)<=o},this.isValidClickDuration=function(){var n=r.props.clickDuration,o=void 0===n?e.DEFAULT_DURATION:n;return r.touchEndTime-r.touchStartTime<=o&&!(r.touchEndTime-r.contextMenuTime<=o)},this.isValidDoubleClickDuration=function(){var n=r.props.doubleClickDuration,o=void 0===n?e.DEFAULT_DURATION:n;return r.touchEndTime-r.firstTouchStartTime<=o},this.clearClickCount=Object(c.debounce)((function(){r.clickCount=0}),(this.props.doubleClickDuration||e.DEFAULT_DURATION)+30)};p.DEFAULT_MOVING_DELTA=30,p.DEFAULT_DURATION=300;var v=function(e){return new p(e).onTouch},g=function(e){return new p(e).onTouch}},dx_Csn1:function(e,n,r){},dx_Cu6Q:function(e,n,r){"use strict";r.d(n,"P",(function(){return l})),r.d(n,"G",(function(){return s}));var o=r("dx_UtDZ"),i=r("dx_xlCA"),c=r("dx_gDjg"),a=r("dx_pzI1");function l(e){var n;return!!(null===(n=e.attributes)||void 0===n?void 0:n.dataMetaBlockProps)}function s(e){var n;if(null===(n=e.attributes)||void 0===n?void 0:n.dataMetaBlockProps)try{var r=JSON.parse(e.attributes.dataMetaBlockProps);if(r.blockType===a.X){var l,s,u=null===(l=r.props.data)||void 0===l||null===(s=l.user)||void 0===s?void 0:s.id;return i.n.getUserShowName(u)||""}if(r.blockType===a.Z){var d,f,h,p=null===(d=r.props)||void 0===d?void 0:d.token,v=null===(f=r.props)||void 0===f?void 0:f.type,g=null===(h=r.props)||void 0===h?void 0:h.title;return v===o.TYPE_ENUM.DOCX?Object(c.A)(p,v,g):""}}catch(b){}return""}},dx_CweE:function(e,n,r){"use strict";var o,i,c,a,l,s=r("dx_lSNA"),u=r.n(s),d=r("dx_o0o1"),f=r.n(d),h=r("dx_yXPU"),p=r.n(h),v=r("dx_yG8O"),g=r.n(v),b=r("dx_lwsE"),y=r.n(b),m=r("dx_W8MJ"),_=r.n(m),k=r("dx_PJYZ"),O=r.n(k),x=r("dx_iWIM"),E=r.n(x),S=r("dx_W7W2"),C=r.n(S),I=r("dx_a1gu"),B=r.n(I),T=r("dx_Nsbk"),w=r.n(T),R=r("dx_Uyc2"),M=r.n(R),j=(r("dx_A1AB"),r("dx_uxuX")),D=r("dx_UtDZ"),A=r("dx_h6a8"),P=r("dx_cDcd"),L=r.n(P),N=r("dx_yzqx"),F=r("dx_P5PS"),U=r("dx_Fimk"),H=r("dx_luPr"),V=r("dx_SUdB"),W=r("dx_OUFY"),z=r("dx_S0Si"),G=r("dx_B28d"),K=r("dx_i5i9S"),q=r("dx_xFJs"),X=r("dx_R7Rv"),Y=r("dx_YRGG"),J=r("dx_zghO"),Z=r("dx_VY1y"),Q=r("dx_BaTw"),$=r("dx_D8nn"),ee=r("dx_O1Ou"),te=r("dx_MUhB"),ne=r("dx_ey54"),re=r("dx_U5UJ"),oe=r("dx_k8kI"),ie=r("dx_zpWR"),ce=r.n(ie),ae=r("dx_OPAz"),le=r("dx_GLPm"),se=ee.a.DocxSheet,ue=function(){function e(n,r){y()(this,e),this.uuid=n,this.component=r,this.startTime=Date.now(),this.detectTimer=void 0}return _()(e,[{key:"detect",value:function(e,n,r,o,i){var c=this;this.detectTimer=window.setTimeout((function(){c.detectTimer=void 0,n();var a=c.component.props.scrollManage,l=a.getMaxScrollLeft(),s=c.component.actualScrollLeft/l;if(!Number.isNaN(s)&&Number.isFinite(s)){var u=0===l&&0===e||Math.abs(e-s)<=.02;if(u||"hidden"!==document.visibilityState){var d="[".concat(se,"]: offset ratio diff is greater than threshold");if(u?c.success():c.fail(d),!u){var f=c.component.commentModule,h=c.component.getPreViewInfo().scrollLeft,p="".concat(s);document.body.contains(c.component.hostElement)?f&&f.activeCommentId&&f.isThirdPartyComment(f.activeCommentId,c.component.record.id)&&(p="".concat(p,", active comment is on sheet block")):p="".concat(p,", hostElement is not on dom tree");var v={subScrollLeft:h,scrollLeft:a.getScrollStatus().scrollLeft,maxScrollLeft:l};p="".concat(p,", ")+"current data: ".concat(JSON.stringify(v),", ")+"prev data: ".concat(JSON.stringify(r),", ")+"target scroll: ".concat(JSON.stringify(o),", ")+"replay reason: ".concat(i),Object(U.N)("vc_action_apply_dev",{code:1,info:d,action:se,string_param_1:p,string_param_2:JSON.stringify(e)})}}else c.ignore("".concat(se,": ignore by visibility is hidden"))}else c.ignore("".concat(se,": ignore by current ratio is NaN or Infinity"))}),100)}},{key:"setStartTime",value:function(e){this.startTime=e}},{key:"ignore",value:function(e){var n;this.detectTimer&&window.clearTimeout(this.detectTimer),null===(n=this.component.vcController)||void 0===n||n.reportReplay(ee.s.IGNORE,this.uuid,e,this.startTime)}},{key:"success",value:function(){var e;null===(e=this.component.vcController)||void 0===e||e.reportReplay(ee.s.SUCCESS,this.uuid,this.startTime)}},{key:"fail",value:function(e){var n;null===(n=this.component.vcController)||void 0===n||n.reportReplay(ee.s.FAIL,this.uuid,e,this.startTime)}}]),e}();r("dx_olpz");function de(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function fe(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?de(Object(r),!0).forEach((function(n){u()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function he(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=w()(e);if(n){var i=w()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return B()(this,r)}}var pe,ve=ee.a.DocxSheet;!function(e){e.SCROLL="scroll"}(pe||(pe={}));var ge=new Set,be=(l=a=function(e){C()(r,e);var n=he(r);function r(e){var o,a;y()(this,r),(a=n.call(this,e)).bridge=void 0,g()(a,"scheduler",i,O()(a)),a.cachedVcAction=null,a.screenShot=void 0,a.activatedCommentSet=new Set,a.preViewInfo={scrollLeft:0,scrollWidth:0,clientWidth:0,viewHeight:0},a.unregisterVc=void 0,a.replayRetryTime=0,a.replayRetryTimer=void 0,a.lastReplayUuid=void 0,a.prevUnFinishReport=void 0,a.mountPoint=null,a.syncSelectionDom=null,a.isRendered=!1,a.isRenderOutsideSlot=!1,a.unSubscribeAfterApply=null,a.cancelCallbacks=null,g()(a,"depLoader",c,O()(a)),a.state={isSelected:!!a.selectionAPI.getSelection().find((function(e){var n=e.id;return a.id===n}))},a.contextMenuLocked=!1,a.handleContextMenuShowLock=function(e){a.contextMenuLocked=e},a.showMobileContextMenu=function(e,n){var r=Object(le.U)(a.token).id;a.bridge.showContextMenu&&a.bridge.showContextMenu(r,e,n)},a.getContextMenus=function(){var e=Object(le.U)(a.token).id;return a.bridge.getContextMenus?a.bridge.getContextMenus(e):[]},a.handleContextMenuClick=function(e){var n=Object(le.U)(a.token).id;a.bridge.handleContextMenuClick&&a.bridge.handleContextMenuClick(n,e)},a.onChangeTranslateLang=function(){a.setUpBridgeAndRenderSheet()},a.enterTranslateMode=p()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.model.loadBridge();case 2:a.setUpBridgeAndRenderSheet();case 3:case"end":return e.stop()}}),e)}))),a.exitTranslateMode=function(){a.model.isBridgeLoaded()&&a.setUpBridgeAndRenderSheet()},a.handleDocumentClick=function(e){var n=e.target.closest(".sheet-block-container");n&&n===a.mountPoint?($.S.emit($.p.TOOLBAR.SHOW_TOOL_BAR,O()(a)),!a.state.isSelected&&a.selectionAPI.setSelection([]),a.blockManager.dispatch(oe.v.ADD,a.id)):a.checkSheetBlockToolbarEnabled(e.composedPath()[1]||e.target)||($.S.emit($.p.TOOLBAR.HIDE_TOOL_BAR,O()(a)),a.blockManager.dispatch(oe.v.REMOVE,a.id))},a.handleSelectionChanged=function(e,n){if(a.model.config.editable){var r=n.some((function(e){return e.id===a.id}));a.setState({isSelected:r})}},a.replayHandler=function(e){var n=e.actionType,r=e.data,o=e.uuid,i=e.reason,c=O()(a),l=c.record,s=c.props.scrollManage,u=c.preViewInfo.scrollWidth;if(!s){var d=l.id;if(n===pe.SCROLL){var f,h,p,v=new ue(o,O()(a));if(!Object.keys(r.offsetRatioMap).length)return void v.success();if(a.replayRetryTime>0&&a.replayRetryTimer)clearTimeout(a.replayRetryTimer),a.lastReplayUuid&&a.lastReplayUuid!==o&&(null===(p=a.vcController)||void 0===p||p.reportReplay(ee.s.IGNORE,a.lastReplayUuid,"[".concat(ve,"]: next action come when retrying"))),a.lastReplayUuid=void 0;if(!u&&a.replayRetryTime<20)return a.lastReplayUuid=o,a.replayRetryTime++,void(a.replayRetryTimer=setTimeout((function(){a.replayHandler({actionType:n,data:r,uuid:o,reason:i})}),500));null===(f=a.prevUnFinishReport)||void 0===f||f.ignore("[".concat(ve,"]: next action come before check")),a.prevUnFinishReport=void 0,a.replayRetryTime=0,a.replayRetryTimer=void 0,a.lastReplayUuid=void 0;var g=r.offsetRatioMap,b=Math.min(1,g[d]||0)*(u-a.actualClientWidth),y=Object(le.U)(a.model.snapshot.token).id;v.setStartTime(Date.now()),null===(h=a.bridge)||void 0===h||h.sheetViewScrollToPos(y,b),v.success()}}},a.cycleHandler=function(e){var n;e===j.STOP_FOLLOW&&(a.replayRetryTimer&&(clearTimeout(a.replayRetryTimer),a.lastReplayUuid&&(null===(n=a.vcController)||void 0===n||n.reportReplay(ee.s.IGNORE,a.lastReplayUuid,"[".concat(ve,"]: stop follow, stop retry"))),a.lastReplayUuid=void 0))},a.calcScrollStateToVc=Object(A.debounce)((function(e){var n=O()(a),r=n.record,o=n.preViewInfo.scrollWidth,i=n.vcController;if(!a.props.scrollManage){var c=r.id;if(i&&e!==z.L.COMMENT_SCROLL){var l=o-a.actualClientWidth,s=a.actualScrollLeft/l;void 0===s||!Number.isNaN(s)&&Number.isFinite(s)||(s=0);var d=(i.getState(ve,pe.SCROLL)||{offsetRatioMap:{}}).offsetRatioMap;if(d[c]!==s){var f={offsetRatioMap:fe(fe({},d),{},u()({},c,s))};i.sendState(ve,pe.SCROLL,f)}}}}),80),a.setRef=function(e){var n,r,o,i;e||(null===(o=a.mountPoint)||void 0===o||o.removeEventListener("touchstart",a.handleTouchStart),null===(i=a.mountPoint)||void 0===i||i.removeEventListener("keydown",a.handleKeyDown));a.mountPoint=e,null===(n=a.mountPoint)||void 0===n||n.addEventListener("touchstart",a.handleTouchStart),null===(r=a.mountPoint)||void 0===r||r.addEventListener("keydown",a.handleKeyDown)},a.handleKeyDown=function(e){var n=N.S.isMac||N.S.isIPad;[{metaCtrlKey:!0,code:"KeyZ",shiftKey:!1},{metaCtrlKey:!0,code:n?"KeyZ":"KeyY",shiftKey:n}].find((function(n){return n.metaCtrlKey===e[V.U]&&n.code===e.code&&n.shiftKey===e.shiftKey}))&&e.stopPropagation()},a.onScrollContainerResize=Object(A.throttle)((function(e){var n,r;if(a.token){var o=Object(le.U)(a.token).id;if(e)a.bridge&&a.bridge.setWidth(e-2,0,o);else{var i=(null===(n=a.mountPoint)||void 0===n?void 0:n.offsetWidth)?(null===(r=a.mountPoint)||void 0===r?void 0:r.offsetWidth)-2:0;a.bridge&&a.bridge.setWidth(i,0,o)}}}),100),a.enterBuffer=function(){var e=a.blockManager,n=e.isPreview,r=e.isHistory;if(a.bridge){a.cachedVcAction&&(a.replayHandler(a.cachedVcAction),a.cachedVcAction=null);var o=Object(le.U)(a.token).id;o&&a.bridge.sheetBlockEnterBuffer(o),n&&!r&&a.onScrollContainerResize()}},a.leaveBuffer=function(){if(a.bridge){var e=Object(le.U)(a.token).id;e&&a.bridge.sheetBlockLeaveBuffer(e)}},a.enterViewport=function(){if(a.bridge){var e=Object(le.U)(a.token).id;e&&a.bridge.sheetBlockEnterBuffer(e)}},a.setUpBridgeAndRenderSheet=p()(f.a.mark((function e(){var n,r,o,i,c,l,s,u,d,h,v,g,b,y,m,_,k,x,E,S,C,I,B,T,w,R,M,j,P;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=a.props,s=l.scrollManage,u=l.recursionProps,d=l.blockId,h=l.onBlockReady,v=a.props,g=v.historyBlockVersionData,b=v.onHistoryResultReady,y=Object(le.U)(a.token),m=y.token,_=y.id,k={total_duration:0,init_duration:0,status:"success",info:""},m&&_&&a.mountPoint){e.next=6;break}return e.abrupt("return");case 6:return x=O()(a),E=x.model,S=Date.now(),e.prev=8,a.depLoader.reporter.report("ccm_docx_loadable_block_component_dev",{extra:["third_party_id:".concat(_," recordid: ").concat(Object(D.encryptTea)(a.model.record.id),", action: load sheet bridge")]},{mergeKey:"extra",delay:5e3}),e.next=12,E.loadBridge();case 12:if(a.bridge=e.sent,k.init_duration=Date.now()-S,!a.bridge.onAfterApply){e.next=18;break}return e.next=17,null===(I=(B=a.bridge).onAfterApply)||void 0===I?void 0:I.call(B,_,(function(){return Object(le.p)(a.props.recursionProps.eventEmitter)}));case 17:a.unSubscribeAfterApply=e.sent;case 18:if(!E.config.get("isHistory")||ge.has(m)){e.next=29;break}return ge.add(m),T=Boolean(null===g||void 0===g?void 0:g.isShowDiff),w=null===g||void 0===g?void 0:g.fromVer,R=null===g||void 0===g?void 0:g.toVer,M=a.getSheetHistoryUsers(),e.next=26,a.bridge.previewHistory(w,R,{isHighlight:T,users:M});case 26:j=e.sent,P=j.payload,null===b||void 0===b||b(P);case 29:if(a.depLoader.reporter.report("ccm_docx_loadable_block_component_dev",{extra:["third_party_id:".concat(_," recordid: ").concat(Object(D.encryptTea)(a.model.record.id),", action: mount sheet")]},{mergeKey:"extra",delay:5e3}),a.mountPoint){e.next=32;break}return e.abrupt("return");case 32:return e.next=34,a.bridge.mountSheetBlock(a.model.recordId,{token:m,sheetId:_,host:a.mountPoint,undoDispatcher:null===(C=u.undoModule)||void 0===C?void 0:C.getUndoDispatcher(),deleteFn:A.noop,isInHistory:E.config.get("isHistory"),historyBlockVersionData:g,onHistoryResultReady:b,onCutWholeSheet:function(){a.selectionAPI.setSelection([{id:a.id,type:J.j.BLOCK}]),a.selectionAPI.copyOrCutSelectedBlocks("cut")},onHeightDidUpdate:function(){a.blockManager.layoutManager.notifyNodeHeightChange(a.id)},onContextMenuComment:function(){N.S.isMobile?a.commentModule.startNewDocComment({selectedBlocks:[{id:a.id,type:J.j.BLOCK}],isThirdPartyComment:!0,callSource:"Sheet"}):a.commentModule.triggerStartNewDocComment({selectedBlocks:[{id:a.id,type:J.j.BLOCK}],isThirdPartyComment:!0,callSource:"Sheet"})},onActiveCommentChange:function(){N.S.isMobile&&!N.S.isIPad||a.contextMenuLocked||!a.commentModule||E.activeCommentChange(a.commentModule,a.selectionAPI)},onCommentLoaded:function(){a.commentModule&&E.handleCommentLoaded(a.commentModule)},scrollToSheetBlock:function(){var e=p()(f.a.mark((function e(n){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r=Object(le.V)(n,a.blockManager))){e.next=4;break}return e.next=4,a.viewport.scrollToRecord(r);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()});case 34:window.sheetRenderCostTime=Date.now()-window.sheetRenderStartTime,console.log("sheetRenderCostTime",window.sheetRenderCostTime),e.next=44;break;case 38:throw e.prev=38,e.t0=e.catch(8),k.status="fail",k.info="string"===typeof e.t0?e.t0:String(e.t0),Object(U.N)("sheet_block_loaded_dev",k),e.t0;case 44:a.onScrollContainerResize(a.props.scrollContainerWidth),N.S.isMobile&&a.blockManager.addListener(ne.G,a.handleEditorResize),a.blockManager.layoutManager.isBlockActive(a.id)&&a.enterBuffer(),a.bridge.setOnCommentBatchUpdate(_,(function(){a.commentModule&&E.handleCommentUpdated(a.commentModule)})),s&&(a.cancelCallbacks=[s.registerSubScroll(a.handleBlockScroll),s.onScroll(a.handleScroll)]),a.props.zoom&&a.bridge.setZoom(a.props.zoom),null===(n=(r=a.bridge).registerScrollContainerRef)||void 0===n||n.call(r,_,null===(o=u.rectForFixed)||void 0===o?void 0:o.scrollableBlockList.get(d)),null===(i=(c=a.bridge).registerViewFlushHandler)||void 0===i||i.call(c,_,(function(){return a.handleSheetViewFlush(_)})),k.total_duration=Date.now()-S,Object(U.N)("sheet_block_loaded_dev",k),h&&h();case 55:case"end":return e.stop()}}),e,null,[[8,38]])}))),a.handleEditorResize=function(e){if(e&&e.editorWidth){var n=e.editorWidth;if(N.S.isMobile){var r=Object(q.M)(a.id,a.blockManager);if(r&&r.gridColumnBlock){var o=a.blockManager.getBlockViewByBlockIdNotCheck(r.gridColumnBlock.id),i=(null===o||void 0===o?void 0:o.hostElement.getBoundingClientRect().width)||1/0;n=Math.min(i,n)}}a.onScrollContainerResize(n)}else a.onScrollContainerResize()},a.highlightHistory=function(){a.model.highlightHistory()},a.clearHighlightHistory=function(){a.model.clearHightlightHistory()},a.takeScreenshot=function(){var e=p()(f.a.mark((function e(n){var o,i,c,l,s,u;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.status,i=n.detail,o!==G.v.start){e.next=11;break}if(r.startTakeScreenshot){e.next=9;break}return r.startTakeScreenshot=!0,s=null===(c=null===i||void 0===i?void 0:i.isBlob)||void 0===c||c,e.next=7,null===(l=a.bridge)||void 0===l?void 0:l.takeScreenShot(s);case 7:a.screenShot=e.sent,console.info("[screenshot sheet]: take screenshot ",n.status,a.screenShot);case 9:e.next=17;break;case 11:if(o!==G.v.end){e.next=17;break}if(!r.startTakeScreenshot){e.next=17;break}return r.startTakeScreenshot=!1,console.info("[screenshot sheet]: end screenshot ",n.status,a.screenShot),e.next=17,null===(u=a.screenShot)||void 0===u?void 0:u.done();case 17:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),a.handleShadowChange=function(e,n){var r,o,i,c,l=a.props.scrollManage;if(l){var s=null===(r=a.bridge.bridge)||void 0===r||null===(o=r.sheetManager)||void 0===o||null===(i=o.sheetComponents)||void 0===i||null===(c=i.get(e))||void 0===c?void 0:c.getEmbedSheetRef().fasterStyle;if(s)switch(s.position){case"absolute":var u,d,f,h,p,v,g,b=(null===(u=a.bridge)||void 0===u||null===(d=u.bridge)||void 0===d||null===(f=d.sheetManager)||void 0===f||null===(h=f.embedShellManager)||void 0===h||null===(p=h.getShellBySheetId)||void 0===p||null===(v=p.call(h,e))||void 0===v||null===(g=v._sheetView)||void 0===g?void 0:g._bottomMargin)||5;s.height.replace("px","")>n?l.emitShadowStyleChange({bottom:3,height:n-b}):l.emitShadowStyleChange({height:"calc(100% - ".concat(b+2,"px)"),top:2,bottom:"unset"});break;case"fixed":var y=l.getScrollContainer().getBoundingClientRect().right;l.emitShadowStyleChange({position:s.position,top:s.top,height:s.height,left:y-10})}}},a.handleSheetViewFlush=function(e){var n=a.props,r=n.scrollManage,o=n.scrollContainerWidth,i=a.bridge.getSheetViewContent(e);if(i){var c,l,s=i.trDocSize,u=i.tlDocSize,d=i.sheetView,f=i.colHeaderWidth,h=!1,p=!1,v=!1,g=d.height,b=d.brTable().contentDoc(),y=s.width+u.width+f;if(a.preViewInfo.clientWidth!==o&&(a.preViewInfo.clientWidth=o,p=!0),a.preViewInfo.viewHeight!==g&&(a.preViewInfo.viewHeight=g,v=!0),a.preViewInfo.scrollLeft!==b.posX&&(a.preViewInfo.scrollLeft=b.posX,h=!0),a.preViewInfo.scrollWidth!==y&&(a.preViewInfo.scrollWidth=y,p=!0),p&&r&&r.emitSubViewChange({width:a.getSheetScrollWidth(y)}),v&&r)r.emitShadowStyleChange({height:g*(null!==(c=a.props.zoom)&&void 0!==c?c:1),bottom:5});if(h&&r)r.emitSubScroll({scrollLeft:b.posX*(null!==(l=a.props.zoom)&&void 0!==l?l:1),scrollWidth:a.getSheetScrollWidth(y)});a.handleShadowChange(e,g),a.calcScrollStateToVc()}},a.getViewSnapshot=function(){if(!a.token||!a.bridge)return Object(Q.X5)(ce.a);try{if(!a.props.recursionProps.fold.isShow(a.id))return Object(Q.X5)(ce.a);var e=Object(le.U)(a.token).id,n=a.bridge.currentScreenShot(e),r=a.mountPoint&&a.mountPoint.querySelector("canvas"),o=null===r||void 0===r?void 0:r.style.width,i=null===r||void 0===r?void 0:r.style.height;return Object(Q.X5)(n,o,i)}catch(c){return Object(Q.X5)(ce.a)}},a.getScrollStatus=function(){if(a.bridge){var e=Object(le.U)(a.token).id;if(e)return a.bridge.getScrollStatus(e)}},a.getSheetActiveStatus=function(){var e,n,r;if(!a.bridge)return!1;var o=Object(le.U)(a.token).id;return!!o&&(null===(e=a.bridge.bridge)||void 0===e||null===(n=e.sheetManager)||void 0===n||null===(r=n.checkSheetActiveElement)||void 0===r?void 0:r.call(n,o))},a.handleBlockScroll=function(e){var n;if(a.props.scrollManage){var r,o,i=Object(le.U)(a.token).id,c=a.bridge.getSheetViewContent(i),l=c.trDocSize,s=c.tlDocSize,u=c.sheetView,d=c.colHeaderWidth,f=u.brTable().contentDoc();if("number"===typeof e)a.bridge.scrollSheetViewPosX(i,e/(null!==(r=a.props.zoom)&&void 0!==r?r:1));else a.bridge.sheetViewScrollToPos(i,e.scrollLeft/(null!==(o=a.props.zoom)&&void 0!==o?o:1));a.props.scrollManage.emitSubScroll({scrollLeft:f.posX*(null!==(n=a.props.zoom)&&void 0!==n?n:1),scrollWidth:a.getSheetScrollWidth(l.width+s.width+d)})}},a.handleScroll=function(e,n){var r,o=null===(r=a.props.scrollManage)||void 0===r?void 0:r.getScrollStatus().scrollLeft;$.s.emit(Z.Y,{blockId:a.id,offset:o}),a.calcScrollStateToVc(n)},a.handleMouseDown=function(e){"canvas"===e.target.nodeName.toLocaleLowerCase()&&e.stopPropagation()},a.showSyncSelection=function(){var e=a.getBlockWrapper();if(e){var n=document.createElement("div");n.className="sheet-block-sync-selected",n.style.backgroundColor=a.props.syncCursorBgColor,e.appendChild(n),a.syncSelectionDom=n}},a.getBlockWrapper=function(){return a.mountPoint?a.mountPoint.querySelector(".faster-wrapper"):a.hostElement},a.hideSyncCursorSelection=function(){var e;null===(e=a.syncSelectionDom)||void 0===e||e.remove()},a.handleTouchStart=function(){a.selectionAPI.removeAllSelection()},a.getSheetHistoryUsers=function(){var e=a.props.historyBlockVersionData;return e?Object.keys(e.users||{}).reduce((function(n,r){var o=e.users[r];return n[r]={textColor:o.textColor,bgColor:o.backgroundColor||o.bgColor,labelColor:o.labelColor,cn_name:o.cn_name,en_name:o.en_name,enName:o.en_name,name:o.cn_name},n}),{}):{}},a.handleSheetDidRender=function(){a.isRendered=!0,a.setSelected(a.state.isSelected),document.addEventListener("click",a.handleDocumentClick),a.registerVc(),$.S.on($.p.MOBILE.CONTEXT_MENU.SHOW_SHEET_CONTEXT_MENU,a.showMobileContextMenu),$.S.on($.p.MOBILE.CONTEXT_MENU.LONG_PRESS,a.handleContextMenuShowLock),N.S.isMobile&&a.initReadStatus(!!a.isMobileEditMode),a.props.recursionProps.isPresentationMode&&$.S.emit($.p.PRESENTATION.FORCE_UPDATE_PAGINATION)},a.onBlockFetchFail=function(){var e,n;null===(e=(n=a.props).updateOuterLoadingComponent)||void 0===e||e.call(n,L.a.createElement(X.F,{onClickRetry:function(){a.props.updateOuterLoadingComponent(a.props.loadingComponent),a.scheduler.retryFetchBlock(a.props.blockId)}}))},a.renderComponent=function(e){return L.a.createElement(ye,{isShowLoading:a.props.isShowLoading,isRenderOutsideSlot:a.isRenderOutsideSlot,recordId:a.props.model.recordId,setRef:a.setRef,token:a.token,bridge:a.bridge,setUpBridgeAndRenderSheet:a.setUpBridgeAndRenderSheet,renderFinishCb:e})};var l=a.props,s=l.model,d=l.editorAPI.config.get("outsideBlockTypes");return a.isRenderOutsideSlot=null!==(o=null===d||void 0===d?void 0:d.has(s.type))&&void 0!==o&&o,window.sheetRenderStartTime=Date.now(),a.props.model.loadBridge().then(function(){var e=p()(f.a.mark((function e(n){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.props.model.bridge.waitUntilBridgeReady();case 2:return H.R.reportBlockLoadStage(H.F.JS_READY,{id:a.props.model.id,time:(new Date).getTime()}),e.abrupt("return");case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){return e})),a}return _()(r,[{key:"initReadStatus",value:function(e){var n,r;null===(n=this.bridge)||void 0===n||null===(r=n.setReadState)||void 0===r||r.call(n,!e)}},{key:"checkSheetBlockToolbarEnabled",value:function(e){if(!this.bridge||!this.token||!e)return!1;var n=Object(le.U)(this.token).id;return this.bridge.checkSheetBlockToolbarEnabled(this.model.recordId,n,e)}},{key:"blockViewDidMount",value:function(){E()(w()(r.prototype),"blockViewDidMount",this).call(this),$.S.on(re.Q,this.takeScreenshot),$.S.on($.p.TRANSLATE.TRANSLATE_LANGUAGE_CHANGE,this.onChangeTranslateLang),$.S.on($.p.TRANSLATE.TRANSLATE_EVENT_DONE,this.enterTranslateMode),$.S.on($.p.TRANSLATE.TRANSLATE_EVENT_CLOSE,this.exitTranslateMode),this.selectionAPI.onSelectionChange(this.handleSelectionChanged)}},{key:"blockViewDidUpdate",value:function(e,n){E()(w()(r.prototype),"blockViewDidUpdate",this).call(this,e,n);var o,i=e.scrollContainerWidth,c=this.props.scrollContainerWidth;(i!==c&&this.onScrollContainerResize(c),!e.syncCursorSelected&&this.props.syncCursorSelected?this.showSyncSelection():e.syncCursorSelected&&!this.props.syncCursorSelected&&this.hideSyncCursorSelection(),e.zoom!==this.props.zoom&&this.bridge)&&this.bridge.setZoom(null!==(o=this.props.zoom)&&void 0!==o?o:1)}},{key:"blockViewWillUnmount",value:function(){var e,n;if(E()(w()(r.prototype),"blockViewWillUnmount",this).call(this),$.S.emit($.p.TOOLBAR.HIDE_TOOL_BAR,this),ge.clear(),document.removeEventListener("click",this.handleDocumentClick),null===(e=this.mountPoint)||void 0===e||e.removeEventListener("touchstart",this.handleTouchStart),this.selectionAPI.offSelectionChange(this.handleSelectionChanged),null===(n=this.unregisterVc)||void 0===n||n.call(this),this.replayRetryTimer&&clearTimeout(this.replayRetryTimer),$.S.off(re.Q,this.takeScreenshot),this.onScrollContainerResize.cancel(),this.unSubscribeAfterApply&&this.unSubscribeAfterApply(),$.S.off($.p.TRANSLATE.TRANSLATE_LANGUAGE_CHANGE,this.onChangeTranslateLang),$.S.off($.p.TRANSLATE.TRANSLATE_EVENT_DONE,this.enterTranslateMode),$.S.off($.p.TRANSLATE.TRANSLATE_EVENT_CLOSE,this.exitTranslateMode),!this.blockManager.isUnmount){var o=Object(le.U)(this.token).id;this.bridge&&this.bridge.delSheetBlock(this.id,o),$.S.off($.p.MOBILE.CONTEXT_MENU.SHOW_SHEET_CONTEXT_MENU,this.showMobileContextMenu),(N.S.isMobile||N.S.isIPad)&&this.blockManager.removeListener(ne.G,this.handleEditorResize),this.cancelCallbacks&&(this.cancelCallbacks.forEach((function(e){return e()})),this.cancelCallbacks=null)}}},{key:"getActivatedCommentPos",value:function(e){var n=Object(le.U)(this.token).id;if(n&&this.bridge.getActivatedCommentPos)return this.bridge.getActivatedCommentPos(n,e)}},{key:"registerVc",value:function(){var e,n=this;this.props.scrollManage||(this.unregisterVc=null===(e=this.vcController)||void 0===e?void 0:e.register({recordId:this.model.record.id,moduleName:ve,defaultState:u()({},pe.SCROLL,{offsetRatioMap:{}}),replayHandler:this.replayHandler,cycleHandler:this.cycleHandler,retryOptions:{retryTimes:5,retryIntervalMs:500},retryOnVersionMatched:"fail-only",checkSame:function(e,r,o){return e===pe.SCROLL&&Object(te.P)(r.offsetRatioMap,o.offsetRatioMap,(function(e,n){return e[n]}),n.blockManager,.02)}}))}},{key:"getPreViewInfo",value:function(){return this.preViewInfo}},{key:"setSelected",value:function(e){if(!this.blockManager.isUnmount&&this.isRendered){var n=Object(le.U)(this.token).id;if(N.S.isMobile&&N.S.isBytedanceApp){var r,o,i=e?G.V.FOCUS_ON_BLOCK:G.V.NONE;null===(r=this.bridge)||void 0===r||null===(o=r.updateSelectionState)||void 0===o||o.call(r,n,i)}else{var c,a;null===(c=this.bridge)||void 0===c||null===(a=c.updateSheetSelectionState)||void 0===a||a.call(c,n,e)}return this.setState({isSelected:e}),!1}}},{key:"setHovered",value:function(e){if(!this.blockManager.isUnmount&&!N.S.isMobile){var n,r,o=Object(le.U)(this.token).id;if(!this.state.isSelected)null===(n=this.bridge)||void 0===n||null===(r=n.updateSheetSelectionState)||void 0===r||r.call(n,o,e)}}},{key:"onFoldStateChange",value:function(e){var n=this;N.S.isMobile&&setTimeout((function(){e.show&&n.onScrollContainerResize()}),0)}},{key:"onResize",value:function(){this.props.scrollManage&&this.props.scrollManage.emitGridChange(),N.S.isMobile&&!this.props.scrollManage&&this.blockManager.layoutManager.isBlockActive(this.id)&&this.onScrollContainerResize()}},{key:"activateComment",value:function(e){var n=Object(le.U)(this.token).id;if(n){var r=this.getActivatedCommentPos(e);if(r){var o,i=null===(o=this.bridge.getSheetViewContent(n))||void 0===o?void 0:o.colHeaderWidth,c=this.bridge.bridge.sheetManager.collaSpread.spread.getSheetFromId(n),a=c.getAllComments().find((function(n){return!!n.comments.find((function(n){return n.id===e}))})),l=c.getCellRect(a.row,a.col).width;Object(le.ak)(this.props.scrollManage,r,i,l)}return this.bridge.activateComment(n,e)}}},{key:"deactivateComment",value:function(e){var n=Object(le.U)(this.token).id;if(n)return this.bridge.deactivateComment(n,e)}},{key:"addHoverHighlight",value:function(e){var n=Object(le.U)(this.token).id;if(n)return this.bridge.addHighlight(n,e)}},{key:"removeHoverHighlight",value:function(e){var n=Object(le.U)(this.token).id;if(n)return this.bridge.removeHighlight(n,e)}},{key:"addCommentHighlight",value:function(e){this.activatedCommentSet.add(e),E()(w()(r.prototype),"addCommentHighlight",this).call(this,e);var n=Object(le.U)(this.token).id;this.bridge.updateHighlight(n,2)}},{key:"removeCommentHighlight",value:function(e){if(this.activatedCommentSet.delete(e),!(this.activatedCommentSet.size>0)){E()(w()(r.prototype),"removeCommentHighlight",this).call(this,e);var n=Object(le.U)(this.token).id;this.bridge.updateHighlight(n,0)}}},{key:"getIsRenderedPromised",value:function(){var e=p()(f.a.mark((function e(){var n=this;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){!function r(){n.isRendered?e({}):setTimeout((function(){r()}),300)}()})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getSheetScrollWidth",value:function(e){var n;return(e+2)*(null!==(n=this.props.zoom)&&void 0!==n?n:1)}},{key:"render",value:function(){var e=this;return L.a.createElement(X.h,{blockId:this.props.blockId,blockType:G.B.SHEET,eventEmitter:this.props.recursionProps.eventEmitter,scheduler:this.scheduler,renderLoadingPlaceholder:this.renderComponent,onBlockFetchFail:this.onBlockFetchFail,renderErrorPlaceholder:function(){return null},renderContent:function(n,r){return e.renderComponent((function(){r(),e.handleSheetDidRender()}))}})}},{key:"isBlockRendered",get:function(){return this.isRendered}},{key:"contentElement",get:function(){return this.mountPoint}},{key:"actualScrollLeft",get:function(){var e,n,r=null===(e=this.props.scrollManage)||void 0===e?void 0:e.getScrollStatus();return((null===r||void 0===r?void 0:r.scrollLeft)||(null===(n=this.scrollContainer)||void 0===n?void 0:n.scrollLeft)||0)+this.preViewInfo.scrollLeft}},{key:"actualClientWidth",get:function(){var e,n,r=null===(e=this.scrollContainer)||void 0===e?void 0:e.querySelector(".".concat(W.z));return(r?r.clientWidth-2:null===(n=this.scrollContainer)||void 0===n?void 0:n.clientWidth)||0}},{key:"scrollContainer",get:function(){var e=this.props.scrollManage;return e?e.getScrollContainer():this.mountPoint}}]),r}(K.W),a.CLASS_NAME="docx-sheet-block",a.startTakeScreenshot=!1,o=l,i=M()(o.prototype,"scheduler",[Y.b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=M()(o.prototype,"depLoader",[ae.H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o),ye=function(e){C()(r,e);var n=he(r);function r(){var e;y()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).didRenderContent=!1,e}return _()(r,[{key:"componentDidMount",value:function(){var e=p()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.renderFinishCb){e.next=2;break}return e.abrupt("return");case 2:if(this.props.bridge||""===this.props.token){e.next=7;break}return this.didRenderContent=!0,e.next=6,this.props.setUpBridgeAndRenderSheet();case 6:this.props.renderFinishCb();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=p()(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.renderFinishCb){e.next=2;break}return e.abrupt("return");case 2:if(this.didRenderContent||this.props.bridge||""===this.props.token){e.next=7;break}return this.didRenderContent=!0,e.next=6,this.props.setUpBridgeAndRenderSheet();case 6:this.props.renderFinishCb();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,n=e.isShowLoading,r=e.isRenderOutsideSlot,o=e.recordId;return L.a.createElement("div",{className:"sheet-block-container",ref:this.props.setRef,contentEditable:!1,style:{minHeight:n?"160px":""}},r&&Object(F.Z)(o))}}]),r}(L.a.Component);n.S=be},dx_CwnG:function(e,n,r){"use strict";r.d(n,"J",(function(){return m})),r.d(n,"S",(function(){return _})),r.d(n,"m",(function(){return x})),r.d(n,"H",(function(){return E})),r.d(n,"h",(function(){return S})),r.d(n,"F",(function(){return C})),r.d(n,"C",(function(){return I})),r.d(n,"p",(function(){return B})),r.d(n,"T",(function(){return T})),r.d(n,"t",(function(){return w})),r.d(n,"F3",(function(){return R})),r.d(n,"M",(function(){return M}));var o,i=r("dx_lSNA"),c=r.n(i),a=r("dx_Vvd7"),l=r("dx_UtDZ"),s=r("dx_h6a8"),u=r("dx_Dsxx"),d=r("dx_WzJv"),f=r("dx_XW5M"),h=r("dx_B28d"),p=r("dx_FNDK"),v=r("dx_zEdG"),g=r("dx_rldU");function b(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function y(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?b(Object(r),!0).forEach((function(n){c()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function m(e,n){var r,o,i=e.getBlockModelByBlockId(n),a=i.type,l=(r={},c()(r,h.B.ISV,(function(){return i.record.snapshot.block_type_id})),c()(r,h.B.DIAGRAM,(function(){return i.record.snapshot.diagram.diagramType})),r),s=(null===(o=l[a])||void 0===o?void 0:o.call(l))||a;return _({record_id:i.record.id,block_type:a,sub_block_type:s})}function _(e){return{object_block_id:Object(l.encryptTea)(e.record_id),object_block_type:e.block_type||"",object_sub_block_type:e.sub_block_type||"",block_content_size:e.block_content_size}}function k(e){return Object(v.p)(e)}function O(e){var n,r=Object(v.M)(e);return y(y({},r),{},{block_id:(null!==(n=r.block_id)&&void 0!==n?n:"").slice(-12)})}function x(e,n){var r=B(e,n);return Object(s.pick)(r,["record_id","block_type","sub_block_type"])}function E(e,n){return O(x(e,n))}function S(e,n){return O(x(n.getBlockIdsByRecordId(e)[0],n))}function C(e,n){var r=B(e,n),o=B(r.parentBlockId,n);return Object(s.pick)(o,["record_id","block_type","sub_block_type"])}function I(e,n){return k(C(e,n))}function B(e,n){var r,o=e&&n.getBlockModelByBlockIdNotCheck(e);if(!o)return{record_id:"",block_type:"",sub_block_type:"",parentBlockId:a.V,parentRecordId:""};var i=o.parent,c=o.record,l=Object(d.D)(c),s=Object(d.T)(c);return{record_id:c.id,block_type:c.snapshot.type,sub_block_type:l,block_content_size:s,parentBlockId:(null===i||void 0===i?void 0:i.id)||a.V,parentRecordId:(null===i||void 0===i||null===(r=i.record)||void 0===r?void 0:r.id)||""}}function T(e,n){var r=[];return e.forEach((function(e){var o=B(e,n);r.push(_(o))})),r}o={},c()(o,f.t.Add,u.G.add_panel),c()(o,f.t.Slash,u.G.slash_panel),c()(o,f.t.BlockMenu,u.G.web_menu_panel),c()(o,f.t.TableCell,u.G.web_text_bubble_toolbar),c()(o,f.t.TextualBlockToolbar,u.G.web_text_bubble_toolbar),c()(o,f.t.TextualToolbar,u.G.web_text_bubble_toolbar);var w=function(e){if(!e)return g.u.BLOCK;var n=e.getSelection();return Object(p.m)(n)?g.u.TEXT:g.u.BLOCK},R=function(){return{record_id:Object(l.getToken)(),block_type:h.B.PAGE}};function M(){return window.localStorage.getItem("vc_device_id")||""}},dx_D0JG:function(e,n,r){"use strict";r.d(n,"Y",(function(){return i})),r.d(n,"f",(function(){return o}));var o,i="TEXTUAL_INLINE_BLOCK_MODEL_UPDATE_EVENT";!function(e){e.ENTER="enter",e.AFTER_ENTER="afterEnter",e.AFTER_SHIFT_ENTER="afterShiftEnter",e.STOPPED_KEYDOWN="stoppedKeydown"}(o||(o={}))},dx_D191:function(e,n,r){"use strict";(function(t){r.d(n,"z",(function(){return L}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_lSNA"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_W7W2"),p=r.n(h),v=r("dx_a1gu"),g=r.n(v),b=r("dx_Nsbk"),y=r.n(b),m=r("dx_uZlF"),_=r("dx_UtDZ"),k=r("dx_cDcd"),O=r.n(k),x=r("dx_xs2W"),E=r("dx_zEdG"),S=r("dx_QJ6a"),C=r("dx_bPy9"),I=r("dx_kZ3l"),B=r("dx_tp1j"),T=r("dx_awlV"),w=r("dx_an0K");r("dx_VByW");function R(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function M(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?R(Object(r),!0).forEach((function(n){c()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function j(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=y()(e);if(n){var i=y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return g()(this,r)}}var D="edit-link-panel",A={text:t("etherpad.enter_text"),link:t("CreationDoc_Sheets_HyperlinkPasteInsertLink")},P=t("CreationDoc_DocX_Block_InsertURL_Invalid_Toast"),L=function(e){p()(r,e);var n=j(r);function r(e){var i;return u()(this,r),(i=n.call(this,e)).linkInputRef=O.a.createRef(),i.textInputRef=O.a.createRef(),i.btnRef=O.a.createRef(),i.autoFocus=function(){var e=i.textInputRef.current&&""===i.state.text,n=i.textInputRef.current&&i.state.text===i.state.link;i.textInputRef.current&&e?i.textInputRef.current.focus():i.textInputRef.current&&n?i.textInputRef.current.select():i.linkInputRef.current&&i.linkInputRef.current.focus(),i.props.blockManager.dispatch(B.S.HOLD_EVENT,i.props.block.id)},i.onClosePanel=function(){var e=i.props,n=e.hidePanel,r=e.block;n&&n(),r.selectionAPI.restoreFocus()},i.onConfirm=function(){var e=i.state,n=e.text,r=e.link;if(r=r.trim(),Object(x.P)(r,!0,!0))if(n||(n=r),Object(E.P)("ccm_doc_link_edit_page_click",{block_type:i.props.block.type,record_id:i.props.block.record.id},{click:"click_confirm_link"}),n===i.originText&&r===i.originLink)i.onClosePanel();else{if((!n||i.textInputRef.current&&""===n)&&(n=r),r=Object(x.z)(r,!1),!Object(x.t)(r))return _.Toast.show({type:"info",key:"CreationDoc_DocX_Block_InsertURL_Invalid_Toast",content:P}),void i.onClosePanel();r=encodeURIComponent(r),i.props.blockManager.dispatch(B.S.HOLD_EVENT,null),i.updateLink(n,r).then(i.onClosePanel)}},i.updateLink=function(){var e=l()(o.a.mark((function e(n,r){var a,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=i.props.block,n===i.originText?a.model.setAttributes(i.state.selection,c()({},S.e,r)):a.model.replaceEditorText(i.state.selection,n,c()({},S.e,r)),l=Object(I.A)(new m.A(M(M({editor:a.editor},i.state.selection),{},{state:a.model.zoneState}))),a.model.setSelection({start:l.start+n.length,len:0}),a.focus();case 5:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),i.handleKeyDown=function(e){var n=i.props.boxContext,r=document.activeElement;switch(e.keyCode){case T.G.ESC:return e.stopPropagation(),void i.onClosePanel();case T.G.ENTER:return e.stopPropagation(),e.preventDefault(),void i.onConfirm();case T.G.TAB:return e.preventDefault(),e.stopPropagation(),void(e.shiftKey?r===i.linkInputRef.current&&i.textInputRef.current?i.domFocus(i.textInputRef.current):r===i.textInputRef.current&&i.linkInputRef.current&&i.domFocus(i.linkInputRef.current):(n.renderType===w.N.basic&&r===i.textInputRef.current&&i.linkInputRef.current&&i.domFocus(i.linkInputRef.current),r===i.linkInputRef.current&&i.textInputRef.current&&i.domFocus(i.textInputRef.current)))}},i.renderLink=function(e){var n=e.hasLabel,r=void 0===n||n,o=e.btnText,c=void 0===o?"Confirm":o,a=e.renderText,l=void 0!==a&&a,s=i.state.link;return O.a.createElement(O.a.Fragment,null,r&&O.a.createElement("div",{className:"".concat(D,"-text-container")},l&&O.a.createElement("div",null,t("etherpad.text")),O.a.createElement("div",null,t("CreationDoc_Docs_WebBookmark_DisplayAs_Link_Button"))),O.a.createElement("div",{className:"".concat(D,"-input-container")},l&&O.a.createElement("input",{spellCheck:!1,ref:i.textInputRef,placeholder:A.text,value:i.state.text,onChange:function(e){return i.setState({text:e.target.value})}}),O.a.createElement("input",{spellCheck:!1,ref:i.linkInputRef,placeholder:A.link,value:i.state.link,onChange:function(e){return i.setState({link:e.target.value})}})),O.a.createElement("div",{className:"".concat(D,"-btn-container")},O.a.createElement("button",{ref:i.btnRef,disabled:!Object(x.P)(s.trim(),!0,!0),onClick:i.onConfirm},c)))},i.state={text:"",link:"",selection:{start:{zoneId:Object(C.v)(e.block.id),line:0,offset:0},end:{zoneId:Object(C.v)(e.block.id),line:0,offset:0}}},i}return f()(r,[{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown),this.props.blockManager.dispatch(B.S.HOLD_EVENT,null)}},{key:"domFocus",value:function(e){window.setTimeout((function(){return e.focus()}),0)}},{key:"render",value:function(){var e=this.props.boxContext.renderType,n=void 0===e?w.N.onlyLink:e,r=null;switch(n){case w.N.onlyLink:r=O.a.createElement(O.a.Fragment,null,this.renderLink({hasLabel:!1,btnText:t("common.confirm")}));break;case w.N.basic:r=O.a.createElement(O.a.Fragment,null,this.renderLink({hasLabel:!0,btnText:t("common.confirm"),renderText:!0}))}return O.a.createElement("div",{className:"".concat(D," ").concat(n)},r)}},{key:"originText",get:function(){return this.props.boxContext.text}},{key:"originLink",get:function(){var e,n,r,o,i=this.props,c=i.boxContext,a=i.block,l=c.token,s=Object(w.E)(a.model.zoneState,l),u="";s.length>0&&((u=(null===(e=s[0])||void 0===e||null===(n=e.attributes)||void 0===n?void 0:n.link)||(null===(r=s[0])||void 0===r||null===(o=r.attributes)||void 0===o?void 0:o.localLink)||"")&&-1===s.findIndex((function(e){var n,r;return(null===e||void 0===e||null===(n=e.attributes)||void 0===n?void 0:n.link)!==u&&(null===e||void 0===e||null===(r=e.attributes)||void 0===r?void 0:r.localLink)!==u}))||(u=""));try{u=decodeURIComponent(u)}catch(d){console.error("decode url error",u,d)}return u}}],[{key:"getDerivedStateFromProps",value:function(e,n){var r=e.boxContext,o=e.block,i=r.text,c=r.selection,a=r.renderType,l=void 0===a?w.N.onlyLink:a,s=m.A.isPointEqual(n.selection.start,c.start),u=m.A.isPointEqual(n.selection.end,c.end);if(!(s&&u)){var d=i,f=o.model.zoneState.getEntities(c),h="";if(f.length>0){var p,v,g=null===(p=f[0])||void 0===p||null===(v=p.attributes)||void 0===v?void 0:v[S.e];if(g)try{h=decodeURIComponent(g)}catch(b){console.error("decode url error",h,b)}else h=Object(x.t)(d)?d:"",f.some((function(e){var n;return!(null===(n=e.attributes)||void 0===n?void 0:n[S.e])}))||(h=""),l===w.N.onlyLink&&(h="")}return{text:d,link:h,selection:c}}return null}}]),r}(k.Component)}).call(this,r("dx_E9Eu"))},dx_D26z:function(e,n,r){"use strict";var o=r("dx_FFTT");r.d(n,"V",(function(){return o.V})),r.d(n,"G",(function(){return o.G})),r.d(n,"n",(function(){return o.n})),r.d(n,"U",(function(){return o.U})),r.d(n,"P",(function(){return o.P}))},dx_D2DF:function(e,n,r){"use strict";r.d(n,"h",(function(){return o}));var o="poll-block-input-field"},dx_D2m8:function(e,n,r){"use strict";r.d(n,"X",(function(){return i}));var o=r("dx_cDcd"),i=r.n(o).a.createContext({})},dx_D3DW:function(e,n,r){"use strict";r.d(n,"i",(function(){return i}));var o=r("dx_NOtv"),i=r.n(o)()("task-block")},dx_D3ws:function(e,n,r){"use strict";var o,i,c,a,l,s,u=r("dx_yG8O"),d=r.n(u),f=r("dx_lwsE"),h=r.n(f),p=r("dx_W8MJ"),v=r.n(p),g=r("dx_PJYZ"),b=r.n(g),y=r("dx_W7W2"),m=r.n(y),_=r("dx_a1gu"),k=r.n(_),O=r("dx_Nsbk"),x=r.n(O),E=r("dx_Uyc2"),S=r.n(E),C=(r("dx_A1AB"),r("dx_Vvd7")),I=r("dx_yaFe"),B=r("dx_xjz2"),T=Object(B.s)(I.V)(o=function(){function e(){h()(this,e),this.data={}}return v()(e,[{key:"addData",value:function(e,n){this.data[e]=n}},{key:"removeKey",value:function(e,n){var r=this.data[e];r&&(null===n||void 0===n||n(r)),delete this.data[e]}},{key:"clearKey",value:function(e){var n=this;Object.keys(this.data).forEach((function(r){return n.removeKey.bind(n,r,e)}))}},{key:"hasKey",value:function(e){return!!this.data[e]}},{key:"getValueOfKey",value:function(e){var n=this.data[e];return null!==n&&void 0!==n?n:null}}]),e}())||o,w=r("dx_dOu9"),R=r("dx_Pgxt"),M=r("dx_N9dL"),j=r("dx_T4T0"),D=r("dx_Z22N"),A=r("dx_B28d"),P=r("dx_LSI4"),L=r("dx_JHXr"),N=r("dx_EcrF");function F(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=x()(e);if(n){var i=x()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return k()(this,r)}}var U=Object(C.H)({providers:[{provide:D.I,useClass:j.V,args:[A.B.IMAGE,{defaultHeight:120}]},{provide:M.RecordSnapshotCreator,useValue:{type:A.B.IMAGE,create:P.h}},R.u,T]})((s=function(e){m()(r,e);var n=F(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),d()(e,"imageManager",a,b()(e)),d()(e,"imageDataCacheStorage",l,b()(e)),e.blocks=[[L.S,{viewCreator:N.S}]],e}return v()(r,[{key:"init",value:function(){this.imageManager.init()}},{key:"destroy",value:function(){this.imageManager.destroy(),this.imageDataCacheStorage.clearKey(window.URL.revokeObjectURL)}}]),r}(C.y),c=s,a=S()(c.prototype,"imageManager",[w.Y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=S()(c.prototype,"imageDataCacheStorage",[I.V],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=c))||i,H=U;n.S=H},dx_D4DL:function(e,n,r){"use strict";var o=r("dx_lSNA"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_tyhF"),s=r("dx_Y0Yg"),u=r("dx_TSYQ"),d=r.n(u),f=r("dx_h6a8"),h=r("dx_cDcd"),p=r.n(h),v=r("dx_awlV"),g=(r("dx_MNju"),"docx-input-number"),b=function(e){return"".concat(e)},y=function(e){return parseInt("".concat(e),10)},m=function(e){return/^[0-9]*$/.test(e)};n.S=function(e){var n=e.defaultValue,r=e.min,o=void 0===r?1:r,c=e.max,u=void 0===c?Number.MAX_SAFE_INTEGER:c,_=e.formatter,k=void 0===_?b:_,O=e.parser,x=void 0===O?y:O,E=e.checker,S=void 0===E?m:E,C=e.onChange,I=e.onPressEnter,B=Object(h.useRef)(n||1),T=Object(h.useState)(k(n||1)),w=a()(T,2),R=w[0],M=w[1],j=Object(h.useState)(!0),D=a()(j,2),A=D[0],P=D[1],L=Object(h.useRef)(null),N=B.current===u,F=B.current===o,U=function(e){if(e){var n=e;e>u&&(n=u),e<o&&(n=o),B.current=n,M(Object(f.isFunction)(k)?k(n):n),Object(f.isFunction)(C)&&C(n,R)}},H=function(){var e=x("".concat(R).toLowerCase());U(e)},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;U(B.current+e)};return Object(h.useEffect)((function(){var e;A&&document.activeElement!==L.current&&(null===(e=L.current)||void 0===e||e.focus())})),Object(h.useEffect)((function(){var e;null===(e=L.current)||void 0===e||e.select()}),[]),p.a.createElement("div",{className:d()(g,i()({},"".concat(g,"-focus"),A))},p.a.createElement("div",{className:"".concat(g,"-input-wrap")},p.a.createElement("input",{ref:L,className:"".concat(g,"-input"),value:R,onChange:function(e){(Object(f.isFunction)(S)?S:m)(e.target.value)&&(M(e.target.value),B.current=x(e.target.value)||B.current)},onKeyDown:function(e){e.keyCode===v.G.UP?(e.preventDefault(),V(1)):e.keyCode===v.G.DOWN?V(-1):e.keyCode===v.G.ENTER&&(H(),Object(f.isFunction)(I)&&I(B.current,R),e.preventDefault())},onFocus:function(){P(!0)},onBlur:function(){H(),P(!1)}})),p.a.createElement("div",{className:"".concat(g,"-handler-wrap")},p.a.createElement("span",{className:d()("".concat(g,"-handler"),"".concat(g,"-handler-up"),i()({},"".concat(g,"-handler-disabled"),N)),onMouseDown:function(e){N||(A||P(!0),V(1))}},p.a.createElement(l.S,null)),p.a.createElement("span",{className:d()("".concat(g,"-handler"),"".concat(g,"-handler-down"),i()({},"".concat(g,"-handler-disabled"),F)),onMouseDown:function(e){F||(A||P(!0),V(-1))}},p.a.createElement(s.S,null))))}},dx_D4hX:function(e,n,r){"use strict";(function(t){r.d(n,"h",(function(){return h}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_UtDZ"),l=r("dx_h6a8"),s=r("dx_cDcd"),u=r.n(s),d=r("dx_jBAU"),f=r("dx_amgp"),h=function(){var e=c()(o.a.mark((function e(n,r,i){var c,s,h,p,v,g,b,y,m,_,k,O,x,E,S,C,I,B;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,d.S.syncOKRProgress(n);case 3:if(c=e.sent,s=c.code,h=c.data,p=h.sync_time,v=h.sync_results,g=h.objective_synced,b=h.weight_target_changed,y=h.progress_rate_type_changed,m=h.progress_record_url,_=1===n.version&&!1===g,k=b||y?1:0,0!==s){e.next=13;break}if(!_){e.next=12;break}return e.abrupt("return",{text:u.a.createElement("div",null,t("CreationDoc_Docs_OKR_SyncProgress_Success"),u.a.createElement("a",{href:m,onClick:i,target:"_blank",rel:"noopener noreferrer"},t("CreationDoc_Docs_OKR_SyncProgress_Detail"))),syncTime:p,toastType:"success"});case 12:return e.abrupt("return",{text:u.a.createElement("div",null,t("CreationDoc_Docs_OKR_SyncProgress_Success"),u.a.createElement("a",{href:m,onClick:i,style:{marginLeft:b||y?0:32},target:"_blank",rel:"noopener noreferrer"},t("CreationDoc_Docs_OKR_SyncProgress_Detail")),k?t("CreationDoc_Docs_OKR_SyncProgress_Failed_SettingChanged"):""),syncTime:p,toastType:"success"});case 13:if(!v||!v.length){e.next=24;break}if(O=Object(l.filter)(v,(function(e){return e.status===f.m.SUCCESS})),(x=Object(l.filter)(v,(function(e){return e.status===f.m.KR_DELETED}))).length!==Object(l.keys)(r).length){e.next=18;break}return e.abrupt("return",{text:t(k?"CreationDoc_Docs_OKR_SyncProgress_Failed_KRDeletedSettingChanged":"CreationDoc_Docs_OKR_SyncProgress_Failed_AllKRDeleted"),toastType:"error"});case 18:return E="zh"===a.i18nHelper.getLanguage()?"\u3001":", ",S=O.map((function(e){return r[e.target_id]})).join(E),C=x.map((function(e){return r[e.target_id]})).join(E),I=S?"".concat(t("CreationDoc_Docs_OKR_SyncProgress_Success_KR",{kr:S})).concat(t("CreationDoc_DocX_common_punctuation_comma")):"",B=C?"".concat(t("CreationDoc_Docs_OKR_SyncProgress_Failed_KRDeleted",{kr:C})):"",e.abrupt("return",{text:"".concat(I).concat(B).concat(k?"".concat(t("CreationDoc_DocX_common_punctuation_comma")).concat(t("CreationDoc_Docs_OKR_SyncProgress_Failed_SettingChanged")):""),toastType:"error"});case 24:return e.abrupt("return",{text:t("CreationDoc_Docs_OKR_SyncProgress_Failed"),toastType:"error"});case 27:return e.prev=27,e.t0=e.catch(0),e.abrupt("return",{text:t("CreationDoc_Docs_OKR_SyncProgress_Failed"),toastType:"error"});case 30:case"end":return e.stop()}}),e,null,[[0,27]])})));return function(n,r,o){return e.apply(this,arguments)}}()}).call(this,r("dx_E9Eu"))},dx_D5D1:function(e,n,r){"use strict";function o(e){return function(){try{return e.apply(void 0,arguments)}catch(n){console.error("capture error",n)}}}r.d(n,"A",(function(){return o}))},dx_D9db:function(e,n,r){"use strict";r.d(n,"f",(function(){return o})),r.d(n,"fB",(function(){return u}));var o,i=r("dx_lSNA"),c=r.n(i),a=r("dx_UtDZ");function l(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?l(Object(r),!0).forEach((function(n){c()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}!function(e){e.COPY="copy",e.PRINT="print",e.DOWNLOAD="download",e.VIEW_HISTORY="viewHistory"}(o||(o={}));var u=function(e,n){Object(a.loadCollectSecurityAudit)().then((function(r){var i=r.collectSecurityAudit,c=r.ISecurityAudit;switch(e){case o.COPY:i(c.OperationType.OperationCopyContent,s({CCM_op_status:"success"},n));break;case o.PRINT:i(c.OperationType.OperationPrint,{CCM_op_status:"success"});break;case o.DOWNLOAD:i(c.OperationType.OperationDownload,s({CCM_op_status:"success"},n));break;case o.VIEW_HISTORY:i(c.OperationType.OperationSpaceViewHistory,s({CCM_op_status:"success"},n))}return null})).catch((function(e){console.log(e)}))}},dx_DKNI:function(e,n,r){"use strict";var o;r.d(n,"Z",(function(){return o})),r.d(n,"v",(function(){return i})),r.d(n,"Q",(function(){return c})),r.d(n,"g",(function(){return a})),function(e){e.COLOR="color",e.BACKGROUND_COLOR="backgroundColor"}(o||(o={}));var i="textHighlight",c="textHighlightBackground",a="background_color"},dx_DOh9:function(e,n,r){"use strict";r.r(n);r("dx_Rbek");var o=r("dx_MM9K"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=(r("dx_aaXo"),r("dx_p4pT"),r("dx_TSYQ")),b=r.n(g),y=r("dx_UtDZ"),m=r("dx_cDcd"),_=r.n(m),k=r("dx_hlsL");function O(){return O=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},O.apply(this,arguments)}var x=_.a.createElement("defs",null,_.a.createElement("linearGradient",{x1:"50%",y1:"-62.681%",x2:"50%",y2:"35.145%",id:"icon_empty_svg__a"},_.a.createElement("stop",{stopColor:"#937EEA",offset:"0%"}),_.a.createElement("stop",{stopColor:"#C4C4C4",stopOpacity:0,offset:"100%"})),_.a.createElement("linearGradient",{x1:"50.181%",y1:"101.25%",x2:"50.181%",y2:"0%",id:"icon_empty_svg__b"},_.a.createElement("stop",{stopColor:"#FFF",stopOpacity:0,offset:"0%"}),_.a.createElement("stop",{stopColor:"#1C1E57",offset:"100%"})),_.a.createElement("linearGradient",{x1:"50.271%",y1:"7.269%",x2:"50.271%",y2:"30.635%",id:"icon_empty_svg__c"},_.a.createElement("stop",{stopColor:"#FFF",offset:"0%"}),_.a.createElement("stop",{stopColor:"#FFF",stopOpacity:0,offset:"100%"}))),E=_.a.createElement("g",{fill:"none",fillRule:"evenodd"},_.a.createElement("ellipse",{fill:"url(#icon_empty_svg__a)",fillRule:"nonzero",opacity:.3,cx:153.495,cy:125.55,rx:153.495,ry:55.89}),_.a.createElement("g",{opacity:.5,transform:"translate(109)"},_.a.createElement("path",{d:"M91.38 20A1.62 1.62 0 0093 18.38V9.72A9.72 9.72 0 0083.28 0H22.681C28.049 0 32.4 4.352 32.4 9.72v8.91c0 .577-.301 1.083-.755 1.37H91.38zm-79.071-.668a1.616 1.616 0 01-.159-.702V9.72c0-5.368 4.351-9.72 9.719-9.72h-.149C16.352 0 12 4.352 12 9.72v8.66c0 .356.115.684.309.952z",fill:"#9D9ABE"}),_.a.createElement("path",{d:"M91.38 20A1.62 1.62 0 0093 18.38V9.72A9.72 9.72 0 0083.28 0H22.681C28.049 0 32.4 4.352 32.4 9.72v8.91c0 .577-.301 1.083-.755 1.37H91.38zm-79.071-.668a1.616 1.616 0 01-.159-.702V9.72c0-5.368 4.351-9.72 9.719-9.72h-.149C16.352 0 12 4.352 12 9.72v8.66c0 .356.115.684.309.952z",fillOpacity:.2,fill:"url(#icon_empty_svg__b)"}),_.a.createElement("path",{d:"M21.72 0A9.72 9.72 0 0012 9.72V78h54.28c5.368 0 9.72-4.352 9.72-9.72V0H21.72zm54.42 8.504A8.506 8.506 0 0184 .023V0h-8v20h.14V8.504z",fillOpacity:.7,fill:"#9E9BC5"}),_.a.createElement("path",{d:"M9.72 0A9.72 9.72 0 000 9.72V78h54.28c5.368 0 9.72-4.352 9.72-9.72V0H9.72zm54.42 8.504A8.506 8.506 0 0172 .023V0h-8v20h.14V8.504z",fillOpacity:.4,fill:"url(#icon_empty_svg__c)",transform:"translate(12)"}),_.a.createElement("path",{d:"M55 59.62A1.62 1.62 0 0053.38 58H1.62A1.62 1.62 0 000 59.62v8.66C0 73.648 4.352 78 9.72 78h54.273a.007.007 0 00.007-.007c0-.004-.003-.007-.007-.007A8.5 8.5 0 0155 69.5v-9.88z",fill:"#DED6EE",fillOpacity:.4}),_.a.createElement("rect",{fill:"#FAFAFA",fillRule:"nonzero",opacity:.8,x:21.061,y:14.58,width:40.5,height:6.48,rx:3.24}),_.a.createElement("rect",{fill:"#FAFAFA",fillRule:"nonzero",opacity:.8,x:21.061,y:29.97,width:40.5,height:6.48,rx:3.24}),_.a.createElement("path",{d:"M91 9a7 7 0 00-7-7V0h.001a9 9 0 019 9v9.38a1.62 1.62 0 01-1.62 1.62H91V9zM65.9 76h-1.61A7.29 7.29 0 0157 68.71V60h-2v10a8 8 0 008 8h3.42c5.368 0 9.72-4.352 9.72-9.72V20H84v-.102h-7.86V9.16A7.29 7.29 0 0183.429 2H84V0h-2a8.1 8.1 0 00-8 8.1v59.8a8.1 8.1 0 01-8.1 8.1zM57 60h-2v-.38A1.62 1.62 0 0053.38 58h2c.894 0 1.62.725 1.62 1.62V60z",fill:"#FBFBFB",fillOpacity:.8}),_.a.createElement("path",{stroke:"#DCDBE6",strokeWidth:3.24,strokeLinecap:"round",d:"M102.329 63.489l9.72 9.72"}),_.a.createElement("path",{d:"M93.824 68.35c7.829 0 14.175-6.346 14.175-14.175 0-7.829-6.346-14.175-14.175-14.175-7.828 0-14.175 6.346-14.175 14.175 0 7.829 6.347 14.175 14.175 14.175zm0-3.24c6.039 0 10.935-4.896 10.935-10.935 0-6.04-4.896-10.935-10.935-10.935-6.039 0-10.935 4.895-10.935 10.934 0 6.04 4.896 10.935 10.935 10.935z",fill:"#A7A5C0"}),_.a.createElement("circle",{fill:"#C4C4C4",fillRule:"nonzero",cx:93.824,cy:54.174,r:10.935}),_.a.createElement("path",{d:"M100.709 54.58a7.29 7.29 0 00-7.29-7.29",stroke:"#FBFBFB",strokeWidth:3.24,strokeLinecap:"round"}))),S=function(e){return _.a.createElement("svg",O({width:307,height:182,viewBox:"0 0 307 182"},e),x,E)};r("dx_Usbk");function C(e){return _.a.createElement("div",{className:"empty-status"},_.a.createElement(S,null),_.a.createElement("span",{className:"text"},e.text))}var I=r("dx_TwmW"),B=r("dx_l6li"),T=r("dx_Vvd7"),w=r("dx_hKIY"),R=r("dx_zjmc"),M=r("dx_R53K"),j=r("dx_W6W8"),D=r("dx_zKF3"),A=r("dx_oECv"),P=r("dx_B28d"),L=r("dx_FBn3"),N=r("dx_W0Ov"),F=r("dx_vlKv"),U=r("dx_ApwS"),H=r("dx_D3ws"),V=r("dx_pVRx"),W=r("dx_MQsy"),z=r("dx_LSbp"),G=r("dx_SbhA"),K=r("dx_x1xr"),q=r("dx_yl1C"),X=r("dx_sDWs"),Y=r("dx_l8lr"),J=r("dx_wGyE"),Z=r("dx_haL5"),Q=r("dx_oxJ8"),$=r("dx_FVZU"),ee=r("dx_pk3x"),te=r("dx_ooSz"),ne=r("dx_VWMO"),re=r("dx_E3Ia"),oe=r("dx_dajS"),ie=r("dx_tokD"),ce=r("dx_V5C0"),ae=r("dx_B1B9"),le=r("dx_lSNA"),se=r.n(le),ue=r("dx_Otwn"),de=r("dx_VjTN"),fe=r("dx_H6o9"),he=r("dx_s4sk"),pe=r("dx_WX15"),ve=r("dx_e6eH"),ge=r("dx_r4mc"),be=r("dx_homR"),ye=be.m;function me(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function _e(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?me(Object(r),!0).forEach((function(n){se()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var ke=function(e){var n=[pe.S,e],r=[ue.S,e],o=[r],i=Object(I.h)()?[r]:[n,r],c=[].concat(i,[[ve.i,e]]),a=[ge.S,e],l=[].concat(i,[a]),s=[].concat(i),u=[fe.R,_e(_e({},e),{},{displayMode:P.J.BLOCK,autoNotifyRenderFinish:!0})],d=[ye,e],f=[d,u],h=[d],p=[d,u,[de.S,e]],v=[].concat(f,[[de.S,e]]),g=[[de.S,e]],b=[d,[de.S,e],[he.y,e]],y=[[de.S,e]],m=[[de.S,e]],_=[[de.S,e]];return[[P.B.TEXT,o],[P.B.HEADING1,c],[P.B.HEADING2,c],[P.B.HEADING3,c],[P.B.HEADING4,c],[P.B.HEADING5,c],[P.B.HEADING6,c],[P.B.HEADING7,c],[P.B.HEADING8,c],[P.B.HEADING9,c],[P.B.FILE,g],[P.B.CHAT_CARD,b],[P.B.BULLET,s],[P.B.QUOTE,o],[P.B.CODE,y],[P.B.ORDERED,l],[P.B.TODO,o],[P.B.DIAGRAM,p],[P.B.SHEET,f],[P.B.BITABLE,f],[P.B.MINDMAP,v],[P.B.POLL,f],[P.B.BOOKMARK,m],[P.B.IMAGE,h],[P.B.JIRA_ISSUE,_]]},Oe=r("dx_pzLC"),xe=r("dx_T4T0"),Ee=r("dx_Z22N"),Se=r("dx_iWIM"),Ce=r.n(Se),Ie=r("dx_iHWM");function Be(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var Te,we,Re=function(e){d()(r,e);var n=Be(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).isLoaded=!1,e}return s()(r,[{key:"updateSvg",value:function(){Ce()(v()(r.prototype),"updateSvg",this).call(this),this.isLoaded=!0,setTimeout((function(){window.dispatchEvent(Object(Ie.x)("diagramBlockDidRender"))}))}}]),r}(r("dx_bD2y").Y);function Me(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var je,De,Ae=Object(T.H)({providers:[{provide:Ee.I,useClass:xe.V,args:[P.B.DIAGRAM,{isAsync:!0,defaultHeight:220}]}]})((we=function(e){d()(r,e);var n=Me(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).blocks=[[Oe.S,{viewCreator:Re}]],e}return r}(T.y),Te=we))||Te,Pe=r("dx_q20L"),Le=r("dx_ztHZ");function Ne(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var Fe=Object(T.H)()((De=function(e){d()(r,e);var n=Ne(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).blocks=[[Pe.S,{viewCreator:Le.G}]],e}return r}(T.y),je=De))||je,Ue=r("dx_J8b8");function He(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var Ve,We,ze=function(e){d()(r,e);var n=He(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"handleVotesChange",value:function(e){Ce()(v()(r.prototype),"handleVotesChange",this).call(this,e,!1),setTimeout((function(){window.dispatchEvent(Object(Ie.x)("pollBlockDidRender"))}))}}]),r}(r("dx_AiiH").Y);function Ge(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var Ke=Object(T.H)()((We=function(e){d()(r,e);var n=Ge(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).blocks=[[Ue.c,{viewCreator:ze}]],e}return r}(T.y),Ve=We))||Ve;function qe(){return Object(ee.k)()}function Xe(){return qe()}function Ye(){return Object(ee.f)()}function Je(){return[Object(T.Y)(X.i,{getTextEditorOptions:Ye}),Object(T.Y)(A.D,{getTextEditorOptions:Xe}),Object(T.Y)($.T,{getTextEditorOptions:qe}),Object(T.Y)(U.R,{getTextEditorOptions:qe}),Object(T.Y)(Y.y,{getTextEditorOptions:qe}),Object(T.Y)(G.D,{getTextEditorOptions:qe}),Object(T.Y)(z.a,{getTextEditorOptions:qe}),Object(T.Y)(te.Y,{getTextEditorOptions:qe}),Object(T.Y)(L.S),Object(T.Y)(j.G),Object(T.Y)(W.o),Object(T.Y)(R.S),Object(T.Y)(Ae),Object(T.Y)(V.S),Object(T.Y)(J.S),Object(T.Y)(K.S),Object(T.Y)(Ke),Object(T.Y)(q.S,{getTextEditorOptions:qe}),Object(T.Y)(Q.Y),Object(T.Y)(re.Z),Object(T.Y)(oe.l),Object(T.Y)(N.S),Object(T.Y)(ne.S),Object(T.Y)(H.S),Object(T.Y)(Fe),Object(T.Y)(D.S),Object(T.Y)(M.S),Object(T.Y)(F.w),Object(T.Y)(Z.A),Object(T.Y)(ce.u,{loadableBlockTypes:[P.B.MINDMAP,P.B.BITABLE,P.B.SHEET,P.B.FILE,P.B.CODE]}),Object(T.Y)(ae.S),Object(T.Y)(w.H),Object(T.Y)(ie.B,{getExtensions:ke})]}function Ze(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var Qe,$e=function(e){d()(r,e);var n=Ze(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).state={loading:!0,error:!1},e.handleMount=function(n){console.log("editor mount",n),e.setState({loading:!1,error:!1}),setTimeout((function(){var e;window.dispatchEvent(Object(Ie.x)("docxDidRender",{detail:{editor:n}})),null===(e=window.__SSR__)||void 0===e||e.clean()}))},e.handleError=function(n){console.error("editor error",n),e.setState({loading:!1,error:!0})},e.scrollerRef=Object(m.createRef)(),e}return s()(r,[{key:"render",value:function(){var e=Object(y.getToken)(),n=!!Object(I.h)(),r=b()("shortcut-page-container",{pdf:n,shortcut:!n});return _.a.createElement("div",{className:r,ref:this.scrollerRef,style:{minHeight:window.innerHeight}},this.state.loading&&_.a.createElement(i.a,{size:"large"}),this.state.error&&_.a.createElement(C,{text:""}),_.a.createElement(k.S,null),_.a.createElement(B.V,{enableVirtualRender:!1,scroller:this.scrollerRef,onMount:this.handleMount,token:e,recursionProps:{isPDF:Object(I.h)(),isShortcut:!0,editable:!1,isNeedToBlock:!Object(I.h)()},getEditorModules:Je,onFetchError:this.handleError,onError:this.handleError}))}}]),r}(_.a.PureComponent),et=$e,tt=r("dx_o0o1"),nt=r.n(tt),rt=r("dx_yXPU"),ot=r.n(rt),it=r("dx_J4zp"),ct=r.n(it),at=r("dx_yzqx"),lt=r("dx_Wkzy"),st=r("dx_m5Ht"),ut=r("dx_U9rT"),dt=r("dx_IWVf"),ft=r("dx_OPAz"),ht=r("dx_USRY"),pt=r("dx_D8nn"),vt=r("dx_r4RQ"),gt=r("dx_F0FY"),bt=at.S.windows?"'Source Code Pro', Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', 'Microsoft Yahei'":"SourceCodeProMac",yt=Date.now(),mt=Object(I.h)()?110:7,_t=new Set,kt=!1,Ot=!1,xt=null,Et=new Set,St=new Set,Ct=[P.B.SHEET,P.B.MINDMAP,P.B.BITABLE,P.B.ISV,P.B.DIAGRAM,P.B.FILE,P.B.POLL,P.B.EQUATION,P.B.WIKI_CATALOG,P.B.WIKI_RECENT],It={},Bt={},Tt={},wt=function(){kt=!1,It={},Ct.forEach((function(e){Tt[e]=0,Bt[e]=0,It[e]=0})),Et.clear(),St.clear(),_t.clear(),Qe&&clearTimeout(Qe)};wt();var Rt=function(){return kt},Mt=function(e){return Bt[e]+It[e]>=Tt[e]},jt=function(){var e=window.shortcutRenderStart;return e?Date.now()-e:0},Dt=function(e,n){return n===P.B.BITABLE?Et.has(e.getTableId()):n===P.B.MINDMAP?St.has(e.id):n===P.B.SHEET?e.isBlockRendered:n===P.B.ISV?e.loadedStatus===st.z.success:n===P.B.IMAGE?(null===(r=e.state)||void 0===r?void 0:r.loadEnd)&&!(null===(o=e.state)||void 0===o?void 0:o.isError)&&(null===(i=e.state)||void 0===i?void 0:i.isBlockReady):n===P.B.DIAGRAM?e.isLoaded:n===P.B.POLL?null===(c=e.state)||void 0===c?void 0:c.isPublish:n===P.B.CHAT_CARD?(null===(a=e.state)||void 0===a?void 0:a.loadSuccess)||e.hostElement.querySelector(".block-error-view"):void 0;var r,o,i,c,a},At=function(){Object(gt.q)("blockLoadTimeout"),kt=!0,!Mt(P.B.SHEET)&&_t.add(P.B.SHEET),!Mt(P.B.BITABLE)&&_t.add(P.B.BITABLE),!Mt(P.B.ISV)&&_t.add(P.B.ISV),!Mt(P.B.MINDMAP)&&_t.add(P.B.MINDMAP),!Mt(P.B.DIAGRAM)&&_t.add(P.B.DIAGRAM),!Mt(P.B.POLL)&&_t.add(P.B.POLL),_t.add(P.B.IMAGE),_t.add(P.B.CHAT_CARD),function(e){var n,r;(null===(n=xt)||void 0===n||null===(r=n.blockManager)||void 0===r?void 0:r.recordManager)&&(_t.forEach((function(e){e&&(It[String(e)]=0)})),xt.blockManager.allBlockViews.forEach((function(n){if(_t.has(n.type)&&!e(n,n.type)){It[n.type]++;var r=n.record.id;pt.N.emit(be.S,r),Object(gt.q)("".concat(n.snapshot.type," LoadTimeout"),r)}})),Object(gt.q)("unloadedBlockNumMap",It))}(Dt),Vt(),Qe&&clearTimeout(Qe)},Pt=function(){var e=jt();e>1e3*mt&&(Object(gt.q)("checkTimeout",e),At())},Lt=function(e){var n=0;return xt&&xt.blockManager&&xt.fold?(xt.blockManager.recordManager.getRecordMap().forEach((function(r){if(xt&&r.snapshot.type===e){var o,i,c;if(!(null===(o=xt.blockManager)||void 0===o?void 0:o.getBlockModelsByRecordId(r.id).length))return void Object(gt.q)("cant find block struct",r.id);var a=null===(i=xt.blockManager)||void 0===i?void 0:i.getBlockModelsByRecordId(r.id)[0],l=a&&(null===(c=xt.fold)||void 0===c?void 0:c.isShowWithStruct(a));if(!Object(I.h)()&&a&&!l)return;n++}})),n):n},Nt=function(e){var n=[];if(!xt)return n;var r=xt,o=r.blockManager,i=r.fold;return o&&i?(o.traverse(o.rootBlockId,(function(r){var c=o.getBlockModelByBlockId(r);return c.snapshot.type!==e||c&&i.isShowWithStruct(c)&&n.push(c.id),!0})),n):n},Ft=function e(n){var r;(null===(r=xt)||void 0===r?void 0:r.blockManager)?kt||xt.blockManager.editorAPI.getService(ut.i).getDepLoader().getBridge().takeScreenShot(n).then((function(e){Bt[P.B.MINDMAP]++,St.add(n),e.done(),Mt(P.B.MINDMAP)&&setTimeout((function(){Vt()}),20),Object(gt.q)("mindmapTakeScreenShot",Bt[P.B.MINDMAP],Tt[P.B.MINDMAP]),Pt()})).catch((function(){Object(gt.q)("mindmapTakeScreenShot error")})):setTimeout((function(){e(n)}),100)},Ut=function e(n){var r;if(null===(r=xt)||void 0===r?void 0:r.blockManager){if(!Et.has(n)&&!kt){Pt();var o=xt.blockManager.editorAPI.getService(lt.x).getLoadedBridge();null===o||void 0===o||o.takeScreenShot(n,!0,!0).then((function(){Bt[P.B.BITABLE]++,Et.add(n),Mt(P.B.BITABLE)&&setTimeout((function(){Vt()}),20),Object(gt.q)("bitableTakeScreenShot",Bt[P.B.BITABLE],Tt[P.B.BITABLE]),Pt()}))}}else setTimeout((function(){e(n)}),100)},Ht=function(){var e=ot()(nt.a.mark((function e(n){var r,o;return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=xt)||void 0===r?void 0:r.blockManager){e.next=3;break}return setTimeout((function(){Ht(n)}),100),e.abrupt("return");case 3:o=xt.blockManager.editorAPI.getService(ft.H).getLoadedBridge(),Bt[P.B.SHEET]++,Object(gt.q)("sheetDidRender",Bt[P.B.SHEET],Tt[P.B.SHEET]),o.wakeup(n),Mt(P.B.SHEET)&&setTimeout((function(){Vt()}),20);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();function Vt(){if(function(){var e=Mt(P.B.SHEET),n=Mt(P.B.MINDMAP),r=Mt(P.B.BITABLE),o=Mt(P.B.ISV),i=Mt(P.B.DIAGRAM),c=Mt(P.B.POLL),a=Mt(P.B.FILE)||kt,l=Mt(P.B.EQUATION),s=Mt(P.B.WIKI_CATALOG),u=Mt(P.B.WIKI_RECENT);return e&&r&&o&&i&&n&&c&&a&&l&&s&&u}()&&!Ot){var e=new Image,n=Date.now(),r="//localhost/signal/loaded/?t=".concat(n),o=[Object(Ie.Y)(document,Rt),Wt(),new Promise((function(e){var n=Nt(P.B.CHAT_CARD);if(0===n.length)return e({});var r=0;function o(){return i.apply(this,arguments)}function i(){return(i=ot()(nt.a.mark((function n(){return nt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(++r>250)){n.next=3;break}return n.abrupt("return",Object(Ie.w)({reason:"mention loaded time out"}));case 3:return n.next=5,c();case 5:n.sent?e({}):setTimeout(o,20);case 7:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function c(){return new Promise((function(e,r){var o=0;if(kt)return e(!0);for(var i=0,c=n.length;i<c;i++){var a,l,s=n[i],u=null===(a=xt)||void 0===a||null===(l=a.blockManager)||void 0===l?void 0:l.getBlockViewByBlockId(s).hostElement;if(!u)return e(!1);var d=u.querySelector(".chat-card--title"),f=u.querySelector(".block-error-view");d||f?Object(Ie.Y)(u,Rt).then((function(){++o===n.length&&e(!0)})).catch((function(e){return r(e)})):e(!1)}}))}o()})),zt(),new Promise((function(e,n){kt&&e(!0);var r=Nt(P.B.POLL);if(0===r.length)return e(void 0);var o=0;function i(){++o===r.length&&e(void 0)}for(var c=0,a=r.length;c<a;c++){var l,s,u=r[c],d=null===(l=xt)||void 0===l||null===(s=l.blockManager)||void 0===s?void 0:s.getBlockViewByBlockId(u).hostElement;d?Object(Ie.Y)(d,Rt).then((function(){i()})).catch((function(e){return n(e)})):i()}})),new Promise((function(e){var n=Nt(P.B.TASK);if(0===n.length)return e({});var r=0;function o(){return i.apply(this,arguments)}function i(){return(i=ot()(nt.a.mark((function n(){return nt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(++r>250)){n.next=3;break}return n.abrupt("return",Object(Ie.w)({reason:"task loaded time out"}));case 3:return n.next=5,c();case 5:n.sent?e({}):setTimeout(o,20);case 7:case"end":return n.stop()}}),n)})))).apply(this,arguments)}function c(){return new Promise((function(e,r){for(var o=0,i=0,c=n.length;i<c;i++){var a,l,s=n[i],u=null===(a=xt)||void 0===a||null===(l=a.blockManager)||void 0===l?void 0:l.getBlockViewByBlockId(s),d=null===u||void 0===u?void 0:u.hostElement;if(kt)return u&&pt.N.emit(be.S,u.record.id),e(!0);if(!d)return e(!1);var f=d.querySelector(".task-block-shortcut-ready");f?Object(Ie.Y)(d,Rt).then((function(){++o===n.length&&e(!0)})).catch((function(e){return r(e)})):e(!1)}}))}o()}))];kt&&(o=[]);var i=1;Promise.all(o).then((function(){try{i=Object(gt.B)()}catch(e){Object(gt.q)("calcAddOffset catch error :",e)}Object(gt.q)("pageCount",i)})).then((function(){Ot=!0,setTimeout((function(){requestAnimationFrame((function(){var n=Date.now();console.info("".concat(vt.A," sendDidRenderSignal"),(n-yt)/1e3),e.src=i?"".concat(r,"&pageCount=").concat(i):r}))}),20),Object(gt.q)("sendDidRenderSignalTime",jt()),wt()})).catch((function(e){wt(),Object(gt.q)("sendDidRenderSignal catch error :",e)}))}}function Wt(){var e=!!Lt(P.B.CODE),n=document.fonts;return e&&n?new Promise((function(e,r){n.load('100px "'.concat(bt,'"'),"BESbswy").then(e).catch(r),kt&&e(!0)})):Promise.resolve()}function zt(){if(Object(I.h)()){var e=document.getElementsByTagName("a");try{Array.from(e).forEach((function(e){var n=e&&e.getAttribute("data-href"),r=e&&e.getAttribute("href");n&&!r&&e.setAttribute("href",n)}))}catch(n){console.info("addLinkAttribute error",n)}}}window.addEventListener("sheetDidRender",function(){var e=ot()(nt.a.mark((function e(n){var r;return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(I.h)()){e.next=5;break}return Bt[P.B.SHEET]++,Mt(P.B.SHEET)&&setTimeout((function(){Vt()}),20),Object(gt.q)("sheetDidRender",Bt[P.B.SHEET],Tt[P.B.SHEET]),e.abrupt("return");case 5:r=n.detail.sheetId,Ht(r);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),window.addEventListener("ISVBlockDidRender",ot()(nt.a.mark((function e(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Bt[P.B.ISV]++,Mt(P.B.ISV)&&setTimeout((function(){Vt()}),20),Object(gt.q)("ISVBlockDidRender",Bt[P.B.ISV],Tt[P.B.ISV]);case 3:case"end":return e.stop()}}),e)})))),window.addEventListener("diagramBlockDidRender",ot()(nt.a.mark((function e(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Bt[P.B.DIAGRAM]++,Mt(P.B.DIAGRAM)&&setTimeout((function(){Vt()}),20),Object(gt.q)("diagramBlockDidRender",Bt[P.B.DIAGRAM],Tt[P.B.DIAGRAM]);case 3:case"end":return e.stop()}}),e)})))),window.addEventListener("pollBlockDidRender",ot()(nt.a.mark((function e(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Bt[P.B.POLL]++,Mt(P.B.POLL)&&setTimeout((function(){Vt()}),20),Object(gt.q)("pollBlockDidRender",Bt[P.B.POLL],Tt[P.B.POLL]);case 3:case"end":return e.stop()}}),e)})))),window.addEventListener("filePreviewDidRender",ot()(nt.a.mark((function e(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Bt[P.B.FILE]++,Mt(P.B.FILE)&&setTimeout((function(){Vt()}),20),Object(gt.q)("filePreviewDidRender",Bt[P.B.FILE],Tt[P.B.FILE]);case 3:case"end":return e.stop()}}),e)})))),window.addEventListener("bitableDidRender",function(){var e=ot()(nt.a.mark((function e(n){var r;return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.detail.tableId,Ut(r);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),window.addEventListener("mindmapBlockDidRender",function(){var e=ot()(nt.a.mark((function e(n){var r;return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.detail.blockId,Ft(r);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),window.addEventListener("equationDidRender",ot()(nt.a.mark((function e(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Bt[P.B.EQUATION]++,Mt(P.B.EQUATION)&&setTimeout((function(){Vt()}),20),Object(gt.q)("equationDidRender",Bt[P.B.EQUATION],Tt[P.B.EQUATION]);case 3:case"end":return e.stop()}}),e)})))),window.addEventListener("wikiBlockDidRender",(function(e){var n=e.detail.blockType;Bt[n]++,Mt(n)&&setTimeout((function(){return Vt()}),20),Object(gt.q)("wikiBlockDidRender",n,Bt[n],Tt[n])})),window.addEventListener("docxDidRender",(function(e){var n,r;(xt=e.detail.editor,window.context=xt,Object(I.h)())&&(null===(n=xt)||void 0===n||null===(r=n.fold)||void 0===r||r.enterIgnoreMode());kt=!1,Ot=!1;var o=1e3*mt-jt();o=o>0?o:0,Object(gt.q)("docxDidRender",o),Qe=window.setTimeout((function(){At()}),o),Tt[P.B.SHEET]=Lt(P.B.SHEET),Tt[P.B.MINDMAP]=Lt(P.B.MINDMAP),Tt[P.B.BITABLE]=Lt(P.B.BITABLE),Tt[P.B.ISV]=Lt(P.B.ISV),Tt[P.B.DIAGRAM]=Lt(P.B.DIAGRAM),Tt[P.B.POLL]=Lt(P.B.POLL),Tt[P.B.WIKI_CATALOG]=Lt(P.B.WIKI_CATALOG),Tt[P.B.WIKI_RECENT]=Lt(P.B.WIKI_RECENT),Tt[P.B.FILE]=function(){var e=0;return xt&&xt.blockManager&&xt.fold?(Nt(P.B.FILE).forEach((function(n){var r,o,i=null===(r=xt.blockManager)||void 0===r?void 0:r.getBlockViewByBlockIdNotCheck(n);i&&(null===(o=i.props)||void 0===o?void 0:o.viewType)===ht.t.Preview&&e++})),e):e}(),Tt[P.B.EQUATION]=function(e){var n=0;return xt&&xt.blockManager&&xt.fold?(xt.blockManager.recordManager.getRecordMap().forEach((function(r){var o;if(xt){var i=null===(o=xt.blockManager)||void 0===o?void 0:o.getBlockModelsByRecordId(r.id)[0];if(null===i||void 0===i?void 0:i.isTextBlock){var c,a=i&&(null===(c=xt.fold)||void 0===c?void 0:c.isShowWithStruct(i)),l=r.snapshot.text;if(i&&!a||!l)return;for(var s=l.initialAttributedTexts.attribs[0],u=0,d=Object.entries(l.apool.numToAttrib);u<d.length;u++){var f=ct()(d[u],2),h=f[0],p=f[1],v=parseInt(h).toString(36);if(ct()(p,1)[0]===e){var g,b=new RegExp("\\*".concat(v,"[+*]"),"g"),y=null===(g=s.match(b))||void 0===g?void 0:g.length;y&&(n+=y)}}}}})),n):n}(P.B.EQUATION),Object(gt.q)("blockNumber",JSON.stringify(Tt)),Tt[P.B.POLL]>0&&dt.D.preload(),Vt()}));n.default=et},dx_DOue:function(e,n,r){"use strict";r.d(n,"A",(function(){return d}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_PcQO"),a=r("dx_TSYQ"),l=r.n(a),s=r("dx_cDcd"),u=r.n(s);r("dx_Kkdw");function d(e){var n,r=e.children,o=e.disabled,a=e.onClick,s=l()((n={},i()(n,"task-block-ud__checkbox",!0),i()(n,"checkboxNormal",!0),i()(n,"checkboxDisabled",o),n));return u.a.createElement("div",{className:"task-block-placeholder-wrapper",contentEditable:!1,onClick:a},u.a.createElement("span",{className:"task-block-status"},u.a.createElement(c.Checkbox,{className:s,checked:!1,disabled:o})),r)}},dx_DP1I:function(e,n,r){"use strict";var o;r.d(n,"K",(function(){return o})),function(e){e[e.ON_FIRST_BLOCK_IN_PRE_ORDER=0]="ON_FIRST_BLOCK_IN_PRE_ORDER",e[e.ON_LAST_BLOCK_IN_PRE_ORDER=1]="ON_LAST_BLOCK_IN_PRE_ORDER"}(o||(o={}))},dx_DPFu:function(e,n,r){"use strict";r.d(n,"t",(function(){return f})),r.d(n,"W",(function(){return h})),r.d(n,"F",(function(){return p})),r.d(n,"p",(function(){return v}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_UtDZ"),a=r("dx_AAGW"),l=r("dx_AilC");function s(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function u(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?s(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function d(){return{baseURL:Object(l.Y)(),headers:{"Agw-Js-Conv":1,"okr-language":c.i18nHelper.getLanguage().startsWith("zh")?"zh-CN":"en-US"}}}function f(e){return a.S.get("/okrx/api/block/admin_users/",u({params:e},d()))}function h(){return a.S.get("/okrx/api/block/entrance/auth/",u({},d()))}function p(e,n){return a.S.get("/okrx/api/block/search_okr_info/",u({params:e,cancelToken:new a.C(n)},d()))}function v(e,n){return a.S.get("/okrx/api/block/get_okr_info/",u({params:e,cancelToken:new a.C(n)},d()))}},dx_DPnS:function(e,n,r){},dx_DSuC:function(e,n,r){"use strict";var o,i,c=r("dx_lwsE"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_N9dL"),g=r("dx_T4T0"),b=r("dx_Z22N"),y=r("dx_B28d"),m=r("dx_hMKL"),_=r("dx_q20L"),k=r("dx_Vsac");function O(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var x=Object(p.H)({providers:[{provide:b.I,useClass:g.V,args:[y.B.IFRAME,{isAsync:!0,shouldRetain:!0,defaultHeight:220}]},{provide:v.RecordSnapshotCreator,useValue:{type:y.B.IFRAME,create:m.F}}]})((i=function(e){s()(r,e);var n=O(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).blocks=[[_.S,{viewCreator:k.S}]],e}return r}(p.y),o=i))||o,E=x;n.S=E},dx_DX3a:function(e,n,r){"use strict";r.d(n,"o",(function(){return h})),r.d(n,"F",(function(){return p}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_B28d"),a=r("dx_oKt1");function l(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return s(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return s(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function s(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function u(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function d(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?u(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var f=new Set(c.Zn),h=function(e,n,r){var o=function(e){var n={},r=0,o=0,i=e.allBlockModels;if(!i)return d({total_block_count:0,page_block_lines:0},n);var c,a=l(i);try{for(a.s();!(c=a.n()).done;){var s=c.value;if(r++,s.isRoot){var u=s.record.snapshot.children;o=u&&u instanceof Array&&u.length||-1}var h=s.type;if(f.has(h)){var p="".concat(h,"_block_count");n[p]?n[p]++:n[p]=1}}}catch(v){a.e(v)}finally{a.f()}return d({total_block_count:r,page_block_lines:o},n)}(e),i=n.getDocComments(!0,!0).size,c=Object(a.q)()?"LOCAL":(null===r||void 0===r?void 0:r.useCache)?"CACHE":"NETWORK";return d(d({},o),{},{comment:i,clientvar_from:c})},p=function(e,n,r){return function(){return h(e,n,r)}}},dx_DXiY:function(e,n,r){"use strict";r.d(n,"G",(function(){return p})),r.d(n,"r",(function(){return v})),r.d(n,"M",(function(){return g})),r.d(n,"D",(function(){return b})),r.d(n,"P",(function(){return y}));var o=r("dx_Icqc"),i=r("dx_FBWK"),c=r("dx_MWd8"),a=r("dx_Py6Q"),l=r("dx_l8lP"),s=r("dx_Lqhf"),u=r("dx_KgXx"),d={},f={text:new Map(Object.keys(l.Lo).map((function(e){return[e,a.C.includes(e)?"":Object(c.f)(Object(i.getColor)(l.Lo[e],o.ThemeType.LIGHT))]}))),background:new Map(Object.keys(l.L).map((function(e){return[e,a.C.includes(e)?"":Object(c.f)(Object(i.getColor)(l.L[e],o.ThemeType.LIGHT))]})))},h=function(e,n){var r=f[e];return Object(u.v)(r,n)},p=function(e,n){var r=h(e,n),o=e===s.D.Background?l.L:l.Lo;return r?o[r]:n},v=function(e,n){var r=h(e,n);return r&&l.Z[e][r]},g=function(e){var n=d[e];n||(n=function(e){return{text:new Map(Object.keys(l.Lo).map((function(n){return[n,Object(c.f)(Object(i.getColor)(l.Lo[n],e))]}))),background:new Map(Object.keys(l.L).map((function(n){return[n,Object(c.f)(Object(i.getColor)(l.L[n],e))]})))}}(e),d[e]=n)},b=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(o.getCurrentThemeType)();d[n]||g(n);var r=d[n];return r[e]},y=function(e){return f[e]}},dx_DbCN:function(e,n,r){"use strict";function o(e){return e instanceof HTMLElement?e.scrollTop:e instanceof Document&&e.scrollingElement?e.scrollingElement.scrollTop:window.scrollY}function i(e){return e instanceof HTMLElement?e.offsetHeight:e instanceof Document&&e.scrollingElement?e.scrollingElement.offsetHeight:window.innerHeight}function c(e){return e instanceof HTMLElement?e.scrollHeight:e instanceof Document&&e.scrollingElement?e.scrollingElement.scrollHeight:document.documentElement.scrollHeight}r.d(n,"h",(function(){return o})),r.d(n,"O",(function(){return i})),r.d(n,"r",(function(){return c}))},dx_DlF2:function(e,n,r){"use strict";r.d(n,"l",(function(){return b})),r.d(n,"H",(function(){return y})),r.d(n,"h",(function(){return m})),r.d(n,"PB",(function(){return _})),r.d(n,"u",(function(){return k})),r.d(n,"uS",(function(){return O})),r.d(n,"n",(function(){return x})),r.d(n,"P",(function(){return E})),r.d(n,"Y",(function(){return S})),r.d(n,"d",(function(){return C}));var o=r("dx_VkAN"),i=r.n(o),c=r("dx_Dtiu"),a=r.n(c);function l(){var e=i()(["\n  margin-right: -36px;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  width: 76px;\n  height: 36px;\n  border-radius: 18px 0 0 18px;\n  border: 1px solid var(--line-border-card);\n  background-color: var(--bg-body);\n  padding-left: 10px;\n  transition: transform 0.3s;\n  cursor: pointer;\n  pointer-events: all;\n  transform: translateX(",");\n  .add-comment-btn {\n    width: 24px;\n    height: 24px;\n    line-height: 24px;\n    text-align: center;\n    font-size: 18px;\n    color: var(--icon-n1);\n  }\n  &:hover {\n    .add-comment-btn {\n      color: var(--B500);\n    }\n  }\n"]);return l=function(){return e},e}function s(){var e=i()(["\n  position: sticky;\n  top: 0;\n  padding-top: 5px;\n  overflow: hidden;\n"]);return s=function(){return e},e}function u(){var e=i()(["\n  position: absolute;\n  top: 0;\n  height: 100%;\n  right: 0;\n  z-index: 4;\n  pointer-events: none;\n"]);return u=function(){return e},e}function d(){var e=i()(["\n  position: sticky;\n  top: calc(100% - 120px - 36px);\n  flex-shrink: 0;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  height: 36px;\n  padding: 0 16px 0 12px;\n  font-size: 14px;\n  color: var(--text-title);\n  border-radius: 18px;\n  box-shadow: var(--shadow-md-down);\n  background-color: var(--bg-float);\n  cursor: pointer;\n  z-index: 4;\n  // \u4fee\u590d safari \u95ea\u52a8\u95ee\u9898\n  transform: translateZ(1px);\n  ","\n  span {\n    margin-left: 8px;\n  }\n  svg {\n    path {\n      fill: var(--icon-n1);\n    }\n  }\n"]);return d=function(){return e},e}function f(){var e=i()(["\n  display: flex;\n  cursor: pointer;\n  font-size: 16px;\n  svg {\n    path {\n      fill: var(--icon-n2);\n    }\n  }\n  &:hover {\n    svg {\n      path {\n        fill: var(--primary-pri-500);\n      }\n    }\n  }\n"]);return f=function(){return e},e}function h(){var e=i()(["\n  flex-shrink: 0;\n  display: flex;\n  align-items: center;\n  width: 100%;\n  height: 40px;\n  padding: 8px 16px;\n  padding-right: 8px;\n  position: sticky;\n  top: 0;\n  background-color: var(--bg-body);\n  z-index: 3;\n  border-style: solid;\n  border-width: 0 0 1px 0;\n  border-color: var(--line-border-card);\n  // \u4fee\u590d safari \u95ea\u52a8\u95ee\u9898\n  transform: translateZ(1px);\n  // \u5904\u7406\u8bc4\u8bba\u590d\u5236\u9009\u53d6\u7684\u95ee\u9898\n  user-select: none;\n  > span {\n    flex: 1;\n    font-size: 14px;\n    font-weight: 500;\n  }\n"]);return h=function(){return e},e}function p(){var e=i()(["\n  padding: 0 12px 96px;\n  width: ","px;\n"]);return p=function(){return e},e}function v(){var e=i()(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]);return v=function(){return e},e}function g(){var e=i()(["\n  position: absolute;\n  top: 0;\n  right: 0;\n  min-height: 100%;\n  border-left: 1px solid var(--line-border-card);\n  z-index: 1;\n  background-color: var(--bg-body);\n  transform: translateX(","px);\n  transition: ",";\n  visibility: ",";\n  ","\n  ","\n"]);return g=function(){return e},e}var b=294,y=a.a.div.attrs({id:"docCommentContainer"})(g(),b+1,(function(e){return e.noAnimation?"none":"transform .3s ease"}),(function(e){return e.hideContainer?"hidden":"visible"}),(function(e){return e.show?"transform: translateX(0);":""}),(function(e){return"display: ".concat(e.display||"block")})),m=a.a.div(v()),_=a.a.div(p(),b),k=a.a.div(h()),O=a.a.div(f()),x=a.a.div(d(),(function(e){return e.show?"\n    visibility: visible;\n    opacity: 1;\n    transition: none;\n  ":"\n    visibility: hidden;\n    opacity: 0;\n    transition: visibility 0s .2s,opacity .2s linear;\n  "})),E=a.a.div(u()),S=a.a.div(s()),C=a.a.div(l(),(function(e){return e.show?"0":"40px"}))},dx_DphS:function(e,n,r){},dx_Dq30:function(e,n,r){"use strict";r.d(n,"Y",(function(){return o})),r.d(n,"b",(function(){return i})),r.d(n,"Z",(function(){return c})),r.d(n,"C",(function(){return a})),r.d(n,"P",(function(){return l}));var o=5,i=12,c=520,a=120,l="doc-cover-wrapper"},dx_Drce:function(e,n,r){},dx_Dsxx:function(e,n,r){"use strict";var o,i;r.d(n,"G",(function(){return o})),r.d(n,"c",(function(){return i})),function(e){e.add_panel="add_panel",e.slash_panel="slash_panel",e.web_menu_panel="web_menu_panel",e.content_page="content_page",e.web_text_bubble_toolbar="web_text_bubble_toolbar",e.mobile_edit_toolbar="mobile_edit_toolbar",e.mobile_menu_toolbar="mobile_menu_toolbar"}(o||(o={})),function(e){e.markdown_action="markdown_action",e.block_action="block_action",e.hotkey_action="hotkey_action"}(i||(i={}))},dx_Dtqr:function(e,n,r){"use strict";r.d(n,"C",(function(){return c}));var o=r("dx_yzqx"),i=r("dx_H1q2"),c=function(){return Object(i.w)()||o.S.isMobile&&o.S.isBytedanceApp}},dx_Durh:function(e,n,r){},dx_Dw4b:function(e,n,r){"use strict";var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_C7Cb"),h=r("dx_KTtu"),p=r("dx_m0BX"),v=function(){function e(n){var r=n.blockId,o=n.key,i=n.blockManager;s()(this,e),this.blockId=void 0,this.key=void 0,this.blockManager=void 0,this.type=h.V.Block,this.visible=!0,this.matchId=void 0,this.blockId=r,this.key=o,this.blockManager=i,this.matchId=Object(f.S)()}return d()(e,[{key:"scrollIntoView",value:function(e,n,r,o){var c=this.blockId,l=n.getRecordByBlockId(this.blockId);return l?e.scrollToRecord(l.id,a()(i.a.mark((function e(){var a,l,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=r.getBlockRect(c),l=a.top+Object(p.F)(n),s=l+a.height,Object(p.E)({startTop:l,endBottom:s,scrollContainer:o});case 4:case"end":return e.stop()}}),e)})))):(console.error("[baseBlockMatch/scrollIntoView] get recordId error"),Promise.resolve())}},{key:"rangeId",get:function(){return this.blockId}},{key:"isReplaceable",get:function(){return!1}},{key:"currentBlockModel",get:function(){return this.blockManager.getBlockModelByBlockId(this.blockId)}}]),e}();n.S=v},dx_DwtJ:function(e,n,r){"use strict";var o;r.d(n,"x",(function(){return o})),function(e){e.RefreshOnly="refreshOnly",e.CopyRefresh="copyRefresh",e.ContactUs="contactUs",e.PermissionDenied="permissionDenied",e.OverLimit="overLimit",e.Noop="noop",e.NotOops="notOops"}(o||(o={}))},dx_E1yU:function(e,n,r){"use strict";r.d(n,"S",(function(){return c}));var o=r("dx_UtDZ"),i=r("dx_bUYd");function c(e){return!Object(o.isOnline)()&&(Object(i.v)({content:e}),!0)}},dx_E2oU:function(e,n,r){"use strict";r.d(n,"L",(function(){return a})),r.d(n,"s",(function(){return l})),r.d(n,"X",(function(){return s}));var o=r("dx_k64k"),i=r("dx_BmAg");r.d(n,"I",(function(){return i.I})),r.d(n,"j",(function(){return i.j}));var c=r("dx_JMey");function a(e){return e.appState.currentUser}function l(e){return e.docx.root.pageToken}function s(e){return e.docx.root.isFirstLineEmpty}r.d(n,"a",(function(){return c.a})),r.d(n,"A",(function(){return c.A})),r.d(n,"n",(function(){return c.n})),r.d(n,"M",(function(){return c.M}));Object(o.m)("userAction")},dx_E3Ia:function(e,n,r){"use strict";r.d(n,"Z",(function(){return O}));var o,i,c=r("dx_lwsE"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_N9dL"),g=r("dx_B28d"),b=r("dx_o68o"),y=r("dx_cuqV"),m=r("dx_yyXO"),_=r("dx_Xihh");function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var O=Object(p.H)({providers:[{provide:v.RecordSnapshotCreator,useValue:{type:g.B.WIKI_CATALOG,create:y.B}}]})((i=function(e){s()(r,e);var n=k(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).blocks=Object(b.Q)()?[[m.S,{viewCreator:_.R}]]:[],e}return r}(p.y),o=i))||o},dx_E7E0:function(e,n,r){"use strict";r.d(n,"i",(function(){return g}));var o=r("dx_cDcd"),i=r.n(o),c=r("dx_xKBv"),a=r("dx_o0o1"),l=r.n(a),s=r("dx_yXPU"),u=r.n(s),d=r("dx_X0Xo"),f=r("dx_xlCA"),h=new d.S;function p(e,n){return v.apply(this,arguments)}function v(){return(v=u()(l.a.mark((function e(n,r){var o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f.n.instance.hasUserInfo(r)){e.next=5;break}return e.next=3,h.fetch(r);case 3:(o=e.sent)&&f.n.setCache(r,{name:o.userCnName,avatar_url:o.userAvatar,en_name:o.userEnName});case 5:return e.abrupt("return",f.n.getCache(r));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return i.a.createElement(c.S,Object.assign({},e,{tabIndex:-1,fetchUser:p}))}},dx_E7E5:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("g",{fill:"none",fillRule:"evenodd"},i.a.createElement("path",{d:"M8 16A8 8 0 118 0a8 8 0 010 16z",fill:"#EE5050",fillRule:"nonzero"}),i.a.createElement("path",{d:"M7 4l.48 6H8.5L9 4s.277-1-1-1C6.723 3 7 4 7 4z",fill:"#FFF"}),i.a.createElement("circle",{fill:"#FFF",cx:8,cy:12,r:1}));n.S=function(e){return i.a.createElement("svg",c({width:16,height:16,viewBox:"0 0 16 16"},e),a)}},dx_E8EE:function(e,n,r){"use strict";r.d(n,"u",(function(){return d}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_e4eN"),a=r("dx_h6a8"),l=r("dx_bdma");function s(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return u(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function u(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var d=Object(a.throttle)((function(e,n){try{var r=Object(l.S)();if(!r||!n)return void(!r&&Object(l.Q)());var o,a=new c.m({zoneId:"0"}),u=r(e,"latex"),d=0,f=s(u);try{for(f.s();!(o=f.n()).done;){var h=o.value,p=i()(h.range,2),v=p[0],g=p[1];a.retain(v-d).retain(g-v,h.mark),d=g}}catch(b){f.e(b)}finally{f.f()}n.getContentState().apply(a,{type:"highlight",nonundoable:!0})}catch(y){console.warn("EquationEditor onEquationChange occur error:",y)}}),500,{leading:!0,trailing:!0})},dx_EBI6:function(e,n,r){"use strict";function o(e){var n=e.resourceType,r=e.token,o=e.version;return{token:"".concat(n,"_").concat(r),version:o,resourceType:n,routeType:"token",routeKey:r}}r.d(n,"Q",(function(){return o}))},dx_EDso:function(e,n,r){"use strict";r.d(n,"k",(function(){return o})),r.d(n,"x",(function(){return i}));var o="docx-empty-placeholder",i="docx-empty-placeholder-button"},dx_EGHe:function(e,n,r){"use strict";r.d(n,"i",(function(){return x}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_KTtu"),m=r("dx_lROi"),_=r("dx_Dw4b"),k=r("dx_m0BX");function O(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var x=function(e){h()(r,e);var n=O(r);function r(e){var o;return s()(this,r),(o=n.call(this,e)).range=void 0,o.position=void 0,o.type=y.V.PollBlock,o.range=e.range,o.position=e.position,o}return d()(r,[{key:"scrollIntoView",value:function(){var e=a()(i.a.mark((function e(n,r,o,c){var l,s,u,d,f=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=this.blockId,s=this.position,u=r.getRecordByBlockId(l).id,r.hasBlockViewByBlockId(l)){e.next=5;break}return e.next=5,r.layoutManager.renderNodeById(l);case 5:return d=r.getBlockViewByBlockId(l),e.next=8,d.awaitRenderFinished();case 8:return e.abrupt("return",n.scrollToRecord(u,a()(i.a.mark((function e(){var n,o,a,l,u,h,p,v;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n="poll-block-input__".concat(s),o=d.hostElement.querySelector(".".concat(n," .poll-input-fake-textarea"))){e.next=4;break}return e.abrupt("return");case 4:if(a=Object(m.Q)(o.firstChild,f.range,(function(e){console.error(e)}))){e.next=7;break}return e.abrupt("return");case 7:l=a.startTop,u=a.endBottom,h=r.getBlockViewByBlockId(r.getRootBlockId()),p=h.hostElement.getBoundingClientRect(),v=Object(k.F)(r)-p.top,l+=v,u+=v,Object(k.E)({startTop:l,endBottom:u,scrollContainer:c});case 14:case"end":return e.stop()}}),e)})))));case 9:case"end":return e.stop()}}),e,this)})));return function(n,r,o,i){return e.apply(this,arguments)}}()},{key:"isReplaceable",get:function(){return!1}}]),r}(_.S)},dx_EKdI:function(e,n,r){},dx_EOHb:function(e,n,r){},dx_EcrF:function(e,n,r){"use strict";var o=r("dx_bCzq");n.S=o.S},dx_EdHe:function(e,n,r){"use strict";r.d(n,"S",(function(){return _}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_cDcd"),v=r.n(p),g=(r("dx_X5XQ"),r("dx_fNdX")),b=r("dx_KHvq"),y=r("dx_kZ3l");function m(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var _=function(e){s()(r,e);var n=m(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).contentRef=v.a.createRef(),e.handleClickOuterEditor=function(n){Object(g.o)(e.model,e.editor,n)},e}return a()(r,[{key:"handleClickListStyle",value:function(){this.isFocus()||Object(y.u)(this.model)}}]),r}(b.N)},dx_EfDq:function(e,n,r){},dx_Efpq:function(e,n,r){},dx_EhSK:function(e,n,r){"use strict";r.d(n,"K",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("lazy-sync")},dx_EjFk:function(e,n,r){"use strict";(function(t){r.d(n,"J",(function(){return w}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_w86w"),p=r("dx_vDqi"),v=r.n(p),g=r("dx_UtDZ"),b=r("dx_bUYd"),y=r("dx_yzqx"),m=r("dx_ukKW"),_=r("dx_xs2W"),k=r("dx_Bv2G"),O=r("dx_Fimk"),x=r("dx_eSV8"),E=r("dx_A0pQ"),S=r("dx_T7TM"),C=r("dx_g0R0"),I=r("dx_B28d"),B=r("dx_lBTJ"),T=["image/jpeg","image/jpg","image/png","image/gif"],w=function(){function e(n){u()(this,e),this.config=n,this.loadDriveSdkPromise=void 0,this.loadDriveSdkPromise=Object(B.v)()}return f()(e,[{key:"validate",value:function(e){var n=this.config.limitSize||20971520;if(e.size>n){var r=t("CreationDoc_Docs_DocXBlock_MaxImageSize_Toast",{size:n/1024/1024});return Object.assign(new Error(r),{msg:r})}var o=this.config.limitTypes||T;if(!o.includes(e.type)){var i=t("CreationDoc_Docs_DocXBlock_ImageFormat_Toast",{format_list:o.join(", ")});return Object.assign(new Error(i),{msg:i})}return null}},{key:"startDialogUpload",value:function(){var e=l()(c.a.mark((function e(){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.L)({fileTypes:this.config.limitTypes||T});case 2:return n=e.sent,r=n.files,e.abrupt("return",r[0]&&this.uploadImage(r[0]));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getFileByDialog",value:function(){var e=l()(c.a.mark((function e(){var n,r,o,i=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>0&&void 0!==i[0]&&i[0],e.next=3,Object(h.L)({allowMultiple:n,fileTypes:this.config.limitTypes||T});case 3:return r=e.sent,o=r.files,e.abrupt("return",n?o:o[0]);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"downloadImage",value:function(){var e=l()(c.a.mark((function e(n){var r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.a.get(n,{responseType:"blob",withCredentials:!0});case 2:return r=e.sent,o=r.headers.contentType||r.headers["content-type"]||"image/jpeg",e.abrupt("return",new File([r.data],this.getFileNameFromUrl(n,o),{type:o}));case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"getFileNameFromUrl",value:function(e,n){var r=Object(x.I)();if(!Object(m.o)(e)){var o=Object(_.V)(e);if(o&&o.pathname)r=o.pathname.split("/").pop()||r}var i=/\.[a-z0-9]$/i.test(r)?"":{"image/jpeg":".jpg","image/jpg":".jpg","image/png":".png","image/gif":".gif"}[n]||".jpg";return"".concat(r).concat(i)}},{key:"uploadImageToServer",value:function(e,n,r){var o=this,i=function(){return!1};return g.resourceGuard.addCanLeavePageHandler(i),Object(O.N)("upload_file_start",{file_size:e.size,file_type:e.type}),new Promise(function(){var a=l()(c.a.mark((function a(l,s){var u,d,f,h,p,v,m,_;return c.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,o.loadDriveSdkPromise;case 2:return u=c.sent,d=u.SuiteUploader,f=u.UploadStatus,h=u.JobType,p={spaceAPIHosts:Object(E.a)(),driveAPIHosts:Object(E.t)(),nearbyDriveAPIHosts:Object(E.P)(),isOnlineEnv:!S.T,isLocalhost:S.T,source:"CCM",teaConfig:Object(g.getUploaderTeaConfig)()},y.S.isOpendoc&&(p.customRequest=g.request),(v=new d({envConfigs:p})).on("tasks_added",(function(){o.config.beforeUpload&&o.config.beforeUpload(),v.upload()})),v.on("tasks_changed",(function(n){var o=n.list[0];if(o.status===f.Error){if(g.resourceGuard.removeCanLeavePageHandler(i),Object(O.N)("upload_file_end",{file_size:e.size,file_type:e.type,upload_result:"failed"}),(o.errorType===k.g.USER_DRIVE||o.errorType===k.g.USER_NO_DRIVE)&&!y.S.isMobile)return g.showUserLimitDialog&&Object(g.showUserLimitDialog)(k.O.IMAGE),void s(new Error("".concat(o.errorType)));if(o.errorType===k.g.SPACE&&!y.S.isMobile)return g.showPicLimitDialog&&Object(g.showPicLimitDialog)(g.PicLimitType.STORAGE_SPACE,{type:g.StorageSpaceType.UPLOAD_FILE}),void s(new Error("".concat(k.g.SPACE)));"Network Error"===o.errorType?Object(b.v)({content:t("etherpad.upload_failed")}):Object(b.h)({content:t("common.upload_image_failed"),errorContext:Object(C.G)(new Error("suiteUploader upload failed!"))}),s(new Error("upload file to drive error: ".concat(o.errorType)))}else o.status===f.Success?(g.resourceGuard.removeCanLeavePageHandler(i),Object(O.N)("upload_file_end",{file_size:e.size,file_type:e.type,upload_result:"success"}),l(o.token||"")):o.status===f.Inflight&&o.progress&&r&&r(o.progress,v)})),m=new MouseEvent("click"),_=g.store.getState().docx.root,c.next=15,v.loadFiles([e],m,{jobType:h.Upload,parentToken:n||_.pageToken,mountPoint:k.O.IMAGE,bizExtra:{drive_route_token:_.pageToken}});case 15:case"end":return c.stop()}}),a)})));return function(e,n){return a.apply(this,arguments)}}())}},{key:"uploadImage",value:function(n,r,i){var c=this.validate(n);return c?Promise.reject(c):Promise.all([this.uploadImageToServer(n,r,i),e.getImageSize(n)]).then((function(e){var r=o()(e,2),i=r[0],c=r[1];return{src:"",token:i,mimeType:n.type,size:n.size,name:n.name,scale:1,width:c.width,height:c.height,align:I.D.CENTER}}))}}],[{key:"getImageSize",value:function(e){return new Promise((function(n,r){var o=URL.createObjectURL(e),i=new Image;i.onload=function(){URL.revokeObjectURL(o),n({width:i.width,height:i.height})},i.onerror=function(){URL.revokeObjectURL(o);var e=t("CreationDoc_Docs_DocXBlock_Image_Toast");r(Object.assign(new Error(e),{msg:e}))},i.src=o}))}}]),e}()}).call(this,r("dx_E9Eu"))},dx_Elol:function(e,n,r){"use strict";r.d(n,"f",(function(){return l}));var o=r("dx_NOtv"),i=r.n(o),c=r("dx_B28d"),a=i()("getStruct");function l(e,n){try{for(var r=n.getBlockModelByBlockIdNotCheck(e);r&&r.parent;){if(r.type===c.B.OKR)return!0;r=r.parent}}catch(o){a("struct not found")}return!1}},dx_EnrF:function(e,n,r){"use strict";(function(t){r.d(n,"Z",(function(){return y})),r.d(n,"U",(function(){return m})),r.d(n,"V",(function(){return _})),r.d(n,"Ux",(function(){return k})),r.d(n,"VD",(function(){return O})),r.d(n,"S",(function(){return x})),r.d(n,"u",(function(){return E})),r.d(n,"b",(function(){return S})),r.d(n,"Uh",(function(){return C})),r.d(n,"W",(function(){return I})),r.d(n,"m",(function(){return B})),r.d(n,"R",(function(){return T})),r.d(n,"P",(function(){return w}));var e=r("dx_h6a8"),o=r("dx_wy2R"),i=r.n(o),c=r("dx_E1yU"),a=r("dx_furZ"),l=r("dx_bWl7"),s=r("dx_B28d"),u=r("dx_GLPm"),d=r("dx_qx8A"),f=r.n(d),h=r("dx_xI7u"),p=r("dx_tgFd"),v={BEFORE_MONTH:t("history.date.before_month"),BEFORE_YEAR:t("history.date.before_year"),TITLE_DATE:t("space.date_format.same_year")};function g(e){return(e-=h.I)-e%h.A+h.I}function b(e,n){return(e-n)/h.A}function y(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date,r=n.getTime(),o=g(r),c=g(e),a=b(o,c),l={0:t("history.date.sunday"),1:t("history.date.monday"),2:t("history.date.tuesday"),3:t("history.date.wednesday"),4:t("history.date.thursday"),5:t("history.date.friday"),6:t("history.date.saturday")};if(0===a)return t("history.date.today");if(1===a)return t("history.date.yesterday");if(a<=n.getDay()){var s=n.getDay()-a;return l[s]}if(a-7<=n.getDay())return t("history.date.last_week");var u=new Date(e);return n.getFullYear()===u.getFullYear()?n.getMonth()===u.getMonth()?t("history.date.this_month"):i()(e).format(v.BEFORE_MONTH):i()(e).format(v.BEFORE_YEAR)}function m(e){return i()(e).format(v.TITLE_DATE)}function _(n){var r=n.page_info,o={};if(1===n.type&&(o.created=!0),!r)return o;var i=r.title_changes,c=i.origin,a=i.now;a!==c&&(o.rename=a||" ");var l,s=r.cover_changes||{},u=s.origin,d=s.now;return Object(e.isEqual)(u,d)||(o.cover=u?d?p.S.modify:p.S.remove:p.S.add),n.minor_history&&1===n.minor_history.length?l=n.minor_history[0].page_info.revert_info:n.page_info.revert_info&&(l=n.page_info.revert_info),l&&(o.revertTime=m(1e3*l.time)),o}function k(){return Object(c.S)(t("common.network_error"))}function O(e){return e.parentVersion||e.version}function x(e){var n=e.version,r=e.minor_history;return r&&r[0]&&(n=r[0].version),n}function E(e){if(!e)return h.T.FAIL;var n=e.status,r=e.block_status,o=h.T.FAIL;n===h.R.SUCCESSES?o=h.T.SUCCESS:r&&Object.keys(r).some((function(e){return r[e].status===h.R.SUCCESSES}))&&(o=h.T.PARTIAL_SUCCESS);return o}function S(e){return e.name||m(1e3*e.edit_time)}function C(e,n){var r=null;if(e===s.B.MINDMAP)r={mainToken:n,subToken:null};else if(e===s.B.BITABLE){var o=Object(l.U)(n);r={mainToken:o.token||null,subToken:o.id||null}}else if(e===s.B.SHEET){var i=Object(u.U)(n);r={mainToken:i.token||null,subToken:i.id||null}}return r}function I(e,n){return e===s.B.SHEET?C(e,n).mainToken:n}function B(e){return 1e3*e.edit_time}function T(e){var n=e.minor_history;return!(!n||!n[0])}function w(){return Object(a.m)(f.a.getState())}}).call(this,r("dx_E9Eu"))},dx_EqZO:function(e,n,r){"use strict";var o=r("dx_lmGg");r.d(n,"m",(function(){return o.m})),r.d(n,"R",(function(){return o.R})),r.d(n,"j",(function(){return o.j})),r.d(n,"s",(function(){return o.s}));r("dx_GRYU")},dx_EtmZ:function(e,n,r){},dx_EuEb:function(e,n,r){"use strict";r.d(n,"t",(function(){return i}));var o=r("dx_UtDZ");function i(){return Object(o.getMinaConfig)("docx_new_cover_enable",!1)}},dx_Ez6L:function(e,n,r){"use strict";r.d(n,"M",(function(){return o}));var o,i,c=r("dx_lwsE"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_UtDZ"),v=r("dx_lSNA"),g=r.n(v),b=r("dx_o0o1"),y=r.n(b),m=r("dx_yXPU"),_=r.n(m),k=r("dx_W8MJ"),O=r.n(k),x=r("dx_h6a8"),E=r("dx_yzqx"),S=r("dx_xWbU"),C=r("dx_zEdG"),I=r("dx_imty"),B=r("dx_T7TM"),T=r("dx_M7MP"),w=r("dx_WzJv"),R=r("dx_B28d"),M=r("dx_D8nn"),j=r("dx_D5D1"),D=r("dx_rldU"),A=r("dx_vQlG");function P(){var e=Object(p.getSuiteModule)().module;if(String(e)!==String(p.NUM_SUITE_TYPE.WIKI))return"";var n=Object(p.selectCurrentWikiInfo)(p.store.getState());if(!n)return"";var r=Object(x.get)(n,"areaId");return r?Object(p.encryptTea)(r):""}function L(){if(E.S.isMobile||E.S.isLark||E.S.isIPad)return"false";var e=Object(A.v)("catalogue:pin");return"1"===e||null===e?"true":"false"}function N(){if(E.S.isMobile)return"false";var e=Object(A.v)("docCommentShown");return"true"===e||null===e?"true":"false"}function F(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function U(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?F(Object(r),!0).forEach((function(n){g()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function H(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return V(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return V(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function V(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}!function(e){e[e.INIT=-1]="INIT",e[e.FETCH_SUCCESS=0]="FETCH_SUCCESS",e[e.FETCH_FAIL=1]="FETCH_FAIL",e[e.UNLOAD_BEFORE_LOAD=2]="UNLOAD_BEFORE_LOAD"}(o||(o={})),function(e){e.FROM_START="from_start",e.FROM_ANCHOR="from_anchor",e.FROM_LAST_READ_POSITION="from_last_read_position",e.FROM_REMINDER="from_reminder"}(i||(i={}));var W="docx",z=function(){function e(){var n=this;a()(this,e),this.pageProfile=void 0,this.curModule=void 0,this.sended=void 0,this.pageBlockId=void 0,this.cancelSendPageView=void 0,this.stopBind=void 0,this.handleEditorOnMount=Object(j.A)((function(e){if(!n.sended){var r,o=e.blockManager.recordManager.getRecordMap(),c={},a=H(o.values());try{for(a.s();!(r=a.n()).done;){var l=r.value.get([]),s=l.text,u=l.type;switch(u){case D.k.USER:case D.k.MENTION_DOC:Object(x.set)(c,u,Object(x.get)(c,u,0)+1);break;default:if(s){var d=s.apool.numToAttrib;for(var f in d)if(d.hasOwnProperty(f)){var h=d[f];if("inline-component"===h[0]){var p=n.getInlineComponentProps(h[1]);p&&Object(x.set)(c,p.type,Object(x.get)(c,p.type,0)+1)}h[0]===D.k.LINK&&Object(x.set)(c,h[0],Object(x.get)(c,h[0],0)+1),"equation"===h[0]&&Object(x.set)(c,"equation",Object(x.get)(c,"equation",0)+1)}}}}}catch(v){a.e(v)}finally{a.f()}n.updateViewState(Object.keys(c).reduce((function(e,n){return e["inline_".concat(n===D.k.USER?"mention_user":n,"_cnt")]=c[n],e}),{})),n.cancelSendPageView=Object(T.N)((function(){n.waitUntilLastReadPosition().then((function(e){!e||n.pageProfile.read_position&&n.pageProfile.read_position!==i.FROM_START||(n.pageProfile.read_position=i.FROM_LAST_READ_POSITION),n.sendPageView()})).catch((function(){n.sendPageView()}))}))}})),this.onVisibilityChange=function(){if("visible"===document.visibilityState){if(n.setCurModule(Object(p.getSuiteModule)().module),Object(p.suiteType)()!==W)return;n.sendPageEvent("page_visible")}else{if(Object(p.suiteType)()!==W)return;n.sendPageEvent("close_view","page_invisible"),n.setCurModule("")}},window.addEventListener("beforeunload",(function(){Object(p.suiteType)()===W&&(n.sendPageEvent("close_view","page_destroy"),n.destroy())}))}return O()(e,[{key:"start",value:function(){var e=this;if(!this.curModule){this.stopBind=Object(T.N)((function(){document.addEventListener("visibilitychange",e.onVisibilityChange)})),this.setCurModule(Object(p.getSuiteModule)().module);var n=window.location.hash.slice(1)||"",r=p.urlHelper.parseQuery(location.href),c=r.block_id,a=r.reminder_id,l=a&&Array.isArray(a)?a[0]:a,s=c&&Array.isArray(c)?c[0]:c,u=l&&s?i.FROM_REMINDER:n?i.FROM_ANCHOR:i.FROM_START,d=l&&s?s:n;this.pageProfile={env_type:B.p,network_status:Object(p.isOnline)()?"online":"offline",url_from:Object(p.getFromByUrl)(location.href),read_position:u,read_position_data:{block_id:d,block_type:"",sub_block_type:"",reminder_id:l||""},wiki_area_id:P(),drive_sdk_appid:"",is_pin_directory:L(),is_show_part_comment:N(),mode:"",is_full_screen:"false",is_have_cover:"false",is_available_offline:"false",is_follow_update:"false",is_show_quote_list:"false",is_show_editor:"false",clientVar_status:o.INIT,inline_link_cnt:0,inline_mention_user_cnt:0,inline_mention_doc_cnt:0,inline_reminder_cnt:0,inline_equation_cnt:0},this.sended=!1,this.setPageBlockId(""),M.S.on(I.H.PageEditable,this.handleEditorOnMount)}}},{key:"waitUntilLastReadPosition",value:function(){var e=_()(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"setAnchorBlockType",value:function(e){var n=this.pageProfile&&this.pageProfile.read_position_data;if(n&&n.block_id){var r=e.block_map[n.block_id];if(r){var o=r.data;n.block_type=o.type,n.sub_block_type=Object(w.D)({snapshot:o})}}}},{key:"setHasCover",value:function(e){var n=e.block_map;if(n){var r=n[this.pageBlockId];if(r){var o=r.data;this.pageProfile.is_have_cover=o&&o.cover?"true":"false"}}}},{key:"setIsFullWidth",value:function(e){var n=e.block_map;if(n){var r=n[this.pageBlockId];if(r){var o=r.data,i=o&&o.width_mode===S.M.FullWidth;E.S.isFeed&&(i=!0),E.S.isMobile&&(i=!1),this.pageProfile.is_full_width=i}}}},{key:"getInlineComponentProps",value:function(e){var n=null;try{return n=JSON.parse(e)}catch(r){console.log("parse inline component error",r)}return n}},{key:"setPageBlockId",value:function(e){this.pageBlockId=e}},{key:"setCurModule",value:function(e){this.curModule=e}},{key:"setPinCatalogStatus",value:function(e){this.start(),this.updateViewState({is_pin_directory:e&&e.isShowing?"true":"false"})}},{key:"updateViewState",value:function(e){this.pageProfile=Object.assign(this.pageProfile||{},e)}},{key:"applyClientVar",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.sended){if(this.start(),this.pageProfile.clientVar_status=e,e!==o.FETCH_SUCCESS||!n)return this.sendPageView();this.setPageBlockId(n.id),this.setAnchorBlockType(n),this.setHasCover(n),this.setIsFullWidth(n)}}},{key:"sendPageEvent",value:function(e,n){if(this.curModule){var r={click:e};n&&(r.sub_click=n),Object(C.P)("ccm_docs_page_click",{record_id:this.pageBlockId,block_type:R.B.PAGE},r)}}},{key:"sendPageView",value:function(){this.curModule&&(Object(C.T)("ccm_docs_page_view",{record_id:this.pageBlockId,block_type:R.B.PAGE},this.getEncryptPageData()),this.sended=!0)}},{key:"getEncryptPageData",value:function(){if(!this.pageProfile)return{};var e=this.pageProfile.read_position_data;return e&&e.block_id?Object.assign({},this.pageProfile,{read_position_data:U(U({},e),{},{block_id:Object(p.encryptTea)(e.block_id)})}):this.pageProfile}},{key:"destroy",value:function(){this.setPageBlockId(""),this.setCurModule(""),M.S.off(I.H.PageEditable,this.handleEditorOnMount),"function"===typeof this.cancelSendPageView&&this.cancelSendPageView(),"function"===typeof this.stopBind&&this.stopBind(),document.removeEventListener("visibilitychange",this.onVisibilityChange)}}]),e}();function G(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var K=function(e){s()(r,e);var n=G(r);function r(){var e;return a()(this,r),e=n.call(this),p.history.listen((function(n,r){"REPLACE"!==r&&Object(p.suiteType)()===W&&(e.sended||(e.updateViewState({clientVar_status:o.UNLOAD_BEFORE_LOAD}),e.sendPageView()),e.sendPageEvent("close_view","page_spa_switch"),e.destroy())})),e}return r}(z);n.S=new K},dx_EzbQ:function(e,n,r){"use strict";(function(t){var e=r("dx_lSNA"),o=r.n(e),i=r("dx_J4zp"),c=r.n(i),a=r("dx_QILm"),l=r.n(a),s=r("dx_P9Oj"),u=r("dx_D3D2"),d=r("dx_OKGb"),f=r("dx_TSYQ"),h=r.n(f),p=r("dx_h6a8"),v=r("dx_cDcd"),g=r.n(v),b=r("dx_iLNO"),y=r("dx_CqjN"),m=r("dx_cGa6"),_=r("dx_bcuL"),k=r("dx_mopU"),O=r("dx_LcdA"),x=r("dx_N4Vo"),E=r("dx_Bapk"),S=(r("dx_OOTY"),function(e){return"task-block__time-label__".concat(e)}),C=Object(b.J)(s.S),I=Object(b.J)(u.S);n.S=function(e){var n,r,i=e.time,a=e.timezone,s=e.isAllDay,u=e.reminders,f=e.completed,b=e.onRemove,B=void 0===b?p.noop:b,T=e.style,w=e.disabled,R=e.rrule,M=l()(e,["time","timezone","isAllDay","reminders","completed","onRemove","style","disabled","rrule"]),j=Object(_.S)(),D=c()(j,3),A=D[0],P=D[1],L=D[2],N=Boolean(u&&u.length&&u.filter((function(e){return-1!==e.time})).length),F=Object(m.n)()&&!!R,U=f?2:Object(k.v)({time:i,timezone:a,isAllDay:e.isAllDay},A/1e3);Object(v.useEffect)((function(){f||(-1===U?L():P())}),[U]);var H=function(e){var n;null===(n=window.getSelection())||void 0===n||n.removeAllRanges(),e.preventDefault(),e.stopPropagation(),B()},V=Object(y.i)({onClick:function(e){return H(e)}});return g.a.createElement(x.a,Object.assign({},M,{type:"text",className:h()((n={},o()(n,S("wrapper"),!0),o()(n,S("wrapper__disabled"),w),o()(n,"task-block--TimeTabKey",!0),n)),style:T}),g.a.createElement("span",{className:h()((r={},o()(r,S("text"),!0),o()(r,S("text--expired"),-1===U),o()(r,S("text--today"),0===U),o()(r,S("text--completed"),2===U),r))},g.a.createElement(E.M,{title:t("CreationDoc_Tasks_DueTime_TextButton")},g.a.createElement(C,{style:{marginRight:4,cursor:"pointer"},isPresentationMode:e.isPresentationMode})),g.a.createElement("span",{style:{whiteSpace:"break-spaces",marginRight:N||F?4:0}},Object(k.a)({dueTime:i,dueTimezone:a,isAllDay:s})),N?g.a.createElement(E.M,{title:Object(k.Cn)({dueTime:i,dueTimezone:a,isAllDay:s,reminders:u||[]})},g.a.createElement(I,{className:S("time-label-icon"),isPresentationMode:e.isPresentationMode})):null,F?g.a.createElement("span",{className:S("time-label-icon")},g.a.createElement(O.S,{rrule:R})):null),!w&&g.a.createElement(x.a,{tooltipProps:{title:t("CreationDoc_Tasks_Remove_TooltipHover")},type:"icon",size:"extra-small",className:S("icon"),icon:g.a.createElement(d.S,null),onClick:H,onTouchStart:V,onTouchEnd:V,onTouchMove:V}))}}).call(this,r("dx_E9Eu"))},dx_F0F4:function(e,n,r){"use strict";var o,i,c,a;r.d(n,"b4",(function(){return o})),r.d(n,"l",(function(){return i})),r.d(n,"j",(function(){return c})),r.d(n,"b",(function(){return a})),function(e){e[e.Default=6]="Default",e[e.TableCell=13]="TableCell",e[e.Foldable=20]="Foldable",e[e.TableFirstColCell=25]="TableFirstColCell"}(o||(o={})),function(e){e[e.Default=0]="Default",e[e.OKRBlock=-6]="OKRBlock"}(i||(i={})),function(e){e[e.TextualBlockDelta=-2]="TextualBlockDelta",e[e.GridColumnTableDelta=-8]="GridColumnTableDelta",e[e.QuoteContainerDelta=14]="QuoteContainerDelta",e[e.FirstGridColumnDelta=12]="FirstGridColumnDelta",e[e.OKRProgressDelta=12]="OKRProgressDelta"}(c||(c={})),function(e){e.FirstGridColumn="first-grid-column",e.NormalGridColumn="normal-grid-column",e.None=""}(a||(a={}))},dx_F0FY:function(e,n,r){"use strict";r.d(n,"q",(function(){return d})),r.d(n,"e",(function(){return h})),r.d(n,"B",(function(){return p}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_h6a8"),a=r("dx_b28D"),l=r("dx_TwmW"),s=r("dx_r4RQ"),u="true"===localStorage.getItem("isPDFDebug"),d=Object(a.e)(s.A);d.enabled=!0;var f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.s,n=i()(s.m).map((function(n){return"".concat(e," ").concat(s.E," ").concat(n)}));return n.join(",")},h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.head,n=arguments.length>1?arguments[1]:void 0,r=f(n);if(r){var o=document.createElement("style"),i="".concat(r," {\n    page-break-inside: avoid;\n    page-break-before: auto;\n    page-break-after: auto;\n  }");o.textContent=i,e.appendChild(o)}},p=function(){if(!Object(l.h)())return 1;document.querySelectorAll(".list").forEach((function(e){var n=e.getBoundingClientRect();e.style.height="".concat(n.height,"px")})),console.time("".concat(s.A," calcAddOffset time"));var e=window.document.querySelector(".shortcut-page-container.pdf"),n=Math.max(e.offsetWidth,s.o*s.M),r=s.t/s.o*n;d("pageHeight",s.M,r);var o=0,i=f(),a=window.document.querySelectorAll(i);d("calcAddOffset sort start length",a.length);var h=Object(c.sortBy)(a,(function(e){return e.getBoundingClientRect().top}));d("calcAddOffset sort end"),h.forEach((function(e,n){var i=e.getBoundingClientRect(),c=i.top+o,a=Math.ceil(c/r),l=a*r,s=l-c;if(!(i.height>r)){e.classList.add("pdf-avoid-break");var f=window.getComputedStyle(e),p=parseFloat(f.marginBottom)||0,v=parseFloat(f.marginTop)||0,g=i.bottom+o-l,b=c-(a-1)*r;if(g>0)o+=s,u&&(e.style.backgroundColor="red",d("height",s));else if(v>0&&b<=v)o-=b;else if(g+p>0&&n<h.length-1){var y=e.nextElementSibling&&window.getComputedStyle(e.nextElementSibling),m=parseFloat((null===y||void 0===y?void 0:y.marginTop)||"0")||0;o-=Math.max(p,m)+g}}})),d("calcAddOffset whiteOffset",o);var p=document.querySelector(".page-block .root-render-unit-container>.render-unit-wrapper");o>0&&p&&(p.style.minHeight="".concat(o+p.offsetHeight,"px"),u&&(p.style.borderBottom="1px solid #ccc"),d("minHeight",p.style.minHeight));var v=(null===p||void 0===p?void 0:p.getBoundingClientRect().bottom)||r;return v<r&&(e.style.minHeight="".concat(v,"px")),console.timeEnd("".concat(s.A," calcAddOffset time")),Math.ceil(e.offsetHeight/r)}},dx_F0qy:function(e,n,r){"use strict";r.d(n,"t",(function(){return C}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_UG67"),m=r("dx_K7ih"),_=r("dx_B28d"),k=r("dx_bPy9"),O=r("dx_z0z2"),x=r("dx_ONjz"),E=r("dx_bdma");function S(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var C=function(e){h()(r,e);var n=S(r);function r(e){var o;return s()(this,r),(o=n.call(this,e)).blockManager=void 0,o.blockId=void 0,o.blockManager=e.blockManager,o.blockId=e.blockId,o}return d()(r,[{key:"isCodeBlockZoneState",value:function(e){var n=e.getZoneId(),r=this.blockManager.getBlockModelByBlockId(Object(k.j)(n));return r&&r.type===_.B.CODE}},{key:"getLanguage",value:function(e){var n=e.getZoneId();return this.blockManager.getBlockModelByBlockId(Object(k.j)(n)).language}},{key:"diffContentChanges",value:function(e){var n=e.previous,r=e.current,o=Object(k.v)(this.blockId),i=r.getZoneState(o),c=n.getZoneState(o);return i&&this.isCodeBlockZoneState(i)&&(null===c||void 0===c?void 0:c.getModelText())!==i.getModelText()?{highlightZones:[{zoneId:o,async:i.getModelText().length<5e3}],identifyZoneIds:[]}:{highlightZones:[],identifyZoneIds:[]}}},{key:"highlightBlockWithRIC",value:function(e){var n=Object(k.v)(e);this.highlightZoneWithRIC(n)}},{key:"highlightBlock",value:function(e){var n=Object(k.v)(e);this.highlightZone(n)}},{key:"identifyCodeLanguage",value:function(){var e=a()(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.identifyLanguage(Object(k.v)(n)));case 1:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"highlight",get:function(){return Object(E.S)()}},{key:"codeWorkerManager",get:function(){return m.S.getInstance()}},{key:"languageMap",get:function(){return x.V}},{key:"sortedLanguageList",get:function(){return x.l}},{key:"defaultLanguage",get:function(){return O.E}}]),r}(y.j)},dx_F2FW:function(e,n,r){},dx_F5F0:function(e,n,r){"use strict";(function(t){r.d(n,"C",(function(){return C}));var e=r("dx_RIqP"),o=r.n(e),i=r("dx_lwsE"),c=r.n(i),a=r("dx_W8MJ"),l=r.n(a),s=r("dx_iWIM"),u=r.n(s),d=r("dx_W7W2"),f=r.n(d),h=r("dx_a1gu"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=r("dx_QxNg"),y=r("dx_UtDZ"),m=r("dx_B28d"),_=r("dx_NMQJ"),k=r("dx_x1WV"),O=r("dx_xlMp"),x=r("dx_lROi"),E=r("dx_cuqV");function S(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}var C=function(e){f()(r,e);var n=S(r);function r(){var e;c()(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(e=n.call.apply(n,[this].concat(i))).isFromLocal=!1,e.matches=[],e.prevKeyword=void 0,e.prevDataUuid=void 0,e}return l()(r,[{key:"getSearchTargetWord",value:function(e,n){switch(e){case O.o.TITLE:return n.title.length?n.title:Object(y.getWikiCatalogFunctions)().suiteType2UnnamedTitle[n.objType];case O.o.AUTHOR:return Object(E.Z)(n);default:throw new Error("Invalid matchType is provided")}}},{key:"find",value:function(e){var n=this,r=[O.o.TITLE,O.o.AUTHOR],i=this.blockManager.getBlockViewByBlockId(this.id);if(!i)return[];var c=i.recentListDataUuid;if(!c||!i.recentListData)return[];if(!this.matches||this.prevKeyword!==e||this.prevDataUuid!==c){var a=[];i.recentListData.forEach((function(o,i){r.forEach((function(r){Object(x.A)(n.getSearchTargetWord(r,o),e).forEach((function(o){var c=o.start,l=o.end;a.push(new O.e({index:i,blockMatchType:r,blockManager:n.blockManager,blockId:n.id,key:e,range:[c,l]}))}))}))})),this.matches=a,this.prevKeyword=e,this.prevDataUuid=c}return o()(this.matches)}},{key:"getText",value:function(){return"[".concat(t("CreationDoc_Wiki_UpdatesBlock_InsertBlock"),"]")}},{key:"onInit",value:function(e){this.isFromLocal=e.options.from===b.H.local,u()(g()(r.prototype),"onInit",this).call(this,e)}},{key:"blockManager",get:function(){return this.editorAPI.getService(k.a)}}]),r}(_.D);C.type=m.B.WIKI_RECENT}).call(this,r("dx_E9Eu"))},dx_F5FD:function(e,n,r){},dx_F5s4:function(e,n,r){"use strict";r.d(n,"U",(function(){return b}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_UtDZ"),d=r("dx_Fimk"),f=r("dx_QRvo"),h=r("dx_K2Kl");function p(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function v(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?p(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var g=function(){function e(){a()(this,e),this.displayParams={decrypt_necessary:!1,request_cdn_necessary:!1},this.timer=new h.S}return s()(e,[{key:"collectDisplayEvent",value:function(e){Object.assign(this.displayParams,e)}},{key:"uploadDisplayEvent",value:function(){Object(d.N)("display_new_gallery",this.displayParams)}},{key:"logDisplayBase",value:function(e){this.collectDisplayEvent(v(v({},e),{},{image_category:"Drive",retryTimes:0}))}},{key:"logRetry",value:function(){this.collectDisplayEvent({retryTimes:(this.displayParams.retryTimes||0)+1})}},{key:"logDisplayImageStart",value:function(){this.timer.start("displayImage")}},{key:"logCdnFetchStatus",value:function(e){this.collectDisplayEvent(e)}},{key:"logLoadImageStart",value:function(){this.timer.start("loadImage")}},{key:"logLoadImageEnd",value:function(){var e=this.timer.end("loadImage");this.collectDisplayEvent({load_time_cost:e})}},{key:"logDisplayImageEnd",value:function(e){var n=this.timer.end("displayImage");this.collectDisplayEvent({display_time_cost:n,load_fail:e.load_fail,token:Object(u.encryptTea)(e.token),origin_src:Object(u.encryptTea)(e.origin_src)}),this.uploadDisplayEvent()}},{key:"logPlayBigGif",value:function(e,n){Object(d.N)("play_big_gif",{file_token:Object(u.encryptTea)(e),page_token:Object(u.encryptTea)(n)})}},{key:"logSaveExternalImage",value:function(e,n,r,o){Object(d.N)("external_save_status",{file_token:Object(u.encryptTea)(e),page_token:Object(u.encryptTea)(n),time_cost:Math.round(performance.now()-o),status:r?"success":"fail"})}},{key:"logUploadImageStart",value:function(e,n,r,o){Object(d.N)("new_image_upload_start",{uuid:Object(u.encryptTea)(e),file_size:n,mime_type:r,source:o})}},{key:"logUploadImageEnd",value:function(e){var n=e.blockId,r=e.size,o=e.type,i=e.source,c=e.fileToken,a=e.isSuccess,l=e.startTime,s=e.errorMsg,h={uuid:Object(u.encryptTea)(n),file_token:c?Object(u.encryptTea)(c):null,file_size:null===r||void 0===r?void 0:r.toString(),mime_type:o,source:i,upload_status:a?f.q.Success:f.q.Fail,cost_time:performance.now()-l};a||(h.upload_error_msg=JSON.stringify(s)),Object(d.N)("new_image_upload_end",h)}},{key:"destroy",value:function(){this.displayParams={},this.timer.clear()}},{key:"collectedInfo",get:function(){return v({},this.displayParams)}}]),e}(),b=function(){function e(){a()(this,e),this.collectorMap=new Map}return s()(e,[{key:"get",value:function(e){var n=this.collectorMap.get(e);return!n&&(n=new g,this.collectorMap.set(e,n)),n}},{key:"delete",value:function(e){var n=this.collectorMap.get(e);this.collectorMap.delete(e),n&&n.destroy()}},{key:"destroy",value:function(){this.collectorMap.forEach((function(e){return e.destroy()}))}}]),e}();new b},dx_F81q:function(e,n,r){"use strict";r.d(n,"L",(function(){return a})),r.d(n,"J",(function(){return l})),r.d(n,"T",(function(){return s})),r.d(n,"r",(function(){return u}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_B28d"),a="fade-in",l="fade-out",s=[].concat(i()(c.O),i()(c.BM),i()(c.hd),[c.B.TASK]),u=s.reduce((function(e,n){return e[n]=!0,e}),{})},dx_FA1D:function(e,n,r){"use strict";r.d(n,"f",(function(){return l})),r.d(n,"E",(function(){return s})),r.d(n,"J",(function(){return u})),r.d(n,"B",(function(){return d})),r.d(n,"G",(function(){return f})),r.d(n,"w",(function(){return p})),r.d(n,"t",(function(){return v}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c);r("dx_RIqP"),r("dx_B28d");function l(e){return JSON.parse(JSON.stringify(e))}function s(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,r=window;r.requestIdleCallback?r.requestIdleCallback(e,{timeout:n}):window.setTimeout(e,n)}function u(e,n,r){e&&(r?e.setAttribute(n,"true"):e.removeAttribute(n))}function d(e,n){return"function"===typeof e.get?e.get(n):e[n]}function f(e){return["Control","Alt","Meta","Shift","Escape","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e)}function h(e,n,r){var o=e-r.x,i=n-r.y;return Math.round(o*o+i*i)}function p(e,n){if(!e)return{x:0,y:0,width:0,height:0};var r=e.x,o=e.y,i=[];n.forEach((function(e){for(var n=e.getClientRects(),r=0;r<n.length;r+=1)i.push(n[r])}));var c=function(e){for(var n=[],r=0;r<e.length;r+=1){var o=l(e[r]);if(0===n.length)n.push(o);else{for(var i=!1,c=0;c<n.length;c+=1){var a=n[c];Math.abs(o.top-a.top)<=4&&(i=!0,a.width+=o.width,a.left=a.left<o.left?a.left:o.left)}i||n.push(o)}}return n}(i);if(1===c.length)return c[0];for(var a=h(r,o,c[0]),s=0,u=1;u<c.length;u+=1){var d=h(r,o,c[u]);d<a&&(a=d,s=u)}return c[s]}var v=function(){function e(n){i()(this,e),this.max=void 0,this.running=void 0,this.taskQueue=void 0,this.max=n,this.running=0,this.taskQueue=[]}return a()(e,[{key:"clear",value:function(){this.max=0,this.taskQueue=[]}},{key:"addTask",value:function(e){this.taskQueue.push(e),this.runTask()}},{key:"runTask",value:function(){var e=this,n=this.max,r=this.running,o=this.taskQueue;if(o.length&&r<n){var i=o.shift();"function"===typeof i&&(this.running++,i().then((function(){e.running--,e.runTask()})))}}}]),e}()},dx_FBn3:function(e,n,r){"use strict";var o,i,c=r("dx_lwsE"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_B28d"),g=r("dx_N9dL"),b=r("dx_w0wU"),y=r("dx_V6VR"),m=r("dx_lmzW");function _(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var k=Object(p.H)({providers:[{provide:g.RecordSnapshotCreator,useValue:{type:v.B.DIVIDER,create:b.s}}]})((i=function(e){s()(r,e);var n=_(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).blocks=[[y.J,{viewCreator:m.S}]],e}return r}(p.y),o=i))||o,O=k;n.S=O},dx_FDiX:function(e,n,r){"use strict";r.d(n,"Y",(function(){return i})),r.d(n,"J",(function(){return c}));var o=r("dx_Bs5u");function i(e){return e?e[o.A.add]?o.A.add:e[o.A.del]?o.A.del:e[o.A.change]?o.A.change:null:null}function c(e,n,r){if(!e||!n)return null;if(n.hasOwnProperty("type"))return null;var o=null;for(var i in n)if(Object.prototype.hasOwnProperty.call(n,i)){var c=n[i];if(null!==c&&void 0!==c){if(-1===r.indexOf(i))return null;o=i}}return o}},dx_FFTT:function(e,n,r){"use strict";r.d(n,"G",(function(){return i})),r.d(n,"V",(function(){return c})),r.d(n,"U",(function(){return a})),r.d(n,"P",(function(){return l})),r.d(n,"B",(function(){return s})),r.d(n,"n",(function(){return u}));var o=r("dx_yNB7"),i="link",c="".concat(o.l,"localLink"),a="link-id",l="unlink",s="link-selection",u="link-selection-token-"},dx_FGmI:function(e,n,r){},dx_FH1m:function(e,n,r){"use strict";(function(t){r.d(n,"q",(function(){return v}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_J4zp"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_YzVl"),u=r("dx_MoY1"),d=r("dx_B28d"),f=r("dx_ZG9w"),h=r("dx_zghO"),p=r("dx_ppc6"),v=function(){var e=l()(o.a.mark((function e(n,r,i,a,l){var v,g,b,y,m,_,k,O,x,E,S=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v=!(S.length>5&&void 0!==S[5])||S[5],g=r.record.id,y=n.getBlockModelByBlockId(r.id),m=y.parent,_=y.position,k=r.model.zoneState,n.editorAPI.getService(p.S).setSelection([{type:h.j.TEXT,id:r.id,selection:{start:i[1],end:i[1]}}]),e.next=10,n.applyTransaction("insertBlockAtRange",(function(e){if(m){var o=d.o.includes(a.type),l=a.type===d.B.TASK,f=0===i[0],h=i[1]===k.getModelText().length-1;if(f&&h){e.removeChildren(m.record.id,[g]);var p=Object(u.l)(e,m.record.id,_,[a]),v=c()(p,1);if(b=v[0],g=b,!o&&!l)if(y.nextSibling)g=y.nextSibling.record.id;else{var O=Object(u.T)(e,m.record.id,_+1,[n.createInitModel(r.type)]),x=c()(O,1);g=x[0]}if(!o){var E=m.record.id,S=r.model.position;r.model.children.length>0&&Object(u.t)(e,E,S+1,r.model.children.map((function(e){return e.recordId})))}}else{var C=r.model.zoneState.remove(i).toAttributeText();e.replace(g,["text"],C);var I=Object(u.l)(e,m.record.id,_+1,[a]),B=c()(I,1);if(b=B[0],g=b,!o&&!l)if(y.nextSibling)g=y.nextSibling.record.id;else{var T=Object(u.l)(e,m.record.id,_+2,[n.createInitModel(d.B.TEXT)]),w=c()(T,1);g=w[0]}}}else Object(s.F)({type:"error",content:t("toolbox.insert_fail"),dom:r.hostElement})}),{afterTransactionAccepted:l});case 10:return O=n.getBlockIdsByRecordId(g)[0],x=n.getBlockViewByBlockId(O),v&&Object(f.U)(x)?x.model.setSelection({start:0,len:0},!0):x.selectionAPI.restoreFocus(),E=b?n.getBlockIdsByRecordId(b)[0]:O,e.abrupt("return",E);case 15:case"end":return e.stop()}}),e)})));return function(n,r,o,i,c){return e.apply(this,arguments)}}()}).call(this,r("dx_E9Eu"))},dx_FHaN:function(e,n,r){"use strict";r.d(n,"O",(function(){return a})),r.d(n,"Y",(function(){return l})),r.d(n,"k",(function(){return o})),r.d(n,"J",(function(){return i})),r.d(n,"n",(function(){return c})),r.d(n,"L",(function(){return s}));var o,i,c,a="inline-component",l="at-user-embed-container";!function(e){e.USER="user",e.REMINDER="reminder",e.DOC="mention_doc",e.FILE="file"}(o||(o={})),function(e){e[e.READABLE=1]="READABLE",e[e.UNREADABLE_ALLOW_APPLY=2]="UNREADABLE_ALLOW_APPLY",e[e.UNREADABLE_NOT_ALLOW_APPLY=3]="UNREADABLE_NOT_ALLOW_APPLY",e[e.NETWORK_ERROR=4]="NETWORK_ERROR",e[e.LOADING=5]="LOADING"}(i||(i={})),function(e){e[e.ALLOW=0]="ALLOW",e[e.NO_PERMISSION=1]="NO_PERMISSION",e[e.NETWORK_ERROR=2]="NETWORK_ERROR"}(c||(c={}));var s=500},dx_FJK0:function(e,n){},dx_FNDK:function(e,n,r){"use strict";r.d(n,"y",(function(){return b})),r.d(n,"hS",(function(){return m})),r.d(n,"E",(function(){return _})),r.d(n,"m",(function(){return k})),r.d(n,"p",(function(){return O})),r.d(n,"e",(function(){return x})),r.d(n,"L",(function(){return E})),r.d(n,"X",(function(){return S})),r.d(n,"Z",(function(){return C})),r.d(n,"K",(function(){return I})),r.d(n,"N",(function(){return B})),r.d(n,"P",(function(){return T})),r.d(n,"i",(function(){return w})),r.d(n,"E4",(function(){return M})),r.d(n,"hy",(function(){return j})),r.d(n,"Y",(function(){return D})),r.d(n,"C",(function(){return A})),r.d(n,"F",(function(){return P})),r.d(n,"h",(function(){return L}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_RIqP"),a=r.n(c),l=r("dx_uZlF"),s=r("dx_h6a8"),u=r("dx_yzqx"),d=r("dx_eSV8"),f=r("dx_B28d"),h=r("dx_kZ3l"),p=r("dx_P58d");function v(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function g(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?v(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function b(e,n,r){var o=[];return n.forEach((function(n){o.push.apply(o,a()(y(e,n,r)))})),o}function y(e,n,r){var o=e.getBlockModelByBlockId(n);if(!r.includes(o.type))return[n];var i=[];return e.getBlockModelByBlockId(n).children.forEach((function(n){i.push.apply(i,a()(y(e,n.id,r)))})),i}function m(e,n){var r=[],o=new Set;return n.forEach((function(n){var i,c=e.getBlockModelByBlockIdNotCheck(n.id);(null===c||void 0===c?void 0:c.type)===f.B.CELL?(null===(i=c.parent)||void 0===i?void 0:i.type)!==f.B.TABLE||o.has(c.parent.id)||(o.add(c.parent.id),r.push({id:c.parent.id,type:p.j.BLOCK})):r.push(n)})),o.size>0&&Object(d.n)("TextSelectionAcrossBlocks includes cell block"),r}function _(e){return e.map((function(e){return{id:e,type:p.j.BLOCK}}))}function k(e){return 1===e.length&&e[0].type===p.j.TEXT}function O(e,n){if(!k(e)||!e[0].selection)return!1;var r=n.getBlockModelByBlockId(e[0].id).getText().length-1,o=e[0].selection,i=o.start;return o.end-i===r}function x(e){return e.length>0&&e.every((function(e){return e.type===p.j.BLOCK}))}function E(e){return e.length>1&&e.some((function(e){return e.type===p.j.TEXT}))}function S(e){return E(e)&&e.some((function(e){return e.type===p.j.BLOCK}))}function C(e){if(1===e.length){var n=e[0],r=n.type,o=n.selection;if(r===p.j.TEXT&&o&&void 0!==o.start&&o.start===o.end)return!0}return!1}function I(e,n){var r=e.anchorNode,o=e.focusNode;if(!r||!o||e.rangeCount<=n)return null;var i=null;if(u.S.safari)try{i=e.getRangeAt(n)}catch(c){i=null}else e.getRangeAt&&(i=e.getRangeAt(n));return i||((i=document.createRange()).setStart(e.anchorNode,e.anchorOffset),i.setEnd(e.focusNode,e.focusOffset)),i}function B(e,n){return e.startContainer===n.startContainer&&e.endContainer===n.endContainer&&e.startOffset===n.startOffset&&e.endOffset===n.endOffset}function T(e,n){return!!n&&(e.anchorNode!==n.startContainer||e.focusNode!==n.endContainer||e.anchorOffset!==n.startOffset||e.focusOffset!==n.endOffset)}function w(e,n,r){var o=n.selection,i=e.view.getBlockViewByBlockId(n.id);if(!i||!o)return null;var c=o.start,a=o.end,s=i.model.zoneState,u=s.offsetToPoint(c),d=s.offsetToPoint(a);return new l.A({editor:i.editor,start:g({},u),end:g({},d),isBackward:r,state:s})}function R(e){var n;return e.type===p.j.TEXT&&0===(null===(n=e.selection)||void 0===n?void 0:n.start)&&0===e.selection.end}function M(e){if(e.length<1)return!1;if(x(e))return!1;var n=e;return n.length>1&&R(n[0])&&(n=n.slice(1)),n.length>1&&R(n[n.length-1])&&(n=n.slice(0,-1)),n.length>0&&x(n)}function j(e,n,r){var o=w(n,e,!r.forward);return o&&Boolean(h.C(o))&&(null===o||void 0===o?void 0:o.isCollapsed())}function D(e,n,r){var o=w(n,e,!r.forward);return o&&Boolean(h.X(o))&&(null===o||void 0===o?void 0:o.isCollapsed())}function A(e,n,r){var o=w(n,e,!r.forward);return o&&Boolean(h.X(o))}function P(e,n,r){var o=w(n,e,!r.forward);return o&&Boolean(h.C(o))}function L(e,n){if(!e.length)return[];if(!n.length)return e;var r=new Map;n.forEach((function(e){r.set(e.id,e)}));for(var o=0,i=e.length-1,c=!1,a=!1,l=[],u=[];o<=i;){var d=e[o];r.has(d.id)?Object(s.isEqual)(r.get(d.id),d)?c=!0:l.push(d):(l.push(d),r.set(d.id,d)),c||o++;var f=e[i];if(d===f)break;if(r.has(f.id)&&Object(s.isEqual)(r.get(f.id),f)?a=!0:u.unshift(f),a||i--,c&&a)break}return l.concat(u)}},dx_FP3m:function(e,n,r){"use strict";var o=r("dx_W23W");r.d(n,"z",(function(){return o.z}))},dx_FT4e:function(e,n,r){"use strict";(function(t,e){r.d(n,"N",(function(){return se}));var o,i,c,a,l=r("dx_o0o1"),s=r.n(l),u=r("dx_yXPU"),d=r.n(u),f=r("dx_lSNA"),h=r.n(f),p=r("dx_J4zp"),v=r.n(p),g=r("dx_yG8O"),b=r.n(g),y=r("dx_lwsE"),m=r.n(y),_=r("dx_W8MJ"),k=r.n(_),O=r("dx_PJYZ"),x=r.n(O),E=r("dx_iWIM"),S=r.n(E),C=r("dx_W7W2"),I=r.n(C),B=r("dx_a1gu"),T=r.n(B),w=r("dx_Nsbk"),R=r.n(w),M=r("dx_Uyc2"),j=r.n(M),D=(r("dx_A1AB"),r("dx_LcNA")),A=r("dx_D38a"),P=r("dx_uZlF"),L=r("dx_Icqc"),N=r("dx_TSYQ"),F=r.n(N),U=r("dx_h6a8"),H=r("dx_cDcd"),V=r.n(H),W=r("dx_SreQ"),z=r("dx_c0wU"),G=r("dx_B28d"),K=r("dx_MGoZ"),q=r("dx_Nn5p"),X=r("dx_zghO"),Y=r("dx_upU1"),J=r("dx_D8nn"),Z=r("dx_ey54"),Q=r("dx_k8kI"),$=r("dx_qx8A"),ee=r.n($),te=r("dx_bvq6"),ne=r("dx_pk3x"),re=r("dx_D2m8"),oe=r("dx_U67U");r("dx_YxRU"),r("dx_pcp3"),r("dx_je71");function ie(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function ce(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ie(Object(r),!0).forEach((function(n){h()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ie(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ae(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=R()(e);if(n){var i=R()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return T()(this,r)}}var le=[""],se=(a=function(n){I()(o,n);var r=ae(o);function o(){var e;m()(this,o);for(var n=arguments.length,a=new Array(n),l=0;l<n;l++)a[l]=arguments[l];return e=r.call.apply(r,[this].concat(a)),b()(e,"editor",i,x()(e)),b()(e,"contentState",c,x()(e)),e.isTextBlock=!0,e.slashPlaceHolder=t("CreationDoc_DocX_MainView_SlashCommand_TypeToSearch_field"),e.smartCorrectionPlugin=void 0,e.unSubscribeThemeChange=void 0,e.customEditorProps={},e.plugins=void 0,e.debounceOnResize=Object(U.debounce)((function(){var n,r=e.editor.getRect(),o=null===(n=e.model.zoneState.getContainer())||void 0===n?void 0:n.getBoundingClientRect();if(o)for(var i=0,c=Object.entries(o.toJSON());i<c.length;i++){var a=v()(c[i],2),l=a[0],s=a[1];if(r[l]!==s){e.editor.setRect(),e.editor.call(D.L.RECT_CHANGE,{previous:r,current:o});break}}}),100),e.onResize=function(n){n&&n.preEditorWidth===n.editorWidth||!e.blockManager.layoutManager.isBlockActive(e.id)||e.debounceOnResize()},e.register=function(){if(e.plugins)return e.plugins;var n=x()(e).editor,r=e.props.options;if(!Array.isArray(r))return e.plugins=[],e.plugins;var o={editor:n,blockManager:e.blockManager,selectionAPI:e.selectionAPI,scroller:e.boundary,recursionProps:e.props.recursionProps},i=r.concat(e.getDefaultEditorPluginOptions()).map((function(r){var i=v()(r.main,2),c=i[0],a=i[1];try{if(c===te.O){var l=n.pluginManager.getPlugin(te.O.KEY);return e.smartCorrectionPlugin=l||Object(oe.z)(n,x()(e)),e.model.isCreatedByPaste&&e.smartCorrectionPlugin.checkAll(e.model.zoneId),e.smartCorrectionPlugin}return[c,ce(ce({},a),o)]}catch(s){return console.error("text block register occur error:",s),r.main}})).filter((function(e){return null!==e}));return e.plugins=i,e.plugins},e.handleEnterBuffer=function(){var n,r,o=x()(e).selectionAPI;o.getIsCurrentTextSelection(e.id)&&o.isFocusInHiddenInputDom()&&e.focus(),null===(n=(r=e.props).onTextualBlockUpdate)||void 0===n||n.call(r)},e.handleMouseOver=function(){e.translatedStatus&&e.model.enableTranslate&&J.S.emit(J.p.TRANSLATE.TRANSLATE_MOUSE_OVER,x()(e),e.model.zoneState.getContainer())},e.handleMouseLeave=function(){J.S.emit(J.p.TRANSLATE.TRANSLATE_MOUSE_LEAVE,x()(e),e.model.zoneState.getContainer())},e.handleThemeChange=function(n){var r,o=n.mode;null===(r=e.smartCorrectionPlugin)||void 0===r||r.setTheme(o.toUpperCase()===L.ThemeType.DARK?"dark":"light")},e}return k()(o,[{key:"focus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.editor.selection.focus(this.model.zoneId,e,n)}},{key:"isFocus",value:function(){return this.editor.isFocus(this.model.zoneId)}},{key:"setBlockFocus",value:function(e){e?(this.hostElement&&this.hostElement.classList.add("focused"),Object(W.P)()&&this.editor.isEditable()&&this.editor.call(D.L.FOCUS)):(this.hostElement&&this.hostElement.classList.remove("focused"),Object(W.P)()&&this.editor.call(D.L.BLUR))}},{key:"setBlockEmptyClass",value:function(){this.model.isEmpty?this.hostElement&&this.hostElement.classList.add("isEmpty"):this.hostElement&&this.hostElement.classList.remove("isEmpty")}},{key:"replaceTextAndUpdateSelection",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i,c,a=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r||(r={text:""}),e.next=3,this.model.replaceText(n,r);case 3:i=this.model.zoneState.pointToOffset(n.start)||0,c=void 0!==o?o:i+r.text.length,setTimeout((function(){a.model.setSelection({start:c,len:0},!0)}));case 6:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"getDefaultEditorPluginOptions",value:function(){return ne.v}},{key:"onEditorInit",value:function(){var e,n,r=this.editor,o=this.model;r.clipboard.setCanInternalPasteWhitelist(le),null===(e=o.zoneState.getContainer())||void 0===e||e.addEventListener("mouseover",this.handleMouseOver),null===(n=o.zoneState.getContainer())||void 0===n||n.addEventListener("mouseleave",this.handleMouseLeave),this.blockManager.addListener(Q.r,this.handleEnterBuffer,this.id)}},{key:"removeCurrentSelection",value:function(){var e,n=this.model.getSelection();n&&this.model.setSelection(ce(ce({},n),{},{isActive:!1})),null===(e=this.model.zoneState.getContainer())||void 0===e||e.blur()}},{key:"getTextEditorSelection",value:function(){var e=this.editor,n=this.selectionAPI.getSelectedBlockIfInSelection(this.id),r=this.model.getSelection();if(n&&n.type===X.j.TEXT&&r)return r;var o=this.model.zoneState,i=o.getLine(o.length()-1).length()-1;return new P.A({editor:e,start:{zoneId:this.model.zoneId,line:0,offset:0},end:{zoneId:this.model.zoneId,line:o.length()-1,offset:i},state:o})}},{key:"blockViewDidMount",value:function(){S()(R()(o.prototype),"blockViewDidMount",this).call(this),this.blockManager.addListener(Z.G,this.onResize),this.unSubscribeThemeChange=Object(L.onUIStateChange)(this.handleThemeChange),this.setBlockEmptyClass(),this.onEditorInit()}},{key:"blockViewDidUpdate",value:function(e,n){S()(R()(o.prototype),"blockViewDidUpdate",this).call(this,e,n),this.setBlockEmptyClass()}},{key:"blockViewWillUnmount",value:function(){var e,n,r,i;this.unSubscribeThemeChange&&this.unSubscribeThemeChange(),this.blockManager.removeListener(Z.G,this.onResize),null===(e=this.model.zoneState)||void 0===e||null===(n=e.getContainer())||void 0===n||n.removeEventListener("mouseover",this.handleMouseOver),null===(r=this.model.zoneState)||void 0===r||null===(i=r.getContainer())||void 0===i||i.removeEventListener("mouseleave",this.handleMouseLeave),this.blockManager.removeListener(Q.r,this.handleEnterBuffer,this.id),S()(R()(o.prototype),"blockViewWillUnmount",this).call(this)}},{key:"addCommentHighlight",value:function(e){this.editor&&Object(Y.I)(this,e)}},{key:"removeCommentHighlight",value:function(e,n){this.editor&&Object(Y.I)(this,e,!0,n)}},{key:"setCustomEditorProps",value:function(e){this.customEditorProps=e}},{key:"render",value:function(){var n={};n.textAlign=this.snapshot.align,e.env.NODEJS;var r=!this.model.zoneState.isEmpty(),o=F()("text-editor",{"hide-placeholder":[G.D.CENTER,G.D.RIGHT].includes(this.snapshot.align)||!this.editable,"non-empty":r});return V.a.createElement(re.X.Provider,{value:this.props.recursionProps},this.renderZoneView({className:o,style:n}))}},{key:"renderZoneView",value:function(e){return V.a.createElement(A.Y,Object.assign({zoneId:this.model.zoneId,editor:this.editor,editable:this.editable,className:e.className,placeholder:this.placeholder,style:e.style,register:this.register},this.customEditorProps))}},{key:"placeholder",get:function(){return""}},{key:"mentionPlaceHolder",get:function(){return Object(z.K)(this.id,this.blockManager)?t("CreationDoc_DocX_MainView_Mention_callout_field"):t("CreationDoc_DocX_MainView_Mention_TypeToMention_field")}},{key:"isTextEditable",get:function(){return this.editable}},{key:"translatedStatus",get:function(){return ee.a.getState().appState.translate.status.translated}}]),o}(K.l),o=a,i=j()(o.prototype,"editor",[q.O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=j()(o.prototype,"contentState",[q.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)}).call(this,r("dx_E9Eu"),r("dx_o8ox"))},dx_FUAQ:function(e,n,r){"use strict";r.d(n,"S",(function(){return f}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_UtDZ"),s=r("dx_AA3h"),u=r("dx_xlCA"),d=r("dx_YR5F"),f=function(){function e(){var n=this;i()(this,e),this.authActionManager=null,this.showBannerTips=function(e,r){var o=r.isTodoCenter,i=r.onMentionSuccess;n.authActionManager||n.init();var c=e.id,a=e.cn_name,s=e.en_name,u=e.not_notify,f=e.is_external,h="zh"===l.i18nHelper.getLanguage()?a:s;n.authActionManager.showBannerTips({id:c,name:h,notNotify:u,source:d.m.DOCX,isTodoCenter:o,isExternal:f,onMentionSuccess:i})},this.showAuthPanel=function(e){n.authActionManager||n.init();var r=e.userId,o=e.userName;if(r){var i=u.n.getCache(r),c=r,a=o||(null===i||void 0===i?void 0:i.name),l=null===i||void 0===i?void 0:i.is_external;n.authActionManager.showAuthPanel({isExternal:l,id:c,name:a,source:d.m.DOCX,onAuthSuccess:function(e){console.info("[ UserAuthManager showAuthPanel targetId ]",e)}})}},this.destory=function(){n.authActionManager&&(n.authActionManager.destroy(),n.authActionManager=null)}}return a()(e,[{key:"init",value:function(){s.MentionAuthActionManager&&(this.authActionManager=new s.MentionAuthActionManager(null===s.suiteUserManager||void 0===s.suiteUserManager?void 0:s.suiteUserManager.userPermissionManager))}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();f.instance=void 0},dx_FVZU:function(e,n,r){"use strict";r.d(n,"T",(function(){return D}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_N9dL"),g=r("dx_B28d"),b=r("dx_L0LN"),y=r("dx_NsKf"),m=r("dx_KHvq");function _(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var k=function(e){s()(r,e);var n=_(r);function r(e){var o;return i()(this,r),(o=n.call(this,e)).isTextBlock=!0,o}return r}(m.H);k.type=g.B.TEXT;var O=r("dx_iWIM"),x=r.n(O),E=r("dx_TSYQ"),S=r.n(E),C=r("dx_cDcd"),I=r.n(C),B=r("dx_rQGm"),T=r("dx_kP4l");r("dx_yJE3");function w(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var R,M=function(e){s()(r,e);var n=w(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"render",value:function(){if("inline"===this.props.displaymode)return x()(h()(r.prototype),"render",this).call(this);var e=S()("text-block",{"text-indent":Object(T.R)(this)});return I.a.createElement("div",{className:"text-block-wrapper"},I.a.createElement("div",{className:e},x()(h()(r.prototype),"render",this).call(this)),this.model.children.length>0?I.a.createElement("div",{style:{paddingLeft:B.X},className:"text-children"},this.renderChildren()):null)}}]),r}(m.N);function j(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var D=Object(p.H)({providers:[{provide:v.RecordSnapshotCreator,useValue:{type:g.B.TEXT,create:y.u}}]})(R=function(e){s()(r,e);var n=j(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"blocks",get:function(){return[[k,{viewCreator:M,options:this.options.getTextEditorOptions()}]]}}]),r}(b.h))||R},dx_FXIk:function(e,n,r){"use strict";r.d(n,"y",(function(){return u})),r.d(n,"e",(function(){return d})),r.d(n,"V",(function(){return h}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_h6a8"),s=r("dx_MoY1");function u(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.getChildRecordIds,o=e.blockManager,i=e.transactionName,c=void 0===i?"insertBlockWithChildSnapshot":i,l=e.blockSnapshot,u=e.parentBlockId,d=e.beforeInsert,p=f(e),v=o.applyTransaction(c,(function(e){d&&d(e);var i=Object(s.l)(e,o.getRecordByBlockId(u).id,p,[l]),c=a()(i,1)[0];h(c,r(e,c),o,e,n)}));return[o.getBlockModelByBlockId(u).children[p].id,v]}function d(e){var n,r=e.childBlockIds,o=e.blockManager,i=e.transactionName,c=void 0===i?"insertBlockWithChildSnapshot":i,l=e.blockSnapshot,u=e.parentBlockId,d=e.beforeInsert,p=e.mergeMode,v=f(e),g=o.applyTransaction(c,(function(e){d&&d(e);var i=r.map((function(e){return o.getRecordByBlockId(e).id})),c=Object(s.l)(e,o.getRecordByBlockId(u).id,v,[l]),f=a()(c,1)[0];n=f,h(f,i,o,e,!0)}),{mergeMode:p});return[o.getBlockIdsByRecordId(n)[0],g]}function f(e){var n=e.position,r=e.insertPositionBlockId,o=e.parentBlockId,i=e.blockManager;if(!r&&void 0===n)throw new Error("\u8bf7\u4f20\u5165 insert position \u6216\u8005\u63d2\u5165\u4f4d\u7f6e\u7684 blockId\uff01");if(!Object(l.isUndefined)(n)&&!Object(l.isNull)(n))return n;var c=i.getBlockModelByBlockId(o);return function(e){var n=c.children.findIndex((function(n){return n.id===e}));if(Object(l.isUndefined)(n)||Object(l.isNull)(n))throw new Error("\u627e\u4e0d\u5230\u9700\u8981 insert \u7684\u4f4d\u7f6e");return n}(r)}function h(e,n,r,o){var c,a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5?arguments[5]:void 0;if(a&&n.forEach((function(n){o.replace(n,["parent_id"],e)})),s)try{var u=r.getRecordByBlockId(s).snapshot.children,d=void 0===u?[]:u;c=Object(l.uniq)([].concat(i()(d),i()(n)))}catch(f){c=i()(n)}else c=i()(n);o.insertChildren(e,0,c)}},dx_Fapt:function(e,n,r){"use strict";r.d(n,"w",(function(){return b})),r.d(n,"k",(function(){return y})),r.d(n,"r",(function(){return m}));var o,i,c=r("dx_lSNA"),a=r.n(c),l=r("dx_UtDZ"),s=r("dx_XW5M"),u=r("dx_B28d"),d=r("dx_i44h"),f=r("dx_u6uu"),h=r("dx_cGa6"),p=r("dx_o68o");function v(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function g(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?v(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var b=g(g(g({},u.B),{},{MENTION_PEOPLE:"mention_people",CHAT_CARD:"chat_card",MENTION_PAGE:"mention_page",MENTION_DOC:"mention_doc",POLL_SINGLE:"poll_single",POLL_MULTIPLE:"poll_multiple"},f.C),{},{LINK:"link",ADD_COLUMN:"add_column",REMINDER:"reminder",OKR:"okr",EQUATION:"equation"}),y=(o={},a()(o,s.J.Basic,["\u57fa\u7840","basic","jichu","jc"]),a()(o,s.J.Common,["\u5e38\u7528","common","changyong","cy"]),a()(o,s.J.Wiki,Object(p.Q)()||Object(p.i)()?["\u77e5\u8bc6\u5e93","wiki","zhishiku","zsk"]:[]),a()(o,s.J.Drawing,["\u7ed8\u56fe","draw","huitu","ht"]),a()(o,s.J.Data,["\u6570\u636e","data","shuju","sj"]),a()(o,s.J.Bitable,["\u591a\u7ef4\u8868\u683c","bitable","duoweibiaoge","dwbg","smartable","\u6570\u636e"]),a()(o,s.J.ProjectManage,["\u9879\u76ee\u7ba1\u7406","xiangmuguanli","xmgl"]),a()(o,s.J.TeamCooperation,["\u56e2\u961f\u534f\u4f5c","collaboration","tuanduixiezuo","tdxz"]),a()(o,s.J.Vote,["\u6295\u7968","toupiao","tp"]),a()(o,s.J.Collection,["\u4fe1\u606f\u6536\u96c6","xinxishouji","xxsj"]),a()(o,s.J.ThirdPartyContent,["\u7b2c\u4e09\u65b9\u5185\u5bb9","disanfangneirong","dsfnr"]),a()(o,s.J.Embed,["\u5185\u5d4c\u7f51\u9875","embeds","neiqianwangye","nqwy","embeds","iframe"]),a()(o,s.J.Application,["\u5e94\u7528\u8fde\u63a5","yingyonglianjie","yylj"]),a()(o,s.J.Advanced,["\u8fdb\u9636","advanced","jinjie","jj"]),o),m=(i={},a()(i,b.TEXT,["\u6587\u672c","zhengwen","zw","wenben","wb","\u6b63\u6587","text","\u6587\u5b57","wenzi","wz"]),a()(i,b.HEADING1,["\u4e00\u7ea7\u6807\u9898","h1","yijibiaoti","yjbt","\u5927\u6807\u9898","\u6807\u98981","\u4e00\u53f7\u6807\u9898","1\u53f7\u6807\u9898","heading1","header1","Large Heading","one","first"]),a()(i,b.HEADING2,["\u4e8c\u7ea7\u6807\u9898","h2","erjibiaoti","ejbt","\u4e2d\u6807\u9898","\u6807\u98982","\u4e8c\u53f7\u6807\u9898","2\u53f7\u6807\u9898","heading2","header2","Medium Heading","two","second"]),a()(i,b.HEADING3,["\u4e09\u7ea7\u6807\u9898","h3","sanjibiaoti","sjbt","\u5c0f\u6807\u9898","\u6807\u98983","\u4e09\u53f7\u6807\u9898","3\u53f7\u6807\u9898","heading3","header3","Small Heading","three","third"]),a()(i,b.HEADING4,["\u56db\u7ea7\u6807\u9898","h4","sijibiaoti","sjbt","\u6807\u98984","\u56db\u53f7\u6807\u9898","4\u53f7\u6807\u9898","heading4","header4","fourth"]),a()(i,b.HEADING5,["\u4e94\u7ea7\u6807\u9898","h5","wujibiaoti","wjbt","\u6807\u98985","\u4e94\u53f7\u6807\u9898","5\u53f7\u6807\u9898","heading5","header5","five","fifth"]),a()(i,b.HEADING6,["\u516d\u7ea7\u6807\u9898","h6","liujibiaoti","ljbt","\u6807\u98986","\u516d\u53f7\u6807\u9898","6\u53f7\u6807\u9898","heading6","header6","six","sixth"]),a()(i,b.HEADING7,["\u4e03\u7ea7\u6807\u9898","h7","qijibiaoti","qjbt","\u6807\u98987","\u4e03\u53f7\u6807\u9898","7\u53f7\u6807\u9898","heading7","header7","seven","seventh"]),a()(i,b.HEADING8,["\u516b\u7ea7\u6807\u9898","h8","bajibiaoti","bjbt","\u6807\u98988","\u516b\u53f7\u6807\u9898","8\u53f7\u6807\u9898","heading8","header8","eight","eighth"]),a()(i,b.HEADING9,["\u4e5d\u7ea7\u6807\u9898","h9","jiujibiaoti","jjbt","\u6807\u98989","\u4e5d\u53f7\u6807\u9898","9\u53f7\u6807\u9898","heading9","header9","nine","ninth"]),a()(i,b.ORDERED,["\u6709\u5e8f\u5217\u8868","numbered list","youxuliebiao","yxlb","\u6570\u5b57\u7f16\u53f7","shuzibianhao","szbh","\u591a\u7ea7\u5217\u8868","ordered list","list"]),a()(i,b.BULLET,["\u65e0\u5e8f\u5217\u8868","bulleted list","wuxuliebiao","wxlb","\u9879\u76ee\u7b26\u53f7","xiangmufuhao","xmfh","\u591a\u7ea7\u5217\u8868","unordered list","list","bullet point"]),a()(i,b.TODO,Object(h.Q)()?["\u4efb\u52a1","renwu","rw","db","todo","to do","to-do","To-do list","renwuliebiao","rwlb","todo list"]:["\u4efb\u52a1\u5217\u8868","To-do list","renwuliebiao","rwlb","\u5f85\u529e\u4e8b\u9879","\u5217\u8868","todo","checkbox","todolist","to-do","task list"]),a()(i,b.TASK,["\u4efb\u52a1","\u5f85\u529e","\u4efb\u52a1\u5217\u8868","renwu","rw","daiban","db","todo","to do","to-do","task","To-do list","renwuliebiao","rwlb","todo list","task list"]),a()(i,b.QUOTE,["\u5f15\u7528","quote","yinyong","yy","\u5f15\u8ff0","\u5f15\u6587","\u6458\u5f15","\u6458\u6284","\u6458\u9009","cite","citation","'",'"',"\u201c","\u201d"]),a()(i,b.DIVIDER,["\u5206\u9694\u7ebf","divider","fengexian","fgx","\u6a2a\u7ebf","\u5206\u5272\u7ebf","\u5206\u5272\u7b26","\u5206\u9694\u7b26","dividing line","line","separate","divide"]),a()(i,b.MENTION_PEOPLE,["\u4eba\u5458","person","renyuan","ry","\u6210\u5458","people","adult","mention","human","member","collaborator","@"]),a()(i,b.CHAT_CARD,["\u7fa4\u540d\u7247","group card","qunmingpian","qmp","\u7fa4\u804a","\u5c0f\u7ec4","\u8bdd\u9898","group chat","mention","card","@"]),a()(i,b.MENTION_PAGE,["\u4e91\u6587\u6863","space file","yunwendang","ywd","cloud file","docs","document","mention","@"]),a()(i,b.CALLOUT,["\u9ad8\u4eae\u5757","callout","gaoliangkuai","glk","\u5f3a\u8c03","qiangdiao","\u7a81\u51fa","highlight","emphasize"]),a()(i,b.CODE,["\u4ee3\u7801\u5757","code","daimakuai","dmk","\u884c\u5185\u4ee3\u7801","code block"]),a()(i,b.UML,["umltu","uml \u56fe","\u7ed8\u56fe","\u753b\u56fe","process","uml diagram","flowchart","graph","draw"]),a()(i,b.FLOWCHART,["\u6d41\u7a0b\u56fe","flowchart","liuchengtu","lct","\u56fe\u5f62","\u7ed8\u56fe","\u753b\u56fe","flow","process","diagram","graph","draw"]),a()(i,b.IMAGE,["\u56fe\u7247","image","tupian","tp","\u7167\u7247","\u591a\u5a92\u4f53","\u914d\u56fe","\u76f8\u7247","picture","photo","jpg","jpeg","png"]),a()(i,b.FILE,["\u89c6\u9891\u6216\u6587\u4ef6","video or file","file","local file","wenjian","wj","\u9644\u4ef6","word","excel","ppt","pdf","\u4e0a\u4f20","document","attachment","shipin","video","sp","\u89c6\u9891","shipinhuowenjian","sphwj"]),a()(i,b.BOOKMARK,["Web Card","Web Bookmark","\u7f51\u9875\u5361\u7247","wangyekapian","wykp","wangye","book","bookmark","mark","web","\u7f51","\u7f51\u9875","\u5361","\u5361\u7247"]),a()(i,b.SHEET,["\u7535\u5b50\u8868\u683c","dianzibiaoge","dzbg","\u6570\u636e","sheet","excel","Spreadsheets"]),a()(i,b.BITABLE,["\u591a\u7ef4\u8868\u683c","duoweibiaoge","dwbg","bitable","smartable"]),a()(i,l.BitableViewType.GridView,["\u8868\u683c\u89c6\u56fe","grid view","gridview","biaogeshitu","bgst","shujubiao","sjb","database","data table","view","sheet"]),a()(i,l.BitableViewType.Kanban,["\u770b\u677f\u89c6\u56fe","kanbanshitu","kbst","kanban view","view","kb","board","\u5361\u7247"]),a()(i,l.BitableViewType.Gantt,["\u7518\u7279\u89c6\u56fe","ganteshitu","gtst","\u7518\u7279\u56fe","gantetu","gante view","view","gtt","board"]),a()(i,l.BitableViewType.Gallery,["\u753b\u518c\u89c6\u56fe","huaceshitu","hcst","gallery view","view","board","\u5361\u7247"]),a()(i,b.MINDMAP,["\u601d\u7ef4\u5bfc\u56fe","mindmap","mind map","siweidaotu","swdt","\u601d\u7ef4\u7b14\u8bb0","siweibiji","swbj","\u8111\u56fe","naotu","nt","mindnote","xmind","mubu"]),a()(i,b.EQUATION,Object(d.h)()?["gongshi","gs","\u6570\u5b66\u516c\u5f0f","\u65b9\u7a0b","LaTeX","TeX","formula","equation","math"]:[]),a()(i,b.TABLE,["\u8868\u683c","table","biaoge","bg","\u6392\u7248\u683c\u5b50","\u6587\u5b57\u8868\u683c","\u6392\u7248\u8868\u683c","form","tabulation"]),a()(i,b.bilibili,["\u54d4\u54e9\u54d4\u54e9","Bilibili","\u89c6\u9891","B\u7ad9","video"]),a()(i,b.bilibiliBv,["\u54d4\u54e9\u54d4\u54e9","Bilibili","\u89c6\u9891","B\u7ad9","video"]),a()(i,b.bilibiliBp,["\u54d4\u54e9\u54d4\u54e9","Bilibili","\u89c6\u9891","B\u7ad9","video"]),a()(i,b.bilibilip,["\u54d4\u54e9\u54d4\u54e9","Bilibili","\u89c6\u9891","B\u7ad9","video"]),a()(i,b.xigua,["\u897f\u74dc\u89c6\u9891","xigua video","Buzzvideo","xiguashipin","xgsp","\u89c6\u9891","video"]),a()(i,b.youku,["\u4f18\u9177\u89c6\u9891","youkushipin","youku","yksp","\u89c6\u9891","video"]),a()(i,b.airtable,["airtable","\u8868\u683c","table"]),a()(i,b.baidumap,["\u767e\u5ea6\u5730\u56fe","baidu maps","baiduditu","bddt","map"]),a()(i,b.autonavi,["\u9ad8\u5fb7\u5730\u56fe","AutoNavi Maps","gaodeditu","gddt","map","gaode map"]),a()(i,b.gmaps,["Google \u5730\u56fe","google maps","gugeditu","ggdt","map"]),a()(i,b.tiktok,["TikTok","\u89c6\u9891","video","site","website","web video"]),a()(i,b.LINK,["\u94fe\u63a5","lianjie","lj","hyperlink","\u7f51\u5740","url","link","www"]),a()(i,b.ADD_COLUMN,["\u5206\u680f","column","fenlan","fl","\u5e03\u5c40","buju","\u6392\u7248","paiban","grid"]),a()(i,b.REMINDER,["\u65e5\u671f\u63d0\u9192","\u63d0\u9192","date reminder","riqitixing","tixing","time","today","\u65f6\u95f4","shijian","sj","tx","\u65e5\u671f","riqi","rq","\u901a\u77e5","\u95f9\u949f","\u5230\u671f","date","mention","reminder","/","\u3001"]),a()(i,b.figma,["\u8bbe\u8ba1","figma","sheji","\u539f\u578b","yuanxing"]),a()(i,b.modao,["\u58a8\u5200","mockingbot","modao","md","\u539f\u578b","yuanxing"]),a()(i,b.canva,["\u8bbe\u8ba1","sheji","\u53ef\u753b","canva","kehua"]),a()(i,b.jcode,["mashangjuejin","juejin","msjj","jj","\u7801\u4e0a\u6398\u91d1","\u6398\u91d1","code","jcode"]),a()(i,b.codepen,["codepen"]),a()(i,b.feishu_survey,["\u98de\u4e66\u95ee\u5377","feishuwenjuan","feishu survey","fswj","wj","survey","\u8868\u5355","biaodan"]),a()(i,b.jinshuju,["\u91d1\u6570\u636e","jinshuju","jsj","survey","\u8868\u5355","biaodan"]),a()(i,b.youtube,["youtube","\u89c6\u9891","video"]),a()(i,b.OKR,["okr","jinzhanbaogao"]),a()(i,b.POLL_SINGLE,["\u6295\u7968","toupiao","tp","\u5355\u9009","danxuan","single vote","danxuantoupiao","dxtp","cast a vote","single choice poll"]),a()(i,b.POLL_MULTIPLE,["\u6295\u7968","toupiao","tp","\u591a\u9009","duoxuan","multiple vote","duoxuantoupiao","dxtp","vote","cast a vote","multiple choice poll"]),a()(i,b.JIRA_ISSUE,["jira","issue","\u95ee\u9898","jira issue","jiraissue","jira\u95ee\u9898"]),a()(i,b.JIRA_FILTER,["jira","filter","\u8fc7\u6ee4\u5668","jira filter","jirafilter","jira\u8fc7\u6ee4\u5668"]),a()(i,b.WIKI_RECENT,["\u7a7a\u95f4\u52a8\u6001","kongjiandongtai","kjdt","workspace","updates"]),a()(i,b.WIKI_CATALOG,["\u5b50\u9875\u9762\u76ee\u5f55","ziyemianmulu","zymml","subpage","contents"]),i)},dx_FnUg:function(e,n,r){"use strict";(function(t){r.d(n,"L",(function(){return o})),r.d(n,"J",(function(){return c}));var e=r("dx_UtDZ"),o=function(n){return Object(e.getHelpCenterUrl)(n.FEISHU,n.LARK)},i=function(e,n){return{FEISHU:e,LARK:n}},c={BACKREFERENCE:i(t("LarkCCM_DocX_HelpCenter_2wayLink_Feishu"),t("LarkCCM_DocX_HelpCenter_2wayLink_Lark")),WEBPAGECARD:i(t("LarkCCM_DocX_HelpCenter_webCard_Feishu"),t("LarkCCM_DocX_HelpCenter_webCard_Lark")),LATEX:i(t("LarkCCM_DocX_HelpCenter_LaTex_Feishu"),t("LarkCCM_DocX_HelpCenter_LaTex_Lark")),FINDREPLACEMENT:i(t("CreationDoc_DocX_FindReplace_HelpURL"),t("CreationDoc_DocX_FindReplace_HelpURL_Lark"))}}).call(this,r("dx_E9Eu"))},dx_Fnd2:function(e,n,r){},dx_FrkR:function(e,n,r){},dx_Frpz:function(e,n,r){"use strict";var o=r("dx_K8KR");r.d(n,"W",(function(){return o.W}))},dx_FvGq:function(e,n,r){"use strict";var o=r("dx_L6LG");r.d(n,"Q",(function(){return o.Q})),r.d(n,"d",(function(){return o.d})),r.d(n,"o",(function(){return o.o})),r.d(n,"m",(function(){return o.m})),r.d(n,"f",(function(){return o.f})),r.d(n,"F",(function(){return o.F})),r.d(n,"T",(function(){return o.T})),r.d(n,"n",(function(){return o.n})),r.d(n,"D",(function(){return o.D}))},dx_FwAy:function(e,n,r){"use strict";r.d(n,"W",(function(){return s})),r.d(n,"S",(function(){return u}));r("dx_lSNA");var o=r("dx_UtDZ"),i=r("dx_h6a8"),c=(r("dx_yzqx"),r("dx_B28d"),r("dx_vxyt"),r("dx_j9j9"),r("dx_KHvq"),r("dx_ZG9w"),r("dx_iw8O"),r("dx_hvnm"));var a,l=function e(n){Array.isArray(n)?n.forEach(e):Object(i.isPlainObject)(n)&&(n.recordId&&(n.recordId=Object(o.encryptTea)(n.recordId)),n.record_id&&(n.record_id=Object(o.encryptTea)(n.record_id)),Object.keys(n).forEach((function(r){return e(n[r])})))},s=(function e(n){return function(){try{for(var r,o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];i.forEach(l),(r=console).info.apply(r,["[".concat(n,"]")].concat(i))}catch(a){console.info("logToNative ".concat(e," error"),a)}}}("EditControl"),function(e,n){for(var r,o=null,i=n;i&&!(o=i.focusElement);)i=i.parentId?e.getBlockViewByBlockId(i.parentId):null;null===(r=o)||void 0===r||r.focus()});!function(e){e.start="start",e.end="end"}(a||(a={}));var u=function(e){return e.getBlockModelByBlockId(e.rootBlockId).zoneState.isEmpty()&&Object(c.X)(e)}},dx_Fwx7:function(e,n,r){"use strict";r.d(n,"t",(function(){return p})),r.d(n,"C",(function(){return v}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_x56x"),s=r("dx_uZlF"),u=r("dx_kZ3l"),d=r("dx_Jl0O");function f(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function h(e,n){var r=Object(u.JI)(e.getContentState().getActiveZone(),n);return new s.A(function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?f(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({editor:e},r))}function p(e,n,r){var o,c,a="======== [highlightView]";try{c=e.selection.toDOMRange(h(e,n),{ignoreNormalize:!0})}catch(O){console.log(a,"getEmbedRect1 error: ",O)}if(c){var s=c.endContainer,u=null===s||void 0===s||null===(o=s.parentElement)||void 0===o?void 0:o.closest("[".concat(l.n,"]")),d=null===u||void 0===u?void 0:u.querySelector(".embed-text-container");if(d&&d.firstChild&&d.firstChild.nodeType===Node.TEXT_NODE){var f=d.firstChild,p=i()(r,2),v=p[0],g=p[1];try{var b=document.createRange();b.setStart(f,v),b.setEnd(f,g);var y=b.getClientRects(),m=y[0],_=y[y.length-1];return{height:m.height,startLeft:m.left,startTop:m.top,startBottom:m.bottom,endLeft:_.right,endBottom:_.bottom}}catch(O){var k;console.log(a,"getEmbedRect2 error: ",{e:O,range:n,offset:r,textLength:null===f||void 0===f||null===(k=f.textContent)||void 0===k?void 0:k.length})}}}}function v(e){var n=e.editor,r=e.blockId,o=e.rect,i=p(n,e.range,e.offset);if(!i)return Object(d.b)();var c={left:i.startLeft,top:i.startTop,bottom:i.endBottom,right:i.endLeft,width:0,height:i.height},a=o.getBlockClientRect(r)||Object(d.b)();return Object(d.l)(c,a)}},dx_G08E:function(e,n,r){},dx_G2Gn:function(e,n,r){"use strict";var o=r("dx_lSNA"),i=r.n(o),c=r("dx_o0o1"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_J4zp"),d=r.n(u),f=r("dx_lwsE"),h=r.n(f),p=r("dx_W8MJ"),v=r.n(p),g=r("dx_UtDZ"),b=r("dx_h6a8"),y=r("dx_yzqx"),m=r("dx_TTrq"),_=r("dx_B28d"),k=r("dx_EqZO"),O=r("dx_k8kI"),x=r("dx_qx8A"),E=r.n(x);function S(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function C(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?S(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var I=null,B=0,T="docx",w=new Map,R=function(){function e(){var n=this;h()(this,e),this.hasInit=!1,this.rectCache=new Map,this.firstPaintHandlerMap=new Map,this.firstPaintStatus=new Map,this.blockitDataManager=new g.BlockitDataManager,this.getDocInfo=function(e,r){var o=r.node,i=g.CCMBlockitSDK.findFlagByOpBlock(o),c=n.encodeISVBlockKey(i),a="default token",l=!1;return 1===w.size&&(l=!0),w.forEach((function(e){(l||c&&e.recordManager.hasRecord(c))&&(a=Object(m.B)(e.rootRecordId))})),{status:g.API_STATUS.Success,data:{token:a,wikiToken:n.findWikiToken(a),data:{token:a}}}},this.getInitParams=function(){return{status:g.API_STATUS.Success}},this.getContainerRect=function(e,r){var o=r.node,i={height:0,width:0},c=n.getBlockRect(o);if(c){var a=c.width,l=c.height;i.height=l,i.width=a}return{status:g.API_STATUS.Success,data:i}},this.getStaticBlock=function(e){return n.blockitDataManager.getStaticBlock(e,T)},this.fetchStaticBlockData=function(e){return n.blockitDataManager.batchFetchData([e],{forceWrite:!1,host:T})}}return v()(e,[{key:"encodeISVBlockKey",value:function(e){var n=e.split("_");return d()(n,1)[0]}},{key:"findWikiToken",value:function(e){if(y.S.isMobile||!Object(g.isUnderWiki)())return"";var n=Object(b.get)(g.selectors,"wiki.selectWikiInfos"),r=Object(b.get)(g.selectors,"wiki.selectNodeMapNew"),o=n?n(E.a.getState()):{},i=r?r(E.a.getState()):{},c=Object.values(o).find((function(n){return n.objToken===e}));if(c&&c.wikiToken)return c.wikiToken;var a=Object.values(i).find((function(n){return n&&n.objToken===e}));return a&&a.wikiToken?a.wikiToken:""}},{key:"setBlockManagerMap",value:function(e,n){var r=this;w.set(e,n);var o=this.encodeISVBlockKey(e);n.addListenerOnce(O.w2,(function(){r.firstPaintStatus.set(o,!0);var e=r.firstPaintHandlerMap.get(o);e&&(e.forEach((function(e){return e()})),r.firstPaintHandlerMap.delete(o))})),n.model.initialDataReady$.subscribe((function(){r.blockitDataManager.batchFetchData(r.getAllAPPBlockID(n),{forceWrite:!0,host:T})})),n.eventEmitter.once(k.R.CLIENTVAR_APPLY_ALL_DONE,(function(){r.blockitDataManager.batchFetchData(r.getAllAPPBlockID(n),{host:T})}))}},{key:"destroy",value:function(){g.CCMBlockitSDK.destroy(g.BLOCKIT_HOST_CHANEL.DOCX),this.blockitDataManager.destory(),this.hasInit=!1}},{key:"setBlockRect",value:function(e,n){this.rectCache.set(e,n)}},{key:"getBlockRect",value:function(e){var n=g.CCMBlockitSDK.findFlagByOpBlock(e);return n?this.rectCache.get(n):null}},{key:"getBlockInstance",value:function(e){return g.CCMBlockitSDK.getBlockInstance(e)}},{key:"subscribeEvent",value:function(e,n){g.CCMBlockitSDK.subscribeEvent(e,n)}},{key:"unSubscribeEvent",value:function(e,n){g.CCMBlockitSDK.unSubscribeEvent(e,n)}},{key:"triggerEventAPI",value:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];g.CCMBlockitSDK.triggerEventAPI.apply(g.CCMBlockitSDK,[e].concat(r))}},{key:"subscribeFirstPaintEvent",value:function(e,n){if(!this.firstPaintStatus.get(e)){var r=this.firstPaintHandlerMap.get(e);r?r.push(n):this.firstPaintHandlerMap.set(e,[n])}}},{key:"getBlockConfig",value:function(e){return g.CCMBlockitSDK.getBlockConfig?g.CCMBlockitSDK.getBlockConfig(e):null}},{key:"getBlockList",value:function(){var e=s()(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.CCMBlockitSDK.getAvailableBlockList({host:T});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"mountBlock",value:function(){var e=s()(a.a.mark((function e(n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.blockitModuleReady){e.next=11;break}return e.prev=1,r=Date.now(),e.next=5,this.initBlockit();case 5:g.CCMBlockitSDK.setCollectionInfo(n.flag,{block_init_duration:Date.now()-r}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),g.CCMBlockitSDK.setCollectionInfo(n.flag,{status:"fail",error_msg:e.t0.message});case 11:return e.abrupt("return",g.CCMBlockitSDK.mountBlock(C(C({},n),{},{channel:g.BLOCKIT_HOST_CHANEL.DOCX})));case 12:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(n){return e.apply(this,arguments)}}()},{key:"reloadBlock",value:function(e){g.CCMBlockitSDK.reloadBlock(e)}},{key:"getBlockInfo",value:function(e){return g.CCMBlockitSDK.getBlockInfo(e)}},{key:"getBlockLocalPackMode",value:function(e){var n=g.CCMBlockitSDK.getBlockInfo(e);return n?{hasLocalPack:n.hasLocalPack,isOnline:n.isOnline}:null}},{key:"setBlockDebugStatus",value:function(e,n){g.CCMBlockitSDK.setBlockDebugStatus(e,n)}},{key:"isBlockUseLocal",value:function(e){return g.CCMBlockitSDK.getBlockDebugStatus(e)}},{key:"mountCreator",value:function(){var e=s()(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.blockitModuleReady){e.next=9;break}return e.prev=1,e.next=4,this.initBlockit();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),g.CCMBlockitSDK.blockitCollectEvent("cmm_isv_creator_loaded_dev",{status:"fail",error_msg:e.t0.message});case 9:return e.abrupt("return",g.CCMBlockitSDK.mountCreator(C(C({},n),{},{channel:g.BLOCKIT_HOST_CHANEL.DOCX})));case 10:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(n){return e.apply(this,arguments)}}()},{key:"getAllAPPBlockID",value:function(e){var n=[],r={};return e.model.rootBlockModel.traverseInDepthFirstPreOrder((function(e){if(_.B.ISV===e.type){var o=e.snapshot.app_block_id;r[o]||(r[o]=1,n.push(o))}})),n}},{key:"reloadCreator",value:function(e){g.CCMBlockitSDK.reloadCreator(e)}},{key:"destroyInstance",value:function(e){g.CCMBlockitSDK.destroyBlock(e)}},{key:"generateSchema",value:function(e,n){return g.CCMBlockitSDK.generateSchema(e,C(C({},n),{},{host:T}))}},{key:"pasteBlock",value:function(){var e=s()(a.a.mark((function e(n,r,o){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.blockitModuleReady){e.next=3;break}return e.next=3,this.initBlockit();case 3:return e.next=5,g.CCMBlockitSDK.bulkPaste([n],C(C({},r),{},{host:T}),{locale:g.i18nHelper.getLocale(),platform:y.S.isMobile?"mobile":"pc"},o).then((function(e){return e[0]}));case 5:if(!(i=e.sent).code){e.next=8;break}throw i;case 8:return e.abrupt("return",i);case 9:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"initBlockit",value:function(){var e=s()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.hasInit||(g.CCMBlockitSDK.switchHost(g.BLOCKIT_HOST_CHANEL.DOCX),g.CCMBlockitSDK.registerAPI(g.BLOCKIT_HOST_CHANEL.DOCX,g.CCM_API.GET_CONTAINER_RECT,this.getContainerRect),g.CCMBlockitSDK.registerAPI(g.BLOCKIT_HOST_CHANEL.DOCX,g.CCM_API.GET_INIT_PARAMS,this.getInitParams),g.CCMBlockitSDK.registerAPI(g.BLOCKIT_HOST_CHANEL.DOCX,g.CCM_API.GET_DOC_INFO,this.getDocInfo),this.hasInit=!0),e.next=3,g.CCMBlockitSDK.init();case 3:if(g.CCMBlockitSDK.ready){e.next=5;break}throw new Error("Blockit init op has fail , plz check log ");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"blockitModuleReady",get:function(){return g.CCMBlockitSDK.ready&&this.hasInit}},{key:"isDebugMode",get:function(){return g.CCMBlockitSDK.isDebugMode}}]),e}();n.S={creatorBlockitModule:function(e,n){return B+=1,I||(I=new R),I.setBlockManagerMap(e,n),I},getBlockitModule:function(){return I},destroyBlockitModule:function(e,n){w.delete(n),I===e&&0===(B-=1)&&(I.destroy(),I=null)}}},dx_G2jP:function(e,n,r){"use strict";r.d(n,"d",(function(){return d}));var o=r("dx_TSYQ"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c),l=r("dx_Pz0G"),s=r("dx_B28d"),u=r("dx_DOue");r("dx_RO6e");function d(e){var n=e.isHistory;return a.a.createElement(u.A,null,a.a.createElement(l.S,{displayMode:s.J.INLINE,className:i()("task-block-loading",n&&"task-block-history")}))}},dx_G3GD:function(e,n,r){"use strict";r.d(n,"u",(function(){return ie}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_PJYZ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_FBWK"),m=r("dx_TSYQ"),_=r.n(m),k=r("dx_UtDZ"),O=r("dx_h6a8"),x=r("dx_cDcd"),E=r.n(x),S=r("dx_yzqx"),C=r("dx_o0o1"),I=r.n(C),B=r("dx_yXPU"),T=r.n(B),w=r("dx_QxNg"),R=r("dx_xy70"),M=r("dx_LeqM"),j=function(){function e(n,r){a()(this,e),this.blockManager=n,this.selectionAPI=r,this.controller=void 0,this.rxOp=new k.RxjsDestroyableOperator,this.loadLimiter=this.loadLimiter.bind(this),n.recordManager.on(w.q.CHANGE,this.handleRecordChange),R.O.pipe(this.rxOp.takeUntil()).subscribe(this.loadLimiter)}return s()(e,[{key:"loadLimiter",value:function(){var e=T()(I.a.mark((function e(){var n,o;return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(S.S.isMobile){e.next=3;break}return e.next=3,Object(k.loadLimitEditModeDeps)();case 3:return e.next=5,this.rxOp.toPromise(Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_tNDb")));case 5:n=e.sent,o=n.default,this.controller=new o(this.blockManager,this.selectionAPI),this.controller.start();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this.blockManager.recordManager.off(w.q.CHANGE,this.handleRecordChange),this.rxOp.destroy(),this.controller&&(this.controller.stop(),this.controller=null)}},{key:"fullscreenEntering",value:function(){this.controller&&this.controller.stop()}},{key:"fullscreenExited",value:function(){this.controller&&this.controller.start()}},{key:"handleRecordChange",value:function(e){M.f.next(e)}}]),e}(),D=r("dx_A2Ao"),A=r("dx_M7MP"),P=r("dx_ZG9w"),L=r("dx_x1WV"),N=r("dx_Xdvu"),F=r("dx_qHDV"),U="selecting-frame",H="selecting-inline",V="selecting-inline-multiple",W=function(e){e.classList.remove(U,U,V)},z=function(e,n){!function(e){e.classList.remove(U)}(e),e.classList.contains(H)||e.classList.add(H),n?e.classList.contains(V)||e.classList.add(V):e.classList.remove(V)},G=function(e){!function(e){e.classList.remove(H,V)}(e),e.classList.contains(U)||e.classList.add(U)},K=r("dx_D8nn"),q=r("dx_UTG8"),X=r("dx_BaZy"),Y=r.n(X),J=Y()({loader:function(){return r.e("dx_duh").then(r.bind(null,"dx_UfHL"))},loading:function(){return null}}),Z=Y()({loader:function(){return r.e("dx_FP4").then(r.bind(null,"dx_EPfY"))},loading:function(){return null}}),Q=k.isDynamicDocxBottomTemplateEnable?Z:J,$=r("dx_ey54");r("dx_h1hl");function ee(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function te(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var ne=k.renderHelpers.MultiStageRenderContainer,re=k.renderHelpers.DocxStage,oe=k.renderHelpers.Business,ie=function(e){h()(r,e);var n=te(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).container=null,e.preContainerWidth=0,e.preContainerHeight=0,e.preEditorWidth=0,e.preEditorHeight=0,e.inited=!1,e.setContainerRef=function(n){e.container=n,n&&!e.inited&&(e.inited=!0,e.init())},e.rootElement=E.a.createRef(),e.hasFirstCanEdit=!1,e.isEditorMounted=!1,e.isUnmounted=!1,e.limitEditModeQuantity=void 0,e.unboundEventFunc=void 0,e.editor=void 0,e.minHeight=0,e.editable=void 0,e.updateMinHeight=function(){var n=Object(O.get)(window,"User.isPDF");e.minHeight=n?0:window.innerHeight-(S.S.isFeed?68:64)},e.handleResize=function(n){var r,o,i,c,a,l=(null===n||void 0===n?void 0:n.width)||(null===(r=e.rootElement.current)||void 0===r?void 0:r.offsetWidth),s=(null===n||void 0===n?void 0:n.height)||(null===(o=e.rootElement.current)||void 0===o?void 0:o.offsetHeight);if(s&&l){var u=(null===(i=e.container)||void 0===i?void 0:i.offsetWidth)||l,f=(null===(c=e.container)||void 0===c?void 0:c.offsetHeight)||s,h=d()(e),p=h.preContainerHeight,v=h.preContainerWidth,g=h.preEditorHeight,b=h.preEditorWidth;null===(a=e.blockManager)||void 0===a||a.dispatch($.G,{containerWidth:l,containerHeight:s,editorWidth:u,editorHeight:f,preContainerHeight:p,preContainerWidth:v,preEditorHeight:g,preEditorWidth:b}),e.preContainerHeight=s,e.preContainerWidth=l,e.preEditorHeight=f,e.preEditorWidth=u}},e.tryCallMountedAndEditableEvent=function(){e.isEditorMounted&&e.hasFirstCanEdit&&(e.limitEditModeQuantity=new j(e.blockManager,e.selectionAPI))},e.handleSelectionMove=function(n){var r=n.renderMode,o=n.items;e.container&&r===F.H.LAZY&&z(e.container,o.length>1)},e.handleSelectionStart=function(n){var r=n.renderMode;e.container&&r===F.H.NORMAL&&G(e.container)},e.handleSelectionStop=function(){e.container&&W(e.container)},e.editorMounted=function(){e.bindSelectionEvents(!0),e.handleResize(),!1!==e.props.focusTitleOnMount&&e.focusTitle(),e.props.onMount&&e.props.onMount(d()(e)),e.blockManager.dispatch($.H),e.isEditorMounted=!0,e.tryCallMountedAndEditableEvent()},e}return s()(r,[{key:"componentDidMount",value:function(){var e=this;D.S.init(),Object(A.N)((function(){e.bindEvent(!0)}))}},{key:"componentDidUpdate",value:function(e){!this.hasFirstCanEdit&&this.editable&&(this.hasFirstCanEdit=!0,this.tryCallMountedAndEditableEvent())}},{key:"componentWillUnmount",value:function(){var e;if(this.isUnmounted=!0,this.bindEvent(!1),this.handleSelectionStop(),this.bindSelectionEvents(!1),D.S.destroy(),this.isEditorMounted){var n=this.props.onUnmount;n&&n(this)}null===(e=this.limitEditModeQuantity)||void 0===e||e.destroy(),this.limitEditModeQuantity=void 0,this.editor&&(this.editor.destroy(),this.editor=null),this.container=null}},{key:"componentWillMount",value:function(){this.updateMinHeight()}},{key:"componentWillUpdate",value:function(){var e,n=this;Object(A.T)((function(){n.updateMinHeight()}),null===(e=this.blockManager)||void 0===e?void 0:e.lazyRecordStatus)}},{key:"getPageMeta",value:function(){var e=this.blockManager.getRecord(this.blockManager.rootRecordId);return{title:q.InputPipe.serialize(e.snapshot.text).alltext,fullWidth:!!e.snapshot.full_width}}},{key:"init",value:function(){var e,n,r,o,i=this;this.preContainerHeight=(null===(e=this.rootElement.current)||void 0===e?void 0:e.offsetHeight)||0,this.preContainerWidth=(null===(n=this.rootElement.current)||void 0===n?void 0:n.offsetWidth)||0,this.preEditorHeight=(null===(r=this.container)||void 0===r?void 0:r.offsetHeight)||0,this.preEditorWidth=(null===(o=this.container)||void 0===o?void 0:o.offsetWidth)||0;var c=this.props.createDocxEditor(this.container);this.editor=c,this.editable=this.editor.api.config.get("editable"),c.api.lifecycle.editorDidMount$.subscribe(this.editorMounted),c.api.modelService.initialDataReady$.subscribe((function(){i.isUnmounted||c.mount(i.container)})),c.api.config.change$.subscribe((function(){var e,n=null===(e=i.editor)||void 0===e?void 0:e.api.config.get("editable");n!==i.editable&&(i.editable=n,i.forceUpdate())}))}},{key:"bindEvent",value:function(e){var n;e?this.rootElement.current&&(this.unboundEventFunc=Object(k.observeResize)(this.rootElement.current,{width:!0,height:!0},this.handleResize)):null===(n=this.unboundEventFunc)||void 0===n||n.call(this)}},{key:"focusTitle",value:function(){var e,n;if(null===(e=this.blockManager)||void 0===e?void 0:e.hasBlockViewByBlockId(null===(n=this.blockManager)||void 0===n?void 0:n.rootBlockId)){var r=this.blockManager.getBlockViewByBlockId(this.blockManager.rootBlockId);if(Object(P.U)(r)){var o=r.model.getText().length,i={zoneId:r.model.zoneId,start:o,len:0};r.model.setSelection(i,!0)}}}},{key:"bindSelectionEvents",value:function(e){if(this.selectionAPI){var n=e?"on":"off";this.selectionAPI[n](F.j.move,this.handleSelectionMove),this.selectionAPI[n](F.j.start,this.handleSelectionStart),this.selectionAPI[n](F.j.stop,this.handleSelectionStop)}}},{key:"handleTransitionEnd",value:function(){K.S.emit(K.p.COMMON.UPDATE_OVERLAY_POSITION)}},{key:"render",value:function(){var e=this.props,n=e.className,r=e.hasCover,o=_()(n,"editor"),c=function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ee(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ee(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({minHeight:this.minHeight},this.props.style);return E.a.createElement("div",{className:o,style:c,ref:this.rootElement,onTransitionEnd:this.handleTransitionEnd},E.a.createElement("div",{className:"doc-cover-toolbar"}),E.a.createElement("div",{ref:this.setContainerRef,className:"editor-container"}),this.isRenderBottomTemplate&&E.a.createElement(ne,{renderOnTimeout:!0,business:oe.Docx,renderWhen:re.Done},E.a.createElement(Q,{recordVersion:this.recordVersion,hasCover:Boolean(r)})))}},{key:"blockManager",get:function(){var e;return null===(e=this.editor)||void 0===e?void 0:e.api.getService(L.a)}},{key:"selectionAPI",get:function(){var e;return null===(e=this.editor)||void 0===e?void 0:e.api.getService(N.a).selectionAPI}},{key:"isRenderBottomTemplate",get:function(){return this.editable&&k.docxBottomTemplateEnabled&&!Object(k.getHideTemplateFromQuery)()&&!Object(y.getIsCrossBrand)()}},{key:"recordVersion",get:function(){var e="-1";if(this.blockManager){var n,r=null===(n=this.blockManager.recordManager.collabModule)||void 0===n?void 0:n.getVersion(this.blockManager.rootRecordId);e=r?"".concat(r):e}return e}}]),r}(E.a.Component)},dx_G3VO:function(e,n,r){"use strict";r.d(n,"A",(function(){return u})),r.d(n,"J",(function(){return d})),r.d(n,"O",(function(){return f})),r.d(n,"c",(function(){return h})),r.d(n,"p",(function(){return v}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_uZlF"),a=r("dx_vdIl");function l(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?l(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function u(e){return Array.isArray(e)?{zoneId:a.x,start:e[0],len:e[1]-e[0]}:e.toPosition()}function d(e,n){var r=e.getActiveZone(),o=r.getZoneId(),i=r.offsetToPoint(n[0]),c=r.offsetToPoint(n[1]);return{start:s(s({},i),{},{zoneId:o}),end:s(s({},c),{},{zoneId:o})}}function f(e){return e.editor.getContentState().getActiveZone().length()>1}function h(e,n){if(n)return 0===e.start.line;var r=e.editor.getContentState().getActiveZone();return e.start.line===r.length()-1}function p(e,n){var r=n.getRect(a.x),o=r.left,i=r.top,c=e.left+o,l=e.top+i;return{left:c,top:l,bottom:e.bottom+i,right:e.right+o,height:e.height,width:e.width,x:c,y:l}}function v(e){var n=e.selection.getSelection();return n.isCollapsed()?p(e.rectModule.getCaretRect(n.start),e):p(e.rectModule.getRangeRect(new c.A({editor:e,start:n.start,end:n.end})),e)}},dx_G5PB:function(e,n,r){"use strict";r.d(n,"X",(function(){return C}));var o,i,c,a=r("dx_yG8O"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_PJYZ"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_W7W2"),g=r.n(v),b=r("dx_a1gu"),y=r.n(b),m=r("dx_Nsbk"),_=r.n(m),k=r("dx_Uyc2"),O=r.n(k),x=(r("dx_A1AB"),r("dx_x1WV")),E=r("dx_eGDr");function S(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=_()(e);if(n){var i=_()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return y()(this,r)}}var C=(c=function(e){g()(r,e);var n=S(r);function r(e){var o;return u()(this,r),o=n.call(this,e),l()(o,"blockManager",i,f()(o)),o.serviceType=void 0,o.isThirdPartyCommentBlock=!0,o.loadBridge=function(){return o.loadBridgeImpl()},o.handleCommentLoaded=function(e){e.handleThirdPartyLoaded(o.record.id,o.getComments())},o.handleCommentUpdated=function(e){e.handleThirdPartyUpdated(o.record.id,o.getComments())},o.handleCommentDidAdd=function(e,n){e.handleThirdPartyCommentDidAdd(o.record.id,n)},o.setCommentsFilter=function(e,n){e.setCommentsFilter(n)},o.activeCommentChange=function(e,n){var r=o.getActiveComments();if(r.length>0){var i=r[0];n&&n.removeAllSelection(!1),e&&e.activateComment(i.commentId,void 0,E.M.thirdParty)}else e&&e.deactivateComment(E.Fr.thirdParty)},o}return p()(r,[{key:"serviceToken",get:function(){return this.snapshot.token}},{key:"config",get:function(){return this.editorAPI.config}},{key:"pageToken",get:function(){return this.config.get("token")}}]),p()(r,[{key:"getServiceTypeAndServiceToken",value:function(){return{serviceType:this.serviceType,serviceToken:this.snapshot.token}}}]),r}(r("dx_NMQJ").D),o=c,i=O()(o.prototype,"blockManager",[x.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)},dx_G6GV:function(e,n,r){"use strict";r.d(n,"B",(function(){return y})),r.d(n,"v",(function(){return m})),r.d(n,"s",(function(){return _})),r.d(n,"r",(function(){return O})),r.d(n,"f",(function(){return x})),r.d(n,"L",(function(){return E}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_QxNg"),a=r("dx_h6a8"),l=r("dx_B28d"),s=r("dx_iSIC"),u=r("dx_r61a"),d=r("dx_XlRC"),f=r("dx_S5Se"),h=r("dx_fCRr");function p(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return v(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function v(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function g(e,n,r){var o,i,c=r.isIgnoreFirstSeq,a=r.isUseCacheOrder,l=r.isForceNewList,s=r.isOnlyOneList,h=r.isNextSiblingOrderedHeaderNotToBeMerge,p=r.isUseDownwardOrder,v=n.map((function(n){return e.getBlockModelByBlockId(n)}));if(!v.length)return new Map;var g=v[0],b=v[v.length-1],y=!1,m=!1,_=new Array(v.length),k=new Array(v.length);v.forEach((function(n,r){var o="auto",i=n.record.get(["seq"]),l=!!i&&"auto"!==i;if(l&&(y=!0),0===r){"1"===i&&(m=!0);var u=e.orderMap.get(n.record.id);o=l?c?1:Number(i):u&&a?u:1}else l&&!s&&(o=Number(i));_[r]=o,k[r]="auto"!==o?o:k[r-1]+1}));var O=new Map,x=Object(d.x)(e,null===(o=g.previousSibling)||void 0===o?void 0:o.id),E=Object(d.x)(e,null===(i=b.nextSibling)||void 0===i?void 0:i.id),S=x,C=h&&(null===E||void 0===E?void 0:E.isHeader)?null:E,I=Object(d.A)(e,g.id,u.b.UP),B=Object(d.A)(e,b.id,u.b.DOWN),T=Object(d.e6)(e,g.id,u.b.UP,k[0]),w=Object(d.e6)(e,b.id,u.b.DOWN,k[k.length-1]),R=S||T,M=C||w,j=!1,D=!1,A=!1;if(l&&m)M&&(O.set(M.blockId,"auto"),A=!0);else{var P=!1;I&&B&&I.order===B.order-1&&!B.isHeader?(_.fill("auto"),P=!0,j=!0):(R&&(_[0]="auto",P=!0,D=!0),M&&(!p||y||P||(_[0]=M.order),O.set(M.blockId,"auto"),P=!0,A=!0))}var L=new Map;if(j){if(I)Object(d.Y)(e,I.blockId,u.b.UP,!0).forEach((function(e){var n=1===e.order?String(e.order):"auto";L.set(e.blockId,n)}));if(B)Object(d.Y)(e,B.blockId,u.b.DOWN,!0).forEach((function(e){L.set(e.blockId,"auto")}))}D&&(R&&Object(d.Y)(e,R.blockId,u.b.UP,!0).forEach((function(e){var n=1===e.order?String(e.order):"auto";L.set(e.blockId,n)})));A&&(M&&Object(d.Y)(e,M.blockId,u.b.DOWN,!0).forEach((function(e){L.set(e.blockId,"auto")})));var N=new Map;return v.forEach((function(e,n){var r=e.record.snapshot.seq,o=String(_[n]);r!==o&&N.set(e.id,o)})),Object(f.U)(N,O),Object(f.U)(N,L),N}function b(e,n,r,o,i){var c=new Map;if(!n.length)return c;if(!r||!o)return c;var a=e.getBlockModelByBlockId(r);if(!a||a.children.length<=o)return c;if(!Object(f.W)(i,n,e))return c;var l=Object(d.e)(e,r,o,u.b.DOWN);return l&&!l.isHeader&&(c.set(l.blockId,"1"),e.orderMap.set(l.recordId,1)),c}function y(e,n,r){var o=r[0],i=n.map((function(n){var r=n.id;return e.getBlockIdsByRecordId(r)[0]})).filter(Boolean),c=function(n){var r;return null===(r=e.getBlockModelByBlockId(n).parent)||void 0===r?void 0:r.id},l=Object(s.Z)(i,e).reduce((function(e,n){var r=Object(a.groupBy)(n,c),o=Object.values(r).map((function(e){return e.filter(Boolean)}));return e.concat(o)}),[]),u=new Map;return l.forEach((function(r){var i=function(r){var i=Object(f.J)(e,r);if(o===h.R.TURNINTO_INSERT)return g(e,i,{isForceNewList:!0,isOnlyOneList:!0});if(o===h.R.TURNINTO_REMOVE){var c,a,l=e.getBlockModelByBlockId(i[i.length-1]);return b(e,i,null===(c=l.parent)||void 0===c?void 0:c.id,null===(a=l.nextSibling)||void 0===a?void 0:a.position,n)}return new Map}(r);Object(f.U)(u,i)})),u}function m(e,n,r){return g(e,Object(f.Y)(e,n).orderedBlockIds,r||{})}function _(e,n,r){var o=r||{},i=o.downwardBlocksPositionNoChange,a=o.originalNextSiblingBlockPosition,l=o.isInAdvanceUpdateOrderMap,s=n.ops.filter(c.ZH),h=Object(f.e)(e,n),p=h.recordIds,v=h.orderedRecordIds,g=null;if(a)g=a;else{var y=s.find((function(e){return e.action.ld===p[0]})).p[1];g=i?y+p.length:y}var m=e.getBlockIdsByRecordId(n.id)[0],_=b(e,v,m,g,[n]);if(l&&n.id&&g){var k=Object(d.e)(e,m,g,u.b.DOWN),O=e.orderMap.get(v[0]);k&&!k.isHeader&&(_.has(k.blockId)||O&&e.orderMap.set(k.recordId,O))}return _}function k(e,n){var r=n.ops.filter(c.ZH),o=Object(f.e)(e,n).recordIds,i=Object(f.h)(o,n),a=new Map;return i.forEach((function(o,c){var s=function(o,i){var c=o.filter((function(n){return e.getRecord(n).snapshot.type===l.B.ORDERED})),a=r.find((function(e){return e.action.ld===o[0]})).p[1],s=i?a+o.length:a,u=e.getBlockIdsByRecordId(n.id)[0];return b(e,c,u,s,[n])}(o,0===c&&i.length>1);Object(f.U)(a,s)})),a}function O(e,n,r){var o=Object(f.JQ)(n,r),c=o.insertRecordOps,s=o.removeRecordOps,h=o.insertOps,v=o.removeOps;if(1===s.length&&1===c.length){var g=new Map,b=c[0],y=s[0];if(b.id!==y.id){var O=_(e,y);Object(f.U)(g,O);var x=m(e,b,{isIgnoreFirstSeq:!0});Object(f.U)(g,x)}else{var E,S=!1,C=p(v);try{var I=function(){var e=E.value,n=e.action.ld,r=h.find((function(e){return e.action.li===n}));if(r.p[1]<e.p[1])return S=!0,"break"};for(C.s();!(E=C.n()).done;){if("break"===I())break}}catch(G){C.e(G)}finally{C.f()}var B=_(e,y,{downwardBlocksPositionNoChange:S});Object(f.U)(g,B);var T=Object(f.Y)(e,b).orderedBlockIds,w=Object(d.x)(e,T[0]);if(!Object(d.e6)(e,T[0],u.b.UP,null===w||void 0===w?void 0:w.order)||(null===w||void 0===w?void 0:w.isHeader)){var R=m(e,b,{isUseDownwardOrder:!0,isUseCacheOrder:!0});Object(f.U)(g,R)}}return g}if(1===s.length&&2===c.length){var M=new Map,j=!0;if(h.forEach((function(n){var r,o=n.action.li;(null===(r=e.getBlockModelsByRecordId(o)[0].parent)||void 0===r?void 0:r.type)!==l.B.GRID_COLUMN&&(j=!1)})),j){var D=k(e,s[0]);Object(f.U)(M,D),c.forEach((function(n){var r=m(e,n);Object(f.U)(M,r)}))}else{var A=e.getBlockIdsByRecordId(s[0].id)[0],P=e.getBlockModelByBlockId(A).parent,L=Object(a.partition)(c,(function(e){return e.id===(null===P||void 0===P?void 0:P.record.id)})),N=i()(L,2),F=N[0],U=N[1];if(1===F.length){var H=F[0],V=m(e,H,{isIgnoreFirstSeq:!0});Object(f.U)(M,V)}if(1===U.length){var W=U[0],z=m(e,W);Object(f.U)(M,z)}}return M}return new Map}function x(e,n,r){var o=Object(f.JQ)(n,r),i=o.insertRecordOps,c=o.removeRecordOps,a=o.insertOps,l=o.removeOps;if(0===c.length&&i.length>0){var s=new Map;return i.forEach((function(n){var r=m(e,n);Object(f.U)(s,r)})),s}if(1===c.length&&0===i.length){var u=c[0];return _(e,u)}if(1===c.length&&i.length>0){var d=new Map,h=c[0],p=Object(f.e)(e,h).recordIds,v=l.find((function(e){return e.action.ld===p[0]})).p[1]+a.length,g=_(e,h,{originalNextSiblingBlockPosition:v,isInAdvanceUpdateOrderMap:!0});return Object(f.U)(d,g),i.forEach((function(n){var r=m(e,n);Object(f.U)(d,r)})),d}return new Map}function E(e,n,r){Object(d.Y)(r,e,u.b.DOWN).forEach((function(e){n.replace(e.recordId,["seq"],"auto")}))}},dx_GDEn:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M7.187 1.648L1.838 6.996l5.349 5.35a.375.375 0 010 .53l-.53.53a.375.375 0 01-.53 0l-5.88-5.88a.75.75 0 010-1.06l5.88-5.88a.375.375 0 01.53 0l.53.531a.375.375 0 010 .53z",fill:"#646A73"}),l=i.a.createElement("path",{d:"M13.862 1.648L8.513 6.996l5.349 5.35a.375.375 0 010 .53l-.53.53a.375.375 0 01-.53 0l-5.88-5.88a.75.75 0 010-1.06l5.88-5.88a.375.375 0 01.53 0l.53.531a.375.375 0 010 .53z",fill:"#646A73"});n.S=function(e){return i.a.createElement("svg",c({width:14,height:14,viewBox:"0 0 14 14",fill:"none"},e),a,l)}},dx_GFgd:function(e,n,r){"use strict";(function(t){r.d(n,"Y",(function(){return Fe}));var e,o,i,c=r("dx_J4zp"),a=r.n(c),l=r("dx_RIqP"),s=r.n(l),u=r("dx_o0o1"),d=r.n(u),f=r("dx_lSNA"),h=r.n(f),p=r("dx_yXPU"),v=r.n(p),g=r("dx_yG8O"),b=r.n(g),y=r("dx_lwsE"),m=r.n(y),_=r("dx_PJYZ"),k=r.n(_),O=r("dx_W8MJ"),x=r.n(O),E=r("dx_W7W2"),S=r.n(E),C=r("dx_a1gu"),I=r.n(C),B=r("dx_iWIM"),T=r.n(B),w=r("dx_Nsbk"),R=r.n(w),M=r("dx_Uyc2"),j=r.n(M),D=(r("dx_A1AB"),r("dx_uxuX")),A=r("dx_cEo5"),P=r("dx_LcNA"),L=r("dx_D38a"),N=r("dx_e4eN"),F=r("dx_cvuT"),U=r("dx_PcQO"),H=r("dx_TSYQ"),V=r.n(H),W=r("dx_UtDZ"),z=r("dx_AA3h"),G=r("dx_h6a8"),K=r("dx_cDcd"),q=r.n(K),X=r("dx_bdgK"),Y=r("dx_AYdr"),J=r("dx_uGy8"),Z=r("dx_k1kQ"),Q=r("dx_v582"),ee=r("dx_yvc8"),te=r("dx_rQGm"),ne=r("dx_yzqx"),re=r("dx_Z7ZC"),oe=r("dx_Fimk"),ie=r("dx_luPr"),ce=r("dx_nddJ"),ae=r("dx_by6m"),le=r("dx_GsbX"),se=r("dx_rldU"),ue=r("dx_dIhn"),de=r("dx_B28d"),fe=r("dx_L6Lu"),he=r("dx_KHvq"),pe=r("dx_ZG9w"),ve=r("dx_bPy9"),ge=r("dx_kZ3l"),be=r("dx_R7Rv"),ye=r("dx_YRGG"),me=r("dx_eGDr"),_e=r("dx_sNGG"),ke=r("dx_awlV"),Oe=r("dx_O1Ou"),xe=r("dx_MUhB"),Ee=r("dx_K7ih"),Se=r("dx_z0z2"),Ce=r("dx_ONjz"),Ie=r("dx_bdma"),Be=r("dx_PEV2"),Te=r("dx_vrvQ");r("dx_rXO6");function we(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Re(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Re(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Re(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function Me(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function je(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Me(Object(r),!0).forEach((function(n){h()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Me(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function De(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=R()(e);if(n){var i=R()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return I()(this,r)}}var Ae=W.LanguagePicker||function(){return null};var Pe,Le=Object(K.memo)((function(e){var n=e.renderFinishCb,r=e.highlightCode,o=e.id;return Object(K.useLayoutEffect)((function(){n(),r(),ie.R.reportBlockLoadStage(ie.F.TTU,{id:o,time:(new Date).getTime()})}),[]),null})),Ne=Oe.a.DocxCode;!function(e){e.SCROLL="scroll"}(Pe||(Pe={}));var Fe=(i=function(e){S()(r,e);var n=De(r);function r(e){var i;return m()(this,r),i=n.call(this,e),b()(i,"scheduler",o,k()(i)),i.unregisterVc=void 0,i.lastVCAction=void 0,i.replayingUUID=void 0,i.pendingVCAction=void 0,i.isAutoDetectingLanguage=!1,i.remainSpaceRef=q.a.createRef(),i.fullSpaceRef=q.a.createRef(),i.languagePickerRef=q.a.createRef(),i.containerRef=q.a.createRef(),i.tabSize=4,i.calcLineGutterRICHandler=void 0,i.setHighlightRICHandler=void 0,i.remainSpaceResizeObserver=void 0,i.fullSpaceResizeObserver=void 0,i._isFocus=!1,i.isMouseEnter=!1,i.state={languages:Ce.l,lineNum:1,headerVisible:!1,isWidthMin:!1,lineItems:[],isDropdownVisible:!1},i.hasEnterBufferEver=!1,i.zoom=void 0,i.lineHeight=void 0,i.lineCountMap=new Map,i.requestId=void 0,i.popupContainer=document.getElementById("docx-popup-container")||document.body,i.handleResize=function(){i.lineCountMap.clear(),i.calcLineGutter(),i.toggleIsWidthMin()},i.handleResizeLanguage=function(){var e=i.containerRef.current;if(e){var n=e.offsetWidth,r=Math.floor((n-65)/14);e.querySelector(".code-block-header-btn span").style.maxWidth="".concat(r,"em")}},i.handleContentChange=function(e){var n,r;(null===(n=e.previous.getZoneState(i.model.zoneId))||void 0===n?void 0:n.getModelText())!==(null===(r=e.current.getZoneState(i.model.zoneId))||void 0===r?void 0:r.getModelText())&&i.updateHighlight(i.model.language,e)},i.highlightCode=function(){var e=i.model.language;if(!e)return i.clearHighlight(),void i.forceUpdate();i.highlightAllCode(e)},i.handleKeyDown=function(e){if(i.isFocus()){var n=ne.S.isMac?e.metaKey:e.ctrlKey;return e.keyCode!==ke.G.ENTER||e.ctrlKey||e.metaKey||e.altKey||e.shiftKey?e.keyCode===ke.G.ENTER&&n&&!e.altKey?i.handleMetaEnter(e):Object(ke.o)("shift.tab")(e)?i.handleUnTab(e):Object(ke.o)(ke.G.TAB)(e)?i.handleTab(e):void 0:i.handleEnter(e)}},i.handleMetaEnter=function(){var e=v()(d.a.mark((function e(n){var r,o,c,a,l,s,u,f,h;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),n.nativeEvent.stopImmediatePropagation(),o=n.shiftKey,c=null===(r=i.model.getSelection())||void 0===r?void 0:r.toPosition()){e.next=6;break}return e.abrupt("return");case 6:if(a=c.isBackward?c.start:c.start+c.len,l=i.model.zoneState.getModelText(),!o){e.next=15;break}return s=l.slice(0,c.start).lastIndexOf("\n"),u=-1===s?0:s,e.next=13,i.newLine(je(je({},c),{},{start:u,len:0}));case 13:e.next=19;break;case 15:return f=l.slice(a).indexOf("\n"),h=-1===f?l.length:a+f,e.next=19,i.newLine(je(je({},c),{},{start:h,len:0}));case 19:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i.handleEnter=function(){var e=v()(d.a.mark((function e(n){var r,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),o=null===(r=i.model.getSelection())||void 0===r?void 0:r.toPosition()){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,i.newLine(o);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i.handleScroll=function(){i.props.recursionProps.eventEmitter.emit(_e.Y.HIGHLIGHT_UPDATE),i.calcScrollStateToVc()},i.calcScrollStateToVc=Object(G.debounce)((function(){if(i.vcController){var e=i.editorContainer,n=e.scrollLeft/(e.scrollWidth-e.clientWidth),r={offsetRatioMap:je(je({},(i.vcController.getState(Ne,Pe.SCROLL)||{offsetRatioMap:{}}).offsetRatioMap),{},h()({},i.record.id,n))};i.vcController.sendState(Ne,Pe.SCROLL,r)}}),80),i.registerVc=function(){var e;i.unregisterVc=null===(e=i.vcController)||void 0===e?void 0:e.register({moduleName:Ne,defaultState:h()({},Pe.SCROLL,{offsetRatioMap:{}}),replayHandler:i.replayHandler,retryOnVersionMatched:"always",cycleHandler:i.cycleHandler,checkSame:function(e,n,r){return e===Pe.SCROLL&&Object(xe.P)(n.offsetRatioMap,r.offsetRatioMap,(function(e,n){return e[n]}),i.blockManager)}})},i.cycleHandler=function(e){e!==D.STOP_FOLLOW&&e!==D.START_RECORD||(i.lastVCAction=void 0,i.pendingVCAction=void 0)},i.replayHandler=function(e){var n=e.actionType,r=e.data,o=e.uuid,c=e.isRecord;if(n===Pe.SCROLL){var a=r.offsetRatioMap[i.record.id];console.debug("debug: replay code scroll",o);var l=k()(i).vcController;if("number"!==typeof a)return null===l||void 0===l?void 0:l.reportReplay(Oe.s.IGNORE,o,"[".concat(Ne,"]: offsetRatioMap is empty"));if(i.replayingUUID)return i.pendingVCAction&&(null===l||void 0===l||l.reportReplay(Oe.s.IGNORE,i.pendingVCAction.uuid,"[".concat(Ne,"]: prev scroll not finish, next action coming"))),void(i.pendingVCAction={actionType:n,data:r,uuid:o,isRecord:c});var s=0;if(void 0!==a){var u=i.editorContainer;s=a*(u.scrollWidth-u.clientWidth)}!c&&(i.lastVCAction={actionType:n,data:r,uuid:o,isRecord:c});var d=Date.now();s!==i.editorContainer.scrollLeft?(i.replayingUUID=o,$(i.editorContainer).animate({scrollLeft:s},{complete:function(){null===l||void 0===l||l.reportReplay(Oe.s.SUCCESS,o,d),i.replayPendingVCAction()},fail:function(){var e="[".concat(Ne,"]: animate fail");null===l||void 0===l||l.reportReplay(Oe.s.FAIL,o,e,d),i.replayPendingVCAction(),Object(oe.N)("vc_action_apply_dev",{code:1,info:e,action:Ne,string_param_1:JSON.stringify(i.editorContainer.scrollLeft),string_param_2:JSON.stringify(r)})}})):null===l||void 0===l||l.reportReplay(Oe.s.IGNORE,o,"[".concat(Ne,"]: same scrollLeft"))}},i.setScrollLeft=function(e){e!==i.editorContainer.scrollLeft&&$(i.editorContainer).animate({scrollLeft:e})},i.getScrollLeft=function(){return i.editorContainer.scrollLeft},i.newLine=function(){var e=v()(d.a.mark((function e(n){var r,o,c,a,l,s,u,f,h,p,v,g,b;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=i.model,o=r.zoneState,c=r.zoneId,a=o.getModelText(),l=a.slice(0,n.start),s=l.lastIndexOf("\n")+1,u=l.slice(s).match(/^( +)/),f="\n",!u){e.next=17;break}h=0;case 8:if(!(h<=u[0].length)){e.next=16;break}if(p=new A.e({zoneId:c,editor:i.editor,start:h+s,len:1}).toRange(),!i.model.getAttributes(p.start,p.end).toMap()["inline-component"]){e.next=13;break}return e.abrupt("break",16);case 13:h++,e.next=8;break;case 16:f+=u[0].slice(0,h);case 17:return v=Object(ge.JI)(o,[n.start,n.start+n.len]),i.model.replaceEditorText(v,f,{}),g=i.model.zoneState.toAttributeText(),e.next=22,i.blockManager.applyTransaction("codeblock:key:enter",(function(e){Object(re.w)(e,i.record,g)}));case 22:b=n.start+f.length,i.model.setSelection(je(je({},n),{},{start:b,len:0}),!0);case 24:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i.handleTab=function(){var e=v()(d.a.mark((function e(n){var r,o,c,a,l,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.stopPropagation(),n.preventDefault(),o=null===(r=i.model.getSelection())||void 0===r?void 0:r.toPosition(),c=new Be.S(i.editor,i.model),a=c.indent(i.tabSize),l=a.reduce((function(e,n){return e+n}),0),o){e.next=8;break}return e.abrupt("return");case 8:s=je(je({},o),{},{start:o.start+i.tabSize,len:o.len+l-i.tabSize}),i.model.setSelection(s,!0);case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i.handleUnTab=function(){var e=v()(d.a.mark((function e(n){var r,o,c,a,l,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.stopPropagation(),n.preventDefault(),o=null===(r=i.model.getSelection())||void 0===r?void 0:r.toPosition(),c=new Be.S(i.editor,i.model),a=c.unindent(),l=a.reduce((function(e,n){return e+n}),0),a.length&&l&&o){e.next=8;break}return e.abrupt("return");case 8:s=je(je({},o),{},{start:o.start-a[0],len:o.len-l+a[0]}),i.model.setSelection(s,!0);case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i.onLanguageChange=function(e){i.isAutoDetectingLanguage=!1,i.setLanguage(e),Object(ae.w)(ce.G.codeLanguageSwitch,k()(i),i.blockManager,{actionValue:{value1:e}})},i.setLanguage=function(e){return localStorage.setItem(Se.i,e),i.blockManager.applyTransaction("codeblock:set-lang",(function(n){return n.replace(i.record.id,["language"],e)}))},i.handleCopy=function(){var e,n;"\n"!==i.model.zoneState.getModelText()&&(null===(e=i.editorContext.clipboard)||void 0===e||e.copyBlockText(i.id),ne.S.isMobile&&ne.S.isBytedanceApp?z.toastHelper.showToast({type:z.toastHelper.EToastType.SUCCESS,message:t("common.copied"),duration:1}):U.toast.success({type:"success",content:t("common.copied")}),Object(ae.w)(ce.G.codeCopy,k()(i),i.blockManager),i.selectionAPI.removeAllSelection(),null===(n=window.getSelection())||void 0===n||n.removeAllRanges())},i.runCalcLineGutter=function(){i.asyncCalc?i.asyncCalcLineGutter():i.syncCalcLineGutter()},i.calcLineGutter=Object(G.throttle)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;try{if(!i.containerRef.current)return;if(!i.lineHeight&&!i.getComputedStyle())return console.log("[codeblock] can't get lineHeight=".concat(i.lineHeight," retryTime=").concat(e," block=").concat(i.id)),void(e<2&&(window.cancelAnimationFrame(i.requestId),i.requestId=window.requestAnimationFrame((function(){i.calcLineGutter(e+1)}))));i.runCalcLineGutter()}catch(n){console.log(n)}}),100),i.onMouseEnter=function(){i.handleResizeLanguage(),i.isMouseEnter=!0,i.setState({headerVisible:!0})},i.onMouseOver=function(){i.handleResizeLanguage(),i.isMouseEnter=!0,i.setState({headerVisible:!0})},i.onMouseLeave=function(){i.isMouseEnter=!1,i.setState({headerVisible:i.isMouseEnter})},i.onFocus=function(){i._isFocus=!0},i.onBlur=function(){i._isFocus=!1},i.onWrapChange=function(){Object(ae.w)(ce.G.codeAutoWrap,k()(i),i.blockManager,{actionValue:{value1:String(!i.model.record.snapshot.wrap)}}),i.lineCountMap.clear(),setTimeout((function(){i.blockManager.applyTransaction("codeblock:set-wrap",(function(e){return e.replace(i.record.id,["wrap"],!i.model.record.snapshot.wrap)}))}),100)},i.onDropdownChange=function(e){i.setState({isDropdownVisible:e})},i.handleRemainWindowResize=Object(G.throttle)((function(){i.toggleIsWidthMin(),i.calcScrollStateToVc()}),100),i.showMobileLanguagePicker=function(){window.lark.biz.util.selectCodeBlockLanguage({value:i.model.record.snapshot.language||Se.E,list:Ce.l,callback:function(e){var n=e.value;i.onLanguageChange(n)}})},i.isShowDropDown=function(){return!me.r&&(i.isTextEditable&&(ne.S.isMobile||i.state.isWidthMin))},i.isShowCopy=function(){return!!i.props.recursionProps.copyable&&(!i.isTextEditable||!ne.S.isMobile&&!i.state.isWidthMin)},i.onMouseDownHeader=function(e){var n;ne.S.isMobile&&(e.stopPropagation(),e.preventDefault(),i.selectionAPI.removeAllSelection(),null===(n=window.getSelection())||void 0===n||n.removeAllRanges())},i.registerPlugins=function(){var e=k()(i),n=e.editor,r=e.blockManager,o=new le.S({editor:n,blockManager:r});return[].concat(s()(i.register()),[[F.X,{editor:n,logger:o}]])},ie.R.reportBlockLoadStage(ie.F.INIT,{id:i.model.id,time:(new Date).getTime(),type:i.model.type}),i}return x()(r,[{key:"onEditorInit",value:function(){T()(R()(r.prototype),"onEditorInit",this).call(this),this.bindEvent(!0)}},{key:"placeholder",get:function(){return""}},{key:"borderColor",get:function(){var e=this.props,n=e.selected,r=e.syncCursorSelected,o=e.syncCursorBorderColor;return!n&&r?o:void 0}}],[{key:"getChildrenRecordListFromBlockStruct",value:function(){return[]}}]),x()(r,[{key:"getEditorLineNum",value:function(){return this.model.zoneState.getModelText().split("\n").length-1||1}},{key:"blockViewDidMount",value:function(){T()(R()(r.prototype),"blockViewDidMount",this).call(this);var e=localStorage.getItem(Se.i);this.handleRemainWindowResize(),this.isAutoDetectingLanguage=!this.props.record.snapshot.language&&!e,this.setState({lineNum:this.getEditorLineNum()}),this.calcLineGutter(),this.registerVc(),Ee.S.getInstance().subscribeDestroy(this.blockManager)}},{key:"enterBuffer",value:function(){this.hasEnterBufferEver||(this.calcLineGutter(),this.hasEnterBufferEver=!0),this.lastVCAction&&this.replayHandler(this.lastVCAction)}},{key:"blockViewDidUpdate",value:function(e,n){var o=this;T()(R()(r.prototype),"blockViewDidUpdate",this).call(this,e,n),e.record.snapshot.language!==this.props.record.snapshot.language&&this.highlightCode();var i=this.getEditorLineNum();i!==this.state.lineNum&&this.setState({lineNum:i});var c=e.record.snapshot.wrap!==this.props.record.snapshot.wrap;(e.record.snapshot.text.initialAttributedTexts.text[0]!==this.props.record.snapshot.text.initialAttributedTexts.text[0]||c)&&setTimeout((function(){o.lineCountMap.clear(),o.calcLineGutter()})),!n.headerVisible&&this.state.headerVisible&&Object(ae.m)(se.H.HOVER_WHOLE,{record_id:this.record.id,block_type:this.props.type})}},{key:"blockViewWillUnmount",value:function(){var e,n,o;(T()(R()(r.prototype),"blockViewWillUnmount",this).call(this),null===(e=this.unregisterVc)||void 0===e||e.call(this),this.bindEvent(!1),this.lastVCAction=void 0,Object(ue.L)(this.calcLineGutterRICHandler),Object(ue.L)(this.setHighlightRICHandler),Ee.S.getInstance().clearHighlightTask(Object(ve.v)(this.props.blockId)),this.replayingUUID)&&(null===(n=this.vcController)||void 0===n||n.reportReplay(Oe.s.IGNORE,this.replayingUUID,"[".concat(Ne,"]: replaying action not finish until block unmount")),this.replayingUUID=void 0);this.pendingVCAction&&(null===(o=this.vcController)||void 0===o||o.reportReplay(Oe.s.IGNORE,this.pendingVCAction.uuid,"[".concat(Ne,"]: pending action not start until block unmount")),this.pendingVCAction=void 0)}},{key:"bindEvent",value:function(e){var n=this;e?(this.remainSpaceResizeObserver=new X.S((function(){n.handleRemainWindowResize()})),this.fullSpaceResizeObserver=new X.S((function(){n.handleResize()})),this.remainSpaceRef.current&&this.remainSpaceResizeObserver.observe(this.remainSpaceRef.current),this.fullSpaceRef.current&&this.fullSpaceResizeObserver.observe(this.fullSpaceRef.current)):(this.remainSpaceResizeObserver&&this.remainSpaceResizeObserver.disconnect(),this.fullSpaceResizeObserver&&this.fullSpaceResizeObserver.disconnect());var r=e?"on":"off",o=this.editor;o[r](P.L.CONTENT_CHANGE,this.handleContentChange),o[r](P.L.KEYDOWN,this.handleKeyDown,999),o[r](P.L.SCROLL,this.handleScroll)}},{key:"clearHighlight",value:function(){var e=this.model.zoneState.getModelText(),n=this.getClearHighlightDelta(0,e.length);this.model.apply(n,{extra:{shouldCollab:!1}})}},{key:"getClearHighlightDelta",value:function(e,n){var r,o=this.model.zoneState,i=o.getEntities({start:o.offsetToPoint(e),end:o.offsetToPoint(n)},(function(e){return e===Se.g})),c=new N.m({zoneId:this.model.zoneId}),a=0,l=we(i);try{for(l.s();!(r=l.n()).done;){var s=r.value,u=o.pointToOffset(s.start),d=o.pointToOffset(s.end);"number"===typeof u&&"number"===typeof d&&(c.retain(u-a).retain(d-u,h()({},Se.g,"")),a=d)}}catch(f){l.e(f)}finally{l.f()}return c}},{key:"getHighlightDelta",value:function(e,n,r){var o=new N.m({zoneId:this.model.zoneId}).retain(n),i=Object(Ie.S)();if(!i||!e||e===Se.E||Ce.V[e]===Se.E)return o;var c=this.model.zoneState.getModelText().slice(n,r);try{var l,s=i(c,e),u=0,d=we(s);try{for(d.s();!(l=d.n()).done;){var f=l.value,h=a()(f.range,2),p=h[0],v=h[1];o.retain(p-u).retain(v-p,f.mark),u=v}}catch(g){d.e(g)}finally{d.f()}}catch(b){console.warn(b)}return o}},{key:"updateHighlight",value:function(e,n){var r=this,o=this.model.zoneId,i=new N.m({zoneId:o}),c=[];n.changes[o].forEach((function(e){var n=e.inserts;n.length&&c.push({start:n[0].getOffset().start,end:n[n.length-1].getOffset().end})})),c.length&&c.forEach((function(n){var o=r.getHighlightDelta(e,n.start,n.end),c=r.getClearHighlightDelta(n.start,n.end);i=i.compose(c).compose(o)})),this.model.apply(i,{extra:{shouldCollab:!1}}),this.highlightAllCode(e)}},{key:"highlightAllCode",value:function(e){var n=this,r=this.model,o=r.zoneState.getModelText();if(this.asyncCalc){var i=this.getClearHighlightDelta(0,o.length),c=this.getHighlightDelta(e,0,o.length),l=i.compose(c);this.model.apply(l,{extra:{shouldCollab:!1}})}else Object(ue.L)(this.setHighlightRICHandler),Ee.S.getInstance().addHighlightTask({code:o,language:e,zoneId:Object(ve.v)(this.props.blockId),onLocalMarksReady:function(e){e.length||n.clearHighlight();var i=Se.D,c=0,l=0;n.setHighlightRICHandler=Object(ue.f)((function s(u){if(e.length){if(u.timeRemaining()>i&&!n.editor.getStatus("isComposing")){var d=Se.H,f=new N.m({zoneId:n.model.zoneId}),h=new N.m({zoneId:n.model.zoneId}).retain(0),p=0;for(c=l;d-- >0&&e.length;){var v=e.shift(),g=a()(v.range,2),b=g[0],y=g[1];h.retain(b-p).retain(y-b,v.mark),l=y,p=y}0===e.length&&(l=o.length);var m=n.getClearHighlightDelta(c,l);f=f.compose(m).compose(h),r.apply(f,{extra:{shouldCollab:!1}})}n.setHighlightRICHandler=Object(ue.f)(s)}else Object(ue.L)(n.setHighlightRICHandler)}))}})}},{key:"replayPendingVCAction",value:function(){if(this.replayingUUID=void 0,this.pendingVCAction){var e=this.pendingVCAction;this.pendingVCAction=void 0,this.replayHandler(e)}}},{key:"getComputedStyle",value:function(e){function n(){return e.apply(this,arguments)}return n.toString=function(){return e.toString()},n}((function(){if(this.containerRef.current){var e=this.containerRef.current.querySelector(".text-editor");if(e){var n,r=getComputedStyle(e),o=(n=Number(r.lineHeight.replace("px","")),Number(n.toFixed(0))),i=Object(fe.C)(e)?Object(fe.K)():1;return this.zoom=i,this.lineHeight=o*i,this.lineHeight}}}))},{key:"getNodeByLineCount",value:function(e,n){var r=q.a.createElement(q.a.Fragment,null,q.a.createElement("br",null),"\xa0");return[n+1].concat(new Array(e-1).fill(r))}},{key:"syncCalcLineGutter",value:function(){var e=this;Object(ue.L)(this.calcLineGutterRICHandler);var n=new Map,r=Object(pe.T)(this.model.zoneState).split("\n"),o=this.model.zoneState.lines,i=r.length||1,c=[],a=Se.f,l=0;this.calcLineGutterRICHandler=Object(ue.f)((function s(u){if(u.timeRemaining()>a){for(var d=Se.F;--d>0&&l<i;){var f=r[l],h=e.lineCountMap.get(f);if(h)c.push({value:e.getNodeByLineCount(h,l)}),n.set(f,h);else{var p=o[l];if(p._node){var v=p._node.getBoundingClientRect().height,g=Math.max(Math.round(v*e.zoom/e.lineHeight),1);c.push({value:e.getNodeByLineCount(g,l)}),n.set(f,g)}}l++}if(l===i){e.lineCountMap=n;var b=e.state.lineItems;return Object(G.isEqual)(b,c)||e.setState({lineItems:c},(function(){e.blockManager.layoutManager.didUpdateNode(e.id,!1)})),void Object(ue.L)(e.calcLineGutterRICHandler)}}e.calcLineGutterRICHandler=Object(ue.f)(s)}))}},{key:"asyncCalcLineGutter",value:function(){for(var e=this,n=new Map,r=Object(pe.T)(this.model.zoneState).split("\n"),o=this.model.zoneState.lines,i=r.length||1,c=[],a=0;a<i;){var l=r[a],s=this.lineCountMap.get(l);if(s)c.push({value:this.getNodeByLineCount(s,a)}),n.set(l,s);else{var u=o[a];if(u._node){var d=u._node.getBoundingClientRect().height,f=Math.max(Math.round(d/this.lineHeight),1);c.push({value:this.getNodeByLineCount(f,a)}),n.set(l,f)}}a++}if(a===i){this.lineCountMap=n;var h=this.state.lineItems;Object(G.isEqual)(h,c)||this.setState({lineItems:c},(function(){e.blockManager.layoutManager.didUpdateNode(e.id,!1)}))}}},{key:"toggleIsWidthMin",value:function(){var e,n,r=null===(e=this.fullSpaceRef.current)||void 0===e?void 0:e.offsetWidth,o=null===(n=this.languagePickerRef.current)||void 0===n?void 0:n.offsetWidth;this.setState({isWidthMin:!!r&&!!o&&r-o<200})}},{key:"getLineNumberMinWidth",value:function(){return 8*Object(pe.T)(this.model.zoneState).split("\n").length.toString().length+12}},{key:"renderComponent",value:function(e){var n=this,o=this.props,i=o.record,c=o.syncCursorBgColor,a=o.recursionProps,l=this.state,s=l.headerVisible,u=l.isWidthMin,d=l.isDropdownVisible,f=a.editable,h=Ce.V[this.model.language]||this.model.language,p=i.snapshot.wrap||!1,v=ne.S.isMobile,g=ne.S.isIPad,b=v||s;T()(R()(r.prototype),"setCustomEditorProps",this).call(this,{scrollFollowCaret:!0});var y=q.a.createElement(U.Menu,{className:"".concat(v||g?"code-menu-mobile":"code-menu")},q.a.createElement(U.Menu.Item,{onClick:this.handleCopy},q.a.createElement("span",null,q.a.createElement(Y.S,null),t("FeishuDocs_Admin_QuickInvite_ButtonText_Copy"))),q.a.createElement(U.Menu.Item,{onClick:this.onWrapChange},q.a.createElement("span",null,p?q.a.createElement(q.a.Fragment,null,q.a.createElement(Z.S,null)," ",t("sheet.cancel_auto_wrap")):q.a.createElement(q.a.Fragment,null,q.a.createElement(Q.S,null)," ",t("sheet.auto_wrap"))))),m="code-block-header";f||(m+=" uneditable");var _="code-wrap";this.isShowCopy()||(_+=" hide-divider");var k=this.renderChildren();return q.a.createElement(q.a.Fragment,null,q.a.createElement("div",{spellCheck:"false",className:V()("code-block old-code-block",{"code-mobile-block":v||g}),style:{borderColor:this.borderColor,backgroundColor:c},ref:this.containerRef,onMouseEnter:this.onMouseEnter,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,onFocus:this.onFocus,onBlur:this.onBlur},q.a.createElement("div",{contentEditable:"false",style:{userSelect:"none"}},q.a.createElement("div",{contentEditable:ne.S.isIOS?"inherit":"false",className:m,style:{visibility:b?"visible":"hidden"},onMouseDown:this.onMouseDownHeader},q.a.createElement("div",{ref:this.languagePickerRef},v||g&&ne.S.isLark?q.a.createElement(Te.S,{type:"text",onClick:this.showMobileLanguagePicker,className:"code-block-header-btn",disabled:!this.isTextEditable||me.r},q.a.createElement("span",null,h||Se.E),this.isTextEditable&&!me.r&&q.a.createElement(ee.S,null)):q.a.createElement(Ae,{languageList:Ce.l,value:h,editable:this.isTextEditable&&f,onSelect:this.onLanguageChange,getPopupContainer:function(){return n.popupContainer}})),q.a.createElement("div",{className:"full-space",ref:this.fullSpaceRef}),q.a.createElement("div",{className:"remain-space",ref:this.remainSpaceRef}),this.isTextEditable&&!v?q.a.createElement(Te.S,{type:"link",onClick:this.onWrapChange,className:_,style:{visibility:u?"hidden":"inherit"}},p?q.a.createElement(q.a.Fragment,null,q.a.createElement(Z.S,null)," ",t("sheet.cancel_auto_wrap")):q.a.createElement(q.a.Fragment,null,q.a.createElement(Q.S,null)," ",t("sheet.auto_wrap"))):"",!me.r&&this.isShowCopy()&&q.a.createElement(Te.S,{type:"link",onClick:this.handleCopy,className:"code-copy"},q.a.createElement(Y.S,null),t("FeishuDocs_Admin_QuickInvite_ButtonText_Copy")),this.isShowDropDown()&&q.a.createElement(U.Dropdown,{overlay:y,placement:"bottomRight",trigger:["click"],onVisibleChange:this.onDropdownChange},q.a.createElement(Te.S,{className:V()("code-dropdown",{hover:d})},q.a.createElement(J.S,null))))),q.a.createElement("div",{className:V()("code-block-content sophon-light-theme",{"code-wrap-content":p})},q.a.createElement("div",{className:"code-block-lines-gutter",style:{minWidth:this.getLineNumberMinWidth()},contentEditable:!1},this.state.lineItems.map((function(e,n){return q.a.createElement("span",{key:n},e.value)}))),T()(R()(r.prototype),"render",this).call(this))),e&&q.a.createElement(Le,{id:this.model.id,renderFinishCb:e,highlightCode:this.highlightCode}),k?q.a.createElement("div",{style:{paddingLeft:te.X}},k):null)}},{key:"renderZoneView",value:function(e){return q.a.createElement(L.Y,Object.assign({zoneId:this.model.zoneId,editor:this.editor,editable:this.editable,className:e.className,placeholder:this.placeholder,style:e.style,register:this.registerPlugins},this.customEditorProps))}},{key:"render",value:function(){var e=this;return this.props.recursionProps.isHistory?this.renderComponent((function(){return null})):q.a.createElement(be.h,{blockId:this.props.blockId,blockType:de.B.CODE,eventEmitter:this.props.recursionProps.eventEmitter,scheduler:this.scheduler,renderLoadingPlaceholder:function(){return e.renderComponent()},renderContent:function(n,r){return e.renderComponent(r)}})}},{key:"isShortcut",get:function(){return!0===this.props.recursionProps.isShortcut}},{key:"asyncCalc",get:function(){return this.isShortcut}},{key:"editorContainer",get:function(){return this.model.zoneState.getContainer()}}]),r}(he.N),e=i,o=j()(e.prototype,"scheduler",[ye.b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e)}).call(this,r("dx_E9Eu"))},dx_GH8q:function(e,n,r){"use strict";(function(t){r.d(n,"g",(function(){return y}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_cDcd"),p=r.n(h),v=r("dx_MGoZ"),g=r("dx_L0Lv");r("dx_F2FW");function b(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var y=function(e){l()(r,e);var n=b(r);function r(){return o()(this,r),n.apply(this,arguments)}return c()(r,[{key:"render",value:function(){if("inline"===this.props.displaymode)return p.a.createElement("div",{className:"fallback-block inline"},"[",t("block.placeholder.new_app"),"]");var e="fallback-block";return p.a.createElement("div",{className:e},p.a.createElement("div",{className:"".concat(e,"--left")},p.a.createElement(g.S,null)),p.a.createElement("div",{className:"".concat(e,"--right")},p.a.createElement("div",{className:"".concat(e,"--title")},p.a.createElement("div",null,t("block.placeholder.new_app")))))}}]),r}(v.l)}).call(this,r("dx_E9Eu"))},dx_GLPm:function(e,n,r){"use strict";(function(t){r.d(n,"Ut",(function(){return s})),r.d(n,"U",(function(){return u})),r.d(n,"a",(function(){return d})),r.d(n,"ak",(function(){return f})),r.d(n,"V",(function(){return h})),r.d(n,"h",(function(){return p})),r.d(n,"p",(function(){return v}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_bUYd"),c=r("dx_g0R0"),a=r("dx_sNGG"),l=r("dx_OPAz");function s(e,n){var r="confluenceTable",o=["ace-table"];if(['class="MsoTableGrid"',"<melo-data","copy-ghost-table-wrapper",r,'id="docs-internal-guid',r,'class="byte-bitable"','class="ql-sheet"',"data-shimo-docs"].some((function(e){return-1!==n.outerHTML.indexOf(e)})))return!1;var i=e.outerHTML;return!o.some((function(e){return-1!==i.indexOf(e)}))}function u(e){var n=null,r=null;if("string"===typeof e){var i=e.split(/_/,2),c=o()(i,2);n=c[0],r=c[1]}return{token:n,id:r}}function d(e){return e.map((function(e){var n=e.commentId,r=e.offsetTop;return{commentId:n,thirdPartyHeight:e.offsetHeight,relativeTopToThirdParty:r,quote:e.quote||""}}))}function f(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=e.getScrollStatus(),c=i.scrollLeft,a=i.scrollWidth,l=i.clientWidth,s=e.getScrollModel(),u=s.scrollItemMaxLeft;if(r){var d=a-l,f=d-c;f>0&&n.x+r+o-c+u>l&&e.executeScroll({scrollLeft:d})}}var h=function(e,n){var r=Array.from(n.allBlockModels).find((function(n){var r=n.record;return"sheet"===n.type&&r.snapshot.token.includes(e)}));return null===r||void 0===r?void 0:r.recordId};function p(e,n,r){var o,a=e.editorAPI.getService(l.H).bridge;if(a&&!a.beforePasteSheetBlock(n.styles,null===(o=n.html)||void 0===o?void 0:o.outerHTML,r))return Object(i.h)({content:t("common.operation_failed"),errorContext:Object(c.G)(new Error("beforePasteSheetBlock error"))}),!1;return!0}function v(e){e.emit(a.Y.THIRD_PARTY_CONTENT_CHANGE)}}).call(this,r("dx_E9Eu"))},dx_GPzN:function(e,n,r){"use strict";var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_UtDZ");function v(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var g=function(e){s()(r,e);var n=v(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"setProfileContext",value:function(e){p.performanceStageCollector.setProfileContext(e)}},{key:"setExtraData",value:function(e){p.performanceStageCollector.setExtraData(e)}},{key:"setOtherEventData",value:function(e,n){p.performanceStageCollector.setOtherEventData&&p.performanceStageCollector.setOtherEventData(e,n)}},{key:"updateStage",value:function(e,n){p.performanceStageCollector.updateStage(e,p.FILE_TYPE.DOCX,n)}},{key:"updateLoadMainStageDurationList",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Date.now();p.performanceStageCollector.updateLoadMainStageDurationList(e,n,r)}},{key:"updateLoadMainStageDurationListByNextRender",value:function(e,n){p.performanceStageCollector.updateLoadMainStageDurationListByNextRender(e,n)}},{key:"getStartTime",value:function(){return p.performanceStageCollector.getStartTime()}},{key:"updateStageByNextRender",value:function(e){return p.performanceStageCollector.updateStageByNextRender(e,p.FILE_TYPE.DOCX)}},{key:"runInNextRender",value:function(e){return p.performanceStageCollector.runInNextRender(e)}},{key:"setFirstScreenBlockLoaded",value:function(){p.performanceStageCollector.setFirstScreenBlockLoaded()}},{key:"setCatalogueLoaded",value:function(){p.performanceStageCollector.setCatalogueLoaded()}},{key:"renderFail",value:function(e){p.performanceStageCollector.renderFail(e)}},{key:"from",get:function(){return p.performanceStageCollector.from}}]),r}(r("dx_ABiD").E);n.S=new g},dx_GRYU:function(e,n,r){"use strict";r.d(n,"T",(function(){return a})),r.d(n,"J",(function(){return c}));var o;!function(e){e[e.TABLE=0]="TABLE",e[e.ROOT=1]="ROOT",e[e.FOLDABLE=2]="FOLDABLE",e[e.NORMAL=3]="NORMAL"}(o||(o={}));var i,c,a="lazy_record";!function(e){e.PRE_CONCURRENCY_FETCH_ENABLE="ccm_docx_clientvar_pre_concurrency_enable",e.FETCH_SLICE_CONFIG="docx_clientvar_fetch_slice_config",e.MOBILE_FETCH_SLICE_CONFIG="User.appConfig.clientvarFetchSliceConfig.concurrency"}(i||(i={})),function(e){e.PRE_CONCURRENCY_FETCH_OOPS="docx_concurrency_pre_fetch_oops",e.PRE_CONCURRENCY_FETCH_STATE="docx_concurrency_pre_fetch_state"}(c||(c={}))},dx_GWFd:function(e,n,r){"use strict";r.d(n,"F",(function(){return o})),r.d(n,"l",(function(){return i})),r.d(n,"c",(function(){return c}));var o=function(e,n){return Number("".concat(e).concat(n))},i=function(e,n){return Number(n.toString().replace(e.toString(),""))},c=function(e,n){return n.toString().startsWith(e.toString())}},dx_GXpI:function(e,n,r){"use strict";r.d(n,"r",(function(){return i})),r.d(n,"d",(function(){return c})),r.d(n,"j",(function(){return a})),r.d(n,"E",(function(){return l})),r.d(n,"S",(function(){return s}));var o=r("dx_fs49");function i(){var e=window.initialCatalogItems;return void 0===e?void 0:e}function c(){var e,n=null===(e=window.catalogRecordInfo)||void 0===e?void 0:e.headingRecords;return void 0===n?void 0:n}function a(){delete window.initialCatalogItems}function l(){delete window.catalogRecordInfo}function s(){var e=i(),n=c();return void 0!==e&&Object(o.u)(e)||!!n&&!Object.keys(n).length}},dx_Ga6P:function(e,n,r){"use strict";r.d(n,"N",(function(){return g}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_LcNA");function v(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var g=function(e){s()(r,e);var n=v(r);function r(e){var o;return i()(this,r),(o=n.call(this)).props=e,o.handleChange=function(e){o.props.onChange(e)},o.editor.on(p.L.CONTENT_CHANGE,o.handleChange),o}return a()(r,[{key:"destroy",value:function(){this.editor.off(p.L.CONTENT_CHANGE,this.handleChange)}},{key:"editor",get:function(){return this.props.editor}}]),r}(r("dx_N8Nu").o)},dx_GbKl:function(e,n,r){"use strict";(function(t){var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_B28d"),p=r("dx_NMQJ"),v=r("dx_jvIN"),g=r("dx_lROi");function b(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var y=function(e){l()(r,e);var n=b(r);function r(){var e;o()(this,r);for(var i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).blockManager=void 0,e.matches=null,e.findKeyword=void 0,e}return c()(r,[{key:"getText",value:function(){return t("CreationDoc_Docs_WebCard_CommentTitle")}},{key:"find",value:function(e){var n=this;if(this.matches&&this.findKeyword===e)return this.matches;var r=this.snapshot.bookmark.title;return r?(this.findKeyword=e,this.matches=Object(g.A)(r,e).map((function(r){return new v.j({blockId:n.id,key:e,blockManager:n.blockManager,range:[r.start,r.end]})})),this.matches):[]}}]),r}(p.D);y.type=h.B.BOOKMARK,n.S=y}).call(this,r("dx_E9Eu"))},dx_Geeh:function(e,n,r){"use strict";r.d(n,"A",(function(){return u}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c),l=r("dx_yzqx"),s=r("dx_TfZh"),u=(r("dx_TN5U"),a.a.forwardRef((function(e,n){var r,o=e.children,u=e.pollBlockContainer,d=Object(c.useState)(!1),f=i()(d,2),h=f[0],p=f[1],v=Object(c.useState)(!1),g=i()(v,2),b=g[0],y=g[1],m=Object(c.useMemo)((function(){return!(!h||b)}),[h,b]),_=Object(c.useRef)(null),k=Object(c.useRef)(null),O=Object(s.S)((function(){var e=_.current;if(e&&u){var n,r;e.clientHeight===e.scrollHeight&&(e=document.documentElement);var o=e.getBoundingClientRect(),i=u.getBoundingClientRect();if(i.top>o.bottom||i.bottom<0)return void(h&&p(!1));var c=null===(n=k.current)||void 0===n?void 0:n.getBoundingClientRect(),a=null===(r=u.querySelector(".poll-block-header__container"))||void 0===r?void 0:r.getBoundingClientRect();if(i&&c&&a){var l=c.bottom-8>=o.bottom&&a.bottom+54+c.height<=o.bottom;p(l)}}y(!1)}),300),x=Object(c.useCallback)((function(){b||y(!0),O()}),[b,O]);Object(c.useEffect)((function(){var e=document.querySelector(".bear-web-x-container");return _.current=e,null===e||void 0===e||e.addEventListener("scroll",x),l.S.isMobile&&window.addEventListener("scroll",x),function(){null===e||void 0===e||e.removeEventListener("scroll",x),l.S.isMobile&&window.removeEventListener("scroll",x)}}),[x]);var E=Object(c.useRef)(0),S=Object(c.useRef)(0),C=Object(s.S)((function(e){var n=(null===e||void 0===e?void 0:e[0].contentRect)||(null===u||void 0===u?void 0:u.getBoundingClientRect());n&&(n.top===E.current&&n.height===S.current||(E.current=n.top,S.current=n.height,x()))}),200);Object(c.useImperativeHandle)(n,(function(){return{resize:C}}));var I={width:(null===(r=k.current)||void 0===r?void 0:r.clientWidth)||0,opacity:m?1:0};return a.a.createElement("div",{ref:k,className:"poll-block__vote-footer"},a.a.createElement("div",Object.assign({className:"poll-block__vote-footer-content"},e)),h&&a.a.createElement("div",{className:"poll-block__vote-footer-content float",style:I},o))})))},dx_GgMS:function(e,n,r){"use strict";r.d(n,"P",(function(){return a}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=function(e,n){var r=n.blockManager,o=Object(c.useState)(null),a=i()(o,2),l=a[0],s=a[1];return Object(c.useEffect)((function(){if(e){var n=r.getBlockViewByBlockIdNotCheck(Number(e));s(n||null)}}),[e,r]),l}},dx_GnmH:function(e,n,r){"use strict";r.d(n,"y",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("record-snapshot-factory")},dx_GsbX:function(e,n,r){"use strict";r.d(n,"S",(function(){return d}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_SreQ"),a=r("dx_Fimk"),l=r("dx_B28d"),s=r("dx_bPy9"),u=[l.B.CODE],d=function e(n){var r=this;i()(this,e),this.blockManager=void 0,this.editor=void 0,this.loggable=function(e){var n=e.activeZone.getZoneId(),o=r.blockManager.getBlockModelByBlockId(Object(s.j)(n));return!(!o||!u.includes(o.type))},this.log=function(e){var n=e.zoneId,o=e.editType,i=e.zoneTextLength,u=e.zoneLinesLength,d=e.costTime,f=r.editor.getContentState().getZoneState(n),h=r.blockManager.getBlockModelByBlockId(Object(s.j)(n));if(f&&h&&h.type===l.B.CODE){var p=Object(c.i8)()?"editor_kit":"docx";Object(a.N)("ccm_docx_code_block_edit_dev",{edit_type:o,code_text_length:i,code_lines_length:u,cost_time:d,version:p})}};var o=n.blockManager,d=n.editor;this.blockManager=o,this.editor=d}},dx_GtBV:function(e,n,r){"use strict";(function(t){var e=r("dx_Xqee"),o=r("dx_PcQO"),i=r("dx_h6a8"),c=r("dx_cDcd"),a=r.n(c),l=r("dx_amgp"),s=r("dx_w0wQ"),u=r("dx_L41L"),d=r("dx_n3mc");r("dx_IUIF");n.S=function(n){var r=n.showScore,c=n.canEdit,f=n.canScore,h=n.weightType,p=n.showTooltip,v=n.hasKeyResults,g=n.score,b=n.weight,y=n.saveScore,m=n.onInputActive,_=n.onHoverScore,k=g/100||0,O=Object(s.q)(b||0),x=function(e){return e.closest(".okr-block")||document.body},E=function(e){e&&_()};return a.a.createElement(a.a.Fragment,null,r?!c||v&&h===l.k.KR?a.a.createElement(d.S,{style:{width:37,marginTop:6,marginLeft:8}},a.a.createElement(u.S,{inputWidth:37,value:k,editable:!1,hoverHint:Object(i.includes)([l.k.O,l.k.CLOSE],h)?t("CreationDoc_Docs_OKR_Score_Specs",{score:k,weight:O}):t("CreationDoc_Docs_OKR_Score_Objective_Tooltips"),showTooltip:p,onPreviewVisibleChange:E,getPopupContainer:x})):f||h!==l.k.KR?a.a.createElement(d.S,{style:{width:37,marginTop:6,marginLeft:8}},a.a.createElement(u.S,{inputWidth:35,value:k,onBlur:function(e){return y(100*e)},minValue:0,maxValue:1,hoverHint:Object(i.includes)([l.k.O,l.k.CLOSE],h)?t("CreationDoc_Docs_OKR_Score_Specs",{score:k,weight:O}):t("CreationDoc_Docs_OKR_Score_Tooltips"),rangeErrorHint:t("CreationDoc_Docs_OKR_Score_Score_Range"),onPreviewVisibleChange:E,getPopupContainer:x,onActive:m})):a.a.createElement(d.S,{style:{width:37,marginTop:6,marginLeft:8}},a.a.createElement("div",{className:"score cannot-edit-objective"},a.a.createElement(o.Tooltip,{title:t("CreationDoc_Docs_OKR_Score_Objective_Tooltips"),offset:13,disabled:!p,onVisibleChange:E},a.a.createElement(e.S,null)))):null)}}).call(this,r("dx_E9Eu"))},dx_GzEb:function(e,n,r){"use strict";r.d(n,"B",(function(){return p}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_jtB3"),s=r("dx_JWrU"),u=r("dx_GWFd"),d=r("dx_k8kI"),f=r("dx_B28d");function h(e){return Object(u.F)(s.S,e)}var p=function(){function e(){i()(this,e),this.type=f.B.GRID,this.caculateModelMap=new Map}return a()(e,[{key:"saveCalculateModel",value:function(e,n){this.caculateModelMap.set(e,n?l.j.HORIZONTAL:l.j.VERTICAL)}},{key:"deleteCalculateModel",value:function(e){this.caculateModelMap.delete(e)}},{key:"getCalculateModel",value:function(e,n){var r,o=null!==(r=this.caculateModelMap.get(e))&&void 0!==r?r:l.j.HORIZONTAL;return{calculateModel:o=n&&!n.show?l.j.IGNORE:o,splitCalculateModel:o===l.j.VERTICAL?l.j.IGNORE:o}}},{key:"getLayoutNodeConfig",value:function(e,n){return{calculateModel:this.getCalculateModel(e.id,n).calculateModel}}},{key:"iterateLayoutNodeChildren",value:function(e,n,r){var o=e.id,i=e.children,c=this.getCalculateModel(o,n).splitCalculateModel;i.forEach((function(e){r(e.id),r(h(e.id),{calculateModel:c,ignoreMarginCollapse:!0})}))}},{key:"insertChild",value:function(e,n,r,o){var i=e.getChangeNode(n.id),c=this.getCalculateModel(n.id,o).splitCalculateModel,a=r.position;e.insertChildRaw(i,2*a,r.id),e.insertChildrenRecursively(r);var l=h(r.id);i.modifications.push({childId:l,index:2*a+1,action:d.o.INSERT_CHILD,config:{calculateModel:c}}),e.getChangeNode(l).modifications.push({action:d.o.UPDATE_PARENT,parentId:i.nodeId}),this.updateChildrenNodes(e,n,c)}},{key:"removeChild",value:function(e,n,r,o,i){var c=e.getChangeNode(n.id),a=this.getCalculateModel(n.id,i).splitCalculateModel;c.modifications.push({childId:h(r.id),index:2*o+1,action:d.o.DELETE_CHILD,config:{calculateModel:a}}),e.removeChildRaw(c,2*o,r.id),e.removeChildrenRecursively(r),this.updateChildrenNodes(e,n,a)}},{key:"updateChildrenNodes",value:function(e,n,r){n.children.forEach((function(n){var o=n.id;e.addModification(o,{action:d.o.UPDATE});var i=h(o);e.addModification(i,{action:d.o.UPDATE}),e.getChangeNode(i).config={calculateModel:r}}))}}]),e}()},dx_H0Hj:function(e,n,r){"use strict";r.d(n,"w",(function(){return c}));var o=r("dx_UtDZ"),i=r("dx_xs2W");function c(e,n,r){if(e){if(e=Object(i.z)(e,!1),r&&Object(i.y)(n,e))return;var c=Object(o.getDocSecureLink)(e),a=Object(o.protectedOpenLink)(c,"_blank","noopener");Object(o.sendSecLinkClickEvent)(),a&&(a.opener=null)}}},dx_H1q2:function(e,n,r){"use strict";(function(t){r.d(n,"h",(function(){return m})),r.d(n,"S",(function(){return O})),r.d(n,"V",(function(){return x})),r.d(n,"H",(function(){return E})),r.d(n,"w",(function(){return S}));var e,o,i=r("dx_J4zp"),c=r.n(i),a=r("dx_lSNA"),l=r.n(a),s=r("dx_UtDZ"),u=r("dx_h6a8"),d=r("dx_a8pA"),f=r("dx_HbDg"),h=r("dx_S0qQ"),p=r("dx_neHd"),v=r("dx_DwtJ");function g(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function b(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?g(Object(r),!0).forEach((function(n){l()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}r.d(n,"x",(function(){return v.x}));var y={page:1e4,table_column:100,table_cell:2e3},m=b(b({},y),Object(s.getMinaConfig)("docx_block_count_limit",y)),_=(e={},l()(e,h.n.REFRESH,t("CreationDoc_DocX_Refresh_Button")),l()(e,h.n.COPY,t("CreationDoc_DocX_CopyContent_Button")),l()(e,h.n.CONTACT,t("CreationDoc_DocX_ContactSupport_Button")),l()(e,h.n.CANCEL,t("CreationDoc_DocX_NotSynced_dialog_cancel_btn")),l()(e,h.n.CREATE,t("CreationDoc_Alert_CopyAll_NewDocs_btn")),p.b),k=(o={},l()(o,d.y.BlockCountOverLimit,{title:t("CreationDoc_DocX_Block_UpperLimit_Dialog_Title"),content:t("CreationDoc_DocX_Block_UpperLimit_Dialog_Content",void 0,void 0,f.S.limitCount)}),l()(o,d.y.TooManyChildrenInBlock,{title:t("CreationDoc_DocX_Block_UpperLimit_Dialog_Title"),content:t("CreationDoc_Docs_Block_MaxReachedToast")}),l()(o,d.y.TooManyTableCell,{title:t("CreationDoc_DocX_Block_UpperLimit_Dialog_Title"),content:t("CreationDoc_Docs_InlineTable_SingleCellsTooMany",void 0,void 0,"".concat(m.table_cell))}),l()(o,d.y.TooManyTableColumn,{title:t("CreationDoc_DocX_Block_UpperLimit_Dialog_Title"),content:t("CreationDoc_Docs_InlineTable_SingleColumnsTooMany",void 0,void 0,"".concat(m.table_column))}),l()(o,d.y.TooManyCharsInOneText,{title:t("CreationDoc_DocX_OverBlockLimit_Title"),content:t("CreationDoc_DocX_OverBlockLimit")}),l()(o,d.y.TooOldPage,{title:t("CreationDoc_Docs_Refresh_Title"),content:t("CreationDoc_DocX_ErrorMessage1_desc")}),l()(o,d.y.CursorExpired,{title:t("CreationDoc_Docs_Refresh_Title"),content:t("CreationDoc_DocX_ErrorMessage1_desc")}),l()(o,d.y.DataMigrate,{title:t("CreationDoc_Docs_Refresh_Title"),content:t("CreationDoc_MultiGeo_900004230")}),l()(o,d.y.TooManyPageOperation,{content:t("CreationDoc_Docs_EditsOverload_Notification")}),l()(o,d.y.LoginRequired,{content:t("not_authorized.login_status_error")}),l()(o,v.x.PermissionDenied,{title:t("CreationDoc_Common_PermissionChanged_Title"),content:t("CreationDoc_Common_PermissionChangedToView_Content")}),l()(o,v.x.RefreshOnly,{content:t("CreationDoc_DocX_ErrorMessage1_desc")}),l()(o,v.x.ContactUs,{content:t("CreationDoc_DocX_ErrorMessage4_desc")}),o),O=function(e){var n=Object.entries(_).find((function(n){return c()(n,2)[1].includes(e)}));return n?n[0]:null},x=function(e,n,r){var o={title:t("CreationDoc_DocX_DocsWentWrong_Title"),content:t(r?"CreationDoc_DocX_ErrorMessage2_desc":"CreationDoc_DocX_ErrorMessage3_desc")},i=k[n]||k[e]||{};return b(b({},o),i)};function E(){var e="",n="";try{e=JSON.stringify(window.scm),n=JSON.stringify(window.scmDocx)}catch(r){console.warn("scm parse error: ",r)}return{scm:e,scmDocx:n}}function S(){var e=s.urlHelper.parseQuery(window.location.href),n=Object(u.get)(window,"scmdocx.stage");return["dev","vdx"].includes(n)||"1"===e.debug||!!Object(u.get)(window,"User.isDebugMode")}}).call(this,r("dx_E9Eu"))},dx_H2H4:function(e,n,r){"use strict";r.d(n,"e",(function(){return o})),r.d(n,"j",(function(){return h}));var o,i=r("dx_QILm"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_MUMK"),f=r("dx_j6ji");!function(e){e.onTextAlign="EditControllerOnTextAlign",e.onTextHighlight="EditControllerTextHighlight",e.onComment="EditControllerOnComment"}(o||(o={}));var h=function(){function e(n){l()(this,e),this.editController=n,this.collectParamas=null}return u()(e,[{key:"canEdit",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.editController.shouldSkipIntercept())return!0;this.collectParamas={handlerName:e,context:r};var i=!0;switch(e){case d.F.onBold:case d.F.onItalic:case d.F.onUnderline:case d.F.onStrikeThrough:case d.F.onInlineCode:i=this.interceptTextualKeyEvent(n,r);break;case d.F.onTab:case d.F.onUnTab:i=this.interceptTabKeyEvent(n,r);break;case o.onTextAlign:i=this.interceptAlignKeyEvent(n,r);break;case o.onTextHighlight:i=this.interceptHighlightKeyEvent(n);break;case o.onComment:i=this.interceptCommentKeyEvent(n);break;default:i=!0}return this.collectParamas=null,i}},{key:"interceptCollect",value:function(e,n){if(null!==this.collectParamas){var r=this.collectParamas,o=r.handlerName,i=r.context,c=null===i||void 0===i?void 0:i.source,a=void 0===(null===i||void 0===i?void 0:i.mouse)?"unknown":(null===i||void 0===i?void 0:i.mouse)?"tool":"keyboard";Object(f.A)({op_source:c||a,op_type:o,edit_type:n.type,interceptedRecord:e.record})}}},{key:"interceptKeyEvent",value:function(e,n,r){var o=this;return!n||((null===r||void 0===r?void 0:r.isSingleTextSelection)&&(n=[n[0]]),n.every((function(n){var r="function"===typeof e?e(n):e,i=r.actionBlock,a=void 0===i?n:i,l=c()(r,["actionBlock"]);if(!a)return!0;var s=o.editController.canBlockEdit(a.record,a.type,l);return s||o.interceptCollect(n,l),s})))}},{key:"interceptTextualKeyEvent",value:function(e,n){return this.interceptKeyEvent({type:"UPDATE_ATTRIBUTE",changedKey:"text",newValue:"unknown"},e,n)}},{key:"interceptAlignKeyEvent",value:function(e,n){return this.interceptKeyEvent((function(){return{type:"UPDATE_ATTRIBUTE",changedKey:"align",newValue:"unknown"}}),e,n)}},{key:"interceptTabKeyEvent",value:function(e,n){return this.interceptKeyEvent((function(e){var n;return{type:"DELETE_CHILD",index:e.model.position,actionBlock:null===(n=e.editorAPI.modelService.getBlockModelByBlockId(e.id))||void 0===n?void 0:n.parent}}),e,n)}},{key:"interceptCommentKeyEvent",value:function(e){return this.interceptKeyEvent({type:"UPDATE_ATTRIBUTE",changedKey:"comments",newValue:"unknown"},e)}},{key:"interceptHighlightKeyEvent",value:function(e){return this.interceptTextualKeyEvent(e)}}]),e}()},dx_H2HL:function(e,n,r){"use strict";r.d(n,"o",(function(){return E}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_TSYQ"),v=r.n(p),g=r("dx_cDcd"),b=r.n(g),y=r("dx_S3cA"),m=r("dx_CH2c");function _(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var k=function(e){s()(r,e);var n=_(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).handleMouseEnter=function(n){var r=n.currentTarget,o=r&&r.querySelector(e.props.containerSelector||".container"),i=r&&r.querySelector(e.props.textSelector||".text");if(o&&i){var c=i.offsetWidth>o.offsetWidth;o.setAttribute("title",c&&(e.props.title||i.textContent)||"")}},e}return a()(r,[{key:"render",value:function(){return b.a.cloneElement(this.props.children,{onMouseEnter:this.handleMouseEnter})}}]),r}(b.a.PureComponent),O=k;r("dx_bXsd");function x(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var E=function(e){s()(r,e);var n=x(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).setRef=function(n){var r,o;null===(r=(o=e.props).setTitleRef)||void 0===r||r.call(o,e.props.recordId,n)},e}return a()(r,[{key:"renderTitle",value:function(){return b.a.createElement("a",{href:"#".concat(this.props.recordId),className:v()("container catalogue__item-title",{"doc-title":0===this.props.sourceLevel})},b.a.createElement("span",{className:"text",ref:this.setRef},Object(y.A)()?b.a.createElement(m.c,{text:this.props.text}):this.props.text))}},{key:"renderLine",value:function(){return b.a.createElement("div",{className:"abstract-item-line"})}},{key:"render",value:function(){return b.a.createElement(O,null,b.a.createElement("li",{style:this.props.style,className:this.props.className,"data-id":this.props.recordId,"data-source-level":this.props.sourceLevel,onClick:this.props.onClick,onTouchStart:this.props.onTouchStart,onTouchEnd:this.props.onTouchEnd,onTouchMove:this.props.onTouchMove},this.props.isShowFull?this.renderTitle():this.renderLine()))}}]),r}(b.a.PureComponent)},dx_H6o9:function(e,n,r){"use strict";r.d(n,"A",(function(){return T})),r.d(n,"R",(function(){return D})),r.d(n,"T",(function(){return W}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_J4zp"),v=r.n(p),g=r("dx_TSYQ"),b=r.n(g),y=r("dx_cDcd"),m=r.n(y),_=r("dx_Pz0G"),k=r("dx_P5PS"),O=r("dx_luPr"),x=r("dx_M7MP"),E=r("dx_B28d"),S=r("dx_Vau3"),C=r("dx_YRGG");r("dx_khWp");function I(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var B="ssr-wrapper",T=function(e){return m.a.createElement("div",{className:"docx-block-loading-container docx-block-loading-container-block-loading",style:{height:e}},m.a.createElement(_.S,{displayMode:E.J.BLOCK}))},w=new Map;function R(e,n){var r=n.getPlaceholderStyle,o=n.displayMode,i=n.getAlign,c=n.renderComponent,a=n.renderLoadingBySelf,l=void 0!==a&&a,s=n.autoNotifyRenderFinish;return function(n){var a=n.record,u=n.recursionProps,d=n.model,f=n.blockId,h=!0;l&&(h=!1);var p=Object(y.useState)(h),g=v()(p,2),S=g[0],I=g[1],T=Object(y.useRef)(!1);T.current||(T.current=!0,O.R.reportBlockLoadStage(O.F.INIT,{id:d.id,time:(new Date).getTime(),type:d.type}));var R,M,j=a.snapshot.loadingDisplayMode||o;r&&(R=r(a.snapshot)),i&&(M=i(a.snapshot));var D=Object(y.useCallback)((function(){var e;null===(e=u.blockManager.editorAPI.getService(C.B))||void 0===e||e.onBlockReady(d.recordId)}),[u.blockManager.editorAPI,d.recordId]),A=Object(y.useCallback)((function(){I(!1),D()}),[D,I]),P=Object(y.useRef)(null),L=Object(y.useMemo)((function(){if(k.e.has(n.model.type))return w.get(n.model.recordId)}),[n.model.recordId,n.model.type]),N=L?null:m.a.createElement(_.S,{style:R,align:M,displayMode:j});Object(y.useLayoutEffect)((function(){if(P.current&&L){var e=document.createElement("div");e.classList.add(B),e.appendChild(L.dom.cloneNode(!0)),P.current.insertBefore(e,P.current.firstChild),P.current.style.height="".concat(L.height,"px"),n.recursionProps.blockManager.layoutManager.notifyRenderFinish(n.blockId)}}),[L]),Object(y.useLayoutEffect)((function(){if(k.e.has(d.type)&&P.current&&!S){var e=P.current.querySelector(".".concat(B));null===e||void 0===e||e.remove(),P.current.style.height=""}}),[S,d.type]),Object(y.useEffect)((function(){if(L&&!L.isFallback||!S){var e=L?S?[O.F.TTV,(null===L||void 0===L?void 0:L.isFallback)?Date.now():0]:[O.F.TTU,Date.now()]:[O.F.TTV,Date.now()],n=v()(e,2),r=n[0],o=n[1];Promise.resolve().then((function(){Object(x.p)((function(){O.R.reportBlockLoadStage(r,{id:d.id,time:o})}))}))}}),[L,S,n.model.id]);var F=Object(y.useState)(N),U=v()(F,2),H=U[0],V=U[1],W=Object(y.useRef)({hasUpdated:!1,wasFirstUpdate:!1}),z=Object(y.useRef)(!0);return Object(y.useLayoutEffect)((function(){s&&!S&&u.blockManager.layoutManager.notifyRenderFinish(f);var e=W.current;e.wasFirstUpdate&&(e.wasFirstUpdate=!1,s&&u.blockManager.layoutManager.notifyRenderFinish(f)),z.current?z.current=!1:u.blockManager.layoutManager.notifyNodeHeightChange(f)}),[S,H]),m.a.createElement("div",{className:b()("docx-block-loading-container",{"docx-block-loading-container-block-loading":S&&j===E.J.BLOCK&&!L}),ref:P},S?H:null,m.a.createElement("div",{style:S&&L?{visibility:"hidden"}:void 0},!1!==c&&m.a.createElement(e,Object.assign({},n,{loadingComponent:N,onBlockReady:A,isShowLoading:S,onLoadingShow:function(){return I(!0)},updateOuterLoadingComponent:function(e){var n=W.current;n.hasUpdated||(n.hasUpdated=!0,n.wasFirstUpdate=!0,D()),I(!0),O.R.blockLoadRecordsModify({id:d.id,isRetry:!0}),V(e)},blockSSRDom:null===L||void 0===L?void 0:L.dom}))))}}document.querySelectorAll("#ssrBox [data-record-id]").forEach((function(e){var n=e.dataset.blockType,r=e.dataset.recordId;if(k.e.has(n)){var o=null===e||void 0===e?void 0:e.classList.contains("block-ssr-fallback"),i=null===e||void 0===e?void 0:e.children[0];w.set(r,{dom:i,isFallback:o,height:i.getBoundingClientRect().height})}}));var M,j,D=function(e){s()(r,e);var n=I(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"getWrapper",value:function(e){return R(e,this.options)}}]),r}(S.A),A=r("dx_UtDZ"),P=r("dx_wbyu"),L=r("dx_TfZh"),N=r("dx_Fimk"),F=r("dx_EqZO"),U=r("dx_k8kI");function H(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}!function(e){e[e.default=0]="default",e[e.succ=1]="succ",e[e.fail=2]="fail"}(M||(M={})),function(e){e[e.init=0]="init",e[e.rendered=1]="rendered",e[e.done=2]="done"}(j||(j={}));var V=[E.B.TABLE],W=function(e){s()(r,e);var n=H(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"getWrapper",value:function(e){var n=this;return R((function(r){var o=r.onBlockReady,i=r.recordId,c=r.type,a=r.blockId,l=n.options.lazyRecord,s=Object(y.useRef)(j.init),u=Object(y.useState)(M.default),d=v()(u,2),f=d[0],h=d[1];function p(){s.current=j.done,console.log("=====hideLoading",i),null===o||void 0===o||o()}l||Object(N.N)(F.m.IS_UNDEFINED,{type:c,recordId:Object(A.encryptTea)(i)});var g=Object(y.useCallback)((function(e,r){if(!e||!r)return!1;for(var o=n.blockManager.getBlockModelsByRecordId(e)[0];o;){if(o.id===r)return!0;o=o.parent}return!1}),[]),b=function(e){if(e.taskId===i&&s.current!==j.done){if(s.current=j.rendered,n.blockManager.layoutManager.isBlockActive(a))return void p();g(e.hash,a)&&p()}},_=Object(y.useCallback)((function(e){if(s.current===j.rendered){var r;if(!e)return void p();var o=null===(r=n.blockManager.getRecordByBlockId(e))||void 0===r?void 0:r.id;(o===i||g(o,e))&&p()}}),[]),k=Object(L.S)((function(){return _()}),0),O=function(e){var o,a=e.fetchFn,l=e.taskId;if(l===i&&V.includes(c)){var s=m.a.createElement(P.S,{displayMode:E.J.BLOCK,onClickRetry:function(){var e;return null===(e=r.updateOuterLoadingComponent)||void 0===e||e.call(r,r.loadingComponent),a().then((function(){return h(M.succ)})).catch((function(e){n.eventEmitter.emit(F.R.CLIENTVAR_SLICE_SKIPPED_BLOCK_ERROR,{error:e,fetchFn:a,taskId:l})}))},blockError:{id:r.model.id,type:r.model.type}});h(M.fail),null===(o=r.updateOuterLoadingComponent)||void 0===o||o.call(r,s)}};return Object(y.useEffect)((function(){return n.eventEmitter.on(F.R.CLIENTVAR_SLICE_SKIPPED_BLOCK_ERROR,O),function(){n.eventEmitter.off(F.R.CLIENTVAR_SLICE_SKIPPED_BLOCK_ERROR,O)}}),[]),Object(y.useEffect)((function(){var e=n.blockManager.lazyRecordStatus,r=null===l||void 0===l?void 0:l.getTaskStatus(i);if(!l||(null===r||void 0===r?void 0:r.isDone())&&!(null===r||void 0===r?void 0:r.isFetchedErr())||(null===e||void 0===e?void 0:e.isSkipBlockDataApplied(i))||!(null===e||void 0===e?void 0:e.shouldShowLoading)&&f!==M.fail||l&&l.isPreEditableEnable()&&(null===e||void 0===e?void 0:e.isFirstScreen))p();else if(null===r||void 0===r?void 0:r.isFetchedErr()){var o=l.retryInfoMap.get(i);o&&O(o)}}),[]),Object(y.useEffect)((function(){return s.current!==j.done&&(n.eventEmitter.on(F.R.CLIENTVAR_RENDER_TASK_FINISH,b),n.eventEmitter.on(F.R.CLIENTVAR_SKIP_BLOCK_APPLIED,b),n.eventEmitter.on(F.R.CLIENTVAR_TABLE_BLOCK_TRIGGER_HIDE_LOADING,_),n.blockManager.addListener(U.Q,k,a)),function(){n.eventEmitter.off(F.R.CLIENTVAR_RENDER_TASK_FINISH,b),n.eventEmitter.off(F.R.CLIENTVAR_SKIP_BLOCK_APPLIED,b),n.eventEmitter.off(F.R.CLIENTVAR_TABLE_BLOCK_TRIGGER_HIDE_LOADING,_),n.blockManager.removeListener(U.Q,k,a)}}),[]),m.a.createElement(e,r)}),this.options)}}]),r}(D)},dx_H9H1:function(e,n,r){},dx_HA1r:function(e,n,r){"use strict";r.d(n,"b",(function(){return b})),r.d(n,"R",(function(){return y})),r.d(n,"q",(function(){return m})),r.d(n,"w",(function(){return _})),r.d(n,"L",(function(){return O})),r.d(n,"F",(function(){return x}));var o,i,c=r("dx_RIqP"),a=r.n(c),l=r("dx_lSNA"),s=r.n(l),u=r("dx_xWWg"),d=r("dx_Z2Zw"),f=r("dx_UtDZ"),h=r("dx_CkQe"),p=r("dx_B28d"),v=r("dx_x2xb");r.d(n,"n",(function(){return d.n})),r.d(n,"D",(function(){return d.D})),r.d(n,"B",(function(){return u.u}));var g,b=["]]","\u3011\u3011","))","\uff09\uff09"],y=["@","\uff20"],m=y.map((function(e){return{input:e,identifier:v.A.mentionAt,key:"@",validators:[function(e){return!/\w$/.test(e)},function(e,n){return!Object.hasOwnProperty.call(n[0].attributes,"link")}]}})),_=[p.B.CALLOUT,p.B.CODE,p.B.PROGRESS,p.B.QUOTE_CONTAINER],k=(o={},s()(o,d.n.USER,[f.TYPE_ENUM.USER]),s()(o,d.n.DOCS,[f.TYPE_ENUM.FILE,f.TYPE_ENUM.SHEET,f.TYPE_ENUM.BITABLE,f.TYPE_ENUM.MINDNOTE,f.TYPE_ENUM.BOX,f.TYPE_ENUM.SLIDE,f.TYPE_ENUM.WIKI,f.TYPE_ENUM.DOCX]),s()(o,d.n.GROUP,[f.TYPE_ENUM.CHAT]),o),O={ALL:[].concat(a()(k[d.n.USER]),a()(k[d.n.DOCS]),a()(k[d.n.GROUP])).sort((function(e,n){return e-n})).join(","),INLINE:[].concat(a()(k[d.n.USER]),a()(k[d.n.DOCS])).sort((function(e,n){return e-n})).join(",")},x=(i={},s()(i,f.TYPE_ENUM.FILE,u.u.DOC),s()(i,f.TYPE_ENUM.SHEET,u.u.SHEET),s()(i,f.TYPE_ENUM.BITABLE,u.u.BITABLE),s()(i,f.TYPE_ENUM.MINDNOTE,u.u.MINDNOTE),s()(i,f.TYPE_ENUM.BOX,u.u.FILE),s()(i,f.TYPE_ENUM.SLIDE,u.u.SLIDE),s()(i,f.TYPE_ENUM.WIKI,u.u.WIKI),s()(i,f.TYPE_ENUM.DOCX,u.u.DOCX),i);h.F.Divider;!function(e){e.at="at_btn",e.bracket="bracket_btn"}(g||(g={}))},dx_HLaa:function(e,n,r){"use strict";r.d(n,"D",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("mouse-event-service")},dx_HOeV:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("block-author-service")},dx_HRGQ:function(e,n,r){},dx_HSkh:function(e,n,r){"use strict";r.d(n,"P",(function(){return b}));var o,i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_UtDZ"),p=r("dx_AA3h"),v=r("dx_Fimk");!function(e){e[e.DOC_UPLOAD=0]="DOC_UPLOAD",e[e.DRIVE_UPLOAD=1]="DRIVE_UPLOAD"}(o||(o={}));var g=r("dx_Z1S2");var b=function(){function e(n,r,o,i){var c=this;u()(this,e),this.thumb=n,this.recordId=r,this.mountPoitnType=o,this.pageToken=i,this.cacheUploadParams=null,this.uploadParams=null,this.reuploadFile=function(){c.uploadParams&&c.upload(c.uploadParams)},window.addEventListener("online",this.reuploadFile)}return f()(e,[{key:"unbindEvent",value:function(){window.removeEventListener("online",this.reuploadFile)}},{key:"restoreUploadParams",value:function(){this.uploadParams=this.cacheUploadParams}},{key:"generateUploadParams",value:function(e){var n=this,r=this.thumb,i=r.uuid,c=r.src,a=r.fileName,l=r.fileSize,s=r.contentType;return{uuids:[i],url:"/space/api/box/upload/prepare/",file_url:c,doc_url:window.location.href,token:this.pageToken,contentType:s,multiparts:{token:this.pageToken,obj_type:h.NUM_SUITE_TYPE.DOCX},uploadType:o.DRIVE_UPLOAD,uploadParams:{mount_point:this.mountPoitnType,mount_node_token:this.recordId,extraParams:{drive_route_token:this.pageToken},size:l,name:a||""},fileName:a||"",callback:function(r){r&&r.code===g.n.no_network?n.restoreUploadParams():(n.uploadParams=null,n.unbindEvent(),e(r))}}}},{key:"uploadFile",value:function(){var e=l()(c.a.mark((function e(n){var r,o,i,a,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.thumb.uuid,o=p.toastHelper.showToast,i=p.toastHelper.EToastType,a=function(e){console.info("Uploader: upload callback uuid: ".concat(r)),e&&e.code&&(o({type:i.FAIL,message:g.w[e.code],duration:3}),Object(v.N)("docx_client_upload_file_error",e)),n(e)},l=this.generateUploadParams(a),this.cacheUploadParams=l,this.upload(l);case 6:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"upload",value:function(e){var n,r;console.info("Uploader: start upload, uuids: ".concat(null===(n=e.uuids)||void 0===n?void 0:n[0])),r=e,window.lark.biz.util.uploadFile(r)}}]),e}()},dx_HTwv:function(e,n,r){"use strict";r.d(n,"o",(function(){return p})),r.d(n,"N",(function(){return v})),r.d(n,"y",(function(){return g})),r.d(n,"p",(function(){return b})),r.d(n,"h",(function(){return y}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_h6a8"),a=r("dx_C7Cb"),l=r("dx_IdzY"),s=r("dx_Bs5u"),u=r("dx_bPy9"),d=r("dx_FHaN");function f(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function h(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?f(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function p(e,n){return{id:Object(a.S)(),type:e,data:n}}function v(e,n){return[{text:" ",mark:h(i()({},d.O,JSON.stringify(e)),n.mark),type:l.B.EMBED}]}function g(e){try{return e?JSON.parse(e):null}catch(n){console.log("inline component data parse error:",n)}return null}function b(e){var n=Object(u.G2)(e),r=Object(c.get)(n,"attributes.".concat(d.O));return r?g(r):null}var y=function(e,n){if(n){var r=e.snapshot[s.B];if(r&&"string"===typeof r)return r}return e.id}},dx_HWDJ:function(e,n,r){"use strict";r.d(n,"c",(function(){return x})),r.d(n,"F",(function(){return S})),r.d(n,"K",(function(){return C}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_MsqB"),m=r("dx_Z7aw"),_=r("dx_uLXv");function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var O=function(e){h()(r,e);var n=k(r);function r(e,o){var i;return s()(this,r),(i=n.call(this,"TaskInfo")).pageToken=e,i.userId=o,i}return d()(r,[{key:"doFetch",value:function(){var e=a()(i.a.mark((function e(n){var r,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.N)({todo_guids:n,doc_token:this.pageToken});case 2:if(r=e.sent,o=r.data,c=r.error,!o){e.next=7;break}return e.abrupt("return",o.docx_todos);case 7:throw c;case 8:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),r}(_.x);O.instance=void 0;var x=function(e,n){return O.instance&&O.instance.pageToken===e&&O.instance.userId===n||(O.instance=new O(e,n)),O.instance},E=function(e){h()(r,e);var n=k(r);function r(e,o){var i;return s()(this,r),(i=n.call(this,"TaskRecover")).pageToken=e,i.userId=o,i}return d()(r,[{key:"doFetch",value:function(){var e=a()(i.a.mark((function e(n){var r,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.NM)({recoverGuids:n,docToken:this.pageToken});case 2:if(r=e.sent,o=r.data,c=r.error,!o){e.next=7;break}return e.abrupt("return",o.saved_docx_todos);case 7:throw c;case 8:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),r}(_.x);E.instance=void 0;var S=function(e,n){return E.instance&&E.instance.pageToken===e&&E.instance.userId===n||(E.instance=new E(e,n)),E.instance};function C(e){return I.apply(this,arguments)}function I(){return(I=a()(i.a.mark((function e(n){var r,o,c,a,l,s,u,d,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.blockManager,o=n.recordIds,c=n.task,a=n.onBeforeTransaction,l={undoable:!1},e.next=4,r.applyTransaction("task-creating",(function(e){o.forEach((function(n){e.replace(n,["status"],y.TaskBlockStatus.Initializing)}))}),l);case 4:return e.next=6,Object(m.B)({new_docx_todo:c,doc_token:c.source.docx_token,doc_block_id:c.source.block_id});case 6:if(s=e.sent,u=s.data,d=s.error,!u){e.next=16;break}return f=u.saved_docx_todo,null===a||void 0===a||a(f),e.next=14,r.applyTransaction("task-created",(function(e){o.forEach((function(n){e.replace(n,["task_id"],f.guid),e.replace(n,["status"],y.TaskBlockStatus.Initialized)}))}),l);case 14:e.next=18;break;case 16:return e.next=18,r.applyTransaction("task-created-faild",(function(e){o.forEach((function(n){e.replace(n,["status"],y.TaskBlockStatus.Failed)}))}),l);case 18:return e.abrupt("return",{data:u,error:d});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},dx_HX5J:function(e,n,r){"use strict";function o(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e<1?"":new Array(e+1).join(n)}r.d(n,"Q",(function(){return o}))},dx_HbDg:function(e,n,r){"use strict";r.d(n,"S",(function(){return x}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_QxNg"),v=r("dx_cDcd"),g=r.n(v),b=r("dx_rQGm"),y=r("dx_H1q2"),m=r("dx_Fimk");function _(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return k(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function k(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function O(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var x=function(e){s()(r,e);var n=O(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"getEffect",value:function(){var e=this;return function(n){var o=n.recursionProps,i=o.blockManager,c=o.editable,a=g.a.useCallback((function(){r.toggleVisible(e.isShowNotice)}),[]);g.a.useEffect((function(){return i.recordManager.on(p.q.CHANGE,a),function(){i.recordManager.off(p.q.CHANGE,a)}}),[i,a]),g.a.useEffect((function(){c?r.toggleVisible(e.isShowNotice):r.toggleVisible(!1)}),[c]),g.a.useEffect((function(){return r.enable}),[])}}},{key:"noticeCount",get:function(){return r.limitCount-10}},{key:"isShowNotice",get:function(){if(!this.blockManager.editable||r.disabled)return!1;var e=this.noticeCount;if(this.blockManager.recordManager.getRecordMap().size>=this.noticeCount){var n,o=0,i=_(this.blockManager.allBlockModels);try{for(i.s();!(n=i.n()).done;){n.value;if(++o>=e)return!0}}catch(c){i.e(c)}finally{i.f()}return!1}return!1}}],[{key:"onVisibleChange",value:function(e){r.callbacks.add(e)}},{key:"offVisibleChange",value:function(e){r.callbacks.delete(e)}},{key:"toggleVisible",value:function(e){r.visible!==e&&(r.visible=e,r.callbacks.forEach((function(n){return n(e)})))}},{key:"disable",value:function(){r.disabled=!0}},{key:"enable",value:function(){r.disabled=!1}},{key:"collectNoticeVisible",value:function(){Object(m.N)("ccm_docs_toast_view",{sub_view:"docx_block_limit_exceeded"})}},{key:"collectCloseNotice",value:function(){Object(m.N)("ccm_docs_toast_click",{click:"close_toast",target:"none",sub_view:"docx_block_limit_exceeded",action_type:"active_close"})}},{key:"collectCreateNewDoc",value:function(){Object(m.N)("ccm_docs_toast_click",{click:"create_docs",target:b.o.CCM_DOCS_PAGE_VIEW,sub_view:"docx_block_limit_exceeded",action_type:"create_docx"})}},{key:"limitCount",get:function(){return y.h.page}}]),r}(r("dx_Vau3").A);x.visible=!1,x.disabled=!1,x.callbacks=new Set},dx_Hc56:function(e,n){},dx_HcsW:function(e,n,r){"use strict";r.d(n,"V",(function(){return p}));var o,i,c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_xjz2"),d=r("dx_bdma"),f=r("dx_B28d"),h=r("dx_YRGG"),p=Object(u.s)(h.h)((i=function(){function e(){a()(this,e),this.type=f.B.CODE}return s()(e,[{key:"fetchResource",value:function(){return Object(d.Q)()}},{key:"canPrefetchResource",value:function(){return!0}}]),e}(),o=i))||o},dx_HeF4:function(e,n,r){"use strict";var o;r.d(n,"u",(function(){return o})),function(e){e.MAIN_PC="pc",e.MAIN_MOBILE="mobile",e.HISTORY="history",e.SERVER="server",e.SHORTCUT="shortcut",e.PRESENTATION_MODE="presentation-mode",e.PREVIEW="preview"}(o||(o={}))},dx_HhFT:function(e,n,r){"use strict";(function(t){r.d(n,"m",(function(){return u})),r.d(n,"G",(function(){return d})),r.d(n,"f",(function(){return f})),r.d(n,"I",(function(){return h})),r.d(n,"A",(function(){return p}));var e=r("dx_UtDZ"),o=r("dx_cDcd"),i=r.n(o),c=r("dx_oWrv"),a="CreationDoc_ECM_NewContacts.BlockNotificationNotAllow",l="CreationDoc_ECM_NewContacts.BlockNotificationCancel",s="CreationDoc_ECM_NewContacts.BlockNotificationConfirmExternal";function u(n){var r=t("CreationDoc_ECM_NewContacts.BlockNotification.Toast").replace("{operate}",t("CreationDoc_ECM_NewContacts.BlockNotification.Mention")).replace("{users}",n).replace("{reason}",t("CreationDoc_ECM_NewContacts.BlockNotification.AdminSetting"));e.Toast.remove(a),e.Toast.show({key:a,type:"success",content:r,duration:3e3,closable:!1})}function d(n){return new Promise((function(r){var o;e.Toast.remove(l),o=e.getNotifyText&&Object(e.getIsWikiV2SuitePage)()?Object(e.getNotifyText)([n],Object(e.getCanInviteViewMemberPermType)()):t("CreationDoc_FeishuDocs_Mention_Notification_Toast",{},"",n),e.Toast.show({key:l,content:i.a.createElement("div",{className:"toast-confirm"},i.a.createElement("p",{className:"toast-text"},o),i.a.createElement("button",{type:"button",className:"toast-button",onClick:function(){e.Toast.remove(l),r(!0)}},t("common.undo"))),duration:c.Y,className:"permissionToast",cancelText:t("common.undo"),onClose:function(){return r(!1)}})}))}function f(n){return new Promise((function(r){var o=t("permission.invite_confirm",{},"",n);e.Toast.show({key:s,content:i.a.createElement("div",{className:"toast-confirm"},i.a.createElement("p",{className:"toast-text"},o),i.a.createElement("button",{type:"button",className:"toast-button",onClick:function(){e.Toast.remove(s),r(!1)}},t("common.confirm"))),duration:c.Y,className:"permissionToast",onClose:function(){return r(!0)}})}))}function h(n,r,o){return new Promise((function(c){var a={left:0,top:0,height:0,width:0};if(n instanceof HTMLElement){var l=n.getBoundingClientRect();a.left=l.x,a.top=l.y,a.height=l.height,a.width=l.width}else a=n;var s=a,u=s.left,d=s.top,f=s.height,h=s.width,p=i.a.createElement("span",{style:{position:"fixed",left:"".concat(u,"px"),top:"".concat(d,"px"),height:"".concat(f,"px"),width:"".concat(h,"px")}}),v=function(){c(!1),e.ShareConfirmWrap.remove()},g=window.setTimeout((function(){v()}),3e3);e.ShareConfirmWrap.showMentionShareConfirm({userInfo:{id:r,name:o},className:"mention-sheet atuser-share-popover",children:p,onConfirm:function(){c(!0),e.ShareConfirmWrap.remove()},onCancel:v,onPopoverMouseEnter:function(){g&&window.clearTimeout(g)},onPopoverMouseLeave:function(){g&&window.clearTimeout(g),g=window.setTimeout((function(){v()}),1e3)}})}))}function p(n,r){return new Promise((function(o){e.ShareConfirmWrap.showTodoCancelToast({userInfo:{id:n,name:r},onTodoConfirm:function(e){e.then((function(e){return void 0!==e&&o(!0),null})).catch((function(e){console.error(e)}))}})}))}}).call(this,r("dx_E9Eu"))},dx_HirW:function(e,n,r){"use strict";r.d(n,"t",(function(){return k})),r.d(n,"g",(function(){return O})),r.d(n,"w",(function(){return x})),r.d(n,"l",(function(){return S})),r.d(n,"mD",(function(){return C})),r.d(n,"lj",(function(){return I})),r.d(n,"lc",(function(){return B})),r.d(n,"I",(function(){return T})),r.d(n,"m",(function(){return w})),r.d(n,"A",(function(){return R})),r.d(n,"K",(function(){return M})),r.d(n,"F",(function(){return j})),r.d(n,"j",(function(){return D})),r.d(n,"H",(function(){return A})),r.d(n,"D",(function(){return P})),r.d(n,"Aj",(function(){return L})),r.d(n,"a",(function(){return N})),r.d(n,"J",(function(){return F}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_UtDZ"),a=r("dx_h6a8"),l=r("dx_C7Cb"),s=r("dx_B28d"),u=r("dx_PhLz"),d=r("dx_QBqw"),f=r("dx_FHaN"),h=r("dx_lSlT"),p=r("dx_ZG9w"),v=r("dx_zghO"),g=r("dx_UTG8"),b=r("dx_Y27Y");function y(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return m(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function m(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var _=["reference"],k="lark-record-clipboard",O="data-lark-record-data",x="data-lark-record-format";function E(e){if(Object(d.sH)(e))return Object(d.T)(e);var n=e.children||[],r=[];return Object(p.S)(e)&&(r=Object(p.W)(e)),n.concat(r)}function S(e){return function(e,n){if(!e)throw new Error("record id can not be empty, id=".concat(e));return{id:e,snapshot:n}}(e.source_block_id,Object(u.q)(e,!0))}function C(e,n){var r=e.getBlockModelByBlockId(n);return I(e,r.record.id)}function I(e,n){var r=e.getRecord(n).snapshot,o=i()({},n,{id:n,snapshot:r});if(_.includes(r.type))return o;var c,l=y(E(r));try{for(l.s();!(c=l.n()).done;){var s=c.value;Object.assign(o,I(e,s))}}catch(d){l.e(d)}finally{l.f()}if(!Object(p.S)(r))return o;var u=Object(a.cloneDeep)(r);return u.text=Object(p.M)(u.text,e),o[n].snapshot=u,Object(p.u)(r.text).forEach((function(e){if(e.source_block_id){var n=S(e);o[n.id]=n}})),o}function B(e,n){var r=!1;return e.forEach((function(e){var o=n.recordManager,i=n.getBlockModelByBlockId(e.id);o.traverse(i.recordId,(function(e){return!(e.snapshot.type===s.B.PENDING)||(r=!0,!1)}))})),r}function T(e){var n={},r={};return Object(p.j)(e,[f.k.DOC]).forEach((function(e){var o=e.data,i=o.token;if(o.file_type===c.TYPE_ENUM.DOCX){var a=h.S.getTitle(i),l=h.S.getUrl(i);n[i]=a,r[i]=l}})),{mention_page_title:n,external_mention_url:r}}function w(e){for(var n={},r={},o=0,i=Object.values(e);o<i.length;o++){var c=i[o];if(Object(p.S)(c.snapshot)){var a=T(c.snapshot.text),l=a.mention_page_title,s=a.external_mention_url;Object.assign(n,l),Object.assign(r,s)}}return{mention_page_title:n,external_mention_url:r}}function R(e){if(e){var n=e.mention_page_title,r=e.external_mention_url;h.S.updateTitles(n),h.S.updateUrls(r)}}function M(e){return e=(e=e||"").replace(/\t/g,"        ")}var j=function(e,n,r){var o=null;try{o=JSON.parse(e.getData(b.L.DOCX_TEXT)||e.getData(b.L.DOCX_RECORD))}catch(y){}if(!o)try{var i=e.getData(b.L.HTML);if(i){var c=(new DOMParser).parseFromString('<div id="block-root">'.concat(i,"</div>"),"text/html").querySelector(".".concat(k));if(c){var l,u,d=null!==(l=c.getAttribute(O))&&void 0!==l?l:"",f=null!==(u=c.getAttribute(x))&&void 0!==u?u:"";[b.L.DOCX_TEXT,b.L.DOCX_RECORD].includes(f)&&(o=JSON.parse(d))}}}catch(y){}if(!o||!o.rootId||!Object(a.isBoolean)(o.isCut))return{pasteInSamePage:!1,applyFrom:s.G.outerCopyPaste};var h=o,p=h.rootId,v=h.isCut,g=n.getBlockModelByBlockId(r).root.recordId===p;return{pasteInSamePage:g,applyFrom:g?v?s.G.innerCutPaste:s.G.innerCopyPaste:v?s.G.outerCutPaste:s.G.outerCopyPaste,parseData:o}};function D(e,n){var r=[];function o(e){return{id:Object(l.S)(),snapshot:{text:g.InputPipe.deserialize({alltext:e,size:e.length,nodes:[{text:e}]}),type:s.B.TEXT}}}n.type===s.B.CODE?r.push(o(e)):e.split("\n").filter((function(e){return""!==e.trim()})).forEach((function(e){r.push(o(e))}));var i={};return{recordIds:r.map((function(e){var n=e.id;return i[n]=e,n})),payloadMap:{},recordMap:i}}function A(e,n,r){function o(e,i,c,a){var l=r(e,a);if(l){var s=l.remove,u=void 0!==s&&s,d=l.stop,f=void 0!==d&&d;if(u){var h=c.findIndex((function(n){return n===e}));return void c.splice(h,1)}if(f)return}var p=E(i);p.forEach((function(r){o(r,n[r].snapshot,p,e)}))}e.forEach((function(r){o(r,n[r].snapshot,e)}))}function P(){c.store.dispatch(c.actions.permission.copyTextWithoutPermission())}function L(e){var n="<([^>\\/]+)>",r="<\\/([^>]+)>",o=new RegExp("".concat(n,"\\n+\\s+?").concat(n),"g"),i=new RegExp("".concat(r,"\\n+\\s+?").concat(n),"g"),c=new RegExp("".concat(r,"\\n+\\s+?").concat(r),"g"),a=new RegExp("[\\r\\n]+","g");return e.replace(a,"\n").replace(o,"<$1><$2>").replace(i,"</$1><$2>").replace(c,"</$1></$2>").replace(c,"</$1></$2>")}function N(e,n){var r=n.getBlockModelByBlockId(e[0]).previous;if(!r)return null;if(r.isTextBlock){var o=Object(p.T)(r.zoneState);return{id:r.id,position:o.length,type:v.j.TEXT}}return{id:r.id,type:v.j.BLOCK}}function F(e,n){if(!e)return null;var r,o=e.id,i=e.recordId,c=e.position,a=void 0===c?0:c,l=e.type,s=void 0===l?v.j.TEXT:l;if(o?r=o:i&&(r=n.getBlockModelsByRecordId(i)[0].id),!r)return null;var u={type:s,id:r};return s===v.j.TEXT&&(u.selection={start:a,end:a}),u}},dx_HlLk:function(e,n,r){"use strict";(function(t){r.d(n,"l",(function(){return p}));var e=r("dx_MJn2"),o=r("dx_cyoC"),i=r("dx_UtDZ"),c=r("dx_xlCA"),a=r("dx_gDjg"),l=r("dx_VXLZ"),s=r("dx_pzI1"),u=r("dx_Svtu"),d=r("dx_ixLp");function f(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return h(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function h(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var p=function(n){var r=Object(u.f)(),h={element_entity_ref:{}};return n&&!function(n){return new e.h(n.zoneId,n).isEmpty()}(n)&&n.eachLine((function(e){var n=Object(u.z)([]);Object(u.t)(r,"",n);var p,v=f(e.ops);try{for(v.s();!(p=v.n()).done;){var g=p.value;if(g.attributes&&g.attributes.lmkr);else{var b,y;if(null===(b=g.attributes)||void 0===b?void 0:b.dataMetaBlockProps){try{var m=JSON.parse(g.attributes.dataMetaBlockProps);if(m.blockType===s.X){var _,k,O=null===(_=m.props.data)||void 0===_||null===(k=_.user)||void 0===k?void 0:k.id;Object(u.t)(r,n.id,Object(u.k)({user_id:O,content:c.n.getUserShowName(O)||""}))}else if(m.blockType===l.Z){var x,E,S,C,I=null===(x=m.props)||void 0===x?void 0:x.token,B=null===(E=m.props)||void 0===E?void 0:E.title,T=null===(S=m.props)||void 0===S?void 0:S.type;(B=Object(a.J)({token:I,type:T,title:B}))!==Object(i.getUnnamedTitle)(T)&&B!==t("common.unnamed_document")||(B="");var w=Object(d.R)(T),R=decodeURIComponent((null===(C=m.props)||void 0===C?void 0:C.link)||""),M=Object(u.S)({href:R,content:B||"Untitled"});Object(u.t)(r,n.id,M),h.element_entity_ref[M.id]={title:B,doc_type:w,doc_token:I,str_doc_type:"unknown"}}}catch(N){}continue}var j=null===(y=g.attributes)||void 0===y?void 0:y[o.Q.KEY];if(j)try{var D=JSON.parse(j),A=decodeURIComponent(D.href||""),P=Object(u.S)({href:A,content:g.insert||""});Object(u.t)(r,n.id,P);continue}catch(N){}var L="string"===typeof g.insert?g.insert:"";if("\n"===L[L.length-1]&&(L=L.slice(0,-1)),!L||!L.trim()&&1===e.ops.length)continue;Object(u.t)(r,n.id,Object(u.w)(L))}}}catch(F){v.e(F)}finally{v.f()}})),{rich_text:r,doc_entity:h}}}).call(this,r("dx_E9Eu"))},dx_HnEY:function(e,n,r){"use strict";(function(t){var e=r("dx_PcQO"),o=r("dx_wy2R"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c);r("dx_iboZ");n.S=function(n){var r=n.deadline,o=n.style,c=i()(r).format("MM-DD");return a.a.createElement(e.Tooltip,{title:t("CreationDoc_Docs_OKR_Deadline_Tooltips"),offset:8},a.a.createElement("span",{style:o,className:"okr-deadline"},c))}}).call(this,r("dx_E9Eu"))},dx_HpeV:function(e,n,r){"use strict";r.d(n,"k",(function(){return a}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_UTG8");function a(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,1/0],r=arguments.length>2?arguments[2]:void 0,o=c.InputPipe.serialize(e),a=i()(n,2),l=a[0],s=a[1],u=0,d=0,f="",h=o.nodes.reduce((function(e,n){var o=n.text.length,i=u+o,c=u;if(l>i||s<c)return u+=o,e;var a=n.text.substring(Math.max(l-u,c-u),Math.min(s-u,i-u)),h=n.mark;h&&r&&(h=r(h));var p={text:a,mark:h};return d+=a.length,f+=a,u+=o,e.push(p),e}),[]);return c.InputPipe.deserialize({alltext:f,size:d,nodes:h})}},dx_HqbJ:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_TSYQ"),m=r.n(y),_=r("dx_h6a8"),k=r("dx_O4O8"),O=r.n(k),x=r("dx_D8nn"),E=r("dx_viBb"),S=r("dx_lpLe");function C(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function I(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?C(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var B=function(){function e(){s()(this,e),this.currentKey="",this.itemNormal=null,this.itemHasSubmenu=null,this.hideTimer=null,this.showTimer=null}return d()(e,[{key:"clearHideTimer",value:function(){this.hideTimer&&(window.clearTimeout(this.hideTimer),this.hideTimer=null)}},{key:"clearShowTimer",value:function(){this.showTimer&&(window.clearTimeout(this.showTimer),this.showTimer=null)}},{key:"triggerHideSubmenu",value:function(e){var n=this;if(this.itemHasSubmenu){var r=this.itemHasSubmenu.onHide,o=function(){r(),n.itemHasSubmenu=null};if(this.clearShowTimer(),e)return o(),void this.clearHideTimer();this.hideTimer||(this.hideTimer=window.setTimeout((function(){o(),n.hideTimer=null}),200))}}},{key:"triggerShowSubmenu",value:function(){var e=this;if(this.itemHasSubmenu&&!this.itemHasSubmenu.visible&&!this.showTimer){var n=this.itemHasSubmenu,r=n.onShow;this.showTimer=window.setTimeout((function(){r(),n.visible=!0,e.showTimer=null}),100)}}},{key:"clearSubmenuDelayCallbackIfNecessary",value:function(){var e;(null===(e=this.itemHasSubmenu)||void 0===e?void 0:e.key)!==this.currentKey&&this.leaveItem()}},{key:"leaveItem",value:function(){return this.triggerHideSubmenu(!0)}},{key:"willLeaveItem",value:function(){return this.triggerHideSubmenu(!1)}},{key:"enterItemNormal",value:function(e){this.currentKey=e,this.itemNormal={key:e},this.willLeaveItem()}},{key:"enterItemHasSubmenu",value:function(e){var n;this.clearHideTimer(),this.currentKey=e.key,(null===(n=this.itemHasSubmenu)||void 0===n?void 0:n.key)!==e.key&&(this.clearSubmenuDelayCallbackIfNecessary(),this.itemHasSubmenu=I(I({},e),{},{visible:!1})),this.triggerShowSubmenu()}},{key:"submenuIsShow",get:function(){var e,n;return!(!this.currentKey||this.currentKey===(null===(e=this.itemNormal)||void 0===e?void 0:e.key))&&!(!this.showTimer&&!(null===(n=this.itemHasSubmenu)||void 0===n?void 0:n.visible))}}]),e}(),T=r("dx_CkQe"),w=r("dx_JUlI");function R(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function M(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?R(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function j(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var D=function(e){h()(r,e);var n=j(r);function r(){var e;s()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).state={activeIndex:e.props.autoSelect?Object(w.X)(e.props.items,-1,"next"):-1,inScroll:!1},e.eventEmitter=new O.a,e.submenuManager=new B,e.leaveTimer=null,e.mouseModeRef={current:!1},e.subMenuRef=null,e.menuRef=null,e.setSubMenuRef=function(n){e.subMenuRef=n},e.itemEleMap=new Map,e.setItemRef=function(n,r){r?e.itemEleMap.set(n,r):e.itemEleMap.delete(n)},e.setMenuRef=function(n){var r,o;e.menuRef=n,null===(r=(o=e.props).getRef)||void 0===r||r.call(o,n)},e.handleClosePanel=function(){var n,r,o,i;e.submenuHasShown||(e.isRootMenu?null===(n=(r=e.props).onClose)||void 0===n||n.call(r):null===(o=(i=e.props).onSelfClose)||void 0===o||o.call(i))},e.isInWheel=!1,e.debouncedResetInWheelStatus=Object(_.debounce)((function(){e.isInWheel=!1}),100),e.handleWheel=function(n){n.stopImmediatePropagation(),e.isInWheel=!0,e.debouncedResetInWheelStatus()},e.handleKeyDown=function(n){if(e.submenuHasShown&&e.subMenuRef)e.subMenuRef.handleKeyDown(n);else if(!(n.shiftKey||n.ctrlKey||n.metaKey||n.altKey))switch(n.keyCode){case E.C.DOWN:if(e.props.keyboard===T.c.vertical)return;var r=Object(w.X)(e.props.items,e.state.activeIndex,"next");if(e.state.activeIndex!==r){var o=e.state.activeIndex>=0&&e.itemEleMap.get(r),i=o&&Object(w.l)(o,Object(w.T)("panel-menu-item"));i&&Object(w.W)(i,E.M),e.setState({activeIndex:r})}else e.state.activeIndex<0&&e.setState({activeIndex:0});e.mouseModeRef.current=!1,n.stopImmediatePropagation(),n.preventDefault();break;case E.C.UP:if(e.props.keyboard===T.c.vertical)return;var c=Object(w.X)(e.props.items,e.state.activeIndex,"prev");if(e.state.activeIndex!==c){e.setState({activeIndex:c});var a=e.state.activeIndex>=0&&e.itemEleMap.get(c),l=a&&Object(w.l)(a,Object(w.T)("panel-menu-item"));l&&Object(w.W)(l,E.M)}e.mouseModeRef.current=!1,n.stopImmediatePropagation(),n.preventDefault();break;case E.C.LEFT:var s,u;if(e.props.keyboard===T.c.horizontal)return;if(n.stopImmediatePropagation(),n.preventDefault(),e.submenuHasShown)return;e.mouseModeRef.current=!1,null===(s=(u=e.props).onSelfClose)||void 0===s||s.call(u);break;case E.C.RIGHT:if(e.props.keyboard===T.c.horizontal)return;if(n.stopImmediatePropagation(),n.preventDefault(),e.submenuHasShown)return;e.isSubmenu(e.getActiveMenuItem())&&(e.mouseModeRef.current=!1,e.manualTriggerItemEnter(!0));break;case E.C.RETURN:if(e.submenuHasShown)return;if(n.stopPropagation(),n.stopImmediatePropagation(),n.preventDefault(),e.noItemCanSelect())return void e.handleClosePanel();var d,f,h=e.getActiveMenuItem();if(Object(w.k)(h))null===(d=(f=e.props).onItemClick)||void 0===d||d.call(f,h,n)}},e.debouncedResetHoverDisabled=Object(_.debounce)((function(){e.setState((function(){return{inScroll:!1}}))}),100),e.throttledSetInScroll=Object(_.throttle)((function(){e.isInWheel&&e.setState((function(){return{inScroll:!0}}),(function(){e.submenuManager.leaveItem()}))}),80),e.handleScroll=function(n){n.stopPropagation(),e.eventEmitter.emit(x.p.COMMON.HIDE_GUIDE_POPOVER),e.throttledSetInScroll(),e.debouncedResetHoverDisabled()},e.handleHoverActive=function(n){if(!(n<0)){var r=e.props.items[n];return r&&!1!==r.canSelected?(e.setState({activeIndex:n}),e.clearLeaveTimer(),void e.handleItemActive(r)):void 0}e.setState({activeIndex:n})},e.handleStatusRefresh=function(){var n,r;null===(n=(r=e.props).onRefresh)||void 0===n||n.call(r)},e.handleItemClick=function(n,r){var o,i,c,a;e.isRootMenu||(null===(c=(a=e.props).onSelfClose)||void 0===c||c.call(a,!0));null===(o=(i=e.props).onItemClick)||void 0===o||o.call(i,n,r)},e.handleMouseLeave=function(){var n,r,o=e.props,i=o.autoSelect,c=o.vertical,a=o.forbiddenInactiveOnMouseLeave,l=o.closeAfterMouseLeave;null===(n=(r=e.props).onMouseLeave)||void 0===n||n.call(r),l?e.handleClosePanel():i||a||c||(e.clearLeaveTimer(),e.leaveTimer=setTimeout((function(){e.submenuHasShown||e.setState({activeIndex:-1})}),200))},e.handleItemActive=function(n){var r,o;null===(r=(o=e.props).onItemActive)||void 0===r||r.call(o,n)},e.handleMouseEnter=function(){var n,r;null===(n=(r=e.props).onMouseEnter)||void 0===n||n.call(r)},e.clearLeaveTimer=function(){e.leaveTimer&&(clearTimeout(e.leaveTimer),e.leaveTimer=null)},e.handleMouseMove=function(){e.mouseModeRef.current=!0},e.handleMouseDown=function(e){e.preventDefault()},e.renderIMenuItem=function(n){return function(r,o){var c=o===e.state.activeIndex,a=e.props,l=a.onClose,s=a.blockManager,u=a.selectionAPI,d=a.boundary;return i.a.createElement(S.S,{item:r,index:o,key:"".concat(r.name,"-").concat(o),hovered:c,onItemHover:e.handleHoverActive,setMenuRef:e.setSubMenuRef,setItemRef:e.setItemRef,onItemClick:e.handleItemClick,isRootMenuItem:e.isRootMenu,vertical:n,onClose:l,showIconColor:e.props.showIconColor,submenuManager:e.submenuManager,eventEmitter:e.eventEmitter,onRefresh:e.handleStatusRefresh,blockManager:s,selectionAPI:u,boundary:d,mouseModeRef:e.mouseModeRef})}},e}return d()(r,[{key:"isSubmenu",value:function(e){return!!e&&Object(w.f)(e)}},{key:"getActiveMenuItem",value:function(){var e=this.state.activeIndex;return e<0?null:this.props.items[e]}},{key:"manualTriggerItemEnter",value:function(e){var n=this.getActiveMenuItem();n&&this.eventEmitter.emit(e?E.Z:E.g,n.name)}},{key:"componentDidMount",value:function(){var e,n,r;null===(e=(n=this.props).setMenuRef)||void 0===e||e.call(n,this),null===(r=this.menuRef)||void 0===r||r.addEventListener("wheel",this.handleWheel)}},{key:"componentWillUnmount",value:function(){var e,n,r;null===(e=(n=this.props).setMenuRef)||void 0===e||e.call(n,null),null===(r=this.menuRef)||void 0===r||r.removeEventListener("wheel",this.handleWheel),this.debouncedResetHoverDisabled.cancel()}},{key:"componentDidUpdate",value:function(){if(this.props.autoSelect){var e=Object(w.Y)(this.props.items),n=this.state.activeIndex;if(n>0){if(0===e.length)this.setState({activeIndex:-1});else if(!e.includes(n)){var r=e[0];this.setState({activeIndex:r})}}else if(-1===n&&0!==e.length){var o=e[0];this.setState({activeIndex:o})}}}},{key:"noItemCanSelect",value:function(){return this.props.items.every((function(e){return!1===e.canSelected}))}},{key:"render",value:function(){var e=this.props,n=e.style,r=e.vertical,o=void 0!==r&&r,c=this.state.inScroll;return i.a.createElement("div",{tabIndex:0,ref:this.setMenuRef,style:M(M({outline:"transparent"},n),{},{maxHeight:this.props.maxHeight}),onMouseDown:this.handleMouseDown,className:m()(E.N,"docx-menu-wrapper-animation","ud-scrollbar",this.props.className,{"menu-align-vertical":o,"menu-align-horizontal":!o,"in-scroll":c}),onScroll:this.handleScroll,onMouseLeave:this.handleMouseLeave,onMouseEnter:this.handleMouseEnter,onMouseMove:this.handleMouseMove},i.a.createElement("div",{className:m()("docx-menu-container")},this.props.items.map(this.renderIMenuItem(o))))}},{key:"submenuHasShown",get:function(){return this.submenuManager.submenuIsShow}},{key:"isRootMenu",get:function(){return!this.props.onSelfClose}}],[{key:"getDerivedStateFromProps",value:function(e,n){return-1===n.activeIndex&&e.autoSelect?{activeIndex:e.autoSelect?Object(w.X)(e.items,-1,"next"):-1}:null}}]),r}(i.a.Component),A=D;r("dx_hvuK"),n.S=function(e){var n=e.keyboard,r=Object(o.useRef)(null),c=Object(o.useCallback)((function(e){r.current=e}),[]),a=Object(o.useCallback)((function(e){var n;null===(n=r.current)||void 0===n||n.handleKeyDown(e)}),[]);return Object(o.useEffect)((function(){if(!1!==n)return document.addEventListener("keydown",a,!0),function(){document.removeEventListener("keydown",a,!0)}}),[n]),i.a.createElement(A,Object.assign({setMenuRef:c},e))}},dx_HsgL:function(e,n,r){"use strict";r.d(n,"M",(function(){return d})),r.d(n,"J",(function(){return f})),r.d(n,"n",(function(){return h})),r.d(n,"G",(function(){return p})),r.d(n,"Q",(function(){return g}));var o=r("dx_UtDZ"),i=r("dx_VXD2"),c=r("dx_tsDa"),a=r("dx_B28d"),l=r("dx_xFJs"),s=r("dx_g1Ip"),u=r("dx_bUp7");function d(){return Object(o.getMinaConfig)("google_api_key","")}function f(e){var n=e.type,r=e.autosize,o=void 0===r||r,c=u.C[n],a=c.defaultHeight,l=c.defaultWidth,s=function(e,n){return{width:Math.round(e),height:Math.round(n)}};if(a&&l)return s(l,a);if(o){var d=Object(i.N)();return s(d,9*d/16)}return s(u.J,u.f)}function h(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_blank",r=Object(o.getDocSecureLink)(e),i=window.open(r,n,"noopener=yes,noreferrer=yes");Object(o.sendSecLinkClickEvent)(),i&&(i.opener=null)}function p(e){return!Object(c.b)(e.blockManager,e.id)&&!Object(l.k)(e.id,e.blockManager)}function v(e){return function(e){return(null===e||void 0===e?void 0:e.type)===a.B.IFRAME}(e)&&p(e)}function g(e){return v(e)&&(null===e||void 0===e?void 0:e.hostElement)?e.hostElement.querySelector(".".concat(s.q)):null}},dx_I05X:function(e,n,r){"use strict";(function(t){var e=r("dx_J4zp"),o=r.n(e),i=r("dx_FBWK"),c=r("dx_K5vg"),a=r("dx_TSYQ"),l=r.n(a),s=r("dx_UtDZ"),u=r("dx_h6a8"),d=r("dx_cDcd"),f=r.n(d),h=r("dx_yzqx"),p=r("dx_y5yU"),v=r("dx_T7TM"),g=r("dx_niVl"),b=r("dx_Dq30"),y=r("dx_a3ox"),m=r("dx_SGLR"),_=r("dx_BBFf"),k=r("dx_hESJ"),O=r("dx_Nv7e"),x=(r("dx_dUBi"),3),E=_.I.PREVIEW,S=Object(p.r)(c.S),C=".template-center-preview__wrapper",I=function(){var e,n=document.documentElement.clientHeight;return.32*((null===(e=$(C).get(0))||void 0===e?void 0:e.getBoundingClientRect().height)||n)},B=function(){var e,n=document.documentElement.clientWidth;return(null===(e=$(C).get(0))||void 0===e?void 0:e.getBoundingClientRect().width)||n};n.S=function(e){var n=e.coverInfo,r=Object(s.isOnline)(),c=Object(d.useRef)(null),a=Object(d.useRef)(null),p=Object(d.useRef)(null),_=Object(d.useState)(!1),C=o()(_,2),T=C[0],w=C[1],R=Object(k.S)(c.current,n,E),M=Object(d.useState)(!1),j=o()(M,2),D=j[0],A=j[1],P=Object(d.useState)(!1),L=o()(P,2),N=L[0],F=L[1],U=Object(d.useState)(!1),H=o()(U,2),V=H[0],W=H[1],z=Object(d.useState)({}),G=o()(z,2),K=G[0],q=G[1],X=Object(d.useState)(""),Y=o()(X,2),J=Y[0],Z=Y[1],Q=Object(d.useState)(""),$=o()(Q,2),ee=$[0],te=$[1],ne=Object(d.useRef)({width:B(),height:I()}),re=Object(d.useCallback)((function(){(B()!==ne.current.width||I()!==ne.current.height)&&(ne.current={width:B(),height:I()},Object(m.n)(ne.current.height,E),a.current&&q(Object(O.d)(n,a.current,ne.current)))}),[n]),oe=function(){},ie=function(e){var n,r,o={pic_show_size:"".concat(Math.round(ne.current.width),"x").concat(Math.round(ne.current.height)),load_status:e?"success":"load_fail"};e&&(o.pic_original_size="".concat(null===(n=a.current)||void 0===n?void 0:n.naturalWidth,"x").concat(null===(r=a.current)||void 0===r?void 0:r.naturalHeight));g.S.loadCover(o)};Object(d.useEffect)((function(){if(n){var e=n&&n.src||"";if(R)return void Z(R);if(!e)return w(!1),void W(!0);if(Object(O.a)(e,J)){var r=Object(O.d)(n,a.current,ne.current);Object(u.isEqual)(K,r)||Object(u.isEmpty)(r)||q(r)}else x=3,A(!1),F(!1),Z(e),te(n.lightSrc||""),w(!0),W(!1)}else Z(""),w(!1),W(!1),Object(m.Z)(0,E)}),[n,R]),Object(d.useEffect)((function(){var e=h.S.isMobile&&!h.S.isIPad,n={trailing:!0};h.S.isMobile||(n.maxWait=200,n.leading=!0);var r=Object(u.debounce)(re,60,n);return(!e||v.Y0)&&window.addEventListener("resize",r),function(){(!e||v.Y0)&&window.removeEventListener("resize",r)}}),[re]),Object(d.useEffect)((function(){re()}),[re]);var ce=function(){if(J)if(x){x--;var e=new URL(J);e.searchParams.append("t","".concat(Number(new Date))),Z(e.toString()),!T&&w(!0),V&&W(!1)}else w(!1),W(!0),ie(!1)},ae=function(){x=3,ce()},le=function(){w(!1),q(Object(O.d)(n,a.current,ne.current)),W(!1),ie(!0)},se=function(){F(!0),q(Object(O.d)(n,p.current,ne.current))},ue=function(){A(!0),F(!0)};if(!n)return null;var de=l()(b.P,"docx-preview-cover-image",{"doc-cover-wrapper-loading":T}),fe={width:Math.min(K.width||ne.current.width,ne.current.width),height:Math.floor(ne.current.height),marginLeft:.1*-ne.current.width,marginBottom:28};return f.a.createElement("div",{ref:c,className:de,style:fe},function(){var e=Math.floor(ne.current.height)>160;return T&&!r?function(e){ie(!1);var n=f.a.createElement("div",{className:"doc-cover-offline-desc",style:{fontSize:16}},f.a.createElement("span",{className:"retry-text"},t("CreationDoc_DocX_Block_Load_Fail"),f.a.createElement("button",{type:"button",onClick:ae,className:"retry-btn"},t("CreationDoc_Docs_TwoWayLinks_LoadingError_Toast12"))));return f.a.createElement("div",{className:"doc-cover-offline"},f.a.createElement("div",{className:"doc-cover-offline-content docx-retry-content"},f.a.createElement("div",{onClick:e?void 0:ae},f.a.createElement(S,{style:{maxHeight:"96px",maxWidth:"96px"}})),e&&n))}(e):f.a.createElement(f.a.Fragment,null,V?function(e){ie(!1);var r=null===n||void 0===n?void 0:n.status,o=f.a.createElement("span",null,t("CreationDoc_DocX_Block_Load_Fail"),f.a.createElement("button",{type:"button",onClick:ae},t("CreationDoc_Docs_TwoWayLinks_LoadingError_Toast12")));return f.a.createElement("div",{className:"doc-cover-error"},f.a.createElement("div",{onClick:e?void 0:ae},f.a.createElement(S,null)),f.a.createElement("div",{className:"doc-cover-error-desc",style:{fontSize:16}},e&&(10!==r||(null===n||void 0===n?void 0:n.token)?o:t("CreationDoc_DocX_Cover_failed_placeholder"))))}(e):n?f.a.createElement(y.S,{isDragging:!1,style:K,updatePosition:oe},f.a.createElement("img",{className:"doc-cover-image",ref:a,src:J,onLoad:le,onError:ce}),T&&ee&&!D&&f.a.createElement("img",{style:{visibility:N?"visible":"hidden"},ref:p,src:ee,onLoad:se,onError:ue})):null,T&&f.a.createElement(s.SuiteLoading,{size:h.S.isMobile?24:36,color:Object(i.getThemeColorByToken)("text-disabled")}))}())}}).call(this,r("dx_E9Eu"))},dx_I11I:function(e,n,r){"use strict";r.d(n,"B",(function(){return o}));var o="inlineblock"},dx_I1IF:function(e,n,r){"use strict";r("dx_yuKo");var o=r("dx_LtlN");r.d(n,"ClientvarSplitter",(function(){return o.Q}))},dx_I2IP:function(e,n,r){"use strict";var o=r("dx_o0o1"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_h6a8"),v=r("dx_qDPQ");function g(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function b(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?g(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var y=function(){function e(){d()(this,e),this.blockManager=void 0,this.translateConfig=void 0,this.transfer=void 0}return h()(e,[{key:"init",value:function(){var e=s()(i.a.mark((function e(n){var o,c,a,l,s,u,d,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.blockManager,c=n.translateConfig,a=c.status,l=c.config,s={},u={src_lang:"zh",target_lang:"en"},this.blockManager=o,this.translateConfig={status:b(b({},s),a),config:b(b({},u),l)},e.next=8,r.e("dx_omQ").then(r.bind(null,"dx_g166"));case 8:d=e.sent,f=d.Transfer,this.transfer=new f({blockManager:this.blockManager,translateConfig:this.translateConfig});case 11:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"updateTranslateConfig",value:function(e){this.translateConfig=e,this.transfer&&this.transfer.updateTranslateConfig(this.translateConfig)}},{key:"getBlockTranslateData",value:function(e){return this.transfer?this.transfer.getBlockTranslateData(e):null}},{key:"translateBlock",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.transfer?this.transfer.translateBlock(e,n):Promise.resolve({code:v.t.FAIL})}},{key:"startTranslate",value:function(){var e=s()(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.transfer){e.next=2;break}return e.abrupt("return",Promise.resolve({code:v.t.FAIL,count:{wordCount:0,charCount:0}}));case 2:return e.abrupt("return",this.transfer.translateWholeData());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this.transfer&&(this.transfer.clear(),this.transfer=null)}},{key:"translated",get:function(){return Object(p.get)(this.translateConfig,"status.translated")}}]),e}();n.S=new y},dx_I4Iz:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return C}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_A9mE"),p=r("dx_K8hg"),v=r("dx_PcQO"),g=r("dx_UtDZ"),b=r("dx_cDcd"),y=r.n(b),m=r("dx_yzqx"),_=r("dx_Fimk"),k=(r("dx_cHMm"),r("dx_o68o")),O=r("dx_cuqV"),x=r("dx_D8nn"),E=r("dx_EDso");function S(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var C=function(e){l()(r,e);var n=S(r);function r(){var e;o()(this,r);for(var i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).templateBtnRef=void 0,e.handleTemplateBtnClick=function(){(0,e.props.toggleTemplateVisible)(!0),Object(_.N)("toggle_attribute",{action:"show_more_template"})},e.handleInsertWikiCatalogButtonClick=function(){var n,r=e.props.blockManager,o=null===(n=r.getBlockModelByBlockId(r.rootBlockId).children[0])||void 0===n?void 0:n.id,i=r.getBlockViewByBlockId(o);Object(O.G)(i,r)},e.setTemplateBtnRef=function(n){e.templateBtnRef=n},e.renderTemplateButton=function(){return y.a.createElement(v.Button,{type:"text",color:"primary",icon:y.a.createElement(h.S,null),id:E.x,ref:e.setTemplateBtnRef,className:e.generateCls("button"),onClick:e.handleTemplateBtnClick},t("common.template"))},e.renderWikiCatalogButton=function(){return y.a.createElement(v.Button,{color:"primary",icon:y.a.createElement(p.S,null),type:"text",className:e.generateCls("button"),onClick:e.handleInsertWikiCatalogButtonClick},t("CreationDoc_Wiki_SubpageTOC_BlockTitle"))},e}return c()(r,[{key:"componentDidUpdate",value:function(e){var n=this.props,r=n.isTemplateVisible,o=n.editable,i=e.isTemplateVisible,c=e.editable;(r!==i||o!==c)&&(i&&!r)&&this.templateBtnRef&&x.S.emit(x.p.TEMPLATE.PERFORM_HIDE_ANIMATION)}},{key:"generateCls",value:function(e){return"".concat(E.k,"_").concat(e)}},{key:"render",value:function(){var e=this.shouldShowTemplateButton,n=this.shouldShowWikiCatalogButton;return e&&n?y.a.createElement("div",{className:E.k},y.a.createElement(g.I18n,{name:t("LarkCCM_Wiki_NewDocs_TextSuggestion_Placeholder"),noWrapper:!0},this.renderWikiCatalogButton(),this.renderTemplateButton())):e?y.a.createElement("div",{className:E.k},y.a.createElement(g.I18n,{name:t("CreationDoc_DocX_SlashCommand_Input_Placeholder"),noWrapper:!0},this.renderTemplateButton())):n?y.a.createElement("div",{className:E.k},y.a.createElement(g.I18n,{name:t("LarkCCM_Docs_Placeholder_slashandsubpage"),noWrapper:!0},this.renderWikiCatalogButton())):t("CreationDoc_Docs_SlashCommand_Input_Placeholder")}},{key:"shouldShowTemplateButton",get:function(){var e=this.props,n=e.editable,r=e.isTemplateVisible,o=e.isFirstLineEmpty,i=!r&&!Object(g.getHideTemplateFromQuery)();return n&&o&&g.docxBottomTemplateEnabled&&i&&!m.S.isLark}},{key:"shouldShowWikiCatalogButton",get:function(){var e=this.props,n=e.editable,r=e.isFirstLineEmpty,o=e.isCurrentWikiNodeHasChild;return n&&o&&r&&Object(k.Q)()}}]),r}(y.a.PureComponent)}).call(this,r("dx_E9Eu"))},dx_I7QL:function(e,n,r){"use strict";r.d(n,"d",(function(){return E}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_LcNA"),v=r("dx_N8Nu"),g=r("dx_h6a8"),b=r("dx_SreQ"),y=r("dx_Xdvu"),m=r("dx_xeoP"),_=r("dx_eGDr"),k=r("dx_D8nn");function O(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var x=new m.o,E=function(e){s()(r,e);var n=O(r);function r(e){var o;return i()(this,r),(o=n.call(this)).props=e,o.handleSelecionRangeChange=Object(g.debounce)((function(){k.N.trigger(k.p.TASK.SELECTION_CHANGE,[o.props.block.id]),o.activeFirstComment()}),50,{leading:!1,trailing:!0}),o.handleFocus=function(){var e,n;null===(e=(n=o.props).onFocus)||void 0===e||e.call(n)},o.handleBlur=function(){var e,n;null===(e=(n=o.props).onBlur)||void 0===e||e.call(n)},Object(b.P)()?x.register(e.editor,{onSelect:o.handleFocus,onBlur:o.handleBlur}):(e.editor.on(p.L.FOCUS,o.handleFocus),e.editor.on(p.L.BLUR,o.handleBlur)),e.editor.on(p.L.SELECTION_CHANGE,o.handleSelecionRangeChange),o}return a()(r,[{key:"activeFirstComment",value:function(){var e=this.props.block.editorAPI.getService(y.a).commentModule;if(e){var n=this.props.block.record.id,r=e.getCommentsByRecordId(n);if(r&&r.size){var o=e.getPositionList().find((function(n){var o=n.commentId;return r.has(o)&&!e.isThirdPartyTypeComment(o)}));o&&e.activeCommentId!==o.commentId&&e.activateComment(o.commentId,void 0,_.M.interaction)}else e.activeCommentId&&e.deactivateComment(_.Fr.selectedBlockHasNoComment)}}},{key:"destroy",value:function(){Object(b.P)()?x.unregister(this.props.editor):(this.props.editor.off(p.L.FOCUS,this.handleFocus),this.props.editor.off(p.L.BLUR,this.handleBlur)),this.props.editor.off(p.L.SELECTION_CHANGE,this.handleSelecionRangeChange)}}]),r}(v.o)},dx_I8xe:function(e,n,r){"use strict";r.d(n,"h",(function(){return i}));var o=r("dx_n4v0");function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return Object(o.D)(e,n)}},dx_I8yo:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return s}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_UtDZ"),l=r("dx_EnrF"),s=function(){function e(n,r){o()(this,e),this.blockManager=n,this._selectionAPI=r}return c()(e,[{key:"onSave",value:function(e){!window.localStorage.getItem("bear-save-tips")&&this.blockManager.editable&&(window.localStorage.setItem("bear-save-tips","1"),a.Toast.show({key:"tips",type:"success",content:t("etherpad.save_tips"),duration:5e3,closable:!0})),e.preventDefault()}},{key:"onFind",value:function(e){a.openFindReplaceBox&&!Object(l.P)()&&(e.preventDefault(),a.store.dispatch(Object(a.openFindReplaceBox)({showOnlyFindRow:!0})))}},{key:"onReplace",value:function(e){e.preventDefault(),Object(l.P)()||(a.openFindReplaceBox&&this.blockManager.editable?a.store.dispatch(Object(a.openFindReplaceBox)({showOnlyFindRow:!1})):a.store.dispatch(Object(a.openFindReplaceBox)({showOnlyFindRow:!0})))}}]),e}()}).call(this,r("dx_E9Eu"))},dx_I9Iq:function(e,n,r){"use strict";var o=r("dx_lSNA"),i=r.n(o),c=r("dx_QILm"),a=r.n(c),l=r("dx_PcQO"),s=r("dx_TSYQ"),u=r.n(s),d=r("dx_cDcd"),f=r.n(d),h=r("dx_amgp"),p=(r("dx_M4lb"),"okr-status");n.S=function(e){var n,r=e.status,o=e.percent,c=a()(e,["status","percent"]),s=u()((n={},i()(n,"".concat(p,"--ontrack"),r===h.G.ON_TRACK),i()(n,"".concat(p,"--atrisk"),r===h.G.AT_RISK),i()(n,"".concat(p,"--offtrack"),r===h.G.OFF_TRACK),i()(n,"".concat(p,"--unset"),r===h.G.UNSET),i()(n,"".concat(p,"--no-percent"),0===o),n),c.className);return f.a.createElement(l.Progress,Object.assign({},c,{className:s,type:"circle",width:18,strokeWidth:5,percent:o,showInfo:!1}))}},dx_IAkw:function(e,n,r){},dx_IBhU:function(e,n,r){"use strict";r.d(n,"j",(function(){return d})),r.d(n,"K",(function(){return f})),r.d(n,"y",(function(){return v})),r.d(n,"u",(function(){return g}));var o=r("dx_k2kP"),i=r("dx_eSV8"),c=r("dx_D8nn"),a=r("dx_D3DW"),l=r("dx_uLXv"),s="DOCX_TASK",u="DOCX_TASK__MSG_BOX_PUSH_EVENT";function d(e){c.S.on(u,e)}function f(e){c.S.off(u,e)}function h(e){var n;try{n=JSON.parse(e)}catch(r){return void Object(i.n)(r)}n.data&&n.data.docx_todos&&(Object(l.K)(n.data.docx_todos,n.data.docx_todo_users),Object.keys(n.data.docx_todos).forEach((function(e){var r;r=n.data.docx_todos[e],c.S.emit(u,r)}))),Object(a.i)("MsgBoxPush: ",n)}var p="";function v(e){if(p!==e){p&&g(p),p=e;var n=Object(o.generateTagOptionsByType)({token:e,resourceType:s});o.default.register(n,h),o.default.onError(n,(function(e){console.error("[MessageBoxError]:",e),Object(i.n)(e)}))}}function g(e){p="";var n=Object(o.generateTagOptionsByType)({token:e,resourceType:s});o.default.deregister(n,h)}},dx_IEnx:function(e,n,r){"use strict";r.d(n,"C",(function(){return u}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_h6a8"),s=r("dx_Vioe"),u=function(){function e(n){var r=this;i()(this,e),this.pageToken=n,this.blockTriggerEventMap={},this.registerBlock=function(e){var n=e.blockId,o=e.eventType,i=r.getRecordName(n,o);r.blockTriggerEventMap[i]=e,r.triggerUnhHandleBlockData(e)},this.getRecordName=function(e,n){return"".concat(n,"_").concat(r.pageToken,"_").concat(e)},this.handleOnline=function(){Object.values(r.blockTriggerEventMap).forEach((function(e){r.triggerUnhHandleBlockData(e)}))},this.triggerUnhHandleBlockData=function(e){var n=e.handlerWhenOnline,o=e.blockId,i=e.eventType;try{var c=r.getRecord(o,i);if(!c)return;var a=c.cacheParams;(void 0===a?[]:a).forEach((function(e){n(e)}))}catch(l){console.error(l)}r.removeRecord(o,i)},window.addEventListener("online",this.handleOnline)}return a()(e,[{key:"destroy",value:function(){window.removeEventListener("online",this.handleOnline)}},{key:"addRecord",value:function(e,n,r){var o=this.getRecord(e,n);o||(o={cacheParams:[]});var i=o.cacheParams,c=this.getRecordName(e,n),a=this.blockTriggerEventMap[c],u=a.shouldMerge,d=a.cacheType;if(d===s.t.CACHE_EVERY_ACTION)i.push(i);else if(d===s.t.ONLY_CACHE_RESULT){var f=i[0];i[0]=f&&u?Object(l.merge)(f,r):r}this.saveRecord(e,n,o)}},{key:"removeRecord",value:function(e,n){localStorage.removeItem(this.getRecordName(e,n))}},{key:"getRecord",value:function(e,n){var r=localStorage.getItem(this.getRecordName(e,n));return null===r?r:JSON.parse(r)}},{key:"saveRecord",value:function(e,n,r){localStorage.setItem(this.getRecordName(e,n),JSON.stringify(r))}}]),e}()},dx_IFC7:function(e,n,r){"use strict";r.d(n,"K",(function(){return s})),r.d(n,"B",(function(){return d}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_UtDZ");function s(e){return u.apply(this,arguments)}function u(){return(u=a()(i.a.mark((function e(n){var r,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(l.request)({url:decodeURIComponent(n),method:"get",responseType:"blob"});case 3:return r=e.sent,o=r.data,e.abrupt("return",o);case 8:e.prev=8,e.t0=e.catch(0),console.error("get blob error: ",e.t0);case 11:return e.abrupt("return",void 0);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})))).apply(this,arguments)}function d(e,n){return function(e){if(!e)return!1;try{var n=new URL(e);return/http(s)?:/.test(n.protocol)}catch(r){return!1}}(e)?Object(l.request)({url:decodeURIComponent(e),method:"get",responseType:"blob",ignoreInterceptors:!0}).then((function(e){var n=e.data;if(n)return window.URL.createObjectURL(n);console.log("get blob url empty")})).catch((function(e){console.error("get blob url error: ",e)})):n||e}},dx_IFVB:function(e,n,r){},dx_INf6:function(e,n,r){},dx_IRIy:function(e,n){},dx_IS8F:function(e,n,r){"use strict";r.d(n,"F",(function(){return s})),r.d(n,"Cn",(function(){return u})),r.d(n,"C",(function(){return f})),r.d(n,"e",(function(){return h})),r.d(n,"W",(function(){return p})),r.d(n,"n",(function(){return m})),r.d(n,"A",(function(){return _}));var o=r("dx_h6a8"),i=r("dx_b3bq"),c=r("dx_B28d"),a=r("dx_xWRc"),l=r("dx_XW5M"),s=function(e){if(e.length>0){var n=e.slice(),r=n[0];if(n.every((function(e){return e===r})))return r}},u=function(e){return e.map((function(e){return(e.getAlignType?e.getAlignType():e.snapshot.align)||(c.I.includes(e.type)?c.D.CENTER:c.D.LEFT)}))},d=function(e){return function(n){var r=n.blocks,o=n.blockManager,c=n.recursive,a=void 0!==c&&c,l=n.fold,s=Object(i.dE)(l,r,o),u=s.blockList,d=s.isMultiSel;return Object(i.t)({fold:l,blockList:u,shouldIgnoreFold:d,blockManager:o,recursive:a}).filter((function(n){return!e.includes(n.type)}))}},f=d(c.uN),h=d(c.U),p=function(e,n,r){return n===l.t.BlockToolbar||r?void 0:e},v=function(e){return(null===e||void 0===e?void 0:e.type)===c.B.VIEW},g=function(e){var n=e.parent;return v(e.parent)?null===n||void 0===n?void 0:n.parent:n},b=function(e){return e.map((function(e){return v(e.parent)?e.parent:e})).sort((function(e,n){return e.position-n.position}))[0]},y=function(e){return 1===Object(o.uniq)(e.map((function(e){var n;return null===(n=g(e))||void 0===n?void 0:n.id}))).length},m=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Object(a.B)(e,n,!0),o=r.blockList;if(0===o.length||!y(o))return!1;var i=b(o),l=i.previousSibling;return!!l&&Object(c.q)().includes(l.type)},_=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Object(a.B)(e,n,!0),o=r.blockList;if(0===o.length||!y(o))return!1;var i=g(o[0]);return!!i&&Object(c.q)().includes(i.type)}},dx_IUIF:function(e,n,r){},dx_IVxn:function(e,n,r){"use strict";r.d(n,"f",(function(){return f})),r.d(n,"L",(function(){return h}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_alfx"),a=r("dx_B28d"),l=r("dx_c7yg"),s=r("dx_MsqB");function u(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function d(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?u(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function f(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filterLocalAttributes:!0,filterInitialAttributedText:!0};return Object(c.P)(e,n)}function h(e){var n=e.blockManager,r=e.snapshot,o=e.applyFrom,i=e.applyTime,c=r.type,u=n.getBlockModelCreatorByBlockType(c).onRecordApply(r,o,i),f=function(e){switch(e.type){case a.B.IMAGE:return d(d({},e),{},{image:d(d({},e.image),{},{token:""})});case a.B.FILE:return d(d({},e),{},{file:d(d({},e.file),{},{token:l.v})});case a.B.SHEET:case a.B.BITABLE:return d(d({},e),{},{token:""});case a.B.CHAT_CARD:return d(d({},e),{},{chat_token:""});case a.B.ISV:return d(d({},e),{},{app_block_id:""});case a.B.TASK:return d(d({},e),{},{status:e.task_id?s.TaskBlockStatus.Initializing:s.TaskBlockStatus.New,task_id:""});default:return e}}(c===a.B.TABLE?u:n.createInitModel(c,u));return f}},dx_IWRl:function(e,n,r){"use strict";r.d(n,"b",(function(){return s})),r.d(n,"y",(function(){return u})),r.d(n,"Y",(function(){return d}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_QxNg"),a=r("dx_B28d"),l=r("dx_USRY");function s(e,n,r,o){if(!o&&n&&!e.hasBlockModelByBlockId(n))return"";var c=r||e.getBlockPath(n);return[].concat(i()(c),[n]).find((function(n){return e.getBlockModelByBlockId(n).type===a.B.CELL}))}var u=function(e){return"view_type"===e.p[0]&&Object(c.bG)(e)&&e.action.od===l.t.Preview&&e.action.oi===l.t.Card},d=function(e){return"view_type"===e.p[0]&&Object(c.bG)(e)&&e.action.od===l.t.Card&&e.action.oi===l.t.Preview}},dx_IWVf:function(e,n,r){"use strict";r.d(n,"D",(function(){return O})),r.d(n,"o",(function(){return x})),r.d(n,"n",(function(){return E}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_Z8Zi"),d=r("dx_LI2F"),f=r("dx_UtDZ"),h=r("dx_cDcd"),p=r.n(h),v=r("dx_BaZy"),g=r.n(v),b=r("dx_Qz0W"),y=new Map,m=function(){var e=s()(i.a.mark((function e(n){var o,c,l,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y.has(n)){e.next=9;break}if(o=u.f.enUS,!n){e.next=9;break}return e.next=5,Promise.all([r("dx_WCA2")("./".concat(n)).then((function(e){return e}),(function(){return r("dx_WCA2")("./".concat(o))}))]);case 5:c=e.sent,l=a()(c,1),s=l[0].default,y.set(n,{emoji:s});case 9:return e.abrupt("return",y.get(n));case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),_=new Map,k=function(){var e=s()(i.a.mark((function e(n){var o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.has(n)){e.next=7;break}if(!n){e.next=7;break}return e.next=4,r("dx_W8W9")("./".concat(n));case 4:return o=e.sent,c=o.default,e.abrupt("return",{UserProfile:c});case 7:return e.abrupt("return",_.get(n));case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),O=g()({loader:function(){return Promise.all([Promise.all([r.e("dx_vNU"),r.e("dx_C1M")]).then(r.bind(null,"dx_Lqso")),m(f.i18nHelper.getLocale())])},loading:function(){return p.a.createElement(b.J,null)},render:function(e,n){var r=a()(e,2),o=r[0].default,i=r[1];return p.a.createElement(d.S,{locale:f.i18nHelper.getLocale(),lang:i},p.a.createElement(o,Object.assign({fallbackType:1,size:24,onMouseDown:function(e){e.preventDefault()}},n)))}}),x=g()({loader:function(){return Promise.all([Promise.all([r.e("dx_vNU"),r.e("dx_cW4")]).then(r.bind(null,"dx_U4U5")),m(f.i18nHelper.getLocale())])},loading:function(){return p.a.createElement(p.a.Fragment,null)},render:function(e,n){var r=a()(e,2),o=r[0].default,i=r[1];return p.a.createElement(d.S,{locale:f.i18nHelper.getLocale(),lang:i},p.a.createElement(o,n))}}),E=g()({loader:function(){return Promise.all([Promise.all([r.e("dx_vNU"),r.e("dx_UTc"),r.e("dx_v7vu"),r.e("dx_hbnQ"),r.e("dx_rTJ")]).then(r.bind(null,"dx_F8Kl")),k(f.i18nHelper.getLocale())])},loading:function(){return p.a.createElement(p.a.Fragment,null)},render:function(e,n){var r=a()(e,2),o=r[0].default,i=r[1];return p.a.createElement(d.S,{locale:f.i18nHelper.getLocale(),lang:i},p.a.createElement(o,Object.assign({onActionDone:function(){},addContactsParams:{source:4}},n)))}})},dx_IZcR:function(e,n,r){},dx_IbkQ:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return le}));r("dx_QU2i");var e=r("dx_d1El"),o=r.n(e),i=r("dx_J4zp"),c=r.n(i),a=r("dx_lSNA"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_PJYZ"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_W7W2"),g=r.n(v),b=r("dx_a1gu"),y=r.n(b),m=r("dx_Nsbk"),_=r.n(m),k=r("dx_TSYQ"),O=r.n(k),x=r("dx_UtDZ"),E=r("dx_h6a8"),S=r("dx_cDcd"),C=r.n(S),I=r("dx_oDxX"),B=r("dx_GDEn"),T=r("dx_rQGm"),w=r("dx_yzqx"),R=r("dx_CqjN"),M=r("dx_gMOR"),j=r("dx_ABiD"),D=r("dx_rrS6"),A=r("dx_GPzN"),P=r("dx_xWbU"),L=r("dx_zEdG"),N=r("dx_imty"),F=r("dx_b28D"),U=r("dx_NUzf"),H=r("dx_MUMK"),V=r("dx_OJCf"),W=r("dx_B28d"),z=r("dx_Jl0O"),G=r("dx_Bait"),K=r("dx_NMuw"),q=r("dx_D8nn"),X=r("dx_fTg3"),Y=r("dx_X279"),J=r("dx_H2HL"),Z=r("dx_av9k"),Q=r("dx_nwMI"),$=r("dx_fs49"),ee=r("dx_p3b8"),te=r("dx_iVNl"),ne=r("dx_L3LL"),re=r("dx_CU16");r("dx_Ldy2");function oe(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function ie(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?oe(Object(r),!0).forEach((function(n){l()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ce(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=_()(e);if(n){var i=_()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return y()(this,r)}}var ae=Object(F.e)("catalogue:component"),le=function(e){g()(r,e);var n=ce(r);function r(e){var o;u()(this,r),(o=n.call(this,e)).activeId=null,o.initActiveId="",o.cacheScrollTop=0,o.catalogueRef=C.a.createRef(),o.catalogueMainRef=C.a.createRef(),o.catalogUlRef=C.a.createRef(),o.scrollRef=null,o.listRef=C.a.createRef(),o.onMoveEnd=function(e,n){ae("%s.onMoveEnd, clear toMoveDirection and movingShowMode",n),o.setState({toMoveDirection:void 0,movingShowMode:void 0}),o.emitRectChangeIfNess("moveEnd"),o.widthExpander.expandWidthDebounced("onMoveEnd")},o.moveManager=new te.C(o.catalogueMainRef,{onMoveEnd:o.onMoveEnd}),o.titleManager=new re.i,o.dataToRenderStageCollector=new D.S(f()(o)),o.state=void 0,o.wikiSidebarWidth=0,o.isSendVCStartData=!1,o.commentSDK=void 0,o.onCommentReady=function(e){var n;w.S.isInVC&&(o.commentSDK=e.getInnerCommentModule(),null===(n=o.commentSDK)||void 0===n||n.on("commentDataChangeRemote",X.m))},o.handleMouseMove=Object(E.throttle)((function(e){var n=o.props,r=n.hotZoneWidth,i=n.maxHeight,c=e.clientX,a=e.clientY,l=window.innerHeight;if(r&&i){var s=c<=r+o.wikiSidebarWidth&&c>=o.wikiSidebarWidth&&a>l-i;o.setIsHotZoneHovered(s)}}),100),o.handleResize=function(e){e&&(o.wikiSidebarWidth=window.innerWidth-e.width)},o.lastEmittedRect=void 0,o.preventSelectBySelectAll=function(e){var n;Object(V.u)(e)===H.F.onSelectAll&&(null===(n=o.catalogueRef.current)||void 0===n||n.classList.add("disable-select"))},o.isMouseDownInPSThumb=!1,o.handlePSThumbMouseDown=function(){return o.setIsMouseDownInPSThumb(!0)},o.handlePSThumbMouseUp=function(){return o.setIsMouseDownInPSThumb(!1)},o.onPaint=function(e){var n,r,i=e.prevListData,c=e.newListData;if(o.isShowFull){o.emitRectChangeIfNess("onPaint"),!i.length&&c.length&&o.isShowFloating&&o.widthExpander.lockWidth("onPaint"),o.titleManager.updateTitleWidthMap(e);var a=o.titleManager.getMaxTitleWidth();null===(n=o.listRef)||void 0===n||null===(r=n.current)||void 0===r||r.setPlaceholderWidth(a),o.widthExpander.expandWidthDebounced("onPaint")}},o.onCatalogueUpdate=function(e){ae("onCatalogueUpdate, %d items",e.length),o.setDataReady(),o.setState({catalogueItems:e,isReady:!0})},o.onNewActiveBlockId=function(e){o.activeId!==e&&(o.activeId=e,null!==o.initActiveId&&(o.initActiveId=e),w.S.isInVC&&Object(X.J)(o.state.catalogueItems.filter((function(n){return n.recordId===e}))),w.S.isInVC&&!o.isSendVCStartData&&(o.isSendVCStartData=!0,Object(X.C)(o.state.catalogueItems)),o.switchActiveItem())},o.switchActiveItem=Object(E.debounce)((function(){o.forceUpdate((function(){o.scrollIntoViewIfNeeded()}))}),200,{leading:!1,trailing:!0}),o.setScrollRef=function(e){o.scrollRef!==e&&(o.scrollRef=e,o.scrollRef&&(o.scrollRef.scrollTop=o.cacheScrollTop))},o.handleItemClick=function(e){var n=e.currentTarget.dataset,r=n.id,i=n.sourceLevel;o.collectContentPageClick({click:"click_directory_link",target:"none",directory_link_block_type:Object($.e)(parseInt(i||"",10))}),o.enableHover(),e.preventDefault(),o.scrollToBlockId(r),Object(x.sendOpendocEvent)(x.OPENDOC_EVENT.CURR_ANCHOR,r)},o.handleTouch=Object(R.i)({onClick:function(e){return o.handleItemClick(e)}}),o.isContentJustFullScreen=function(e,n){if(n){var r=(o.hasTitle()?o.titleItemHeight+(e-1)*o.itemHeight:e*o.itemHeight)+T.l-n;return r<=T.l&&r>=0}return!1},o.onPinClicked=function(){ae("onPinClicked, old isPinned=%s",o.state.isPinned);var e=!o.state.isPinned;Object(L.P)("ccm_doc_content_page_click",{record_id:Object(x.getToken)(),block_type:W.B.PAGE},{click:"click_show_directory",sub_click:e?"pin":"cancel_pin"}),o.setIsPinned(e)},o.onMouseDown=function(){var e;null===(e=o.catalogueRef.current)||void 0===e||e.classList.remove("disable-select")},o.enableHover=function(){var e;null===(e=o.catalogueRef.current)||void 0===e||e.classList.remove("disable-hover")},o.disableHover=function(){var e;null===(e=o.catalogueRef.current)||void 0===e||e.classList.add("disable-hover")},o.onMouseEnterCatalogue=function(){setTimeout((function(){var e;if(!o.isToMoveOrMoving&&((null===(e=o.catalogUlRef.current)||void 0===e?void 0:e.matches(":hover"))||!o.isShowFull)){o.setIsHovered(!0),o.enableHover(),o.collectContentPageClick({click:"click_show_directory",sub_click:"hover"});var n=o.props.onCatalogueHoverChange;null===n||void 0===n||n(!0),o.widthExpander.lockWidth("onMouseEnterCatalogue.".concat(o.state.showMode))}}),100)},o.widthExpander=new ne.D({getEl:function(){return o.catalogUlRef.current},onExpandEnd:function(e){return o.emitRectChangeIfNess(e)},canLockWidth:o.canLockWidth.bind(f()(o)),canUnlockWidth:o.canUnlockWidth.bind(f()(o)),canExpandWidth:o.canExpandWidth.bind(f()(o)),onMouseLeaveCatalogue:function(){return o.onMouseLeaveCatalogue()}}),o.onMouseLeaveCatalogue=function(){var e,n;o.state.isPinned||o.collectContentPageClick({click:"click_show_directory",sub_click:"hide"}),o.setIsHovered(!1),null===(e=(n=o.props).onCatalogueHoverChange)||void 0===e||e.call(n,!1),o.widthExpander.expandWidthDebounced("onMouseLeaveCatalogue")},o.onTouchStartCatalogue=function(){o.disableHover()},o.handleCopy=function(e){var n=o.props.onCopy;n&&n(e)},A.S.updateLoadMainStageDurationList(x.FILE_TYPE.DOCX,x.LOAD_MAIN_STAGE_DURATION_LIST_KEY.RENDER_FILE_CATALOGUE_START);var i={top:0};o.props.isSSR&&(i.visibility="hidden");var c=void 0!==e.initialCatalogItems;return c&&o.setDataReady(),ae("constructor isReady=%s, items=%o",c,e.initialCatalogItems),o.state={catalogStyle:i,isPinned:!!Object(E.isUndefined)(e.defaultPin)||e.defaultPin,isHovered:!1,isHotZoneHovered:!1,isReady:c,catalogueItems:e.initialCatalogItems||[]},w.S.isOpendoc&&Object(x.registerOpendocApi)(x.OPENDOC_API.anchorJump,o.scrollToBlockId.bind(f()(o))),o}return p()(r,[{key:"catalogueRect",get:function(){var e;return(null===(e=this.catalogueRef.current)||void 0===e?void 0:e.getBoundingClientRect())||null}},{key:"relativeCatalogRect",get:function(){var e=this.catalogueRect;if(!e)return null;var n=Object(z.I)(e);return ie(ie({},n),{},{left:n.left-this.wikiSidebarWidth,right:n.right-this.wikiSidebarWidth})}}]),p()(r,[{key:"componentDidMount",value:function(){q.S.on(G.v.CATALOGUE_UPDATE,this.onCatalogueUpdate),q.S.on(G.v.CATALOGUE_ACTIVE_UPDATE,this.onNewActiveBlockId),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("keydown",this.preventSelectBySelectAll),this.props.isInWiki&&!w.S.isMobile&&Object(Y.N)().onResize(this.handleResize),this.componentDidMountOrUpdate(!0,!0,!0,"componentdidMount")}},{key:"componentWillUnmount",value:function(){this.props.isInWiki&&!w.S.isMobile&&Object(Y.N)().offResize(this.handleResize),this.handleMouseMove.cancel(),q.S.off(G.v.CATALOGUE_UPDATE,this.onCatalogueUpdate),q.S.off(G.v.CATALOGUE_ACTIVE_UPDATE,this.onNewActiveBlockId),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("keydown",this.preventSelectBySelectAll),this.switchActiveItem.cancel();var e,n=this.props.onCatalogueHoverChange;(null===n||void 0===n||n(!1),w.S.isInVC)&&(Object(X.c)(),null===(e=this.commentSDK)||void 0===e||e.off("commentDataChangeRemote",X.m))}},{key:"emitRectChangeIfNess",value:function(e){if(this.state.showMode===ee.n.FULL_NORMAL){var n=this.relativeCatalogRect;Object(U.P)(this.lastEmittedRect,n)||(ae("%s.emitRectChange",e,n),q.S.emit(G.v.CATALOGUE_RECT_CHANGE,n),this.lastEmittedRect=n)}}},{key:"setIsMouseDownInPSThumb",value:function(e){this.isMouseDownInPSThumb=e,this.widthExpander.expandWidthDebounced("setIsMouseDownInPSThumb.".concat(e))}},{key:"calcCatalogTop",value:function(){var e=this.props.pageContainer,n=this.catalogueRect,r=(null===e||void 0===e?void 0:e.clientHeight)||0;if(n){var o=Object(M.x)(r,n.height);return ae("calcCatalogTop: containerHeight=%d catalogHeight=%d top=%d",r,n.height,o),o}}},{key:"updateCatalogTop",value:function(){var e=this.calcCatalogTop();e!==this.state.catalogStyle.top&&this.setState({catalogStyle:{top:e}})}},{key:"lockBoundaryIntersection",value:function(){q.S.emit(G.v.CATALOGUE_MOVE_START)}},{key:"getSnapshotBeforeUpdate",value:function(e,n){e.maxWidth!==this.props.maxWidth&&this.lockBoundaryIntersection()}},{key:"componentDidUpdate",value:function(e,n){var r=this.props,o=r.maxWidth,i=r.maxHeight,c=r.onCatalogBaseShowModeChange,a=r.pageToken,l=this.state.catalogueItems;if(a!==e.pageToken)return null===c||void 0===c||c(!1),void this.dataToRenderStageCollector.switchDocToken();var s=Object($.v)(e,n),u=s.showMode,d=s.baseIsAbstract,f=Object($.v)(this.props,this.state),h=f.showMode,p=f.baseIsAbstract,v=n.catalogStyle.top!==this.state.catalogStyle.top,g=u!==h||e.maxHeight!==i||n.catalogueItems!==l,b=v||g||e.maxWidth!==o,y=d!==p;this.componentDidMountOrUpdate(g,b,y,"componentDidUpdate")}},{key:"componentDidMountOrUpdate",value:function(e,n,r,o){this.initActiveId&&this.scrollRef&&(this.initActiveId=null,this.scrollIntoViewIfNeeded()),this.isShowAbstract&&this.widthExpander.unlockWidthImmediately(o),this.moveCatalogIfNess(o),r&&this.notifyBaseShowModeChange(),e&&this.updateCatalogTop(),n&&this.emitRectChangeIfNess(o),this.dataToRenderStageCollector.didUpdate(j.ET.RENDER_DOCX_CATALOGUE_SUCCESS),this.dataToRenderStageCollector.didUpdateForStage(x.LOAD_MAIN_STAGE_DURATION_LIST_KEY.RENDER_FILE_CATALOGUE_SUCCESS)}},{key:"moveCatalogIfNess",value:function(e){var n=this.state.toMoveDirection;!this.moveManager.isMoving&&n&&this.moveManager.moveCatalog(n,this.animationEnabled,e)}},{key:"notifyBaseShowModeChange",value:function(){var e,n,r=Object($.d)(this.props,this.state).baseIsAbstract;ae("notifyBaseShowModeChange abs=%s",r),null===(e=(n=this.props).onCatalogBaseShowModeChange)||void 0===e||e.call(n,r)}},{key:"setDataReady",value:function(){this.props.isSSR?A.S.setCatalogueLoaded():(this.dataToRenderStageCollector.dataReady(j.ET.FETCH_DOCX_CATALOGUE_SUCCESS),this.dataToRenderStageCollector.dataReadyForStage(x.LOAD_MAIN_STAGE_DURATION_LIST_KEY.FETCH_FILE_CATALOGUE_SUCCESS))}},{key:"scrollIntoViewIfNeeded",value:function(){var e=this;if(this.scrollRef){var n=this.state.catalogueItems,r=this.itemHeight,o=this.titleItemHeight,i=n.findIndex((function(n){return n.recordId===e.activeId})),c=i>0?this.hasTitle()?o+r*(i-1):i*r:0,a=this.scrollRef.scrollTop,l=this.scrollRef.getBoundingClientRect(),s=(this.hasTitle()&&0===i?o:r)-this.itemPaddingBottom;if(!(c>=a&&c+s<=a+l.height)){this.widthExpander.lockWidth("scrollIntoViewIfNeeded");var u=c-a;this.scrollRef.scrollTop+=u,this.cacheScrollTop=this.scrollRef.scrollTop}}}},{key:"scrollToBlockId",value:function(e){q.S.trigger(N.H.LocateBlockWithRecordId,[e]);var n=this.props.blockManager.getBlockIdsByRecordId(e),r=c()(n,1)[0];r&&q.S.trigger(T.Fx,[r,!1])}},{key:"onFirstRenderAfterDataReady",value:function(){var e,n;null===(e=(n=this.props).updateBusinessStage)||void 0===e||e.call(n,x.renderHelpers.DocxStage.SectionNavRendered)}},{key:"renderItemList",value:function(e){var n,r=this,o=e.catalogueItems,i=e.activeBlockId,c=e.isShowFull,a=e.isContentHeightJustFull,l=O()("catalogue__list",{"show-full":c,"show-abstract":!c}),s=this.itemHeight,u=this.titleItemHeight,d=this.itemPaddingBottom,f={paddingBottom:a?0:T.l,cursor:"pointer"},h={height:u,paddingBottom:d},p={height:s,paddingBottom:d};return C.a.createElement(Q.f,{isSSR:!!this.props.isSSR,ref:this.listRef,className:l,style:f,scroller:".catalogue__scroller",listData:o,itemHeight:s,containerRef:this.catalogUlRef,getBeforePlaceholderHeight:function(e,n){if(0===e.length)return 0;var o=e[0].sourceLevel,i=s*n;return r.hasTitle()&&o!==K.z?i+(u-s):i},renderItem:function(e){var n=e.sourceLevel,o=e.recordId,a=e.level,l=O()("catalogue__list-item","indent-level-".concat(a),"heading-".concat(n),{active:o===i,"abstract-item":!c});return C.a.createElement(J.o,{key:o,recordId:o,className:l,"data-id":o,onClick:r.handleItemClick,onTouchStart:r.handleTouch,onTouchEnd:r.handleTouch,onTouchMove:r.handleTouch,isShowFull:c,text:e.text,style:0===n?h:p,setTitleRef:r.titleManager.setTitleRef,sourceLevel:e.sourceLevel})},initScrollTop:c&&(null===(n=this.scrollRef)||void 0===n?void 0:n.scrollTop)||0,initPlaceholderWidth:this.titleManager.getMaxTitleWidth(),getViewportHeight:function(){return window.innerHeight},onPaint:this.onPaint,onViewportHeightOrOffsetTopChange:function(e){var n=window.innerHeight,r=function(){n!==window.innerHeight&&(n=window.innerHeight,e())};return window.addEventListener("resize",r),function(){window.removeEventListener("resize",r)}}})}},{key:"renderPin",value:function(e,n){var r=this,i=C.a.createElement(o.a,{trigger:["hover"],title:t(e?"CreationDoc_Docs_TOC_Hide":"CreationDoc_Docs_TOC_Expand"),placement:"topLeft",arrowPointAtCenter:!0,getPopupContainer:function(){return r.props.pageContainer||document.body}},C.a.createElement("span",{className:"catalogue__pin-wrapper",onClick:this.onPinClicked,onMouseEnter:function(){return r.setIsHovered(!1)}},e?C.a.createElement(B.S,null):C.a.createElement(I.S,null)));return C.a.createElement("div",{className:"catalogue__pin"},n?i:null)}},{key:"setIsPinned",value:function(e){this.setState({isPinned:e})}},{key:"setIsHotZoneHovered",value:function(e){this.setState({isHotZoneHovered:e})}},{key:"setIsHovered",value:function(e){this.setState({isHovered:e})}},{key:"collectContentPageClick",value:function(e){Object(L.P)("ccm_doc_content_page_click",{record_id:Object(x.getToken)(),block_type:W.B.PAGE},e)}},{key:"canLockWidth",value:function(){return!(this.props.isSSR||this.isShowAbstract)}},{key:"canUnlockWidth",value:function(){return!this.isToMoveOrMoving&&(this.isShowAbstract||!this.state.isHovered&&!this.isMouseDownInPSThumb)}},{key:"canExpandWidth",value:function(){return!this.isToMoveOrMoving&&!(this.props.isSSR||this.isMouseDownInPSThumb||this.isShowAbstract)}},{key:"hasTitle",value:function(){return Object($.q)(this.state.catalogueItems)}},{key:"getCatalogMaxWidth",value:function(e,n,r){switch(e){case ee.n.FULL_FLOATING:return Math.max(n||0,T.q);case ee.n.ABSTRACT:return r;default:return n}}},{key:"renderFull",value:function(e,n){var r=x.PerfectScrollbar.default;return C.a.createElement(r,{className:"catalogue__scroller",containerRef:this.setScrollRef,onYDragStart:this.handlePSThumbMouseDown,onYDragEnd:this.handlePSThumbMouseUp,options:{suppressScrollX:!0},style:{outline:"transparent",maxHeight:n},size:x.PerfectScrollbar.ScrollbarSize.Small},e)}},{key:"renderAbstract",value:function(e,n){return C.a.createElement("div",{className:"catalogue__scroller",ref:this.setScrollRef,style:{maxHeight:n}},e)}},{key:"render",value:function(){var e=this.props,n=e.maxWidth,r=e.maxHeight,o=e.abstractWidth,i=void 0===o?T.a:o,c=e.widthMode,a=e.visible,l=this.state,s=l.catalogueItems,u=l.isPinned,d=l.isHotZoneHovered,f=l.catalogStyle,h=l.movingShowMode,p=r&&r-T.m,v=c===P.M.FullWidth,g=Object($.v)(this.props,this.state),b=g.showMode,y=g.canShowPin,m=h||b,_=m!==ee.n.ABSTRACT,k=m===ee.n.FULL_FLOATING,x=y&&d,S=this.getCatalogMaxWidth(m,n,i),I=this.isContentJustFullScreen(s.length,p),B=this.renderItemList({catalogueItems:s,activeBlockId:this.activeId,isShowFull:_,isContentHeightJustFull:I});return ae("render(%s,%s) force(bi=%s,forceAbs=%s,empty=%s,ready=%s), isPinned=%s, hovered=%s, showPin(%s,%s), toMove(%s,%s), areaSize=%d/%d, top=%s, hotZone=%d",m,b,this.props.isBoundaryIntersection,this.props.isForceShowAbstract,this.isEmptyCatalogue,this.state.isReady,u,this.state.isHovered,y,d,this.state.toMoveDirection,this.state.movingShowMode,n,r,this.state.catalogStyle.top,this.props.hotZoneWidth),this.isEmptyCatalogue||!Object(E.isUndefined)(a)&&!a?null:C.a.createElement("div",{className:O()("catalogue-container",{floating:k}),onCopy:this.handleCopy,onCut:this.handleCopy,style:f},C.a.createElement("div",{className:O()("catalogue",{hovered:k,"in-vc":w.S.isInVC,"full-width":v}),style:{maxWidth:S},ref:this.catalogueRef},this.renderPin(u,x),C.a.createElement("div",{className:"catalogue__main",onMouseDown:this.onMouseDown,onMouseLeave:this.onMouseLeaveCatalogue,onMouseEnter:this.onMouseEnterCatalogue,onTouchStart:this.onTouchStartCatalogue,ref:this.catalogueMainRef},_?this.renderFull(B,p):this.renderAbstract(B,p))))}},{key:"itemHeight",get:function(){var e;return null!==(e=this.props.itemHeight)&&void 0!==e?e:Z.a}},{key:"titleItemHeight",get:function(){var e;return null!==(e=this.props.docTitleItemHeight)&&void 0!==e?e:Z.V}},{key:"itemPaddingBottom",get:function(){var e;return null!==(e=this.props.itemPaddingBottom)&&void 0!==e?e:Z.x}},{key:"animationEnabled",get:function(){return Boolean(this.props.animationEnabled)||this.state.movingShowMode===ee.n.FULL_FLOATING}},{key:"isToMoveOrMoving",get:function(){return Boolean(this.state.toMoveDirection)}},{key:"isShowFloating",get:function(){return this.state.showMode===ee.n.FULL_FLOATING}},{key:"isShowFull",get:function(){return this.state.showMode!==ee.n.ABSTRACT}},{key:"isShowAbstract",get:function(){return!this.isToMoveOrMoving&&this.state.showMode===ee.n.ABSTRACT}},{key:"isEmptyCatalogue",get:function(){return Object($.u)(this.state.catalogueItems)}}],[{key:"getDerivedStateFromProps",value:function(e,n){var r=Object($.v)(e,n).showMode,o=n.showMode,i=n.toMoveDirection;if(o===r)return null;if(!o||i)return{showMode:r};var c=o!==ee.n.ABSTRACT,a=r!==ee.n.ABSTRACT;return c&&!a?{toMoveDirection:te.D.LEFT,movingShowMode:o,showMode:r}:!c&&a?{toMoveDirection:te.D.RIGHT,movingShowMode:r,showMode:r}:{showMode:r}}}]),r}(C.a.PureComponent)}).call(this,r("dx_E9Eu"))},dx_IcDz:function(e,n,r){"use strict";r.d(n,"w",(function(){return o})),r.d(n,"s",(function(){return i})),r.d(n,"m",(function(){return c}));var o="fold_set_state",i="fold_status_change_view_display",c="post_fold_status_change_view_display"},dx_IdVu:function(e,n,r){"use strict";r.d(n,"m",(function(){return W}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_lSNA"),b=r.n(g),y=r("dx_yXPU"),m=r.n(y),_=r("dx_UtDZ"),k=r("dx_h6a8"),O=r("dx_yzqx"),x=r("dx_GPzN"),E=r("dx_Fimk"),S=r("dx_eSV8"),C=r("dx_Ayao"),I=r("dx_upU1"),B=Symbol("isReady"),T=Symbol("readyCallbacks"),w=function(){function e(){a()(this,e),this[B]=!1,this[T]=[]}return s()(e,[{key:"ready",value:function(e){if("function"===typeof e)return this.register(e);this.emit(e)}},{key:"register",value:function(e){this[B]?e():this[T].push(e)}},{key:"emit",value:function(e){this[B]=!1!==e,this[B]&&this[T].splice(0,1/0).forEach((function(e){return e()}))}}],[{key:"mixin",value:function(n){if(n){var r=new e;n.ready=function(e){return r.ready(e)}}}}]),e}();var R=function(){function e(n){var r,o=this;a()(this,e),this.options=n,this.isReady=void 0,this.ready=void 0,this._module=void 0,this._scrollToComment=function(e,n,r){o.ready((function(){var i;null===(i=o.module)||void 0===i||i.commentScroller.scrollToComment(e,n,r)}))},this._scrollToBottom=function(){o.ready((function(){var e;null===(e=o.module)||void 0===e||e.commentScroller.scrollToBottom()}))},this._fixHorizontalScroll=function(e){o.ready((function(){var n;null===(n=o.module)||void 0===n||n.commentScroller.fixHorizontalScroll(e)}))},this._collectEvent=function(e,n,r){o.ready((function(){var i;null===(i=o.module)||void 0===i||i.eventCollector.collectEvent(e,n,r)}))},this.setCommentsFilter=function(e){o.ready((function(){var n;null===(n=o.module)||void 0===n||n.setCommentsFilter(e)}))},this.updateAllCommentPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];o.ready((function(){var n;null===(n=o.module)||void 0===n||n.updateAllCommentPosition(e)}))},r=this,w.mixin(r),this.ready((function(){o.isReady=!0}))}return s()(e,[{key:"setModule",value:function(e){this._module=e}},{key:"once",value:function(e,n){var r=this;this.ready((function(){var o;null===(o=r.module)||void 0===o||o.once(e,n)}))}},{key:"on",value:function(e,n){var r=this;this.ready((function(){var o;null===(o=r.module)||void 0===o||o.on(e,n)}))}},{key:"off",value:function(e,n){var r=this;this.ready((function(){var o;null===(o=r.module)||void 0===o||o.off(e,n)}))}},{key:"setVcPosition",value:function(e){var n=this;this.ready((function(){var r;null===(r=n.module)||void 0===r||r.setVcPosition(e)}))}},{key:"activeCommentChange",value:function(e){var n=this;this.ready((function(){var r;null===(r=n.module)||void 0===r||r.activeCommentChange(e)}))}},{key:"hoverCommentChange",value:function(e){var n=this;this.ready((function(){var r;null===(r=n.module)||void 0===r||r.hoverCommentChange(e)}))}},{key:"jumpToReply",value:function(e,n){var r=this;this.ready((function(){var o;null===(o=r.module)||void 0===o||o.jumpToReply(e,n)}))}},{key:"activateComment",value:function(e,n,r,o,i,c){var a=this;this.ready((function(){var l;null===(l=a.module)||void 0===l||l.activateComment(e,n,r,o,i,c)}))}},{key:"deactivateComment",value:function(e,n){var r=this;this.ready((function(){var o;null===(o=r.module)||void 0===o||o.deactivateComment(e,n)}))}},{key:"handleCommentChange",value:function(e,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{type:C.K.REMOTE};this.ready((function(){var i;null===(i=r.module)||void 0===i||i.handleCommentChange(e,n,o)}))}},{key:"getCommentable",value:function(){var e;return(null===(e=this.module)||void 0===e?void 0:e.getCommentable())||!1}},{key:"getIsReady",value:function(){var e;return(null===(e=this.module)||void 0===e?void 0:e.getIsReady())||!1}},{key:"calcCommentPositionByBlockId",value:function(e){var n=this;this.ready((function(){var r;null===(r=n.module)||void 0===r||r.calcCommentPositionByBlockId(e)}))}},{key:"setGlobalCommentLoaded",value:function(){var e=this;this.ready((function(){var n;null===(n=e.module)||void 0===n||n.setGlobalCommentLoaded()}))}},{key:"getTempCommentIds",value:function(){var e;return(null===(e=this.module)||void 0===e?void 0:e.getTempCommentIds())||new Set}},{key:"calcCommentPosition",value:function(e){var n;return(null===(n=this.module)||void 0===n?void 0:n.calcCommentPosition(e))||[]}},{key:"getRecordsByCommentId",value:function(e){var n;return null===(n=this.module)||void 0===n?void 0:n.getRecordsByCommentId(e)}},{key:"getCommentsByRecordId",value:function(e){var n;return null===(n=this.module)||void 0===n?void 0:n.getCommentsByRecordId(e)}},{key:"getBlockModelsByCommentId",value:function(e){var n;return(null===(n=this.module)||void 0===n?void 0:n.getBlockModelsByCommentId(e))||[]}},{key:"getCommentByCommentId",value:function(e){var n;return null===(n=this.module)||void 0===n?void 0:n.getCommentByCommentId(e)}},{key:"findTempCommentsByRecordId",value:function(e){var n;return(null===(n=this.module)||void 0===n?void 0:n.findTempCommentsByRecordId(e))||[]}},{key:"getCommentIsFinished",value:function(e){var n;return(null===(n=this.module)||void 0===n?void 0:n.getCommentIsFinished(e))||!0}},{key:"getPositionByCommentId",value:function(e){var n;return null===(n=this.module)||void 0===n?void 0:n.getPositionByCommentId(e)}},{key:"getPositionList",value:function(){var e;return(null===(e=this.module)||void 0===e?void 0:e.getPositionList())||[]}},{key:"getDocComments",value:function(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(null===(e=this.module)||void 0===e?void 0:e.getDocComments(n,r))||new Map}},{key:"isThirdPartyComment",value:function(e,n){var r;return(null===(r=this.module)||void 0===r?void 0:r.isThirdPartyComment(e,n))||!1}},{key:"isThirdPartyTypeComment",value:function(e){var n;return(null===(n=this.module)||void 0===n?void 0:n.isThirdPartyTypeComment(e))||!1}},{key:"isThirdPartyCommentLoaded",value:function(e){var n;return(null===(n=this.module)||void 0===n?void 0:n.isThirdPartyCommentLoaded(e))||!1}},{key:"isThirdPartyBlock",value:function(e){var n;return(null===(n=this.module)||void 0===n?void 0:n.isThirdPartyBlock(e))||!1}},{key:"handleThirdPartyLoaded",value:function(e,n){var r=this;this.ready((function(){var o;null===(o=r.module)||void 0===o||o.handleThirdPartyLoaded(e,n)}))}},{key:"handleThirdPartyUpdated",value:function(e,n){var r=this;this.ready((function(){var o;null===(o=r.module)||void 0===o||o.handleThirdPartyUpdated(e,n)}))}},{key:"handleThirdPartyCommentDidAdd",value:function(e,n){var r=this;this.ready((function(){var o;null===(o=r.module)||void 0===o||o.handleThirdPartyCommentDidAdd(e,n)}))}},{key:"triggerStartNewDocComment",value:function(e){var n;null===(n=this.module)||void 0===n||n.triggerStartNewDocComment(e)}},{key:"startNewDocComment",value:function(e){var n;null===(n=this.module)||void 0===n||n.startNewDocComment(e)}},{key:"getCommentRect",value:function(e,n){var r;return(null===(r=this.module)||void 0===r?void 0:r.getCommentRect(e,n))||null}},{key:"scrollToWholeComment",value:function(){var e=m()(i.a.mark((function e(n,r){var o,c=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){c.ready((function(){e(void 0)}))}));case 2:return e.abrupt("return",null===(o=this.module)||void 0===o?void 0:o.scrollToWholeComment(n,r));case 3:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"setCommentable",value:function(e){var n=this;this.ready((function(){var r;null===(r=n.module)||void 0===r||r.setCommentable(e)}))}},{key:"setCommentViewPortLock",value:function(e){var n;null===(n=this.module)||void 0===n||n.setCommentViewPortLock(e)}},{key:"toggleCommentPanel",value:function(e){var n;null===(n=this.module)||void 0===n||n.toggleCommentPanel(e)}},{key:"destroy",value:function(){var e;null===(e=this.module)||void 0===e||e.destroy()}},{key:"module",get:function(){return this._module}},{key:"commentScroller",get:function(){var e,n,r;return{scrollTop:(null===(e=this.module)||void 0===e?void 0:e.commentScroller.scrollTop)||0,scrollToComment:this._scrollToComment,scrollToBottom:this._scrollToBottom,calcScrollTop:null===(n=this.module)||void 0===n?void 0:n.commentScroller.calcScrollTop,fixHorizontalScroll:this._fixHorizontalScroll,getCommentPositionInfo:null===(r=this.module)||void 0===r?void 0:r.commentScroller.getCommentPositionInfo}}},{key:"eventCollector",get:function(){return{collectEvent:this._collectEvent}}},{key:"activeCommentId",get:function(){var e;return(null===(e=this.module)||void 0===e?void 0:e.activeCommentId)||null}},{key:"isRecordChangeDebounceUpdated",get:function(){var e,n;return null===(e=null===(n=this.module)||void 0===n?void 0:n.isRecordChangeDebounceUpdated)||void 0===e||e}},{key:"disableScrollInVC",get:function(){return this.module?this.module.disableScrollInVC:Object(I.n)()}},{key:"vcPosition",get:function(){var e;return null===(e=this.module)||void 0===e?void 0:e.vcPosition}}]),e}();function M(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}function j(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function D(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?j(Object(r),!0).forEach((function(n){b()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function A(){var e={};return e.promise=new Promise((function(n,r){e.resolve=n,e.reject=r})),e}function P(e){return L.apply(this,arguments)}function L(){return L=m()(i.a.mark((function e(n){var r,o,c=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:2,o=c.length>2&&void 0!==c[2]?c[2]:1e3,e.prev=2,e.next=5,n();case 5:return e.abrupt("return",e.sent);case 8:if(e.prev=8,e.t0=e.catch(2),!r){e.next=16;break}return e.next=13,Object(S.E)(o);case 13:return e.abrupt("return",P(n,r-1,o));case 16:throw e.t0;case 17:case"end":return e.stop()}}),e,null,[[2,8]])}))),L.apply(this,arguments)}function N(){return F.apply(this,arguments)}function F(){return(F=m()(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([r.e("dx_Vhz"),r.e("dx_Yon")]).then(r.bind(null,"dx_ELL6")));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function U(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="ccm_doc_load_comment";Object(E.N)(r,D({state:e},n))}var H=function(e){d()(r,e);var n=M(r);function r(e){var o;return a()(this,r),(o=n.call(this,e)).isLoading=!1,o.load=m()(i.a.mark((function e(){var n,c,a,l;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.isReady&&!o.isLoading){e.next=2;break}return e.abrupt("return");case 2:if(U("start"),i=r.defer,!Object(k.isFunction)(null===i||void 0===i?void 0:i.then)){e.next=9;break}return e.next=6,r.defer;case 6:n=e.sent,e.next=37;break;case 9:if(!r.defer){e.next=13;break}n=r.defer,e.next=37;break;case 13:return e.prev=13,U("match_default"),o.isLoading=!0,c=A(),r.defer=c.promise,e.next=20,P(_.loadCommentDeps);case 20:return U("load_deps_done"),x.S.updateLoadMainStageDurationList(_.FILE_TYPE.DOCX,_.LOAD_MAIN_STAGE_DURATION_LIST_KEY.FETCH_FILE_COMMENT_START),_.commentSDKHelper.getCurrentSuiteCommentSDK(),U("get_sdk_done"),e.next=25,P(N);case 25:a=e.sent,U("load_module_done"),n=a.default,c.resolve(n),r.defer=n,e.next=37;break;case 32:return e.prev=32,e.t0=e.catch(13),U("error",{message:e.t0.message,data:JSON.stringify({stack:e.t0.stack})}),o.isLoading=!1,e.abrupt("return");case 37:l=new n(o.options),o.setModule(l),o.ready(!0),l.detectReady(),U("ready"),l.getInnerCommentModule().hasInitCommentData&&l.triggerReady(),o.isLoading=!1;case 44:case"end":return e.stop()}var i}),e,null,[[13,32]])}))),[O.S.isLarkFeed,!Object(_.getMinaConfig)("ccm.docx.comment_delay_enable",!1),o.options.blockManager.config.get("isPresentationMode")].includes(!0)&&(console.log("loadComment immediately"),o.load()),o}return s()(r,[{key:"handleCommentDidAdd",value:function(e,n){var r=this;this.ready((function(){var o;null===(o=r.module)||void 0===o||o.handleCommentDidAdd(e,n)}))}},{key:"handleCommentDidResolve",value:function(e){var n=this;this.ready((function(){var r;null===(r=n.module)||void 0===r||r.handleCommentDidResolve(e)}))}},{key:"handleCommentDidDelete",value:function(e,n){var r=this;this.ready((function(){var o;null===(o=r.module)||void 0===o||o.handleCommentDidDelete(e,n)}))}},{key:"highlightWholeComment",value:function(e,n,r){var o=this;this.ready((function(){var i;null===(i=o.module)||void 0===i||i.highlightWholeComment(e,n,r)}))}},{key:"updateStoreCommentPosition",value:function(e,n){var r=this;this.ready((function(){var o;null===(o=r.module)||void 0===o||o.updateStoreCommentPosition(e,n)}))}},{key:"getInnerCommentModule",value:function(){var e;return null===(e=this.module)||void 0===e?void 0:e.getInnerCommentModule()}}]),r}(R);H.defer=null;var V=H;function W(e,n,r,o,i,c,a,l,s,u){e.commentModule=new V({blockManager:o,token:i,rect:n,fold:r,commentable:c,pageEventEmitter:l,viewport:s,selectionAPI:e.selectionAPI,scrollingDetector:e.scrollingDetector,vcController:e.vcController,scroller:u})}},dx_IdzY:function(e,n,r){"use strict";r.d(n,"E",(function(){return m})),r.d(n,"x",(function(){return _})),r.d(n,"I",(function(){return k})),r.d(n,"B",(function(){return i})),r.d(n,"xj",(function(){return O})),r.d(n,"g",(function(){return x})),r.d(n,"z",(function(){return E})),r.d(n,"r",(function(){return S}));var o,i,c=r("dx_lSNA"),a=r.n(c),l=r("dx_qJ1M"),s=r("dx_TwjU"),u=r("dx_BuQo"),d=r("dx_uZlF"),f=r("dx_Q112"),h=r("dx_lwsE"),p=r.n(h),v=r("dx_W8MJ"),g=r.n(v),b=function(){function e(){p()(this,e),this.getNthUndoRecordFromTop=void 0}return g()(e,[{key:"setUndoDispatcher",value:function(){}},{key:"batchedUndo",value:function(e){e()}},{key:"undo",value:function(){}},{key:"redo",value:function(){}},{key:"mergeRecords",value:function(){}},{key:"clear",value:function(){}},{key:"destroy",value:function(){}}]),e}(),y=r("dx_gA4Q"),m="CollabConnector",_="0",k="clientside-";!function(e){e.EMBED="embed",e.PLAINTEXT="plaintext",e.FORMATTEDTEXT="formattedtext",e.LINK="link"}(i||(i={}));var O=(o={},a()(o,l.m.ContentState,u.O),a()(o,l.m.Range,d.A),a()(o,l.m.ZoneState,y.h),a()(o,l.m.UndoModule,b),a()(o,l.m.InputModel,f.N),o),x=new s.M;x.set(O);var E=["flushInput","composition","deleteBackward","codeblock:key:enter","replaceText"],S=["insertAt","insertText","deleteRange","deleteForward","deleteToLineStart","deleteToLineEnd","deleteEntireWordBackward","deleteEntireWordForward","multiple:deleteMultipleSelection","applyPlainTextIntoTextualBlock","flowbaseRecordOnDelete","replaceSlashToAt","addReminder","pasteIntoBlock","insertInlineBlockInTextualBlock","autoComplete","onApplyChange","mention doc","mention user","deleteText"]},dx_If1T:function(e,n,r){"use strict";(function(t){var e=r("dx_TSYQ"),o=r.n(e),i=r("dx_cDcd"),c=r.n(i),a=r("dx_rR5J"),l=r("dx_Mzjv"),s=r("dx_z3zX"),u=r("dx_viBb"),d=Object(i.memo)((function(e){var n=e.desc,r=e.appName,i=e.imgUrl;return c.a.createElement("div",{className:o()("docx-menu-guide-panel",{"has-img":!!i})},i&&c.a.createElement("img",{className:"guide-panel-thumb",src:i,alt:""}),n&&c.a.createElement("section",{className:"guide-panel-desc"},n),r&&c.a.createElement("section",{className:"guide-panel-app-name"},t("CreationDoc_ISV_CreatedBy_title",void 0,void 0,r)))}));n.S=function(e){var n=e.guideInfo,r=e.blockManager,o=e.selectionAPI,i=e.boundary,f=e.visible,h=e.target;return c.a.createElement(s.S,{visible:f,direction:l.R.RightCenter,blockManager:r,selectionAPI:o,boundary:i,target:h,zIndex:a.M+1,once:!0,offset:u.f,sticky:u.h,bubbleForbidden:!0},c.a.createElement(d,n))}}).call(this,r("dx_E9Eu"))},dx_Ifm4:function(e,n,r){},dx_IjPx:function(e,n,r){"use strict";r.d(n,"S",(function(){return i}));var o=r("dx_cDcd");function i(e){var n=Object(o.useRef)(e);return Object(o.useLayoutEffect)((function(){n.current=e}),[e]),n}},dx_InLz:function(e,n,r){"use strict";r.d(n,"U",(function(){return a})),r.d(n,"u",(function(){return l})),r.d(n,"j",(function(){return s})),r.d(n,"Z",(function(){return u}));var o=r("dx_QBqw"),i=["AREA","BASE","COL","COMMAND","EMBED","TITLE","SVG","KEYGEN","LINK","META","PARAM","SOURCE","TRACK","WBR","STYLE","SCRIPT","#COMMENT"],c=["P","CODE"],a=function(e){var n,r=e.nodeName.toUpperCase(),o=null===(n=e.parentElement)||void 0===n?void 0:n.nodeName.toUpperCase();return!i.includes(r)&&(!!(o&&c.includes(o)||3!==e.nodeType)||e.textContent&&!/^\n*$/.test(e.textContent))};function l(e,n){var r=e.match(/^(\d+)/);return r?Number(r[0]):n}function s(e,n,r){return e.reduce((function(o,i,c){var a=o.length,l=o[a-1],s=e[c+1];if(null===r||void 0===r||r(i,s),a>0&&l.context[n]&&i.context[n])for(var u=o,d=o[a-1],f=i.context[n];d;){if(f<=d.context[n]){u.push(i);break}if(0===d.children.length){d.children.push(i);break}var h=d.children[d.children.length-1];if(f<=h.context[n]){d.children.push(i);break}u=(d=h).children}else o.push(i);return o}),[])}function u(e){for(var n=e.cell_set,r=e.rows_id,i=e.columns_id,c={},a=0,l=0;l<i.length;l++){for(var s=i[l],u=0,d=0;d<r.length;){var f=r[d],h=n["".concat(f).concat(s)].merge_info.row_span;u+=h,d+=h}c[s]=u,a=Math.max(u,a)}if(!(a<=r.length)){for(var p=r.length,v=p;v<a;v++)r.push(Object(o.b)());i.forEach((function(e){for(var o=p;o<a;o++)n["".concat(r[o]).concat(e)]={children:[],merge_info:{row_span:1,col_span:1}}}))}}},dx_IoVS:function(e,n,r){"use strict";r.d(n,"y",(function(){return E}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W7W2"),a=r.n(c),l=r("dx_a1gu"),s=r.n(l),u=r("dx_Nsbk"),d=r.n(u),f=r("dx_Vvd7"),h=r("dx_N9dL"),p=r("dx_fEKD"),v=r("dx_B28d"),g=r("dx_W8MJ"),b=r.n(g);function y(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var m=function(e){a()(r,e);var n=y(r);function r(){return i()(this,r),n.apply(this,arguments)}return b()(r,null,[{key:"updateBlockModelStruct",value:function(){}},{key:"deriveChildrenFromSnapshot",value:function(e){return[]}}]),r}(r("dx_NMQJ").D);m.type=v.B.FALLBACK;var _,k,O=r("dx_GH8q");function x(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var E=Object(f.H)({providers:[{provide:h.RecordSnapshotCreator,useValue:{type:v.B.FALLBACK,create:p.b}}]})((k=function(e){a()(r,e);var n=x(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).blocks=[[m,{viewCreator:O.g}]],e}return r}(f.y),_=k))||_},dx_IsMn:function(e,n,r){},dx_IvU4:function(e,n,r){"use strict";var o,i,c,a,l,s,u,d=r("dx_lwsE"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_D8nn"),g=r("dx_XW5M");!function(e){e.HAS_BLOCK_MENU="hasBlockMenu",e.HAS_TEXT_TOOLBAR="hasTextToolbar",e.HAS_TEXT_BLOCK_TOOLBAR="hasTextBlockToolbar",e.HAS_TABLE_CELL_TOOLBAR="hasTableCellToolbar",e.HAS_TABLE_COLUMN_TOOLBAR="hasTableColumnToolbar",e.HAS_BLOCK_TOOLBAR="hasBlockToolbar"}(u||(u={})),o=u.HAS_BLOCK_MENU,i=u.HAS_TEXT_TOOLBAR,c=u.HAS_TEXT_BLOCK_TOOLBAR,a=u.HAS_TABLE_CELL_TOOLBAR,l=u.HAS_TABLE_COLUMN_TOOLBAR,s=u.HAS_BLOCK_TOOLBAR;var b=function(){function e(){f()(this,e),this[o]=!1,this[i]=!1,this[c]=!1,this[a]=!1,this[l]=!1,this[s]=!1}return p()(e,[{key:"canShowBlockToolbar",value:function(){return!(this[u.HAS_BLOCK_MENU]||this[u.HAS_TEXT_TOOLBAR]||this[u.HAS_TEXT_BLOCK_TOOLBAR]||this[u.HAS_TABLE_CELL_TOOLBAR]||this[u.HAS_TABLE_COLUMN_TOOLBAR])}},{key:"canShowTextualBlockToolbar",value:function(){return!this[u.HAS_BLOCK_MENU]}},{key:"setStatusOfKey",value:function(e,n,r){this[e]!==n&&(this[e]=n,r&&r())}},{key:"canShowBlockMenu",value:function(){return!this[u.HAS_TEXT_TOOLBAR]&&!this[u.HAS_TABLE_COLUMN_TOOLBAR]&&!this[u.HAS_TABLE_CELL_TOOLBAR]}},{key:"isShowBlockToolbar",value:function(){return this[u.HAS_BLOCK_TOOLBAR]}},{key:"setPanelStatus",value:function(e,n){switch(e){case g.t.Add:case g.t.BlockMenu:this.setStatusOfKey(u.HAS_BLOCK_MENU,n,(function(){n&&v.S.emit(v.p.COMMON.BLOCK_MENU_PANEL_SHOW)}));break;case g.t.BlockToolbar:this.setStatusOfKey(u.HAS_BLOCK_TOOLBAR,n);break;case g.t.PopoverMenu:this.setStatusOfKey(u.HAS_TABLE_COLUMN_TOOLBAR,n);break;case g.t.TableCell:this.setStatusOfKey(u.HAS_TABLE_CELL_TOOLBAR,n);break;case g.t.TextualBlockToolbar:this.setStatusOfKey(u.HAS_TEXT_BLOCK_TOOLBAR,n,(function(){n&&v.S.emit(v.p.COMMON.HIDE_BLOCK_TOOLBAR)}));break;case g.t.TextualToolbar:this.setStatusOfKey(u.HAS_TEXT_TOOLBAR,n,(function(){v.S.emit(v.p.COMMON.TEXT_TOOLBAR_STATUS_CHANGE,n),v.S.emit(v.p.COMMON.FORCE_UPDATE_BLOCK_MENU_TOOLBAR_STATUS)}))}}},{key:"canShowPanel",value:function(e){switch(e){case g.t.BlockMenu:return this.canShowBlockMenu();case g.t.BlockToolbar:return this.canShowBlockToolbar();case g.t.TextualBlockToolbar:return this.canShowTextualBlockToolbar();default:return!1}}},{key:"getPanelStatus",value:function(e){switch(e){case g.t.Add:case g.t.BlockMenu:return this[u.HAS_BLOCK_MENU];case g.t.BlockToolbar:return this[u.HAS_BLOCK_TOOLBAR];case g.t.PopoverMenu:return this[u.HAS_TABLE_COLUMN_TOOLBAR];case g.t.TableCell:return this[u.HAS_TABLE_CELL_TOOLBAR];case g.t.TextualBlockToolbar:return this[u.HAS_TEXT_BLOCK_TOOLBAR];case g.t.TextualToolbar:return this[u.HAS_TEXT_TOOLBAR]}}}]),e}();n.S=new b},dx_IwME:function(e,n,r){"use strict";r.d(n,"U",(function(){return R})),r.d(n,"Q",(function(){return M}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lSNA"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_uxuX"),v=r("dx_h6a8"),g=r("dx_Fimk"),b=r("dx_eSV8"),y=r("dx_b28D");function m(){return Date.now()}var _=r("dx_S0Si"),k=r("dx_O1Ou"),O=r("dx_YCIe"),x=r("dx_rdYh"),E=r("dx_PciH");function S(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function C(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?S(Object(r),!0).forEach((function(n){s()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var I=function(){function e(n,r,o,i){d()(this,e),this.recordId=r,this.vcModule=o,this.startTime=m(),this.reporter=void 0,this.reporter=E.L.get(n,i,(function(e){return e.data.offsetRatioMap}))}return h()(e,[{key:"report",value:function(e,n){var r=this.startTime,o=this.recordId,i=this.vcModule,c={timestamp:r,recordId:o},a=n?C(C({},c),{},{info:"[".concat(i,"]: ").concat(n)}):c;this.reporter.report(e,a)}}]),e}();function B(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function T(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?B(Object(r),!0).forEach((function(n){s()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var w=Object(y.h)("scrollable:vc-sync-manager"),R=function(){function e(n){var r=this;d()(this,e),this.props=n,this.helper=void 0,this.calcAndSendScrollState=function(e,n){var o;return null===(o=r.helper)||void 0===o?void 0:o.calcAndSendScrollState(e,n)},this.replayLast=function(e){var n;return null===(n=r.helper)||void 0===n?void 0:n.replayLast(e)},this.handleReplay=function(e){var n;return null===(n=r.helper)||void 0===n?void 0:n.handleReplay(e)},this.canReplay=function(){var e;return null===(e=r.helper)||void 0===e?void 0:e.canReplay()},this.getLastOffsetRatio=function(){var e;return null===(e=r.helper)||void 0===e?void 0:e.getLastOffsetRatio()}}return h()(e,[{key:"init",value:function(){var e=this.props.scrollManage.scrollModel;e.isModelReady()&&(this.helper=new M(T(T({},this.props),{},{scrollModel:e})))}},{key:"destroy",value:function(){var e;null===(e=this.helper)||void 0===e||e.destroy(),this.helper=void 0}}]),e}(),M=function(){function e(n){var r=this;d()(this,e),this.props=n,this.destroyCallbacks=void 0,this.lastAction=void 0,this.vcModule=void 0,this.scrollModel=void 0,this.logId=void 0,this.handleReplay=function(e){if(e.actionType===k.X.SCROLL){var n=e;if(Object(v.isEmpty)(n.data.offsetRatioMap))return r.props.vcController.reportReplay(k.s.IGNORE,n.uuid,"ignore default state by vc-sync-manager",m()),void r.clearAction("handleReplay.emptyMap");var o=r.props.model.recordId,i=n.data.offsetRatioMap;if(Object.prototype.hasOwnProperty.call(i,o)){var c=Object(x.X)(i,o);r.updateLastAction({action:e,offsetRatio:c},"handleReplay.newAction"),r.lastAction&&r.replayAndReport(r.lastAction,"handleReplay")}else r.lastAction=void 0}},this.vcModule=n.enableVcOptions.vcModule,this.scrollModel=n.scrollModel,this.logId=n.logId,this.init()}return h()(e,[{key:"init",value:function(){var e=this,n=this.props,r=n.vcController,o=n.model.recordId,i=this.vcModule,c=r.register({recordId:o,moduleName:i,defaultState:O.B,cycleHandler:function(n){n!==p.STOP_FOLLOW&&n!==p.START_RECORD||e.clearAction("cycleHandler.".concat(n))},replayHandler:this.handleReplay});c&&(this.destroyCallbacks=[c])}},{key:"destroy",value:function(){var n;null===(n=this.destroyCallbacks)||void 0===n||n.forEach((function(e){return e()})),this.destroyCallbacks=void 0,this.clearAction("destory"),e.blockScrollable.delete(this.props.model.recordId)}},{key:"clearAction",value:function(e){this.updateLastAction(void 0,e)}},{key:"replayAndReport",value:function(){var e=a()(i.a.mark((function e(n,r){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.doReplay(n,r);case 2:return o=e.sent,this.report(n,o,r),e.abrupt("return",o);case 5:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"report",value:function(e,n,r){var o=this.props,i=o.vcController,c=o.model.recordId,a=this.vcModule,l=e.action,s=e.offsetRatio,u=n.reportType,d=n.reportReason,f=n.reportEvent;w(this.logId,"%s.report: reportType=%s, ratio=%o, uuid=%s, isRetry=%s, reportReason=%s",r,u,s,l.uuid,l.isRetry,d),new I(e.action,c,a,i).report(u,d),e.lastReportType=u,f&&Object(g.N)("vc_action_apply_dev",f)}},{key:"canReplay",value:function(){var e=this.props,n=e.vcController,r=e.blockManager,o=e.model;return Boolean(n.isFollow&&this.lastAction&&r.layoutManager.isBlockActive(o.id))}},{key:"replayLast",value:function(e){var n=this.lastAction,r=this.scrollModel;if(n&&this.canReplay()){var o=n.offsetRatio,i=n.lastReportType;r.scrollRatio!==o||i!==k.s.SUCCESS?this.replayAndReport(n,"".concat(e,".replayLast")):w(this.logId,"%s.replayLast: skip due to same ratio(%s)",e,n.offsetRatio)}}},{key:"getLastOffsetRatio",value:function(){var e;return null===(e=this.lastAction)||void 0===e?void 0:e.offsetRatio}},{key:"updateLastAction",value:function(e,n){var r=this.lastAction;r&&!r.lastReportType&&this.report(r,{reportType:k.s.IGNORE,reportReason:n},n),this.lastAction=e}},{key:"calcAndSendScrollState",value:function(n,r){var o=this.scrollModel,i=o.scrollRatio,c=o.viewType,a=o.isScrollable,l=this.props,u=l.vcController,d=l.enableVcOptions,f=d.offsetRatioObject,h=d.vcModule;e.blockScrollable.set(n,a);var p=(u.getState(h,k.X.SCROLL)||{offsetRatioMap:{}}).offsetRatioMap,g=r===_.L.COMMENT_SCROLL?void 0:i,b=f?{viewType:c,offsetRatio:g}:g;if(Object(v.isEqual)(p[n],b))w(this.logId,"calcAndSendScrollState: same ratio(%o), skip",b);else{var y={offsetRatioMap:T(T({},p),{},s()({},n,b))};w(this.logId,"calcAndSendScrollState: %o, from=%s",b,r),u.sendState(h,k.X.SCROLL,y)}}},{key:"doReplay",value:function(){var e=a()(i.a.mark((function e(n,r){var o,c,a,l,s,u,d,f,h,p,g,y,m,x,E,S,C,I;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.offsetRatio,c=n.action,a=c.reason,l=this.vcModule,s=this.props,u=s.scrollManage,d=s.blockManager,f=s.model,h=this.scrollModel,!Object(v.isUndefined)(o)){e.next=7;break}return e.abrupt("return",{reportType:k.s.IGNORE,reportReason:"undefined offsetRatio"});case 7:if(d.layoutManager.isBlockActive(f.id)){e.next=9;break}return e.abrupt("return",{reportType:k.s.IGNORE,reportReason:"not in buffer, retry on enterbuffer"});case 9:if(p=this.getPosInfo(h),g=h.getScrollLeftByRatio(o),y={scrollLeft:g.mainScrollLeft,subScrollLeft:g.subScrollLeft},u.scrollByRatio(o,!1,"".concat(r,".").concat(_.L.VC_REPLAY)),(m=this.checkReplayResult(o,h)).reportType===k.s.FAIL){e.next=16;break}return e.abrupt("return",m);case 16:return e.next=18,Object(b.E)(O.f);case 18:if(n===this.lastAction){e.next=20;break}return e.abrupt("return",{reportType:k.s.IGNORE,reportReason:"new action arrived"});case 20:if(m=this.checkReplayResult(o,h),E=(x=m).reportType,S=x.reportReason,E===k.s.FAIL){e.next=24;break}return e.abrupt("return",m);case 24:return C=this.getParam1(h,p,y,a),I={code:1,info:S,action:l,string_param_1:C,string_param_2:JSON.stringify(o)},e.abrupt("return",T(T({},m),{},{reportEvent:I}));case 27:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"checkReplayResult",value:function(e,n){var r=n.scrollRatio;if(!n.isScrollable)return{reportType:k.s.SUCCESS,reportReason:"no need to scroll, isScrollable = false"};var o=Object(x.L)(e,r),i=o?"":"offset ratio diff is greater than threshold, want ".concat(e,", got ").concat(r);return{reportType:o?k.s.SUCCESS:k.s.FAIL,reportReason:i}}},{key:"getParam1",value:function(e,n,r,o){var i=this.props.scrollManage,c=e.scrollRatio,a=document.body.contains(i.getScrollContainer()),l="".concat(c);a?"hidden"===document.visibilityState&&(l="".concat(l,", document visible is hidden")):l="".concat(l,", hostElement is not on dom tree");var s=this.getPosInfo(e);return"".concat(l,", ")+"current data: ".concat(JSON.stringify(s))+"prev data: ".concat(JSON.stringify(n))+"target scroll: ".concat(JSON.stringify(r),", ")+"replay reason: ".concat(o)}},{key:"getPosInfo",value:function(e){return{subScrollLeft:e.subScrollLeft,scrollLeft:e.mainScrollLeft,maxScrollLeft:e.totalMaxScrollLeft}}}],[{key:"ensureSame",value:function(n){return!1===e.blockScrollable.get(n)}}]),e}();M.blockScrollable=new Map},dx_IyNS:function(e,n,r){"use strict";r.d(n,"y",(function(){return i}));var o=r("dx_QBqw");function i(e,n){return{tableId:e,tableSnapshot:n,rowIds:n.rows_id,colIds:n.columns_id,cellsLayout:Object(o.c)(n)}}},dx_J3jD:function(e,n,r){"use strict";r.d(n,"k",(function(){return a}));var o=r("dx_cDcd"),i=r.n(o),c=r("dx_BaZy"),a=r.n(c)()({loader:function(){return Promise.all([r.e("dx_vNU"),r.e("dx_UTc"),r.e("dx_v7vu"),r.e("dx_j1jX"),r.e("dx_HUt")]).then(r.bind(null,"dx_D379"))},loading:function(){return null},render:function(e,n){var r=e.ShortCutShare;return i.a.createElement(r,n)}})},dx_J8b8:function(e,n,r){"use strict";(function(t){r.d(n,"c",(function(){return C}));var e=r("dx_lSNA"),o=r.n(e),i=r("dx_RIqP"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_W7W2"),f=r.n(d),h=r("dx_a1gu"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=r("dx_B28d"),y=r("dx_NMQJ"),m=r("dx_x1WV"),_=r("dx_EGHe"),k=r("dx_lROi"),O=r("dx_UTG8");function x(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function E(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?x(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function S(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}var C=function(e){f()(r,e);var n=S(r);function r(e){var o;return l()(this,r),(o=n.call(this,e)).matches=null,o.findKeyword=void 0,o}return u()(r,[{key:"getText",value:function(){return t("block.poll")}},{key:"find",value:function(e){var n=this;if(!this.matches||this.findKeyword!==e){var r=[],o=this.record.snapshot,i=o.option_map,a=o.option_ids,l=o.title,s=this.generatePollBlockMatches(O.InputPipe.getPlainText(l),e,"title");r.push.apply(r,c()(s)),a.forEach((function(o){var a=i[o];r.push.apply(r,c()(n.generatePollBlockMatches(O.InputPipe.getPlainText(a.text),e,o)))})),this.matches=r,this.findKeyword=e}return c()(this.matches)}},{key:"generatePollBlockMatches",value:function(e,n,r){var o={blockManager:this.editorAPI.getService(m.a),blockId:this.id,key:n,position:r,range:[0,0]};return Object(k.A)(e,n).map((function(e){return new _.i(E(E({},o),{},{range:[e.start,e.end]}))}))}}]),r}(y.D);C.type=b.B.POLL}).call(this,r("dx_E9Eu"))},dx_J93J:function(e,n,r){"use strict";r.d(n,"v",(function(){return v}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f);function p(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var v=function(e){s()(r,e);var n=p(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"match",value:function(e){return e===r.KEY}},{key:"render",value:function(e){return e.class+=" trigger-holder-".concat(e.attributes[r.KEY]),e.children}}]),r}(r("dx_N8Nu").o);v.KEY="trigger"},dx_JFWd:function(e,n,r){"use strict";r.d(n,"E",(function(){return l})),r.d(n,"b",(function(){return d})),r.d(n,"y",(function(){return f})),r.d(n,"f",(function(){return h})),r.d(n,"h",(function(){return p})),r.d(n,"n",(function(){return v}));r("dx_FBWK");var o=r("dx_UtDZ"),i=r("dx_wy2R"),c=r.n(i),a=r("dx_c3cO");function l(e){var n=e.match(/\s{1}?[PA]?M?/i);n||(n=e.match(/\s?[PA]?M+?/i));var r=e.match(/(\d+)?(\uff1a|:)?(\d+)?/),o="";if(r&&r[0].length>0){var i=r[0].split(/:|\uff1a/);o+=i[0]+(i.length>1?":":"")+(i[1]||"")}else{var c=e.match(/\d+/);o+=c?c[0]:""}return o+=(n?n[0]:"").toUpperCase()}var s,u=function(e,n){if(o.LANG_MAP.en){var r=e>12?e-12:0===e?e+12:e,i=n<10?"0".concat(n):n,c=e>12||12===e&&n>=0?"PM":"AM";return"".concat(r,":").concat(i," ").concat(c)}return"".concat(e<10?"0".concat(e):e,":").concat(n<10?"0".concat(n):n)},d=function(e){var n=Math.floor(e/36e5);return u(n,e%36e5/6e4)},f=function(e){var n=e.toLowerCase().indexOf("pm")>-1;e=e.replace(/\uff1a/g,":").replace(/[^\d:]/g,"");if(/^([0-9]|[0-1]\d|2[0-3]):([0-9]|[0-5]\d)$/.test(e)){var r=e.split(":"),o=Number(r[0]);return n&&o<12&&(o+=12),60*(60*o+Number(r[1]))*1e3}return null},h=function(e){var n=Array(24).fill(null).map((function(e,n){return n})),r=Array(2).fill(null).map((function(e,n){return 30*n})),o=[];return n.forEach((function(e){r.forEach((function(n){var r,i;o.push({text:u(e,n),value:(r=e,i=n,60*(60*r+i)*1e3)})}))})),e&&o.some((function(n,r){return n.value===e||(n.value>e&&o.splice(r,0,{text:d(e),value:e}),n.value>e)})),o},p=function(){var e=h(),n=c()().valueOf()-c()().set(a.Z).valueOf(),r=e[0].value;return e.some((function(o,i){var c=o.value;return c>n&&(r=e[i-1].value),c>n})),r};function v(e){return c()().isAfter(e)?s.Red:c()(e).isBetween(c()(),c()().add("7","days"))?s.Orange:s.Blue}!function(e){e.Red="red",e.Orange="orange",e.Blue="blue"}(s||(s={}))},dx_JFYx:function(e,n,r){"use strict";r.d(n,"Pi",(function(){return f})),r.d(n,"T",(function(){return h})),r.d(n,"b",(function(){return p})),r.d(n,"P",(function(){return v})),r.d(n,"N",(function(){return y})),r.d(n,"a",(function(){return m})),r.d(n,"d",(function(){return _})),r.d(n,"S",(function(){return k})),r.d(n,"i",(function(){return O})),r.d(n,"n6",(function(){return x})),r.d(n,"l",(function(){return E})),r.d(n,"n",(function(){return S})),r.d(n,"B",(function(){return C}));var o,i,c,a,l,s,u,d,f,h,p,v,g=r("dx_lSNA"),b=r.n(g);!function(e){e.TextColor="text_color",e.Border="border_color",e.BackgroundColor="background_color"}(f||(f={})),function(e){e.Default="default",e.Red="red",e.Orange="orange",e.Yellow="yellow",e.Green="green",e.Blue="blue",e.Purple="purple",e.Neutral="neutral"}(h||(h={})),function(e){e.Default="default",e.Red="red",e.Orange="orange",e.Yellow="yellow",e.Green="green",e.Blue="blue",e.Purple="purple",e.Neutral="neutral"}(p||(p={})),function(e){e.Default="default",e.LightRed="lightRed",e.LightOrange="lightOrange",e.LightYellow="lightYellow",e.LightGreen="lightGreen",e.LightBlue="lightBlue",e.LightPurple="lightPurple",e.LightNeutral="lightNeutral",e.DarkGray="darkGary",e.DarkRed="darkRed",e.DarkOrange="darkOrange",e.DarkYellow="darkYellow",e.DarkGreen="darkGreen",e.DarkBlue="darkBlue",e.DarkPurple="darkPurple",e.DarkNeutral="darkNeutral"}(v||(v={}));var y=(o={},b()(o,h.Default,"N900"),b()(o,h.Neutral,"N500"),b()(o,h.Red,"R600"),b()(o,h.Orange,"O600"),b()(o,h.Yellow,"Y600"),b()(o,h.Green,"G600"),b()(o,h.Blue,"B600"),b()(o,h.Purple,"P600"),o),m=(i={},b()(i,v.Default,""),b()(i,v.LightNeutral,"N100"),b()(i,v.LightRed,"ccmtoken-doc-highlightcolor-bg-red-soft"),b()(i,v.LightOrange,"ccmtoken-doc-highlightcolor-bg-orange-soft"),b()(i,v.LightYellow,"ccmtoken-doc-highlightcolor-bg-sunflower-soft"),b()(i,v.LightGreen,"ccmtoken-doc-highlightcolor-bg-green-soft"),b()(i,v.LightBlue,"ccmtoken-doc-highlightcolor-bg-blue-soft"),b()(i,v.LightPurple,"ccmtoken-doc-highlightcolor-bg-purple-soft"),i),_=(c={},b()(c,v.DarkGray,"ccmtoken-doc-highlightcolor-callout-neutral-light"),b()(c,v.DarkNeutral,"N200"),b()(c,v.DarkRed,"ccmtoken-doc-highlightcolor-bg-red-solid"),b()(c,v.DarkOrange,"ccmtoken-doc-highlightcolor-bg-orange-solid"),b()(c,v.DarkYellow,"ccmtoken-doc-highlightcolor-bg-sunflower-solid"),b()(c,v.DarkGreen,"ccmtoken-doc-highlightcolor-bg-green-solid"),b()(c,v.DarkBlue,"ccmtoken-doc-highlightcolor-bg-blue-solid"),b()(c,v.DarkPurple,"ccmtoken-doc-highlightcolor-bg-purple-solid"),c),k=(a={},b()(a,p.Default,""),b()(a,p.Neutral,"N200"),b()(a,p.Red,"R200"),b()(a,p.Orange,"O200"),b()(a,p.Yellow,"S300"),b()(a,p.Green,"G200"),b()(a,p.Blue,"B200"),b()(a,p.Purple,"P200"),a),O=(l={},b()(l,p.Neutral,"N300"),b()(l,p.Red,"R300"),b()(l,p.Orange,"O300"),b()(l,p.Yellow,"S400"),b()(l,p.Green,"G300"),b()(l,p.Blue,"B300"),b()(l,p.Purple,"P300"),l),x=(s={},b()(s,p.Default,"bg-float"),b()(s,p.Neutral,"N300"),b()(s,p.Red,"R300"),b()(s,p.Orange,"O300"),b()(s,p.Yellow,"S300"),b()(s,p.Green,"G300"),b()(s,p.Blue,"B300"),b()(s,p.Purple,"P300"),s),E=(u={},b()(u,v.Default,"bg-float"),b()(u,v.LightNeutral,"N300"),b()(u,v.LightRed,"R100"),b()(u,v.LightOrange,"O100"),b()(u,v.LightYellow,"S100"),b()(u,v.LightGreen,"G100"),b()(u,v.LightBlue,"B100"),b()(u,v.LightPurple,"P100"),b()(u,v.DarkGray,"N200"),b()(u,v.DarkNeutral,"N400"),b()(u,v.DarkRed,"R200"),b()(u,v.DarkOrange,"O200"),b()(u,v.DarkYellow,"S200"),b()(u,v.DarkGreen,"G200"),b()(u,v.DarkBlue,"B200"),b()(u,v.DarkPurple,"P200"),u),S=(d={},b()(d,v.LightNeutral,.6),b()(d,v.DarkGray,.7),b()(d,v.DarkNeutral,.5),d),C="rgb(248, 249, 250)"},dx_JHBk:function(e,n,r){"use strict";r.d(n,"B",(function(){return a}));var o=r("dx_cDcd"),i=r.n(o),c=r("dx_xy70"),a=i.a.memo((function(){return Object(o.useEffect)((function(){return c.i.next(!0),function(){c.i.next(!1)}}),[]),null}))},dx_JHXr:function(e,n,r){"use strict";(function(t){var e,o,i,c,a,l,s,u=r("dx_o0o1"),d=r.n(u),f=r("dx_yXPU"),h=r.n(f),p=r("dx_yG8O"),v=r.n(p),g=r("dx_lwsE"),b=r.n(g),y=r("dx_PJYZ"),m=r.n(y),_=r("dx_W8MJ"),k=r.n(_),O=r("dx_W7W2"),x=r.n(O),E=r("dx_a1gu"),S=r.n(E),C=r("dx_Nsbk"),I=r.n(C),B=r("dx_Uyc2"),T=r.n(B),w=(r("dx_A1AB"),r("dx_xjz2")),R=r("dx_UtDZ"),M=r("dx_E1yU"),j=r("dx_B28d"),D=r("dx_NMQJ"),A=r("dx_dOu9"),P=r("dx_x1WV"),L=r("dx_KFKk"),N=r("dx_d2PS"),F=r("dx_Ai6r");function U(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=I()(e);if(n){var i=I()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return S()(this,r)}}var H=(e=Object(w.S)(),s=l=function(e){x()(r,e);var n=U(r);function r(e){var o;return b()(this,r),o=n.call(this,e),v()(o,"blockManager",i,m()(o)),v()(o,"imageManager",c,m()(o)),v()(o,"offlineUpload",a,m()(o)),o.isApplyBackUp=void 0,o.getPasteUploadInfo=function(e){var n,r=e.fileToken,o=e.src,i=e.oldRecord,c=e.file,a=e.uuid;return{driveToken:r,image:null===i||void 0===i||null===(n=i.snapshot)||void 0===n?void 0:n.image,file:c,src:o,uuid:a}},o.onPasteRecordAfterApply=function(e){var n;Object(M.S)(t("CreationDoc_DocX_ImageUpload_failed_toast"));var r=o.getPasteUploadInfo(e);Object(R.isOnline)()&&o.view&&Object(F.T)(o.view,o.record.id,r),null===(n=o.offlineUpload)||void 0===n||n.addStoreData(N.e.PASTE_IMAGE,o.record.id,r)},o}return k()(r,[{key:"view",get:function(){return this.editorAPI.viewService.getBlockViewByBlockId(this.id)}}]),k()(r,[{key:"onInit",value:function(e){var n=e.options;this.isApplyBackUp=!!n.isApplyBackup}},{key:"getText",value:function(){return"[".concat(t("editorbar.image"),"]")}},{key:"onPasteRecordAfterAccepted",value:function(){var e=h()(d.a.mark((function e(n){var r,o=this;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.getPasteUploadInfo(n),Object(F.R)({blockManager:this.blockManager,imageManager:this.imageManager,recordId:this.record.id,payload:r,onFinally:function(){var e;Object(R.isOnline)()&&(null===(e=o.offlineUpload)||void 0===e||e.removeStoreData(N.e.PASTE_IMAGE,o.record.id))}});case 2:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),r}(D.D),l.type=j.B.IMAGE,o=s,i=T()(o.prototype,"blockManager",[P.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=T()(o.prototype,"imageManager",[A.Y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=T()(o.prototype,"offlineUpload",[e,L.y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o);n.S=H}).call(this,r("dx_E9Eu"))},dx_JI81:function(e,n,r){"use strict";(function(t){var e=r("dx_Xqee"),o=r("dx_PcQO"),i=r("dx_h6a8"),c=r("dx_cDcd"),a=r.n(c),l=r("dx_amgp"),s=r("dx_MBBr"),u=(r("dx_BQEl"),"objective-status-editor");n.S=function(n){var r=n.progress,c=n.progressStatus,d=n.statusType,f=n.onChange,h=void 0===f?i.noop:f,p=d===l.l.USE_WORST?l.G.UNSET:c;return a.a.createElement("div",{className:"".concat(u,"__wrapper")},a.a.createElement("div",{className:"".concat(u,"__header")},a.a.createElement("span",{className:"".concat(u,"__label")},t("CreationDoc_Docs_OKR_Status_ProgressNum",{progress:r})),a.a.createElement(o.Tooltip,{title:t("CreationDoc_Docs_OKR_Status_ProgressObjectiveNum")},a.a.createElement(e.S,null))),a.a.createElement("div",{className:"".concat(u,"__progress-type-wrapper")},a.a.createElement("div",{className:"".concat(u,"__caption")},t("CreationDoc_Docs_OKR_StatusDefault")),a.a.createElement(o.Radio,{checked:d===l.l.USE_WORST,onChange:function(e){e.target.checked&&h({progressStatus:l.G.UNSET,statusType:l.l.USE_WORST})},value:l.l.USE_WORST},t("CreationDoc_Docs_OKR_StatusDefault_Desc"))),a.a.createElement("div",{className:"".concat(u,"__progress-status-wrapper")},a.a.createElement("div",{className:"".concat(u,"__caption")},t("CreationDoc_Docs_OKR_StatusCustom")),a.a.createElement(s.S,{value:p,onChange:function(e){h({progressStatus:e,statusType:l.l.CUSTOM})}})))}}).call(this,r("dx_E9Eu"))},dx_JLMK:function(e,n,r){},dx_JM9i:function(e,n,r){"use strict";var o=r("dx_Ufnh");r.d(n,"S",(function(){return o.S}))},dx_JMEe:function(e,n,r){"use strict";r.d(n,"L",(function(){return l}));var o=r("dx_cDcd"),i=r.n(o),c=r("dx_yzqx"),a=r("dx_MG1i"),l=function(e){var n=Object(a.j)(e.SelectionAPI)&&c.S.isIPadSafariBrowser;return!0===e.hasCover&&e.isSSR?null:i.a.createElement("div",{contentEditable:n?void 0:"false",style:{userSelect:"none"}},i.a.createElement("div",{className:"doc-meta-entry-wrapper"},e.children))}},dx_JMey:function(e,n,r){"use strict";function o(e){return e.docx.cover.coverInfo}function i(e){var n=e.docx.cover.coverInfo;return n&&!!n.type}function c(e){return e.docx.cover.isUploading}function a(e){return e.docx.cover.coverList}r.d(n,"a",(function(){return o})),r.d(n,"M",(function(){return i})),r.d(n,"n",(function(){return c})),r.d(n,"A",(function(){return a}))},dx_JOYA:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o),c=r("dx_faye"),a=r.n(c),l=r("dx_jLaS");n.S=function(e){var n=document.querySelector(".doc-cover-toolbar");return n?a.a.createPortal(i.a.createElement(l.S,e),n):null}},dx_JUA0:function(e,n,r){"use strict";(function(t){r.d(n,"X",(function(){return m}));var e=r("dx_RIqP"),o=r.n(e),i=r("dx_lwsE"),c=r.n(i),a=r("dx_W8MJ"),l=r.n(a),s=r("dx_W7W2"),u=r.n(s),d=r("dx_a1gu"),f=r.n(d),h=r("dx_Nsbk"),p=r.n(h),v=r("dx_B28d"),g=r("dx_NMQJ"),b=r("dx_QBqw");function y(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=p()(e);if(n){var i=p()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return f()(this,r)}}var m=function(e){u()(r,e);var n=y(r);function r(e){return c()(this,r),n.call(this,e)}return l()(r,null,[{key:"updateBlockModelStruct",value:function(e){var n=e.record,r=e.api,o=e.ops,i=e.insertChild,c=e.removeChild,a=n.id,l=n.snapshot,s=r.modelService.getBlockModelsByRecordId(n.id)[0];if(s&&o.some((function(e){return 0===e.p.length||"cell_set"===e.p[0]&&e.p.length<3}))){var u=new Map;s.children.forEach((function(e){u.set(e.recordId,e)}));var d=Object(b.T)(l),f=new Set(d);u.forEach((function(e,n){if(!f.has(n)){var r=u.get(n);c(a,r.position)}}));for(var h=0,p=d.length;h<p;++h){var v=d[h],g=u.get(v);g?(u.delete(v),g.position!==h&&(c(a,g.position),i(a,h,v))):i(a,h,v)}}}},{key:"deriveChildrenFromSnapshot",value:function(e){return Object(b.T)(e)}}]),l()(r,[{key:"getText",value:function(){return"[".concat(t("common.table"),"]")}},{key:"find",value:function(e){return this.children.reduce((function(n,r){return r.find?(n.push.apply(n,o()(r.find(e))),n):n}),[])}}]),r}(g.D);m.type=v.B.TABLE}).call(this,r("dx_E9Eu"))},dx_JUlI:function(e,n,r){"use strict";r.d(n,"T",(function(){return s})),r.d(n,"l",(function(){return u})),r.d(n,"W",(function(){return d})),r.d(n,"X",(function(){return f})),r.d(n,"Y",(function(){return h})),r.d(n,"y",(function(){return p})),r.d(n,"k",(function(){return v})),r.d(n,"lQ",(function(){return g})),r.d(n,"B",(function(){return b})),r.d(n,"f",(function(){return y}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_Mzjv"),a=r("dx_viBb"),l=r("dx_CkQe");function s(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(e){return e instanceof HTMLElement&&n.some((function(n){return e.classList.contains(n)}))}}function u(e,n){for(var r=e;r;){if(n(r))return r;r=r.parentElement}return null}function d(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r=e.closest(".docx-menu-wrapper");r&&(r.scrollTop>e.offsetTop-n?r.scrollTo(0,Math.max(e.offsetTop-n,0)):r.scrollTop+r.offsetHeight<e.offsetTop+e.offsetHeight+n&&r.scrollTo(0,e.offsetTop+e.offsetHeight+n-r.offsetHeight))}function f(e,n,r){var o="prev"===r?-1:1,c=e.length,a=n+o;if(a>=c){var l=e.findIndex((function(e){return!1!==e.canSelected&&!0!==e.disabled}));if(-1===l)return-1;a=l}else if(a<0){var s=i()(e).reverse().findIndex((function(e){return!1!==e.canSelected&&!0!==e.disabled}));if(-1===s)return-1;a=c-s-1}return a>=0&&a<c&&(!1===e[a].canSelected||!0===e[a].disabled)?f(e,a,r):a}function h(e){return e.reduce((function(e,n,r){return!1!==n.canSelected&&e.push(r),e}),[])}function p(e){switch(e){case c.R.BottomLeft:case c.R.TopLeft:return[-9,12];case c.R.BottomCenter:case c.R.TopCenter:return[0,12];case c.R.RightCenter:case c.R.LeftCenter:return a.f;default:return[0,0]}}function v(e){return!!(null===e||void 0===e?void 0:e.action)}function g(e){return!!(null===e||void 0===e?void 0:e.blockType)}function b(e){return e.type===l.F.MenuItemNormal}function y(e){return[l.F.SubmenuItemWithComponent,l.F.SubmenuItemWithChildren].includes(e.type)}},dx_JWrU:function(e,n,r){"use strict";r.d(n,"S",(function(){return o})),r.d(n,"b",(function(){return i}));var o=-1e4,i=-10001},dx_JXmB:function(e,n,r){"use strict";r.d(n,"n",(function(){return i})),r.d(n,"U",(function(){return a})),r.d(n,"e",(function(){return l})),r.d(n,"G",(function(){return s})),r.d(n,"M",(function(){return u}));var o=r("dx_B28d");function i(e){return!e||e.snapshot.type===o.B.PENDING}function c(e){var n=-1;return/heading\d/.test(e)&&(n=parseInt(/\d/.exec(e)[0])),n}function a(e){var n=c(e.type);if(n<-1)return!1;for(var r=e.previousSibling;r;){if(i(r.record))return!1;var o=c(r.record.snapshot.type);if(o>0&&n>=o)return!0;r=r.previousSibling}return!0}function l(e){for(var n=c(e.type),r=e.nextSibling;r;){if(i(r.record))return!1;var o=c(r.record.snapshot.type);if(o>0&&n>=o)return!0;r=r.nextSibling}return!0}function s(e){return!!i(e.record)||!!e.children.length&&e.children.some((function(e){return s(e)}))}function u(e){var n=e.record;if("DELETE_CHILD"===e.action.type){var r,o=null===(r=n.snapshot.children)||void 0===r?void 0:r[e.action.index];if(!o)return!1;var i=e.modelService.getBlockModelsByRecordId(o)[0];if(!i.type.startsWith("heading"))return!0;if(!a(i))return!1}return!0}},dx_JZDi:function(e,n,r){"use strict";r.d(n,"Y",(function(){return d})),r.d(n,"O",(function(){return f})),r.d(n,"Q",(function(){return h})),r.d(n,"q",(function(){return p})),r.d(n,"U",(function(){return v}));var o,i=r("dx_J4zp"),c=r.n(i),a=r("dx_h6a8"),l=r("dx_cDcd"),s=r.n(l),u=s.a.createContext(null),d=function(e){var n=e.onWikiSidebarResize,r=e.tokenFromWiki,o=e.getClientVarsRequestExtraParams,i=e.reportWikiFirstContentLoaded,c=e.reportWikiAllContentLoaded,a=e.children,l={onSidebarResize:n,isInWiki:!!r,token:r,getClientVarsRequestExtraParams:o,reportWikiFirstContentLoaded:i,reportWikiAllContentLoaded:c};return s.a.createElement(u.Provider,{value:l},a)},f=function(){return s.a.useContext(u)};!function(e){e[e.IDLE=0]="IDLE",e[e.RESIZING=1]="RESIZING"}(o||(o={}));var h=function(e){return e===o.RESIZING},p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.onResizeStart,r=e.onResizeEnd,i=f(),c=Object(l.useRef)(o.IDLE),s=Object(l.useCallback)((function(){return c.current=o.IDLE}),[]),u=Object(l.useMemo)((function(){return Object(a.debounce)((function(){s(),null===r||void 0===r||r()}),300,{trailing:!0})}),[r,s]),d=Object(l.useCallback)((function(){h(c.current)||(c.current=o.RESIZING,null===n||void 0===n||n()),u()}),[n,u]);return Object(l.useEffect)((function(){var e,n;i&&i.isInWiki&&(e=null===(n=i.onSidebarResize)||void 0===n?void 0:n.call(i,d));return function(){var n;s(),u.cancel(),null===(n=e)||void 0===n||n()}}),[i,s,u,d]),c},v=function(){var e=f(),n=Object(l.useState)(o.IDLE),r=c()(n,2),i=r[0],s=r[1],u=Object(l.useMemo)((function(){return Object(a.debounce)((function(){s(o.IDLE)}),300,{trailing:!0})}),[]),d=Object(l.useCallback)((function(){s(o.RESIZING),u()}),[u]);return Object(l.useEffect)((function(){var n,r;e&&e.isInWiki&&(n=null===(r=e.onSidebarResize)||void 0===r?void 0:r.call(e,d));return function(){var e;null===(e=n)||void 0===e||e()}}),[e,u,d]),Object(l.useEffect)((function(){return function(){u.cancel()}}),[]),i}},dx_JcnR:function(e,n,r){},dx_Je9X:function(e,n,r){"use strict";r.d(n,"F",(function(){return o.F})),r.d(n,"C",(function(){return o.C}));var o=r("dx_tfgj"),i=r("dx_o0o1"),c=r.n(i),a=r("dx_lSNA"),l=r.n(a),s=r("dx_yXPU"),u=r.n(s),d=r("dx_lwsE"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_iWIM"),g=r.n(v),b=r("dx_W7W2"),y=r.n(b),m=r("dx_a1gu"),_=r.n(m),k=r("dx_Nsbk"),O=r.n(k),x=r("dx_UtDZ"),E=r("dx_l6la"),S=r("dx_CZKf"),C=r("dx_D8nn"),I=r("dx_niVl"),B=r("dx_tPxY"),T=r("dx_gLqT");function w(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function R(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?w(Object(r),!0).forEach((function(n){l()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function M(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=O()(e);if(n){var i=O()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return _()(this,r)}}var j=function(e){y()(r,e);var n=M(r);function r(e){var i;return f()(this,r),(i=n.call(this,e)).handleSetCustomCover=function(){var e=u()(c.a.mark((function e(n,r){var o,a,l,s,u,d,f;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.file,a=n.imageUploader,l=URL.createObjectURL(o),i.updateCoverInfo({type:S.i.Customize,src:l,offset_ratio_x:0,offset_ratio_y:0,mime_type:o.type}),s=Object.assign({},r,{action_type:"album",pic_file_type:o.type}),e.prev=4,e.next=7,a.uploadImage(o);case 7:if(u=e.sent,d=u.token,f=u.mimeType,i.checkCoverUploadStatus(r)){e.next=11;break}return e.abrupt("return");case 11:if(i.checkEditableStatus(r)){e.next=13;break}return e.abrupt("return");case 13:return i.tokenToSrcMap[d]=l,i.applyDocCover(d,S.i.Preset,f),e.abrupt("return",i.collectChangeCover(T.q.SUCCESS,s));case 18:return e.prev=18,e.t0=e.catch(4),console.log("[ upload custom cover fail]",e.t0),e.abrupt("return",i.collectChangeCover(T.q.FAIL_UPLOAD_IMAGE,Object.assign(R(R({},s),{},{error:e.t0,err:e.t0.msg}))));case 22:case"end":return e.stop()}}),e,null,[[4,18]])})));return function(n,r){return e.apply(this,arguments)}}(),i.handleSetCover=function(){var e=u()(c.a.mark((function e(n){var r,o,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,o=i.getCommonCollectParam(n),I.S.init(),Object(x.isOnline)()){e.next=5;break}return e.abrupt("return",i.collectChangeCover(T.q.FAIL_OFFLINE,o));case 5:if(i.checkEditableStatus(o)){e.next=7;break}return e.abrupt("return");case 7:return window.scrollTo(0,0),null===(r=window.getSelection())||void 0===r||r.removeAllRanges(),n.type!==S.i.NONE&&x.store.dispatch(Object(E.M)()),a=i.getSetCover(n.type),e.next=14,a;case 14:if(e.t0=e.sent,!e.t0){e.next=17;break}a(n,o);case 17:e.next=23;break;case 19:e.prev=19,e.t1=e.catch(0),console.log("copy cover image error",e.t1),i.collectChangeCover(T.q.FAIL_UNKNOWN,R(R({},n),{},{error:e.t1,err:e.t1.message}));case 23:case"end":return e.stop()}}),e,null,[[0,19]])})));return function(n){return e.apply(this,arguments)}}(),C.S.on(o.F.SET_COVER_DATA,i.handleSetCover),i}return p()(r,[{key:"destroy",value:function(){g()(O()(r.prototype),"destroy",this).call(this),C.S.off(o.F.SET_COVER_DATA,this.handleSetCover)}},{key:"getSetCover",value:function(e){var n;return(n={},l()(n,S.i.Preset,this.handleSetPresetCover),l()(n,S.i.Customize,this.handleSetCustomCover),l()(n,S.i.NONE,this.handleSetNoneCover),n)[e]}}]),r}(B.S);n.S=j},dx_JgGi:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o),c=r("dx_f6fH"),a=r("dx_rGeQ"),l=r("dx_tX8z"),s=r("dx_Mzjv"),u=r("dx_h6a8"),d=r("dx_a2aT"),f=r("dx_S6dX"),h=r("dx_viBb"),p=r("dx_JUlI");n.S=function(e){var n=e.visible,r=e.target,v=e.isComponent,g=e.getSubmenuContainer,b=e.defaultDirection,y=e.reverse,m=e.adjust,_=e.beforeChangeMaxHeight,k=e.boundary,O=e.blockManager,x=e.selectionAPI,E=e.children,S=Object(l.l)(r,O,n,k),C=Object(a.S)(k,O,n),I=function(e){var n=e.visible,r=e.defaultDirection,i=e.reverse,c=e.adjust,a=e.beforeChangeMaxHeight,l=e.boundaryRect,v=e.isComponent,g=Object(o.useMemo)((function(){return r===s.R.None?[r]:i?[r,Object(f.c)(r)]:[r]}),[r]),b=Object(o.useRef)(),y=Object(o.useMemo)((function(){return["left","right"].some((function(e){return r.toLowerCase().startsWith(e)}))}),[r]),m=Object(o.useMemo)((function(){return Object(p.y)(r)}),[r]),_=Object(d.S)(n),k=Object(o.useCallback)((function(e){var n=e.adaptiveSize,r=e.contentRect,o=e.allowDirections;if(0===o.length||o[0]===s.R.None)return s.R.None;var c=o[0],l=n[c],u=Object(f.c)(c);if(y){var d=Math.min(l.height,_,r.height);return a(d)&&(b.current=d),r.width>l.width&&i&&n[u].width>l.width?u:c}var p=i?n[u].height:1/0,g=v?r.height:h.s,m=v?1/0:_;if(l.height<g&&i&&p>l.height){var k=Math.min(p,m);return a(k)&&(b.current=k),u}var O=Math.min(l.height,m);return a(O)&&(b.current=O),c}),[y,i,a,v]),O=Object(o.useCallback)((function(e){var n=e.contentRect,r=e.offsetInfo,o=e.viewportInfo,i=e.targetRect,a=e.direction,s=e.bodyRect,d=Object(f.r)({contentRect:n,offsetInfo:r,viewportInfo:o,targetRect:i,direction:a,bodyRect:s});if(c){var h=Object(f.h)({positionInfo:d,viewportInfo:o,boundaryRect:l,contentRect:Object(u.isUndefined)(b.current)?n:new DOMRect(n.left,n.top,n.width,b.current),bodyRect:s});y?(h.top>0&&(Object(u.isUndefined)(d.top)?d.bottom-=h.top:d.top+=h.top),h.bottom>0&&(Object(u.isUndefined)(d.top)?d.bottom+=h.bottom:d.top-=h.bottom)):(h.left>0&&(Object(u.isUndefined)(d.left)?d.right-=h.left:d.left+=h.left),h.right>0&&(Object(u.isUndefined)(d.left)?d.right+=h.right:d.left-=h.right))}return d}),[c,l,y]);return{allowDirections:g,offset:m,directionCalculator:k,positionCalculator:O}}({visible:n,defaultDirection:b,reverse:y,adjust:m,boundaryRect:C,beforeChangeMaxHeight:_,isComponent:v}),B=I.allowDirections,T=I.offset,w=I.directionCalculator,R=I.positionCalculator;return i.a.createElement(c.S,{visible:n,getContainer:g,allowDirections:B,targetRect:S,boundaryRect:C,calcDirection:w,calcPosition:R,animation:s.e.Slide,offset:T,blockManager:O,selectionAPI:x},E)}},dx_JgOH:function(e,n,r){"use strict";r.d(n,"n",(function(){return i}));var o=r("dx_B28d");function i(e,n){return e.type===o.B.VIEW&&(e=e.children[0]),function(e,n){var r,i,c=e.id,a=e.type,l=e.snapshot,s=n.getBlockViewByBlockIdNotCheck(c);switch(a){case o.B.FILE:return!!(null===(r=l.file)||void 0===r?void 0:r.token);case o.B.IMAGE:return!!(null===(i=l.image)||void 0===i?void 0:i.token);case o.B.BLANK:return!1;case o.B.TASK:var u;return!(null===(u=e.taskModel)||void 0===u?void 0:u.isLocalCreating);default:return!o.M5.includes(a)||!(!s||!s.isBlockRendered)&&!!l.token}}(e,n)}},dx_JjWO:function(e,n,r){},dx_JkhV:function(e,n,r){"use strict";r.d(n,"t",(function(){return a})),r.d(n,"o",(function(){return l})),r.d(n,"E",(function(){return u}));var o=r("dx_B28d"),i=r("dx_zghO"),c=r("dx_X3XX");function a(e,n){var r=Array.isArray(n)?n:[n],i={},c="";return r.forEach((function(n){e.traverse(n,(function(n){var r=e.getRecordByBlockId(n);if(o.n.includes(r.snapshot.type)&&!i[n]){i[n]=!0;var a=s(e,n);c+=a}return!0}))})),c}function l(e,n){return n.reduce((function(n,r){var o=r.id,c=r.type,l=r.selection;return c===i.j.TEXT?n+s(e,o,l):c===i.j.BLOCK?n+a(e,o):n}),"")}function s(e,n,r){var o=e.getBlockModelByBlockId(n).getText();return r?o.slice(r.start,r.end):"".concat(o,"\n")}function u(e){var n=d(e,!1);return{charCount:d(e,!0),wordCount:n}}function d(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.replace("\n"," "),o=[],i=0;return(o=o.concat(r.split(c.Q.toRegExp()))).forEach((function(e){if(""!==e){for(var r=f(e);r.hasNext();)r.next(n);i+=r.counts()}})),i}function f(e){var n=0,r=new RegExp("(\\S*?)((".concat(c.r.toString(),")*)(\\S*?)(([a-zA-Z0-9]+'?)?[a-zA-Z0-9]*'?)"),"g"),o=0;function i(){r.lastIndex=o;var n=r.exec(e);return o=r.lastIndex,n}var a=i();return{counts:function(){return n},next:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];a[2]?n+=Array.from(a[2]).length:n+=0,a[5]&&"'"!==a[5]?n+=e?Array.from(a[5]).length:1:n+=0,a=i()},hasNext:function(){return a&&a[0]}}}},dx_Jl0O:function(e,n,r){"use strict";function o(e,n){return{width:e.width,height:e.height,left:e.left-n.left,right:e.right-n.left,top:e.top-n.top,bottom:e.bottom-n.top}}function i(e){var n=e.left,r=e.top,o=e.width,i=e.height;return new DOMRect(n,r,o,i)}function c(){return{left:0,right:0,top:0,bottom:0,width:0,height:0}}function a(e){return{left:e.left,top:e.top,bottom:e.bottom,right:e.right,width:e.width,height:e.height}}function l(e){return[e.blockId,e.blockType,e.cacheType,e.relativeBlock,e.offset,e.isStart?"right":"left",e.rangeStart,e.rangeEnd].filter((function(e){return void 0!==e})).join("-")}function s(e){return{top:e,bottom:e,width:0,height:0,left:0,right:0}}r.d(n,"l",(function(){return o})),r.d(n,"w",(function(){return i})),r.d(n,"b",(function(){return c})),r.d(n,"I",(function(){return a})),r.d(n,"p",(function(){return l})),r.d(n,"d",(function(){return s}))},dx_JlLZ:function(e,n,r){"use strict";(function(t){var e,o,i,c,a,l,s=r("dx_o0o1"),u=r.n(s),d=r("dx_yXPU"),f=r.n(d),h=r("dx_yG8O"),p=r.n(h),v=r("dx_lwsE"),g=r.n(v),b=r("dx_W8MJ"),y=r.n(b),m=r("dx_PJYZ"),_=r.n(m),k=r("dx_W7W2"),O=r.n(k),x=r("dx_a1gu"),E=r.n(x),S=r("dx_Nsbk"),C=r.n(S),I=r("dx_Uyc2"),B=r.n(I),T=(r("dx_A1AB"),r("dx_xjz2")),w=r("dx_UtDZ"),R=r("dx_NMQJ"),M=r("dx_x1WV"),j=r("dx_KFKk"),D=r("dx_d2PS"),A=r("dx_e8ez"),P=r("dx_c7yg"),L=r("dx_O5Om");function N(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=C()(e);if(n){var i=C()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return E()(this,r)}}var F=(e=Object(T.S)(),l=a=function(e){O()(r,e);var n=N(r);function r(e){var o;return g()(this,r),o=n.call(this,e),p()(o,"blockManager",i,_()(o)),p()(o,"offlineUpload",c,_()(o)),o.isApplyBackUp=void 0,o}return y()(r,[{key:"onInit",value:function(e){var n=e.options;this.isApplyBackUp=!!n.isApplyBackup}},{key:"onPasteRecordAfterApply",value:function(e){var n;L.w.setStartCopying(this.record.id);var r={driveToken:e.token};null===(n=this.offlineUpload)||void 0===n||n.addStoreData(D.e.PASTE_FILE,this.record.id,r)}},{key:"onPasteRecordAfterAccepted",value:function(){var e=f()(u.a.mark((function e(n){var r=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(A.U)(null===n||void 0===n?void 0:n.token,this.record.id,this.blockManager,(function(){var e;Object(w.isOnline)()&&(null===(e=r.offlineUpload)||void 0===e||e.removeStoreData(D.e.PASTE_FILE,r.record.id))}));case 2:L.w.setEndCopying(this.record.id);case 3:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"getText",value:function(){return"[".concat(t("etherpad.Drive"),"]")}}]),r}(R.D),a.type=P.O,o=l,i=B()(o.prototype,"blockManager",[M.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=B()(o.prototype,"offlineUpload",[e,j.y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o);n.S=F}).call(this,r("dx_E9Eu"))},dx_JnYQ:function(e,n,r){"use strict";var o,i;r.d(n,"x",(function(){return o})),r.d(n,"v",(function(){return i})),r.d(n,"pk",(function(){return c})),r.d(n,"p",(function(){return a})),r.d(n,"e",(function(){return l})),r.d(n,"K",(function(){return s})),r.d(n,"A",(function(){return u})),r.d(n,"h",(function(){return d})),r.d(n,"z",(function(){return f})),r.d(n,"y",(function(){return h})),function(e){e[e.SPACE_NO_PERMISSION=920004007]="SPACE_NO_PERMISSION",e[e.WIKI_NODE_NO_PERMISSION=920004012]="WIKI_NODE_NO_PERMISSION",e[e.SPACE_NOT_EXIST=3]="SPACE_NOT_EXIST",e[e.WIKI_NODE_NOT_EXIST=920004002]="WIKI_NODE_NOT_EXIST",e[e.REQUIRE_LOGIN=5]="REQUIRE_LOGIN"}(o||(o={})),function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.NORMAL=1]="NORMAL",e[e.ANONYMOUS=2]="ANONYMOUS",e[e.TEMPORARY=3]="TEMPORARY",e[e.APPUSER=4]="APPUSER"}(i||(i={}));var c=[10,20,30,50],a=0,l="first_insert",s="template_block",u="block-recent",d=100,f="block-catalog",h=600},dx_Jo01:function(e,n,r){"use strict";r.d(n,"q",(function(){return o})),r.d(n,"d",(function(){return i}));var o="HIDE_BLOCK_TOOLBAR",i=96},dx_JoJM:function(e,n,r){"use strict";var o=r("dx_lSNA"),i=r.n(o),c=r("dx_o0o1"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_QxNg"),v=r("dx_e4eN"),g=r("dx_VAwJ"),b=r("dx_UtDZ"),y=r("dx_C7Cb"),m=r("dx_UHze"),_=r("dx_Fimk"),k=r("dx_s1qv"),O=r("dx_SDvP"),x=r("dx_gDjg"),E=r("dx_D26z"),S=r("dx_ZG9w"),C=r("dx_kZ3l"),I=r("dx_zghO"),B=r("dx_cDcd"),T=r.n(B),w=r("dx_faye"),R=r.n(w),M=r("dx_Vqq2"),j=r("dx_yzqx"),D=r("dx_ADkB"),A=r("dx_zEdG"),P=r("dx_Y299"),L=r("dx_K18H"),N=r("dx_a48a"),F=r("dx_QJ6a"),U=r("dx_bPy9"),H=r("dx_S6dX"),V=r("dx_iUyp"),W=r("dx_Vkw6"),z=document.createElement("div");function G(e){return K.apply(this,arguments)}function K(){return K=s()(a.a.mark((function e(n){var r,o,c,l,u,d,f,h,p,v,g,y;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.text,o=n.block,c=n.boundary,l=n.linkId,u=n.toBookmark,d=n.toIframe,f=n.toISVBlock,Object(b.isOnline)()){e.next=3;break}return e.abrupt("return");case 3:if(!j.S.isMobile){e.next=5;break}return e.abrupt("return");case 5:if(!Object(N.b)(o.id,o.blockManager)){e.next=7;break}return e.abrupt("return");case 7:if(h=u&&Object(L.p)(),e.t0=h,!e.t0){e.next=13;break}return e.next=12,Object(P.D)(r);case 12:e.t0=e.sent;case 13:if(p=e.t0,v=d&&Object(D.d)(r),(g=f&&Object(V.P)())||v||p){e.next=18;break}return e.abrupt("return");case 18:y=function(){return g?W.l:W.W.filter((function(e){return!(!p&&[W.k.title,W.k.card].includes(e.name))&&!(!v&&e.name===W.k.preview)}))},setTimeout((function(){var e=o.selectionAPI,n=o.blockManager,u=o.id;e.getSelection()[0].selection&&(Object(H.f)()&&o.model.zoneState.getEntities([[F.U,l]]).length&&(document.body.appendChild(z),R.a.render(T.a.createElement(M.O,{menuItems:y(),onClick:function(e){return d.apply(this,arguments)},boundary:c,host:z,visible:!0}),z),Object(A.T)("ccm_doc_paste_link_panel_view",{record_id:o.record.id,block_type:o.type},{})));function d(){return(d=s()(a.a.mark((function e(c){var s,d,f,h,p,b,y,m,_;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d=o.model.zoneState,!((f=d.getContent().ops.filter((function(e){var n;return(null===(n=e.attributes)||void 0===n?void 0:n[F.U])===l}))).length<1)){e.next=4;break}return e.abrupt("return");case 4:if(n.getRecordByBlockId(u)){e.next=7;break}return e.abrupt("return");case 7:h=Object(U.J)(d,f[0])[0],p=Object(U.J)(d,f[f.length-1])[1],b=[h,p],y=c.name,m={linkId:l,text:r,block:o,menuItemName:y,linkRange:b},g?Object(V.N)(m):Object(V.B)(m),s={},i()(s,W.k.title,"title"),i()(s,W.k.card,"bookmark"),i()(s,W.k.preview,"iframe"),i()(s,W.k.link,"link"),_=s,Object(A.P)("ccm_doc_paste_link_panel_click",{record_id:o.record.id,block_type:o.type},{click:_[y],iframe_type:y===W.k.preview?v:void 0});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}));case 20:case"end":return e.stop()}}),e)}))),K.apply(this,arguments)}function q(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function X(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?q(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var Y=function(){function e(n,o){var i=this;d()(this,e),this.block=n,this.selectionAPI=o,this.running=!1,this.queue=[],this.replaceToJiraIssue=function(){var e=s()(a.a.mark((function e(n){var o,c,l,s,u,d,f,h,p,v;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=n.value,c=n.range,l=n.tempId,e.next=4,r.e("dx_P4P3").then(r.bind(null,"dx_ziaQ"));case 4:if(s=e.sent,u=s.insertJiraIssueByLinkUrl,d=s.logPasteJiraAuth,f=i.block.model.zoneState,(h=f.getEntities([[E.U,l]])).length){e.next=11;break}return e.abrupt("return");case 11:return p=h[0].start,v=f.pointToOffset(p),e.next=15,u({block:i.block,blockManager:i.block.blockManager,linkUrl:o,range:[v,v+c.len],log:function(e){d(e,o,"jira_issue")}});case 15:if(!e.sent){e.next=19;break}return Object(_.N)("ccm_doc_insert_jira_click",{click:"insert",target:"none",insert_source:"paster_url",block_num:1}),e.abrupt("return",!0);case 19:return e.abrupt("return",!1);case 22:e.prev=22,e.t0=e.catch(0),console.error("transform jira issue error",e.t0);case 25:case"end":return e.stop()}}),e,null,[[0,22]])})));return function(n){return e.apply(this,arguments)}}()}return h()(e,null,[{key:"create",value:function(n,r){var o=e.instanceMap.get(n);return o||(o=new e(n,r),e.instanceMap.set(n,o)),o}}]),h()(e,[{key:"linkToOtherView",value:function(){var n=s()(a.a.mark((function n(){var r;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.queue.shift()){n.next=4;break}return this.running=!1,n.abrupt("return",e.instanceMap.delete(this.block));case 4:return n.next=6,this.transformLinkImpl(r);case 6:this.linkToOtherView();case 7:case"end":return n.stop()}}),n,this)})));return function(){return n.apply(this,arguments)}}()},{key:"transformLinkImpl",value:function(){var e=s()(a.a.mark((function e(n){var r,o,i,c,l,s,u,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.tempId,o=n.value,i=n.toMention,c=n.toBookmark,l=n.toIframe,s=n.toJiraIssue,u=n.toISVBlock,!i){e.next=7;break}return e.next=4,this.linkToMentionImpl(n);case 4:if(!e.sent){e.next=7;break}return e.abrupt("return");case 7:if(!s){e.next=13;break}return e.next=10,this.replaceToJiraIssue(n);case 10:if(!e.sent){e.next=13;break}return e.abrupt("return");case 13:if(!(c||l||u)){e.next=20;break}if(d=this.block.model.zoneState,d.getEntities([[E.U,r]]).length){e.next=18;break}return e.abrupt("return");case 18:return e.next=20,G({text:o,block:this.block,linkId:r,boundary:this.block.boundary,toBookmark:c,toIframe:l,toISVBlock:u});case 20:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"linkToMentionImpl",value:function(){var e=s()(a.a.mark((function e(n){var r,o,c,l,s,u,d,f,h,y,B,T,w,R,M,j,D,A=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.range,c=n.value,l=n.source,s=n.tempId,u=Date.now(),d=Object(x.O)(c)){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,Object(x.m)(X({},d));case 7:if(f=e.sent){e.next=10;break}return e.abrupt("return",!1);case 10:if(h=this.block.model.zoneState,(y=h.getEntities([[E.U,s]])).length){e.next=14;break}return e.abrupt("return",!1);case 14:return B=y[0].start,T=h.pointToOffset(B),w=X(X({},o),{},{start:T,len:f.raw_url.length}),R=Object(k.generateInlineComponent)(k.INLINE_COMPONENT_TYPE.DOC,f),M=Object(C.JI)(h,[w.start,w.start+w.len]),j=Object(S.w)(this.block.model,M),D=h.applyDeltaWithClone((new v.m).retain(w.start).delete(w.len).insert(" ",X(X({},j),{},(r={},i()(r,k.INLINE_COMPONENT_MARK,JSON.stringify(R)),i()(r,g.R.KEY,Object(m.K)().userId||""),r))).insert(" ",X(X({},j),{},i()({},g.R.KEY,Object(m.K)().userId||"")))).toAttributeText(),e.next=23,new Promise((function(e){A.block.blockManager.applyTransaction("replaceLink",(function(e){e.replace(A.block.record.id,["text"],D)}),{mergeMode:p.f.SPLIT,from:p.H.local,afterTransactionAccepted:function(){e()}});var n=w.start+2;A.selectionAPI.setSelection([{id:A.block.id,type:I.j.TEXT,selection:{start:n,end:n}}]),Object(_.N)("doc_replace_suite_url",{create_source:"link_to_mention",insert_token:Object(b.encryptTea)(d.token),insert_type:d.type,replace_source:l,time_cost:Date.now()-u})}));case 23:return this.block.blockManager.dispatch(O.j,[this.block,{token:f.token,title:f.title,mentionType:f.file_type,componentId:R.id}]),e.abrupt("return",!0);case 25:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"push",value:function(e){var n=Object(y.S)();this.addLocalIdToLink(n,Object(C.S)(e.range)),this.queue.push(X(X({},e),{},{tempId:n})),this.running||(this.running=!0,this.linkToOtherView())}},{key:"addLocalIdToLink",value:function(e,n){this.block.model.setAttributes(Object(C.j)(this.block,n),i()({},E.U,e),{type:"addTempIdToMentionLink"})}},{key:"getMentionLinkRange",value:function(e){var n=e.tempId,r=e.value,o=0,i=!1,c=!1;return this.block.model.zoneState.getContent().ops.find((function(e){var r;return o+=e.insert.length,(null===(r=e.attributes)||void 0===r?void 0:r[E.U])===n?i=!0:i&&(o-=e.insert.length,c=!0),c})),i?[o-r.length,o]:Object(C.S)(this.block.model.getSelection())}}]),e}();Y.instanceMap=new WeakMap;n.S=Y},dx_JsDk:function(e,n,r){"use strict";r.d(n,"R",(function(){return f}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_yzqx"),a=r("dx_bbfH"),l={minRightPadding:Math.max(a.j,a.J),historyScrollableOptions:{subScrollerLeftOffset:0}};function s(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function u(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?s(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var d=c.Z.isIPadSafariBrowser,f=u(u({},l),{},{showShadow:!0,enableOperation:!0,enableCreation:!0,enableResizerButton:!1,enableResizerLine:!0,isHeaderInScroller:!1,isHeaderAndInsertBarInSlot:d,disableOperationBarOnSelected:!1,leftExtending:20,leftPadding:0,rightPadding:l.minRightPadding,scrollableOptions:{scrollbarToBlock:3,subScrollerLeftOffset:0,enableNativeSubScroll:!c.Z.isIPadSafariBrowser,ignoreScrollClasses:a.B,isClipLeft:d,enableRightShadow:!0}})},dx_Jwfk:function(e,n,r){"use strict";r.d(n,"d",(function(){return o})),r.d(n,"kO",(function(){return i})),r.d(n,"u",(function(){return c})),r.d(n,"n",(function(){return a})),r.d(n,"Y",(function(){return l})),r.d(n,"k",(function(){return s}));var o=16,i=12,c=.8,a={width:730,height:404,originalWidth:730,originalHeight:500,isModified:!0},l=a.height,s=130},dx_JyKP:function(e,n,r){},dx_JyNn:function(e,n,r){"use strict";(function(t){r.d(n,"T",(function(){return h}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_QILm"),c=r.n(i),a=r("dx_PJ9B"),l=r("dx_cDcd"),s=r.n(l),u=r("dx_E8EE"),d=r("dx_PIlC"),f=r("dx_a7X6"),h=function(e){var n=e.equation,r=e.onEquationChange,i=e.onExit,h=e.onInit,p=e.extra,v=c()(e,["equation","onEquationChange","onExit","onInit","extra"]),g=Object(l.useState)(null),b=o()(g,2),y=b[0],m=b[1],_=Object(l.useCallback)((function(e){m(e);var n=e.getText();Object(u.u)(n,e),null===h||void 0===h||h(e)}),[h]),k=Object(l.useCallback)((function(){return[[f.V]]}),[]);return s.a.createElement("div",{className:"editor-kit-equation-editor-wrapper"},s.a.createElement(a.T,Object.assign({scrollerStyle:{maxHeight:500},placeholder:t("CreationDoc_Docs_Equation.placeholder.input"),equation:n,onEquationChange:function(e){r(e),Object(d.U)(d.n.EDIT),Object(u.u)(e,y)},registerPlugins:k,onInit:_,onExit:i},v)),p)}}).call(this,r("dx_E9Eu"))},dx_K18H:function(e,n,r){"use strict";r.d(n,"p",(function(){return i}));var o=r("dx_UtDZ");function i(){return Object(o.getMinaConfig)("ccm.docx.bookmark_block",!1)}},dx_K2KV:function(e,n,r){"use strict";r.d(n,"x",(function(){return Sn}));var o=r("dx_yG8O"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_PJYZ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_Uyc2"),m=r.n(y),_=(r("dx_A1AB"),r("dx_Vvd7")),k=r("dx_Xdvu"),O=r("dx_lSNA"),x=r.n(O),E=r("dx_xjz2"),S=r("dx_UtDZ"),C=r("dx_h6a8"),I=r("dx_C7Cb"),B=r("dx_yzqx"),T=r("dx_DX3a"),w=r("dx_GPzN"),R=r("dx_Fimk"),M=r("dx_luPr"),j=r("dx_imty"),D=r("dx_zjmc"),A=r("dx_B28d"),P=r("dx_lmzW"),L=r("dx_n8nr"),N=r("dx_Vsac"),F=r("dx_EcrF"),U=r("dx_L9Lc"),H=r("dx_b1bI"),V=r("dx_IBhU");var W=r("dx_FP3m"),z=r("dx_x1WV"),G=r("dx_hSCS"),K=r("dx_T3tg"),q=r("dx_qHDV"),X=r("dx_ppc6"),Y=r("dx_NYvg"),J=r("dx_uOSm"),Z=r("dx_e46e"),Q=r("dx_G2Gn"),ee=r("dx_Bait"),te=r("dx_BLU6"),ne=r("dx_Je9X"),re=r("dx_EqZO"),oe=r("dx_X3XX"),ie=function(){function e(n,r){var o=this;a()(this,e),this.getCountStats=void 0,this.eventEmitter=void 0,this.handleAllDone=function(){S.EventEmitter.emit("clientvar_fetch_all_done")},this.handelCount=function(){var e=o.getCountStats();console.log("[docx-detail] count",e),S.EventEmitter.emit(oe.y.SEND_DOCX_WORD_COUNT,e)},this.getCountStats=n,this.eventEmitter=r}return s()(e,[{key:"bindEvent",value:function(){S.EventEmitter.on(oe.y.HANDLE_DOCX_WORD_COUNT,this.handelCount),this.eventEmitter.on(re.R.CLIENTVAR_APPLY_ALL_DONE,this.handleAllDone)}},{key:"unBindEvent",value:function(){S.EventEmitter.off(oe.y.HANDLE_DOCX_WORD_COUNT,this.handelCount),this.eventEmitter.off(re.R.CLIENTVAR_APPLY_ALL_DONE,this.handleAllDone)}}]),e}(),ce=r("dx_JkhV"),ae=function(){function e(n){var r=this,o=n.blockManager,i=n.eventEmitter;a()(this,e),this.blockManager=void 0,this.detailEvent=void 0,this.bindEvent=function(){r.detailEvent.bindEvent()},this.handleCount=function(){var e=Object(ce.t)(r.blockManager,r.blockManager.rootBlockId);return Object(ce.E)(e)},this.blockManager=o,this.detailEvent=new ie(this.handleCount,i),this.bindEvent()}return s()(e,[{key:"destroy",value:function(){this.detailEvent.unBindEvent()}}]),e}(),le=r("dx_D8nn"),se=r("dx_fb2c").S,ue=r("dx_MP54"),de=r("dx_e6eH"),fe=r("dx_qZ2L"),he=r("dx_hD2y"),pe=r("dx_Rr9s"),ve=r("dx_n5nx"),ge=r("dx_SeGt"),be=B.S.isLarkFeed?ve.S:ge.S,ye=(pe.S,r("dx_jtB3")),me=r("dx_wy2R"),_e=r.n(me);function ke(e){return"number"===typeof e&&isFinite(e)}var Oe=r("dx_Kkjd");function xe(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Ee(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?xe(Object(r),!0).forEach((function(n){x()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var Se,Ce=B.S.isMobile;!function(e){e.slow="scroll_speed_slow",e.medium="scroll_speed_medium",e.fast="scroll_speed_fast"}(Se||(Se={}));var Ie=function(){function e(n){var r=this,o=n.scroller,i=n.container,c=n.blockManager,l=n.commentModule;a()(this,e),this.scroller=void 0,this.container=void 0,this.blockManager=void 0,this.commentModule=void 0,this.scrollEvent=null,this.maxMissFrameDuration=0,this.paintContexts=[],this.rAFId=void 0,this.scrollStartLogParams=void 0,this.destroy=function(){r.removeEvents()},this.bindEvents=function(){r.scrollEvent=r.detectScrollEvent(r.handleScrollStart,r.handleScrollEnd)},this.removeEvents=function(){r.scrollEvent&&r.scrollEvent.removeEvent(),r.scrollEvent=null},this.frameCount=0,this.frameRecordLastTime=0,this.frameRecordLastTop=0,this.fpsPool=[],this.fpsPoolMap={},this.setupRAFMonitorLoop=function(){var e=performance.now();r.frameCount++;var n=performance.now();if(n>r.frameRecordLastTime+1e3){var o=Math.round(1e3*r.frameCount/(n-r.frameRecordLastTime)),i=r.scroller,c=i instanceof Document?window.scrollY:i.scrollTop,a=function(e){var n=Math.abs(e);return n<=1500?Se.slow:n>1500&&n<=4e3?Se.medium:Se.fast}(c-r.frameRecordLastTop);r.fpsPoolMap[a]?r.fpsPoolMap[a].push(o):r.fpsPoolMap[a]=[o],r.fpsPool.push(o),r.frameCount=0,r.frameRecordLastTime=n,r.frameRecordLastTop=c}r.rAFId=requestAnimationFrame((function(){var n=performance.now();r.maxMissFrameDuration=Math.max(r.maxMissFrameDuration,n-e-16.666666666666668),r.setupRAFMonitorLoop()}))},this.handleScrollStart=function(){r.frameCount=0,r.frameRecordLastTime=performance.now();var e=r.scroller,n=r.container.offsetHeight,o=window.innerHeight,i=e instanceof Document?window.scrollY:e.scrollTop;r.frameRecordLastTop=i;var c=i+o;r.scrollStartLogParams={scroll_top:ke(i)?i:-1,scroll_bottom:ke(c)?c:-1,document_height:ke(n)?n:-1,window_width:window.innerWidth},r.paintContexts=r.blockManager.layoutManager.getReconciler().tracker.startRecordPaintContextsOnScroll(),r.setupRAFMonitorLoop()},this.handleScrollEnd=function(){window.cancelAnimationFrame(r.rAFId);var e,n={};if(r.fpsPool.length>0){var o=r.fpsPool.reduce((function(e,n){return n+e}),0)/r.fpsPool.length;n.scroll_avg_fps=o,Object.keys(r.fpsPoolMap).forEach((function(e){if(r.fpsPoolMap[e].length>0){var o=r.fpsPoolMap[e].reduce((function(e,n){return n+e}),0)/r.fpsPoolMap[e].length;n[e]=o}})),r.fpsPool=[],r.fpsPoolMap={}}r.maxMissFrameDuration&&(e=r.maxMissFrameDuration,r.maxMissFrameDuration=0),r.blockManager.layoutManager.getReconciler().tracker.stopRecordPaintContextsOnScroll();var i=r.paintContexts;r.paintContexts=[];var c=r.getPaintLogFromContexts(i),a=Ee(Ee(Ee(Ee(Ee({},r.scrollStartLogParams),Object(T.o)(r.blockManager,r.commentModule)),c),n),{},{scroll_miss_frame_duration:e,fg:{allow_pre_edit:Oe.w,docx_bear_virtual_slice_render:Object(S.getMinaConfig)("docx_bear_virtual_slice_render",!1)}});Object(R.N)("ccm_doc_performance_scroll_dev",a),r.scrollStartLogParams=null},this.detectScrollEvent=function(e,n){var o,i=function(i){i.target===r.scroller&&(window.clearTimeout(o),o||e(),o=window.setTimeout((function(){o=void 0,n()}),300))};window.addEventListener("scroll",i,{passive:!0,capture:!0});return{removeEvent:function(){o&&(window.clearTimeout(o),o=void 0,n()),window.removeEventListener("scroll",i,{capture:!0})}}},this.scroller=Ce?document:o,this.container=i,this.blockManager=c,this.commentModule=l,this.bindEvents()}return s()(e,[{key:"getPaintLogFromContexts",value:function(e){var n={paint_has_render:0,paint_max_render_count:0,paint_max_layout_count:0,paint_max_paint_time:0,paint_times:0,paint_logs:[]};try{e.forEach((function(e){var r,o=0,i=0,c=0,a="";e.forEach((function(e){!e[ye.Z.PAINT]||c||a||(c=e.r,a=e[ye.Z.PAINT][0]),e[ye.Z.RENDER]&&(o+=e[ye.Z.RENDER][0][0]),e[ye.Z.LAYOUT]&&(i+=e[ye.Z.LAYOUT][1][1])}));var l=null===(r=e[e.length-1])||void 0===r?void 0:r.r,s=c&&l?l-c:0;o>0&&(n.paint_has_render=1),n.paint_max_render_count=Math.max(n.paint_max_render_count,o),n.paint_max_layout_count=Math.max(n.paint_max_layout_count,i),n.paint_max_paint_time=Math.max(n.paint_max_paint_time,s),n.paint_times+=1;var u=l?_e()(l).format("YYYY-MM-DD HH:mm:ss.SSS"):"";n.paint_logs.push("".concat(u," render: ").concat(o,", layout: ").concat(i,", time: ").concat(s,", viewport: ").concat(a))}))}catch(r){console.error("getLogFromContexts error",r)}return n}}]),e}(),Be=r("dx_xIqD"),Te=r("dx_RIqP"),we=r.n(Te),Re=r("dx_QxNg"),Me=r("dx_rQGm"),je=r("dx_jNWT"),De=r("dx_b28D"),Ae=r("dx_K3oP"),Pe=r("dx_Jl0O"),Le=r("dx_FvGq"),Ne=r("dx_NMuw"),Fe=r("dx_MlPX"),Ue=r("dx_ey54"),He=r("dx_X279"),Ve=r("dx_k8kI"),We=r("dx_qx8A"),ze=r.n(We),Ge=r("dx_NOtv"),Ke=r.n(Ge)()("CacheCompute"),qe=function(){function e(n,r){var o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"CacheCompute";a()(this,e),this.compute=n,this.getDependence=r,this.key=i,this._isNeedCalculate=!0,this.cacheValue=void 0,this.oldDependence=void 0,this.newDependence=void 0,this.getValue=function(e){return o.getDependence&&(o.oldDependence=o.newDependence,o.newDependence=o.getDependence(e)),Ke("\b\u91cd\u65b0\u8ba1\u7b97=".concat(o.key),o.isNeedCalculate),o.isNeedCalculate&&(o.cacheValue=o.compute(),o._isNeedCalculate=!1),o.cacheValue},this.setCacheValue=function(e){var n=e(o.cacheValue);o.cacheValue=n,Ke("setCacheValue=".concat(o.key),n)},this.checkIsEqual=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Ke("checkIsEqual=".concat(o.key),o.cacheValue),e.length===n.length&&0!==e.length&&void 0!==e.length&&!e.some((function(e,r){return e!==n[r]}))}}return s()(e,[{key:"setIsNeedCalculate",value:function(e){this._isNeedCalculate=e,Ke("setIsNeedCalculate",e)}},{key:"isNeedCalculate",get:function(){return this.getDependence?this._isNeedCalculate||!this.checkIsEqual(this.oldDependence,this.newDependence):this._isNeedCalculate}}]),e}();function Xe(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Ye(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ye(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Ye(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var Je,Ze,Qe=Object(De.e)("rect:rectForFixed"),$e=function(){function e(n){var r=this;a()(this,e),this.options=n,this.contentOffset=0,this.isMoving=!1,this.isViewEditors=Object(je.B)(ze.a.getState()),this.scrollableBlockList=void 0,this.iframeBlockList=void 0,this.catalogueRect=void 0,this.subscriptions=void 0,this.pageLeft=0,this.destroy=function(){r.options.blockManager.removeListener(Ue.G,r.clearCache),r.options.blockManager.removeListener(Re.q.BEFORE_CHANGE,r.clearCache),r.options.blockManager.removeListener(Le.D,r.handelBlockUpdate),r.options.blockManager.removeListener(Ve.a,r.onBufferChanged),r.options.scroller.removeEventListener("scroll",r.handleScroll),le.S.off(Ne.v.CATALOGUE_RECT_CHANGE,r.handleCatalogueRectChange),le.S.off(Ne.v.CATALOGUE_MOVE_START,r.handleMoveStart),le.S.off(Ne.v.CATALOGUE_MOVE_END,r.handleMoveEnd),le.S.on(Fe.g.CONTENT_OFFSET_CHANGED,r.updateContentOffset),r.subscriptions.forEach((function(e){return e.unsubscribe()})),S.EventEmitter.off("viewEditorsMenuChange",r.updateViewEditors),r.options.isInWiki&&!B.S.isMobile&&Object(He.N)().offResize(r.handleWikiSidebarResize)},this.handleWikiSidebarResize=function(e){e&&(r.pageLeft=window.innerWidth-e.width)},this.updateContentOffset=Object(C.debounce)((function(e){r.contentOffset=e,r.updateBoundaryIntersection("updateContentOffset")}),0,{trailing:!0}),this.updateViewEditors=function(e){r.isViewEditors=e},this.handleMoveStart=function(){r.isMoving=!0,Qe("move start"),r.handleMoveEnd.cancel(),r.handleMoveEnd()},this.handleMoveEnd=Object(C.debounce)((function(){r.isMoving&&(r.isMoving=!1,r.updateBoundaryIntersection("moveEnd"))}),1e3,{trailing:!0}),this.onBufferChanged=function(e){var n=e.enterBlocks,o=e.leaveBlocks,i=new Set(r.collisionDetectionBlocklist.keys());(n.find((function(e){return i.has(e)}))||o.find((function(e){return i.has(e)})))&&r.clearCache()},this.handelBlockUpdate=function(e){e.type===A.B.IFRAME?r.handelIfrarmeBlockUpdate(e):r.handelBlockUpdateComm()},this.handelIfrarmeBlockUpdate=Object(C.throttle)((function(e){var n=e.blockId;r.reflashCacheById(n,r.iframeBlockList),r.updateBoundaryIntersection("blockUpdate",!1)}),100,{leading:!0,trailing:!0}),this.reflashCacheById=function(e,n){n.has(e)&&r.fixedBlockList.setCacheValue((function(n){n=new Map(n);var o=r.options.blockManager,i=o.layoutManager.isBlockActive;return o.model.hasBlockModelByBlockId(e)&&i(e)?n.set(e,r.getOriginBlockRect(e)):n.delete(e),n}))},this.handelBlockUpdateComm=Object(C.debounce)((function(){r.clearCache(),r.updateBoundaryIntersection("blockUpdate")}),500),this.clearCache=function(){r.fixedBlockList.setIsNeedCalculate(!0)},this.calculateAllCollisionDetectionBlock=function(){var e=new Map,n=r.options.blockManager,o=n.layoutManager.isBlockActive;return we()(r.collisionDetectionBlocklist.keys()).filter((function(e){return n.model.hasBlockModelByBlockId(e)&&o(e)})).forEach((function(n){var o=r.getOriginBlockRect(n);e.set(n,o)})),e},this.fixedBlockList=new qe(this.calculateAllCollisionDetectionBlock),this.calculateIsBoundaryIntersection=function(){var e=!1,n=r.catalogueRect;if(!n)return e;var o,i=n.left+r.pageLeft,c=n.right+r.pageLeft,a=r.isViewEditors?Me.y:0,l=Xe(r.fixedBlockList.getValue().values());try{for(l.s();!(o=l.n()).done;){var s=o.value;if(s){var u=Object(Pe.I)(s);if(Qe("calc BoundaryIntersection %s = %d + 20 >= %d + %d",c+20>=u.left+r.contentOffset,Math.floor(c),Math.floor(u.left),Math.floor(r.contentOffset)),!(n.top>u.bottom||c<u.left+r.contentOffset-a||n.bottom<u.top||i>u.right+r.contentOffset)){e=!0;break}}}}catch(d){l.e(d)}finally{l.f()}return e},this.isBoundaryIntersection=new qe(this.calculateIsBoundaryIntersection,(function(){return[r.fixedBlockList.getValue(),r.catalogueRect,r.contentOffset]}),"isBoundaryIntersection"),this.getOriginBlockRect=function(e){var n=r.options.blockManager.getBlockViewByBlockId(e);if(!n)throw new Error("block not found: ".concat(e));if(r.collisionDetectionBlocklist.has(e)){var o=n.getContentRect();return o.x-=Me.uu,o.width+=Me.uu,o}return n.getHostRect()},this.handleScroll=Object(C.throttle)((function(){r.clearCache(),r.updateBoundaryIntersection("scroll")}),100,{leading:!0,trailing:!0}),this.handleScrollForX=Object(C.throttle)((function(e){r.fixedBlockList.setCacheValue((function(n){return n=new Map(n),r.scrollableBlockList.has(e)&&n.set(e,r.getOriginBlockRect(e)),n})),r.updateBoundaryIntersection("scrollForX",!1)}),10,{leading:!0,trailing:!0}),this.pushBlockId=function(e,n){r.scrollableBlockList.set(e,n)},this.deleteBlockId=function(e){r.scrollableBlockList.delete(e)},this.pushBlock=function(e,n){e.type===A.B.IFRAME?r.iframeBlockList.set(e.id,n):r.scrollableBlockList.set(e.id,n)},this.deleteBlock=function(e){e.type===A.B.IFRAME?r.iframeBlockList.delete(e.id):r.scrollableBlockList.delete(e.id)},this.getCollisionDetectionBlockContent=function(e){var n=r.collisionDetectionBlocklist.get(e);if(n)return n.current},this.handleCatalogueRectChange=function(e){Qe("handleCatalogueRectChange",e),r.catalogueRect=e?Object(Pe.I)(e):null,r.updateBoundaryIntersection("rectChange")},this.updateBoundaryIntersection=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(r.options.catalogue)if(n&&r.isMoving)Qe("%s.updateBoundaryIntersection, skip due to isMoving",e);else{var o=r.isBoundaryIntersection.getValue();Qe("%s.updateBoundaryIntersection %s contentOffset=%d",e,o,r.contentOffset),r.options.catalogue.catalogueEvent.updateBoundaryIntersectionStatus(o)}},this.init=function(){r.scrollableBlockList=new Map,r.iframeBlockList=new Map},this.init(),n.blockManager.addListener(Ue.G,this.clearCache),n.blockManager.addListener(Re.q.BEFORE_CHANGE,this.clearCache),n.blockManager.addListener(Le.D,this.handelBlockUpdate),n.blockManager.addListener(Ve.a,this.onBufferChanged),n.scroller.addEventListener("scroll",this.handleScroll),le.S.on(Ne.v.CATALOGUE_RECT_CHANGE,this.handleCatalogueRectChange),le.S.on(Ne.v.CATALOGUE_MOVE_START,this.handleMoveStart),le.S.on(Ne.v.CATALOGUE_MOVE_END,this.handleMoveEnd),le.S.on(Fe.g.CONTENT_OFFSET_CHANGED,this.updateContentOffset),this.subscriptions=[Ae.f.mainScroll$.subscribe(this.handleScrollForX),Ae.f.paddingChange$.subscribe(this.handleScrollForX)],S.EventEmitter.on("viewEditorsMenuChange",this.updateViewEditors),this.options.isInWiki&&!B.S.isMobile&&Object(He.N)().onResize(this.handleWikiSidebarResize)}return s()(e,[{key:"collisionDetectionBlocklist",get:function(){return new Map([].concat(we()(this.iframeBlockList),we()(this.scrollableBlockList)))}}]),e}(),et=r("dx_g9Aj");!function(e){e.CONTENT="content"}(Je||(Je={})),function(e){e.BACKGROUND="vc-hover-background",e.BORDER="vc-hover-border",e.CUSTOM="vc-hover"}(Ze||(Ze={}));var tt=r("dx_J4zp"),nt=r.n(tt),rt=A.B.TABLE,ot=A.B.BITABLE,it=A.B.SHEET,ct=function e(n){return!!n.find((function(n){return!![rt,ot,it].includes(n.type)||!!n.children.length&&e(n.children)}))};function at(e,n){var r=e.getBlockIdsByRecordId(n),o=nt()(r,1)[0];if("undefined"===typeof o)return null;var i=e.getBlockViewByBlockIdNotCheck(o);if(!i)return null;var c=i.model,a=c.type,l=c.children;return Object(A.q)().includes(a)&&ct(l)?i.hostElement.children[0].children[0]:i.hostElement}function lt(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var st=[A.B.BLANK,A.B.TEXT,A.B.ORDERED,A.B.BULLET,A.B.TASK,A.B.TODO,A.B.QUOTE,A.B.QUOTE_CONTAINER,A.B.PROGRESS,A.B.HEADING1,A.B.HEADING2,A.B.HEADING3,A.B.HEADING4,A.B.HEADING5,A.B.HEADING6,A.B.HEADING7,A.B.HEADING8,A.B.HEADING9,A.B.GRID_COLUMN,A.B.DIVIDER],ut=[],dt=[A.B.TABLE,A.B.CELL,A.B.SHEET,A.B.BITABLE,A.B.FILE,A.B.IMAGE,A.B.CODE,A.B.IFRAME,A.B.UML,A.B.DIAGRAM,A.B.MINDMAP,A.B.FLOWCHART,A.B.BOOKMARK,A.B.ISV,A.B.CHAT_CARD,A.B.CALLOUT,A.B.OBJECTIVE,A.B.KEY_RESULT,A.B.POLL],ft=[A.B.IMAGE,A.B.IFRAME],ht=function(){function e(n){a()(this,e),this.blockManager=n,this.className=void 0}return s()(e,[{key:"apply",value:function(e){!function(e,n,r){var o=at(e,n);!!o&&o.classList.add(r)}(this.blockManager,e.recordId,this.className)}},{key:"reset",value:function(e){!function(e,n,r){var o=at(e,n);if(o)o.classList.remove(r);else{var i=document.querySelector('[data-record-id="'.concat(n,'"]'))||document.querySelector(r);if(!i)return!1;i.classList.remove(r)}}(this.blockManager,e.recordId,this.className)}}]),e}(),pt=function(e){h()(r,e);var n=lt(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).className=Ze.BACKGROUND,e}return s()(r,[{key:"canHandle",value:function(e){return st.includes(e)}}]),r}(ht),vt=function(e){h()(r,e);var n=lt(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).className=Ze.BORDER,e}return s()(r,[{key:"canHandle",value:function(e){return ut.includes(e)}}]),r}(ht),gt=function(e){h()(r,e);var n=lt(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).className=Ze.CUSTOM,e}return s()(r,[{key:"canHandle",value:function(e){return dt.includes(e)}}]),r}(ht),bt=function(e){h()(r,e);var n=lt(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).className="",e}return s()(r,[{key:"canHandle",value:function(e){return!e}},{key:"apply",value:function(){var e=document.querySelector(".".concat(Ze.BACKGROUND));e&&e.classList.remove(Ze.BACKGROUND);var n=document.querySelector(".".concat(Ze.BORDER));n&&n.classList.remove(Ze.BORDER);var r=document.querySelector(".".concat(Ze.CUSTOM));r&&r.classList.remove(Ze.CUSTOM)}},{key:"reset",value:function(){}}]),r}(ht),yt=function(){function e(n,r){a()(this,e),this.handlers=n,this.blockManager=r}return s()(e,[{key:"apply",value:function(e){at(this.blockManager,e.recordId)||this.blockManager.layoutManager.renderNodeByIdSync(this.blockManager.getBlockIdsByRecordId(e.recordId));var n=this.handlers.find((function(n){return n.canHandle(e.type)}));return!!n&&(n.apply(e),!0)}},{key:"reset",value:function(e){if(!e)return!0;var n=this.handlers.find((function(n){return n.canHandle(e.type)}));return!!n&&(n.reset(e),!0)}},{key:"revertAll",value:function(){this.apply({type:"",recordId:""})}}]),e}();var mt=r("dx_uxuX"),_t=r("dx_O1Ou"),kt=x()({},Je.CONTENT,{recordId:"",type:""}),Ot=_t.a.Hover,xt=r("dx_KUGi"),Et=function(){function e(n,r,o){a()(this,e),this.vcController=n,this.blockManager=r,this.uuid=o}return s()(e,[{key:"detect",value:function(e){var n=e.recordId;if(!n)return this.success();var r=at(this.blockManager,n);if(!r){var o="".concat(Ot,": fail cause not find element");return this.fail(o),void Object(S.collectEvent)("vc_action_apply_dev",e,"")}if([Ze.BACKGROUND,Ze.BORDER,Ze.CUSTOM].some((function(e){return r.classList.contains(e)})))return this.success();var i="".concat(Ot,": fail cause className not match");this.fail(i),this.collect(i,e,{recordId:r.dataset.recordId,className:r.className,type:r.dataset.blockType})}},{key:"collect",value:function(e,n,r){Object(S.collectEvent)("vc_action_apply_dev",{code:1,info:e,action:Ot,string_param_1:JSON.stringify(n),string_param_2:JSON.stringify(r)})}},{key:"success",value:function(){this.vcController.reportReplay(_t.s.SUCCESS,this.uuid)}},{key:"ignore",value:function(e){this.vcController.reportReplay(_t.s.IGNORE,this.uuid,e)}},{key:"fail",value:function(e){this.vcController.reportReplay(_t.s.FAIL,this.uuid,e)}}]),e}();r("dx_d2dD");function St(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}var Ct,It,Bt,Tt=Number(Object(S.getMinaConfig)("ccm.docx.vc_hover_debounce_time",50))||50,wt=function(){function e(n,r,o){var i=this;a()(this,e),this.vcController=n,this.handlerChain=r,this.blockManager=o,this.unregisterVC=void 0,this.lastData=void 0,this.followerLocalData=void 0,this.isFirstMouseOver=!0,this.pageElement=void 0,this.replayHandler=function(e){if(!i.vcController.isRecord){var n=e.uuid,r=e.data,o=new Et(i.vcController,i.blockManager,n);i.lastData&&i.handlerChain.reset(i.lastData),i.lastData=r,i.handlerChain.apply(r),i.vcController.sendState(Ot,Je.CONTENT,function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?St(Object(r),!0).forEach((function(n){x()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):St(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({},r)),o.detect(r)}},this.handleMouseLeave=function(e){!e.target||e.target!==i.pageElement&&e.target!==document.body||(i.lastData&&i.handlerChain.reset(i.lastData),i.lastData=null,i.sendVcState(kt[Je.CONTENT]),i.handleMouseOver.cancel())},this.handleMouseOver=Object(C.debounce)((function(e){if(e.target){var n=i.generateHoverAction(e.target);if(!n||!i.lastData||n.recordId!==i.lastData.recordId){if(i.isFirstMouseOver&&n&&i.vcController.isRecord&&(i.isFirstMouseOver=!1,i.handleOnboarding(e.clientX,e.clientY)),i.vcController.isRecord){i.lastData&&i.handlerChain.reset(i.lastData),i.lastData=n;var r=S.selectors.share.selectCanEditInvolvingEditMode(ze.a.getState());!n||r&&ft.includes(n.type)||i.handlerChain.apply(n)}i.vcController.isRecord||(i.followerLocalData=n),i.sendVcState(n||kt[Je.CONTENT])}}}),Tt),this.sendVcState=function(e){var n=i.vcController.getState(Ot,Je.CONTENT);Object(C.isEqual)(n,e)||i.vcController.sendState(Ot,Je.CONTENT,e)},this.handleStartRecord=function(){i.reset(),i.followerLocalData&&i.handlerChain.apply(i.followerLocalData),i.sendVcState(i.followerLocalData||kt[Je.CONTENT]),i.lastData=i.followerLocalData,i.followerLocalData=null},this.handleStopFollow=function(){i.reset()},this.handleStartFollow=function(){i.reset()},B.S.isInVC&&Object(S.getMinaConfig)("ccm.docx.vc_hover_enable",!1)&&this.bindEvent()}return s()(e,[{key:"destroy",value:function(){this.unbindEvent(),this.sendVcState(kt[Je.CONTENT])}},{key:"bindEvent",value:function(){B.S.isMobile||(window.addEventListener("mouseover",this.handleMouseOver),window.addEventListener("mouseleave",this.handleMouseLeave)),this.unregisterVC=this.vcController.register({moduleName:Ot,defaultState:kt,retryOnVersionMatched:"fail-only",retryOptions:{retryTimes:4,retryIntervalMs:500},replayHandler:this.replayHandler,checkSame:function(e,n,r){return e===Je.CONTENT&&n.recordId===r.recordId}}),S.EventEmitter.on(mt.STOP_FOLLOW,this.handleStopFollow),S.EventEmitter.on(mt.START_RECORD,this.handleStartRecord),S.EventEmitter.on(mt.START_FOLLOW,this.handleStartFollow)}},{key:"unbindEvent",value:function(){var e;B.S.isMobile||(window.removeEventListener("mouseover",this.handleMouseOver),window.removeEventListener("mouseleave",this.handleMouseLeave)),null===(e=this.unregisterVC)||void 0===e||e.call(this),S.EventEmitter.off(mt.STOP_FOLLOW,this.handleStopFollow),S.EventEmitter.off(mt.START_RECORD,this.handleStartRecord),S.EventEmitter.off(mt.START_FOLLOW,this.handleStartFollow)}},{key:"generateHoverAction",value:function(e){for(var n=[];e&&e!==this.traverseStopElement;){if(e.dataset.recordId){var r={recordId:e.dataset.recordId,type:e.dataset.blockType};n.push(r)}e=e.parentElement}var o=n.find((function(e){return e.type===A.B.CALLOUT}));return o||(n.length?n[0]:null)}},{key:"handleOnboarding",value:function(e,n){var r=Object(S.selectUserGuide)(ze.a.getState());Object(S.isGuideTypeDone)(r,S.STEP_TYPES.docx_vc_hover_follow)||Object(xt.j)(e,n)}},{key:"reset",value:function(){this.handlerChain.revertAll(),this.lastData=void 0}},{key:"traverseStopElement",get:function(){if(this.pageElement)return this.pageElement;var e=document.querySelector('[data-record-id="'.concat(this.blockManager.rootRecordId,'"]'));return e&&(this.pageElement=e),e||document.body}}]),e}(),Rt=r("dx_o0o1"),Mt=r.n(Rt),jt=r("dx_yXPU"),Dt=r.n(jt),At=r("dx_Ayao"),Pt=r("dx_upU1"),Lt=_t.a.DocxPosition;function Nt(e){if(!e.length)return-1;var n=we()(e),r=Object.create(null),o=Object.values(Bt);n.reverse(),n.forEach((function(e,o){return e.from&&void 0===r[e.from]&&(r[e.from]=n.length-1-o)}));var i=o.find((function(e){return void 0!==r[e]}));return i?r[i]:-1}!function(e){e.POSITION="position",e.THIRD_SCROLL="third_scroll"}(Ct||(Ct={})),function(e){e.COMMENT="comment"}(It||(It={})),function(e){e.VC_DISPATCH="vc_dispatch",e.COMMENT_SCROLL="comment_scroll",e.FOUND_TARGET="found_target",e.EDITOR_RESIZE="editor_resize"}(Bt||(Bt={}));var Ft=function(e){var n=e.actionType,r=e.data;return n===Ct.THIRD_SCROLL&&r.type===It.COMMENT},Ut=function e(n,r){var o=this;a()(this,e),this.commentScrollEnable=n,this.reportIgnore=r,this.pendingList=[],this.push=function(e){o.pendingList.push(e)},this.clear=function(){o.pendingList.forEach((function(e){return o.reportIgnore(e.uuid,"comment active")})),o.pendingList.length=0},this.getReplayAction=function(e){o.commentScrollEnable||o.removePendingReplayList(Ft,"follower is not in FG");var n=o.getHighestPriorityAction();if(n&&(Ft(n)&&!e(n)&&(o.removePendingReplayList((function(e){var r,o=e.uuid;return(null===(r=n)||void 0===r?void 0:r.uuid)===o})),o.removePendingReplayList(Ft,"can not find active comment context")),n=o.getHighestPriorityAction()))return o.pendingList.forEach((function(e){var r;return e.uuid!==(null===(r=n)||void 0===r?void 0:r.uuid)&&o.reportIgnore(e.uuid,"ignore by replay highest priority action")})),o.pendingList.length=0,n},this.removePendingReplayList=function(e,n){o.pendingList=o.pendingList.filter((function(r){return!e(r)||(n&&o.reportIgnore(r.uuid,n),!1)}))},this.getHighestPriorityAction=function(){if(0!==o.pendingList.length){var e=Nt(o.pendingList);return e>-1?o.pendingList[e]:o.pendingList[o.pendingList.length-1]}}},Ht=function e(){var n=this;a()(this,e),this.pendingList=[],this.clear=function(){n.pendingList.length=0},this.push=function(e,r){var o=n.pendingList[n.pendingList.length-1];(null===o||void 0===o?void 0:o.func)===e&&(null===o||void 0===o?void 0:o.from)===r||n.pendingList.push({from:r,func:e})},this.run=function(){if(n.pendingList.length){var e=Nt(n.pendingList),r=n.pendingList[e>-1?e:n.pendingList.length-1];n.pendingList.length=0,r.func()}}},Vt=function(){function e(n){a()(this,e),this.timeout=3e3,this.startTime=Date.now(),n&&(this.timeout=n)}return s()(e,[{key:"setTimeout",value:function(e){this.timeout=e}},{key:"shouldIgnore",value:function(){return Math.abs(Date.now()-this.startTime)<=this.timeout}}]),e}(),Wt=function(){function e(n,r){var o=this;a()(this,e),this.vcController=n,this.onTargetFound=r,this.notFoundTargetInfo=void 0,this.clear=function(){o.report(),o.notFoundTargetInfo=void 0},this.set=function(e,n){o.notFoundTargetInfo&&e.timestamp<o.notFoundTargetInfo.action.timestamp?o.vcController.reportReplay(_t.s.IGNORE,e.uuid,"ignore action cause not found target, timestamp is smaller"):(o.report(),o.notFoundTargetInfo={action:e,target:n,notFoundHelper:new Vt})},this.notify=function(e){var n;(null===(n=o.notFoundTargetInfo)||void 0===n?void 0:n.target)===e&&(o.onTargetFound(o.notFoundTargetInfo.action),o.notFoundTargetInfo=void 0)}}return s()(e,[{key:"report",value:function(){if(this.notFoundTargetInfo){var e=this.notFoundTargetInfo,n=e.action.uuid;e.notFoundHelper.shouldIgnore()?this.vcController.reportReplay(_t.s.IGNORE,n,"ignore action cause not found target"):this.vcController.reportReplay(_t.s.FAIL,n,"found target timeout")}}},{key:"notFoundAction",get:function(){var e;return null===(e=this.notFoundTargetInfo)||void 0===e?void 0:e.action}}]),e}(),zt=function(){function e(n,r){var o=this;a()(this,e),this.blockManager=n,this.onVersionChange=r,this.destroy=function(){o.binding("off")},this.bindingSyncEvents=function(e){var n;null===(n=o.sync)||void 0===n||n[e](Re.T.VersionChange,o.onVersionChange)},this.handleSyncReady=function(){o.bindingSyncEvents("on")},this.binding("on")}return s()(e,[{key:"binding",value:function(e){this.sync?this.bindingSyncEvents(e):"on"===e&&le.N.once(le.p.COMMON.COLLAB_MODULE_INIT_FINISH,this.handleSyncReady),"off"===e&&le.N.off(le.p.COMMON.COLLAB_MODULE_INIT_FINISH,this.handleSyncReady)}},{key:"sync",get:function(){var e;return null===(e=this.blockManager.recordManager.collabModule)||void 0===e?void 0:e.sync}}]),e}(),Gt=r("dx_Nv7e"),Kt=r("dx_DbCN"),qt=r("dx_c9zL"),Xt=r("dx_QBqw"),Yt=function e(){var n=this;a()(this,e),this.lastSendAction=void 0,this.lastPositionState=void 0,this.disableNextSendPositionAction=!1,this.isFirstTimeToScroll=!0,this.lastReplayAction=void 0,this.scrollingInfo=void 0,this.pendingScrollAction=void 0,this.followerEditorResizeCallback=void 0,this.doFollowerEditorResizeCallbackTimes=8,this.currentActiveCommentContext=void 0,this.replayCommentContext=void 0,this.isPresenterV2=!1,this.resetFollowState=function(){n.isFirstTimeToScroll=!0,n.scrollingInfo=void 0,n.pendingScrollAction=void 0,n.lastReplayAction=void 0,n.replayCommentContext=void 0,n.followerEditorResizeCallback=void 0,n.doFollowerEditorResizeCallbackTimes=8}};function Jt(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Zt(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Jt(Object(r),!0).forEach((function(n){x()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jt(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var Qt=function(){function e(n){var r=this,o=n.scroller,i=n.blockManager,c=n.rect,l=n.viewPort,s=n.selectionAPI,u=n.commentModule;a()(this,e),this.state=new Yt,this.scroller=void 0,this.blockManager=void 0,this.rect=void 0,this.viewPort=void 0,this.selectionAPI=void 0,this.commentModule=void 0,this.checkScrollPositionAndReport=Object(C.debounce)((function(e){if(!B.S.isMobile||"fixed"!==document.body.style.position){var n=e.uuid,o=e.data,i=r.getCurrPositionState();if(o.blockId&&o.blockId!==i.blockId){var c="",a=o.blockId,l=r.blockManager.getBlockModelsByRecordId(a)[0].id;if(l){var s=r.blockManager.getBlockViewByBlockIdNotCheck(l);if(s){var u=r.rect.getBlockRect(l).top,d=s.hostElement.getBoundingClientRect().top;c="document top recordId not same, "+"target recordId: ".concat(a,", ")+"current recordId: ".concat(i.blockId,", ")+"rect top: ".concat(u,", ")+"domRectTop: ".concat(d,", ")+"has cover: ".concat(!!r.coverHeight,", ")+"is document visible: ".concat(document.visibilityState)}else c="not found blockView by recordId: ".concat(a)}else c="not found blockId by recordId: ".concat(a);console.info("call checkScrollPositionAndReport and is not same: ".concat(c)),Object(S.collectEvent)("vc_action_apply_dev",{code:1,info:c,uuid:n,action:"DocxPositionCheck",beforeTop:"",currentTop:r.scrollTop,expectTop:r.calcScrollTop(e),string_param_1:JSON.stringify(i),string_param_2:JSON.stringify(o)})}}}),2e3),this.scroller=o,this.blockManager=i,this.rect=c,this.viewPort=l,this.selectionAPI=s,this.commentModule=u}return s()(e,[{key:"getCurrPositionState",value:function(){var e,n=this.getViewPortFirstRecordId(),r=this.calcBlockYRatio(n);return{blockId:n,blockYRatio:r,titleYRatio:(null===(e=this.blockManager.getBlockModelsByRecordId(n)[0].previous)||void 0===e?void 0:e.id)===this.blockManager.rootBlockId&&r<0?this.getTitleYRatio():void 0,v2:this.commentModule.disableScrollInVC}}},{key:"getThirdScrollCommentOptions",value:function(e){if(B.S.isMobile)return{commentId:e};var n=this.commentModule.getPositionByCommentId(e);return n?{commentId:e,screenYRatio:(n.top-this.scrollTopWithoutCover)/window.innerHeight}:{commentId:e}}},{key:"getDefaultPositionState",value:function(){var e=this.getFirstRecordId();return{blockId:e,blockYRatio:this.calcBlockYRatio(e),v2:this.commentModule.disableScrollInVC}}},{key:"getBlockRect",value:function(e){var n=this.blockManager.getBlockModelsByRecordId(e)[0].id,r=this.getBlockType(n),o=this.rect.getBlockRect(n),i=o.top,c=o.height;r===A.B.GRID_COLUMN&&(c=this.getGridColumnBottom(n)-i);return{height:c,top:i}}},{key:"calcScrollTop",value:function(e){var n=e.actionType,r=e.data,o=e.uuid;switch(n){case Ct.POSITION:var i,c=r,a=c.blockId,l=c.blockYRatio,s=void 0===l?0:l,u=c.titleYRatio;if(void 0!==u){var d=Object(qt.S)();void 0!==d&&(i=d.top+d.height*u)}if(void 0===i){var f=this.getBlockRect(a);i=f.top+f.height*s}var h=i+this.coverHeight;return Math.max(h,0);case Ct.THIRD_SCROLL:var p=r,v=p.type,g=p.options;if(v===It.COMMENT){var b,y=g.commentId;if((null===(b=this.state.replayCommentContext)||void 0===b?void 0:b.activeCommentId)!==y)return;var m=this.commentModule.getPositionByCommentId(y);this.commentModule.calcCommentPositionByBlockId(m.blockId);var _=this.state.replayCommentContext,k=_.panelHeight,O=void 0===k?0:k,x=_.panelTop;if(void 0!==x){var E,C,I,B,T=null===(E=(C=this.commentModule.commentScroller).getCommentPositionInfo)||void 0===E?void 0:E.call(C,y);if(!T)return;return null===(I=(B=this.commentModule.commentScroller).calcScrollTop)||void 0===I?void 0:I.call(B,Zt(Zt({},T),{},{panelTop:x}))}var w=this.calcNormalCommentScrollTop(y,O,g.screenYRatio);return Object(S.collectEvent)("vc_doc_position",{uuid:o,info:"calc scroll top result: ".concat(w),string_param_1:JSON.stringify(r)}),w}return;default:return}}},{key:"calcNormalCommentScrollTop",value:function(e,n,r){var o,i,c,a,l=this,s=this.commentModule,u=s.isCommentInAsideMode;if(B.S.isIPad&&u){var d=this.commentModule.getPositionByCommentId(e);if(!d)return;return s.calcScrollToOnIpad(d)}var f=null===(o=(i=this.commentModule.commentScroller).getCommentPositionInfo)||void 0===o?void 0:o.call(i,e);if(f){var h=this.commentModule.getPositionByCommentId(e).top,p=this.scrollerOffsetHeight,v=(null===(c=(a=this.commentModule.commentScroller).calcScrollTop)||void 0===c?void 0:c.call(a,f))||0;return B.S.isMobile||n>=p||!r?v:Math.min(function(e){var r=Math.min(Math.max(e,0),1);return h+l.coverHeight-r*window.innerHeight+Math.max(n-p*(1-r),0)}(r),v)}}},{key:"getRecordIdFromAction",value:function(e){var n=e.actionType,r=e.data;if(n===Ct.POSITION)return r.blockId;if(n===Ct.THIRD_SCROLL){var o=r,i=o.type,c=o.options;if(i===It.COMMENT){var a=this.commentModule.getPositionByCommentId(c.commentId);if(a)return this.blockManager.getRecordByBlockId(a.blockId).id}}}},{key:"checkScrollPositionRight",value:function(e,n){if(Math.abs(n-e)<30||0===window.innerHeight)return[!0];var r=this.scrollerHeight,o=this.scrollerOffsetHeight;return e+o>r?[e>=n&&(e<=n+o||e>=r)]:[!1]}},{key:"checkThirdScrollPositionRight",value:function(e){var n=e.type,r=e.options;if(n===It.COMMENT){var o=this.commentModule.getPositionByCommentId(r.commentId);if(o){var i,c=o.top+((null===(i=this.state.replayCommentContext)||void 0===i?void 0:i.scrollTop)||0);return[c>=this.scrollTopWithoutCover&&c<=this.scrollTopWithoutCover+this.scrollerOffsetHeight,c]}return[!1]}return[!0]}},{key:"getTitleYRatio",value:function(){var e=Object(qt.S)();if(void 0!==e)return(this.scrollTopWithoutCover-e.top)/e.height}},{key:"getFirstRecordId",value:function(){var e=this.blockManager,n=e.rootBlockId,r=e.rootRecordId,o=e.getBlockModelByBlockId(n).children;return o.length?o[0].recordId:r}},{key:"calcBlockYRatio",value:function(e){var n=this.getBlockRect(e),r=n.top,o=n.height,i=(this.scrollTopWithoutCover-r)/o;return Number.isNaN(i)||"number"!==typeof i||i===1/0?0:i}},{key:"getViewPortFirstRecordId",value:function(){var e=this.viewPort,n=this.scrollTopWithoutCover,r=this.blockManager,o=e.getBlockIds({offsets:[n,n]}),i=o.length?o[0]:r.rootBlockId;if(this.getBlockType(i)===A.B.GRID)for(var c=r.getBlockModelByBlockId(i).next;c;){var a=c.id;if(this.getGridColumnBottom(a)>n){i=a;break}c=c.nextSibling}return this.getFirstFloorRecordId(i)}},{key:"getBlockType",value:function(e){return this.blockManager.getBlockModelByBlockId(e).type}},{key:"getGridColumnBottom",value:function(e){var n=this.blockManager.getBlockModelByBlockId(e).children;return this.rect.getBlockRect(n[n.length-1].id).bottom}},{key:"getFirstFloorRecordId",value:function(e){var n=this.viewPort,r=this.scrollTopWithoutCover,o=this.blockManager,i=e;if(this.blockManager.getBlockModelByBlockId(i).type===A.B.TABLE)return this.getTableFirstFloorRecordId(i);for(;0!==o.getBlockModelByBlockId(i).children.length;){var c=n.getBlockIds({parentBlockId:i,offsets:[r,r]});if(0===c.length)break;var a=nt()(c,1)[0],l=o.getBlockViewByBlockIdNotCheck(a);if(!l)break;var s=l.hostElement.getBoundingClientRect();if([s.top,s.bottom,s.width,s.height].every((function(e){return 0===e})))break;if(i=a,this.getBlockType(i)===A.B.TABLE)return this.getTableFirstFloorRecordId(i)}if(i===o.rootBlockId){var u=o.getBlockModelByBlockId(i).children;if(u.length){var d=u[0].id,f=this.rect.getBlockRect(d).top;this.scrollTopWithoutCover<=f&&(i=d)}}return o.getRecordByBlockId(i).id}},{key:"getTableFirstFloorRecordId",value:function(e){var n=this.scrollTopWithoutCover,r=this.blockManager;try{for(var o=r.getBlockModelByBlockId(e).snapshot,i=o.rows_id.length,c=o.columns_id.length,a=0;a<i;a++){var l=Object(Xt.P)(0,a,o,r),s=r.getBlockModelByBlockId(l.id).id,u=this.rect.getBlockRect(s),d=u.top,f=u.bottom,h=u.height;if(d<=n&&f>=n&&0!==h)break}if(a>=i)return r.getRecordByBlockId(e).id;for(var p=Object(Xt.P)(0,a,o,r),v=1;v<c;v++){var g=Object(Xt.P)(v,a,o,r);g.children.length>p.children.length&&(p=g)}return this.getFirstFloorRecordId(p.id)}catch(b){console.error("getTableFirstFloorRecordId error: ",b)}return r.getRecordByBlockId(e).id}},{key:"scrollerHeight",get:function(){return Object(Kt.r)(this.scroller)}},{key:"scrollerOffsetHeight",get:function(){return Object(Kt.O)(this.scroller)}},{key:"scrollTop",get:function(){return Object(Kt.h)(this.scroller)}},{key:"coverHeight",get:function(){return Object(Gt.F)(this.blockManager)}},{key:"scrollTopWithoutCover",get:function(){return this.scrollTop-this.coverHeight}}]),e}(),$t=r("dx_wDsH");function en(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function tn(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?en(Object(r),!0).forEach((function(n){x()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):en(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var nn,rn,on,cn,an,ln,sn,un,dn,fn,hn=function(){function e(n){var r=this;a()(this,e),this.core=void 0,this.vcController=void 0,this.unregisterVcFollow=void 0,this.readySub=void 0,this.targetNotFoundHelper=void 0,this.versionChangeHelper=void 0,this.pendingScrollHelper=void 0,this.pendingReplayHelper=void 0,this.destroy=function(){var e,n;r.clear(),r.binding("off"),r.versionChangeHelper.destroy(),null===(e=r.readySub)||void 0===e||e.unsubscribe(),null===(n=r.unregisterVcFollow)||void 0===n||n.call(r),r.sendPositionAction.cancel(),r.sendThirdScrollAction.cancel(),r.core.state.currentActiveCommentContext=void 0,r.unregisterVcFollow=void 0},this.disableNextSendPosition=function(){r.sendPositionAction.cancel(),r.core.state.disableNextSendPositionAction=!0},this.resendPositionAction=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];r.core.state.lastSendAction===Ct.POSITION&&r.vcController.isRecord&&r.sendPositionAction(e)},this.handleActivateCommentChange=function(e){var n=r.core.state,o=n.currentActiveCommentContext,i=n.replayCommentContext,c=n.lastReplayAction,a=e||o;if(a){var l=a.activeCommentId,s=a.panelHeight,u=a.panelTop;l&&Object(Pt.V)(l)||(r.core.state.currentActiveCommentContext={activeCommentId:l,panelHeight:s,panelTop:u},l?(r.sendPositionAction.cancel(),r.sendThirdScrollAction(It.COMMENT,{commentId:l}),r.vcController.isFollow&&(r.targetNotFoundHelper.notify(l),(null===c||void 0===c?void 0:c.actionType)!==Ct.THIRD_SCROLL||c.data.type!==It.COMMENT||l!==(null===i||void 0===i?void 0:i.activeCommentId)||Object(C.isEqual)(r.core.state.currentActiveCommentContext,i)||r.replayHandler(c))):r.sendPositionAction(!0))}},this.handleFollowScrollTopChange=function(e){var n,o=r.core.state,i=o.replayCommentContext,c=o.currentActiveCommentContext,a=o.scrollingInfo;if((0!==e||(null===i||void 0===i?void 0:i.scrollTop))&&i){var l=function(){return r.pendingScrollHelper.push((function(){return r.handleFollowScrollTopChange(e)}),Bt.COMMENT_SCROLL)};if(null===i||void 0===i?void 0:i.activeCommentId)if(a)l();else{var s=i.activeCommentId,u=i.panelHeight,d=void 0===u?0:u;if(s){var f=null===(n=r.core.commentModule.getRecordsByCommentId(s))||void 0===n?void 0:n[0];r.replayAction.cancel(),i.scrollTop=e,r.core.state.doFollowerEditorResizeCallbackTimes=8;var h={recordId:f,getScrollTopWhenStartScroll:function(){return(r.core.calcNormalCommentScrollTop(s,d)||0)+e}};r.core.state.followerEditorResizeCallback=function(){return r.scrollToPosition(tn(tn({},h),{},{from:"editor resize: comment follow scroll"}))},r.scrollToPosition(tn(tn({},h),{},{from:"comment follow scroll"}))}}else(null===c||void 0===c?void 0:c.activeCommentId)&&l()}},this.sendThirdScrollAction=Object(C.debounce)((function(e,n){var o,i=n.commentId;e===It.COMMENT&&(o=r.core.getThirdScrollCommentOptions(i)),o&&r.sendState(Ct.THIRD_SCROLL,{type:e,options:o})}),80),this.sendPositionAction=Object(C.debounce)((function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=r.core.state.lastPositionState,o=n||{},i=o.blockId,c=o.blockYRatio,a=void 0===c?0:c,l=o.titleYRatio,s=void 0===l?0:l,u=!0===e,d=r.core.getCurrPositionState();if(u&&(r.core.state.disableNextSendPositionAction=!1),r.core.state.disableNextSendPositionAction)return r.core.state.lastPositionState=d,void(r.core.state.disableNextSendPositionAction=!1);if(B.S.isMobile){if("fixed"===document.body.style.position)return;var f=r.core.commentModule,h=f.isPanelShow,p=f.isCommentInFloatMode;if(h&&p)return}(u||d.blockId!==i||Math.abs(d.blockYRatio-a)*r.core.getBlockRect(d.blockId).height>10||Math.abs((d.titleYRatio||0)-s)>.01)&&(r.core.state.lastPositionState=d,r.sendState(Ct.POSITION,d),r.sendVcPosition(_t.f.FOLLOWER,d))}),80),this.handleBlockModelCreate=function(e){var n=e.model.recordId;r.targetNotFoundHelper.notify(n)},this.handleEditorResize=Object(C.debounce)((function(){r.doFollowerEditorResizeCallback(),r.resendPositionAction()}),80),this.doFollowerEditorResizeCallback=Object(C.debounce)((function(){var e=r.core.state,n=e.doFollowerEditorResizeCallbackTimes,o=e.pendingScrollAction,i=e.followerEditorResizeCallback,c=e.scrollingInfo;!r.vcController.isFollow||n<=0||o||!i||(c?r.pendingScrollHelper.push(i,Bt.EDITOR_RESIZE):(i(),r.core.state.doFollowerEditorResizeCallbackTimes--))}),80),this.registerVcFollow=function(){r.unregisterVcFollow||(r.unregisterVcFollow=r.vcController.register({moduleName:Lt,defaultState:x()({},Ct.POSITION,r.core.getDefaultPositionState()),replayHandler:function(e){return r.replayHandler(e,Bt.VC_DISPATCH)},presenterHandler:r.presenterHandler,cycleHandler:r.cycleHandler,retryOptions:{retryTimes:8,retryIntervalMs:500},checkSame:r.checkSame,retryOnVersionMatched:"always"}),r.sendPositionAction())},this.cycleHandler=function(e){var n;switch(e){case mt.START_RECORD:r.core.commentModule.disableScrollInVC&&r.resendPositionAction(!0);break;case mt.START_FOLLOW:r.core.selectionAPI.removeAllSelection(),null===(n=window.getSelection())||void 0===n||n.removeAllRanges();break;case mt.STOP_FOLLOW:r.clear()}},this.replayHandler=function(e,n){r.pendingReplayHelper.push(tn(tn({},e),{},{from:n})),r.replayAction()},this.replayAction=Object(C.debounce)((function(){var e=r.pendingReplayHelper.getReplayAction(r.checkHasTarget);if(e){var n=e.actionType,o=e.uuid,i=e.data,c=e.isRetry,a=e.reason,l=e.from;if(Object(R.N)("vc_doc_position",{uuid:o,from:l,info:"replay action",actionType:n,data:i,reason:a}),r.core.state.isPresenterV2=n===Ct.THIRD_SCROLL||n===Ct.POSITION&&i.v2,r.vcController.isFollow||a===mt.ReplayReason.ForceSetState){if(r.doFollowerEditorResizeCallback.cancel(),r.checkHasTarget(e)&&!r.checkIsScrolling(e,l)){var s=r.core.scrollTop;switch(r.core.state.lastReplayAction=e,!c&&(r.core.state.doFollowerEditorResizeCallbackTimes=8),n){case Ct.POSITION:r.replayPositionAction(e,s);break;case Ct.THIRD_SCROLL:r.replayThirdScrollAction(e,s)}}}else r.reportIgnore(o,"user is not following")}}),40),this.checkHasTarget=function(e){var n=e.actionType,o=e.data,i=e.uuid,c=e.timestamp;if(r.targetNotFoundHelper.notFoundAction){var a=r.targetNotFoundHelper.notFoundAction,l=a.uuid,s=a.timestamp;i!==l&&s<c&&r.targetNotFoundHelper.clear()}switch(n){case Ct.POSITION:var u=o.blockId;if(!r.core.blockManager.getBlockIdsByRecordId(u).length)return r.targetNotFoundHelper.set(e,u),!1;break;case Ct.THIRD_SCROLL:var d,f=o,h=f.type,p=f.options;if(h===It.COMMENT&&(null===(d=r.core.state.currentActiveCommentContext)||void 0===d?void 0:d.activeCommentId)!==p.commentId)return r.targetNotFoundHelper.set(e,p.commentId),!1}return!0},this.checkIsScrolling=function(e,n){var o=r.core.state,i=o.pendingScrollAction,c=o.scrollingInfo;return i&&i.uuid!==e.uuid&&(r.reportIgnore(i.uuid,"current pending action not consume, next action coming"),r.core.state.pendingScrollAction=void 0),!!c&&(c.canCancel?(c.hasCancel=!0,$(r.core.scroller).stop(),!1):(r.core.state.pendingScrollAction=e,r.pendingScrollHelper.push((function(){r.core.state.pendingScrollAction&&r.replayHandler(r.core.state.pendingScrollAction,n),r.core.state.pendingScrollAction=void 0}),n),!0))},this.handleThirdScrollAfterScroll=function(e){var n=e.type,o=e.options;if(n===It.COMMENT){var i,c,a=o.commentId;r.sendThirdScrollAction(It.COMMENT,{commentId:a}),null===(i=(c=r.core.commentModule.commentScroller).fixHorizontalScroll)||void 0===i||i.call(c,a)}},this.scrollToPosition=function(e){var n=e.uuid,o=e.recordId,i=e.from,c=e.scrollTop,a=e.animate,l=void 0!==a&&a,s=e.canCancel,u=void 0!==s&&s,d=e.forceRender,f=void 0!==d&&d,h=e.beforeScroll,p=e.afterScroll,v=e.getScrollTopWhenStartScroll;if(void 0===c&&void 0===v)return Promise.reject(new Error("params [scrollTop] and [getScrollTopWhenStartScroll] must has one"));var g=function(e,r,c){return Object(R.N)("vc_doc_position",{uuid:n,from:i,animate:l,info:r,recordId:o,currentTop:e,expectTop:c,device_id:Object(S.getDeviceId)()})};r.core.state.scrollingInfo={uuid:n,canCancel:u,hasCancel:!1};var b=function(){var e=Dt()(Mt.a.mark((function e(n,i){var a,s,u,d,b,y;return Mt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.core.scrollTop,g(a,"scroll to position",c),s=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],o=arguments.length>1?arguments[1]:void 0,c=arguments.length>2?arguments[2]:void 0;null===p||void 0===p||p(),g(r.core.scrollTop,e?"scroll success: ".concat(o):"scroll fail: ".concat(o),c),e?n(r.core.state.scrollingInfo):i(o),r.core.state.scrollingInfo=void 0,r.pendingScrollHelper.run()},u=function(e,n,o){var i=v?v():c;if(void 0===i){var a="get scroll top undefined";return null===o||void 0===o||o(a),void s(!1,a)}Object($t.p)(r.core.scroller,i,l,(function(){null===n||void 0===n||n(),s(!0,e,i)}),(function(e){null===o||void 0===o||o(e),s(!1,e,i)}),{beforeScroll:h})},d=a<=c&&a+r.core.scrollerOffsetHeight>=c,!f&&d){e.next=17;break}if(b=!1,y=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"viewport scroll";return new Promise((function(e,o){var i;b=!0,(null===(i=r.core.state.scrollingInfo)||void 0===i?void 0:i.hasCancel)?(e(),s(!1,"has cancel")):u(n,e,o)}))},!o){e.next=14;break}return e.next=11,r.core.viewPort.scrollToRecord(o,y,!0);case 11:!b&&y(0,"viewport finally scroll"),e.next=15;break;case 14:u("viewport no recordId scroll");case 15:e.next=18;break;case 17:a===c?s(!0,"top same"):u("normal scroll");case 18:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}();return new Promise(b)},this.reportScrollResult=function(e,n,o,i){var c,a=i.startScrollTime,l=i.beforeScrollTop,s=i.expectScrollTop,u=i.afterScrollTop,d=n.uuid,f=n.actionType,h=u||r.core.scrollTop;if(null===(c=e)||void 0===c?void 0:c.hasCancel)r.reportIgnore(d,"scroll has cancel");else{var p=o(),v=nt()(p,2),g=v[0],b=v[1];if(g)r.vcController.reportReplay(_t.s.SUCCESS,d,a);else{var y="".concat(f," fail by scroll position is not right");e instanceof Error?y=e.message:void 0===e.hasCancel&&(e=JSON.stringify(e)),r.reportFail(n,y,h,s,l,a,b)}}},this.reportIgnore=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";e&&r.vcController.reportReplay(_t.s.IGNORE,e,n)},this.presenterHandler=function(e){var n=e.actionType,o=e.data;n===Ct.POSITION&&r.sendVcPosition(_t.f.PRESENTER,o)},this.checkSame=function(e,n,o){if(e===Ct.POSITION){var i=n.blockId,c=n.blockYRatio;if(i===o.blockId){if(i===r.core.blockManager.rootRecordId||n.titleYRatio&&o.titleYRatio)return!0;if(Math.abs(c-o.blockYRatio)<=30/r.core.getBlockRect(i).height)return!0}var a=r.core,l=a.scrollTop,s=a.scrollerHeight-a.scrollerOffsetHeight,u=r.core.calcScrollTop(n),d=r.core.calcScrollTop(o);if(Math.abs(u-d)<=30)return!0;if(l+30>=s&&u>=s)return!0;var f=r.core.blockManager.getBlockModelsByRecordId(i)[0],h=f.previous,p=f.next;if((!h||h.id===r.core.blockManager.rootBlockId)&&c<0||!p&&c>1)return!0}if(e===Ct.THIRD_SCROLL){var v=n,g=v.type,b=v.options,y=o,m=y.type,_=y.options;if(g===It.COMMENT&&m===It.COMMENT)return b.commentId===_.commentId}return!1};var o=n.vcController,i=n.blockManager,c=n.commentModule,l=i.editorAPI;this.core=new Qt(n),this.vcController=o,this.targetNotFoundHelper=new Wt(o,(function(e){return o.isFollow&&r.replayHandler(e,Bt.FOUND_TARGET)})),this.versionChangeHelper=new zt(i,this.resendPositionAction),this.pendingScrollHelper=new Ht,this.pendingReplayHelper=new Ut(c.disableScrollInVC,this.reportIgnore),c.setVcPosition(this),this.binding("on"),l.modelService.isInitialDataReady()?this.registerVcFollow():this.readySub=l.lifecycle.editorReady$.subscribe((function(){r.registerVcFollow()}))}return s()(e,[{key:"clear",value:function(){var e=this.core.state,n=e.scrollingInfo,r=e.pendingScrollAction;this.replayAction.cancel(),this.handleEditorResize.cancel(),this.doFollowerEditorResizeCallback.cancel(),this.reportIgnore(null===n||void 0===n?void 0:n.uuid,"ignore pending action cause page unmount"),this.reportIgnore(null===r||void 0===r?void 0:r.uuid,"ignore pending action cause page unmount"),this.pendingReplayHelper.clear(),this.targetNotFoundHelper.clear(),this.pendingScrollHelper.clear(),this.core.state.resetFollowState()}},{key:"binding",value:function(e){var n,r=this.core.blockManager.editorAPI.modelService;this.core.commentModule.disableScrollInVC&&(this.core.commentModule[e](At.M.ACTIVE_COMMENT_CHANGE,this.handleActivateCommentChange),le.N[e](At.M.FOLLOW_SCROLL_TOP_CHANGE,this.handleFollowScrollTopChange));var o="on"===e?"addListener":"removeListener";this.core.blockManager[o](Ue.G,this.handleEditorResize);var i="on"===e?"subscribe":"unsubscribe";r.blockModelCreate$[i](this.handleBlockModelCreate);var c="on"===e?"addEventListener":"removeEventListener";null===(n=this.core.scroller)||void 0===n||n[c]("scroll",this.sendPositionAction),window[c]("resize",this.resendPositionAction)}},{key:"sendState",value:function(e,n){this.core.state.lastSendAction=e,this.vcController.sendState(Lt,e,n,!0)}},{key:"replayPositionAction",value:function(e,n){var r=this,o=e.uuid,i=e.isRetry,c=this.core.state.isFirstTimeToScroll,a=Date.now(),l=this.core.calcScrollTop(e),s=!i&&!c;this.core.commentModule.setCommentViewPortLock(!1),c&&(this.core.state.isFirstTimeToScroll=!1);var u=function(o){var i=r.core.scrollTop;r.reportScrollResult(o,e,(function(){return r.core.checkScrollPositionRight(l,i)}),{startScrollTime:a,expectScrollTop:l,beforeScrollTop:n,afterScrollTop:i})},d={uuid:o,recordId:this.core.getRecordIdFromAction(e)};this.core.state.followerEditorResizeCallback=function(){return r.scrollToPosition(tn(tn({},d),{},{scrollTop:r.core.calcScrollTop(e),from:"editor resize, action: position",canCancel:!0}))},this.scrollToPosition(tn(tn({},d),{},{scrollTop:l,from:"replay position action",animate:s,beforeScroll:function(){return a=Date.now()}})).then(u).catch(u).finally((function(){return r.core.checkScrollPositionAndReport(e)}))}},{key:"replayThirdScrollAction",value:function(e,n){var r=this,o=e.data,i=e.uuid;this.core.state.replayCommentContext=this.core.state.currentActiveCommentContext;var c,a=Date.now(),l=function(i){return r.reportScrollResult(i,e,(function(){return r.core.checkThirdScrollPositionRight(o)}),{expectScrollTop:c,beforeScrollTop:n,startScrollTime:a})},s={uuid:i,recordId:this.core.getRecordIdFromAction(e),forceRender:!0,getScrollTopWhenStartScroll:function(){return c=r.core.calcScrollTop(e)},beforeScroll:this.disableNextSendPosition,afterScroll:function(){var n=Dt()(Mt.a.mark((function n(){return Mt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.handleThirdScrollAfterScroll(e.data);case 2:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()};this.core.state.followerEditorResizeCallback=function(){return r.scrollToPosition(tn(tn({},s),{},{from:"editor resize, action: third scroll",canCancel:!0}))},this.scrollToPosition(tn(tn({},s),{},{from:"replay third scroll action"})).then(l).catch(l)}},{key:"reportFail",value:function(e,n,r,o,i,c,a){var l=e.uuid,s=e.actionType,u=e.data,d=void 0!==r?r:this.core.scrollTop,f=void 0!==i?i:d,h="[".concat(Lt,"]: ").concat(n);this.vcController.reportReplay(_t.s.FAIL,l,h,c),Object(R.N)("vc_action_apply_dev",{code:1,info:h,uuid:l,module:Lt,actionType:s,beforeTop:f,currentTop:d,expectTop:o,checkTop:a,string_param_1:"\u6eda\u52a8\u524d: ".concat(f,", \u9884\u671f: ").concat(o,"\uff0c\u5b9e\u9645: ").concat(d,", \u6709\u5c01\u9762: ").concat(this.core.coverHeight?"yes":"no").concat(s===Ct.THIRD_SCROLL&&u.type===It.COMMENT?", context: ".concat(JSON.stringify(this.core.state.replayCommentContext)):""),string_param_2:JSON.stringify(u)})}},{key:"sendVcPosition",value:function(e,n){var r,o=this.core.calcScrollTop({actionType:Ct.POSITION,data:n})/this.core.rect.getBlockRect(this.core.blockManager.rootBlockId).height;null===(r=this.vcController)||void 0===r||r.sendPosition(e,{x:0,y:o})}}]),e}(),pn=r("dx_vira"),vn=r("dx_GXpI"),gn=r("dx_IdVu");function bn(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function yn(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?bn(Object(r),!0).forEach((function(n){x()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bn(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var mn,_n,kn,On,xn=Object(E.s)(k.a)((rn=function(){function e(){var n=this;a()(this,e),this.getIsMobileEditMode=void 0,this.fold=void 0,this.profile=void 0,this.coverModule=void 0,this.commentModule=void 0,this.viewport=void 0,this.scrollFpsCollector=void 0,this.pcMessage=void 0,this.blockitModule=void 0,this.scrollingDetector=void 0,this.clipboard=void 0,this.catalogue=void 0,this.detail=void 0,this.rectForFixed=void 0,this.fileUploader=void 0,this.autoExpandCellModule=void 0,this.layout=void 0,this.messageModule=void 0,this.vcPosition=void 0,this.vcHover=void 0,this.nativeInvokeController=void 0,this.headingModule=void 0,i()(this,"selectionAPI",on,this),i()(this,"config",cn,this),i()(this,"modelService",an,this),i()(this,"blockManager",ln,this),i()(this,"lazyRecord",sn,this),i()(this,"rect",un,this),i()(this,"eventEmitter",dn,this),i()(this,"undoModule",fn,this),this.vcController=void 0,this.vcKey=void 0,this.options=void 0,this.editableChangeSub=void 0,this.uuid=Object(I.S)(),this.blockViewportAdapter=void 0,this.handleEditableChange=function(e){var r;le.S.emit(j.H.EditableChange,{curr:e}),null===(r=n.undoModule)||void 0===r||r.setEnable(e)}}return s()(e,[{key:"init",value:function(e){var n,r,o;this.options=e;var i=e.vcController,c=e.getIsMobileEditMode,a=e.contentRef;this.vcController=i,this.getIsMobileEditMode=c;var l=this.rect,s=this.config,u=this.blockManager,d=this.eventEmitter,f=this.lazyRecord;M.R.setBlockManager(u);var h=s.get("scroller"),p=s.get("container");this.blockViewportAdapter=new Z.S({blockManager:u}),this.fold=new ue.S(u,this.vcController),this.selectionAPI.init({getContentContainer:function(){return p},boundaryAreaContainer:s.get("boundary"),pasteBoundary:p,selectionAreaContainer:document.body,unSelectableType:[A.B.SELECTION,A.B.GRID,A.B.GRID_COLUMN,A.B.VIEW,A.B.PENDING,A.B.OBJECTIVE,A.B.KEY_RESULT,A.B.PROGRESS]},this.fold),this.undoModule.setEnable(this.config.editable),this.profile=new S.Profile((function(e,n){Object(R.N)(e,yn(yn({},n),{},{__disable_storage__:1}))})),this.editableChangeSub=s.editableChange$.subscribe(this.handleEditableChange),this.coverModule=new ne.S({blockManager:u,pageToken:s.get("token"),editable:s.get("editable"),selectionAPI:this.selectionAPI}),this.headingModule=new de.a({blockManager:this.blockManager,eventEmitter:this.eventEmitter,selectionAPI:this.selectionAPI,modelService:this.modelService}),this.setupSelectionAPI(),this.viewport=new pn.o({container:s.get("boundary"),selectionAPI:this.selectionAPI,fold:this.fold,rect:this.rect,blockManager:u,eventEmitter:d}),this.scrollingDetector=new et.Q(h),Object(gn.m)(this,l,this.fold,u,s.get("token"),s.get("commentable")||!1,le.S,d,this.viewport),this.scrollFpsCollector=new Ie({scroller:h,container:p,blockManager:u,commentModule:this.commentModule}),B.S.isMobile||(this.pcMessage=new be),null===(n=this.pcMessage)||void 0===n||n.setCommentModule({commentModule:this.commentModule,scroller:h}),this.profile.setGetContext(Object(T.F)(u,this.commentModule,f)),w.S.setProfileContext(Object(T.F)(u,this.commentModule,f)),this.completeVcMagicShare(),this.vcKey={token:s.get("token")},this.blockitModule=Q.S.creatorBlockitModule("".concat(this.vcKey.token,"_").concat(this.uuid),u);var v=this.toPlainObject();if(this.clipboard=new te.S(yn(yn({},v),{},{pageToken:s.get("token")})),!B.S.isFeed){var g=Object(vn.r)(),b=Object(vn.d)();this.catalogue=new ee.S({lazyRecord:this.lazyRecord,blockManager:this.blockManager,rect:this.rect,scroller:h,initialCatalogItems:g,eventEmitter:this.eventEmitter,headingModule:this.headingModule,initialHeadingRecords:b})}this.detail=new ae({blockManager:this.blockManager,eventEmitter:this.eventEmitter,isInWiki:!!this.config.get("tokenFromWiki")}),this.rectForFixed=new $e({blockManager:u,scroller:h,catalogue:this.catalogue,isInWiki:Boolean(this.config.get("isInWiki"))}),this.fileUploader=new se(this.blockManager),this.autoExpandCellModule=new J.S(this.blockManager),this.layout=new fe.S({catalogue:new he.S((function(){return document.querySelector(".catalogue")})),content:new he.S(a),comment:new he.S((function(){return B.S.isLarkFeed?document.querySelector(".message-container"):document.querySelector("#docCommentContainer")})),editor:new he.S((function(){return p}))}),null===(r=this.pcMessage)||void 0===r||r.handleEditorMount({blockManager:u,viewport:this.viewport}),null===(o=e.onContextInit)||void 0===o||o.call(e,this)}},{key:"toPlainObject",value:function(){return{selectionAPI:this.selectionAPI,blockManager:this.blockManager,boundary:this.boundary,fold:this.fold,editable:this.editable,catalogue:this.catalogue,editPermission:this.editPermission,isMobileEditMode:this.isMobileEditMode,copyable:this.copyable,commentModule:this.commentModule,messageModule:this.messageModule,undoModule:this.undoModule,exportable:this.exportable,fileUploader:this.fileUploader,scroller:this.scroller,rect:this.rect,lazyRecord:this.lazyRecord,profile:this.profile,vcController:this.vcController,layout:this.layout,rectForFixed:this.rectForFixed,viewport:this.viewport,eventEmitter:this.eventEmitter,container:this.container,tokenFromWiki:this.config.get("tokenFromWiki"),blockViewportAdapter:this.blockViewportAdapter,headingModule:this.headingModule}}},{key:"destroy",value:function(){var e,n,r,o,i,c,a,l,s,u,d,f,h,p;null===(e=this.pcMessage)||void 0===e||e.destroy(),null===(n=this.vcController)||void 0===n||n.setBlockManager(null),this.viewport.destroy(),this.blockViewportAdapter.destroy(),this.headingModule.destroy(),this.clipboard.unmount(),null===(r=this.catalogue)||void 0===r||r.destroy(),this.coverModule.destroy(),this.detail.destroy(),this.fold.destroy(),this.profile.destroy(),this.commentModule.destroy(),null===(o=this.messageModule)||void 0===o||o.destroy(),Q.S.destroyBlockitModule(this.blockitModule,"".concat(this.vcKey.token,"_").concat(this.uuid)),null===(i=this.nativeInvokeController)||void 0===i||i.destroy(),this.fileUploader.destroy(),this.autoExpandCellModule.destroy(),this.scrollFpsCollector.destroy(),w.S.setProfileContext(C.noop),null===(c=this.layout)||void 0===c||c.destroy(),null===(a=this.rectForFixed)||void 0===a||a.destroy(),null===(l=this.vcPosition)||void 0===l||l.destroy(),null===(s=this.vcHover)||void 0===s||s.destroy(),null===(u=this.editableChangeSub)||void 0===u||u.unsubscribe(),null===(d=this.options)||void 0===d||null===(f=d.onContextDestroy)||void 0===f||f.call(d,this),Be.T.destroy(),h=this.config.get("token"),p=this.blockManager,Object(H.c)(h,p).garbage.flush(),Object(V.u)(h)}},{key:"setupSelectionAPI",value:function(){this.selectionAPI.register(q.q.startTargetFilter,U.R.selectionTargetFilter),this.selectionAPI.register(q.q.startTargetFilter,F.S.selectionTargetFilter),this.selectionAPI.register(q.q.startTargetFilter,N.S.selectionTargetFilter),this.selectionAPI.register(q.q.startTargetFilter,L.S.selectionTargetFilter),this.selectionAPI.register(q.q.startTargetFilter,P.S.selectionTargetFilter),this.selectionAPI.register(q.q.startTargetFilter,D.D.selectionTargetFilter)}},{key:"completeVcMagicShare",value:function(){var e=this.vcController,n=this.blockManager,r=this.selectionAPI,o=this.rect,i=this.viewport,c=this.scroller;e&&(e.setBlockManager(n),e.setSelectionAPI(r),this.vcPosition=new hn({vcController:e,blockManager:n,rect:o,viewPort:i,selectionAPI:r,scroller:c,commentModule:this.commentModule}),this.vcHover=new wt(e,function(e){return new yt([new gt(e),new pt(e),new vt(e),new bt(e)],e)}(n),n))}},{key:"isMobileEditMode",get:function(){var e,n;return null!==(e=null===(n=this.getIsMobileEditMode)||void 0===n?void 0:n.call(this))&&void 0!==e&&e}},{key:"boundary",get:function(){return this.config.get("boundary")}},{key:"scroller",get:function(){return this.config.get("scroller")}},{key:"container",get:function(){return this.config.get("container")}},{key:"editable",get:function(){return this.config.get("editable")}},{key:"editPermission",get:function(){return this.config.get("editPermission")}},{key:"copyable",get:function(){return this.config.get("copyable")}},{key:"exportable",get:function(){return this.config.get("exportable")}}]),e}(),on=m()(rn.prototype,"selectionAPI",[X.S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),cn=m()(rn.prototype,"config",[_.j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),an=m()(rn.prototype,"modelService",[_.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ln=m()(rn.prototype,"blockManager",[z.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sn=m()(rn.prototype,"lazyRecord",[K.M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),un=m()(rn.prototype,"rect",[W.z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dn=m()(rn.prototype,"eventEmitter",[G.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fn=m()(rn.prototype,"undoModule",[Y.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nn=rn))||nn;function En(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Sn=Object(_.H)({providers:[xn]})((On=function(e){h()(r,e);var n=En(r);function r(){var e;a()(this,r);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return e=n.call.apply(n,[this].concat(c)),i()(e,"context",kn,d()(e)),e}return s()(r,[{key:"init",value:function(){this.context.init(this.options)}},{key:"destroy",value:function(){this.context.destroy()}}]),r}(_.G),_n=On,kn=m()(_n.prototype,"context",[k.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mn=_n))||mn},dx_K2Kl:function(e,n,r){"use strict";var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=function(){function e(){i()(this,e),this.startTimestamp=new Map}return a()(e,[{key:"start",value:function(e){this.startTimestamp.set(e,performance.now())}},{key:"end",value:function(e){var n=this.startTimestamp.get(e);return(performance.now()-n).toFixed(4)}},{key:"clear",value:function(){this.startTimestamp.clear()}}]),e}();n.S=l},dx_K3oP:function(e,n,r){"use strict";r.d(n,"f",(function(){return i}));var o=r("dx_K9Ia"),i={mainScroll$:new o.Z,paddingChange$:new o.Z}},dx_K7RJ:function(e,n,r){"use strict";r.d(n,"C",(function(){return b}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_h6a8"),a=r("dx_cDcd"),l=r("dx_RIqP"),s=r.n(l),u=r("dx_B28d"),d=function(e,n){if(n&&!e.hasBlockModelByBlockId(n))return"";var r=e.getBlockPath(n);return[].concat(s()(r),[n]).find((function(n){return e.getBlockModelByBlockId(n).type===u.B.TABLE}))},f=r("dx_bbfH"),h=r("dx_BEcL"),p=r("dx_QBqw"),v=r("dx_a7X6"),g=r("dx_IWRl"),b=function(e){var n=e.block,r=e.equationViewInstance,o=e.getEquationRange;return{autoExpandTableCell:Object(a.useCallback)((function(){var e,a,l,s;if(n){var u=o();if(u){var b=n.model.getAttributes(u.start,u.end).toMap().objectID;if(b&&v.h.initEquationSet.has(b)){v.h.initEquationSet.delete(b);var y=n.parentId,m=n.blockManager,_=null===(e=r.current)||void 0===e?void 0:e.getViewElement();if(y&&_){var k=d(m,y),O=Object(g.b)(m,y);if(k&&O&&!(((null===(a=_.parentElement)||void 0===a?void 0:a.clientWidth)||0)>=_.scrollWidth)){var x=null===(l=m.getRecordByBlockId(k))||void 0===l?void 0:l.snapshot,E=null===(s=m.getRecordByBlockId(O))||void 0===s?void 0:s.id;if(x&&E){for(var S=null,C=x.column_set,I=x.cell_set,B=0,T=Object.entries(I);B<T.length;B++){var w=i()(T[B],2),R=w[0];if(w[1].block_id===E){var M=Object(p.j)(R);S=i()(M,2)[1];break}}var j=_.scrollWidth+2*f.K,D=Object(c.cloneDeep)(C);S&&D[S]&&(D[S].column_width=Math.max(j,f.P),Object(h.J)({blockManager:m,blockId:k,column_set:D}))}}}}}}}),[n])}}},dx_K7ih:function(e,n,r){"use strict";r.d(n,"S",(function(){return h}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_z0z2"),h=function(){function e(){var n=this;s()(this,e),this.worker=void 0,this.getWorkerPromise=void 0,this.blockManager=void 0,this.highlightTasks=void 0,this.identifyLanguageTasks=void 0,this.onmessage=function(e){var r=e.data;switch(r.type){case f.k.HIGHLIGHT:n.onHighlightTaskFinished(r.data);break;case f.k.AUTO_IDENTIFY_LANGUAGE:n.onIdentifyLanguageTaskFinished(r.data)}},this.highlightTasks=new Map,this.identifyLanguageTasks=new Map,this.initEvents()}return d()(e,null,[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),d()(e,[{key:"getWorker",value:function(){var e=a()(i.a.mark((function e(){var n=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.worker){e.next=2;break}return e.abrupt("return",this.worker);case 2:if(!this.getWorkerPromise){e.next=4;break}return e.abrupt("return",this.getWorkerPromise);case 4:return this.getWorkerPromise=new Promise((function(e){r.e("dx_jiz").then(r.t.bind(null,"dx_hy1Q",7)).then((function(r){var o=r.default;n.worker=new o,e(n.worker)})).catch((function(e){console.warn(e),console.warn("load code worker failed")})).finally((function(){n.getWorkerPromise=null}))})),e.abrupt("return",this.getWorkerPromise);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initEvents",value:function(){var e=this;this.getWorker().then((function(n){n.addEventListener("message",e.onmessage)})).catch((function(e){console.warn(e)}))}},{key:"onHighlightTaskFinished",value:function(e){var n=e.zoneId,r=e.localMarks,o=this.highlightTasks.get(n);if(null===o||void 0===o?void 0:o.length){var i=o.shift().onLocalMarksReady;0===o.length?(i(r),this.highlightTasks.delete(n)):this.runHighlightTask(n)}}},{key:"onIdentifyLanguageTaskFinished",value:function(e){var n=e.zoneId,r=e.localMarks,o=e.language,i=this.identifyLanguageTasks.get(n);if(null===i||void 0===i?void 0:i.length){var c=i.shift().onLanguageIdentified;0===i.length?(c({localMarks:r,language:o}),this.identifyLanguageTasks.delete(n)):this.runIdentifyLanguageTask(n)}}},{key:"runHighlightByWorker",value:function(e){var n=e.zoneId,r=e.code,o=e.language;this.getWorker().then((function(e){e.postMessage({type:f.k.HIGHLIGHT,payload:{zoneId:n,code:r,language:o}})})).catch((function(e){console.warn(e)}))}},{key:"runHighlightTask",value:function(e){var n=this.highlightTasks.get(e);if(null===n||void 0===n?void 0:n[0]){var r=n[0],o=r.code,i=r.language;this.runHighlightByWorker({zoneId:e,code:o,language:i})}}},{key:"runIdentifyLanguageTask",value:function(e){var n=this.identifyLanguageTasks.get(e);if(null===n||void 0===n?void 0:n[0]){var r=n[0],o=r.code,i=r.zoneId;this.worker.postMessage({type:f.k.AUTO_IDENTIFY_LANGUAGE,payload:{code:o,zoneId:i}})}}},{key:"addHighlightTask",value:function(e){var n=e.zoneId,r={code:e.code,language:e.language,onLocalMarksReady:e.onLocalMarksReady},o=this.highlightTasks.get(n);o?this.highlightTasks.set(n,[o.shift(),r]):(this.highlightTasks.set(n,[r]),this.runHighlightTask(n))}},{key:"addIdentifyLanguageTask",value:function(e){var n=e.zoneId,r={code:e.code,onLanguageIdentified:e.onLanguageIdentified,zoneId:n},o=this.identifyLanguageTasks.get(n);o?this.identifyLanguageTasks.set(n,[o.shift(),r]):(this.identifyLanguageTasks.set(n,[r]),this.runIdentifyLanguageTask(n))}},{key:"clearHighlightTask",value:function(e){this.highlightTasks.delete(e)}},{key:"clearIdentifyLanguageTask",value:function(e){this.identifyLanguageTasks.delete(e)}},{key:"subscribeDestroy",value:function(e){var n=this;!this.blockManager&&e&&(this.blockManager=e,this.blockManager.editorAPI.lifecycle.editorWilDestroy$.subscribe((function(){n.destroy()})))}},{key:"destroy",value:function(){this.highlightTasks.clear(),this.identifyLanguageTasks.clear(),this.worker&&this.worker.terminate(),this.getWorkerPromise=null,this.blockManager=null,e.instance=null}}]),e}();h.instance=void 0},dx_K8KR:function(e,n,r){"use strict";r.d(n,"W",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("sync-cursor-select-state-service")},dx_K8h1:function(e,n,r){"use strict";r.d(n,"u",(function(){return o})),r.d(n,"uY",(function(){return i}));var o={CONTENT_SCROLLER:"content-scroller"},i={BLOCK_BG_HOVER:"var(--ccmtoken-doc-block-bg-hover)"}},dx_K9KW:function(e,n,r){"use strict";(function(t){r.d(n,"A",(function(){return m}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_RIqP"),c=r.n(i),a=r("dx_lSNA"),l=r.n(a),s=r("dx_ga2g"),u=r("dx_B28d"),d=r("dx_hFUV"),f=r("dx_vOIB"),h=r("dx_GLPm"),p=r("dx_o6oG"),v=r("dx_tsDa");function g(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function b(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?g(Object(r),!0).forEach((function(n){l()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var y=u.h.filter((function(e){return e!==u.B.TABLE&&e!==u.B.CELL})).concat(u.B.CODE);function m(e){var n=e.selectedBlocks,r=e.blockManager,i=e.data,a=i.recordIds,l=i.recordMap,h=i.payloadMap,g=r.getBlockModelByBlockId(n[0].id),m=g.type===u.B.CODE?g:g.parent;if(m){var O,x=b(b({},_(m)),{},{record:m.record,blockType:m.type,children:[]}),E=function(e,n,r,i,c,a){var l,s=new Map;1===n.length&&r[n[0]].snapshot.type===u.B.TABLE&&Object(v.e)(e,a)&&!y.includes(c.type)&&(l=n[0]);var d=n.filter((function(n){return n===e.rootRecordId})),h=o()(d,1)[0];return n.forEach((function(n){k(e,n,r,i)&&e.recordManager.pureTraverse(n,c.record,(function(e){return r[e]}),(function(n,o){var a=n.snapshot.type,d=n.id;if(!k(e,d,r,i))return!0;var v=c;v=(!h||d!==h&&(null===o||void 0===o?void 0:o.id)!==h)&&s.get(o.id)||c;var g={type:l===d?p.c:a,children:a===u.B.TABLE?null:[],parent:v,level:u.h.includes(v.type)?1:Object(f.q)(v)+1,depth:v.depth+1,record:n};return s.set(d,g),v.children&&v.children.push(g),!0}))})),s}(r,a,l,h,x,n),S=[];if(Object(p.L)(r,n,x,(function(e){return l[e].snapshot}),{onNoCreator:function(){Object(s.F)({mobileToastType:"top",pcToastType:"info",message:t("CreationDoc_DocX_Paste_failed_toast"),duration:5e3,key:"paste-no-creator"})},onFilterInvalidBlock:function(e){S.push(e)}}),S.length){var C=Array.from(new Set(S.map((function(e){return d.L[e.type]})).filter((function(e){return void 0!==e})))).join("\u3001");Object(s.F)({pcToastType:"info",mobileToastType:"top",message:t("CreationDoc_Docs_Paste_BlockNotSupported",void 0,void 0,C),duration:5e3,key:"paste-filter-info"})}if(Object.keys(l).forEach((function(e){var n=E.get(e);n&&n.children&&(l[e].snapshot.children=n.children.map((function(e){return e.record.id})))})),i.recordIds.splice(0,a.length),x.children)(O=i.recordIds).push.apply(O,c()(x.children.map((function(e){return e.record.id}))||[]))}}function _(e){return{type:e.type,record:e.record,get children(){return e.children.map(_)},get parent(){return e.parent?_(e.parent):null},level:u.h.includes(e.type)?1:Object(f.q)(e)+1,depth:e.depth+1}}function k(e,n,r,o){if(r[n].snapshot.type===u.B.SHEET){if(!Object(h.h)(e,o[n],n))return!1;o[n].transitionId=n}return!0}}).call(this,r("dx_E9Eu"))},dx_KFKk:function(e,n,r){"use strict";r.d(n,"y",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("offline-upload")},dx_KFmR:function(e,n,r){"use strict";r.d(n,"z",(function(){return a})),r.d(n,"u",(function(){return l})),r.d(n,"L",(function(){return s})),r.d(n,"l",(function(){return u}));var o=r("dx_yzqx"),i=r("dx_B28d"),c=r("dx_iw8O");function a(e){var n=document.getSelection(),r=n&&n.rangeCount>=1?n.getRangeAt(0):null;if(!r)return null;var o=r.startContainer,a=r.endContainer,l=Object(c.S)(o),s=Object(c.S)(a);if(!l||!s||l!==s)return null;var u=e.getBlockViewByBlockIdNotCheck(l);return function(e){return!!(null===e||void 0===e?void 0:e.type)&&i.x.includes(e.type)&&!!e.editorInstance}(u)&&u.editorInstance||null}function l(e,n){var r;e instanceof InputEvent?(e.targetRanges=e.getTargetRanges(),r=new InputEvent(e.type,e),o.S.isIOS&&Object.defineProperties(r,{inputType:{writable:!1,value:e.inputType}})):r=new e.constructor(e.type,e);var i={writable:!1,value:n.getContainer()};return Object.defineProperties(r,{target:i,currentTarget:i,srcElement:i}),r.isDispatchFromEditableExtension=!0,r}function s(e){var n;if(!(e.target instanceof HTMLElement))return!1;var r="true"===e.target.dataset.contentEditableRoot,o=!(!(null===(n=document.querySelector("[data-content-editable-root]"))||void 0===n?void 0:n.contains(e.target))||!e.target.hasAttribute("data-enter")),i=e.target.classList.contains("render-unit-wrapper");return r||o||i}function u(e,n){var r=e.getSelection();if(0===r.length)return!0;var o=n.getBlockViewByBlockId(r[0].id);return!(null===o||void 0===o?void 0:o.isFocus())}},dx_KHsp:function(e,n,r){},dx_KHvq:function(e,n,r){"use strict";r.d(n,"H",(function(){return we})),r.d(n,"N",(function(){return Re.N}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_o0o1"),s=r.n(l),u=r("dx_yXPU"),d=r.n(u),f=r("dx_yG8O"),h=r.n(f),p=r("dx_lwsE"),v=r.n(p),g=r("dx_W8MJ"),b=r.n(g),y=r("dx_PJYZ"),m=r.n(y),_=r("dx_iWIM"),k=r.n(_),O=r("dx_W7W2"),x=r.n(O),E=r("dx_a1gu"),S=r.n(E),C=r("dx_Nsbk"),I=r.n(C),B=r("dx_Uyc2"),T=r.n(B),w=(r("dx_A1AB"),r("dx_Vvd7")),R=r("dx_QxNg"),M=r("dx_xjz2"),j=r("dx_M30o"),D=r("dx_e4eN"),A=r("dx_Z7ZC"),P=r("dx_AMht"),L=r("dx_Fimk"),N=r("dx_eSV8"),F=r("dx_B28d"),U=r("dx_NMQJ"),H=r("dx_PhLz"),V=r("dx_TYsD"),W=r("dx_x1WV"),z=r("dx_fEKD"),G=r("dx_Yuai"),K=r("dx_D8nn"),q=r("dx_PRjj"),X=r("dx_lROi"),Y=r("dx_UTG8"),J=r("dx_I2IP"),Z=r("dx_IdzY"),Q=r("dx_D0JG"),$=r("dx_I11I"),ee=r("dx_s1qv"),te=r("dx_NbrS"),ne=r("dx_WXfY"),re=r("dx_Nn5p"),oe=r("dx_ZG9w"),ie=r("dx_bPy9"),ce=r("dx_kZ3l"),ae=r("dx_SreQ"),le=r("dx_g0R0"),se=r("dx_FHaN"),ue=r("dx_bME5");function de(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function fe(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?de(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function he(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return pe(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pe(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function pe(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function ve(e,n){Object(ae.j)()&&ge(Y.InputPipe.serialize(e),n)}function ge(e,n){var r=e.nodes;if(Object(ae.j)()){var o,i,c=he(r);try{for(c.s();!(o=c.n()).done;){var a=o.value,l=a.mark||{};if(!(i=l)[$.B]&&!i[se.O]||" "===a.text)return;var s=Object(le.n)(new Error("client validate failed"),fe(fe({},n),{},{code:R.e.ILLEGAL_RECORD_SNAPSHOT,msg:"invalid text for inlineblock/inline-component, expected ' ', actual '".concat(a.text,"'"),nodes:r}));Object(ue.f)(s,!0)}}catch(u){c.e(u)}finally{c.f()}}}var be,ye,me,_e,ke,Oe,xe,Ee=r("dx_XiKs");r("dx_M32A");function Se(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Ce(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ce(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Ce(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function Ie(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Be(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Ie(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ie(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Te(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=I()(e);if(n){var i=I()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return S()(this,r)}}var we=(be=Object(M.S)(),xe=function(e){x()(r,e);var n=Te(r);function r(e){var o;return v()(this,r),o=n.call(this,e),h()(o,"blockManager",me,m()(o)),h()(o,"translation",_e,m()(o)),h()(o,"editor",ke,m()(o)),h()(o,"contentState",Oe,m()(o)),o.matches=null,o.findKeyword=void 0,o.isTextBlock=!0,o.enableTranslate=!0,o.translateStatus=!1,o.isCreatedByPaste=!1,o.zoneId=String(o.id),o._zoneState=void 0,o.initialVersion=-1,o.inlineBlocks=void 0,o.handleRecordChange=function(){var e=d()(s.a.mark((function e(n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.matches=null,!o.translateStatus){e.next=7;break}return r=n.options.from===R.H.local,e.next=5,J.S.translateBlock(o.recordId,r);case 5:return o.updateOriginContentStateByTranslation(),e.abrupt("return");case 7:o.updateOriginContentState(n),o.updateInlineBlocks();case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),o}return b()(r,[{key:"getInlineBlocks",value:function(){return this.inlineBlocks||this.updateInlineBlocks(),this.inlineBlocks||[]}},{key:"onInit",value:function(e){var n,o;this.translateStatus=J.S.translated,this.isCreatedByPaste=Boolean(e.options.isInPaste);var i=Object(ie.w)(this.snapshot.text).get(Z.x);this.contentState.addZone(this.zoneId,i),this.initialVersion=(null===(n=this.blockManager.editorAPI.getService(V.q,{optional:!0}))||void 0===n?void 0:n.getVersion(this.recordId))||-1,this.updateInlineBlocks(),this.record.on(R.Ra.CHANGE,this.handleRecordChange),this.initTranslation(),null===(o=this.translation)||void 0===o||o.add(this),k()(I()(r.prototype),"onInit",this).call(this,e)}},{key:"onDestroy",value:function(e){var n,o=this;this.record.off(R.Ra.CHANGE,this.handleRecordChange),null===(n=this.translation)||void 0===n||n.remove(this),this.getInlineBlocks().forEach((function(e){e.isDestroyed||o.modelService.destroyUncontrolledBlockModel(e)})),this._zoneState=this.zoneState,this.contentState.removeZone(this.zoneId),k()(I()(r.prototype),"onDestroy",this).call(this,e)}},{key:"onTranslateOpen",value:function(){this.enableTranslate&&(this.translateStatus=!0,this.updateOriginContentStateByTranslation())}},{key:"onTranslateClose",value:function(){this.translateStatus=!1,this.updateOriginContentStateByTranslation()}},{key:"onTranslateLanguageChange",value:function(){this.updateOriginContentStateByTranslation(),this.isRoot&&this.forceUpdate()}},{key:"updateOriginContentStateByTranslation",value:function(){if(this.enableTranslate)if(this.translateStatus){var e=J.S.getBlockTranslateData(this.recordId);if(!e)return;var n=Object(ie.T)(e,this.zoneState).get(Z.x);this.updateContent(n,{extra:{shouldCollab:!1}}),this.updateInlineBlocks()}else{var r=this.getUpdateContext(),o=r.shouldUpdate,i=r.applyFunction,c=r.applyData;o&&i(c,{extra:{shouldCollab:!1}})}}},{key:"getText",value:function(){return this.zoneState.getModelText()}},{key:"toModel",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=n?{}:{children:[]};return JSON.parse(JSON.stringify(Be(Be(Be({},this.snapshot),e),r)))}},{key:"onPasteRecordAfterApply",value:function(){var e=this.record,n=e.id,r=e.snapshot;K.S.emit(Ee.F,r,n,this.blockManager)}},{key:"onPasteRecordAfterAccepted",value:function(){var e=this.record,n=e.id,r=e.snapshot;K.S.emit(Ee.Q,r,n,this.blockManager)}},{key:"find",value:function(e){var n=this;if(!this.matches||this.findKeyword!==e){var r=[],o="",c=0;this.zoneState.getContent().forEach((function(a){if(Object(j.X)(a)&&Object(te.c)(a)){r.push.apply(r,i()(n.generateTextBlockMatches(o,e,c))),c+=o.length,o="";var l=Object(ne.G)(a,n.blockManager.recordManager);return r.push.apply(r,i()(n.generateTextBlockEmbedMatches(l,e,c))),void c++}o+=a.insert})),o&&r.push.apply(r,i()(this.generateTextBlockMatches(o,e,c))),this.matches=r,this.findKeyword=e}var a=this.findChildrenKeyword(e);return[].concat(i()(this.matches),i()(a))}},{key:"findChildrenKeyword",value:function(e){var n=this,r=this.snapshot.children;return r?r.reduce((function(r,o){var c=n.blockManager.getBlockModelsByRecordId(o)[0];return c?(r.push.apply(r,i()(c.find(e))),r):r}),[]):[]}},{key:"replaceAll",value:function(e,n){var r=this,o=n.map((function(n){var o=n.range;o[1]-o[0]<=0&&console.error("[Replace] illegal range: ".concat(o));var i=Object(ce.JI)(r.zoneState,[o[0],o[0]+1]),c=r.getAttributes(i.start,i.end).toMap();return{range:o,toBeReplaced:{text:e,mark:c}}})),i=this.zoneState.multiReplace(o).toAttributeText();return this.applyTransaction("replaceAll",(function(e){e.replace(r.recordId,["text"],i)}))}},{key:"generateTextBlockMatches",value:function(e,n,r){var o={blockManager:this.blockManager,blockId:this.id,key:n};return Object(X.A)(e,n).map((function(e){return new q.P(Be(Be({},o),{},{range:[e.start+r,e.end+r]}))}))}},{key:"generateTextBlockEmbedMatches",value:function(e,n,r){var o={blockManager:this.blockManager,blockId:this.id,key:n};return Object(X.A)(e,n).map((function(e){return new q.D(Be(Be({},o),{},{range:[r,r+1],offset:[e.start,e.end]}))}))}},{key:"toggleMark",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3?arguments[3]:void 0;if(r){var i=Object.keys(e).reduce((function(e,n){return e[n]="",e}),{});this.setAttributes(n,i,o)}else this.setAttributes(n,e,o)}},{key:"replaceText",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.zoneState.replace(n,(null===r||void 0===r?void 0:r.text)||"",(null===r||void 0===r?void 0:r.mark)||{}),i=o.toAttributeText(),e.next=4,this.replaceRecordText(i,!0);case 4:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"replaceInputData",value:function(){var e=d()(s.a.mark((function e(n){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ge(n,{recordId:this.record.id}),r=Y.InputPipe.deserialize(n),this.replaceRecordText(r,!1);case 3:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"getInlineRecordIds",value:function(){return Object(oe.W)(this.snapshot)}},{key:"getAttributes",value:function(e,n){return this.zoneState.getAttributes(e,n)}},{key:"setAttributes",value:function(e,n,r){return this.contentState.setAttributes(e,n,r)}},{key:"apply",value:function(e,n){return this.contentState.apply(e,n)}},{key:"replaceEditorText",value:function(e,n,r,o){return this.contentState.replaceText(e,n,r,o)}},{key:"insertText",value:function(e,n,r,o){return this.contentState.insertText(e,n,r,o)}},{key:"getContent",value:function(){return this.contentState.getContent()}},{key:"rangeToPosition",value:function(e){return this.contentState.rangeToPosition(e)}},{key:"getSelection",value:function(){return this.editor.selection.getSelection(this.zoneId)}},{key:"setSelection",value:function(e,n){var r;r=Be(Be({},e),{},"len"in e?{zoneId:this.zoneId}:{start:Be(Be({},e.start),{},{zoneId:this.zoneId}),end:Be(Be({},e.end),{},{zoneId:this.zoneId})}),this.editor.selection.setSelection(r,n)}},{key:"isSelectingAll",value:function(){return this.editor.selection.isSelectingAll(this.zoneId)}},{key:"selectAll",value:function(){return this.editor.selection.selectAll(this.zoneId)}},{key:"domRangeToModelRange",value:function(e){return this.editor.selection.toModelRange(e,this.zoneId)}},{key:"getRect",value:function(){return this.editor.getRect(this.zoneId)}},{key:"onStructUpdate",value:function(e){var n=e.action;if(n.type===w.W.CHANGE_CHILD_TYPE){var r=this.getInlineBlocks().indexOf(n.oldChild);r>=0&&this.getInlineBlocks().splice(r,1,n.child),this.blockManager.eventEmitter.dispatch(Q.Y,[n],this.id)}}},{key:"replaceRecordText",value:function(){var e=d()(s.a.mark((function e(n,r){var o=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r&&ve(n,{recordId:this.record.id}),this.applyTransaction("replaceRecordText",(function(e){Object(A.w)(e,o.record,n)}));case 2:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"initTranslation",value:function(){var e=d()(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.translateStatus){e.next=5;break}return e.next=3,J.S.translateBlock(this.recordId,!0);case 3:return this.updateOriginContentStateByTranslation(),e.abrupt("return");case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateOriginContentState",value:function(e){var n,r,o,i=this;if(this.contentState&&this.snapshot.text){var c=(null===e||void 0===e?void 0:e.options)||{},a=c.isInUndoRedo,l=c.transactionName,s=Z.z.concat(P.S.lineEditable?Z.r:[]);if(a||!l||!s.includes(l)){var u=!1;(null===(n=e.ops)||void 0===n?void 0:n.length)&&e.ops.forEach((function(e){Object(A.I)(e)||Object(R.r)(e)||(u=!0)}));var d=(null===(r=this.blockManager.editorAPI.getService(V.q,{optional:!0}))||void 0===r?void 0:r.getVersion(this.recordId))||-1;this.initialVersion>=d&&"applyRemoteOperations"===l&&(Object(L.N)("doc_bug_track_dev",{action:"content_state_version",info:JSON.stringify({id:Object(N.L)(this.recordId),collab_version:d,init_version:this.initialVersion,snapshot:this.snapshot.text.initialAttributedTexts.text[0].length,content:this.getText().length})}),u=!0);var f=this.record.snapshot.text.initialAttributedTexts.text[Z.x];if(Object(A.a)(f)&&(u=!0),u){var h=this.getUpdateContext(),p=h.shouldUpdate,v=h.applyFunction,g=h.applyData;if(p){var b=this.getSelection(),y=b&&(null===e||void 0===e?void 0:e.options.from)===R.H.local;try{v(g,{extra:{shouldCollab:!1}})}catch(m){console.error("[Editor] error:",m)}b&&y&&this.setSelection(b)}}else(null===(o=e.ops)||void 0===o?void 0:o.length)&&e.ops.filter((function(e){return Object(A.I)(e)})).forEach((function(n){var r=n.subType.o,o=r.apool,c=r.zone_changesets;Object(L.N)("doc_bug_track_dev",{action:"update_content_state",info:JSON.stringify({id:Object(N.L)(i.recordId),cs:Object(A.K)(c[0]),attr:Object(A.b)(o.numToAttrib),snapshot:i.snapshot.text.initialAttributedTexts.text[0].length,content:i.getText().length,collab_version:d,init_version:i.initialVersion})});var a=Object(A.P)(n).get(Z.x),l=new D.m({zoneId:i.zoneId}).concat(a);i.apply(l,{extra:{shouldCollab:!1},type:e.options.transactionName})}))}}}},{key:"updateContent",value:function(e,n){var r,o=e.ops.length-1,i=e.ops[o];"\n"===(null===i||void 0===i?void 0:i.insert)?e.ops.pop():(null===i||void 0===i||null===(r=i.insert)||void 0===r?void 0:r.endsWith("\n"))&&(i.insert=i.insert.slice(0,-1));var c=new D.m({zoneId:this.zoneId}).delete(this.zoneState.totalWidth()-1).concat(e);try{this.apply(c,n)}catch(a){console.error("[Editor] error:",a)}}},{key:"getUpdateContext",value:function(){var e=Object(ie.T)(this.snapshot.text,this.zoneState).get(Z.x),n=this.zoneState.getContent(!0),r=e,o=this.updateContent.bind(this);return{shouldUpdate:!Object(ie.B)(e,n),applyFunction:o,applyData:r}}},{key:"updateInlineBlocks",value:function(){var e,n,r=this.zoneState.getEntities([[$.B],[ee.INLINE_COMPONENT_MARK]]);if(r.length||(null===(e=this.inlineBlocks)||void 0===e?void 0:e.length)){var o=this.getInlineRecordIdsFromEntities(r);if(o.length||(null===(n=this.inlineBlocks)||void 0===n?void 0:n.length)){var i,c=new Map,a=Se(this.inlineBlocks||[]);try{for(a.s();!(i=a.n()).done;){var l=i.value,s=c.get(l.recordId);s||(s=[],c.set(l.recordId,s)),s.push(l)}}catch(x){a.e(x)}finally{a.f()}var u,d=this.modelService,f=[],h=Se(o);try{for(h.s();!(u=h.n()).done;){for(var p=u.value,v=c.get(p),g=null;v&&v.length>0;){var b=v.pop();if(!b.isDestroyed){g=b;break}}g||((g=d.createUncontrolledBlockModel(p)).parent=this),f.push(g)}}catch(x){h.e(x)}finally{h.f()}var y,m=Se(c.values());try{for(m.s();!(y=m.n()).done;){var _,k=Se(y.value);try{for(k.s();!(_=k.n()).done;){var O=_.value;d.destroyUncontrolledBlockModel(O)}}catch(x){k.e(x)}finally{k.f()}}}catch(x){m.e(x)}finally{m.f()}this.inlineBlocks=f}}}},{key:"getInlineRecordIdsFromEntities",value:function(e){var n=this,r=[];return e.forEach((function(e){var o=e.attributes,i=o[$.B];i&&(n.modelService.hasRecordByRecordId(i)||n.modelService.registerRecords([{id:i,snapshot:Object(z.b)({},F.B.BLANK)}]),r.push(i));var c=o[ee.INLINE_COMPONENT_MARK];if(c){var a;try{a=JSON.parse(c)}catch(h){console.error("parse inline component mark fail in render, origin string is:",c,h)}if(a){if(a.type!==ee.INLINE_COMPONENT_TYPE.FILE)return;var l=a.data,s=l.source_block_id||a.id;if(!n.modelService.hasRecordByRecordId(s)){var u,d,f=Object(H.q)(l,!0);if(f.parent_id=n.recordId,n.modelService.registerRecords([{id:s,snapshot:f}]),!(null===(u=n.blockManager.recordManager.collabModule)||void 0===u?void 0:u.hasEntity(s,R.N.record)))null===(d=n.blockManager.recordManager.collabModule)||void 0===d||d.register([{id:s,resourceType:R.N.record,version:l.source_version}])}r.push(s)}}})),r}},{key:"zoneState",get:function(){var e;return null!==(e=this.contentState.getZoneState(this.zoneId))&&void 0!==e?e:this._zoneState}},{key:"schema",get:function(){return this.contentState.schema}},{key:"isSSR",get:function(){return!0===this.editorAPI.config.get("isSSR")}},{key:"isEmpty",get:function(){return this.zoneState.isEmpty()}}]),r}(U.D),ye=xe,me=T()(ye.prototype,"blockManager",[W.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e=T()(ye.prototype,"translation",[be,G.Y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ke=T()(ye.prototype,"editor",[re.O],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe=T()(ye.prototype,"contentState",[re.n],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ye),Re=r("dx_FT4e")},dx_KHyL:function(e,n,r){},dx_KI1b:function(e,n,r){"use strict";r.d(n,"p",(function(){return M}));var o,i,c,a,l=r("dx_lSNA"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_W7W2"),v=r.n(p),g=r("dx_a1gu"),b=r.n(g),y=r("dx_Nsbk"),m=r.n(y),_=r("dx_Uyc2"),k=r.n(_),O=r("dx_vtL4"),x=r("dx_R4RO"),E=r("dx_N8Nu"),S=r("dx_e4eN"),C=r("dx_cDcd"),I=r.n(C),B=r("dx_TSY5");r("dx_AHmk");function T(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return w(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return w(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function w(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function R(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var M=(o=Object(O.R)(99999),a=c=function(e){v()(r,e);var n=R(r);function r(e){var o,i=e.editor;return d()(this,r),(o=n.call(this)).name="auto-space",o.editor=void 0,o.editor=i,o}return h()(r,[{key:"_editorLineStateWillRender",value:function(e){var n,o=e.lineState,i=new S.m({zoneId:o.getZoneId()}),c=o.getModelText(),a=0,l=T(Object(B.d)(c));try{for(l.s();!(n=l.n()).done;){var u=n.value;i.retain(u-a),i.retain(1,s()({},r.KEY,Math.random().toString())),a=u+1}}catch(d){l.e(d)}finally{l.f()}return i.ops.length&&(e.lineState=o.compose(i)),o}},{key:"match",value:function(e){return e===r.KEY}},{key:"render",value:function(e){var n=e.children;return I.a.createElement(x.S,{className:"".concat(r.KEY)},n)}}]),r}(E.o),c.KEY="auto-space",i=a,k()(i.prototype,"render",[o],Object.getOwnPropertyDescriptor(i.prototype,"render"),i.prototype),i)},dx_KMlW:function(e,n,r){"use strict";(function(t){var e,o,i,c,a=r("dx_o0o1"),l=r.n(a),s=r("dx_yXPU"),u=r.n(s),d=r("dx_yG8O"),f=r.n(d),h=r("dx_lwsE"),p=r.n(h),v=r("dx_PJYZ"),g=r.n(v),b=r("dx_W8MJ"),y=r.n(b),m=r("dx_W7W2"),_=r.n(m),k=r("dx_a1gu"),O=r.n(k),x=r("dx_Nsbk"),E=r.n(x),S=r("dx_Uyc2"),C=r.n(S),I=(r("dx_A1AB"),r("dx_B28d")),B=r("dx_NMQJ"),T=r("dx_x1WV"),w=r("dx_Ykhn");function R(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=E()(e);if(n){var i=E()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return O()(this,r)}}var M=(c=i=function(e){_()(i,e);var n=R(i);function i(e){var r;return p()(this,i),r=n.call(this,e),f()(r,"blockManager",o,g()(r)),r.firstTimeSyncJira=!1,r.syncWhenInit=u()(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.snapshot.isDelete&&!r.firstTimeSyncJira&&r.editable){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,r.getUpdater();case 4:e.sent.syncWhenInit(),r.firstTimeSyncJira=!0;case 7:case"end":return e.stop()}}),e)}))),r}return y()(i,[{key:"editable",get:function(){return this.editorAPI.config.editable}}]),y()(i,[{key:"getText",value:function(){return"[".concat(t("doc.jira.jira_issue"),"]")}},{key:"sync",value:function(e){this.editable&&this.doSync(e),this.firstTimeSyncJira=!0}},{key:"doSync",value:function(){var e=u()(l.a.mark((function e(n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getUpdater();case 2:if(r=e.sent,(n.priority||w.A.high)!==w.A.high){e.next=8;break}return e.abrupt("return",r.doSync(n));case 8:return e.abrupt("return",r.idleSync(n));case 9:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"getUpdater",value:function(){var e=u()(l.a.mark((function e(){var n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e("dx_j7jj").then(r.bind(null,"dx_W3y7"));case 2:return n=e.sent,o=n.JiraIssueModelUpdater,e.abrupt("return",new o(this.blockManager,this.snapshot,this.recordId));case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),i}(B.D),i.type=I.B.JIRA_ISSUE,e=c,o=C()(e.prototype,"blockManager",[T.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e);n.S=M}).call(this,r("dx_E9Eu"))},dx_KTtu:function(e,n,r){"use strict";var o,i,c;r.d(n,"V",(function(){return o})),r.d(n,"k",(function(){return i})),r.d(n,"S",(function(){return c})),function(e){e.Block="block",e.BookMarkBlock="bookmarkBlock",e.PollBlock="pollBlock",e.TextBlock="textBlock",e.TextEmbedBlock="textEmbedBlock",e.Comment="comment",e.GlobalComment="globalComment",e.SheetBlock="sheetBlock",e.BitableBlock="bitableBlock",e.WikiCatalogBlock="wikiCatalogBlock",e.WikiRecentBlock="wikiRecentBlock"}(o||(o={})),function(e){e.Block="block",e.Comment="comment"}(i||(i={})),function(e){e.NEXT="find_next",e.PREV="find_prev",e.ESC="find_exit"}(c||(c={}))},dx_KUGi:function(e,n,r){"use strict";(function(t){r.d(n,"j",(function(){return f}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_UtDZ"),c=r("dx_cDcd"),a=r.n(c),l=r("dx_faye"),s=r.n(l);function u(e){var n=function(){var e=Object(c.useState)({x:0,y:0}),n=o()(e,2),r=n[0],i=n[1];return Object(c.useEffect)((function(){function e(e){var n=e.clientX,r=e.clientY;i({x:n,y:r})}return document.addEventListener("mousemove",e),function(){document.removeEventListener("mousemove",e)}}),[i]),r}();Object(c.useEffect)((function(){var n=setTimeout((function(){e.onClose()}),3e3);return function(){clearTimeout(n),e.onClose()}}),[]);var r=(n.x||e.x)+200>window.innerWidth?window.innerWidth-200-10:n.x||e.x,i={left:"".concat(r,"px"),top:"".concat((n.y||e.y)+10,"px")};return a.a.createElement("div",{className:"vc-hover-onboarding",style:i},t("CreationDoc_Docx_MagicShare_WillSyncToOthers"))}var d=document.createElement("div");function f(e,n){s.a.unmountComponentAtNode(d),s.a.render(a.a.createElement(u,{x:e,y:n,onClose:function(){s.a.unmountComponentAtNode(d),null===i.closeUserGuide||void 0===i.closeUserGuide||Object(i.closeUserGuide)(i.STEP_TYPES.docx_vc_hover_follow)}}),d)}document.body.appendChild(d)}).call(this,r("dx_E9Eu"))},dx_KXll:function(e,n,r){"use strict";r.d(n,"h",(function(){return d})),r.d(n,"s",(function(){return f})),r.d(n,"H",(function(){return p})),r.d(n,"u",(function(){return v})),r.d(n,"z",(function(){return g})),r.d(n,"Y",(function(){return b})),r.d(n,"J",(function(){return y}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_EDG4"),a=r("dx_UtDZ"),l=r("dx_yzqx"),s=r("dx_USRY"),u=(r("dx_B28d"),r("dx_c7yg"));function d(e){for(var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=1024,o=[" B","KB","MB","GB","TB","P","E","Z","Y"],i=0;e>=r&&i<o.length-1;)e/=r,++i;return i>0&&n?e.toFixed(2)+o[i]:Math.floor(e)+o[i]}function f(e){var n=e.lastIndexOf(".");return n<0?"":e.substr(n+1).toLowerCase()}function h(e){return function(e){return c.DIRECT_PREVIEW_TYPES.includes(e.toLowerCase())}(e)||function(e){return[].concat(i()(a.FileHelpers.PDFPreviewTypes),i()(c.INDIRECT_PREVIEW_TYPES)).includes(e.toLowerCase())}(e)}function p(e){return e===u.v}function v(e,n){return function(e,n){return n<10485760&&h(e)&&!a.FileHelpers.isImageTypePreview(e)&&!a.FileHelpers.isArchiveTypePreview(e)}(f(e),n)?s.t.Preview:u.n}function g(e){return e.type===u.O}function b(e,n,r,o){var i=e.file,c={token:i.token,mime_type:i.mimeType,size:i.size,name:i.name,need_copy_resource:r,source_block_id:"",source_version:u.j};if(o){var a;c.source_block_id=o;var l=null===(a=n.recordManager.collabModule)||void 0===a?void 0:a.getVersion(o);void 0!==l&&(c.source_version=l)}return c}function y(){var e,n,r;return l.S.isMobile&&!!(null===(e=window)||void 0===e||null===(n=e.LarkNativeComponentConfig)||void 0===n||null===(r=n.supportNativeComponent)||void 0===r?void 0:r.call(n))}},dx_KdQW:function(e,n,r){"use strict";r.d(n,"Z",(function(){return Dh}));var o,i,c,a,l=r("dx_RIqP"),s=r.n(l),u=r("dx_Vvd7"),d=r("dx_VAwJ"),f=r("dx_W3kT"),h=r("dx_yzqx"),p=r("dx_UHze"),v=r("dx_zjmc"),g=r("dx_R53K"),b=r("dx_W6W8"),y=r("dx_zKF3"),m=r("dx_oECv"),_=r("dx_o54o"),k=r("dx_B28d"),O=r("dx_bD2y"),x=r("dx_FBn3"),E=r("dx_W0Ov"),S=r("dx_vlKv"),C=r("dx_ApwS"),I=r("dx_DSuC"),B=r("dx_D3ws"),T=r("dx_pVRx"),w=r("dx_MYIx"),R=r("dx_LSbp"),M=r("dx_SbhA"),j=r("dx_x1xr"),D=r("dx_yl1C"),A=r("dx_sDWs"),P=r("dx_yG8O"),L=r.n(P),N=r("dx_lwsE"),F=r.n(N),U=r("dx_W8MJ"),H=r.n(U),V=r("dx_PJYZ"),W=r.n(V),z=r("dx_W7W2"),G=r.n(z),K=r("dx_a1gu"),q=r.n(K),X=r("dx_Nsbk"),Y=r.n(X),J=r("dx_Uyc2"),Z=r.n(J),Q=(r("dx_A1AB"),r("dx_jtB3")),$=r("dx_N9dL"),ee=r("dx_fEKD"),te=r("dx_T4T0"),ne=r("dx_Z22N"),re=r("dx_iWIM"),oe=r.n(re),ie=r("dx_NMQJ"),ce=r("dx_xjz2"),ae=Object(ce.S3)("pending-client-var");function le(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var se,ue=(a=c=function(e){G()(r,e);var n=le(r);function r(e){var o;return F()(this,r),o=n.call(this,e),L()(o,"pendingClientVarService",i,W()(o)),o}return H()(r,[{key:"onInit",value:function(e){this.pendingClientVarService.add(this),oe()(Y()(r.prototype),"onInit",this).call(this,e)}},{key:"onDestroy",value:function(e){this.pendingClientVarService.remove(this),oe()(Y()(r.prototype),"onDestroy",this).call(this,e)}}]),r}(ie.D),c.type=k.B.PENDING,o=a,i=Z()(o.prototype,"pendingClientVarService",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o),de=r("dx_uv4w"),fe=r("dx_hSCS"),he=r("dx_EqZO"),pe=r("dx_T3tg"),ve=r("dx_Za4A");function ge(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return be(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return be(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function be(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var ye=Object(ce.s)(ae)(se=function(){function e(n,r,o,i){var c=this;F()(this,e),this.lazyRecord=n,this.clientVar=r,this.status=o,this.emitter=i,this.blocks=new Set,this.handleClientVarsFetchAllDone=function(){var e=c.blocks;if(e.size){c.blocks=new Set;var n,r=ge(e);try{for(r.s();!(n=r.n()).done;){var o=n.value.record;c.handleRecordFetchDone(o)}}catch(i){r.e(i)}finally{r.f()}}},i.once(he.R.CLIENTVAR_APPLY_ALL_DONE,this.handleClientVarsFetchAllDone)}return e=Object(fe.h)(e,void 0,3)||e,e=Object(pe.r)(e,void 0,2)||e,e=Object(de.v)(e,void 0,1)||e,e=Object(pe.M)(e,void 0,0)||e,H()(e,[{key:"destroy",value:function(){this.emitter.off(he.R.CLIENTVAR_APPLY_ALL_DONE,this.handleClientVarsFetchAllDone)}},{key:"add",value:function(e){this.status.isAllDone||this.blocks.add(e)}},{key:"remove",value:function(e){this.blocks.delete(e)}},{key:"handleRecordFetchDone",value:function(e){var n=this.clientVar,r=this.lazyRecord;try{var o=r.getTaskStatus(e.snapshot.baseRecordId);if(!o)return;var i=e.snapshot.type!==k.B.PENDING,c=o.isFetchedErr()&&e.snapshot.allowFail;if(i||c)return;Object(ve.K)(he.s,{block_map_incomplete:1}),n.fetchRecordBatch(e.id)}catch(a){console.error("[model] handle pending client var fetch error",a)}}}]),e}())||se,me=r("dx_cDcd"),_e=r.n(me);r("dx_pI28");function ke(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Oe,xe,Ee,Se,Ce=function(e){G()(r,e);var n=ke(r);function r(){return F()(this,r),n.apply(this,arguments)}return H()(r,[{key:"render",value:function(){return _e.a.createElement("div",null)}}]),r}(r("dx_MGoZ").l);function Ie(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Be,Te,we,Re,Me,je,De,Ae,Pe,Le=Object(u.H)({providers:[ye,{provide:ne.I,useClass:te.V,args:[k.B.PENDING,{calculateModel:Q.j.PENDING}]},{provide:$.RecordSnapshotCreator,useValue:{type:k.B.PENDING,create:ee.b}}]})((Se=function(e){G()(r,e);var n=Ie(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),L()(e,"pendingClientVar",Ee,W()(e)),e.blocks=[[ue,{viewCreator:Ce}]],e}return H()(r,[{key:"destroy",value:function(){this.pendingClientVar.destroy()}}]),r}(u.y),xe=Se,Ee=Z()(xe.prototype,"pendingClientVar",[ae],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe=xe))||Oe,Ne=r("dx_NMyZ"),Fe=r("dx_l8lr"),Ue=r("dx_wGyE"),He=r("dx_haL5"),Ve=r("dx_oxJ8"),We=r("dx_FVZU"),ze=r("dx_a7X6"),Ge=r("dx_ViSK"),Ke=r("dx_pk3x"),qe=r("dx_ooSz"),Xe=r("dx_VWMO"),Ye=r("dx_E3Ia"),Je=r("dx_dajS"),Ze=Object(ce.S3)("bidirectionLink"),Qe=r("dx_J4zp"),$e=r.n(Qe),et=r("dx_UtDZ"),tt=r("dx_h6a8"),nt=r("dx_l6la"),rt=r("dx_s1qv"),ot=r("dx_HTwv"),it=r("dx_x1WV"),ct=r("dx_gDjg"),at=function(){function e(n,r,o){F()(this,e),this.token=void 0,this.type=void 0,this.title=void 0,this.link=void 0,this.recordRef=void 0,this.embedPermissionCode=void 0,this.blockManager=void 0;var i=n.token,c=n.file_type,a=n.title,l=n.raw_url;this.token=i,this.type=c,this.link=l,this.title=Object(ct.A)(i,c,a),this.recordRef=r,this.blockManager=o}return H()(e,null,[{key:"compare",value:function(e,n){for(var r=e.positionPath,o=n.positionPath,i=Math.min(r.length,o.length),c=0;c<i;c++)if(r[c]!==o[c])return r[c]-o[c];return r.length-o.length<0?-1:1}}]),H()(e,[{key:"positionPath",get:function(){for(var e=this.blockManager.getBlockModelsByRecordId(this.recordRef)[0],n=[e],r=e.parent;r&&!r.isRoot;)n.unshift(r),r=r.parent;return n.map((function(e){return e.position}))}}]),e}(),lt=Object(ce.s)(Ze)((Te=function(){function e(){var n=this;F()(this,e),L()(this,"eventEmitter",we,this),L()(this,"blockManager",Re,this),L()(this,"model",Me,this),this.subscriptions=void 0,this.blockIdToMentionDocList=new Map,this.isReady=!1,this.getListFromSnapshot=function(e,r){var o=[],i=Object(tt.get)(e,"text.apool.numToAttrib");return Object.values(i).forEach((function(e){var i=$e()(e,2),c=i[0],a=i[1];if(c===rt.INLINE_COMPONENT_MARK&&-1!==a.indexOf(rt.INLINE_COMPONENT_TYPE.DOC)){var l=Object(ot.y)(a);(null===l||void 0===l?void 0:l.data)&&o.push(new at(l.data,r,n.blockManager))}})),o},this.handleBlockModelCreate=function(e){var r=e.model,o=r.isTextBlock,i=r.id,c=r.recordId,a=r.snapshot;if(o){var l=n.getListFromSnapshot(a,c);l.length&&(n.blockIdToMentionDocList.set(i,l),n.sendRefLinkList())}},this.handleBlockModelUpdate=function(e){var r=e.model,o=r.recordId,i=r.snapshot,c=r.id;if(r.isTextBlock){var a=n.getListFromSnapshot(i,o);if(a.length)return n.blockIdToMentionDocList.set(c,a),void n.sendRefLinkList();n.blockIdToMentionDocList.has(c)&&(n.blockIdToMentionDocList.delete(c),n.sendRefLinkList())}},this.handleBlockModelDestroy=function(e){var r=e.model,o=r,i=o.id;o.isTextBlock&&n.blockIdToMentionDocList.has(i)&&(n.blockIdToMentionDocList.delete(r.id),n.sendRefLinkList())},this.sendRefLinkList=Object(tt.debounce)((function(){n.isReady&&et.store.dispatch(Object(nt.vu)(n.mentionDocList))}),300),this.handleAllDone=function(){n.isReady=!0,n.sendRefLinkList()}}return H()(e,[{key:"init",value:function(){this.eventEmitter.on(he.R.CLIENTVAR_APPLY_ALL_DONE,this.handleAllDone),this.subscriptions=[this.model.blockModelCreate$.subscribe(this.handleBlockModelCreate),this.model.blockModelUpdate$.subscribe(this.handleBlockModelUpdate),this.model.blockModelDestroy$.subscribe(this.handleBlockModelDestroy)]}},{key:"destroy",value:function(){this.eventEmitter.off(he.R.CLIENTVAR_APPLY_ALL_DONE,this.handleAllDone),this.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"mentionDocList",get:function(){var e=[],n={};return this.blockIdToMentionDocList.forEach((function(n){return e.push.apply(e,s()(n))})),e.sort(at.compare).filter((function(e){return!n[e.token]&&(n[e.token]=!0)}))}}]),e}(),we=Z()(Te.prototype,"eventEmitter",[fe.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Re=Z()(Te.prototype,"blockManager",[it.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Me=Z()(Te.prototype,"model",[u.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Be=Te))||Be;function st(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var ut,dt,ft,ht,pt,vt=Object(u.H)({providers:[lt]})((Pe=function(e){G()(r,e);var n=st(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),L()(e,"bidirectionLink",Ae,W()(e)),e}return H()(r,[{key:"init",value:function(){this.bidirectionLink.init()}},{key:"destroy",value:function(){this.bidirectionLink.destroy()}}]),r}(u.G),De=Pe,Ae=Z()(De.prototype,"bidirectionLink",[Ze],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),je=De))||je,gt=r("dx_AOVQ"),bt=r("dx_tokD"),yt=Object(ce.S3)("collab-controller"),mt=r("dx_lSNA"),_t=r.n(mt),kt=r("dx_QxNg"),Ot=r("dx_acOG"),xt=r("dx_j6ji");function Et(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function St(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Et(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Et(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Ct(e){return null!==e}var It,Bt,Tt,wt,Rt,Mt=Object(ce.s)(yt)((dt=function(){function e(){var n=this;F()(this,e),L()(this,"modelService",ft,this),this.subs=void 0,L()(this,"editController",ht,this),this.cacheOperations=new Map,L()(this,"eventEmitter",pt,this),this.isAllDone=!1,this.handleRemoteChange=function(e){var r=e.recordOps;if(!n.isAllDone){var o=r.map((function(e){return e.ops.map((function(n){return Object(kt.ZH)(n)&&"children"===n.p[0]?{record:new kt.R(e.id,St(St({},e.record.snapshot),{},{type:(e.record.snapshot.type||"").toString()})),action:{type:"DELETE_CHILD",index:n.p[1]}}:Object(kt.X)(n)&&"children"===n.p[0]?{record:new kt.R(e.id,St(St({},e.record.snapshot),{},{type:(e.record.snapshot.type||"").toString()})),action:{type:"INSERT_CHILD",index:n.p[1],id:n.action.li,newBlockRecord:e.record}}:Object(kt.y)(n)||Object(kt.P)(n)||Object(kt.bG)(n)?{record:new kt.R(e.id,St(St({},e.record.snapshot),{},{type:(e.record.snapshot.type||"").toString()})),action:{type:"UPDATE_ATTRIBUTE",changedKey:n.p[0]||"",newValue:"oi"in n.action?n.action.oi:void 0}}:null})).filter(Ct)})).filter((function(e){return e.length})),i={};return o.every((function(e){return n.cacheOperations.has(e[0].record.id)?(i.intercept_reason=xt.b.HasCacheOp,i.interceptedRecord=e[0].record,!1):e.every((function(e){var r=e.record,o=e.action;return i.intercept_reason=xt.b.EditControl,i.edit_type=o.type,i.interceptedRecord=r,n.editController.canBlockEdit(r,r.snapshot.type,o)}))}))?void 0:(r.forEach((function(e){var r=n.cacheOperations.get(e.id)||[];r.push(e),n.cacheOperations.set(e.id,r)})),r.length=0,void Object(xt.M)(i))}},this.consumeCacheOperation=function(){n.isAllDone=!0,n.cacheOperations.forEach((function(e){n.modelService.applyTransaction("reApplyRemoteOperations",(function(n){e.forEach((function(e){n.apply(e.id,e.ops)}))}),{from:kt.H.remote})}))}}return H()(e,[{key:"bindEvents",value:function(){this.subs=this.modelService.interceptRemoteChange$.subscribe(this.handleRemoteChange),this.eventEmitter.on(he.R.CLIENTVAR_APPLY_ALL_DONE,this.consumeCacheOperation)}},{key:"unBindEvents",value:function(){this.eventEmitter.off(he.R.CLIENTVAR_APPLY_ALL_DONE,this.consumeCacheOperation),this.subs.unsubscribe()}}]),e}(),ft=Z()(dt.prototype,"modelService",[u.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ht=Z()(dt.prototype,"editController",[Ot.N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pt=Z()(dt.prototype,"eventEmitter",[fe.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ut=dt))||ut,jt=r("dx_shqt");function Dt(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var At,Pt=Object(u.H)({providers:[jt.a,Mt]})((Rt=function(e){G()(r,e);var n=Dt(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),L()(e,"editController",Tt,W()(e)),L()(e,"collabController",wt,W()(e)),e}return H()(r,[{key:"init",value:function(){this.editController.init(),this.collabController.bindEvents()}},{key:"destroy",value:function(){this.editController.destroy(),this.collabController.unBindEvents()}}]),r}(u.G),Bt=Rt,Tt=Z()(Bt.prototype,"editController",[Ot.N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wt=Z()(Bt.prototype,"collabController",[yt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),It=Bt))||It,Lt=r("dx_ij4R"),Nt=r("dx_XBgx"),Ft=r("dx_lmGg"),Ut=r("dx_OEIU"),Ht=Object(ce.s)(Ut.r)(At=function(){function e(n){var r=this;F()(this,e),this.eventEmitter=n,this.isFirstScreen=!1,this.isAllDone=!1,this.isAllowEdit=!1,this.shouldShowLoading=!0,this.skipBlockApplied=new Set,this.onSkipBlockApplied=function(e){var n=e.taskId;r.skipBlockApplied.add(n)},this.onAllDone=function(){r.isAllDone=!0,setTimeout((function(){r.shouldShowLoading=!1}),100)},this.onAllowEdit=function(){r.isAllowEdit=!0},this.handleFirstScreenSuccess=function(){r.isFirstScreen=!0},this.bindEvents()}return e=Object(ce.d)(fe.h)(e,void 0,0)||e,H()(e,[{key:"bindEvents",value:function(){this.eventEmitter.on(Ft.R.CLIENTVAR_APPLY_ALL_DONE,this.onAllDone),this.eventEmitter.on(Ft.R.CLIENTVAR_FETCH_ALLOW_EDIT,this.onAllowEdit),this.eventEmitter.on(Ft.R.CLIENTVAR_SKIP_BLOCK_APPLIED,this.onSkipBlockApplied),this.eventEmitter.once(Ft.R.CLIENTVAR_SUB_TASK_FINISH,this.handleFirstScreenSuccess)}},{key:"isSkipBlockDataApplied",value:function(e){return this.skipBlockApplied.has(e)}},{key:"destroy",value:function(){this.shouldShowLoading=!0,this.isAllDone=!1,this.isAllowEdit=!1,this.isFirstScreen=!1,this.skipBlockApplied.clear(),this.eventEmitter.off(Ft.R.CLIENTVAR_APPLY_ALL_DONE,this.onAllDone),this.eventEmitter.off(Ft.R.CLIENTVAR_FETCH_ALLOW_EDIT,this.onAllowEdit),this.eventEmitter.off(Ft.R.CLIENTVAR_SKIP_BLOCK_APPLIED,this.onSkipBlockApplied),this.eventEmitter.off(Ft.R.CLIENTVAR_SUB_TASK_FINISH,this.handleFirstScreenSuccess)}}]),e}())||At,Vt=r("dx_o0o1"),Wt=r.n(Vt),zt=r("dx_yXPU"),Gt=r.n(zt),Kt=r("dx_m3ds"),qt=r("dx_xlCA"),Xt=r("dx_Uh2b");var Yt=r("dx_xWbU"),Jt=r("dx_qx8A"),Zt=r.n(Jt);var Qt=function(e){var n=function(e,n,r){var o,i,c=(null===(o=e.block_map[e.id])||void 0===o||null===(i=o.data)||void 0===i?void 0:i.width_mode)||Yt.M.StandardWidth;return n&&(c=Yt.M.FullWidth),r&&(c=Yt.M.StandardWidth),c}(e,h.S.isFeed,h.S.isMobile);Zt.a.dispatch(function(e){return{type:Xt.R.SwitchWidthMode,payload:{widthMode:e}}}(n))},$t=r("dx_ABiD"),en=r("dx_GPzN"),tn=r("dx_jBAU"),nn=r("dx_luPr"),rn=r("dx_M7MP"),on=r("dx_lSlT"),cn=r("dx_TYsD"),an=r("dx_lXxx"),ln=r("dx_D8nn"),sn=r("dx_aINA"),un=r("dx_Kkjd"),dn=r("dx_P9db"),fn=r("dx_EhSK"),hn=r("dx_GRYU"),pn=r("dx_LA8U"),vn=r("dx_uxuX"),gn=r("dx_rQGm"),bn=r("dx_v7vG"),yn=r("dx_bME5");function mn(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function _n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?mn(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mn(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var kn,On,xn=function(){function e(n,r){var o=this;F()(this,e),this.modelService=n,this.eventEmitter=r,this.token=Object(et.getToken)(),this.fetchCount={all:0,body:0,table:0,fold:0},this.applySliceTimes=0,this.handleFetchWillStart=function(e){var n=e.isFoldable;e.isTable?o.fetchCount.table++:n&&o.fetchCount.fold++},this.handleMainContentFetched=function(e){Object(ve.K)(Ft.j.MAIN_CONTENT_FETCH_DONE,{fetchBodyCount:o.fetchCount.body,taskId:Object(et.encryptTea)(e)})},this.handleSliceResponse=function(e){var n=e.taskId,r=e.clientvar;n===Object(et.getToken)()&&o.fetchCount.body++,o.fetchCount.all++,Object(ve.K)(Ft.j.HANDLE_RESPONSE,{taskId:Object(et.encryptTea)(n),hasMore:r.has_more})},this.handleClientvarSliceFatal=function(e){Object(ve.K)(Ft.R.CLIENTVAR_SLICE_FATAL,{taskId:Object(et.encryptTea)(e.taskId)}),kt.Z0.includes(e.code)?en.S.renderFail($t.g.FETCH_CLIENTVAR_ERROR_PERM,e):Object(et.isOnline)()&&Object(yn.n)({event:e,type:hn.T})},this.handleFirstScreenSuccuess=function(e){Object(rn.p)((function(){console.timeEnd("firstScreen"),ln.S.emit($t.C.RENDER_DOCX_FIRST_SCREEN_SUCCESS,e),en.S.updateStage($t.ET.RENDER_DOCX_FIRST_CLIENTVAR_SUCCESS),window.__SSR_NEED_LOG__?(en.S.updateStage($t.ET.RENDER_DOCX_FIRST_SCREEN_SUCCESS,window.docSSRDomReadyTime),en.S.updateLoadMainStageDurationList(et.FILE_TYPE.DOCX,et.LOAD_MAIN_STAGE_DURATION_LIST_KEY.RENDER_FILE_ETHERPAD_SUCCESS,window.docSSRDomReadyTime),en.S.updateLoadMainStageDurationList(et.FILE_TYPE.DOCX,et.LOAD_MAIN_STAGE_DURATION_LIST_KEY.RENDER_FILE_ALL_TIME_TO_VISIT,window.docSSRDomReadyTime),window.__SSR_NEED_LOG__=!1):(o.modelService,en.S.updateStage($t.ET.RENDER_DOCX_FIRST_SCREEN_SUCCESS),en.S.updateLoadMainStageDurationListByNextRender(et.FILE_TYPE.DOCX,et.LOAD_MAIN_STAGE_DURATION_LIST_KEY.RENDER_FILE_ETHERPAD_SUCCESS),en.S.updateLoadMainStageDurationListByNextRender(et.FILE_TYPE.DOCX,et.LOAD_MAIN_STAGE_DURATION_LIST_KEY.RENDER_FILE_ALL_TIME_TO_VISIT))}))},this.handleClientVarRenderTaskFinish=function(e){var n=e.taskId;Object(ve.K)(Ft.R.CLIENTVAR_RENDER_TASK_FINISH,{taskId:Object(et.encryptTea)(n)})},this.handleClientVarsAllowEdit=function(){vn.eventEmitter.emit("".concat(vn.FOLLOW_EVENT,":NETWORK_EVENT"),{type:gn.Wu.Smooth}),Object(rn.p)((function(){console.timeEnd("pure_docx_editable"),console.timeEnd("editable");var e=Date.now();en.S.updateStage($t.ET.RENDER_DOCX_ALLOW_EDIT,e),bn.S.collectRenderEditorSuccess({current:e}),en.S.updateLoadMainStageDurationList(et.FILE_TYPE.DOCX,et.LOAD_MAIN_STAGE_DURATION_LIST_KEY.RENDER_FILE_ALLOW_EDIT,Date.now()),Object(ve.K)(Ft.R.CLIENTVAR_FETCH_ALLOW_EDIT)}))},this.afterEachTaskSliceClientvarApply=function(){o.applySliceTimes++},this.handleClientVarsApplyAllDone=function(e){en.S.updateStageByNextRender($t.ET.RENDER_DOCX_CLIENTVARS_ALL_DONE);var n=e.lazyRecord;requestAnimationFrame((function(){var e=n.view,r=Object(pn.p)(e),i=Object(pn.e)(e);Object(ve.K)(Ft.R.CLIENTVAR_APPLY_ALL_DONE,_n(_n({blockCount:r,blockTypeCount:i},o.fetchCount),{},{applySliceTimes:o.applySliceTimes}))}));var r=Object(pn.h)(n.model);if(r.length>0){var i=r.length,c=r.map((function(e){var n=e.id,r=e.parent,o=e.record;return{blockId:Object(et.encryptTea)(n),parentId:Object(et.encryptTea)(null===r||void 0===r?void 0:r.id),recordId:Object(et.encryptTea)(o.id)}}));Object(ve.K)(Ft.m.FETCH_ALL_DONE_BUT_HAS_PENDING_BLOCK,{encryptPendingBlocks:c,pendingBlocksLength:i}),console.error("fetch all done but has pendingBlock",i)}},this.eventEmitter.on(Ft.R.CLIENTVAR_RENDER_TASK_FINISH,this.handleClientVarRenderTaskFinish),this.eventEmitter.on(Ft.R.CLIENTVAR_APPLY_SLICE_CLIENTVAR_AFTER,this.afterEachTaskSliceClientvarApply),this.eventEmitter.on(Ft.R.CLIENTVAR_APPLY_ALL_DONE,this.handleClientVarsApplyAllDone),this.eventEmitter.on(Ft.R.CLIENTVAR_SLICE_FATAL,this.handleClientvarSliceFatal),this.eventEmitter.on(Ft.R.POST_CLIENTVAR_FETCH_ALLOW_EDIT,this.handleClientVarsAllowEdit),this.eventEmitter.once(Ft.R.CLIENTVAR_SUB_TASK_FINISH,this.handleFirstScreenSuccuess),this.eventEmitter.on(Ft.R.CLIENTVAR_SLICE_RESPONSE,this.handleSliceResponse),this.eventEmitter.on(Ft.R.CLIENTVAR_FETCH_MAIN_CONTENT_DONE,this.handleMainContentFetched),this.eventEmitter.on(Ft.R.CLIENTVAR_FETCH_TASK_WILL_START,this.handleFetchWillStart)}return H()(e,[{key:"destroy",value:function(){var e=this;this.eventEmitter.off(Ft.R.CLIENTVAR_SLICE_FATAL,this.handleClientvarSliceFatal),this.eventEmitter.off(Ft.R.CLIENTVAR_APPLY_SLICE_CLIENTVAR_AFTER,this.afterEachTaskSliceClientvarApply),this.eventEmitter.off(Ft.R.CLIENTVAR_APPLY_ALL_DONE,this.handleClientVarsApplyAllDone),this.eventEmitter.off(Ft.R.POST_CLIENTVAR_FETCH_ALLOW_EDIT,this.handleClientVarsAllowEdit),this.eventEmitter.off(Ft.R.CLIENTVAR_RENDER_TASK_FINISH,this.handleClientVarRenderTaskFinish),this.eventEmitter.off(Ft.R.CLIENTVAR_SLICE_RESPONSE,this.handleSliceResponse),this.eventEmitter.off(Ft.R.CLIENTVAR_FETCH_MAIN_CONTENT_DONE,this.handleMainContentFetched),this.eventEmitter.off(Ft.R.CLIENTVAR_FETCH_TASK_WILL_START,this.handleFetchWillStart),Object.keys(this.fetchCount).forEach((function(n){e.fetchCount[n]=0})),this.applySliceTimes=0}}]),e}(),En=r("dx_hEqA"),Sn=function(){function e(n){F()(this,e),this.foldableTypes=void 0,this.foldableTypes=n.foldableTypes}return H()(e,[{key:"needRequest",value:function(e,n){var r=e.data;return this.foldableTypes.has(r.type)&&!r.type.includes("heading")&&e.data.folded&&(r.children||[]).some((function(e){return!n[e]}))}},{key:"isThisType",value:function(e){var n=e.data;return this.foldableTypes.has(n.type)}}]),e}(),Cn=r("dx_QBqw"),In=function(){function e(){F()(this,e)}return H()(e,[{key:"isThisType",value:function(e){return e.data.type===k.B.TABLE}},{key:"needRequest",value:function(e,n){return this.isThisType(e)&&Object(Cn.T)(e.data).some((function(e){return!n[e]}))}}]),e}(),Bn=function(){function e(n,r){F()(this,e),this.taskId=n,this.allowFail=r,this.fetched=!1,this.rendered=!1,this.applied=!1,this.fetchedErr=!1}return H()(e,[{key:"reset",value:function(){this.fetched=!1,this.rendered=!1,this.fetchedErr=!1}},{key:"setFetched",value:function(){this.fetched=!0}},{key:"setFetchErr",value:function(){this.fetchedErr=!0}},{key:"setApplied",value:function(){this.applied=!0}},{key:"setRendered",value:function(){this.rendered=!0}},{key:"isDone",value:function(){return this.fetched&&this.applied&&this.rendered||this.fetchedErr}},{key:"isFetchedErr",value:function(){return this.fetchedErr}},{key:"isFetched",value:function(){return this.fetched}},{key:"isApplied",value:function(){return this.applied}},{key:"isAllowFail",value:function(){return this.allowFail}},{key:"getTaskId",value:function(){return this.taskId}}]),e}();function Tn(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return wn(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wn(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function wn(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function Rn(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Mn(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Rn(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rn(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var jn,Dn,An,Pn,Ln,Nn,Fn,Un,Hn,Vn,Wn=an.u.getInstance(),zn=Wn.clientvarFetchManager,Gn=Object(ce.s)(En.M)((On=function(){function e(n,r,o,i,c,a,l,s,u){var d=this;F()(this,e),this.api=n,this.eventEmitter=r,this.model=o,this.view=i,this.collab=c,this.lazySync=a,this.lazyRecordStatus=l,this.lazyConsumer=u,this.needRequestSkipBlockHandler=new Map,this.logger=void 0,this.taskStatusMap=new Map([]),this.cancelBackClientvarApply=void 0,this.useCache=!1,this.retryInfoMap=new Map,this.renderer=void 0,this.isWidthModeInitialized=!1,this.readyToToggleEditable=!1,this._ready=!0,this.listenHistoryRevert=function(){d.lazyConsumer.startApplyAllMode()},this.tryToEmitAllowEdit=function(){var e=!1;return function(){e||Object(rn.H)((function(){d.tryToConnectSyncAndToggleEditable(),d.eventEmitter.emit(Ft.R.POST_CLIENTVAR_FETCH_ALLOW_EDIT),e=!0}),d.lazyRecordStatus)}}(),this.logger=new xn(o,r),r.on(ln.p.HISTORY.TOGGLE_REVERT,this.listenHistoryRevert),this.injectRenderer(s)}return e=Object(Lt.e)(e,void 0,8)||e,e=Object(dn.u)(e,void 0,7)||e,e=Object(Ut.r)(e,void 0,6)||e,e=Object(fn.K)(e,void 0,5)||e,e=Object(cn.q)(e,void 0,4)||e,e=Object(u.p)(e,void 0,3)||e,e=Object(u.VA)(e,void 0,2)||e,e=Object(fe.h)(e,void 0,1)||e,e=Object(u.Q)(e,void 0,0)||e,H()(e,[{key:"getTaskStatus",value:function(e){return this.taskStatusMap.get(e)}},{key:"getFirstSlice",value:function(e){var n=this,r=e.hash,o=e.token,i=e.onFirstSliceError;this.initClientvars({id:o,hash:r}).catch((function(e){var c,a;(null===e||void 0===e?void 0:e.code)===kt.e.CODE_CURSOR_INVALID&&(null===(a=Wn.cacheManager)||void 0===a||a.deleteCache());i&&i(e),null===(c=n.taskStatusMap.get(o))||void 0===c||c.setFetchErr();var l={blockType:"page",taskId:o,mode:r?tn.Z.SPREAD:tn.Z.TOP_BOTTOM,requestId:e.requestId,ttLogId:e.ttLogId,url:e.url,queryParams:e.queryParams,msg:Object(tt.get)(e,"msg")||Object(tt.get)(e,"message"),resMsg:Object(tt.get)(e,"resMsg"),code:Object(tt.get)(e,"code")||kt.e.LAZY_RECORD_RES_EXCEPTION,type:hn.T,from:en.S.from,stack:e.stack};n.eventEmitter.emit(Ft.R.CLIENTVAR_SLICE_FATAL,l),Object(ve.K)(Ft.m.FETCH_SLICED_ERROR,l),n.destroy()}))}},{key:"genSkipBlockSet",value:function(){var e=s()(this.model.getRegisteredBlockTypes()).filter((function(e){return Object(pn.O)(e)}));this.needRequestSkipBlockHandler.set(Sn,new Sn({foldableTypes:new Set(e)})),this.needRequestSkipBlockHandler.set(In,new In)}},{key:"isPreEditableEnable",value:function(){return this.lazyConsumer.isPreEditableEnable()}},{key:"notifySkipBlockHideLoading",value:function(e,n){var r=this;e&&Object.entries(e.block_map).forEach((function(o){var i=$e()(o,2),c=i[0],a=i[1];Object(pn.z)(a.data.type)&&!r.shouldBlockRequest(a,e.block_map)&&r.eventEmitter.emit(Ft.R.CLIENTVAR_SKIP_BLOCK_APPLIED,{taskId:c,hash:n})}))}},{key:"uploadFetchStateInfo",value:function(e){var n=e.id,r=e.hash,o=e.lazyConsumer,i=function(e){return Object.keys(e||{}).find((function(n){if(e[n].data.type===k.B.TABLE){var r=zn.getClientvar(n);return!r||!(r.code&&!r.data)&&(r.data.next_cursors||[]).find((function(e){return!zn.getClientvar(e)}))}return!1}))},c=zn.getClientvar(n),a=-1,l=-1,s=0,u=0,d=0,f=0;if(c)if(u=1,0===c.code&&c.data){var h=c.data,p=h.block_map||{};a=h.concurrent?1:0,l=Number(h.has_more),(h.next_cursors||[]).find((function(e){return!zn.getClientvar(e)}))||(f=1),i(p)||(s=1)}else d=1;var v={fetchStartStage:zn.stage,use_cache:zn.getRemainInfo()?1:0,hash:r,isLark:Number(Kt.S.isLark),isLarkPcTab:Number(Kt.S.isLarkPcTab),concurrent:a,hasMore:l,remain_info:JSON.stringify(zn.getRemainInfo()),mobile:Number(Wn.isMobile),is_fg_enabled:Wn.isPreFetchEnable?1:0,concurrency_count_limit:Wn.maxConcurrency,fetchFinish:Number(zn.getFinishInfo().isFinish),from:en.S.from,isFirstSliceFetched:u,isFirstSliceError:d,firstTableFinished:s,pageCursorsFinished:f,fetchFinishAfterFirstApplied:0,pageCursorsFinishedAfterFirstApplied:0,tableInFirstAppliedSliceFinished:0};u&&d?(Kt.S.isMobile&&console.info("=====docx_concurrency_pre_fetch_state: ".concat(JSON.stringify(v))),Object(ve.K)(hn.J.PRE_CONCURRENCY_FETCH_STATE,v)):o.setFirstSliceApplied((function(e){var r=zn.getClientvar(n).data,o=0,c=0;if(!f&&(r.next_cursors||[]).find((function(e){return!zn.getClientvar(e)}))||(o=1),s)c=1;else{var a=(e||{}).block_map||{};i(a)||(c=1)}var l={concurrent:r.concurrent?1:0,hasMore:Number(r.has_more),fetchFinishAfterFirstApplied:Number(zn.getFinishInfo().isFinish),pageCursorsFinishedAfterFirstApplied:o,tableInFirstAppliedSliceFinished:c};Kt.S.isMobile&&console.info("=====docx_concurrency_pre_fetch_state: ".concat(JSON.stringify(v))),Object(ve.K)(hn.J.PRE_CONCURRENCY_FETCH_STATE,Object.assign({},v,l))}))}},{key:"initClientvars",value:function(){var e=Gt()(Wt.a.mark((function e(n){var r,o,i,c,a,l,u,d,f,h,p,v,g,b,y,m,_,k,O,x=this;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.id,o=n.blockType,i=n.hash,c=this.lazyConsumer,a=this.eventEmitter,l=this.taskStatusMap,c.token=r,i&&c.setStartId(i),u=sn.S.getQueryJumpInfo(),d=$e()(u,2),f=d[0],h=d[1],f&&f===sn.u.Reminder&&h&&h.block_id&&(v=h.block_id,c.setStartId(v),g=!0,p=function(e){g&&e.block_map[v]&&(g=!1,p=void 0,sn.S.queryJump(x.api.getService(it.a),f,h))}),c.setBeforeApply((function(e,n){null===qt.n||void 0===qt.n||qt.n.applyClientVar(n),on.S.applyClientVar(n),Object(ve.K)(Ft.j.REQUEST_RENDER,{taskId:Object(et.encryptTea)(e)})})),c.setAfterApply((function(e){a.emit(Ft.R.CLIENTVAR_APPLY_SLICE_CLIENTVAR_AFTER,e);var n=e.taskId,r=e.clientvar,o=e.taskClientvar,c=e.isTaskFinish,u=l.get(n);(null===u||void 0===u?void 0:u.isFetched())&&c&&u.setApplied(),(x.isPreEditableEnable()||s()(l.values()).filter((function(e){return!e.isAllowFail()})).every((function(e){return e.isApplied()})))&&x.tryToConnectSyncAndToggleEditable(),x.renderer.requestRender({clientvar:r,recordId:n,hash:i}),(null===u||void 0===u?void 0:u.isApplied())&&x.notifySkipBlockHideLoading(o,i),p&&p(r)})),c.setDuplicated((function(e){if(x.isPreEditableEnable()){var n=l.get(e);if(null===n||void 0===n?void 0:n.isFetched()){n.setApplied(),n.setRendered();var r=s()(x.taskStatusMap.values()),o=r.filter((function(e){return!e.isAllowFail()})),c=o.every((function(e){return e.isApplied()})),a=o.every((function(e){return e.isDone()})),u=r.every((function(e){return e.isDone()}));x.eventEmitter.emit(Ft.R.CLIENTVAR_RENDER_TASK_FINISH,{taskId:e,hash:i}),c&&x.tryToConnectSyncAndToggleEditable(),a&&x.tryToEmitAllowEdit(),u&&x.tryToEmitAllDone()}}})),b=i?tn.Z.SPREAD:tn.Z.TOP_BOTTOM,y=Object(et.encryptTea)(r),Object(ve.K)(Ft.j.FETCH_SLICED_CLIENTVARS,{mode:b,blockType:o,hash:Object(et.encryptTea)(i),taskId:y}),this.getOrInitTaskStatus(r),a.emit(Ft.R.CLIENTVAR_FETCH_TASK_WILL_START,{taskId:r,blockType:o}),m=!0,_=function(e){var n=e.data;a.emit(Ft.R.CLIENTVAR_SLICE_RESPONSE,{taskId:r,clientvar:n}),c.add(r,un.J.NORMAL,n,m),m=!1},k=function(e){x.notifySkipBlockHideLoading(e,i),Object(ve.K)(Ft.j.ON_ALL_SLICE_RESPONSE,{taskId:y})},O=Mn(Mn({id:r,mode:b,blockType:o},i?{block_id:i}:{}),{},{onSliceResponse:_,onAllSliceResponse:k}),this.useCache=!!zn.getRemainInfo(),this.uploadFetchStateInfo({id:r,hash:i,lazyConsumer:c}),e.next=22,this.concurrencyFetchSlicedClientvars(O);case 22:this.eventEmitter.emit(Ft.R.CLIENTVAR_FETCH_MAIN_CONTENT_DONE,r);case 23:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"concurrencyFetchSlicedClientvars",value:function(){var e=Gt()(Wt.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v,g=this;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=[],i=n.id,c=n.mode,a=n.block_id,l=void 0===a?i:a,u=n.onSliceResponse,d=n.onAllSliceResponse,f=c!==tn.Z.SPREAD?l:i,h=[f],p=Wt.a.mark((function e(){var n,c,a,l,d,p,v,b,y,m,_,k,O,x,E,S,C,I,B,T,w,R;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=[],a=[],l=h[0],!(d=zn.getClientvar(l))){e.next=9;break}if(!d.code&&d.data){e.next=7;break}throw d;case 7:e.next=12;break;case 9:return e.next=11,zn.fetchClientvar(l);case 11:d=e.sent;case 12:p=d.data,g.isWidthModeInitialized||(Qt(p),g.isWidthModeInitialized=!0),v=p.skip_blocks,b=p.cursor,y=p.has_more,m=p.concurrent,_=p.next_cursors,m||(g._ready=!1),h.shift(),g._ready||(_=y?[b]:[]),(null===(n=_)||void 0===n?void 0:n.length)&&h.push.apply(h,s()(_)),c.push(p),!r&&(null===v||void 0===v?void 0:v.length)&&a.push.apply(a,s()(v));case 22:if(!h.length){e.next=37;break}if(k=h[0],O=zn.getClientvar(k)){e.next=27;break}return e.abrupt("break",37);case 27:if(!O.code){e.next=29;break}throw O;case 29:x=O.data,E=x.skip_blocks,S=x.has_more,C=x.cursor,h.shift(),c.push(x),!g._ready&&S&&h.push(C),!r&&(null===E||void 0===E?void 0:E.length)&&a.push.apply(a,s()(E)),e.next=22;break;case 37:I=function(){var e,n,r=a[0],o=zn.getClientvar(r);if(!o)return"break";if(o.code||!o.data)return null===(n=g.taskStatusMap.get(r))||void 0===n||n.setFetchErr(),"break";var i=o.data,l=[],s=null===(e=i.next_cursors)||void 0===e?void 0:e.every((function(e){var n=zn.getClientvar(e);return n&&!n.code&&l.push(n.data),n&&!n.code}));if(!s)return"break";a.shift(),c.push.apply(c,[i].concat(l))};case 38:if(!a.length||!g._ready||g.isPreEditableEnable()){e.next=44;break}if("break"!==I()){e.next=42;break}return e.abrupt("break",44);case 42:e.next=38;break;case 44:B=Object(pn.g)(c),T=B.block_map,w=a.map((function(e){return g.getOrInitTaskStatus(e,Object(pn.z)(T[e].data.type)),e})),B.next_cursors=Array.from(h),B.skip_blocks=Array.from(w),o.push(B),h.length||(null===(R=g.taskStatusMap.get(i))||void 0===R||R.setFetched(),g.isAllTaskFetched()&&g.eventEmitter.emit(Ft.R.CLIENTVAR_FETCH_ALL_DONE_NEW)),u&&u({data:B,taskId:f,hasMore:B.has_more}),!r&&setTimeout((function(){return g.fetchSkipBlocksClientvars(B,w)}),1);case 53:case"end":return e.stop()}}),e)}));case 5:if(!h.length){e.next=9;break}return e.delegateYield(p(),"t0",7);case 7:e.next=5;break;case 9:return v=Object(pn.g)(o),d&&d(v),e.abrupt("return",v);case 12:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"isAllTaskFetched",value:function(e){var n=s()(this.taskStatusMap.values());return e&&(n=n.filter((function(e){return!e.isAllowFail()}))),n.every((function(e){return e.isFetched()}))}},{key:"fetchSkipBlocksClientvars",value:function(e,n){var r=this;n.forEach((function(n){var o=e.block_map[n].data.type;return r.eventEmitter.emit(Ft.R.CLIENTVAR_FETCH_TASK_WILL_START,{taskId:n,blockType:o,isTable:o===k.B.TABLE,isFoldable:Object(pn.O)(o)&&!Object(pn.l)(o)}),Object(ve.K)(Ft.j.GEN_FETCH_SKIP_BLOCK_TASK,{taskId:Object(et.encryptTea)(n)}),function(n){var o=e.block_map[n],i=o.id,c=o.data,a=c.type,l=function(){return r.concurrencyFetchSlicedClientvars({id:i,mode:tn.Z.SPECIFIC,blockType:a,block_id:n,onSliceResponse:function(e){var o;r.eventEmitter.emit(Ft.R.CLIENTVAR_SLICE_RESPONSE,{taskId:n,clientvar:e.data}),(null===(o=r.taskStatusMap.get(n))||void 0===o?void 0:o.isAllowFail())||r.lazyConsumer.add(n,un.J.FOLDABLE,e.data)},onAllSliceResponse:function(e){var o;(null===(o=r.taskStatusMap.get(n))||void 0===o?void 0:o.isAllowFail())&&r.lazyConsumer.add(n,un.J.TABLE,e),Object(ve.K)(Ft.j.ON_ALL_SLICE_RESPONSE,{taskId:Object(et.encryptTea)(n)}),r.eventEmitter.emit(Ft.R.CLIENTVAR_FETCH_SKIPPED_BLOCK_DONE,{clientvar:e,taskId:n})}},!0)};return l().catch((function(e){var o;null===(o=r.taskStatusMap.get(n))||void 0===o||o.setFetchErr();var i={blockType:"page",taskId:Object(et.encryptTea)(n),mode:tn.Z.SPECIFIC,requestId:e.requestId,url:e.url,queryParams:e.queryParams,msg:Object(tt.get)(e,"msg")||Object(tt.get)(e,"message"),resMsg:Object(tt.get)(e,"resMsg"),code:Object(tt.get)(e,"code")||kt.e.LAZY_RECORD_RES_EXCEPTION,type:hn.T,from:en.S.from};console.error(e),Object(ve.K)(Ft.m.FETCH_SLICED_ERROR,i);var s=Object(pn.z)(a);try{var u=function(){var e=zn.getClientvar(n);if(e&&!e.code&&e.data){var r,o=e.data.next_cursors,i=Tn(void 0===o?[]:o);try{for(i.s();!(r=i.n()).done;){var c=r.value,a=zn.getClientvar(c);a&&!a.code&&a.data||zn.retryTable(n,c)}}catch(s){i.e(s)}finally{i.f()}}else zn.retryTable(n);return l()};if(s){var d=Mn(Mn({},c),{},{error:e,fetchFn:u,taskId:n});r.retryInfoMap.set(n,d),r.eventEmitter.emit(Ft.R.CLIENTVAR_SLICE_SKIPPED_BLOCK_ERROR,d)}else r.eventEmitter.emit(Ft.R.CLIENTVAR_SLICE_FATAL,Mn(Mn({},i),{},{error:e,fetchFn:u,taskId:n})),r.destroy()}catch(f){console.error("emit CLIENTVAR_FETCH_SKIPED_BLOCK_DONE error"),console.error(f)}}))}(n).then((function(e){if(o===k.B.TABLE){var i=r.model.getBlockModelsByRecordId(n);if(i.length>0){var c=i.map((function(e){return e.id}))[0];nn.R.reportBlockLoadStage(nn.F.DATA_READY,{id:c,time:Date.now()})}}}))}))}},{key:"injectRenderer",value:function(e){var n=this;this.renderer=e,this.renderer.onTaskFinish((function(e){var r=e.taskId,o=n.taskStatusMap.get(r),i=n.isPreEditableEnable();if(i&&n.tryToEmitAllowEdit(),null===o||void 0===o?void 0:o.isApplied()){null===o||void 0===o||o.setRendered();var c=s()(n.taskStatusMap.values()),a=c.every((function(e){return e.isDone()})),l=!i&&c.filter((function(e){return!e.isAllowFail()})).every((function(e){return e.isDone()}));n.eventEmitter.emit(Ft.R.CLIENTVAR_RENDER_TASK_FINISH,e),l&&n.tryToEmitAllowEdit(),a&&n.tryToEmitAllDone()}})),this.renderer.onSubTaskFinish((function(e){n.eventEmitter.emit(Ft.R.CLIENTVAR_SUB_TASK_FINISH,Object.assign({},e,{lazyRecord:n}))}))}},{key:"destroy",value:function(){var e,n;ln.S.off(ln.p.HISTORY.TOGGLE_REVERT,this.listenHistoryRevert),this.lazyConsumer.destroy(),null===(e=this.renderer)||void 0===e||e.destroy(),this.logger.destroy(),this.taskStatusMap.clear(),this.retryInfoMap.clear(),null===(n=Wn.cacheManager)||void 0===n||n.destroy(),zn.destroy()}},{key:"tryToEmitAllDone",value:function(){var e=this,n=zn.getFinishInfo();en.S.updateStage($t.ET.WORKER_FETCH_DOCX_CLIENTVAR_FINISH,n.fetchFinishTime),en.S.updateStage($t.ET.WORKER_FETCH_DOCX_CLIENTVAR_TO_MAIN_FINISH,n.mainFinishTime),Object(rn.H)((function(){var n,r;e.eventEmitter.emit(Ft.R.CLIENTVAR_APPLY_ALL_DONE,{lazyRecord:e}),null===(n=e.collab)||void 0===n||null===(r=n.sync)||void 0===r||r.forceSendHeartbeats(),console.timeEnd("alldone")}),this.lazyRecordStatus)}},{key:"tryToConnectSyncAndToggleEditable",value:function(){this.readyToToggleEditable||(this.lazySync.onAllowEdit(),this.eventEmitter.emit(Ft.R.CLIENTVAR_FETCH_ALLOW_EDIT),this.readyToToggleEditable=!0)}},{key:"getOrInitTaskStatus",value:function(e,n){var r=this.taskStatusMap.get(e);return r?r.reset():(r=new Bn(e,n),this.taskStatusMap.set(e,r)),r}},{key:"shouldBlockRequest",value:function(e,n){return s()(this.needRequestSkipBlockHandler.values()).some((function(r){return r.needRequest(e,n)}))}}]),e}(),kn=On))||kn,Kn="LazyRendereRend",qn="BlockRendered",Xn="TaskError",Yn=Object(ce.s)(dn.u)(jn=function(){function e(){F()(this,e),this.eventCallbacks=[]}return H()(e,[{key:"requestRender",value:function(e){var n=e.clientvar,r=e.recordId,o=e.hash,i=r;try{Promise.resolve().then((function(e){return ln.S.emit(qn,{clientvarToWork:n,taskId:i,hash:o}),ln.S.emit(Kn,{fullClientvar:n,taskId:i,hash:o}),e})).catch(console.error)}catch(c){throw ln.S.emit(Xn,{clientvarToWork:n,taskId:i}),c}}},{key:"onSubTaskFinish",value:function(e){this.eventCallbacks.push(e),ln.S.on(qn,e)}},{key:"onTaskFinish",value:function(e){this.eventCallbacks.push(e),ln.S.on(Kn,e)}},{key:"onTaskError",value:function(e){this.eventCallbacks.push(e),ln.S.on(Xn,e)}},{key:"destroy",value:function(){this.eventCallbacks.forEach((function(e){ln.S.off(Kn,e),ln.S.off(qn,e),ln.S.off(Xn,e)})),this.eventCallbacks=[]}}]),e}())||jn,Jn=Object(ce.s)(fn.K)(Dn=function(){function e(){var n=this;F()(this,e),this.needDelaySync=!0,this.pendingSyncTask=[],this.connectSync=void 0,this.onAllowEdit=function(){n.needDelaySync=!1,n.beginSync()}}return H()(e,[{key:"setConnectSync",value:function(e){this.connectSync=e}},{key:"requestSync",value:function(e){this.pendingSyncTask.push({entities:e}),this.needDelaySync||this.beginSync()}},{key:"destroy",value:function(){this.needDelaySync=!0}},{key:"beginSync",value:function(){var e=this;this.pendingSyncTask.forEach((function(n){return e.connectSync(n.entities)})),this.pendingSyncTask=[]}},{key:"enabled",get:function(){return!0}}]),e}())||Dn;function Zn(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Qn=(Vn=function(e){G()(r,e);var n=Zn(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),L()(e,"lazySync",Pn,W()(e)),L()(e,"clientVar",Ln,W()(e)),L()(e,"lazyRecord",Nn,W()(e)),L()(e,"lazyConsumer",Fn,W()(e)),L()(e,"lazyRecordStatus",Un,W()(e)),L()(e,"lazyRenderer",Hn,W()(e)),e}return H()(r,[{key:"init",value:function(){this.clientVar.connectSync(this.lazySync)}},{key:"destroy",value:function(){this.lazyRenderer.destroy(),this.lazySync.destroy(),this.lazyRecord.destroy(),this.lazyRecordStatus.destroy(),this.lazyConsumer.destroy()}}],[{key:"forVirtualRender",value:function(){return{module:r,providers:[Jn,Gn,Nt.v,Ht,Yn]}}}]),r}(u.G),An=Vn,Pn=Z()(An.prototype,"lazySync",[fn.K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ln=Z()(An.prototype,"clientVar",[de.v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nn=Z()(An.prototype,"lazyRecord",[pe.M],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fn=Z()(An.prototype,"lazyConsumer",[Lt.e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Un=Z()(An.prototype,"lazyRecordStatus",[pe.r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hn=Z()(An.prototype,"lazyRenderer",[pe.u],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),An),$n=r("dx_V5C0"),er=r("dx_YIK2"),tr=r("dx_K9Ia"),nr=r("dx_DnxT"),rr=r("dx_Fimk"),or=r("dx_eSV8"),ir=r("dx_Dtqr"),cr=r("dx_NOtv"),ar=r.n(cr),lr=r("dx_AA3h"),sr=r("dx_LbJg"),ur=r("dx_MmkF"),dr="MobileSyncStorageWeb",fr=Object(ur.f)(dr),hr=ar()("".concat(dr,"-offline")),pr=function(){function e(n){var r=this;F()(this,e),this.token=n,this.constantKey="PAGE_TOKEN",this.oldKeySet=new Set,this.getNewKey=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.token;return e.replace(n,r.constantKey)},this.clearOldData=function(){var e=Gt()(Wt.a.mark((function e(n){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.oldKeySet.has(n)){e.next=4;break}return fr("clear old data, oldKey: ".concat(n)),e.next=4,r.setDocXData(n,null);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}return H()(e,[{key:"getDocXData",value:function(){var e=Gt()(Wt.a.mark((function e(n){var r;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(lr.getData)({key:n});case 2:if((r=e.sent)||fr("getData null"),r&&r.code&&fr("getData illegal, the code is ".concat(r.code)),!r||r.code||!r.data){e.next=7;break}return e.abrupt("return",r.data);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},{key:"setDocXData",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(lr.setData)({key:e,data:n,needSync:r})}},{key:"getItem",value:function(){var e=Gt()(Wt.a.mark((function e(n){var r,o,i,c,a;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getNewKey(n),e.next=3,this.getDocXData(r);case 3:if(o=e.sent,hr("getItem",n,r,o),o){e.next=11;break}return e.next=8,this.getDocXData(n);case 8:return(i=e.sent)&&this.oldKeySet.add(n),e.abrupt("return",i);case 11:if(Object(lr.isLocalCreateSuite)()||!("change_map"in o)){e.next=17;break}return e.next=14,sr.S.getFakeToken(this.token);case 14:c=e.sent,hr("refresh fakeToken",c),c&&(a=this.refreshBackupData(o,c))&&this.setDocXData(r,a);case 17:return e.abrupt("return",o);case 18:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"setItem",value:function(){var e=Gt()(Wt.a.mark((function e(n,r){var o;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.getNewKey(n),fr("setItem token: ".concat(Object(et.encryptTea)(this.token),", oldKey: ").concat(Object(et.encryptTea)(n),", newKey: ").concat(o)),hr("setItem",n,o),e.next=5,this.clearOldData(n);case 5:return e.abrupt("return",this.setDocXData(o,r));case 6:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"removeItem",value:function(){var e=Gt()(Wt.a.mark((function e(n){var r;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.getNewKey(n),fr("removeItem token: ".concat(Object(et.encryptTea)(this.token),", oldKey: ").concat(Object(et.encryptTea)(n),", newKey: ").concat(r)),e.next=4,this.clearOldData(n);case 4:return e.abrupt("return",this.setDocXData(r,null));case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"updateIsNeedSync",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e?{baseRev:n}:null;return fr("updateIsNeedSync. needSync: ".concat(e)),this.setDocXData("DOCX_BACKGROUND_NEED_SYNC",r,e)}},{key:"refreshBackupData",value:function(e,n){var r=this,o=e.change_map;if(o[n])return fr("refreshing backup data, replaced token is: ".concat(n)),o[this.token]=o[n],o[this.token].id=this.token,delete o[n],Object.keys(o).forEach((function(e){o[e].payload.ops=Object(kt.O)({ops:o[e].payload.ops,originID:n,replaceID:r.token})})),e}}]),e}(),vr=pr;var gr,br=r("dx_sBQB"),yr=new function e(){var n=this;F()(this,e),this._storage=Object(br.J)(),this.getItem=function(e){return n._storage.then((function(n){return n.getItem(e)})).then((function(e){return JSON.parse(e)}))},this.setItem=function(e,r){var o=JSON.stringify(r);return n._storage.then((function(n){return n.setItem(e,o)}))},this.removeItem=function(e){return n._storage.then((function(n){return n.removeItem(e)}))}},mr=r("dx_cDf5"),_r=r.n(mr),kr=function e(){F()(this,e),this.sendMessageToOtherTab=function(e,n){var r={backupIDMap:n};localStorage.setItem(e,JSON.stringify(r)),localStorage.removeItem(e)},this.getMessageFromEvent=function(e,n){if(n.key!==e||!n.newValue)return null;var r=JSON.parse(n.newValue);return"object"===_r()(r)&&r.backupIDMap},this.onHandleReceiveMessage=function(e){window.addEventListener("storage",e)},this.offHandleReceiveMessage=function(e){window.removeEventListener("storage",e)}},Or=r("dx_tSNM");function xr(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Er,Sr,Cr,Ir,Br=h.S.isMobile&&h.S.isBytedanceApp,Tr=Object(ce.s)(Or.c)(gr=function(e){G()(r,e);var n=xr(r);function r(e,o,i){var c;return F()(this,r),(c=n.call(this,e.get("token"),{isNeedWatchCollab:!0,isNeedApply:Object(ir.C)(),requestAPI:{USER_CHANGE:nr.r.userChange,NEW_CHANGES:nr.r.fetchMiss},uniqueMemberId:"10000000000000",onSyncStatusChanged:function(e){return c._onSyncStatusChanged(e)},onDataSubmitted:function(e,n,r){return c.onDataSubmitted$.next({backupID:e,payload:n,response:r})}})).collab=o,c.model=i,c.onDataSubmitted$=new tr.Z,c._storage=void 0,c._logWithInfo=function(e,n){Br&&(e===kt.w.DATA_CHANGE&&navigator.onLine||console.info("[offline-sync]: ".concat(e," params: ").concat(n?JSON.stringify(n):""))),Object(rr.N)(e,n)},c._onSyncStatusChanged=function(e){Br&&c._getStorage().updateIsNeedSync(e,c.collab.getSyncVersion())},c}return r=Object(u.VA)(r,void 0,2)||r,r=Object(cn.q)(r,void 0,1)||r,r=Object(u.j)(r,void 0,0)||r,H()(r,[{key:"destroy",value:function(){oe()(Y()(r.prototype),"destroy",this).call(this),this._storage=null}},{key:"_getStorage",value:function(){return this._storage||(this._storage=Br?new vr(this.token):yr),this._storage}},{key:"_getRequestInstance",value:function(){return{request:this.collab.sync.autoRetryRequest.bind(this.collab.sync)}}},{key:"_createLogger",value:function(){return{log:this._logWithInfo,logError:or.n}}},{key:"_getCollab",value:function(){return this.collab}},{key:"_getOfflineApplyAPI",value:function(){var e=this.model;return{hasRecord:function(n){return e.hasRecordByRecordId(n)},getRecord:function(n){return e.getRecordByRecordId(n)},registerRecords:function(n){return e.registerRecords(n)},applyTransaction:e.applyTransaction}}},{key:"_getMultiTabMessenger",value:function(){return new kr}}]),r}(kt.u))||gr;function wr(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Rr,Mr,jr,Dr,Ar,Pr,Lr=Object(u.H)({providers:[Tr]})((Ir=function(e){G()(r,e);var n=wr(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),L()(e,"offlineSync",Cr,W()(e)),e}return H()(r,[{key:"init",value:function(){this.offlineSync.init()}},{key:"destroy",value:function(){this.offlineSync.destroy()}}]),r}(u.G),Sr=Ir,Cr=Z()(Sr.prototype,"offlineSync",[er.c],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Er=Sr))||Er,Nr=r("dx_A5O8"),Fr=r("dx_FP3m"),Ur=r("dx_Ogyw");function Hr(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Vr,Wr,zr=Object(u.H)()((Pr=function(e){G()(r,e);var n=Hr(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),L()(e,"model",jr,W()(e)),L()(e,"rect",Dr,W()(e)),L()(e,"blockManager",Ar,W()(e)),e.cacheSuiteTitle="",e.onReady=function(){h.S.isOpendoc&&(e.cacheSuiteTitle=e.model.rootBlockModel.getText(),e.model.rootBlockModel.update$.subscribe((function(n){var r=n.model.getText();r!==e.cacheSuiteTitle&&(e.cacheSuiteTitle=r,Object(et.sendOpendocEvent)(et.OPENDOC_EVENT.SUITE_TITLE_CHANGE,{title:r}))})),Object(et.registerOpendocApi)(et.OPENDOC_API.getSuiteTitle,(function(){return e.model.rootBlockModel.getText()})),Object(et.registerOpendocApi)(et.OPENDOC_API.getAnchorTop,(function(n){var r=e.blockManager.getBlockIdsByRecordId(n),o=$e()(r,1)[0];return o?e.rect.getBlockRect(o).top:0})),Object(et.registerOpendocApi)(et.OPENDOC_API.highlightAnchor,(function(n){var r=e.blockManager.getBlockViewsByRecordId(n);return Object(Ur.I)(r)})),Object(et.registerOpendocApi)(et.OPENDOC_API.highlightAnchor,(function(n){var r=e.blockManager.getBlockViewsByRecordId(n);return Object(Ur.I)(r)})))},e}return H()(r,[{key:"init",value:function(){this.model.initialDataReady$.subscribe(this.onReady)}}]),r}(u.G),Mr=Pr,jr=Z()(Mr.prototype,"model",[u.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Dr=Z()(Mr.prototype,"rect",[Fr.z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ar=Z()(Mr.prototype,"blockManager",[it.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Rr=Mr))||Rr,Gr=r("dx_z8zm"),Kr=r("dx_k9kc"),qr=r("dx_rldU"),Xr=r("dx_MUMK"),Yr=r("dx_OJCf"),Jr=r("dx_qHDV"),Zr=r("dx_ppc6"),Qr=r("dx_hIkB"),$r=r("dx_BaZy"),eo=r.n($r),to=eo()({loader:function(){return r.e("dx_nUC").then(r.bind(null,"dx_Br4q"))},loading:function(){return null},render:function(e,n){var r=e.PresentationModeMask;return _e.a.createElement(r,Object.assign({},n,{ref:n.editorRef}))}}),no=r("dx_uvPz"),ro=r("dx_Ynen"),oo=r.n(ro),io=Object(ce.S3)("fullscreen"),co=Object(ce.s)(io)((Wr=function(){function e(){F()(this,e),this.isExitByRequest=!1,this.presentationFullscreenElement=document.body}return H()(e,[{key:"waitForFullscreenChanged",value:function(e){var n=this;return new Promise((function(r,o){var i=function i(c){var a="enter"===e;if(n.isExitByRequest||!oo.a.fullscreenElement||a){if(oo.a.removeEventListener("fullscreenchange",i),oo.a.removeEventListener("fullscreenerror",i),!oo.a.fullscreenElement&&!n.isExitByRequest){var l=Object(Gr.E)(et.store.getState());Object(rr.N)("ccm_doc_display_mode_click",{click:"exit",target:"none",mode_type:"".concat(l,"_mode"),exit_type:"esc"})}return c?c.type.toLowerCase().endsWith("fullscreenchange")?r():o(new Error("fullscreenerror fired.")):o(new Error("fullscreen change failed."))}};oo.a.addEventListener("fullscreenchange",i),oo.a.addEventListener("fullscreenerror",i)}))}},{key:"requestEnterFullscreen",value:function(){var e=Gt()(Wt.a.mark((function e(){var n;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.waitForFullscreenChanged("enter"),!no.t.chrome&&!no.t.safari){e.next=4;break}return e.next=4,new Promise((function(e){return setTimeout(e,100)}));case 4:return oo.a.requestFullscreen(this.presentationFullscreenElement),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"requestExitFullscreen",value:function(){var e=Gt()(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isExitByRequest=!0,oo.a.exitFullscreen(),e.next=4,new Promise((function(e){return setTimeout(e,100)}));case 4:oo.a.fullscreenElement?this.requestExitFullscreen():this.isExitByRequest=!1;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),Vr=Wr))||Vr,ao=Object(ce.S3)("presentation-mode"),lo=r("dx_faye"),so=r.n(lo),uo=r("dx_h74D");function fo(e){return{type:Xt.R.UpdatePresentationModeStatus,payload:e}}var ho,po,vo,go,bo,yo,mo,_o,ko,Oo,xo,Eo,So,Co,Io,Bo=r("dx_Xdvu"),To=r("dx_MC5R"),wo=r("dx_QWnh"),Ro="presentation-mode",Mo=Object(ce.s)(ao)((_o=function(){function e(){F()(this,e),this._cacheType=Qr.h.NONE,this._cacheStatus=Qr.R.DONE,this.lastUsedMode=null,this.waitForExitFullscreenPromise=null,this.editorRef=_e.a.createRef(),L()(this,"eventEmitter",vo,this),L()(this,"fullscreen",go,this),L()(this,"model",bo,this),L()(this,"context",yo,this),L()(this,"editorAPI",mo,this),this.viewContainer=null}return H()(e,[{key:"enterPresentationMode",value:function(){var e=Gt()(Wt.a.mark((function e(){var n;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=this.getLastUsedType(),e.next=4,this.setPresentationMode(n);case 4:if(document.body.classList.add(Ro),this._cacheType!==Qr.h.NONE){e.next=7;break}throw new Error("Enter presentation mode failed");case 7:return e.next=9,this.waitForExitFullscreenPromise;case 9:return e.next=11,this.setPresentationMode(Qr.h.NONE);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.error(e.t0),this.exitPresentationMode();case 17:case"end":return e.stop()}}),e,this,[[0,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"exitPresentationMode",value:function(){var e=Gt()(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,document.body.classList.remove(Ro),e.next=4,this.fullscreen.requestExitFullscreen();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:return e.prev=9,this._cacheType!==Qr.h.NONE&&this.setPresentationMode(Qr.h.NONE),this.unmountView(),e.finish(9);case 13:case"end":return e.stop()}}),e,this,[[0,6,9,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"switchPresentationMode",value:function(){var e=Gt()(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._cacheStatus===Qr.R.DONE){e.next=2;break}return e.abrupt("return");case 2:if(this._cacheType!==Qr.h.DOCUMENT){e.next=5;break}return this.setPresentationMode(Qr.h.PAGINATION),e.abrupt("return");case 5:if(this._cacheType!==Qr.h.PAGINATION){e.next=8;break}return this.setPresentationMode(Qr.h.DOCUMENT),e.abrupt("return");case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPresentationMode",value:function(){var e=Gt()(Wt.a.mark((function e(n){var r,o,i,c=this;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this._cacheType)!==(o=n)){e.next=4;break}return e.abrupt("return");case 4:if(this._cacheType=o,et.store.dispatch((a=o,{type:Xt.R.UpdatePresentationModeType,payload:a})),r!==Qr.h.NONE){e.next=16;break}return i=this.mountView(),e.next=10,this.fullscreen.requestEnterFullscreen();case 10:return this.waitForExitFullscreenPromise=this.fullscreen.waitForFullscreenChanged(),e.next=13,this.transitLifecycle(Qr.b.ENTERING,Qr.b.ENTERED,Gt()(Wt.a.mark((function e(){var n;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(wo.Q)(c.editorAPI).record.id,e.next=3,i;case 3:if(c._cacheStatus!==Qr.R.ENTERING){e.next=7;break}return e.next=6,c.getModeInstance(o).onEnter(n);case 6:c.lastUsedMode=o;case 7:case"end":return e.stop()}}),e)}))));case 13:Object(rr.N)("ccm_doc_display_mode_view",{mode_type:"".concat(o,"_mode")}),e.next=23;break;case 16:if(o===Qr.h.NONE){e.next=21;break}return e.next=19,this.transitLifecycle(Qr.b.BEFORE_CHANGE,Qr.b.AFTER_CHANGE,Gt()(Wt.a.mark((function e(){var n,i,a;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=c.getModeInstance(r),i=c.getModeInstance(o),a=n.getLastVisitedBlock(),e.next=5,n.onExit();case 5:return e.next=7,i.onEnter(a);case 7:c.lastUsedMode=o;case 8:case"end":return e.stop()}}),e)}))));case 19:e.next=23;break;case 21:return e.next=23,this.transitLifecycle(Qr.b.EXITING,Qr.b.EXITED,Gt()(Wt.a.mark((function e(){var n,o;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.editorRef.current){e.next=8;break}return n=c.getModeInstance(r),o=n.getLastVisitedBlock(),e.next=5,n.onExit();case 5:return e.next=7,c.unmountView();case 7:o&&c.context.viewport.scrollToRecord(o);case 8:case"end":return e.stop()}}),e)}))));case 23:case"end":return e.stop()}var a}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"getStatusByLifecycle",value:function(e){var n=Qr.R.DONE;switch(e){case Qr.b.ENTERING:n=Qr.R.ENTERING;break;case Qr.b.ENTERED:n=Qr.R.DONE;break;case Qr.b.EXITING:n=Qr.R.EXITING;break;case Qr.b.EXITED:n=Qr.R.DONE;break;case Qr.b.BEFORE_CHANGE:n=Qr.R.SWITCHING;break;case Qr.b.AFTER_CHANGE:n=Qr.R.DONE}return n}},{key:"transitLifecycle",value:function(){var e=Gt()(Wt.a.mark((function e(n,r,o){var i;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.getStatusByLifecycle(n),this._cacheStatus=i,et.store.dispatch(fo(i)),this.eventEmitter.dispatch(n),e.next=6,o();case 6:this._cacheStatus===i&&(i=this.getStatusByLifecycle(r),this._cacheStatus=i,et.store.dispatch(fo(i)),this.eventEmitter.dispatch(n));case 7:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"mountView",value:function(){var e=Gt()(Wt.a.mark((function e(){var n=this;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.viewContainer&&n.unmountView();var r=document.createElement("div");document.body.appendChild(r),n.viewContainer=r,so.a.render(_e.a.createElement(uo.Provider,{store:et.store},[_e.a.createElement(to,{editorRef:n.editorRef,token:n.model.rootRecordId,onMount:function(){return e()},onExitBtnClick:function(){Object(rr.N)("ccm_doc_display_mode_click",{click:"exit",target:"none",mode_type:"".concat(n._cacheType,"_mode"),exit_type:"back"}),n.exitPresentationMode()},onModeBtnClick:function(){var e=n._cacheType===Qr.h.DOCUMENT?Qr.h.PAGINATION:Qr.h.DOCUMENT;Object(rr.N)("ccm_doc_display_mode_click",{target:"none",click:"".concat(e,"_mode")}),n.switchPresentationMode()},onGoBackBtnClick:function(){var e;return!!(null===(e=n.editorRef)||void 0===e?void 0:e.current)&&n.getModeInstance(n._cacheType).goBack()},shouldShowGoBack:function(){var e;return!!(null===(e=n.editorRef)||void 0===e?void 0:e.current)&&n.getModeInstance(n._cacheType).shouldShowGoBack()}})]),r)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"unmountView",value:function(){var e=Gt()(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.viewContainer&&(so.a.unmountComponentAtNode(this.viewContainer),document.body.removeChild(this.viewContainer),this.viewContainer=null);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getModeInstance",value:function(e){var n,r,o=null===(n=this.editorRef.current)||void 0===n||null===(r=n.editor)||void 0===r?void 0:r.api.getService(To.W).getModeInstance(e);if(!o)throw new Error("cannot get presentation mode instance: ".concat(e));return o}},{key:"getLastUsedType",value:function(){return this.lastUsedMode&&this.lastUsedMode!==Qr.h.NONE?this.lastUsedMode:Qr.h.DOCUMENT}}]),e}(),po=_o,vo=Z()(po.prototype,"eventEmitter",[fe.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),go=Z()(po.prototype,"fullscreen",[io],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bo=Z()(po.prototype,"model",[u.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yo=Z()(po.prototype,"context",[Bo.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mo=Z()(po.prototype,"editorAPI",[u.Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ho=po))||ho;function jo(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Do,Ao,Po,Lo,No,Fo=Object(u.H)({providers:[Mo,co]})((Io=function(e){G()(r,e);var n=jo(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),L()(e,"presentationMode",xo,W()(e)),L()(e,"model",Eo,W()(e)),L()(e,"blockManager",So,W()(e)),L()(e,"selectionAPI",Co,W()(e)),e.handleKeyDown=function(n){var r=Object(Gr.u)(et.store.getState());Object(Yr.u)(n)===Xr.F.onPresentationMode&&(r||(e.presentationMode.enterPresentationMode(),n.preventDefault(),Object(Kr.Fi)({target:"ccm_doc_display_mode_view",actionType:Kr.F.display_mode,blocks:[],blockManager:e.blockManager,source:Kr.G.content_page,click:Kr.c.hotkey_action,actionObject:qr.u.BLOCK})))},e.handleEnterPresentationMode=function(){e.presentationMode.enterPresentationMode()},e.selectionTargetFilter=function(e){return!e.closest(".".concat(Qr.r))},e}return H()(r,[{key:"init",value:function(){document.addEventListener("keydown",this.handleKeyDown),et.EventEmitter.on("enter-presentation-mode",this.handleEnterPresentationMode),this.selectionAPI.register(Jr.q.startTargetFilter,this.selectionTargetFilter),to.preload()}},{key:"destroy",value:function(){document.removeEventListener("keydown",this.handleKeyDown),et.EventEmitter.off("enter-presentation-mode",this.handleEnterPresentationMode),this.selectionAPI.unregister(Jr.q.startTargetFilter,this.selectionTargetFilter)}}]),r}(u.G),Oo=Io,xo=Z()(Oo.prototype,"presentationMode",[ao],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Eo=Z()(Oo.prototype,"model",[u.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),So=Z()(Oo.prototype,"blockManager",[it.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Co=Z()(Oo.prototype,"selectionAPI",[Zr.S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ko=Oo))||ko,Uo=r("dx_Frpz"),Ho=r("dx_QILm"),Vo=r.n(Ho),Wo="SYNC_CURSOR_SELECT_STATE_UPDATE_EVENT",zo=r("dx_K8KR"),Go=Object(ce.s)(zo.W)(Do=function(){function e(n){var r=this;F()(this,e),this.emitter=n,this.stateMap=new Map,this.handleSyncCursorSelect=function(e){var n=e.blockId,o=Vo()(e,["blockId"]);r.stateMap.set(n,o),r.emitter.dispatch(Wo,o,n)},ln.N.on(ln.p.COMMON.SYNC_CURSOR_SELECT,this.handleSyncCursorSelect)}return e=Object(fe.h)(e,void 0,0)||e,H()(e,[{key:"get",value:function(e){return this.stateMap.get(e)}},{key:"onStateChange",value:function(e,n){this.emitter.addListener(Wo,n,e)}},{key:"offStateChange",value:function(e,n){this.emitter.removeListener(Wo,n,e)}},{key:"destroy",value:function(){ln.N.off(ln.p.COMMON.SYNC_CURSOR_SELECT,this.handleSyncCursorSelect)}}]),e}())||Do;function Ko(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var qo,Xo,Yo,Jo,Zo,Qo=Object(u.H)({providers:[Go]})((No=function(e){G()(r,e);var n=Ko(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),L()(e,"state",Lo,W()(e)),e}return H()(r,[{key:"destroy",value:function(){this.state.destroy()}}]),r}(u.G),Po=No,Lo=Z()(Po.prototype,"state",[Uo.W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ao=Po))||Ao,$o=r("dx_Yuai"),ei=Object(ce.s)($o.Y)(qo=function(){function e(){var n=this;F()(this,e),this.targets=new Set,this.onOpen=function(){n.targets.forEach((function(e){e.onTranslateOpen()}))},this.onClose=function(){n.targets.forEach((function(e){e.onTranslateClose()}))},this.onLanguageChange=function(){n.targets.forEach((function(e){e.onTranslateLanguageChange()}))},ln.N.on(ln.p.TRANSLATE.TRANSLATE_EVENT_DONE,this.onOpen),ln.N.on(ln.p.TRANSLATE.TRANSLATE_EVENT_CLOSE,this.onClose),ln.N.on(ln.p.TRANSLATE.TRANSLATE_LANGUAGE_CHANGE,this.onLanguageChange)}return H()(e,[{key:"destroy",value:function(){ln.N.off(ln.p.TRANSLATE.TRANSLATE_EVENT_DONE,this.onOpen),ln.N.off(ln.p.TRANSLATE.TRANSLATE_EVENT_CLOSE,this.onClose),ln.N.off(ln.p.TRANSLATE.TRANSLATE_LANGUAGE_CHANGE,this.onLanguageChange)}},{key:"add",value:function(e){this.targets.add(e)}},{key:"remove",value:function(e){this.targets.delete(e)}}]),e}())||qo;function ti(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var ni,ri,oi,ii,ci=Object(u.H)({providers:[ei]})((Zo=function(e){G()(r,e);var n=ti(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),L()(e,"translation",Jo,W()(e)),e}return H()(r,[{key:"destroy",value:function(){this.translation.destroy()}}]),r}(u.G),Yo=Zo,Jo=Z()(Yo.prototype,"translation",[$o.Y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Xo=Yo))||Xo,ai=r("dx_NYvg"),li=r("dx_SUdB");!function(e){e.COMMENT="COMMENT",e.SHARE="SHARE",e.MORE_OPERATE="MORE_OPERATE",e.MESSAGE="MESSAGE",e.UNDO="UNDO",e.UNDO_DISABLE="UNDO_DISABLE",e.REDO="REDO",e.REDO_DISABLE="REDO_DISABLE",e.SECRET="SECRET"}(ri||(ri={})),function(e){e.COMMENT="COMMENT",e.SHARE="SHARE",e.MORE_OPERATE="MORE_OPERATE",e.MESSAGE="MESSAGE",e.UNDO="UNDO",e.REDO="REDO",e.SECRET="SECRET"}(oi||(oi={})),function(e){e.POINT="point",e.NUM="num"}(ii||(ii={}));var si,ui,di=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{id:e,disabled:n}};ni={},_t()(ni,ri.COMMENT,di(oi.COMMENT,!1)),_t()(ni,ri.MESSAGE,di(oi.MESSAGE,!1)),_t()(ni,ri.MORE_OPERATE,di(oi.MORE_OPERATE,!1)),_t()(ni,ri.SHARE,di(oi.SHARE,!1)),_t()(ni,ri.SECRET,di(oi.SECRET,!1)),_t()(ni,ri.UNDO,di(oi.UNDO)),_t()(ni,ri.UNDO_DISABLE,di(oi.UNDO,!0)),_t()(ni,ri.REDO,di(oi.REDO)),_t()(ni,ri.REDO_DISABLE,di(oi.REDO,!0));!function(e){e[e.SUCCESS_GET_SEC=0]="SUCCESS_GET_SEC",e[e.FAILED_GET_SEC=1]="FAILED_GET_SEC",e[e.FAILED_CREATE_DOC_SEC=2]="FAILED_CREATE_DOC_SEC",e[e.NO_SEC=3]="NO_SEC"}(si||(si={})),function(e){e[e.NO_AVAILABLE_SEC=0]="NO_AVAILABLE_SEC",e[e.ALLOW_SET_SEC=1]="ALLOW_SET_SEC"}(ui||(ui={}));var fi,hi,pi=r("dx_O75l"),vi=r("dx_vlFf"),gi=r("dx_ahlY");function bi(e,n){var r,o=e.target&&(e.target.tagName||"").toLowerCase();return!(("input"!==o&&"textarea"!==o||n.isFocusInHiddenInputDom())&&(r=e.target,!r||!Object(gi.d)(r,"mxCellEditor")))}var yi,mi,_i,ki,Oi=Object(ce.s)(ai.p)((hi=function(){function e(n,r,o,i){var c=this;F()(this,e),this.undoService=n,this.eventEmitter=r,this.context=i,this.undoDispatcher=void 0,this.prevSelectionQueue=[],this.inTransaction=!1,this.inComposition=!1,this.boundary=void 0,this.subs=void 0,this.enabled=!0,this.handleHistoryUndoRedo=function(e){if(e instanceof InputEvent&&!bi(e,c.selectionAPI)&&c.selectionAPI.isFocus()){if("historyUndo"===e.inputType)c.checkAndUndo();else{if("historyRedo"!==e.inputType)return;c.checkAndRedo()}e.preventDefault()}},this.checkAndUndo=function(){c.canUndo&&c.enabled&&(c.undo(),et.EventEmitter.emit("undo"))},this.checkAndRedo=function(){c.canRedo&&c.enabled&&c.redo()},this.handleKeyDown=function(e){var n,r,o,i=h.S.isMac||h.S.isIPad,a=[{metaCtrlKey:!0,key:"z",shiftKey:!1,handler:pi.r.UNDO},{metaCtrlKey:!0,key:i?"z":"y",shiftKey:i,handler:pi.r.REDO}],l=(null===(n=function(e){return a.find((function(n){return n.metaCtrlKey===e[li.U]&&n.key===e.key.toLowerCase()&&n.shiftKey===e.shiftKey}))}(e))||void 0===n?void 0:n.handler)||void 0,s="undo"===l&&h.S.isSafari&&c.canUndo&&!("None"!==(null===(r=window)||void 0===r||null===(o=r.getSelection())||void 0===o?void 0:o.type));if(l&&(c.selectionAPI.isFocus()||s||c.isFocusInBlock(e.target))&&!c.inComposition){if(bi(e,c.selectionAPI))return;e.preventDefault(),e.stopImmediatePropagation(),c.eventEmitter.dispatch(l)}},this.isFocusInBlock=function(e){return!!(e&&e instanceof HTMLElement&&e.closest(".BITABLE_BLOCK_OVERLAY"))},this.handleChange=function(){var e=Gt()(Wt.a.mark((function e(n){var r,o,i,a,l;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.inTransaction=!1,!c.undoService.inUndoRedo){e.next=3;break}return e.abrupt("return");case 3:if(r=n.options,o=r.from!==kt.H.remote&&r.from!==kt.H.silence&&!1!==r.undoable,i=c.selectionAPI,a={prev:c.prevSelectionQueue.shift()||[],next:i.getSelection()},c.addToUndoStack(n,o,a),!o){e.next=13;break}return e.next=11,Object(kt.E)(0);case 11:(l=a.next).splice.apply(l,[0,a.next.length].concat(s()(i.getSelection()))),console.log("[stack] update selection",a.prev," -> ",a.next," (transaction: ".concat(r.transactionName,"#").concat(r.transactionFrame,")"));case 13:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),this.handleBeforeChange=function(e){if(!c.undoService.inUndoRedo){c.inTransaction=!0;var n=e.options.extra,r=(n=void 0===n?{}:n).undoSelection;if(r)c.prevSelectionQueue.push(r);else{var o=c.selectionAPI.getSelection();o.length&&c.prevSelectionQueue.push(o)}}},this.handleCompositionStart=function(){c.inComposition=!0},this.handleCompositionEnd=function(){c.inComposition=!1},this.getUndoDispatcher=function(){return c.undoDispatcher},this.undo=Gt()(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.inTransaction){e.next=2;break}return e.abrupt("return");case 2:c.undoDispatcher.undo();case 3:case"end":return e.stop()}}),e)}))),this.redo=Gt()(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c.inTransaction){e.next=2;break}return e.abrupt("return");case 2:c.undoDispatcher.redo();case 3:case"end":return e.stop()}}),e)}))),this.undoDispatcher=new kt.Hh((function(){r.dispatch("UPDATE_UNDO_HEADER")})),this.undoDispatcher.register(this.undoService),this.subs=[o.beforeChange$.subscribe(this.handleBeforeChange),o.change$.subscribe(this.handleChange)],r.addListener(pi.r.UNDO,this.checkAndUndo),r.addListener(pi.r.REDO,this.checkAndRedo)}return e=Object(Bo.a)(e,void 0,3)||e,e=Object(ce.a)()(e,void 0,3)||e,e=Object(u.VA)(e,void 0,2)||e,e=Object(fe.h)(e,void 0,1)||e,e=Object(vi.H)(e,void 0,0)||e,H()(e,[{key:"setEnable",value:function(e){this.enabled=e}},{key:"update",value:function(e){if(e.boundary!==this.boundary){var n,r,o,i,c=this.boundary;null===c||void 0===c||c.removeEventListener("compositionstart",this.handleCompositionStart),null===c||void 0===c||c.removeEventListener("compositionend",this.handleCompositionEnd),null===c||void 0===c||c.removeEventListener("keydown",this.handleKeyDown),null===c||void 0===c||c.removeEventListener("beforeinput",this.handleHistoryUndoRedo),null===(n=e.boundary)||void 0===n||n.addEventListener("compositionstart",this.handleCompositionStart),null===(r=e.boundary)||void 0===r||r.addEventListener("compositionend",this.handleCompositionEnd),null===(o=e.boundary)||void 0===o||o.addEventListener("keydown",this.handleKeyDown),null===(i=e.boundary)||void 0===i||i.addEventListener("beforeinput",this.handleHistoryUndoRedo),this.boundary=e.boundary}}},{key:"destroy",value:function(){this.update({}),this.undoDispatcher.unregister(this.undoService.id),this.subs.forEach((function(e){return e.unsubscribe()})),this.eventEmitter.removeListener(pi.r.UNDO,this.checkAndUndo),this.eventEmitter.removeListener(pi.r.REDO,this.checkAndRedo)}},{key:"addToUndoStack",value:function(e,n,r){var o=e.recordOps,i=e.options,c=i.from,a=i.mergeMode,l=o.map((function(e){var n=e.clone();return n.ops=n.ops.filter((function(e){return!(Object(kt.y)(e)&&(0===e.p.length||1===e.p.length&&"parent_id"===e.p[0]))})),n})),s=e.options;console.log("[stack]",r.prev," -> ",r.next," with options",s," (transaction: ".concat(s.transactionName,"#").concat(s.transactionFrame,", undoable: ").concat(n,", from: ").concat(c,")")),this.undoDispatcher.do(this.undoService.id,{operations:l,undoable:n,options:{selection:r,applyOptions:s},mergeMode:a})}},{key:"canUndo",get:function(){return this.undoDispatcher.canUndo}},{key:"canRedo",get:function(){return this.undoDispatcher.canRedo}},{key:"selectionAPI",get:function(){return this.context.get().selectionAPI}}]),e}(),fi=hi))||fi,xi=r("dx_w8Jj"),Ei=r("dx_P58d");function Si(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Ci,Ii,Bi,Ti,wi=Object(ce.s)(vi.H)((ki=function(e){G()(r,e);var n=Si(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),L()(e,"model",_i,W()(e)),e.inUndoRedo=!1,e.asyncEmit=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return new Promise((function(n){ln.N.emit.apply(ln.N,[e].concat(r,[n]))}))},e}return H()(r,[{key:"undo",value:function(){var e=Gt()(Wt.a.mark((function e(){var n,r,o,i,c,a,l=this,u=arguments;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>0&&void 0!==u[0]?u[0]:this._performUndoFactory(pi.I.undo),r=n()){e.next=4;break}return e.abrupt("return");case 4:if(o=r.options,!(i=r.operations)||!o){e.next=15;break}return this.inUndoRedo=!0,(c=Object.assign({},o.applyOptions,{transactionName:"undo"})).isInUndoRedo=!0,this.model.applyTransaction("undo",(function(e){i.forEach((function(n){var r=n.id,o=n.ops;e.apply(r,o)})),l.emit(pi.r.BEFORE_UNDO_REDO,i,e)}),c),e.next=12,Object(xi.i)();case 12:return e.next=14,this.asyncEmit(pi.r.AFTER_UNDO_REDO,i,o,Ei.q.Undo);case 14:this.inUndoRedo=!1;case 15:return o&&o.selection&&!(null===o||void 0===o?void 0:o.applyOptions.undoNotSetSelection)&&(a=o.selection.prev,this.emit(gn.D,s()(a),{source:Ei.q.Undo})),e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"redo",value:function(){var e=Gt()(Wt.a.mark((function e(){var n,r,o,i,c,a,l=this,u=arguments;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>0&&void 0!==u[0]?u[0]:this._performUndoFactory(pi.I.redo),r=n()){e.next=4;break}return e.abrupt("return");case 4:if(o=r.options,!(i=r.operations)||!o){e.next=15;break}return this.inUndoRedo=!0,(c=Object.assign({},o.applyOptions,{transactionName:"redo"})).isInUndoRedo=!0,this.model.applyTransaction("redo",(function(e){i.forEach((function(n){var r=n.id,o=n.ops;e.apply(r,o)})),l.emit(pi.r.BEFORE_UNDO_REDO,i,e)}),c),e.next=12,Object(xi.i)();case 12:return e.next=14,this.asyncEmit(pi.r.AFTER_UNDO_REDO,i,o,Ei.q.Redo);case 14:this.inUndoRedo=!1;case 15:return o&&o.selection&&(a=o.selection.next,this.emit(gn.D,s()(a),{source:Ei.q.Redo})),e.abrupt("return",r);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"emit",value:function(e){try{for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];ln.S.emit.apply(ln.S,[e].concat(r))}catch(i){console.error("[LarkUndoModule] handle event ".concat(e," error"),i)}}}]),r}(kt.b),mi=ki,_i=Z()(mi.prototype,"model",[u.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yi=mi))||yi;function Ri(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Mi=Object(u.H)({providers:[wi,Oi]})((Ti=function(e){G()(r,e);var n=Ri(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),L()(e,"undo",Bi,W()(e)),e}return H()(r,[{key:"init",value:function(){this.undo.update(this.options)}},{key:"destroy",value:function(){this.undo.destroy()}}]),r}(u.G),Ii=Ti,Bi=Z()(Ii.prototype,"undo",[ai.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ci=Ii))||Ci,ji=r("dx_qKh5"),Di=r("dx_B1B9"),Ai=r("dx_PQBD"),Pi=r("dx_OUFY"),Li=r("dx_TfZh"),Ni=r("dx_FvGq"),Fi=r("dx_zghO");function Ui(e){var n=e.selectionAPI,r=e.blockManager,o=_e.a.useState([]),i=$e()(o,2),c=i[0],a=i[1],l=_e.a.useState([]),s=$e()(l,2),u=s[0],d=s[1],f=_e.a.useState(!1),h=$e()(f,2),p=h[0],v=h[1],g=_e.a.useCallback((function(){var e=n.getContext(),o=(null===e||void 0===e?void 0:e.source)===Fi.q.TableHeader;o!==p&&v(o);var i=n.getSelection().filter((function(e){return r.hasBlockViewByBlockId(e.id)&&r.getBlockViewByBlockId(e.id).type===k.B.CELL})).map((function(e){return r.getBlockViewByBlockId(e.id)}));Object(tt.isEqual)(i,c)||a(i);var l=Object(Cn.G)(i,r);Object(tt.isEqual)(l,u)||d(l)}),[n,r,p,c,u]),b=function(){d([])},y=Object(Li.S)((function(){g()}),0),m=function(){var e=n.getSelection().filter((function(e){return r.hasBlockViewByBlockId(e.id)&&r.getBlockViewByBlockId(e.id).type===k.B.CELL})).map((function(e){return r.getBlockViewByBlockId(e.id)}));v(!0),a(e)};return _e.a.useEffect((function(){return c.forEach((function(e){r.addListener(Ni.D,y,e.id)})),function(){c.forEach((function(e){r.removeListener(Ni.D,y,e.id)}))}}),[r,c,y]),_e.a.useEffect((function(){return n.onSelectionChange(g),ln.N.on(gn.E,b),ln.N.on(ln.p.TABLE.TABLE_HEADER_CLICK,m),function(){n.offSelectionChange(g),ln.N.off(gn.E,b),ln.N.off(ln.p.TABLE.TABLE_HEADER_CLICK,m)}}),[n,g]),{cellBlocks:c,textualBlocks:u,isFromHeader:p}}var Hi=r("dx_Vau3"),Vi=r("dx_rR5J"),Wi=r("dx_zEdG"),zi=r("dx_CwnG");function Gi(e){var n=Object(me.useRef)(-1),r=Object(me.useRef)(!1),o=Object(me.useState)(Date.now()),i=$e()(o,2),c=i[0],a=i[1],l=Object(me.useRef)(e);Object(me.useEffect)((function(){l.current=e}),[e]);var s=Object(me.useCallback)((function(){r.current=!0,a(Date.now())}),[]),u=Object(me.useCallback)((function(){clearTimeout(n.current)}),[]),d=Object(me.useCallback)((function(){u(),r.current=!1,n.current=window.setTimeout(s)}),[s,u]);return Object(me.useEffect)((function(){return u}),[u]),Object(me.useEffect)((function(){r.current&&l.current&&(l.current(),r.current=!1)}),[c]),d}var Ki=r("dx_qGrX"),qi=r("dx_XW5M"),Xi=r("dx_d8dQ"),Yi=r("dx_Mzjv"),Ji=r("dx_z3zX"),Zi=r("dx_r3rH"),Qi=r("dx_Jo01"),$i=r("dx_IvU4"),ec=[0,14],tc=[!0,!1],nc={editable:!0},rc={className:"table-cell-toolbar"},oc=function(e){var n=e.visible,r=e.target,o=e.onClose,i=e.cellBlocks,c=e.blockManager,a=e.selectionAPI,l=e.boundary,s=e.fold,u=e.comment,d=Object(me.useMemo)((function(){return{cellBlocks:i}}),[i]),f=Object(Ki.S)(),p=$e()(f,2),v=p[0],g=Gi(p[1]),b=Object(Cn.I)(i,c);return Object(me.useEffect)((function(){n&&i[0]&&Object(Wi.T)("ccm_doc_web_text_bubble_toolbar_view",Object(zi.F)(i[0].id,c),{})}),[i,n,c]),Object(me.useEffect)((function(){Object(Zi.m)(n),$i.S.setPanelStatus(qi.t.TableCell,n)}),[n]),Object(me.useEffect)((function(){return function(){$i.S.setPanelStatus(qi.t.TableCell,!1),Object(Zi.m)(!1)}}),[]),_e.a.createElement(Ji.S,{visible:n,target:r,direction:Yi.R.TopCenter,reverse:!0,once:!0,offset:ec,sticky:tc,onClose:o,blockManager:c,selectionAPI:a,boundary:l,zIndex:h.S.isLarkFeed?Qi.d:Vi.M},_e.a.createElement(Xi.S,{panelType:qi.t.TableCell,contextBlocks:b,contextExtraProps:d,options:nc,forceUpdateRef:v,comment:u,menuProps:rc,keyboard:!1,blocks:b,fold:s,vertical:!0,type:"table_cell_toolbar",extraProps:i,onClick:g,onRefresh:g,source:Kr.G.web_text_bubble_toolbar,showDivider:!0,blockManager:c,selectionAPI:a,boundary:l}))};function ic(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function cc(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ic(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ic(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ac(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var lc,sc=function(e){G()(r,e);var n=ac(r);function r(){return F()(this,r),n.apply(this,arguments)}return H()(r,[{key:"getWrapper",value:function(e){var n=this;return function(r){var o=Ui({blockManager:n.blockManager,selectionAPI:n.selectionAPI}),i=o.cellBlocks,c=o.textualBlocks,a=o.isFromHeader,l=Object(me.useState)(null),s=$e()(l,2),u=s[0],d=s[1],f=Object(me.useCallback)((function(){return d(null)}),[]),h=Object(me.useCallback)((function(e){return i.find((function(n){return n.cellId===e}))}),[i]),p=Object(me.useMemo)((function(){return!1!==r.recursionProps.editable&&u&&i&&i.length&&c&&c.length&&!a&&i.every((function(e){return e.type===k.B.CELL}))}),[r,u,i,c,a]);Object(me.useEffect)((function(){if(i&&i.length&&c.length&&c){var e=i[0].parentId,o=r.blockId;if(e&&e===o){var a,l,s,u,f,p,v=i.map((function(e){return e.cellId})),g=n.blockManager.getRecordByBlockId(e).snapshot,b=Object(Cn.c)(g),y=Object(Cn.xp)({cellIds:v,layoutInfo:b,snapshot:g}),m=y.startRow,_=y.startCol,k=y.endRow,O=y.endCol,x=i.sort((function(e,n){return e.model.position-n.model.position}))[0].getHostRect().top,E=document.createRange();if(x<140)a=null===(s=h(b[k][_].sourceCellId))||void 0===s?void 0:s.hostElement,l=null===(u=h(b[k][O].sourceCellId))||void 0===u?void 0:u.hostElement;else a=null===(f=h(b[m][_].sourceCellId))||void 0===f?void 0:f.hostElement,l=null===(p=h(b[m][O].sourceCellId))||void 0===p?void 0:p.hostElement;a&&l?(E.setStart(a,0),E.setEnd(l,1),d(E)):d(null)}else d(null)}else d(null)}),[i,c]);var v=Object(me.useCallback)((function(e,r){u&&p&&(r!==i[0].parentId||Object(Ai.R)(r,n.blockManager,k.B.GRID_COLUMN)||ln.S.emit(ln.p.COMMON.UPDATE_OVERLAY_POSITION))}),[u,p,i]);Object(me.useEffect)((function(){return ln.S.on(Pi.o.ON_SCROLL,v),function(){ln.S.off(Pi.o.ON_SCROLL,v)}}),[v]);var g=Object(me.useMemo)((function(){return Boolean(u&&p&&n.comment)}),[u,p]),b={cellToolbarVisible:Boolean(u&&p)};return _e.a.createElement(_e.a.Fragment,null,_e.a.createElement(e,cc(cc({},r),b)),_e.a.createElement(oc,{visible:g,target:u,onClose:f,cellBlocks:i,blockManager:n.blockManager,selectionAPI:n.selectionAPI,boundary:n.boundary,fold:n.fold,comment:n.comment}))}}}]),r}(Hi.A),uc=r("dx_vE74"),dc=r("dx_yU7P"),fc=r("dx_bbfH"),hc=r("dx_tq79"),pc=r("dx_fiWO"),vc={className:"table-popover-toolbar"},gc=(lc={},_t()(lc,Yi.R.LeftCenter,[12,0]),_t()(lc,Yi.R.RightCenter,[12,0]),_t()(lc,Yi.R.TopCenter,[0,12]),_t()(lc,Yi.R.BottomCenter,[0,12]),lc),bc=function(e){var n=e.visible,r=e.cellBlocks,o=e.target,i=e.popoverStatus,c=e.direction,a=e.onClose,l=e.forceUpdatePopoverItemsRef,s=e.updatePopoverItemsInNextEffect,u=e.blockManager,d=e.selectionAPI,f=e.boundary,h=e.fold,p=e.comment,v=Object(uo.useSelector)(et.selectors.share.ifhaveCommentPermission),g=Object(Cn.I)(r,u);Object(me.useEffect)((function(){return Object(Zi.z)(n),$i.S.setPanelStatus(qi.t.PopoverMenu,n),function(){n&&(Object(Zi.z)(!1),$i.S.setPanelStatus(qi.t.PopoverMenu,!1))}}),[n]);var b=Object(me.useCallback)((function(){s()}),[s,a]),y=Object(me.useMemo)((function(){return{cellBlocks:r,popoverStatus:i}}),[r,i]),m=Object(me.useMemo)((function(){return{editable:!0,commentable:v}}),[v]);return _e.a.createElement(Ji.S,{visible:n,target:o,blockManager:u,selectionAPI:d,boundary:f,direction:c,offset:gc,reverse:!0,sticky:!1,onClose:a,zIndex:Vi.M},_e.a.createElement(Xi.S,{panelType:qi.t.PopoverMenu,contextBlocks:g,contextExtraProps:y,options:m,forceUpdateRef:l,menuProps:vc,comment:p,keyboard:!1,blocks:g,fold:h,vertical:!0,type:"table-popover-toolbar",extraProps:y,onClick:b,blockManager:u,selectionAPI:d,boundary:f}))};function yc(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var mc=ar()("table:popover"),_c=function(e){G()(r,e);var n=yc(r);function r(){return F()(this,r),n.apply(this,arguments)}return H()(r,[{key:"getWrapper",value:function(e){var n=this;return function(r){var o=r.model.id,i=r.editorAPI.getService(Zr.S),c=r.scrollManage,a=Ui({blockManager:n.blockManager,selectionAPI:n.selectionAPI}),l=a.cellBlocks,s=a.textualBlocks,u=a.isFromHeader,d=_e.a.useState(Yi.R.TopCenter),f=$e()(d,2),h=f[0],p=f[1],v=_e.a.useState(null),g=$e()(v,2),b=g[0],y=g[1],m=_e.a.useState(null),_=$e()(m,2),O=_[0],x=_[1],E=Object(me.useState)(!1),S=$e()(E,2),C=S[0],I=S[1],B="table=".concat(o," "),T=_e.a.useCallback((function(e){var n;if(e.target){var r=e.target,c=r.closest(".docx-table-block"),a=(null===c||void 0===c||null===(n=c.dataset)||void 0===n?void 0:n.blockId)===o.toString();mc("%sstart hiding when %s %s, currentTable=%s",B,e.type,e.target,a),a&&Object(uc.Q)(r,fc.N)?mc("%sskip hiding when clicked on keeping-popover classes",B):(i.clearSelection("popoverToolbar.hide"),y(null),mc("%shided",B))}}),[o,B,i]),w=Object(me.useMemo)((function(){return!C&&u&&b&&s.length&&l.length&&l.every((function(e){return e.type===k.B.CELL}))}),[C,b,u,s,l]),R=Object(Ki.S)(),M=$e()(R,2),j=M[0],D=Gi(M[1]),A=Object(dc.r)((function(){if(l.length&&s.length){var e=l[0].parentId;if(e&&e===o){if(D(),u){var r="column"===O?Yi.R.TopCenter:Yi.R.LeftCenter,i=Object(hc.y)(n.blockManager,o);if(!i)return;p(r),y(i)}}else y(null)}else y(null)}));Object(me.useEffect)((function(){A()}),[l,s,u,o,A]);var P=Object(me.useCallback)((function(e,r){b&&w&&(r!==l[0].parentId||Object(Ai.R)(r,n.blockManager,k.B.GRID_COLUMN)||ln.N.emit(ln.p.COMMON.UPDATE_OVERLAY_POSITION))}),[b,w,l]);Object(me.useEffect)((function(){if(c)return ln.N.on(Pi.o.ON_SCROLL,P),function(){ln.N.off(Pi.o.ON_SCROLL,P)}}),[P,c]);var L=Object(me.useMemo)((function(){return Boolean(b&&w&&n.comment)}),[b,w]);Object(me.useEffect)((function(){L||Object(pc.l)({tableId:o,willDelete:!1,caller:"popoverToolbar.hide"})}),[o,L]),mc("%srender: visible=%s, %s && %s && %s && %s && %s, collapsedRange=%s",B,w,!C,u,b,l.length,s.length,null===b||void 0===b?void 0:b.collapsed);var N={setPopoverStatus:x,popoverStatus:O,setIsPopoverToolbarHide:I};return _e.a.createElement(_e.a.Fragment,null,_e.a.createElement(e,Object.assign({},r,N,{boundary:n.boundary})),_e.a.createElement(bc,{visible:L,target:b,cellBlocks:l,popoverStatus:O,direction:h,onClose:T,forceUpdatePopoverItemsRef:j,updatePopoverItemsInNextEffect:D,blockManager:n.blockManager,selectionAPI:n.selectionAPI,boundary:n.boundary,fold:n.fold,comment:n.comment}))}}}]),r}(Hi.A),kc=r("dx_bvq6"),Oc=r("dx_nesn");function xc(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Ec(){return e=[[Ge.v],[kc.O]],h.S.isFeishuRooms?Object(Ke.B)([[Ge.v]]):h.S.isOpendoc?Object(Ke.B)([[kc.O]]):Object(Ke.B)(e);var e}function Sc(){return[].concat(s()(Object(Ke.t)()),s()(Ec()))}function Cc(e){return function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?xc(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xc(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({},e)}var Ic=r("dx_vLvZ"),Bc=r("dx_SreQ"),Tc=r("dx_r2rw"),wc=r("dx_Otwn"),Rc=r("dx_VjTN"),Mc=r("dx_HbDg"),jc=r("dx_H6o9"),Dc=r("dx_TKhc"),Ac=r("dx_uQZk"),Pc=r("dx_VmtY");r("dx_xYlW");function Lc(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Nc="focus-editor-hidden-input",Fc=function(e){G()(r,e);var n=Lc(r);function r(){return F()(this,r),n.apply(this,arguments)}return H()(r,[{key:"getEffect",value:function(){var e=this;return function(){var n=Object(me.useCallback)((function(){e.selectionAPI.getSelection().length>0&&e.options.boundary.classList.remove(Nc)}),[]),r=Object(me.useCallback)((function(){e.options.boundary.classList.add(Nc)}),[]);Object(me.useEffect)((function(){return e.selectionAPI.onSelectionChange(n),ln.S.on(ln.p.COMMON.RESTORE_FOCUS,r),function(){e.selectionAPI.offSelectionChange(n),ln.S.off(ln.p.COMMON.RESTORE_FOCUS,r)}}),[n,r])}}}]),r}(Hi.A),Uc=r("dx_dRZF"),Hc=r("dx_O7R4"),Vc=r("dx_cEo5"),Wc=r("dx_LcNA"),zc=r("dx_e4eN"),Gc=r("dx_MoY1"),Kc=r("dx_Z7ZC"),qc=r("dx_SpiB"),Xc=r("dx_c0wU"),Yc=r("dx_F81q"),Jc=r("dx_A7Ap"),Zc=r("dx_D0JG"),Qc=r("dx_ZG9w"),$c=r("dx_bPy9"),ea=r("dx_iSIC"),ta=r("dx_MWo5"),na=r("dx_z0z2"),ra=r("dx_PIlC"),oa=r("dx_i44h"),ia=r("dx_Elol"),ca=r("dx_cGa6"),aa=r("dx_kZ3l"),la=r("dx_e6eH"),sa=r("dx_r61a");function ua(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function da(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ua(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ua(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var fa,ha=function(e){var n=e.replaceWithLine,r=e.match.rangeToReplace;n((function(e){var n=e.snapshot,o=[];o.push({parent_id:n.parent_id,type:k.B.DIVIDER,author:et.userHelper.getCurrentUser().get("id")});var i=e.model.zoneState,c=aa.j(e,[r[1],i.totalWidth()]),a=i.slice(c.start,c.end).toAttributeText();return o.push(Object.assign({},n,{text:a})),o}))},pa=function(e,n){return new RegExp("".concat(e,"{2,}.+").concat(e,"{2,}\\s")).test(n)?null:new RegExp("".concat(e,"([^\\s").concat(e,"]+[^").concat(e,"]*[^\\s").concat(e,"]+)").concat(e,"\\s")).exec(n)},va={name:"code",replaceTriggerKey:!0,triggerKey:" ",match:function(e){var n=e.match(/[`\xb7]{3}(\S*)(?:\s|Enter)/);return n?{rangeToReplace:[0,n[0].length],rangeAfterReplace:[0,0],leftMatchKeyLength:3,language:n[1]}:null},action:function(e){var n=e.replaceWithLine,r=e.match;n((function(e){var n=e.snapshot,o=e.model.zoneState.remove(r.rangeToReplace),i=Object(ea.Y)(o,e.blockManager.recordManager),c=o.applyDeltaWithClone(i).toAttributeText();return Object.assign({},n,{text:c,type:"code",language:Object(ta.h)(r.language,localStorage.getItem(na.i)||na.E)})}))},blockType:k.B.CODE},ga={name:"equation",replaceTriggerKey:!0,triggerKey:"$",match:function(e){var n;if(!Object(oa.h)())return null;var r=/\$\$(\S|\S+.*\S+)\$\$|\${4}/.exec(e);if(!r)return null;var o=r.index||0,i=r[1]||"\n";return{rangeToReplace:[o,o+(((null===(n=r[1])||void 0===n?void 0:n.length)||0)+4)],rangeAfterReplace:[o,o+1],text:i,leftMatchKeyLength:2}},action:function(e){var n=e.match,r=e.replaceWithInline,o=n.text||"\n",i=Object(or.I)(8),c=!0;"\n"===o&&(ze.h.toolboxInsertEquationSet.add(i),c=!1),ze.h.initEquationSet.add(i),r([{text:" ",mark:{author:et.userHelper.getCurrentUser().get("id"),equation:o,objectID:i}}],c),Object(ra.U)(ra.n.ADD)},blockType:k.B.TEXT},ba=[{name:"heading",replaceTriggerKey:!0,triggerKey:" ",match:function(e,n,r){var o=n.type,i=/^(#{1,9}\s)(\S*|\S+[\s\S]*)$/.exec(e),c={leftMatchKeyLength:1,rangeAfterReplace:[0,0]};if(i)return(i[1].length-1).toString()===o.split("heading")[1]?null:(c.rangeToReplace=[0,i[1].length],c.level=i[1].length-1,c);if(Object(la.Q)()&&k.O.includes(o)){var a=e.replace(/\u3002/g,"."),l=/^((\d+[.\u3002]+)+\s)([\s\S]*)$/.exec(a);if(l){var s;c.rangeToReplace=[0,l[1].length];var u=a.trim().split("."),d=parseInt(u[u.length-2],10);if("0"===u[0]||Number.isNaN(d)||0===d)return null;var f=null===r||void 0===r||null===(s=r.headingModule)||void 0===s?void 0:s.getMarkdownAfterInsertInfo(n.id,u);return c.seq=f.seq,c.seq_level=f.seqLevel,c}}return null},action:function(e){var n=e.match,r=e.replaceWithLine,o=n.level,i=void 0===o?void 0:o,c=n.seq,a=void 0===c?void 0:c,l=n.seq_level,s=void 0===l?void 0:l;r((function(e){var r=e.snapshot,o=e.model.zoneState.remove(n.rangeToReplace).toAttributeText(),c={},l=!1;return i&&(c.type="heading".concat(i)),(a||s)&&(c.seq=String(a),c.seq_level=String(s),l=Boolean(r.folded)),Object.assign({},r,da({text:o,folded:l},c))}))},blockType:k.B.HEADING1},{name:"quote-container",replaceTriggerKey:!0,triggerKey:" ",match:function(e){var n=/^[>|\u300b]\s$/.exec(e);return n?{leftMatchKeyLength:1,rangeToReplace:[0,n[0].length],rangeAfterReplace:[0,0]}:null},action:function(e){var n=e.match;(0,e.replaceWithLine)((function(e){var r=e.snapshot,o=e.model.zoneState.remove(n.rangeToReplace).toAttributeText();return Object.assign({},r,{text:o,type:k.B.QUOTE_CONTAINER})}))},blockType:k.B.QUOTE_CONTAINER},{name:"bold",triggerKey:" ",match:function(e){var n=/\*\*(\S|\S+.*\S+)\*\*\s/.exec(e);return n?{leftMatchKeyLength:2,rangeToReplace:[n.index,n.index+(n[1].length+4)],rangeAfterReplace:[n.index,n.index+n[1].length],text:n[1]}:null},action:function(e){var n=e.match;(0,e.replaceWithInline)([{text:n.text,mark:{bold:"true"}}])},blockType:k.B.TEXT},{name:"italic",triggerKey:" ",match:function(e){var n=pa("\\*",e);return n?{leftMatchKeyLength:1,rangeToReplace:[n.index,n.index+(n[1].length+2)],rangeAfterReplace:[n.index,n.index+n[1].length],text:n[1]}:null},action:function(e){var n=e.match;(0,e.replaceWithInline)([{text:n.text,mark:{italic:"true"}}])},blockType:k.B.TEXT},{name:"strikethrough",triggerKey:" ",match:function(e){var n=/~~(\S|\S+.*\S+)~~\s/.exec(e);return n?{leftMatchKeyLength:2,rangeToReplace:[n.index,n.index+(n[1].length+4)],rangeAfterReplace:[n.index,n.index+n[1].length],text:n[1]}:null},action:function(e){var n=e.match;(0,e.replaceWithInline)([{text:n.text,mark:{strikethrough:"true"}}])},blockType:k.B.TEXT},{name:"underline",triggerKey:" ",match:function(e){var n=pa("~",e);return n?{leftMatchKeyLength:1,rangeToReplace:[n.index,n.index+(n[1].length+2)],rangeAfterReplace:[n.index,n.index+n[1].length],text:n[1]}:null},action:function(e){var n=e.match;(0,e.replaceWithInline)([{text:n.text,mark:{underline:"true"}}])},blockType:k.B.TEXT},{name:"inlineCode",triggerKey:"`",replaceTriggerKey:!0,match:function(e,n,r){var o=r?r.formattedText:null,i=/(`)(\S*|\S+[\s\S]*)(`)/.exec(o||e),c=i&&i[2];return i&&c&&"`"!==c?{leftMatchKeyLength:1,rangeToReplace:[i.index,i.index+(i[2].length+2)],rangeAfterReplace:[i.index,i.index+i[2].length],text:e.slice(i.index+1,i.index+(i[2].length+2)-1)}:null},action:function(e){var n=e.match;(0,e.replaceWithInline)([{text:n.text,mark:{inlineCode:"true"}}])},blockType:k.B.TEXT},{name:"inlineCode",triggerKey:"\xb7",replaceTriggerKey:!0,match:function(e){var n=/(\xb7+)(\S+.*\S+)(\xb7+)/.exec(e);return n?{leftMatchKeyLength:1,rangeToReplace:[n.index,n.index+(n[2].length+2)],rangeAfterReplace:[n.index,n.index+n[2].length],text:n[2]}:null},action:function(e){var n=e.match;(0,e.replaceWithInline)([{text:n.text,mark:{inlineCode:"true"}}])},blockType:k.B.TEXT},{name:"divider",triggerKey:"-",replaceTriggerKey:!0,match:function(e){var n=/^([-]{3})([\s\S])*/.exec(e);return n?{leftMatchKeyLength:3,rangeToReplace:[0,n[1].length],rangeAfterReplace:[0,0]}:null},action:ha,blockType:k.B.DIVIDER},{name:"divider",triggerKey:"*",replaceTriggerKey:!0,match:function(e){var n=/^([*]{3})([\s\S])*/.exec(e);return n?{leftMatchKeyLength:3,rangeToReplace:[0,n[1].length],rangeAfterReplace:[0,0]}:null},action:ha,blockType:k.B.DIVIDER},{name:"bullet",replaceTriggerKey:!0,triggerKey:" ",match:function(e,n){if(n.type===k.B.BULLET)return null;var r=/([-*]\s)([\s\S]*)/.exec(e);return r?{leftMatchKeyLength:1,rangeToReplace:[0,r[1].length],rangeAfterReplace:[0,0]}:null},action:function(e){var n=e.replaceWithLine,r=e.match;n((function(e){var n=e.snapshot,o=e.model.zoneState.remove(r.rangeToReplace).toAttributeText();return Object.assign({},n,{text:o,type:"bullet",folded:!1})}))},blockType:k.B.BULLET},{name:"ordered",replaceTriggerKey:!0,triggerKey:" ",match:function(e,n){var r=n.type;if(k.O.includes(r)||r===k.B.TODO||r===k.B.ORDERED)return null;var o=/(\d+[.\u3002]\s)([\s\S]*)/.exec(e);if(!o)return null;var i=parseInt(o[1],10);return i<=0?null:{leftMatchKeyLength:o[1].length,rangeToReplace:[0,o[1].length],rangeAfterReplace:[0,0],seq:i<=sa.h?i:1}},action:function(e){var n=e.replaceWithLine,r=e.match;n((function(e){var n=e.snapshot,o=e.model.zoneState.remove(r.rangeToReplace).toAttributeText();return Object.assign({},n,{text:o,type:"ordered",folded:!1,seq:String(r.seq)})}))},blockType:k.B.ORDERED},{name:"todo",replaceTriggerKey:!0,triggerKey:" ",match:function(e,n){var r=n.type,o=/((\[]\s)|(\u3010\u3011\s))([\s\S]*)/.exec(e);return o&&r!==k.B.TODO?{leftMatchKeyLength:2,rangeToReplace:[0,o[1].length],rangeAfterReplace:[0,0],done:4===o[0].length}:null},action:function(e){var n=e.replaceWithLine,r=e.match;n((function(e){var n=e.snapshot,o=e.model.zoneState.remove(r.rangeToReplace).toAttributeText();return Object.assign({},n,{text:o,type:"todo",align:"",done:r.done})}))},blockType:k.B.TODO},{name:"task",replaceTriggerKey:!0,triggerKey:" ",match:function(e,n){if(!Object(ca.Q)()||Object(ia.f)(n.id,n.blockManager))return null;var r=/((\]\]\s)|(\u3011\u3011\s))([\s\S]*)/.exec(e);return r?{leftMatchKeyLength:2,rangeToReplace:[0,r[1].length],rangeAfterReplace:[0,0]}:null},action:function(e){var n=e.replaceWithLine,r=e.match;n((function(e){var n=e.model.snapshot,o=e.model.zoneState.remove(r.rangeToReplace).toAttributeText();return Object.assign({},n,{text:o,type:k.B.TASK,task_id:""})}))},blockType:k.B.TASK},va,da(da({},va),{},{triggerKey:"Enter"}),ga];fa="heading",ba.find((function(e){return e.name===fa}));function ya(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return ma(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ma(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function ma(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function _a(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function ka(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?_a(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_a(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Oa(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var xa=function(e){G()(r,e);var n=Oa(r);function r(){return F()(this,r),n.apply(this,arguments)}return H()(r,[{key:"getEffect",value:function(){var e=this,n=ba,r=Object(tt.uniq)(n.map((function(e){return e.triggerKey}))),o=[].concat(s()(k.O),s()(k.BM),[k.B.TEXT,k.B.QUOTE]);return function(i){var c=Object(me.useRef)(),a=Object(me.useRef)(),l=Object(me.useState)(null),s=$e()(l,2),d=s[0],f=s[1];Object(me.useEffect)((function(){var n=e.blockManager.getBlockViewByBlockIdNotCheck(i.blockId);n?Object(Qc.f)(n)&&o.includes(n.type)&&(a.current=n,f(a.current)):f(null)}),[i.hostBlock]);var p=Object(me.useCallback)(function(){var n=Gt()(Wt.a.mark((function n(r,o,i){var c,a,l,s,f,h,p,v,g=arguments;return Wt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=g.length>3&&void 0!==g[3]?g[3]:0,d){n.next=3;break}return n.abrupt("return");case 3:if(a=e.blockManager,l=e.selectionAPI,s=[c+i.rangeToReplace[0],c+i.rangeToReplace[1]],f=[c+i.rangeAfterReplace[0],c+i.rangeAfterReplace[1]],h=function(){var e=Gt()(Wt.a.mark((function e(){var n;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.replaceTriggerKey?s[1]-1:s[1],e.next=3,a.applyTransaction("insertTriggerKey",(function(e){var r=d.model,i=r.zoneState,c=r.zoneId,a=i.applyDeltaWithClone(new zc.m({zoneId:c}).retain(Math.min(i.getModelText().length-1,n)).insert(o.triggerKey)).toAttributeText();Object(Kc.w)(e,d.record,a)}));case 3:d.model.setSelection({start:s[1],len:0},!0),l.setSelection([{id:d.id,type:Fi.j.TEXT,selection:{start:s[1],end:s[1]}}],{source:Fi.q.TextSelection,syncBrowser:!1});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),p=function(){var e=Gt()(Wt.a.mark((function e(n){var r,o,i,c,l,s,f,h,p,v,g,b,y,m;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.V,o=a.getBlockModelByBlockId(d.id),i=null===o||void 0===o?void 0:o.parent,c=[],o&&i){e.next=6;break}return e.abrupt("return");case 6:if("function"===typeof n&&(n=n(d)),c=Array.isArray(n)?n:[n],l=k.O.includes(d.type)&&!o.record.snapshot.seq&&c[0].seq,Object(Kr.Fi)({actionObject:qr.u.BLOCK,source:Kr.G.content_page,blockManager:a,click:Kr.c.markdown_action,actionType:l?"heading_auto_num_ordered":c[0].type,blocks:[d],actionValue:{value1:"true"}}),s=o.parent,f=null===s||void 0===s?void 0:s.record.id,h={mergeMode:kt.f.SPLIT,from:kt.H.local},1!==c.length){e.next=22;break}return p=c[0],v=p.type,p.children,g=Vo()(p,["type","children"]),e.next=17,Object(ea.S)(d,a,v,g,h,void 0,"singleLineFromMarkdown");case 17:b=e.sent,y=$e()(b,1),r=y[0],e.next=31;break;case 22:if(c[0].type!==k.B.DIVIDER){e.next=27;break}return e.next=25,a.applyTransaction("replaceWithLine:divider",(function(e){e.replace(d.record.id,["text"],c[1].text),Object(Gc.l)(e,f,o.position,c.slice(0,1)),r=d.id}),h);case 25:e.next=31;break;case 27:if(!s){e.next=31;break}return e.next=30,a.applyTransaction("replaceWithLine",(function(e){e.replace(d.record.id,[],c[0]);var n=Object(Gc.l)(e,f,o.position+1,c.slice(1));c.forEach((function(r,o){var i;0!==o&&(null===(i=r.children)||void 0===i||i.forEach((function(r){e.replace(r,["parent_id"],n[o-1])})))}))}),h);case 30:r=s.children[o.position+c.length-1].id;case 31:if(r){e.next=33;break}return e.abrupt("return");case 33:m=a.getBlockViewByBlockId(r),Object(Qc.U)(m)&&m.model.setSelection({start:0,len:0},!0),ln.S.emit(gn.e,{operation_method:gn.mu.MARKDOWN,source:"other",action:c[0].type,block_id:d.id,blockManager:a});case 36:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),v=function(){var e=Gt()(Wt.a.mark((function e(n){var r,c,l=arguments;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(l.length>1&&void 0!==l[1])||l[1],e.next=3,a.applyTransaction("replaceWithInline",(function(e){var r={};r=Array.isArray(n)?n.map((function(e){return e.mark})).reduce((function(e,n){return ka(ka({},e),n)}))||{}:n.mark||{};var o=Array.isArray(n)?n.map((function(e){return e.text})).reduce((function(e,n){return e+n})):n.text,c=i.rangeToReplace[0]+i.leftMatchKeyLength,a=o.length,l=d.model.zoneState,u=d.model.zoneId,f=new zc.m({zoneId:u}).retain(s[0]).delete(s[1]-s[0]);if(" "===o&&r.equation)f=f.insert(o,Object.assign({},r));else{var h,p=ya(l.getEntities([]));try{for(p.s();!(h=p.n()).done;){var v=h.value,g=void 0;c>0?(g=v.text.substr(c),c-=v.text.length):g=v.text,a<g.length&&(g=g.substr(0,a)),a-=g.length,g&&(f=f.insert(g,Object.assign({},v.attributes,r)))}}catch(b){p.e(b)}finally{p.f()}}l=l.applyDeltaWithClone(f),e.replace(d.record.id,["text"],l.toAttributeText())}),{mergeMode:kt.f.SPLIT});case 3:r&&d.model.setSelection({start:f[1]+(o.replaceTriggerKey?0:1),len:0},!0),c=Array.isArray(n)?n[0]:n,Object(Kr.Fi)({actionObject:qr.u.TEXT,source:Kr.G.content_page,blockManager:a,click:Kr.c.markdown_action,actionType:c.mark,blocks:[d],actionValue:{value1:"true"}}),c.mark&&ln.S.emit(gn.e,{operation_method:gn.mu.MARKDOWN,source:"other",action:Object.keys(c.mark).join("_"),block_id:d.id,blockManager:a});case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),r){n.next=12;break}return n.next=12,h();case 12:o.action({match:i,replaceWithLine:p,replaceWithInline:v});case 13:case"end":return n.stop()}}),n)})));return function(e,r,o){return n.apply(this,arguments)}}(),[d]),v=Object(me.useMemo)((function(){return!!d&&Object(Xc.K)(d.id,e.blockManager)}),[d]),g=Object(me.useMemo)((function(){return!!d&&Object(Ai.R)(d.id,e.blockManager,k.B.PROGRESS)}),[null===d||void 0===d?void 0:d.id]),b=Object(me.useMemo)((function(){return!!d&&Object(Jc.T)(e.blockManager,d.id)}),[d]),y=Object(me.useCallback)((function(e,r){var o;if(d){var c="Enter"===r?"\n":r,a=d.model.zoneState,l=null===(o=d.model.getSelection())||void 0===o?void 0:o.toPosition();if(l){var s,u=a.getModelText().slice(0,l.start)+(e?"":c),f={},h=ya(n);try{for(h.s();!(s=h.n()).done;){var y=s.value;if((!v||qc.Lj[y.blockType])&&((!g||k.B3.includes(y.blockType))&&(!b||Yc.r[y.blockType]))){var m=Object($c.y)(a.getContent()).join("");e||(m=m.slice(0,l.start)+c+m.slice(l.start)),f.formattedText=m,f.headingModule=i.recursionProps.headingModule;var _=y.match(u,d,f);if(_){var O=y.blockType!==k.B.TEXT||y.replaceTriggerKey?0:1;if(!(_.rangeToReplace[1]+O===l.start+(e?0:c.length)))break;var x=new Vc.e({zoneId:d.model.zoneId,editor:d.editor,start:_.rangeToReplace[0],len:_.rangeToReplace[1]-_.rangeToReplace[0]}).toRange();if(Object($c.G)(a,x)[y.name])break;return p(e,y,_),!0}}}}catch(E){h.e(E)}finally{h.f()}}}}),[d,v,p]),m=Object(me.useCallback)((function(e){if(d){var n=e.data||"";"insertParagraph"===e.inputType&&(n="Enter");var o=d.model.getSelection();if(!c.current&&(null===o||void 0===o?void 0:o.isCollapsed())&&r.includes(n))y(!1,n)&&e.preventDefault()}}),[d,y]),_=Object(me.useCallback)((function(e){if(d&&(!h.S.isSafari||"Enter"===e.key)){var n=d.model.getSelection(),o=e.key,i="keydown"===e.type;if(!(c.current||!(null===n||void 0===n?void 0:n.isCollapsed())||i&&!r.includes(o)||!i&&"Unidentified"!==o))y(!i,o)&&i&&(e.preventDefault(),"Enter"===e.key&&(e.preventEvent(),e.stopEvent()))}}),[d,y]),O=Object(me.useCallback)((function(){c.current=!0}),[]),x=Object(me.useCallback)((function(e){c.current=!1,h.S.isWindows&&r.includes(e.data)&&y(!0,e.data)}),[y]);Object(me.useEffect)((function(){if(d&&d.editor){var e=d.editor;h.S.isSafari&&e.on(Wc.L.BEFORE_INPUT,m);var n=d.model.zoneId;return e.on(Zc.f.ENTER,_,{zoneId:n}),e.on(Wc.L.KEYDOWN,_,{zoneId:n}),e.on(Wc.L.KEYUP,_,{zoneId:n}),e.on(Wc.L.COMPOSITION_START,O,{zoneId:n}),e.on(Wc.L.COMPOSITION_END,x,{zoneId:n}),function(){h.S.isSafari&&e.off(Wc.L.BEFORE_INPUT,m),e.off(Zc.f.ENTER,_),e.off(Wc.L.KEYDOWN,_),e.off(Wc.L.KEYUP,_),e.off(Wc.L.COMPOSITION_START,O),e.off(Wc.L.COMPOSITION_END,x)}}}),[d,x,O,_,m])}}}]),r}(Hi.A),Ea=r("dx_Q5XO"),Sa=r("dx_KFmR");function Ca(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Ia=ar()("RootEditableSetter"),Ba=function(e){G()(r,e);var n=Ca(r);function r(){return F()(this,r),n.apply(this,arguments)}return H()(r,[{key:"getEffect",value:function(){var e=this;return function(){if(h.S.isIOS){var n=e.blockManager,r=Object(uo.useSelector)(Ea.R),o=function(){var e=Object(me.useState)(document.activeElement),n=$e()(e,2),r=n[0],o=n[1],i=function(e){o(document.activeElement),Ia("set active element",document.activeElement)};return Object(me.useEffect)((function(){return document.addEventListener("focus",i,!0),document.addEventListener("blur",i,!0),function(){document.removeEventListener("focus",i,!0),document.removeEventListener("blur",i,!0)}}),[]),r}(),i=function(e){var r=document.querySelector("[data-content-editable-root]"),o="true"===r.contentEditable,i=!!Object(Sa.z)(n);if(o&&!e)Ia("set root can not editable"),r.contentEditable="false",Ia("set root blur"),r.blur();else if(!o&&e){Ia("set root editable"),r.contentEditable="true";var c=document.activeElement;if((null===c||void 0===c?void 0:c.closest('[contenteditable="false"]'))||i)return;Ia("set root focus"),r.focus({preventScroll:!0})}},c=Object(me.useMemo)((function(){return Object(tt.debounce)((function(o,c){if(!r)return i(!1),void Ia("is not editing, set root not editable");var a=!!Object(Sa.z)(n);a&&Ia("is editing but focus at third editor"),e.selectionAPI.isTextSelectionAcrossBlocks(c)||e.selectionAPI.isSingleTextSelection(c)||a?i(!0):i(!1)}),80)}),[r]);Object(me.useEffect)((function(){return e.selectionAPI.onSelectionChange(c),function(){e.selectionAPI.offSelectionChange(c)}}),[c]),Object(me.useEffect)((function(){if(!r)return i(!1),void Ia("is not editing, set root not editable")}),[r]),Object(me.useEffect)((function(){setTimeout((function(){!!Object(Sa.z)(n)&&(Ia("is editing but focus at third editor"),i(!0))}),300)}),[o])}}}}]),r}(Hi.A),Ta=r("dx_VXD2"),wa=r("dx_DX3a");function Ra(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Ma="ccm_doc_performance_delete_keydown_to_paint_dev",ja="ccm_doc_performance_return_keydown_to_paint_dev",Da="ccm_doc_performance_soft_return_keydown_to_paint_dev",Aa="ccm_doc_performance_keydown_to_paint_dev",Pa="ccm_doc_performance_composition_end_to_paint_dev",La=[17,18,91,93,38,40,37,39,16],Na=function(e){G()(r,e);var n=Ra(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).profileState=new Map,e.inComposition=!1,e.lastCollectTimestamp=0,e.profileContext={},e.isPerformCapitalization=!1,e.applyAllDone=!1,e.resetProfileState=function(){[Ma,ja,Da,Aa,Pa].forEach((function(n){e.profileState.set(n,{totalKeyCodes:0,inStateKeyCodes:0,inState:!1})}))},e.startProfile=function(n){var r={isComposeAcceptable:!1,beforeEnd:e.handleBeforeEnd,beforeSend:e.handleBeforeSend,conditionSampleRate:function(e){return e.usedTime>100?1:.2}};e.profile.start(n);var o=performance.now(),i=o-e.lastCollectTimestamp<3e4;i||(e.lastCollectTimestamp=o,e.profileContext=Object(wa.o)(e.blockManager,e.comment));var c=Object.assign({lineType:e.getLineType(),applyType:e.getApplyType(n),profileContextFromCache:i,applyAllDone:e.applyAllDone,fg:{allow_pre_edit:un.w}},e.profileContext);Aa===n&&Object.assign(c,{inComposition:e.inComposition}),e.profile.pushData(n,c),e.profile.endByNextRender(n,r)},e.getLineType=function(){var n=e.selectionAPI.getSelection().map((function(n){return e.blockManager.getBlockViewByBlockId(n.id).type}));return n.length?n.join(", "):""},e.getApplyType=function(n){var r,o,i=e.selectionAPI.getSelection(),c=1===i.length&&!i.some((function(e){return e.type!==Fi.j.TEXT}));return(!c||n!==Ma||(null===(r=i[0].selection)||void 0===r?void 0:r.start)||(null===(o=i[0].selection)||void 0===o?void 0:o.end))&&c?Fi.j.TEXT:Fi.j.BLOCK},e.handleBeforeEnd=function(n,r){e.isPerformCapitalization&&(r.extraData||(r.extraData={}),r.extraData.isPerformCapitalization=e.isPerformCapitalization,e.isPerformCapitalization=!1);var o=e.profileState.get(n);o.totalKeyCodes+=o.inStateKeyCodes,o.inStateKeyCodes=0,o.inState=!1},e.handleBeforeSend=function(n){var r=e.profileState.get(n),o=r.totalKeyCodes;return r.totalKeyCodes=r.inStateKeyCodes,{key_code_count:o}},e}return H()(r,[{key:"getEffect",value:function(){var e=this,n=this.selectionAPI,r=this.eventEmitter,o=this.profile,i=Object(Ta.s)(),c=function(r){if(o){var i=r.type,c=r.keyCode;if(!(La.indexOf(c)>-1)&&"keydown"===i&&n.isFocus()){var a=n.getSelection(),l=1===a.length&&!a.some((function(e){return e.type!==Fi.j.TEXT})),s=e.profileState.get(Ma),u=e.profileState.get(ja),d=e.profileState.get(Da);if(!e.inComposition){var f=13===c;8===c&&!s.inState&&(e.startProfile(Ma),s.inState=!0),l&&f&&!r.shiftKey&&!u.inState&&(e.startProfile(ja),u.inState=!0),l&&f&&r.shiftKey&&!d.inState&&(e.startProfile(Da),d.inState=!0)}var h=e.profileState.get(Aa);l&&!h.inState&&(e.startProfile(Aa),h.inState=!0,e.isPerformCapitalization=!1),[s,u,d].forEach((function(e){e.inState&&e.inStateKeyCodes++})),l&&h.inState&&h.inStateKeyCodes++}}},a=function(){e.inComposition=!0},l=function(n){if(e.inComposition=!1,o){var r=e.profileState.get(Pa);e.startProfile(Pa),r.inState=!0;var i=n.data?n.data:"";r.inStateKeyCodes+=i.length}},s=function(){e.isPerformCapitalization=!0},u=function n(){e.applyAllDone=!0,r.off(Ft.R.CLIENTVAR_APPLY_ALL_DONE,n)};return function(){return _e.a.useEffect((function(){if(i)return e.resetProfileState(),document.addEventListener("keydown",c,{capture:!0,passive:!0}),i.addEventListener("compositionstart",a),i.addEventListener("compositionend",l),ln.N.on(ln.p.EDITOR_PLUGIN.PERFORM_AUTO_CAPITALIZATION,s),r.on(Ft.R.CLIENTVAR_APPLY_ALL_DONE,u),function(){i&&(document.removeEventListener("keydown",c,{capture:!0}),i.removeEventListener("compositionstart",a),i.removeEventListener("compositionend",l),ln.N.off(ln.p.EDITOR_PLUGIN.PERFORM_AUTO_CAPITALIZATION,s),r.off(Ft.R.CLIENTVAR_APPLY_ALL_DONE,u))}}),[]),null}}}]),r}(Hi.A),Fa=r("dx_mGN1"),Ua=r("dx_o68o"),Ha=Node.prototype.removeChild;function Va(e){try{return Ha.call(this,e)}catch(n){return n instanceof Error&&Object(et.collectEvent)("doc_bug_track_dev",{action:"remove_child_fail",info:JSON.stringify({stack:n.stack})}),e}}Node.prototype.removeChild=Va,Element.prototype.removeChild=Va;var Wa=r("dx_zFsx"),za=r("dx_UydN"),Ga=r("dx_q0q6"),Ka=["beforeinput","input","compositionstart","compositionupdate","compositionend"];function qa(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Xa=function(e){G()(r,e);var n=qa(r);function r(){return F()(this,r),n.apply(this,arguments)}return H()(r,[{key:"getWrapper",value:function(e){return function(n){return _e.a.createElement(e,Object.assign({},n,{editable:n.recursionProps.editable}))}}},{key:"getEffect",value:function(){var e=this;return function(n){var r=n.editorAPI,o=r.viewService,i=r.getService(Zr.S),c=Object(me.useRef)(null),a=r.getService(Ga.A),l=Object(me.useRef)(!1),s=Object(me.useRef)(!1),u=Object(me.useCallback)(function(){var e=Gt()(Wt.a.mark((function e(n){var o,c,a,s=arguments;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>1&&void 0!==s[1]?s[1]:{},c=n,a=function(){c.preventDefault(),l.current=!0},e.next=5,Object(za.Z)({selectionAPI:i,editorAPI:r},n.data,{beforeReplace:a},o);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[i,r]),d=Object(me.useCallback)((function(n){if(n.isDispatchFromEditableExtension)return null;var r=i.getSelection();if(i.isTextSelectionAcrossBlocks(r))return null;if(n.defaultPrevented||h.S.isAndroid&&l.current)return null;var c=Object(Sa.z)(e.blockManager);if(c)return c;if(i.isSingleTextSelection(r)){var a=r[0].id,s=o.getBlockViewByBlockId(a);return"blur"===n.type?(null===s||void 0===s?void 0:s.editor)||null:(null===s||void 0===s?void 0:s.isFocus())?s.editor:null}return null}),[i,o]);Object(me.useLayoutEffect)((function(){function e(e){return n.apply(this,arguments)}function n(){return(n=Gt()(Wt.a.mark((function e(n){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.current=!1,!(h.S.isIOS&&!a.isComposing&&"deleteCompositionText"===n.inputType&&i.isTextSelectionAcrossBlocks()&&n.target instanceof HTMLElement)){e.next=7;break}return s.current=!0,document.querySelector("[data-content-editable-root]").contentEditable="false",n.target.contentEditable="false",i.getSelection().forEach((function(e){var n=e.id;e.type===Fi.j.TEXT&&o.getBlockViewByBlockId(n).editor.setEditable(!1)})),e.abrupt("return");case 7:if("insertText"===n.inputType&&i.isTextSelectionAcrossBlocks(i.getSelection())&&i.isFocus()){e.next=9;break}return e.abrupt("return");case 9:u(n,{type:"flushInput"});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return document.addEventListener("beforeinput",e),function(){document.removeEventListener("beforeinput",e)}}),[i,a,u]),Object(me.useLayoutEffect)((function(){function e(e){return n.apply(this,arguments)}function n(){return(n=Gt()(Wt.a.mark((function e(n){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(h.S.isIOS&&s.current&&i.isTextSelectionAcrossBlocks()&&n.target instanceof HTMLElement)){e.next=6;break}return s.current=!1,document.querySelector("[data-content-editable-root]").contentEditable="true",n.target.contentEditable="true",i.getSelection().forEach((function(e){var n=e.id;e.type===Fi.j.TEXT&&o.getBlockViewByBlockId(n).editor.setEditable(!0)})),e.abrupt("return");case 6:if(i.isTextSelectionAcrossBlocks(i.getSelection())&&i.isFocus()){e.next=8;break}return e.abrupt("return");case 8:u(n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return document.addEventListener("compositionend",e),function(){document.removeEventListener("compositionend",e)}}),[i,u]),Object(me.useLayoutEffect)((function(){var e,n;function r(e){if(!(e.target instanceof HTMLInputElement&&["checkbox","radio"].includes(e.target.type))&&!(e.target instanceof HTMLElement&&!e.target.isContentEditable&&e.target.closest(".taskblock,.task-block-dropdown-keydown-menu"))){Ka.includes(e.type)&&Object(Sa.L)(e)&&Object(Sa.l)(i,o)&&i.emitSelectionChange();var n=d(e);if(n){var r=Object(Sa.u)(e,n);n.getDelegator().dispatchNativeEvent(r),r.defaultPrevented&&e.preventDefault()}}}return c.current||(c.current=document.querySelector("[data-content-editable-root]")),document.addEventListener("compositionstart",r),document.addEventListener("compositionupdate",r),document.addEventListener("compositionend",r),Wa.Q.on("keydown",document,r,{priority:1}),document.addEventListener("keypress",r),document.addEventListener("keyup",r),document.addEventListener("input",r),document.addEventListener("beforeinput",r),null===(e=c.current)||void 0===e||e.addEventListener("focus",r),null===(n=c.current)||void 0===n||n.addEventListener("blur",r),function(){var e,n;document.removeEventListener("compositionstart",r),document.removeEventListener("compositionupdate",r),document.removeEventListener("compositionend",r),Wa.Q.off("keydown",document,r),document.removeEventListener("keypress",r),document.removeEventListener("keyup",r),document.removeEventListener("input",r),document.removeEventListener("beforeinput",r),null===(e=c.current)||void 0===e||e.removeEventListener("focus",r),null===(n=c.current)||void 0===n||n.removeEventListener("blur",r)}}),[i,o]),Object(me.useLayoutEffect)((function(){try{if(h.S.isAndroid){var e=function(e){l.current&&e.preventDefault()};return document.addEventListener("textInput",e),function(){document.removeEventListener("textInput",e)}}}catch(n){}}),[])}}}]),r}(Hi.A),Ya=r("dx_TSvr"),Ja=r("dx_dYKg"),Za=r("dx_kP4l"),Qa=r("dx_ipoS");r("dx_ayEv");function $a(e){var n=e.blockManager,r=e.blockId,o=e.tips,i=e.delay_ms,c=void 0===i?5e3:i,a=e.onClose,l={};if(Object(me.useEffect)((function(){var e=setTimeout((function(){a()}),c);return function(){clearTimeout(e)}}),[a,c,r]),!r)return null;var s=n.getBlockViewByBlockIdNotCheck(r);if(!s)return null;var u=s.hostElement;if(!u)return null;var d=n.editorAPI.getService(Fr.z).getBlockClientRect(r)||u.getBoundingClientRect(),f=d.top,h=d.left;l.left=h;var p=f-8-30;if(p>=68){var v=document.body.offsetHeight-4-30;l.top=Math.min(p,v)}else l.top=68;return so.a.createPortal(_e.a.createElement("div",{className:"block-tips__container"},_e.a.createElement("div",{className:"block-tips-tooltip__container",style:l},_e.a.createElement("div",null,_e.a.createElement("span",{className:"block-tips-tooltip__icon"},_e.a.createElement(Qa.S,null)),o))),document.body)}var el=r("dx_pxpU");function tl(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var nl=function(e){G()(r,e);var n=tl(r);function r(){return F()(this,r),n.apply(this,arguments)}return H()(r,[{key:"getAfterSlot",value:function(){return function(e){var n=e.recursionProps,r=n.blockManager,o=n.boundary,i=Object(me.useState)(u.V),c=$e()(i,2),a=c[0],l=c[1],s=Object(me.useState)(""),d=$e()(s,2),f=d[0],h=d[1],p=Object(Za.S)(),v=Object(me.useCallback)((function(){r.dispatch(el.e,[a]),l(u.V),h(""),p.reset(),o.removeEventListener("scroll",g),document.removeEventListener("click",g)}),[o]),g=function(){v()},b=Object(me.useCallback)((function(e,n){l(e),h(n),o.addEventListener("scroll",g),document.addEventListener("click",g)}),[o]);return Object(me.useEffect)((function(){return r.addListener(el.i,b),function(){r.removeListener(el.i,b),o.removeEventListener("scroll",g)}}),[r,b]),_e.a.createElement($a,{blockManager:r,blockId:a,tips:f,delay_ms:5e3,onClose:v})}}}]),r}(Hi.A),rl=r("dx_imty"),ol=function(e){var n=Object(me.useState)(e),r=$e()(n,2),o=r[0],i=r[1],c=Object(me.useCallback)((function(e){var n=e.curr;i(n)}),[]);return Object(me.useEffect)((function(){return ln.S.on(rl.H.EditableChange,c),function(){ln.S.off(rl.H.EditableChange,c)}}),[c]),o};function il(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var cl=function(e){G()(r,e);var n=il(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).mouseContext=void 0,e.handleClickPageBlock=function(n){var r=n.target,o=r.closest(".block");if(o&&!!!r.closest(".text-editor")){var i=[].concat(s()(k.h),s()(Object(k.q)())),c=o.dataset.blockType,a=i.includes(c),l=k.S.includes(c);if(a||l){var u=Number(o.dataset.blockId);if(!a){var d,f=null===(d=e.blockManager.getBlockModelByBlockId(u))||void 0===d?void 0:d.parent;f&&[k.B.PAGE,k.B.CELL].includes(f.type)&&(u=f.id)}if(u){var h=e.getClosestBlockIdByPosition(u,n.y);h&&(Object(Ai.A)(e.blockManager,e.selectionAPI,e.viewPort,h.blockId,h.isNextBlock),n.stopPropagation())}}}},e.checkIsOneLineBlock=function(n){var r=e.blockManager.getBlockViewByBlockId(n);return k.S.includes(r.type)},e.getClosestBlockIdByPosition=function(n,r){var o=e.blockManager.layoutManager.isBlockActive,i=e.blockManager.getBlockModelByBlockId(n),c=i.children.map((function(e){return e.id})).filter(o),a=c.length;if(0!==a){var l=e.binarySearch(c,(function(n){var o=e.blockManager.getBlockViewByBlockId(n).hostElement.getBoundingClientRect(),i=o.y,c=o.height;return r<i?r>i-16?{index:0,placement:"upside"}:{index:-1,placement:"upside"}:r>i+c?r<i+c+16?{index:0,placement:"downside"}:{index:1,placement:"downside"}:void 0}),0,a-1);if(l){var s,u,d=l.index;if("upside"===l.placement?(s=c[d-1],u=c[d]):(s=c[d],u=c[d+1]),!s){if(i.isRoot)return;if(!e.checkIsOneLineBlock(u))return;return{isNextBlock:!1,blockId:u}}if(!u){if(!e.checkIsOneLineBlock(s))return;return{isNextBlock:!0,blockId:s}}if(e.checkIsOneLineBlock(s)&&e.checkIsOneLineBlock(u))return{isNextBlock:!0,blockId:s}}}},e.handleMouseDown=function(n){e.mouseContext={x:n.clientX,y:n.clientY}},e}return H()(r,[{key:"binarySearch",value:function(e,n,r,o){var i=n(e[o]);if(0===(null===i||void 0===i?void 0:i.index))return i.index=o,i;var c=n(e[r]);if(0===(null===c||void 0===c?void 0:c.index))return c.index=r,c;for(;o-r>1;){var a=Math.floor((r+o)/2),l=n(e[a]);if(void 0===l)return;var s=l.index;if(0===s)return l.index=a,l;if(s<0)o=a;else{if(!(s>0)){var u=this.binarySearch(e,n,r,s-1);return u||(u=this.binarySearch(e,n,s+1,o)),u}r=a}}}},{key:"checkIsDrag",value:function(e){if(this.mouseContext){var n=this.mouseContext,r=n.x,o=n.y,i=Math.abs(o-e.clientY),c=Math.abs(r-e.clientX);return i>10||c>10}return!1}},{key:"getEffect",value:function(){var e=this;return function(n){var r=function(n){return e.handleMouseDown(n)};Object(me.useEffect)((function(){var n=e.options.container;return n.addEventListener("mousedown",r),function(){n.removeEventListener("mousedown",r)}}),[]);var o=e.options.container,i=ol(n.recursionProps.editable),c=Object(me.useCallback)((function(n){i&&(e.checkIsDrag(n)||e.handleClickPageBlock(n))}),[i]);Object(me.useEffect)((function(){return o.addEventListener("click",c),function(){o.removeEventListener("click",c)}}),[o,c])}}}]),r}(Hi.A),al=r("dx_NsKf"),ll=r("dx_iw8O"),sl=r("dx_pmiW");function ul(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}function dl(e,n){if(Object(Qc.U)(e)&&e.type===k.B.TEXT){var r=e.model.children.length;if(r>0){var o=e.model.children[r-1];return dl(n.getBlockViewByBlockId(o.id),n)}return e.model.isEmpty?e.id:void 0}}var fl=function(e){G()(r,e);var n=ul(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).removeAllSelection=function(){return e.selectionAPI.removeAllSelection()},e.rootBlockHost=void 0,e.mouseContext=void 0,e.findLastTextualBlockIfEmpty=function(){var n=Gt()(Wt.a.mark((function n(r){var o,i,c,a;return Wt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0!==(o=e.blockManager.getBlockModelByBlockId(r.id)).children.length){n.next=3;break}return n.abrupt("return");case 3:if(i=o.children[o.children.length-1],c=i.id,e.blockManager.hasBlockViewByBlockId(c)){n.next=8;break}return n.next=8,e.blockManager.layoutManager.getReconciler().renderNodeById([c]);case 8:return a=e.blockManager.getBlockViewByBlockId(c),n.abrupt("return",dl(a,e.blockManager));case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.handleClickPageBlock=function(){var n=Gt()(Wt.a.mark((function n(r,o,i){var c,a,l,s,u,d,f,h,p,v,g;return Wt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(c=e.blockManager.getBlockViewByBlockId(o),a=r.target instanceof HTMLElement&&r.target.closest(".page-block-content"),e.rootBlockHost&&r.target&&!a&&i){n.next=4;break}return n.abrupt("return");case 4:if(Object(ll.S)(r.target)===o||r.target.classList.contains("editor")){n.next=7;break}return n.abrupt("return");case 7:if(!(e.options&&e.options.ignores&&e.options.ignores.some((function(e){return e(r)})))){n.next=9;break}return n.abrupt("return");case 9:if(l=e.selectionAPI.getSelection(),!e.selectionAPI.isSelecting()||!(l.length>1||1===l.length&&l[0].id!==o&&"block"===l[0].type)){n.next=12;break}return n.abrupt("return");case 12:if(!e.checkIsDrag(r)){n.next=15;break}return n.abrupt("return");case 15:if(!(s=e.blockManager.getLastBlockIdByPreOrder())){n.next=20;break}if(u=e.options.rect.getBlockClientRect(s),!(r.clientY-((null===u||void 0===u?void 0:u.bottom)||0)<1)){n.next=20;break}return n.abrupt("return");case 20:return n.next=22,e.findLastTextualBlockIfEmpty(c);case 22:if(!(d=n.sent)){n.next=26;break}return f=e.blockManager.getBlockViewByBlockId(d),n.abrupt("return",Object(aa.Z)(f.model));case 26:return h=e.blockManager.getBlockModelByBlockId(o),p=h.children.length,n.next=30,e.blockManager.applyTransaction("handleClickPageBlockToInsertBlock",(function(e){Object(Gc.l)(e,h.recordId,p,[Object(al.u)()])}));case 30:v=h.children[p].id,g=e.blockManager.getBlockViewByBlockId(v),Object(Qc.U)(g)&&Object(aa.u)(g.model);case 33:case"end":return n.stop()}}),n)})));return function(e,r,o){return n.apply(this,arguments)}}(),e.handleMouseDown=function(n){e.mouseContext={x:n.clientX,y:n.clientY}},e.handleMouseUp=function(n,r){var o=e.blockManager.getBlockViewByBlockId(r).hostElement;if(n.target instanceof Node&&o.contains(n.target))e.resetMouseContext();else{if(e.mouseContext){var i,c=e.mouseContext,a=c.x,l=c.y,s=Math.min(a,n.clientX),u=Math.min(l,n.clientY),d=Math.abs(l-n.clientY),f=Math.abs(a-n.clientX),h={x:s,y:u,width:f,height:d,left:a,right:a+f,top:l,bottom:l+d,toJSON:function(){return h}},p=null===(i=e.rootBlockHost)||void 0===i?void 0:i.getBoundingClientRect();if(p&&Object(sl.L)(h,p))return void e.resetMouseContext()}e.removeAllSelection(),e.resetMouseContext()}},e}return H()(r,[{key:"checkIsDrag",value:function(e){if(this.mouseContext){var n=this.mouseContext,r=n.x,o=n.y,i=Math.abs(o-e.clientY),c=Math.abs(r-e.clientX);return i>50||c>50}return!1}},{key:"resetMouseContext",value:function(){this.mouseContext=null}},{key:"getEffect",value:function(){var e=this;return function(n){var r=function(n){return e.handleMouseDown(n)},o=function(r){return e.handleMouseUp(r,n.blockId)};Object(me.useEffect)((function(){var n=e.options.container;return n.addEventListener("mousedown",r),n.addEventListener("mouseup",o),function(){n.removeEventListener("mousedown",r),n.removeEventListener("mouseup",o)}}),[]);var i=Object(me.useCallback)((function(r){return e.handleClickPageBlock(r,n.blockId,n.recursionProps.editable)}),[n.blockId,n.recursionProps.editable]);Object(me.useEffect)((function(){var r=e.blockManager.getBlockViewByBlockId(n.blockId),o=r.hostElement.closest(".editor")||r.hostElement;return o.addEventListener("click",i),e.rootBlockHost=r.hostElement.getElementsByClassName("root-block")[0],function(){e.rootBlockHost=null,o.removeEventListener("click",i)}}),[n.blockId,i])}}}]),r}(Hi.A),hl=r("dx_QzB0"),pl=r("dx_hoya");function vl(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var gl=function(e){G()(r,e);var n=vl(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).bridge=null,e}return H()(r,[{key:"getEffect",value:function(){var e=this;return function(n){if(Object(pl.r)()&&!e.bridge){e.bridge=n.model.loadBridgeImpl();var r=e.editorAPI.getService(hl.H),o=function(){var n,o;r.editing?null===(n=e.bridge)||void 0===n||n.unfreeze():null===(o=e.bridge)||void 0===o||o.freeze()};o(),r.onDocsModeChange(o)}}}}]),r}(Hi.A);function bl(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var yl=function(e){G()(r,e);var n=bl(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).bridge=null,e}return H()(r,[{key:"getEffect",value:function(){var e=this;return function(n){if(Object(pl.r)()&&!e.bridge){e.bridge=n.model.loadBridgeImpl();var r=e.editorAPI.getService(hl.H),o=function(){var n,o;r.editing?null===(n=e.bridge)||void 0===n||n.unfreeze():null===(o=e.bridge)||void 0===o||o.freeze()};o(),r.onDocsModeChange(o)}}}}]),r}(Hi.A);function ml(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var _l=function(e){var n,r;return null===(n=e.sheet)||void 0===n||null===(r=n.status)||void 0===r?void 0:r.frozen},kl=function(e){G()(r,e);var n=ml(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).bridge=null,e.isLoaded=!1,e.docsModeService=null,e.handleDocsModeChange=function(){var n,r,o;(null===(n=e.docsModeService)||void 0===n?void 0:n.editing)?null===(r=e.bridge)||void 0===r||r.unfreeze():null===(o=e.bridge)||void 0===o||o.freeze()},e}return H()(r,[{key:"loadBridge",value:function(){var e=Gt()(Wt.a.mark((function e(n){var r,o=this;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoaded=!0,e.next=3,n.loadBridgeImpl();case 3:this.bridge=e.sent,this.handleDocsModeChange(),Zt.a.subscribe((function(){var e;_l(Zt.a.getState())===(null===(e=o.docsModeService)||void 0===e?void 0:e.editing)&&o.handleDocsModeChange()})),null===(r=this.docsModeService)||void 0===r||r.onDocsModeChange(this.handleDocsModeChange);case 7:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"getEffect",value:function(){var e=this;return function(){var n=Gt()(Wt.a.mark((function n(r){return Wt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.docsModeService=e.docsModeService||e.editorAPI.getService(hl.H),Object(pl.r)()&&!e.isLoaded&&r.model.snapshot.token&&e.loadBridge(r.model);case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}}]),r}(Hi.A),Ol=r("dx_sNGG"),xl=r("dx_KTtu"),El=r("dx_Wkzy"),Sl=r("dx_yDa2");function Cl(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Il(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Cl(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cl(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Bl(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Tl=function(e){G()(r,e);var n=Bl(r);function r(e){var o;F()(this,r),(o=n.call(this,e)).matches=[];var i=e.blockManager,c=e.ranges;return o.updateHighlight(i,c),o}return H()(r,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var n=e.updateFlag,r=e.ranges;n===this.props.updateFlag&&Object(tt.isEqual)(r,this.props.ranges)||this.updateHighlight(this.props.blockManager,r)}},{key:"componentWillUnmount",value:function(){var e=this.props,n=e.blockManager,r=e.ranges;this.clearHighlight(n,r),this.matches=[]}},{key:"clearHighlight",value:function(e,n){var r=e.editorAPI.getService(El.x).getLoadedBridge(),o={isReplaceable:!1,blockId:n[0].match.bitableId,matches:this.matches};r.clearSearchResult(o.blockId,o)}},{key:"updateHighlight",value:function(e,n){var r=this,o=e.editorAPI.getService(El.x).getLoadedBridge(),i=null;this.matches=n.map((function(e){return e.match})),n.forEach((function(e){var n=e.color,c=e.match,a=n===Sl.F.selected,l=Il(Il({},c),{},{isReplaceable:!1,blockId:c.bitableId,matches:r.matches});a&&(i=l),o.highlightSearchItem(c.bitableId,l,!1)})),i&&o.highlightSearchItem(i.blockId,i,!0)}},{key:"render",value:function(){return null}}]),r}(me.Component),wl=r("dx_w0Wf"),Rl=r("dx_lROi");function Ml(e){var n=e.startTop,r=e.startLeft,o=e.endLeft,i=e.endBottom,c=e.height,a=e.color,l=e.id,s=e.lineHeight,u=e.paddingLeft,d=e.paddingRight,f=e.rangePadding,h=e.classPrefix;if(0===s)return console.error("[find] renderRange lineHeight===0"),null;if(void 0===s||void 0===u||void 0===d)return null;if(void 0===r||void 0===o)return null;var p=c+2*f,v=Object(Rl.p)((i-n)/s),g=n-(p-c)/2,b=g+s,y=jl({color:a,height:p,left:r,top:g,width:1===v?o-r:void 0,right:1===v?void 0:d,classPrefix:h}),m=[],_=b;if(v>2){for(var k=0;k<v-2;k++)m.push(jl({color:a,height:p,left:u,top:b+k*s,right:d,classPrefix:h}));_=b+s*(v-2)}var O=null;return v>=2&&(O=jl({color:a,height:p,left:u,top:_,width:o-u,classPrefix:h})),_e.a.createElement("div",{className:"".concat(h,"-container"),"data-id":l,key:l},y,m,O)}function jl(e){var n=e.color,r=e.left,o=e.right,i=e.top,c=e.width,a=e.height,l=e.classPrefix,s={height:a,backgroundColor:n,left:Object(Rl.p)(r),top:Object(Rl.p)(i),position:"absolute",pointerEvents:"none",zIndex:1};return void 0!==o?s.right=Object(Rl.p)(o):s.width=c,_e.a.createElement("div",{className:"".concat(l,"-content"),style:s})}function Dl(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Al="docx-bookmark-title",Pl=function(e){G()(r,e);var n=Dl(r);function r(e){var o;F()(this,r),(o=n.call(this,e)).container=void 0,o.afterSetIsReplacingAllAnimationFrame=new wl.P,o.blockStyle=void 0,o.updateInfo=function(){var e=o.props.blockId;o.container=o.getContainer(e),o.blockStyle=o.getBlockStyle()},o.updateInfoWithForceUpdate=Gt()(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.afterSetIsReplacingAllAnimationFrame.request();case 2:o.updateInfo(),o.forceUpdate();case 4:case"end":return e.stop()}}),e)})));var i=e.blockId;return e.blockManager.addListener(Ni.T,o.updateInfoWithForceUpdate,i),o.updateInfo(),o}return H()(r,[{key:"shouldComponentUpdate",value:function(e){var n=e.selectionAPI,r=e.blockManager,o=e.rect,i=e.ranges,c=e.updateFlag,a=this.props,l=a.selectionAPI,s=a.blockManager,u=a.rect,d=a.ranges,f=a.updateFlag;return l!==n||s!==r||u!==o||c!==f||!Object(tt.isEqual)(d,i)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.updateFlag!==this.props.updateFlag&&this.updateInfo()}},{key:"componentWillUnmount",value:function(){var e=this.props,n=e.blockManager,r=e.blockId;n.removeListener(Ni.T,this.updateInfoWithForceUpdate,r),this.afterSetIsReplacingAllAnimationFrame.cancel(),this.container=null}},{key:"getContainer",value:function(e){var n=this.props.blockManager.getBlockViewByBlockIdNotCheck(e);return n?n.hostElement:null}},{key:"getBlockStyle",value:function(){var e,n=null===(e=this.container)||void 0===e?void 0:e.querySelector(".".concat(Al));if(!n)return{};var r=getComputedStyle(n),o=Object(Rl.p)(Number(r.lineHeight.replace("px",""))),i=n.getBoundingClientRect(),c=this.container.getBoundingClientRect();return{lineHeight:o,paddingLeft:i.left-c.left,paddingRight:c.right-i.right}}},{key:"renderTitleRange",value:function(e){var n=this.props,r=n.blockId,o=n.blockManager,i=e.color,c=e.match,a=this.blockStyle.lineHeight;if(this.container&&void 0!==a){var l=o.getBlockViewByBlockId(r).hostElement,s=l.querySelector(".".concat(Al));if(s){var u=Object(Rl.Q)(s.firstChild,c.range,(function(e){console.error(e)}));if(u){var d=l.getBoundingClientRect(),f=d.left,h=d.top,p=u.startLeft,v=u.startTop,g=u.endBottom,b=u.endLeft,y=u.height,m=p-f,_=v-h;return _e.a.createElement(Ml,{startLeft:m,endLeft:b-f,startTop:_,endBottom:g-h,height:y,color:i,id:c.matchId,lineHeight:this.blockStyle.lineHeight,paddingLeft:this.blockStyle.paddingLeft,paddingRight:this.blockStyle.paddingRight,rangePadding:2,classPrefix:"docx-bookmark-highlight"})}}}}},{key:"renderContent",value:function(){var e=this,n=this.props.ranges;return _e.a.createElement(_e.a.Fragment,null,n.map((function(n){return e.renderTitleRange(n)})))}},{key:"render",value:function(){return this.container?so.a.createPortal(_e.a.createElement("span",{className:"block-highlight-wrap"},this.renderContent()),this.container):null}}]),r}(me.Component),Ll=r("dx_w5wE");function Nl(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Fl=function(e){G()(r,e);var n=Nl(r);function r(e){var o;return F()(this,r),(o=n.call(this,e)).updateHighlight=function(){var e=o.props.ranges;if(e.length){var n=e.find((function(e){return e.isSelected}));if(!n)return ln.s.emit(Ol.Y.GLOBAL_COMMENT_HIGHLIGHT_CHANGE,[]),void ln.s.emit(Ol.Y.COMMENT_HIGHLIGHT_CHANGE,[]);var r=n.match.commentType===Ll.a.global?Ol.Y.GLOBAL_COMMENT_HIGHLIGHT_CHANGE:Ol.Y.COMMENT_HIGHLIGHT_CHANGE;ln.s.emit(r,[n.match.matchContent])}},o}return H()(r,[{key:"componentDidMount",value:function(){this.updateHighlight()}},{key:"componentDidUpdate",value:function(){this.updateHighlight()}},{key:"render",value:function(){return null}}]),r}(me.Component),Ul=r("dx_ZeFe"),Hl=r("dx_tsDa");r("dx_rAjM");function Vl(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Wl=function(e){G()(r,e);var n=Vl(r);function r(e){var o;F()(this,r),(o=n.call(this,e)).container=void 0,o.block=void 0,o.afterSetIsReplacingAllAnimationFrame=new wl.P,o.blockStyle=void 0,o.rangePadding=2,o.updateInfo=function(){var e=o.props,n=e.blockId,r=e.blockManager;o.block=r.getBlockViewByBlockIdNotCheck(n),o.container=o.getContainer(n),o.blockStyle=o.getBlockStyle(),o.rangePadding=Object(Hl.b)(o.props.blockManager,o.block.id)?0:2},o.updateInfoWithForceUpdate=Object(tt.debounce)(Gt()(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.afterSetIsReplacingAllAnimationFrame.request();case 2:o.updateInfo(),o.forceUpdate();case 4:case"end":return e.stop()}}),e)}))),100);var i=e.blockId;return e.blockManager.addListener(Ni.T,o.updateInfoWithForceUpdate,i),o.updateInfo(),o}return H()(r,[{key:"componentDidMount",value:function(){ln.S.on(Ul.o,this.updateInfoWithForceUpdate)}},{key:"shouldComponentUpdate",value:function(e){var n=e.selectionAPI,r=e.blockManager,o=e.rect,i=e.ranges,c=e.updateFlag,a=this.props,l=a.selectionAPI,s=a.blockManager,u=a.rect,d=a.ranges,f=a.updateFlag;return l!==n||s!==r||u!==o||c!==f||!Object(tt.isEqual)(d,i)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.updateFlag!==this.props.updateFlag&&this.updateInfo()}},{key:"componentWillUnmount",value:function(){var e=this.props,n=e.blockManager,r=e.blockId;n.removeListener(Ni.T,this.updateInfoWithForceUpdate,r),ln.S.off(Ul.o,this.updateInfoWithForceUpdate),this.afterSetIsReplacingAllAnimationFrame.cancel(),this.container=null}},{key:"renderPollRange",value:function(e){var n=this.props,r=n.blockId,o=n.blockManager,i=e.color,c=e.match,a=c.position,l=this.blockStyle.lineHeight;if(this.container&&void 0!==l){var s="poll-block-input__".concat(a),u=o.getBlockViewByBlockId(r).hostElement,d=u.querySelector(".".concat(s," .poll-input-fake-textarea"));if(d){var f=Object(Rl.Q)(d.firstChild,c.range,(function(e){console.error(e)}));if(f){var h=u.getBoundingClientRect(),p=h.left,v=h.top,g=f.startLeft,b=f.startTop,y=f.endBottom,m=f.endLeft,_=f.height,k=g-p,O=b-v;return this.renderRange({startLeft:k,endLeft:m-p,startTop:O,endBottom:y-v,height:_,color:i,id:c.matchId})}}}}},{key:"renderContent",value:function(){var e=this,n=this.props.ranges;return _e.a.createElement(_e.a.Fragment,null,n.map((function(n){return e.renderPollRange(n)})))}},{key:"render",value:function(){return this.container?so.a.createPortal(_e.a.createElement("span",{className:"block-highlight-wrap"},this.renderContent()),this.container):null}},{key:"getContainer",value:function(e){var n=this.props.blockManager.getBlockViewByBlockIdNotCheck(e);return n?n.hostElement:null}},{key:"getBlockStyle",value:function(){var e,n=null===(e=this.container)||void 0===e?void 0:e.querySelector(".poll-input-fake-textarea");if(!n)return{};var r=getComputedStyle(n),o=Object(Rl.p)(Number(r.lineHeight.replace("px",""))),i=getComputedStyle(this.container);return{lineHeight:o,paddingLeft:Object(Rl.p)(Number(i.paddingLeft.replace("px",""))),paddingRight:Object(Rl.p)(Number(i.paddingRight.replace("px","")))}}},{key:"fixRange",value:function(e,n){return[e,n]}},{key:"renderRange",value:function(e){var n=e.startTop,r=e.startLeft,o=e.endLeft,i=e.endBottom,c=e.height,a=e.color,l=e.id,s=this.blockStyle,u=s.lineHeight,d=s.paddingLeft,f=s.paddingRight,h=this.fixRange(r,o),p=$e()(h,2),v=p[0],g=p[1];return _e.a.createElement(Ml,{startLeft:v,endLeft:g,startTop:n,endBottom:i,height:c,color:a,id:l,lineHeight:u,paddingLeft:d,paddingRight:f,rangePadding:this.rangePadding,classPrefix:"poll-block-highlight"})}}]),r}(me.Component),zl=r("dx_OPAz");function Gl(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Kl(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Gl(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gl(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ql(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Xl=function(e){G()(r,e);var n=ql(r);function r(e){var o;F()(this,r),o=n.call(this,e);var i=e.blockManager,c=e.ranges;return o.updateHighlight(i,c),o}return H()(r,[{key:"UNSAFE_componentWillReceiveProps",value:function(e){var n=e.updateFlag,r=e.ranges;n===this.props.updateFlag&&Object(tt.isEqual)(r,this.props.ranges)||this.updateHighlight(this.props.blockManager,r)}},{key:"componentWillUnmount",value:function(){var e=this.props,n=e.blockManager,r=e.ranges;this.clearHighlight(n,r)}},{key:"updateHighlight",value:function(e,n){var r=e.editorAPI.getService(zl.H).bridge;n.forEach((function(e){var n=e.color,o=e.match,i=n===Sl.F.selected,c=Kl(Kl({},o),{},{key:o.cellId});r.highlightSearchItem(o.sheetId,c,i)}))}},{key:"clearHighlight",value:function(e,n){var r=e.editorAPI.getService(zl.H).bridge,o={isReplaceable:!1,blockId:n[0].match.sheetId,matches:n.map((function(e){return e.match}))};r.clearSearchResult(o.blockId,o)}},{key:"render",value:function(){return null}}]),r}(me.Component),Yl=r("dx_Jl0O"),Jl=r("dx_Fwx7");function Zl(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Ql(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Zl(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zl(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function $l(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var es=function(e){G()(r,e);var n=$l(r);function r(e){var o;F()(this,r),(o=n.call(this,e)).container=void 0,o.block=void 0,o.afterSetIsReplacingAllAnimationFrame=new wl.P,o.blockStyle=void 0,o.rangePadding=2,o.updateInfo=function(){var e=o.props,n=e.blockId,r=e.blockManager;o.block=r.getBlockViewByBlockId(n),o.container=o.getContainer(n),o.blockStyle=o.getBlockStyle(),o.rangePadding=Object(Hl.b)(o.props.blockManager,o.block.id)?0:2},o.updateInfoWithForceUpdate=Gt()(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.afterSetIsReplacingAllAnimationFrame.request();case 2:o.updateInfo(),o.forceUpdate();case 4:case"end":return e.stop()}}),e)})));var i=e.blockId;return e.blockManager.addListener(Ni.T,o.updateInfoWithForceUpdate,i),o.updateInfo(),o}return H()(r,[{key:"shouldComponentUpdate",value:function(e){var n=e.selectionAPI,r=e.blockManager,o=e.rect,i=e.ranges,c=e.updateFlag,a=this.props,l=a.selectionAPI,s=a.blockManager,u=a.rect,d=a.ranges,f=a.updateFlag;return l!==n||s!==r||u!==o||c!==f||!Object(tt.isEqual)(d,i)}},{key:"componentWillReceiveProps",value:function(e){e.updateFlag!==this.props.updateFlag&&this.updateInfo()}},{key:"componentWillUnmount",value:function(){var e=this.props,n=e.blockManager,r=e.blockId;n.removeListener(Ni.T,this.updateInfoWithForceUpdate,r),this.afterSetIsReplacingAllAnimationFrame.cancel(),this.container=null}},{key:"getContainer",value:function(e){var n=this.props.blockManager.getBlockViewByBlockIdNotCheck(e);return n?n.hostElement:null}},{key:"getBlockStyle",value:function(){var e,n=null===(e=this.container)||void 0===e?void 0:e.querySelector(".task-block-text-editor");if(!n)return{};var r=getComputedStyle(n),o=Object(Rl.p)(Number(r.lineHeight.replace("px",""))),i=getComputedStyle(this.container);return{lineHeight:o,paddingLeft:Object(Rl.p)(Number(i.paddingLeft.replace("px",""))),paddingRight:Object(Rl.p)(Number(i.paddingRight.replace("px","")))}}},{key:"getActualCaretRect",value:function(e){var n,r=null===(n=this.block)||void 0===n?void 0:n.editorInstance;if(!r)return Object(Yl.b)();var o=r.getContentState().getActiveZone(),i=r.rectModule.getRawCaretRect(Ql(Ql({},o.offsetToPoint(e)),{},{zoneId:o.getZoneId()})),c=Object(Yl.I)(this.block.hostElement.getBoundingClientRect());return Object(Yl.l)(i,c)}},{key:"renderTextRange",value:function(e){var n=e.color,r=e.match,o=$e()(r.range,2),i=o[0],c=o[1],a=this.blockStyle.lineHeight;if(this.container&&void 0!==a){var l=this.getActualCaretRect(i),s=l.left,u=l.top,d=l.height,f=this.getActualCaretRect(c),h=f.left,p=f.bottom;return this.renderRange({startLeft:s,endLeft:h,startTop:u,endBottom:p,height:d,color:n,id:r.matchId})}}},{key:"renderEmbedTextRange",value:function(e){var n=this.props,r=n.rect,o=n.blockId,i=e.color,c=e.match,a=c.range,l=c.contentOffset,s=c.matchId,u=this.blockStyle.lineHeight,d=Object(Jl.t)(this.block.editorInstance,a,l),f=r.getBlockClientRect(o);if(void 0===u||!d||!f)return null;var h=d.startLeft,p=d.startTop,v=d.endBottom,g=d.endLeft,b=d.height;return this.renderRange({startLeft:h-f.left,startTop:p-f.top,endLeft:g-f.left,endBottom:v-f.top,height:b,color:i,id:s})}},{key:"fixRange",value:function(e,n){var r,o=this.props,i=o.rect,c=o.blockId,a=i.getBlockClientRect(c),l=null===(r=this.container)||void 0===r?void 0:r.querySelector(".task-block-text-editor"),s=null===l||void 0===l?void 0:l.getClientRects()[0];if(!s||!a)return[];var u=s.left-a.left,d=s.right-a.left;return e>d||n<u?[]:[Math.max(u,e),Math.min(d,n)]}},{key:"renderRange",value:function(e){var n=e.startTop,r=e.startLeft,o=e.endLeft,i=e.endBottom,c=e.height,a=e.color,l=e.id,s=this.blockStyle,u=s.lineHeight,d=s.paddingLeft,f=s.paddingRight,h=this.fixRange(r,o),p=$e()(h,2),v=p[0],g=p[1];return _e.a.createElement(Ml,{startLeft:v,endLeft:g,startTop:n,endBottom:i,height:c,color:a,id:l,lineHeight:u,paddingLeft:d,paddingRight:f,rangePadding:this.rangePadding,classPrefix:"text-block-highlight"})}},{key:"renderContent",value:function(){var e=this,n=this.props.ranges;return _e.a.createElement(_e.a.Fragment,null,n.map((function(n){var r=n.match.type;return xl.V.TextBlock===r?e.renderTextRange(n):e.renderEmbedTextRange(n)})))}},{key:"render",value:function(){return this.container?so.a.createPortal(_e.a.createElement("span",{className:"block-highlight-wrap"},this.renderContent()),this.container):null}}]),r}(me.Component);function ts(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var ns=function(e){G()(r,e);var n=ts(r);function r(e){var o;F()(this,r),(o=n.call(this,e)).container=void 0,o.block=void 0,o.afterSetIsReplacingAllAnimationFrame=new wl.P,o.blockStyle=void 0,o.rangePadding=2,o.updateInfo=function(){var e=o.props,n=e.blockId,r=e.blockManager;o.block=r.getBlockViewByBlockIdNotCheck(n),o.container=o.getContainer(n),o.blockStyle=o.getBlockStyle(),o.rangePadding=Object(Hl.b)(o.props.blockManager,o.block.id)?0:2},o.updateInfoWithForceUpdate=Gt()(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.afterSetIsReplacingAllAnimationFrame.request();case 2:o.updateInfo(),o.forceUpdate();case 4:case"end":return e.stop()}}),e)})));var i=e.blockId;return e.blockManager.addListener(Ni.T,o.updateInfoWithForceUpdate,i),o.updateInfo(),o}return H()(r,[{key:"shouldComponentUpdate",value:function(e){var n=e.selectionAPI,r=e.blockManager,o=e.rect,i=e.ranges,c=e.updateFlag,a=this.props,l=a.selectionAPI,s=a.blockManager,u=a.rect,d=a.ranges,f=a.updateFlag;return l!==n||s!==r||u!==o||c!==f||!Object(tt.isEqual)(d,i)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){e.updateFlag!==this.props.updateFlag&&this.updateInfo()}},{key:"componentWillUnmount",value:function(){var e=this.props,n=e.blockManager,r=e.blockId;n.removeListener(Ni.T,this.updateInfoWithForceUpdate,r),this.afterSetIsReplacingAllAnimationFrame.cancel(),this.container=null}},{key:"getContainer",value:function(e){var n=this.props.blockManager.getBlockViewByBlockIdNotCheck(e);return n?n.hostElement:null}},{key:"getBlockStyle",value:function(){var e,n=null===(e=this.container)||void 0===e?void 0:e.querySelector(".text-editor");if(!n)return{};var r=getComputedStyle(n),o=Object(Rl.p)(Number(r.lineHeight.replace("px",""))),i=n.getBoundingClientRect(),c=this.container.getBoundingClientRect();return{editorRect:i,blockRect:c,lineHeight:o,paddingLeft:i.left-c.left,paddingRight:c.right-i.right}}},{key:"renderTextRange",value:function(e){var n=this.props,r=n.rect,o=n.blockId,i=e.color,c=e.match,a=$e()(c.range,2),l=a[0],s=a[1],u=this.blockStyle.lineHeight;if(this.container&&void 0!==u){var d=r.getActualCaretRect(o,l,o,!0),f=d.left,h=d.top,p=d.height,v=r.getActualCaretRect(o,s,o,!1),g=v.left,b=v.bottom;return this.renderRange({startLeft:f,endLeft:g,startTop:h,endBottom:b,height:p,color:i,id:c.matchId})}}},{key:"renderEmbedTextRange",value:function(e){var n=this.props,r=n.rect,o=n.blockId,i=e.color,c=e.match,a=c.range,l=c.contentOffset,s=c.matchId,u=this.blockStyle.lineHeight,d=Object(Rl.t)(this.block,a,l),f=r.getBlockClientRect(o);if(void 0===u||!d||!f)return null;var h=d.startLeft,p=d.startTop,v=d.endBottom,g=d.endLeft,b=d.height;return this.renderRange({startLeft:h-f.left,startTop:p-f.top,endLeft:g-f.left,endBottom:v-f.top,height:b,color:i,id:s})}},{key:"fixRange",value:function(e,n){if(this.block.type===k.B.CODE){var r=this.blockStyle,o=r.blockRect,i=r.editorRect;if(!i||!o)return[];var c=i.left-o.left,a=i.right-o.left;return e>a||n<c?[]:[Math.max(c,e),Math.min(a,n)]}return[e,n]}},{key:"renderRange",value:function(e){var n=e.startTop,r=e.startLeft,o=e.endLeft,i=e.endBottom,c=e.height,a=e.color,l=e.id,s=this.blockStyle,u=s.lineHeight,d=s.paddingLeft,f=s.paddingRight,h=this.fixRange(r,o),p=$e()(h,2),v=p[0],g=p[1];return _e.a.createElement(Ml,{startLeft:v,endLeft:g,startTop:n,endBottom:i,height:c,color:a,id:l,lineHeight:u,paddingLeft:d,paddingRight:f,rangePadding:this.rangePadding,classPrefix:"text-block-highlight"})}},{key:"renderContent",value:function(){var e=this,n=this.props.ranges;return _e.a.createElement(_e.a.Fragment,null,n.map((function(n){var r=n.match.type;return xl.V.TextBlock===r?e.renderTextRange(n):e.renderEmbedTextRange(n)})))}},{key:"render",value:function(){return this.container?so.a.createPortal(_e.a.createElement("span",{className:"block-highlight-wrap"},this.renderContent()),this.container):null}}]),r}(me.Component),rs=eo()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_D2D7"))},loading:function(){return null},render:function(e,n){var r=e.default;return _e.a.createElement(r,n)}});function os(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var is=function(e){G()(r,e);var n=os(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).state={ranges:[],updateFlag:!1},e.handleUpdateHighlight=Object(tt.throttle)((function(){e.setState({updateFlag:!e.state.updateFlag})}),300),e.handleRangeChange=function(n){Object(tt.isEqual)(n,e.state.ranges)||e.setState({ranges:n})},e}return H()(r,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleUpdateHighlight),this.props.eventEmitter.on(Ol.Y.RANGE_CHANGE,this.handleRangeChange),this.props.eventEmitter.on(Ol.Y.HIGHLIGHT_UPDATE,this.handleUpdateHighlight),this.props.blockManager.addListener(gn.ln,this.handleUpdateHighlight)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleUpdateHighlight),this.props.eventEmitter.off(Ol.Y.RANGE_CHANGE,this.handleRangeChange),this.props.eventEmitter.off(Ol.Y.HIGHLIGHT_UPDATE,this.handleUpdateHighlight),this.props.blockManager.removeListener(gn.ln,this.handleUpdateHighlight)}},{key:"shouldComponentUpdate",value:function(e,n){var r=e.selectionAPI,o=e.blockManager,i=e.rect,c=n.updateFlag,a=n.ranges,l=this.props,s=l.selectionAPI,u=l.blockManager,d=l.rect,f=this.state,h=f.updateFlag,p=f.ranges;return s!==r||u!==o||d!==i||c!==h||!Object(tt.isEqual)(p,a)}},{key:"generateBlockRangeMap",value:function(){return this.state.ranges.reduce((function(e,n){var r=n.match,o=r.rangeId;return r.type===xl.V.Comment?(e.comment||(e.comment=[]),e.comment.push(n)):e[o]=(e[o]||[]).concat([n]),e}),{})}},{key:"renderContent",value:function(e,n){if("comment"===e)return _e.a.createElement(Fl,{ranges:n,key:e});e=Number(e);var r=this.props.blockManager.getBlockModelByBlockId(e).type;switch(r){case k.B.POLL:return _e.a.createElement(Wl,Object.assign({blockId:e,ranges:n},this.props,{updateFlag:this.state.updateFlag,key:e}));case k.B.BOOKMARK:return _e.a.createElement(Pl,Object.assign({blockId:e,ranges:n},this.props,{updateFlag:this.state.updateFlag,key:e}));case k.B.TASK:return _e.a.createElement(es,Object.assign({blockId:e,ranges:n},this.props,{updateFlag:this.state.updateFlag,key:e}));case k.B.SHEET:return _e.a.createElement(Xl,Object.assign({blockId:e,ranges:n},this.props,{updateFlag:this.state.updateFlag,key:e}));case k.B.BITABLE:return _e.a.createElement(Tl,Object.assign({blockId:e,ranges:n},this.props,{updateFlag:this.state.updateFlag,key:e}));case k.B.WIKI_CATALOG:case k.B.WIKI_RECENT:return _e.a.createElement(rs,Object.assign({blockId:e,blockType:r,key:e,ranges:n,updateFlag:this.state.updateFlag},this.props));default:return _e.a.createElement(ns,Object.assign({blockId:e,ranges:n},this.props,{updateFlag:this.state.updateFlag,key:e}))}}},{key:"render",value:function(){var e=this,n=this.generateBlockRangeMap();return _e.a.createElement(_e.a.Fragment,null,Object.keys(n).map((function(r){return e.renderContent(r,n[r])})))}}]),r}(me.Component),cs=is;function as(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var ls=function(e){G()(r,e);var n=as(r);function r(){return F()(this,r),n.apply(this,arguments)}return H()(r,[{key:"getAfterSlot",value:function(){var e=this;return function(){var n=e.selectionAPI,r=e.blockManager,o=e.rect,i=e.eventEmitter;return _e.a.createElement(cs,{selectionAPI:n,blockManager:r,rect:o,eventEmitter:i})}}}]),r}(Hi.A),ss=r("dx_TAqX"),us=r("dx_WX15"),ds=r("dx_r4mc"),fs=r("dx_BTVV"),hs=r("dx_wvVt"),ps=r("dx_s04s"),vs=["text_indent","align","seq_level","text"],gs=function(){function e(n,r){var o=this;F()(this,e),this.blockManager=n,this.selectionAPI=r,this.observerConfigMap=new Map,this.subs=void 0,this.shouldUpdateSelectedBlock=function(e,n){if(!o.checkIsShouldWatchModel(o.blockManager.getBlockModelByBlockId(e).type))return!1;for(var r=o.blockManager.getBlockModelByBlockId(n[0].id),i=o.blockManager.getBlockModelByBlockId(n[n.length-1].id),c=r;c&&c.id!==i.id;){var a;if((null===(a=c)||void 0===a?void 0:a.id)===e)return!0;c=c.next}return!1},this.checkIsShouldWatchModel=function(e,n){return k.BM.includes(e)},this.generateSelectionFromBlockId=function(e){var n=o.blockManager.getBlockModelByBlockId(e),r={id:e,type:Ei.j.BLOCK};if(o.checkIsShouldWatchModel(n.type,n)){var i=n.zoneState.totalWidth();return{id:e,type:Ei.j.TEXT,selection:{start:0,end:i}}}return r},this.handleBlockModelStructUpdate=function(e){var n=e.model,r=e.action,i=n.id,c=r.child,a=c.position,l=c.id;r.type===u.W.INSERT_CHILD&&o.forEachMatchObserverConfigs(c,(function(e){var n=e.currentSelectedBlocks,r=e.callback,c=n.findIndex((function(e){return e.id===i})),u=s()(n);u.splice(c+a+1,0,o.generateSelectionFromBlockId(l)),e.currentSelectedBlocks=u,r(e.id,u,e.extra)}),!0)},this.handleBlockModelUpdate=function(e){var n=e.model;o.checkIsShouldWatchModel(n.type,n)&&o.forEachMatchObserverConfigs(n,(function(e){var r=e.currentSelectedBlocks,o=e.callback,i=r.find((function(e){return e.id===n.id}));if(i){i.selection.end=n.zoneState.totalWidth();var c=s()(r);e.currentSelectedBlocks=c,o(e.id,c,e.extra)}}))},this.forEachMatchObserverConfigs=function(e,n,r){o.observerConfigMap.forEach((function(i){var c=i.currentSelectedBlocks;r&&c.forEach((function(e){void 0===e.id&&e.recordId&&(e.id=o.blockManager.getBlockIdsByRecordId(e.recordId)[0])})),o.shouldUpdateSelectedBlock(e.id,c)&&n(i)}))};var i=n.modelService;this.subs=[i.blockModelStructUpdate$.subscribe(this.handleBlockModelStructUpdate),i.blockModelUpdate$.subscribe(this.handleBlockModelUpdate)]}return H()(e,[{key:"destroy",value:function(){var e;this.observerConfigMap.clear(),null===(e=this.subs)||void 0===e||e.forEach((function(e){return e.unsubscribe()})),this.subs=null}},{key:"observe",value:function(e,n,r,o){this.selectionAPI.isTextSelectionAcrossBlocks(n)?this.observerConfigMap.set(e,{id:e,currentSelectedBlocks:s()(n),selectedBlocks:n,callback:r,extra:o}):this.disconnect(e)}},{key:"disconnect",value:function(e){this.observerConfigMap.delete(e)}}]),e}();function bs(e){return e.editable}var ys,ms=r("dx_k8kI"),_s=r("dx_TSYQ"),ks=r.n(_s),Os=r("dx_bdgK");!function(e){e.Text="text",e.Block="block"}(ys||(ys={}));var xs=r("dx_b28D"),Es=Object(xs.h)("sync-cursor:inset-delta-manager"),Ss=function(){function e(n){F()(this,e),this.caller=n,this.insetDeltaSubs=[],this.logId=void 0}return H()(e,[{key:"addInsetDeltaListener",value:function(e,n){if(!this.insetDeltaSubs.length){this.logId=e.logId;var r=e.blockMaskManager.hostRectInsetDeltaChange$;r&&(Es(this.logId,"%s: add insetDelta listener",this.caller),this.insetDeltaSubs=[r.subscribe((function(){return n()}))])}}},{key:"removeInsetDeltaListener",value:function(){this.insetDeltaSubs.length&&(Es(this.logId,"%s: remove insetDelta listener",this.caller),this.insetDeltaSubs.forEach((function(e){return e.unsubscribe()})),this.insetDeltaSubs=[])}}]),e}(),Cs=r("dx_E2oU"),Is=function(e){var n=Object(me.useRef)(null),r=Object(me.useState)(!1),o=$e()(r,2),i=o[0],c=o[1],a=Object(uo.useSelector)(Cs.I),l=Object(uo.useSelector)(Cs.j),s=e.boundaryRect,u=Object(me.useCallback)((function(){var e=n.current;if(e){var r=e.getBoundingClientRect().left,o=e.clientWidth,u=window.innerWidth;a?u-=295:l&&(u-=48);var d=s&&s.right?s.right:1/0,f=Math.min(u,d);c(i?r+o+o>f:r+o>f)}}),[i,a,l,s]);Object(me.useEffect)((function(){var e=Object(tt.debounce)(u,300);return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e),e.cancel()}}),[u]),Object(me.useEffect)((function(){u()}),[n,a,l,e,u]);var d=ks()("sync-cursor-name",{"sync-cursor-name-right":e.isOverflow||i}),f=e.name,h=e.backgroundColor;return Object(me.useMemo)((function(){return _e.a.createElement("div",{ref:n,className:d,style:{backgroundColor:h}},f)}),[d,f,h])},Bs=r("dx_KHvq");function Ts(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var ws=function(e){return function(n){G()(o,n);var r=Ts(o);function o(e){var n;return F()(this,o),(n=r.call(this,e)).observer=void 0,n.componentDom=void 0,n.handleBlockStructUpdate=function(){var e=n.props,r=e.blockManager,o=e.data.blockId,i=o&&r.getBlockViewByBlockIdNotCheck(o);i&&(i instanceof Bs.N?i.editor.once(Wc.L.PAINT,(function(){n.updateModelVersion()})):n.updateModelVersion())},n.getComponentRef=function(e){e&&(n.observer&&n.componentDom&&n.observer.unobserve(n.componentDom),n.observer=new Os.S(n.handleResize),n.observer.observe(e),n.componentDom=e)},n.handleResize=Object(tt.debounce)((function(){n.updateModelVersion()}),50),n.state={modelVersion:0},n}return H()(o,[{key:"shouldComponentUpdate",value:function(e,n){if(e.forceUpdateFlag!==this.props.forceUpdateFlag)return!0;var r=Object.assign({},this.props.data,this.state),o=Object.assign({},e.data,n),i=Object.assign({},r,o);return Object.keys(i).some((function(e){return r[e]!==o[e]}))}},{key:"componentDidMount",value:function(){var e=this.props,n=e.blockManager,r=e.data.blockId;n.addListener(Ni.F,this.handleBlockStructUpdate,r)}},{key:"componentWillUnmount",value:function(){var e=this.props,n=e.blockManager,r=e.data.blockId;n.removeListener(Ni.F,this.handleBlockStructUpdate,r),this.observer&&this.componentDom&&(this.observer.unobserve(this.componentDom),this.observer=void 0,this.componentDom=void 0)}},{key:"updateModelVersion",value:function(){this.setState((function(e){return{modelVersion:e.modelVersion+1}}))}},{key:"render",value:function(){return _e.a.createElement("div",{ref:this.getComponentRef,style:{position:"absolute",top:0,left:0,bottom:0,right:0}},_e.a.createElement(e,Object.assign({},this.props,{modelVersion:this.state.modelVersion})))}}]),o}(me.Component)};r("dx_IFVB");function Rs(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Ms(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var js=function(e){G()(r,e);var n=Ms(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).state={active:!1,initLeft:0,isHide:e.getIsHide(),height:0},e.lineHeight=0,e.clearActiveTimer=0,e.lastCursorStyle=null,e.insetDeltaManager=new Ss("SyncCursor"),e.subs=[],e.resizeObserver=void 0,e.mutationObserver=void 0,e.getResizeObserveDom=function(){var n,r=e.props.data.blockId;if(r){var o=e.props.blockManager.getBlockViewByBlockId(r),i=_t()({},k.B.TABLE,(function(){var e;return null===(e=o.hostElement)||void 0===e?void 0:e.querySelector(".scrollable-container")}));return null===(n=i[o.type])||void 0===n?void 0:n.call(i)}},e.getMutationObserveDom=function(){var n,r=e.props.data.blockId;if(r){var o=e.props.blockManager.getBlockViewByBlockId(r),i=_t()({},k.B.TABLE,(function(){var e;return{dom:null===(e=o.hostElement)||void 0===e?void 0:e.querySelector(".scrollable-item"),options:{attributes:!0,attributeFilter:["style"]}}}));return null===(n=i[o.type])||void 0===n?void 0:n.call(i)}},e.handleScroll=function(){if(e.props.scrollBoundary&&void 0!==e.state.initLeft){var n=e.props.scrollBoundary.scrollLeft,r=e.state,o=r.scrollLeft,i=r.initLeft+o-n;e.setState({left:i})}},e.calculateCursorPosition=function(){return e.isTextCursor?e.calculateTextCursor():e.calculateBlockCursor()},e.getLineActualTop=function(n,r){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=W()(e),c=i.lineHeight,a=Math.trunc((n-r)/c)*c+r,l=(0===o||o>=c?0:c-o)/2,s=n-l;return Math.abs(a-s)>3?s:a},e.getTableCellHandle=function(){return{bottom:4,right:0,height:"100%"}},e.activeSyncCursor=function(){clearTimeout(e.clearActiveTimer),e.state.active?e.clearActiveSyncCursor():e.setState({active:!0},(function(){e.clearActiveSyncCursor()}))},e.handleSelectionChange=function(){var n=e.getIsHide();n!==e.state.isHide&&e.setState({isHide:n})},e}return H()(r,[{key:"componentDidMount",value:function(){var e=this.props,n=e.selectionAPI,r=e.scrollBoundary,o=e.blockManager,i=this.props.data.blockId;if(i){n.onSelectionChange(this.handleSelectionChange),r&&r.addEventListener("scroll",this.handleScroll),this.calculateCursorPosition(),ln.S.on(ln.p.MOBILE.COMMON.CHANGE_COVER_UPDATE_SYNC_CURSOR,this.calculateCursorPosition);var c=o.getBlockViewByBlockId(i),a=this.getResizeObserveDom();a&&(this.resizeObserver=new Os.S(this.calculateCursorPosition),this.resizeObserver.observe(a)),this.insetDeltaManager.addInsetDeltaListener(c,this.calculateCursorPosition);var l=this.getMutationObserveDom()||{},s=l.dom,u=l.options;s&&(this.mutationObserver=new MutationObserver(this.calculateCursorPosition),this.mutationObserver.observe(s,function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Rs(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rs(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({},u)))}}},{key:"componentDidUpdate",value:function(e){var n=this.props,r=n.data.start,o=n.forceUpdateFlag,i=n.modelVersion;r===e.data.start&&o===e.forceUpdateFlag&&i===e.modelVersion||(this.activeSyncCursor(),this.calculateCursorPosition()),this.handleSelectionChange()}},{key:"componentWillUnmount",value:function(){var e,n,r=this.props,o=r.selectionAPI,i=r.scrollBoundary;o.offSelectionChange(this.handleSelectionChange),i&&i.removeEventListener("scroll",this.handleScroll),null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.resizeObserver=void 0,null===(n=this.mutationObserver)||void 0===n||n.disconnect(),this.mutationObserver=void 0,this.insetDeltaManager.removeInsetDeltaListener(),this.subs.forEach((function(e){return e.unsubscribe()})),clearTimeout(this.clearActiveTimer),ln.S.off(ln.p.MOBILE.COMMON.CHANGE_COVER_UPDATE_SYNC_CURSOR,this.calculateCursorPosition)}},{key:"getIsHide",value:function(){var e=this.props,n=e.selectionAPI,r=e.data,o=r.blockId,i=r.start,c=!1,a=n.getSelection();if(1===a.length){var l=a[0],s=l.id,u=l.selection,d=u&&u.start;c=s===o&&d===i&&n.isCursor(a)}return c}},{key:"getBlockCursorStyleHandle",value:function(e){var n;return(n={},_t()(n,k.B.FILE,(function(){var n=e.hostElement.querySelector(".file-block");if(n)return{top:0,left:n.getBoundingClientRect().width,height:"200%"}})),_t()(n,k.B.IFRAME,(function(){var n=e.hostElement.querySelector(".iframe-container");if(n){var r=n.getBoundingClientRect();return{top:0,left:r.width+n.offsetLeft,height:r.height}}})),_t()(n,k.B.CHAT_CARD,(function(){if(e.hostElement.querySelector(".chat-card"))return{top:0,right:-3,height:"200%"}})),_t()(n,k.B.IMAGE,(function(){if(e.hostElement.querySelector("img"))return{top:1,right:-3,height:"200%"}})),_t()(n,k.B.POLL,(function(){var n=e.hostElement.querySelector(".poll-block__container");if(n){var r=n.getBoundingClientRect();return{top:0,left:r.width+n.offsetLeft,height:r.height}}})),_t()(n,k.B.TABLE,(function(){var n=e,r=n.hostElement.querySelector(".table"),o=h.S.isIPad?16:0,i=n.scrollManage.getScrollContainer().getBoundingClientRect(),c=i.left,a=i.width,l=i.height,s=r.getBoundingClientRect().width,u=n.hostElement.querySelector(".table-block").getBoundingClientRect().left,d=s>a?a+c-u-1:s;return{top:h.S.isMobile?10:h.S.isIPadSafariBrowser?8:0,left:d,height:l+o}})),_t()(n,k.B.SHEET,(function(){return null})),_t()(n,k.B.BITABLE,(function(){return null})),_t()(n,k.B.CELL,this.getTableCellHandle),_t()(n,k.B.ISV,(function(){var n=e.hostElement.querySelector("op-block");if(n){var r=n.getBoundingClientRect();return{top:0,left:r.width+n.offsetLeft,height:r.height}}})),_t()(n,k.B.BOOKMARK,(function(){var n=e.hostElement.querySelector(".docx-bookmark-wrapper");if(n){var r=n.getBoundingClientRect();return{top:0,left:r.width+n.offsetLeft,height:r.height}}})),_t()(n,k.B.OKR,(function(){var n=e.hostElement.querySelector(".okr-block__objective-wrapper");if(n){var r=e.hostElement.getBoundingClientRect(),o=n.getBoundingClientRect();return{top:o.top-r.top,left:o.width+n.offsetLeft,height:o.height}}})),n)[e.type]}},{key:"clearActiveSyncCursor",value:function(){var e=this;this.clearActiveTimer=window.setTimeout((function(){e.setState({active:!1})}),2e3)}},{key:"setCursorPosition",value:function(e){this.lastCursorStyle=e;var n=e.top,r=e.left,o=e.right,i=e.bottom,c=e.height;if(!(c="number"===typeof c?2*Math.round(c):c))return null;n=n&&Math.round(n),i=i&&Math.round(i),r=r&&Math.round(r),o=o&&Math.round(o);var a=0;this.props.scrollBoundary&&(a=this.props.scrollBoundary.scrollLeft),this.setState({left:r?r-a:r,top:n,bottom:i,initLeft:r,right:o,height:c,scrollLeft:a})}},{key:"getBoundaryRect",value:function(){var e=this.props,n=e.data.blockId,r=e.blockManager,o=n&&r.getBlockViewByBlockIdNotCheck(n);if(o){var i=o.hostElement.closest(".table-cell-block");if(i)return Object(Yl.I)(i.getBoundingClientRect());var c=o.hostElement.closest(".progress-block");return c?Object(Yl.I)(c.getBoundingClientRect()):void 0}}},{key:"getTextDomByBlock",value:function(e){return e.type===k.B.PAGE?document.querySelector(".root-block > .editor-kit-container > .page-block-header .page-block-content"):e.hostElement.querySelector(".text-editor")}},{key:"getTextDomText",value:function(e){return s()(e.children).reduce((function(e,n){var r,o=null===(r=n.textContent)||void 0===r?void 0:r.length;return(o||1)+e}),0)}},{key:"getTextDomRelativeToBlockRect",value:function(e,n){var r=Object(Yl.I)(n.getBoundingClientRect()),o=Object(Yl.I)(e.hostElement.getBoundingClientRect());return Object(Yl.l)(r,o)}},{key:"calculateTextCursor",value:function(){var e=this,n=this.props,r=n.data,o=r.blockId,i=r.start,c=n.blockManager,a=n.rect;if(!o)return null;var l=c.getBlockViewByBlockIdNotCheck(o);if(l&&l.type!==k.B.BLANK){var s=function(n){var r=a.getActualCaretRect(o,Math.max(i,0),o),c=r.top,s=r.left,u=r.height,d=e.getTextDomRelativeToBlockRect(l,n).top;e.lineHeight=e.lineHeight||Math.round(parseFloat(getComputedStyle(n).lineHeight)),e.setCursorPosition({top:e.getLineActualTop(c,d,u),left:s,height:e.lineHeight})};try{var u=l.model.getText();if(u.length>1||[k.B.PAGE,k.B.CODE].includes(l.type)){var d=this.getTextDomByBlock(l);if(!d)return;if(i&&i>u.length||u.length>this.getTextDomText(d))return this.lastCursorStyle&&this.setCursorPosition(this.lastCursorStyle);s(d)}else{var f=this.getTextDomByBlock(l);if(f)s(f);else{var h=a.getActualCaretRect(o,Math.max(i,0),o).left,p=a.getBlockRect(o,o),v=p.top,g=p.height;this.setCursorPosition({top:v,left:h,height:g})}}}catch(b){}}}},{key:"calculateBlockCursor",value:function(){var e=this.props,n=e.data.blockId,r=e.rect,o=e.blockManager;if(!n)return null;var i=o.getBlockViewByBlockIdNotCheck(n);if(!i)return null;var c=this.getBlockCursorStyleHandle(i);if(c){var a=c();return a?this.setCursorPosition(a):null}var l=r.getBlockRect(n,n),s=l.top,u=l.width,d=l.height,f=(i.blockMaskManager.getHostRectInsetDelta()||{rightDelta:0}).rightDelta;return this.setCursorPosition({top:s,left:u-f,height:d})}},{key:"render",value:function(){var e=this.state,n=e.active,r=e.isHide,o=e.left,i=e.right,c=e.top,a=e.bottom,l=e.height,s=this.props.data.type,u=ks()("sync-cursor-wrap",{active:n}),d=ks()("sync-cursor-container",{"is-text-selection":s===Fi.j.TEXT}),f=this.props.data,h=f.name,p=f.color,v=this.getBoundaryRect();return _e.a.createElement("div",{className:d},_e.a.createElement("div",{className:u,style:{top:c,left:o,right:i,bottom:a,opacity:r?0:1},onMouseLeave:this.activeSyncCursor,contentEditable:!1},_e.a.createElement("div",{className:"sync-cursor-caret",style:{height:l,backgroundColor:p}}),_e.a.createElement("div",{className:"sync-cursor-dot",style:{backgroundColor:p}}),h&&""!==h&&_e.a.createElement(Is,{backgroundColor:p,name:h,boundaryRect:v})))}},{key:"isTextCursor",get:function(){return this.props.data.cursorType===ys.Text}}]),r}(me.Component),Ds=ws(js),As=r("dx_Zss7"),Ps=r.n(As),Ls=(r("dx_MWd8"),new Map);function Ns(e,n){var r=e.getBlockIdsByRecordId(n)[0],o=e.getBlockViewByBlockIdNotCheck(r);if(!o)return!1;var i="".concat(n,"-").concat(o.type);if(Ls.has(i))return Ls.get(i);var c=void 0!==Object(tt.get)(o,"props.syncCursorSelected");return Ls.set(i,c),c}var Fs=r("dx_VkAN"),Us=r.n(Fs),Hs=r("dx_Dtiu"),Vs=r.n(Hs);function Ws(){var e=Us()([""]);return Ws=function(){return e},e}function zs(){var e=Us()(["\n  position: absolute;\n  pointer-events: none;\n  z-index: 1;\n  // \u5148\u4e0d\u4f7f\u7528\u6b63\u7247\u53e0\u5e95\uff0c\u539f\u56e0\u662f\u8272\u7cfb\u5dee\u8ddd\u4e0d\u8fdc\u65f6\u4f1a\u6ca1\u6709\u989c\u8272\n  /* mix-blend-mode: multiply; */\n"]);return zs=function(){return e},e}var Gs=Vs.a.div(zs()),Ks=Vs.a.div(Ws());function qs(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Xs(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?qs(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qs(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Ys(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Js=function(e){G()(r,e);var n=Ys(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).state={scrollLeft:0},e.type=e.getBlockType(),e.lineHeight=void 0,e.isShow=e.getIsShow(),e.insetDeltaManager=new Ss("SyncSelection"),e.handleChangeCover=function(){e.reCalculatePosition(e.props)},e.reCalculatePosition=function(n){var r=n.data;r.type===Fi.j.TEXT?e.calculateTextSelection(r):e.calculateBlockSelection(r)},e.handleScroll=function(){if(e.props.scrollBoundary){var n=e.props.scrollBoundary.scrollLeft,r=e.state.scrollLeft,o=e.state,i=o.firstSelectionConfig,c=o.middleSelectionConfig,a=o.endSelectionConfig,l=function(e){return e+r-n};i&&(i=Xs(Xs({},i),{},{left:l(i.initLeft)})),c&&(c=Xs(Xs({},c),{},{left:l(c.initLeft)})),a&&(a=Xs(Xs({},a),{},{left:l(a.initLeft)})),e.setState({firstSelectionConfig:i,middleSelectionConfig:c,endSelectionConfig:a})}},e.handleSelectionChange=function(){var n=e.getIsShow();e.isShow!==n&&(e.isShow=n,e.toggleBlockSelection(n))},e.calculateTextSelection=function(n){var r={middleSelectionConfig:void 0,endSelectionConfig:void 0};try{var o=e.props,i=o.rect,c=o.blockManager,a=o.data.color,l=o.scrollBoundary,s=n.start,u=n.end,d=n.blockId;if(!d)return null;var f=c.getBlockViewByBlockIdNotCheck(d);if(!f)return;var h=f.hostElement.querySelector(".text-editor");if(!h||void 0===s||void 0===u)return;if(s>u){var p=[u,s];s=p[0],u=p[1]}if(l){var v=l.scrollLeft;r.scrollLeft=v}var g=i.getActualCaretRect(d,s,d,!0),b=g.left,y=g.top,m=g.bottom,_=g.height,O=i.getActualCaretRect(d,u,d,!1),x=O.left,E=O.bottom,S=f.type===k.B.PAGE?0:4;if(!e.lineHeight){var C=getComputedStyle(h).lineHeight;e.lineHeight=e.fixed(Number(C.replace("px","")))}var I=W()(e).lineHeight,B=e.fixed((E-m)/e.lineHeight)+1,T=e.getLineActualTop(y,_),w={color:a,left:b,initLeft:b,top:T,width:1===B?x-b:void 0,right:1!==B?4:void 0,height:I};r.firstSelectionConfig=w;var R=T+I;if(B>=2){var M=R;if(B>2){var j=I*(B-2);r.middleSelectionConfig={color:a,left:S,initLeft:S,top:R,right:S,height:j},M=R+j}r.endSelectionConfig={color:a,left:S,initLeft:S,top:M,width:x-S,height:I}}}catch(D){return}e.setState(r)},e.calculateBlockSelection=function(n){if(!e.isCustomize){var r=e.props.data.color,o=e.getBlockView();null===o||void 0===o||o.setSyncSelected(!0);var i=(null===o||void 0===o?void 0:o.blockMaskManager.getHostRectInsetDelta())||{leftDelta:0,rightDelta:0},c=e.getSelectionBorderPosition(),a={borderRadius:e.type!==k.B.CELL?4:0};c.length&&c.forEach((function(e){a["border-".concat(e)]="".concat(r," solid 1px")})),e.setState({blockSelectionConfig:{color:r,left:i.leftDelta,top:0,bottom:0,right:i.rightDelta,extraStyle:a}})}},e.getSelectionBorderPosition=function(){var n=e.props.tableLayoutInfo,r=[];if(!n)return r;var o=n.currentRowIndex,i=n.currentColIndex,c=n.currentRowEndIndex,a=n.currentColEndIndex,l=n.startRowIndex,s=n.endRowIndex,u=n.startColIndex,d=n.endColIndex;return o===l&&r.push("top"),i===u&&r.push("left"),c===s&&r.push("bottom"),a===d&&r.push("right"),r},e.getLineActualTop=function(n,r){var o=W()(e).lineHeight;return n-e.getLineTopGap(o,r)},e.getLineSelection=function(n){if(!n)return null;var r=n.color,o=n.left,i=n.top,c=n.right,a=n.bottom,l=n.width,s=n.height,u=n.extraStyle,d=void 0===u?{}:u,f=Ps()(r).toRgb(),h=f.r,p=f.g,v=f.b,g={backgroundColor:"rgba(".concat(h,",").concat(p,",").concat(v,",0.2)"),left:e.fixed(o),top:e.fixed(i)};return void 0!==a?g.bottom=e.fixed(a):g.height=s,void 0!==c?g.right=e.fixed(c):g.width=l,Object.assign(g,d),_e.a.createElement(Gs,{style:g})},e.fixed=function(e){return Number(e.toFixed(0))},e}return H()(r,[{key:"componentDidMount",value:function(){var e=this,n=this.props,r=n.selectionAPI,o=n.scrollBoundary;o&&o.addEventListener("scroll",this.handleScroll),this.isCustomize&&(r.onSelectionChange(this.handleSelectionChange),this.toggleBlockSelection(this.isShow)),this.reCalculatePosition(this.props),ln.S.on(ln.p.MOBILE.COMMON.CHANGE_COVER_UPDATE_SYNC_CURSOR,this.handleChangeCover);var i=this.getBlockView();i&&this.insetDeltaManager.addInsetDeltaListener(i,(function(){return e.reCalculatePosition(e.props)}))}},{key:"componentDidUpdate",value:function(e){var n=this.getBlockType(),r=!1;this.props.forceUpdateFlag===e.forceUpdateFlag&&this.props.modelVersion===e.modelVersion||this.reCalculatePosition(this.props),this.type!==n&&(this.type=n,r=!0);var o=this.props.data;if(this.isCustomize){var i=o.color,c=o.bgColor,a=e.data,l=a.color,s=a.bgColor;(r||(i!==l||c!==s))&&this.getIsShow()&&this.toggleBlockSelection(!0)}o.type===Fi.j.TEXT&&(e.data.start===o.start&&e.data.end===o.end||this.calculateTextSelection(o))}},{key:"componentWillUnmount",value:function(){var e=this.props.selectionAPI;this.isCustomize&&(e.offSelectionChange(this.handleSelectionChange),this.toggleBlockSelection(!1)),ln.S.off(ln.p.MOBILE.COMMON.CHANGE_COVER_UPDATE_SYNC_CURSOR,this.handleChangeCover),this.insetDeltaManager.removeInsetDeltaListener()}},{key:"getBlockType",value:function(){var e=this.props,n=e.blockManager,r=e.data.blockId,o=r&&n.getBlockViewByBlockIdNotCheck(r);return o?o.type:""}},{key:"getLineTopGap",value:function(e,n){return(e-n)/2}},{key:"toggleBlockSelection",value:function(e){var n=this.props.data,r=n.blockId,o=n.color,i=n.bgColor;ln.S.emit(ln.p.COMMON.SYNC_CURSOR_SELECT,{blockId:r,selected:e,borderColor:e?o:void 0,bgColor:e?i:void 0})}},{key:"getIsShow",value:function(){var e=this.props,n=e.selectionAPI,r=e.data.blockId;return n.getSelection().every((function(e){var n=e.id;return e.type!==Fi.j.BLOCK||n!==r}))}},{key:"getBlockView",value:function(){var e=this.props,n=e.data,r=e.blockManager,o=n.blockId;return o?r.getBlockViewByBlockIdNotCheck(o):void 0}},{key:"render",value:function(){var e=this.props,n=e.data,r=e.blockManager,o=n.blockId,i=n.type;if(!o||!r.getBlockViewByBlockIdNotCheck(o)||this.isCustomize)return null;var c=this.state,a=c.firstSelectionConfig,l=c.middleSelectionConfig,s=c.endSelectionConfig,u=c.blockSelectionConfig;switch(i){case Fi.j.TEXT:return _e.a.createElement(Ks,null,this.getLineSelection(a),this.getLineSelection(l),this.getLineSelection(s));case Fi.j.BLOCK:return this.getLineSelection(u)}}},{key:"isCustomize",get:function(){var e=this.props,n=e.data,r=n.type,o=n.recordId,i=e.blockManager;return r===Fi.j.BLOCK&&Ns(i,o)}}]),r}(me.Component),Zs=ws(Js);r("dx_X58X");function Qs(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var $s=function(e){G()(r,e);var n=Qs(r);function r(e){var o;F()(this,r),(o=n.call(this,e)).container=void 0,o.hadEverEnterBuffer=!1,o.blockMountTimer=void 0,o.handleBlockUpdate=function(e){o.handleBlockMount(e),o.props.blockManager.removeListener(Ni.D,o.handleBlockUpdate)},o.handleBlockMount=function(e){var n=o.props,r=n.recordId,i=n.onBlockMount,c=n.blockId;r===e.model.recordId&&(o.blockMountTimer=setTimeout((function(){o.container=o.getContainer(c),i(r)}),50))},o.handleBlockEnterBuffer=function(e){var n=e.enterBlocks,r=o.props.blockId;!o.hadEverEnterBuffer&&n.includes(r)&&(o.hadEverEnterBuffer=!0,o.doForceUpdate())},o.doForceUpdate=function(){var e=o.props.blockManager;o.container&&o.hadEverEnterBuffer&&(e.removeListener(Ni.T,o.handleBlockMount),e.removeListener(Ni.D,o.handleBlockMount),e.removeListener(ms.a,o.handleBlockMount),o.forceUpdate())};var i=e.blockId,c=e.blockManager;return o.container=o.getContainer(i),o.container||c.addListener(Ni.D,o.handleBlockUpdate),c.addListener(Ni.T,o.handleBlockMount),o.hadEverEnterBuffer=!!i&&c.layoutManager.isBlockActive(i),o.hadEverEnterBuffer||c.addListener(ms.a,o.handleBlockEnterBuffer),o}return H()(r,[{key:"componentDidUpdate",value:function(e){e.blockId&&!this.props.blockId&&(this.container=this.getContainer(e.blockId))}},{key:"componentWillUnmount",value:function(){var e=this.props,n=e.blockManager,r=e.blockId;n.removeListener(Ni.T,this.handleBlockMount),n.removeListener(Ni.D,this.handleBlockUpdate),n.removeListener(ms.a,this.handleBlockEnterBuffer),this.container=null,this.blockMountTimer&&clearTimeout(this.blockMountTimer);var o=r?n.getBlockViewByBlockIdNotCheck(r):void 0;null===o||void 0===o||o.setSyncSelected(!1)}},{key:"getContainer",value:function(e){var n=this.props.blockManager,r=e&&n.getBlockViewByBlockIdNotCheck(e);if(!r)return null;var o=r.hostElement;switch(r.type){case k.B.PAGE:return o.querySelector(".page-block-header");case k.B.IMAGE:return o.querySelector(".image-block-container");case k.B.ISV:return o.querySelector(".isv-block-container");case k.B.CHAT_CARD:return o.querySelector(".chat-card-inner");case k.B.FILE:return o.querySelector(".docx-file-block-container");case k.B.TABLE:return o.querySelector(".table-block");default:return o}}},{key:"renderContent",value:function(){var e=this,n=this.props,r=n.data,o=n.blockManager,i=n.selectionAPI,c=n.rect,a=n.tableLayoutInfo;return r.map((function(n){var r,l=n.memberId,s=n.type,u=n.cursorType,d=n.blockId,f="".concat(l,"-").concat(s,"-").concat(u,"-").concat(d),h=d&&e.props.blockManager.getBlockViewByBlockIdNotCheck(d);if(h)return h.type===k.B.CODE&&(r=h.hostElement.querySelector(".code-block-content .text-editor")),u?_e.a.createElement(Ds,{key:f,forceUpdateFlag:n.forceUpdateFlag,scrollBoundary:r,data:n,blockManager:o,selectionAPI:i,rect:c,tableLayoutInfo:a}):_e.a.createElement(Zs,{key:f,forceUpdateFlag:n.forceUpdateFlag,scrollBoundary:r,data:n,blockManager:o,selectionAPI:i,rect:c,tableLayoutInfo:a})}))}},{key:"render",value:function(){return this.container&&this.hadEverEnterBuffer?so.a.createPortal(_e.a.createElement("span",{className:"sync-cursor-view-wrap"},this.renderContent()),this.container):null}}]),r}(me.PureComponent);function eu(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function tu(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?eu(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eu(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function nu(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var ru=function(e){G()(r,e);var n=nu(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).cursorSelectionMap={},e.customizeBlockMap={},e.getTableLayoutInfo=function(){var n=e.filterEqual(e.props.data),r=e.props.blockManager,o=Object(tt.uniqBy)(n,"recordId");try{if(!(o.length>0&&o.every((function(e){var n=e.blockId&&r.getBlockModelByBlockId(e.blockId);return n&&n.type===k.B.CELL}))))return;var i=e.getParentSnapshot(o[0].blockId),c=Object(Cn.c)(i);return{syncCursorTableLayoutInfo:Object(Cn.xp)({cellIds:o.map((function(e){return Object(Cn.s)(r,e.blockId)})),layoutInfo:c,snapshot:i}),tableLayoutInfo:c}}catch(a){return void console.log("getTableLayoutInfo error",a)}},e}return H()(r,[{key:"mergeColor",value:function(e){return function(e){var n=e.reduce((function(n,r,o){var i=$e()(r,2),c=i[0],a=i[1],l=void 0===a?1:a;return n.r*=parseInt(c.substring(1,3),16),n.g*=parseInt(c.substring(3,5),16),n.b*=parseInt(c.substring(5,7),16),n.a=parseFloat((1-(1-n.a)*(1-l)).toFixed(2)),1!==e.length&&o===e.length-1&&(n.r=Math.round(n.r/255),n.g=Math.round(n.g/255),n.b=Math.round(n.b/255)),n}),{r:1,g:1,b:1,a:0}),r=n.r,o=n.g,i=n.b,c=n.a;return"rgba(".concat(r,", ").concat(o,", ").concat(i,", ").concat(c,")")}(e.reduce((function(e,n){var r=n.cursorType,o=n.color;return!r&&e.push([o,.2]),e}),[]))}},{key:"filterEqual",value:function(e){var n=this,r=Object.values(this.cursorSelectionMap);return e.reduce((function(o,i){var c=i.cursorType,a=i.memberId,l=i.recordId;return c?r.includes(a)&&o.push(i):n.customizeBlockMap[l]?n.customizeBlockMap[l]===a&&o.push(tu(tu({},i),{},{bgColor:n.mergeColor(e)})):o.push(i),o}),[])}},{key:"generateBlockSelectionMap",value:function(){var e=this,n=this.props,r=n.data,o=n.blockManager;return this.customizeBlockMap={},this.cursorSelectionMap={},r.reduce((function(n,r){var i=r.recordId,c=r.start,a=r.memberId,l=r.cursorType;return n[i]=(n[i]||[]).concat([r]),Ns(o,i)&&(e.customizeBlockMap[i]=a),l&&(e.cursorSelectionMap["".concat(i,"-").concat(c)]=a),n}),{})}},{key:"getParentSnapshot",value:function(e){return this.props.blockManager.getBlockModelByBlockId(e).parent.snapshot}},{key:"render",value:function(){var e,n,r,o=this,i=this.props,c=i.rect,a=i.blockManager,l=i.selectionAPI,s=i.data,u=i.onBlockMount,d=this.generateBlockSelectionMap(),f=this.getTableLayoutInfo();return f&&(n=this.getParentSnapshot(s[0].blockId),r=f.tableLayoutInfo),_e.a.createElement(_e.a.Fragment,null,Object.keys(d).map((function(i){var s=d[i],h=o.filterEqual(s),p=s[0].blockId;if(f){var v=Object(Cn.C)({cellIds:[Object(Cn.s)(a,p)],layoutInfo:r,snapshot:n}),g=v.startCol,b=v.startRow,y=v.endCol,m=v.endRow,_=f.syncCursorTableLayoutInfo,k=_.startRow,O=_.endRow,x=_.startCol,E=_.endCol;e={startRowIndex:k,endRowIndex:O,startColIndex:x,endColIndex:E,currentRowIndex:b,currentColIndex:g,currentRowEndIndex:m,currentColEndIndex:y}}return _e.a.createElement($s,{key:p||i,recordId:i,blockId:p,data:h,rect:c,tableLayoutInfo:e,blockManager:a,selectionAPI:l,onBlockMount:u})})))}}]),r}(me.PureComponent),ou=ru;function iu(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function cu(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?iu(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iu(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function au(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var lu=function(e){G()(r,e);var n=au(r);function r(e){var o;F()(this,r),(o=n.call(this,e)).state={data:[]},o.version=0,o.memberIdSet=new Set,o.prevSelections=[],o.clearSelectionTimerMap=new Map,o.updateCursorRaf=null,o.multiSelectionObserver=void 0,o.subs=void 0,o.timers=[],o.forceUpdateSelection=function(e){var n=o.state.data,r=!1;n.forEach((function(n){n.blockId===e&&(n.forceUpdateFlag++,r=!0)})),r&&o.setState({data:s()(n)})},o.handleBlockModelStructUpdate=function(e){var n=e.action,r=n.child;n.type===u.W.CHANGE_CHILD_TYPE&&o.timers.push(setTimeout((function(){o.forceUpdateSelection(r.id)}),50))},o.handleBlockModelUpdate=function(e){var n=e.ops,r=e.model;if(n){var i=!1;n.forEach((function(e){var n=e.p;if(n.includes("view_type")){var c=r.children[0].id;o.timers.push(setTimeout((function(){o.forceUpdateSelection(c)}),50))}else i=i||vs.some((function(e){return n.includes(e)}))})),i&&o.timers.push(setTimeout((function(){o.forceUpdateSelection(r.id)}),50))}},o.updateBlockId=function(e){var n=o.props.blockManager;o.setState((function(r){return{data:r.data.map((function(r){return r.recordId===e?cu(cu({},r),{},{forceUpdateFlag:r.forceUpdateFlag++,blockId:n.getBlockIdsByRecordId(e)[0]}):r}))}}))},o.clearMemberSelection=function(e){o.setState((function(n){var r=n.data,o=r.filter((function(n){return!(n.memberId===e&&n.cursorType!==ys.Text)}));return r.length===o.length?null:{data:o}}))},o.addClearSelectionTimer=function(e){var n=window.setTimeout((function(){return o.clearMemberSelection(e)}),6e4);o.clearSelectionTimerMap.set(e,n)},o.deleteClearSelectionTimer=function(e){if(o.clearSelectionTimerMap.has(e)){var n=o.clearSelectionTimerMap.get(e);clearTimeout(n),o.clearSelectionTimerMap.delete(e)}},o.handleSelectionChange=Object(tt.debounce)((function(e,n){var r=bs(o.props),i=o.isNoneTeamworker(),c=o.isSameSelections(e,n);console.info("docxSyncCursorEvent: sendingMessage: shouldSend: ".concat(r,", isNoneTeamworker: ").concat(i,", isSameSelections: ").concat(c)),!r||i||c||(o.prevSelections=n,o.sendMessage({version:++o.version,selections:o.isSelectAll(n)?[]:o.generateSendSelections(n)}))}),200),o.handleRecordChange=function(e){var n=e.options;o.handleSelectionChange(o.prevSelections,o.props.selectionAPI.getSelection()),n.from===kt.H.remote&&(o.updateCursorRaf||(o.updateCursorRaf=window.requestAnimationFrame((function(){o.updateCursorRaf=null,o.updateCursorImpl()}))),o.throttleUpdateCursor.cancel())},o.handleAutoCompleteForMultiSelection=function(e,n,r){var i=r.userId,c={version:-2,selections:n.map((function(e){return{id:o.props.blockManager.getRecordByBlockId(e.id).id,type:e.type===Fi.j.BLOCK?"block":"text",selection:e.selection}}))};o.pendingMemberSelectionDataMap.set(Number(e),{userId:i,memberId:Number(e),cursorInfo:c,isAutoComplete:!0}),o.throttleUpdateCursor()},o.generateSelectionForMultiSelectionObserver=function(e){var n=o.props.blockManager;return e.map((function(e){return Object.assign({},e,{type:"block"===e.type?Fi.j.BLOCK:Fi.j.TEXT,id:n.getBlockIdsByRecordId(e.id)[0],recordId:e.id})}))},o.handleUpdateCursor=function(e){var n;if(!o.isWrongfulMessage(e)){var r=e.user_id,i=e.member_id,c=e.cursor_info;console.info("docxSyncCursorEvent: updateCursor: memberId: ".concat(i)),Number(null===(n=o.props.blockManager.recordManager.collabModule)||void 0===n?void 0:n.getMemberId())!==i&&(o.pendingMemberSelectionDataMap.set(i,{userId:r,memberId:i,cursorInfo:c}),o.multiSelectionObserver.observe(i.toString(),o.generateSelectionForMultiSelectionObserver(c.selections),o.handleAutoCompleteForMultiSelection,{userId:r})),o.throttleUpdateCursor()}},o.handleNewChangesMessage=function(){o.shortThrottleUpdateCursor.cancel(),o.throttleUpdateCursor=o.longThrottleUpdateCursor,o.pendingMemberSelectionDataMap.size>0&&o.throttleUpdateCursor()},o.pendingMemberSelectionDataMap=new Map,o.updateCursorImpl=function(){o.throttleUpdateCursor=o.shortThrottleUpdateCursor,0!==o.pendingMemberSelectionDataMap.size&&o.setState((function(e){var n=e.data;return o.pendingMemberSelectionDataMap.forEach((function(e){var r=e.userId,i=e.memberId,c=e.cursorInfo,a=c.selections;if(n=n.filter((function(e){return e.userId!==r||(o.memberIdSet.delete(e.memberId),o.deleteClearSelectionTimer(e.memberId),!1)})),a.length){o.memberIdSet.add(i),o.addClearSelectionTimer(i);var l=o.generateUserData({userId:r,memberId:i,cursorInfo:c});n=n.concat(l)}})),o.pendingMemberSelectionDataMap.clear(),{data:n}}))},o.shortThrottleUpdateCursor=Object(tt.throttle)(o.updateCursorImpl,500,{leading:!1,trailing:!0}),o.longThrottleUpdateCursor=Object(tt.throttle)(o.updateCursorImpl,1e3,{leading:!1,trailing:!0}),o.throttleUpdateCursor=o.shortThrottleUpdateCursor,o.handleUserLeave=function(e){var n=e.member_id.map(Number);o.setState((function(e){var r=e.data,i=r.filter((function(e){var r=e.memberId;return!n.includes(r)||(o.memberIdSet.delete(r),o.pendingMemberSelectionDataMap.delete(r),o.deleteClearSelectionTimer(r),!1)}));return r.length===i.length?null:{data:i}}))},o.handleUpdateMember=function(e){o.props.blockManager.editorAPI.getService(zl.H).notifyMembersUpdate(e)};var i=e.blockManager.modelService;return o.subs=[i.blockModelStructUpdate$.subscribe(o.handleBlockModelStructUpdate),i.blockModelUpdate$.subscribe(o.handleBlockModelUpdate)],o.bindEvent(!0),o.multiSelectionObserver=new gs(e.blockManager,e.selectionAPI),o}return H()(r,[{key:"componentDidUpdate",value:function(e){var n=this.props,r=n.editable,o=n.members,i=bs(this.props),c=bs(e);i!==c&&(this.bindSelectionChangeEvent(r),c&&!i&&this.sendMessage({version:++this.version,selections:[]})),o!==e.members&&this.handleFixUserLeaveData()}},{key:"componentWillUnmount",value:function(){var e;this.bindEvent(!1),null===(e=this.subs)||void 0===e||e.forEach((function(e){return e.unsubscribe()})),this.clearSelectionTimerMap.forEach((function(e){return clearTimeout(e)})),this.timers.forEach((function(e){return clearTimeout(e)})),this.handleSelectionChange.cancel(),this.shortThrottleUpdateCursor.cancel(),this.longThrottleUpdateCursor.cancel(),this.multiSelectionObserver.destroy(),this.updateCursorRaf&&window.cancelAnimationFrame(this.updateCursorRaf)}},{key:"render",value:function(){var e=this.props,n=e.rect,r=e.blockManager,o=e.selectionAPI,i=e.translateMode,c=this.state.data;return Object(Bc.Pf)()&&!this.props.editable||i?null:_e.a.createElement(ou,{data:c,rect:n,blockManager:r,selectionAPI:o,onBlockMount:this.updateBlockId})}},{key:"bindSelectionChangeEvent",value:function(e){var n=this.props,r=n.selectionAPI,o=n.blockManager,i=bs(this.props);e&&i?(console.info("docxSyncCursorEvent: start watching selection change"),r.onSelectionChange(this.handleSelectionChange),o.recordManager.on(kt.q.CHANGE,this.handleRecordChange)):(console.info("docxSyncCursorEvent: stop watching selection change"),r.offSelectionChange(this.handleSelectionChange),o.recordManager.off(kt.q.CHANGE,this.handleRecordChange))}},{key:"bindEvent",value:function(e){this.bindSelectionChangeEvent(e);var n=e?"on":"off";console.info("docxSyncCursorEvent: ".concat(e?"start":"stop"," watching message box")),ln.S[n](ln.p.COMMON.UPDATE_CURSOR,this.handleUpdateCursor),ln.S[n](ln.p.COMMON.USER_LEAVE,this.handleUserLeave),ln.S[n](ln.p.COMMON.UPDATE_MEMBERS,this.handleUpdateMember),ln.S[n](ln.p.COMMON.NEW_CHANGES_MESSAGE,this.handleNewChangesMessage)}},{key:"isNoneTeamworker",value:function(){return this.props.members.length<2}},{key:"isSameSelections",value:function(e,n){return n.length===e.length&&!Object(hs.diff)(n,e).length}},{key:"isSelectAll",value:function(e){if(!e.length)return!1;var n=this.props.blockManager,r=n.getBlockModelByBlockId(n.rootBlockId).children,o=Object(ps.h)(r.map((function(e){return e.id})),n);return Object(tt.isEqual)(e,o)}},{key:"generateSendSelections",value:function(e){var n=this.props.blockManager;return e.map((function(e){return cu(cu({},e),{},{id:n.getRecordByBlockId(e.id).id})}))}},{key:"isWrongfulMessage",value:function(e){var n=e.member_id,r=e.user_id,o=e.cursor_info.version;if(this.memberIdSet.size>=50&&!this.memberIdSet.has(n))return!0;var i=this.props.members,c=et.userHelper.getUserFromEntitiesByUserId(r),a=i.some((function(e){return n===Number(e.member_id)}));if(!a){var l,s=null===(l=this.props.blockManager.recordManager.collabModule)||void 0===l?void 0:l.getMemberId();Object(rr.N)("ccm_diagram_block_log_dev",{action:"sync_cursor",text:"noExistMember currentMemberId: ".concat(s,", messageMemberId: ").concat(n)}),console.info("docxSyncCursorEvent: wrongfulMessage: noExistMember currentMemberId: ".concat(s,", messageMemberId: ").concat(n))}if(!a&&!c)return!0;var u=this.pendingMemberSelectionDataMap.get(n);if(u&&u.cursorInfo.version>=o)return console.info("docxSyncCursorEvent: wrongfulMessage: pendingVersion pendingSelectionVersion: ".concat(u.cursorInfo.version,", messageVersion: ").concat(o)),!0;var d=this.state.data.find((function(e){return e.memberId===n}));return!!(d&&d.version>=o)&&(console.info("docxSyncCursorEvent: wrongfulMessage: selectionVersion selectionVersion: ".concat(d.version,", messageVersion: ").concat(o)),!0)}},{key:"hasCursor",value:function(e){return e.some((function(e){return e.cursorType}))}},{key:"padCursor",value:function(e){if(!this.hasCursor(e)){var n=e[e.length-1],r=n.type,o=n.end;if(r===Fi.j.TEXT){var i=o;e.push(cu(cu({},n),{},{start:i,end:i,cursorType:ys.Text}))}else e.push(cu(cu({},n),{},{cursorType:ys.Block}))}}},{key:"generateUserData",value:function(e){var n=e.userId,r=e.memberId,o=e.cursorInfo,i=o.version,c=o.selections,a=this.props,l=a.selectionAPI,s=a.blockManager,u=Object(et.getUserNameFromMembers)(n,Object(et.suiteType)(),Object(et.getToken)())||et.userHelper.getUserName(n),d=et.userColorHelper.getColorByUserId(n),f=c.map((function(e){var o=e.id,c=e.type,a=e.selection,f=s.getBlockIdsByRecordId(o)[0];return{forceUpdateFlag:0,userId:n,memberId:r,version:i,blockId:f,recordId:o,type:c,start:null===a||void 0===a?void 0:a.start,end:null===a||void 0===a?void 0:a.end,name:u,color:d,cursorType:l.isCursor([e])?ys.Text:void 0}}));return this.padCursor(f),f}},{key:"sendMessage",value:function(e){var n,r,o=Number(null===(n=this.props.blockManager.recordManager.collabModule)||void 0===n?void 0:n.getMemberId());console.info("docxSyncCursorEvent: sendMessage: currentMemberId ".concat(o)),null===(r=this.props.blockManager.recordManager.collabModule)||void 0===r||r.sendMessage({type:kt.j.ENGAGEMENT_CURSOR,cursor_info:e},{headers:{path:"/api/room/update_cursor"}})}},{key:"handleFixUserLeaveData",value:function(){var e=this;this.setState((function(n,r){var o=n.data,i=r.members.map((function(e){return Number(e.member_id)})),c=o.filter((function(n){var r=n.memberId;return!!i.includes(r)||(e.memberIdSet.delete(r),e.pendingMemberSelectionDataMap.delete(r),e.deleteClearSelectionTimer(r),!1)}));return o.length===c.length?null:{data:c}}))}}]),r}(me.PureComponent),su=lu,uu=Object(uo.connect)((function(e){return{members:Object(et.selectCurrentSuiteMembers)(e),isEditing:Object(Ea.R)(e)}}),{})(su);function du(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var fu=function(e){G()(r,e);var n=du(r);function r(){return F()(this,r),n.apply(this,arguments)}return H()(r,[{key:"getAfterSlot",value:function(){var e=this;return function(n){var r=e.selectionAPI,o=e.blockManager,i=e.rect,c=n.recursionProps,a=c.editable,l=c.translated,s=void 0!==l&&l;return _e.a.createElement(uu,{editable:a,translateMode:s,selectionAPI:r,blockManager:o,rect:i})}}}]),r}(Hi.A),hu=r("dx_S8Sa"),pu=r("dx_Z7aw"),vu=r("dx_kTtG");function gu(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var bu=["flowbaseRecordOnDelete","performDropToSameLevel","performDropToDifferentLevel"],yu=function(e){G()(r,e);var n=gu(r);function r(e){var o;F()(this,r),(o=n.call(this,e)).subs=[],o.deletedGuids=new Set,o.pendingDeletedGuids=new Set,o.pendingDeletedMap=new Map,o.notify=Object(tt.debounce)(Gt()(Wt.a.mark((function e(){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==o.pendingDeletedGuids.size){e.next=3;break}return vu.z.close(!0),e.abrupt("return");case 3:if(!vu.z.isOpen()){e.next=5;break}return e.abrupt("return");case 5:return Object(rr.N)("ccm_docs_toast_view",{sub_view:"sync_delete_task_center"}),e.next=8,vu.z.open();case 8:if(!e.sent){e.next=12;break}return o.pendingDeletedGuids.clear(),e.abrupt("return");case 12:if(o.pendingDeletedGuids.size){e.next=14;break}return e.abrupt("return");case 14:Object(et.isOnline)()&&o.deleteTasks();case 15:case"end":return e.stop()}}),e)}))),100,{leading:!1,trailing:!0}),o.update=function(e){e(),o.notify()},o.handleOnline=function(){vu.z.isOpen()||o.deleteTasks()},o.isTaskBlockModelEffectiveChange=function(e){var n=e.options,r=n.from,o=n.transactionName;return r===kt.H.local&&e.model.type===k.B.TASK&&!bu.includes(o||"")},o.handleBlockModelCreate=function(e){if(Object(ca.O)()&&o.isTaskBlockModelEffectiveChange(e)){var n=e.model,r=n.taskId;o.pendingDeletedGuids.has(r)?o.update((function(){return o.pendingDeletedGuids.delete(r)})):o.deletedGuids.has(r)&&(o.deletedGuids.delete(r),n.taskModel.restore())}},o.handleBlockModelDestroy=function(e){if(Object(ca.O)()&&o.isTaskBlockModelEffectiveChange(e)){var n=e.model;n.taskId&&!n.taskData.is_deleted&&n.isTaskEditable&&!n.isReference&&o.pendingDeletedMap.set(n.taskId,n.recordId)}},o.afterModelChange=Object(tt.debounce)((function(){o.pendingDeletedMap.forEach((function(e,n){0===o.blockManager.getBlockModelsByRecordId(e).length?o.pendingDeletedGuids.add(n):o.pendingDeletedGuids.delete(n)})),o.pendingDeletedMap.clear(),o.notify()}),100,{leading:!1,trailing:!0});var i=o.blockManager.editorAPI.modelService;return o.subs=[i.blockModelCreate$.subscribe(o.handleBlockModelCreate),i.change$.subscribe(o.afterModelChange),i.blockModelDestroy$.subscribe(o.handleBlockModelDestroy)],window.addEventListener("online",o.handleOnline),o}return H()(r,[{key:"docToken",get:function(){return this.blockManager.getRecordByBlockId(this.blockManager.rootBlockId).id}}]),H()(r,[{key:"deleteTasks",value:function(){var e=this,n=s()(this.pendingDeletedGuids);this.pendingDeletedGuids.clear(),n.forEach((function(n){e.deletedGuids.add(n)})),Object(pu.NM)({deletedGuids:n,recoverGuids:[],docToken:this.docToken})}},{key:"destroy",value:function(){oe()(Y()(r.prototype),"destroy",this).call(this),this.subs.forEach((function(e){return e.unsubscribe()})),window.removeEventListener("online",this.handleOnline)}}]),r}(Hi.A),mu=r("dx_hIpu"),_u=function(e){var n=e.blockManager,r=Object(me.useState)(!0),o=$e()(r,2),i=o[0],c=o[1];return Object(me.useEffect)((function(){var e=function(){var e=Gt()(Wt.a.mark((function e(n){var r;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.options.transactionName,["multiple:deleteMultipleSelection","keyevent:block:backspace"].includes(void 0===r?"":r)){e.next=4;break}return e.abrupt("return");case 4:return c(!1),e.next=7,Object(xi.i)();case 7:c(!0);case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return n.recordManager.on(kt.q.BEFORE_CHANGE,e),function(){n.recordManager.off(kt.q.BEFORE_CHANGE,e)}}),[]),i},ku=r("dx_h0lG"),Ou=function(){function e(n){F()(this,e),this.eventEmitter=n,this.hoverBlock=null}return H()(e,[{key:"update",value:function(e){e!==this.hoverBlock&&(this.eventEmitter.emit(ku.S.COMMON.HOVER_BLOCK_CHANGE,{prev:this.hoverBlock,cur:e}),this.hoverBlock=e)}}]),e}(),xu=eo()({loader:function(){return Promise.all([r.e("dx_k3k"),r.e("dx_p5p"),r.e("dx_G1G"),r.e("dx_N76")]).then(r.bind(null,"dx_fEdh"))},loading:function(){return null}});r("dx_d5ce");function Eu(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Su=function(e){G()(r,e);var n=Eu(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).hoverBlockManager=new Ou(e.eventEmitter),e}return H()(r,[{key:"checkSingleParents",value:function(){var e,n,r=this.selectionAPI.getSelection();if(0===r.length)return"";var o,i,c=r[0],a=r[r.length-1];if(this.blockManager.hasBlockViewByBlockId(c.id)&&(o=this.blockManager.getBlockViewByBlockId(c.id)),this.blockManager.hasBlockViewByBlockId(a.id)&&(i=this.blockManager.getBlockViewByBlockId(a.id)),!(null===(e=o)||void 0===e?void 0:e.parentId)||!(null===(n=i)||void 0===n?void 0:n.parentId))return"";var l=this.blockManager.getBlockViewByBlockId(o.parentId),s=this.blockManager.getBlockViewByBlockId(i.parentId);return l&&s&&l===s?l.record.id:""}},{key:"getSelectionStartPosition",value:function(){var e=this.selectionAPI.getSelection();if(0===e.length)return-1;var n=e[0];return this.blockManager.getBlockModelByBlockId(n.id).position}},{key:"getSelectionEndPosition",value:function(){var e=this.selectionAPI.getSelection();if(0===e.length)return-1;var n=e[e.length-1];return this.blockManager.getBlockModelByBlockId(n.id).position}},{key:"getAfterSlot",value:function(){var e=this;return function(n){return _u({blockManager:e.blockManager})?_e.a.createElement(xu,Object.assign({},e.options,n.recursionProps,{hoverBlockManager:e.hoverBlockManager})):null}}}]),r}(Hi.A),Cu=r("dx_k7kY"),Iu=r("dx_k64k"),Bu=r("dx_nddJ"),Tu=r("dx_by6m"),wu=r("dx_dIhn");function Ru(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Mu(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Ru(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ru(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var ju=Object(tt.throttle)((function(e){Object(wu.f)((function(){Object(et.collectEvent)("doc_bug_track_dev",{action:"toolbar_status_report",info:e})}))}),100);function Du(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ju(JSON.stringify(Mu(Mu({},n),{},{type:e})))}var Au=r("dx_c7yg"),Pu=r("dx_KXll");var Lu,Nu,Fu=function(e){var n=_e.a.useRef(null);return _e.a.useEffect((function(){var r,o=e.block.model.depLoader.getToolbar();e.block.bridge&&o&&(e.block.bridge.setBlockToolbarVisible(!0,e.block.token),null===(r=n.current)||void 0===r||r.appendChild(o));return function(){e.block.bridge&&e.block.bridge.setBlockToolbarVisible(!1,e.block.token)}}),[e.block.model.depLoader,e.block.bridge,e.block.token]),_e.a.createElement("div",{className:"sheet-toolbar-wrapper",ref:n})},Uu=r("dx_USRY");!function(e){e.hover="hover",e.select="select",e.event="event"}(Nu||(Nu={}));var Hu=(Lu={},_t()(Lu,k.B.IMAGE,{triggerBy:[Nu.hover],reverseOverflow:!1,stickTop:!0,blockType:k.B.IMAGE,targetSelector:".image-block-container"}),_t()(Lu,k.B.DIAGRAM,{triggerBy:[Nu.hover],reverseOverflow:!1,stickTop:!0,blockType:k.B.DIAGRAM}),_t()(Lu,k.B.POLL,{triggerBy:[Nu.hover],reverseOverflow:!1,blockType:k.B.POLL,targetSelector:".poll-block__container"}),_t()(Lu,k.B.IFRAME,{triggerBy:[Nu.hover],reverseOverflow:!1,blockType:k.B.IFRAME,targetSelector:"[data-iframe-hover-flag]"}),_t()(Lu,k.B.BOOKMARK,{triggerBy:[Nu.hover],reverseOverflow:!1,blockType:k.B.BOOKMARK,targetSelector:".docx-bookmark-wrapper"}),_t()(Lu,k.B.FILE,{triggerBy:[Nu.hover],reverseOverflow:!1,stickTop:function(e){var n=e;if(n.props.viewType)return n.props.viewType===Uu.t.Preview;if(!n.props.viewType||n.props.viewType===Uu.t.Inline)return!1;var r=Object(Pu.s)(n.model.snapshot.file.name),o=et.FileHelpers.isAudioTypePreview(r),i=et.FileHelpers.isVideoTypePreview(r),c=et.FileHelpers.isImageTypePreview(r),a=et.FileHelpers.isArchiveTypePreview(r);return c||i||o||a},blockType:k.B.FILE,targetSelector:".".concat(Au.H)}),_t()(Lu,k.B.CALLOUT,{triggerBy:[Nu.hover],reverseOverflow:!1,blockType:k.B.CALLOUT}),_t()(Lu,k.B.CHAT_CARD,{triggerBy:[Nu.hover],reverseOverflow:!1,blockType:k.B.CHAT_CARD,targetSelector:".chat-card"}),_t()(Lu,k.B.SHEET,{CustomToolbar:Fu,triggerBy:[Nu.event],direction:function(e){return e?Yi.R.TopLeft:Yi.R.TopCenter},stickTop:!0,blockType:k.B.SHEET,targetSelector:".faster-wrapper"}),_t()(Lu,k.B.ISV,{triggerBy:[Nu.hover],reverseOverflow:!1,blockType:k.B.ISV}),_t()(Lu,k.B.TASK,{triggerBy:[Nu.hover],reverseOverflow:!1,blockType:k.B.TASK,ignoreSelector:".task-block-editor-focused"}),_t()(Lu,k.B.JIRA_ISSUE,{triggerBy:[Nu.hover],reverseOverflow:!1,blockType:k.B.JIRA_ISSUE}),_t()(Lu,k.B.WIKI_CATALOG,{triggerBy:[Nu.hover],blockType:k.B.WIKI_CATALOG}),_t()(Lu,k.B.WIKI_RECENT,{triggerBy:[Nu.hover],blockType:k.B.WIKI_RECENT}),Lu),Vu=ar()("useHoverBlock");var Wu=r("dx_BEcL");function zu(e){var n=Object(me.useState)(!1),r=$e()(n,2),o=r[0],i=r[1];return Object(me.useEffect)((function(){var n=function(){i(!0)};return e.on(he.R.POST_CLIENTVAR_FETCH_ALLOW_EDIT,n),function(){e.off(he.R.POST_CLIENTVAR_FETCH_ALLOW_EDIT,n)}}),[e]),[o]}var Gu=r("dx_BBJ7");function Ku(e,n,r){var o=e.type,i=r[o];return{targetBlock:e,CustomToolbar:i.CustomToolbar,reverseOverflow:!!i.reverseOverflow,blockType:o,direction:(Object(tt.isFunction)(i.direction)?i.direction(n):i.direction)||Yi.R.TopCenter,stickTop:(Object(tt.isFunction)(i.stickTop)?i.stickTop(e):i.stickTop)||!1}}function qu(e,n,r){if(!n||!e)return!1;for(var o=r.getBlockModelByBlockId(n);o.parent;){if(o.parent.id===e)return!0;o=o.parent}return!1}r("dx_EKdI");function Xu(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Yu={},Ju=[0,8],Zu=et.selectors.share.selectCurrentSuiteOtherPermissions,Qu=function(e){G()(r,e);var n=Xu(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).toolbarManager=$i.S,e}return H()(r,[{key:"getAfterSlot",value:function(){var e=this;return function(n){var r=n.recursionProps.editable,o=Object(me.useState)(null),i=$e()(o,2),c=i[0],a=i[1],l=Object(me.useState)(null),s=$e()(l,2),d=s[0],f=s[1],h=e.boundary,p=e.blockManager,v=e.selectionAPI,g=Object(uo.useSelector)(et.selectors.share.ifhaveCommentPermission),b=Object(uo.useSelector)(Zu).exportable,y=Object(uo.useSelector)(Iu.F),m=Object(uo.useSelector)(et.selectors.translate.selectTranslateStatus),_=function(e){var n=e.selectionAPI,r=e.blockManager,o=_e.a.useState(),i=$e()(o,2),c=i[0],a=i[1],l=_e.a.useState(),s=$e()(l,2),u=s[0],d=s[1],f=_e.a.useCallback((function(){var e=n.getSelection(),o=e.length>=1?r.getBlockViewByBlockIdNotCheck(e[0].id):null;if(o){var i,c;if(e[0].type===Fi.j.BLOCK)return a(o),void d(null);if((null===(i=e[0].selection)||void 0===i?void 0:i.start)!==(null===(c=e[0].selection)||void 0===c?void 0:c.end))return a(null),void d(o)}a(null),d(null)}),[n,r]);return _e.a.useEffect((function(){return n.onSelectionChange(f),function(){n.offSelectionChange(f)}}),[n,f]),{selectedBlock:c,textSelectedBlock:u}}({selectionAPI:v,blockManager:p}),O=_.selectedBlock,x=_.textSelectedBlock,E=function(e){var n=Object(me.useState)(null),r=$e()(n,2),o=r[0],i=r[1],c=Object(me.useRef)(!1),a=e.boundary,l=e.blockManager,s=Object(me.useCallback)((function(e){Vu("setToolbarHovered",e),c.current=e,e||i(null)}),[]),u=Object(me.useCallback)((function(){return s(!1)}),[s]),d=Object(Li.S)(u,200),f=Object(me.useCallback)((function(){d.cancel(),s(!0)}),[s]),h=Object(me.useCallback)((function(){return i(null)}),[]),p=Object(me.useCallback)(Object(tt.debounce)((function(e){var n=e.target;if(n instanceof Element){if(Vu("toolbarHovered",c.current),c.current||n.closest(".overlay-container")||!document.contains(n))return;var r=n.closest("div.block"),o=Number(null===r||void 0===r?void 0:r.getAttribute("data-block-id"))||null;if(!o||!ln.X.active)return i(null);var a=l.hasBlockViewByBlockId(o)?l.getBlockViewByBlockId(o):null;if(a){var s=Hu[a.type],u=null===s||void 0===s?void 0:s.targetSelector,d=null===s||void 0===s?void 0:s.ignoreSelector;if(u&&!n.closest(u))return i(null);if(d&&n.closest(d))return i(null)}i(a)}}),100,{trailing:!0}),[l]);return Object(me.useEffect)((function(){return a.addEventListener("mousemove",p),l.addListener(Qi.q,h),function(){a.removeEventListener("mousemove",p),l.removeListener(Qi.q,h)}}),[l,a,p,h]),Object(me.useEffect)((function(){if(o){var e=o.model.destroy$.subscribe(h);return function(){e.unsubscribe()}}}),[o,h]),{block:o,handleMouseEnterToolbar:f,handleMouseLeaveToolbar:d}}({boundary:h,blockManager:p}),S=E.block,C=E.handleMouseEnterToolbar,I=E.handleMouseLeaveToolbar,B=function(){var e=Object(me.useState)(null),n=$e()(e,2),r=n[0],o=n[1],i=Object(me.useRef)(null),c=_e.a.useCallback((function(e){o(e),i.current=e}),[]),a=_e.a.useCallback((function(e){e===i.current&&(o(null),i.current=null)}),[]);return _e.a.useEffect((function(){return ln.S.on(ln.p.TOOLBAR.SHOW_TOOL_BAR,c),ln.S.on(ln.p.TOOLBAR.HIDE_TOOL_BAR,a),function(){ln.S.off(ln.p.TOOLBAR.SHOW_TOOL_BAR,c),ln.S.off(ln.p.TOOLBAR.HIDE_TOOL_BAR,a)}}),[a,c]),r}(),T=Object(me.useMemo)((function(){return function(e){var n,r,o=e.hoverBlock,i=e.selectedBlock,c=e.textSelectedBlock,a=e.blockManager,l=e.eventShowBlock,s=e.editable;if(l&&Hu[l.type])return Ku(l,s,Hu);if(i&&(null===(n=Hu[i.type])||void 0===n||null===(r=n.triggerBy)||void 0===r?void 0:r.includes(Nu.select)))return Ku(i,s,Hu);var d=null;for(o&&o.hostElement&&a.hasBlockModelByBlockId(o.id)&&(d=a.getBlockModelByBlockId(o.id));d;){var f,h,p=d.type;if(null===(f=Hu[p])||void 0===f||null===(h=f.triggerBy)||void 0===h?void 0:h.includes(Nu.hover)){if(qu(d.id,(null===i||void 0===i?void 0:i.id)||u.V,a)||qu(d.id,(null===c||void 0===c?void 0:c.id)||u.V,a))break;if(a.hasBlockViewByBlockId(d.id))return Ku(a.getBlockViewByBlockId(d.id),s,Hu)}d=d.parent}return{targetBlock:null,reverseOverflow:!1,blockType:null,direction:Yi.R.TopCenter}}({selectedBlock:O,textSelectedBlock:x,hoverBlock:S,blockManager:p,eventShowBlock:B,editable:r})}),[O,x,S,p,B,r]),w=T.targetBlock,R=T.blockType,M=T.reverseOverflow,j=T.CustomToolbar,D=T.direction,A=T.stickTop,P=Object(me.useState)(Gu.N.Mouse),L=$e()(P,2),N=L[0],F=L[1],U=Object(me.useMemo)((function(){if(m.translated&&R===k.B.CALLOUT)return!0}),[m.translated,R]),H=function(n){var r=e.selectionAPI.getSelection().filter((function(n){return e.blockManager.hasBlockModelByBlockId(n.id)})).map((function(n){return e.blockManager.getBlockModelByBlockId(n.id)}));return!r.some((function(e){return e.type===k.B.CELL}))||!((null===n||void 0===n?void 0:n.type)!==k.B.CELL||!r.some((function(e){return e.id===(null===n||void 0===n?void 0:n.id)})))}(w),V=Object(me.useCallback)((function(){I(),a(null)}),[]),W=Object(me.useCallback)((function(e){if(w){var n=k.B.CALLOUT,r=k.B.DIAGRAM,o=k.B.SHEET,i=k.B.ISV;!e&&[n,r,o,i].includes(w.type)||V()}}),[V,w]),z=Object(me.useCallback)((function(){W()}),[W]);Object(me.useEffect)((function(){return ln.S.on(ln.p.COMMON.BLOCK_MENU_PANEL_SHOW,z),function(){ln.S.off(ln.p.COMMON.BLOCK_MENU_PANEL_SHOW,z)}}),[z]);var G=Object(me.useCallback)((function(e){var n=Bu.J[e.name]||Bu.J[e.aliasName];if(w&&(e.name||e.aliasName)&&n){var r={},o=Object(Tu.L)(e);o&&(r.actionValue=o),f({extraPrams:r,actionType:n})}}),[c]);Object(me.useEffect)((function(){d&&d.actionType&&w&&w.id&&p.hasBlockViewByBlockId(w.id)&&(Object(Tu.w)(d.actionType,w,null===w||void 0===w?void 0:w.blockManager,d.extraPrams),f(null))}),[d,null===w||void 0===w?void 0:w.id]);var K=Object(me.useCallback)((function(n){var r="sheet"===n.props.type,o=Object(zi.m)(n.id,e.blockManager);Object(Tu.m)(r?qr.H.SELECT_PART:qr.H.HOVER_WHOLE,o)}),[]),q=Object(Gu.Y)(n.editorAPI).editMode;Object(me.useEffect)((function(){(null===w||void 0===w?void 0:w.type)===k.B.SHEET?F(Gu.N.Mouse):F(q)}),[q,null===w||void 0===w?void 0:w.type]),Object(me.useEffect)((function(){if(w){var n=w.type,o=Hu[n].targetSelector,i=(null===w||void 0===w?void 0:w.hostElement)||null;switch(n){case k.B.SHEET:if(!r&&o){var c=e.rect.getBlockRect(e.blockManager.rootBlockId).width,l=w.hostElement.querySelector(o);c>=((null===l||void 0===l?void 0:l.style.width)?parseFloat(null===l||void 0===l?void 0:l.style.width):0)&&(i=l)}break;case k.B.ISV:var s=w;i=s.isInValid?null:s.getContainer();break;default:o&&(i=w.hostElement.querySelector(o))}a(i)}}),[w]),Object(me.useEffect)((function(){return ln.S.on(ln.p.COMMON.HIDE_BLOCK_TOOLBAR,V),function(){ln.S.off(ln.p.COMMON.HIDE_BLOCK_TOOLBAR,V)}}),[V]),Object(me.useEffect)((function(){return e.blockManager.addListener(Qi.q,W),function(){e.blockManager.removeListener(Qi.q,W)}}),[a,W]);var X=zu(e.eventEmitter),Y=$e()(X,1)[0],J=Object(Ki.S)(),Z=$e()(J,1)[0],Q=Object(me.useCallback)((function(){window.setTimeout((function(){R&&Y&&Z.current()}))}),[R,Y]);Object(me.useEffect)((function(){w&&Q()}),[w,Q]),Object(me.useEffect)((function(){if(w){var e=p.getRecordByBlockId(w.id);return e&&e.on(kt.Ra.CHANGE,Q),function(){e&&e.off(kt.Ra.CHANGE,Q)}}}),[p,w,Q]),Object(me.useEffect)((function(){w&&c&&N===Gu.N.Mouse&&K(w)}),[c]);var $=_e.a.useCallback((function(n,r){var o;if(c&&w){var i=w,a=null===(o=e.blockManager.getBlockModelByBlockIdNotCheck(r))||void 0===o?void 0:o.id;a&&Object(Wu.D)(i,a,e.blockManager)&&!Object(Ai.R)(a,e.blockManager,k.B.GRID_COLUMN)&&ln.S.emit(ln.p.COMMON.UPDATE_OVERLAY_POSITION)}}),[c,w]);Object(me.useEffect)((function(){return ln.S.on(Pi.o.ON_SCROLL,$),function(){ln.S.off(Pi.o.ON_SCROLL,$)}}),[$]);var ee=Boolean(w&&e.toolbarManager.canShowPanel(qi.t.BlockToolbar)&&R&&Y&&c&&N===Gu.N.Mouse&&H);Object(me.useEffect)((function(){!ee&&H&&w&&c&&N===Gu.N.Mouse&&Du(qi.t.BlockToolbar,{blockType:R,dataReady:Y,otherToolbarEffect:e.toolbarManager.canShowPanel(qi.t.BlockToolbar)})}),[ee,!w,!c,N,R,Y,H]);var te=Object(me.useCallback)((function(){return{targetBlock:w,showBlockPanel:e.toolbarManager.canShowPanel(qi.t.BlockToolbar),isDataReadyForEdit:Y,target:c,isMouseMode:N===Gu.N.Mouse,notInSelection:H}}),[w,Y,c,N,H]),ne=Object(me.useCallback)((function(){return e.toolbarManager}),[]);Object(me.useEffect)((function(){window.__CCM_DOCX_GET_BLOCK_TOOLBAR_VISIBLE_STATUS__=te,window.__CCM_DOCX_GET_ALL_TOOLBAR_STATUS__=ne}),[te]);var re=Object(me.useMemo)((function(){return w?[w]:[]}),[w]);Object(me.useEffect)((function(){e.toolbarManager.setPanelStatus(qi.t.BlockToolbar,ee)}),[ee]);var oe=Object(me.useMemo)((function(){return{blockType:R,editable:r||!1,commentable:g&&!U,copyable:y,exportable:b}}),[R,r,g,U,y,b]);return _e.a.createElement(Ji.S,{visible:ee,className:"block-toolbar__overlay",selectionAPI:v,blockManager:p,boundary:h,target:c,onClose:z,direction:D,reverse:M,zIndex:Vi.M-1,offset:Ju,sticky:[!0,!!A&&"top"],hideWhenOverflow:!0},j?_e.a.createElement(j,{block:w}):_e.a.createElement(Xi.S,{panelType:qi.t.BlockToolbar,contextBlocks:re,contextExtraProps:Yu,options:oe,forceUpdateRef:Z,fold:e.fold,comment:e.comment,blockManager:p,onClick:G,onClose:W,keyboard:!1,blocks:re,selectionAPI:v,vertical:!0,type:"edit_toolbar",showDivider:!0,boundary:h,onMenuMouseEnter:C,onMenuMouseLeave:I}))}}}]),r}(Hi.A),$u=Qu,ed=r("dx_D26z"),td=r("dx_QJ6a"),nd=r("dx_iCf4"),rd=r("dx_D191"),od=r("dx_an0K");function id(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var cd=function(e){G()(r,e);var n=id(r);function r(){return F()(this,r),n.apply(this,arguments)}return H()(r,[{key:"getWrapper",value:function(e){var n=this;return function(r){var o=_e.a.useState(),i=$e()(o,2),c=i[0],a=i[1],l=_e.a.useState(),s=$e()(l,2),u=s[0],d=s[1],f=_e.a.useState(),h=$e()(f,2),p=h[0],v=h[1],g=_e.a.useState({y:0}),b=$e()(g,2),y=b[0],m=b[1],_=Object(me.useCallback)((function(){p&&Object(Qc.f)(p)&&Object(nd.g)(p.model),a(null),d(null),v(null)}),[p]),k=_e.a.useCallback((function(e,r){var o=n.blockManager.getBlockViewByBlockId(e);_(),r&&r.token&&Object(Qc.U)(o)&&(Object(Wi.T)("ccm_doc_link_edit_page_view",{record_id:o.record.id,block_type:o.type},{}),setTimeout((function(){var e=o.model.isEmpty;a(c),a(!e&&c?c:o.hostElement),d(r),v(o)}),0))}),[_]);Object(me.useEffect)((function(){var e=Object(tt.debounce)((function(){if(c){var e=c.getBoundingClientRect();0===e.x&&0===e.y&&_()}}),200);return document.addEventListener("selectionchange",e),function(){document.removeEventListener("selectionchange",e)}}),[c,_]),Object(me.useEffect)((function(){if(p&&u){var e=u.token;if(p.model.zoneState.getEntities((function(n,r){return n===td.h&&r.indexOf(e)>-1}))){var n=p.hostElement.querySelectorAll(".".concat(ed.n).concat(e));if(0!==n.length){var r=document.createRange();return r.setStart(n[0],0),r.setEnd(n[n.length-1],1),a(r),function(){}}}}}),[p,u]),Object(me.useEffect)((function(){return n.blockManager.addListener(od.q,k),function(){n.blockManager.removeListener(od.q,k)}}),[k]),Object(me.useEffect)((function(){if(c&&p&&p.hostElement){var e=p.hostElement;if(c instanceof Range){for(var n=c.commonAncestorContainer;!(n instanceof Element);){var r;n=null!==(r=n.parentElement)&&void 0!==r?r:e}e=n}var o=parseInt(window.getComputedStyle(e).lineHeight,10),i=c.getBoundingClientRect().height;return m({y:-(i-o)/2}),function(){m({y:0})}}m({y:0})}),[c,p]);var O=Object(me.useRef)(null),x=Object(me.useCallback)((function(){setTimeout((function(){O.current&&O.current.autoFocus()}),0)}),[]),E=Boolean(c&&u&&p);return Object(me.useEffect)((function(){E&&O.current&&x()}),[E,O]),_e.a.createElement("div",null,_e.a.createElement(e,r),E&&_e.a.createElement(Ji.S,{visible:!0,blockManager:n.blockManager,mask:!0,reverse:!0,boundary:n.boundary,selectionAPI:n.selectionAPI,target:c,direction:Yi.R.BottomLeft,onClose:_,animation:Yi.e.None,offset:[0,y.y]},_e.a.createElement(rd.z,{ref:O,boxContext:u,block:p,blockManager:n.blockManager,hidePanel:_})))}}}]),r}(Hi.A),ad=cd,ld=r("dx_C7Cb"),sd=r("dx_xs2W"),ud=r("dx_WzJv");function dd(e){var n=e.selectionAPI,r=e.blockManager,o=_e.a.useState(),i=$e()(o,2),c=i[0],a=i[1],l=Object(Li.S)((function(){var e=n.getSelection();if(1===e.length&&e[0].type===Fi.j.TEXT){var o=e[0].id,i=r.getBlockViewByBlockIdNotCheck(o);if(!i){var c=r.hasBlockModelByBlockId(o);Object(rr.N)("doc_bug_track_dev",{action:"selection_block_view_error",info:JSON.stringify({blockId:o,hasBlockModel:c,recordId:c&&r.getBlockModelByBlockId(o).recordId})})}i&&Object(Qc.f)(i)&&a(i)}else a(null)}),0);return _e.a.useEffect((function(){return l(),n.onSelectionChange(l),function(){n.offSelectionChange(l)}}),[n,l]),c}var fd=r("dx_Sj0J"),hd=r("dx_awlV"),pd=r("dx_IjPx"),vd=r("dx_rCbK"),gd=r("dx_a2aT"),bd=r("dx_f6fH"),yd=r("dx_rGeQ"),md=r("dx_WEEE"),_d=r("dx_tX8z"),kd=r("dx_S6dX");var Od=function(e){var n=e.visible,r=e.blocks,o=e.target,i=e.onClose,c=e.forceUpdateTarget,a=e.thresholdHeight,l=e.maxHeight,s=e.minHeight,u=e.currentRef,d=e.mark,f=e.identifier,h=e.options,p=e.boundary,v=e.blockManager,g=e.selectionAPI,b=e.eventEmitter,y=e.fold,m=e.comment,_=e.Component,k=function(e){var n=e.visible,r=e.target,o=e.boundary,i=e.blockManager,c=e.forceUpdateTarget,a=Object(_d.l)(r,i,n,o),l=Object(me.useState)(a),s=$e()(l,2),u=s[0],d=s[1];return Object(me.useLayoutEffect)((function(){d((function(e){return n&&Object(kd.w)(a)&&c(),Object(tt.isEqual)(e,a)?e:a}))}),[n,a]),u}({visible:n,target:o,boundary:p,blockManager:v,forceUpdateTarget:c}),O=Object(yd.S)(p,v,n),x=Object(me.useState)(l),E=$e()(x,2),S=E[0],C=E[1],I=Object(gd.S)(n),B=Object(md.c)().isOKRBlockEnable,T=Object(me.useState)(Yi.R.None),w=$e()(T,2),R=w[0],M=w[1],j=Object(me.useCallback)((function(e){return M(e),e}),[]),D=Object(me.useCallback)((function(e){var n=e.adaptiveSize,r=Math.max(Math.min(n[Yi.R.BottomLeft].height,null!==l&&void 0!==l?l:I,I),null!==s&&void 0!==s?s:0);if(!a)return C(r),j(Yi.R.BottomLeft);if((R===Yi.R.None||Yi.R.TopLeft===R)&&n[Yi.R.BottomLeft].height<a&&n[Yi.R.TopLeft].height>n[Yi.R.BottomLeft].height){var o=Math.max(Math.min(n[Yi.R.TopLeft].height,null!==l&&void 0!==l?l:I,I),null!==s&&void 0!==s?s:0);return C(o),j(Yi.R.TopLeft)}return C(r),j(Yi.R.BottomLeft)}),[a,l,s,j,I,R]);return Object(me.useEffect)((function(){n?b.emit(gn.t,{source:gn.S.ININE_TRIGGER}):M(Yi.R.None)}),[n]),_e.a.createElement(bd.S,{visible:n,targetRect:k,boundaryRect:O,allowDirections:vd.e,offset:vd.q,calcDirection:D,mask:!0,blockManager:v,selectionAPI:g,transition:!0,onClose:i},_e.a.createElement(_,{blocks:r,currentRef:u,mark:d,onClose:i,blockManager:v,selectionAPI:g,fold:y,comment:m,identifier:f,options:h,maxHeight:S,minHeight:s,isOKRBlockEnable:B,boundary:p}))},xd=r("dx_x2xb"),Ed=r("dx_hJpx"),Sd=r("dx_HA1r"),Cd=eo()({loader:function(){return Promise.all([r.e("dx_k3k"),r.e("dx_p5p"),r.e("dx_G1G"),r.e("dx_N76")]).then(r.bind(null,"dx_X12Q"))},loading:function(){return null}});function Id(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Bd(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Bd(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Bd(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function Td(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var wd=function(e){G()(r,e);var n=Td(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).triggers=[{identifier:xd.A.slash,input:"/",content:Cd,validators:[function(e){return""===e||/\s+$/.test(e)}],thresholdHeight:vd.Q},{identifier:xd.A.slash,input:"\u3001",content:Cd,validators:[function(e){return""===e||/\s+$/.test(e)}],thresholdHeight:vd.Q}].concat(s()(Sd.q.map((function(e){return{identifier:e.identifier,key:e.key,input:e.input,maxHeight:vd.v,thresholdHeight:vd.n,minHeight:vd.r,content:Ed.S,validators:e.validators||[]}})))),e.disableBlocks=[k.B.CODE,k.B.DIAGRAM,k.B.PAGE],e.disableInTitleTriggers=[xd.A.slash,xd.A.mentionAt,xd.A.mentionBracket,xd.A.mentionBracketCN,xd.A.mentionRoundBracket,xd.A.mentionRoundBracketCN],e}return H()(r,[{key:"getModelText",value:function(e){var n;return null!==(n=null===e||void 0===e?void 0:e.model.zoneState.getModelText().slice(0,-1))&&void 0!==n?n:""}},{key:"getAfterSlot",value:function(){var e=this;return function(){var n,r=_e.a.useRef(null),o=_e.a.useRef(null),i=_e.a.useState(),c=$e()(i,2),a=c[0],l=c[1],s=_e.a.useState(null),u=$e()(s,2),d=u[0],f=u[1],h=_e.a.useState({}),p=$e()(h,2),v=p[0],g=p[1],b=dd({blockManager:e.blockManager,selectionAPI:e.selectionAPI}),y=Object(pd.S)(b),m=Object(me.useRef)(null),_=Object(me.useCallback)((function(e,n){var r,o;e.classList.add(vd.K),e.setAttribute(vd.s,n?null===(r=y.current)||void 0===r?void 0:r.mentionPlaceHolder:null===(o=y.current)||void 0===o?void 0:o.slashPlaceHolder),m.current=function(){e.removeAttribute(vd.s),e.classList.remove(vd.K)}}),[]),k=Object(me.useCallback)((function(e){if(e instanceof HTMLElement){var n=e.innerText,r=Sd.R.includes(n);_(e,r)}else if(e){var o=e.startContainer,i=o.innerText,c=Sd.R.includes(i);_(o,c)}}),[_]),O=Object(me.useRef)(null),x=Object(me.useCallback)((function(e){var n;if(null===(n=O.current)||void 0===n||n.call(O),e){var r=e instanceof HTMLElement?e:e.startContainer;r.classList.add(vd.p),O.current=function(){r.classList.remove(vd.p)}}}),[]),E=_e.a.useCallback(function(){var e=Gt()(Wt.a.mark((function e(n){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.current=n.uuid,l(n.identifier),x(n.target),f(n.target),g(n.options||{});case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[x]),S=_e.a.useCallback((function(){var e,n;null===(e=m.current)||void 0===e||e.call(m);var o=r.current;if(r.current=null,l(void 0),null===(n=O.current)||void 0===n||n.call(O),f(null),g({}),b&&b.editor&&o){var i=b.model.zoneState;setTimeout((function(){b.model.isDestroyed||i.getEntities([["trigger",o]]).forEach((function(e){b.model.toggleMark({trigger:o},e,!0,{nonundoable:!0})}))}),0)}}),[b]),C=_e.a.useCallback((function(n,r){var o=n.input,i=n.identifier;if(o&&Sd.R.includes(o)){if(!b)return;var c=b.type,a=b.record,l=Object(ud.D)(a);Object(Wi.P)("ccm_doc_content_page_click",{record_id:a.id,block_type:c,sub_block_type:l},{target:"ccm_mention_panel_view",click:"open_mention_panel"})}i===xd.A.slash&&b&&Object(Kr.g)({blockManager:e.blockManager,subClick:r?"eng_space_slash":"eng_slash",blockId:b.id})}),[b,e.blockManager]),I=_e.a.useCallback(function(){var n=Gt()(Wt.a.mark((function n(o){var i,c,a,l,s,u,d;return Wt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("flushInput"===o.options.type||"composition"===o.options.type){n.next=2;break}return n.abrupt("return");case 2:if(i=Object.keys(o.changes)[0]){n.next=5;break}return n.abrupt("return");case 5:c=o.deltaSet.get(i),a="",l=Id(c.ops);try{for(l.s();!(s=l.n()).done;)(u=s.value).insert&&(a+=u.insert)}catch(f){l.e(f)}finally{l.f()}if(!b||!a||r.current){n.next=14;break}return n.delegateYield(Wt.a.mark((function n(){var r,o,i,c,l,s,u,d,f,h,p,g,y,m,_,O;return Wt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=b.model.getSelection()){n.next=3;break}return n.abrupt("return",{v:void 0});case 3:o=r.toPosition(),i=o.start+o.len,c=a.length,l=a.slice(0,1),s=b.model.zoneState.getModelText().slice(0,i-c),u=b.model.zoneState.getEntities(o.toRange()),d=Id(e.triggers),n.prev=10,d.s();case 12:if((f=d.n()).done){n.next=32;break}if(h=f.value,p=h.input&&(l!==h.input||b.model.zoneState.getModelText().slice(0,i-c).endsWith(h.input)),!h.validators.some((function(e){return!e(s,u)}))&&!p){n.next=18;break}return n.abrupt("continue",30);case 18:if(!e.disableInTitleTriggers.includes(h.identifier)||!e.disableBlocks.includes(b.props.type)){n.next=20;break}return n.abrupt("break",32);case 20:return C(h,s),g=Object(ld.S)(),y=new Vc.e({zoneId:b.model.zoneId,editor:b.editor,start:i-c,len:c}),n.next=25,b.model.toggleMark({trigger:g},y.toRange());case 25:return m=b.hostElement.querySelector(".trigger-holder-".concat(g)),_=!0,h.identifier===xd.A.slash&&i>1&&b.editor&&(O=new Vc.e({zoneId:b.model.zoneId,editor:b.editor,start:i-2,len:1}).toRange(),"inline-component"in b.model.getAttributes(O.start,O.end).toMap()&&(_=!1)),_&&m&&(1===e.getModelText(b).length&&k(m),E({target:m,identifier:h.identifier,uuid:g,options:v})),n.abrupt("break",32);case 30:n.next=12;break;case 32:n.next=37;break;case 34:n.prev=34,n.t0=n.catch(10),d.e(n.t0);case 37:return n.prev=37,d.f(),n.finish(37);case 40:case"end":return n.stop()}}),n,null,[[10,34,37,40]])}))(),"t0",11);case 11:if(d=n.t0,"object"!==_r()(d)){n.next=14;break}return n.abrupt("return",d.v);case 14:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),[b,E,k,v]),B=_e.a.useRef([]),T=Object(me.useCallback)((function(e){return Array.from(e.hostElement.querySelectorAll(".trigger-holder-".concat(r.current)))}),[]),w=Object(me.useCallback)((function(e){B.current=e;var n=document.createRange();return e.length>0&&(n.setStart(e[0],0),n.setEnd(e[e.length-1],1),f(n)),n}),[]),R=Object(me.useCallback)((function(){b&&w(T(b))}),[b,T,w]),M=_e.a.useCallback((function(n){var o=n.current;if(b&&r.current&&a){var i=T(b),c=i.reduce((function(t,e){return t+e.innerText}),"");if(1===o.start.offset&&1===o.end.offset&&1===e.getModelText(b).length){var l=c.slice(0,1);if(l){var s=Sd.R.includes(l);(["\u3001","/"].includes(l)||s)&&_(i[0],s)}}else{var u;null===(u=m.current)||void 0===u||u.call(m)}var f=function(){E({target:w(i),identifier:a,uuid:r.current,options:v})};if(d){var h=Object(fd.Q)(b,{trigger:r.current});if(h){var p,g=b.model.zoneState.getModelText().slice(h[0],h[1]);Object(sd.t)(g)&&S();var y=null===(p=b.model.getSelection())||void 0===p?void 0:p.toPosition();if(y&&y.start>=h[0]&&y.start+y.len<=h[1])return void(i.some((function(e){return-1===B.current.findIndex((function(n){return e===n}))}))&&f())}return void S()}if(i.length>0&&c){var k=e.triggers.find((function(e){return e.identifier===a}));return void(k&&k.input&&!c.startsWith(k.input)||c.endsWith("  ")?S():f())}}}),[b,a,d,S,T,w,_]),j=_e.a.useCallback((function(e){o.current=e;var n=o.current&&o.current.keyCode;n!==hd.G.RIGHT&&n!==hd.G.LEFT&&n!==hd.G.ESC||S()}),[]),D=_e.a.useCallback((function(e){var n;null===(n=m.current)||void 0===n||n.call(m)}),[b,E,v]);Object(me.useEffect)((function(){if(b&&b.editor){var e=b.editor,n=b.model.zoneId;return e.on(Wc.L.CONTENT_CHANGE,I,{zoneId:n}),e.on(Wc.L.KEYDOWN,j,{zoneId:n}),e.on(Wc.L.COMPOSITION_START,D,{zoneId:n}),e.on(Wc.L.SELECTION_CHANGE,M,{zoneId:n}),function(){var e=b.editor;e.off(Wc.L.CONTENT_CHANGE,I),e.off(Wc.L.KEYDOWN,j),e.off(Wc.L.COMPOSITION_START,D),e.off(Wc.L.SELECTION_CHANGE,M)}}}),[b,I,M,j]),Object(me.useEffect)((function(){var n=function(n){E(n),1===e.getModelText(y.current).length&&k(n.target)};return e.blockManager.addListener(vd.X,n),e.blockManager.addListener(vd.b,S),function(){e.blockManager.removeListener(vd.b,S),e.blockManager.removeListener(vd.X,n)}}),[E,S,k]);var A=e.triggers.find((function(e){return e.identifier===a})),P=null===A||void 0===A?void 0:A.content;return _e.a.createElement(Od,{visible:Boolean(d&&b&&P&&e.comment),blocks:[b],target:d,forceUpdateTarget:R,Component:P,thresholdHeight:null===A||void 0===A?void 0:A.thresholdHeight,minHeight:null===A||void 0===A?void 0:A.minHeight,maxHeight:null===A||void 0===A?void 0:A.maxHeight,mark:{trigger:null!==(n=r.current)&&void 0!==n?n:""},onClose:S,identifier:a,eventEmitter:e.eventEmitter,options:v,currentRef:o,blockManager:e.blockManager,selectionAPI:e.selectionAPI,boundary:e.boundary,fold:e.fold,comment:e.comment})}}}]),r}(Hi.A),Rd=r("dx_hrzn"),Md=r("dx_O49O");function jd(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Dd=function(e){G()(r,e);var n=jd(r);function r(){return F()(this,r),n.apply(this,arguments)}return H()(r,[{key:"getAfterSlot",value:function(){var e=this;return function(){var n=_e.a.useState(!1),r=$e()(n,2),o=r[0],i=r[1],c=_e.a.useState(!1),a=$e()(c,2),l=a[0],s=a[1],u=_e.a.useState(null),d=$e()(u,2),f=d[0],h=d[1],p=_e.a.useState(null),v=$e()(p,2),g=v[0],b=v[1],y=function(){h(null),b(null),s(!1)},m=_e.a.useCallback((function(e){setTimeout((function(){var n=e.block.model.isEmpty,r=document.getSelection(),o=r&&r.rangeCount>0?r.getRangeAt(0):void 0;!n&&o?(h(e.block),b(o)):(h(e.block),b(e.block.hostElement)),e.block.editor.blur()}),0)}),[]);_e.a.useEffect((function(){return e.blockManager.addListener(Rd.Jk,m),e.blockManager.addListener(Rd.J,y),function(){e.blockManager.removeListener(Rd.Jk,m),e.blockManager.removeListener(Rd.J,y)}}),[m,y]);return _e.a.useEffect((function(){!o&&l&&(h(null),b(null),s(!1))}),[o,l]),g&&f?_e.a.createElement(Md.S,{block:f,target:g,boundary:e.boundary,blockManager:e.blockManager,selectionAPI:e.selectionAPI,onClose:function(e){o||(h(null),b(null)),e.target instanceof Element&&e.target.closest(".cooperater-user-popover")||s(!0)},onVisibleChange:i}):null}}}]),r}(Hi.A),Ad=r("dx_Mpt7"),Pd=r("dx_Dsxx"),Ld=r("dx_Nc7r"),Nd=r("dx_UhQm"),Fd=r("dx_Z8yN"),Ud=r("dx_nQiu");function Hd(e){var n=e.visible,r=e.referencePoint,o=e.targetRect,i=e.boundaryRect,c=e.isMultipleClick,a=void 0!==c&&c,l=Object(me.useRef)(Yi.f.None),s=Object(me.useRef)(Yi.R.None),u=Object(me.useRef)({}),d=Object(me.useRef)({x:0,y:0});Object(me.useLayoutEffect)((function(){n||(l.current=Yi.f.None,s.current=Yi.R.None,u.current={},d.current={x:0,y:0})}),[n]);var f=Object(me.useCallback)((function(e){var n=e.adaptiveSize,i=e.contentRect,c=e.currentDirection;if(!r||!Object(kd.E)(o))return Yi.R.None;if(s.current!==Yi.R.None)return s.current;if(c!==Yi.R.None)return c;var u,f=n[Yi.R.TopCenter];return u=o.height<=Ud.z?f.height<i.height?Yi.c.Bottom:Yi.c.Top:a&&o.height<=Ud.Y?Yi.c.Top:Object(kd.I)(r,o),d.current={x:r.x-o.left,y:0},u===Yi.c.Top?(f.height>=i.height?(l.current=Yi.f.OutBox,s.current=Yi.R.TopCenter):l.current=Yi.f.StickTop,Yi.R.TopCenter):u===Yi.c.Middle?(l.current=Yi.f.Fixed,d.current={x:d.current.x,y:r.y-o.top},f.height-o.top+r.y>=i.height?Yi.R.TopCenter:Yi.R.BottomCenter):(n[Yi.R.BottomCenter].height>=i.height?(l.current=Yi.f.OutBox,s.current=Yi.R.BottomCenter):l.current=Yi.f.StickBottom,Yi.R.BottomCenter)}),[r,o]),h=Object(me.useCallback)((function(e){var n=e.contentRect,o=e.targetRect,c=e.viewportInfo,a=e.offsetInfo,f=e.direction,h=e.bodyRect;if(r&&f!==Yi.R.None){if(l.current===Yi.f.OutBox)return u.current={},Object(kd.r)({contentRect:n,viewportInfo:c,direction:f,offsetInfo:a,targetRect:new DOMRect(d.current.x+o.left,o.top,1,o.height),bodyRect:h});if(l.current===Yi.f.Fixed)return u.current={},Object(kd.r)({contentRect:n,viewportInfo:c,direction:f,offsetInfo:a,targetRect:new DOMRect(d.current.x+o.left,o.top+d.current.y,1,1),bodyRect:h});if(0===Object.keys(u.current).length){u.current=Object(kd.r)({contentRect:n,viewportInfo:c,direction:f,offsetInfo:a,targetRect:new DOMRect(d.current.x+o.left,o.top,1,o.height),bodyRect:h});var p=Object(kd.h)({positionInfo:u.current,contentRect:n,viewportInfo:c,boundaryRect:i,bodyRect:h});p.top>0&&(Object(tt.isUndefined)(u.current.top)?u.current.bottom-=p.top:u.current.top+=p.top),p.bottom>0&&(Object(tt.isUndefined)(u.current.top)?u.current.bottom+=p.bottom:u.current.top-=p.bottom)}var v=Object(kd.h)({positionInfo:u.current,contentRect:n,viewportInfo:c,boundaryRect:new DOMRect(o.left,o.top-a[1]-n.height,o.width,o.height+2*a[1]+2*n.height),bodyRect:h});return v.top>0&&(l.current=Yi.f.OutBox,s.current=Yi.R.TopCenter,Object(tt.isUndefined)(u.current.top)?u.current.bottom-=v.top:u.current.top+=v.top),v.bottom>0&&(l.current=Yi.f.OutBox,s.current=Yi.R.BottomCenter,Object(tt.isUndefined)(u.current.top)?u.current.bottom+=v.bottom:u.current.top-=v.bottom),u.current}return{}}),[r,i]);return[f,h]}function Vd(e,n,r){var o=Object(me.useState)(n),i=$e()(o,2),c=i[0],a=i[1],l=Object(me.useRef)(null),s=Object(me.useRef)(r);return Object(me.useLayoutEffect)((function(){s.current=r,e&&n&&Object(kd.E)(r)&&a((function(e){return e||(n.x<=r.left?(l.current=0,{x:r.left,y:n.y}):n.x>=r.left+r.width?(l.current=1,{x:r.left+r.width,y:n.y}):(l.current=(n.x-r.left)/r.width,n))})),e||(l.current=null,a(null))}),[e,n,r]),Object(me.useEffect)((function(){if(e){var n=function(){a((function(e){if(e&&null!==l.current){var n={x:s.current.left+s.current.width*l.current,y:e.y};return Object(tt.isEqual)(n,e)?e:n}return e}))};return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}}),[e]),c}var Wd=r("dx_FNDK");function zd(e,n){return n.hasBlockModelByBlockId(e.id)?function(e){return e.parent&&[k.B.QUOTE_CONTAINER,k.B.GRID_COLUMN].includes(e.parent.type)?e.parent.id:-1}(n.getBlockModelByBlockId(e.id)):-1}function Gd(e,n){return n.hasBlockModelByBlockId(e.id)?function(e){for(var n=e;n;){if([k.B.QUOTE_CONTAINER,k.B.GRID_COLUMN].includes(n.type))return n.id;n=n.parent}return-1}(n.getBlockModelByBlockId(e.id)):-1}function Kd(e,n,r,o,i,c,a){var l=Object(me.useState)(e),s=$e()(l,2),u=s[0],d=s[1];return Object(me.useEffect)((function(){d((function(l){var s=Object(kd.w)(e)&&2===(null===a||void 0===a?void 0:a.length)?function(e){var n=$e()(e,2),r=n[0],o=n[1],i=Object(_d.e)(r.hostElement),c=i.top,a=i.left,l=Object(_d.e)(o.hostElement),s=l.bottom,u=l.right;return new DOMRect(a,c,u-a,s-c)}(a):function(e,n,r,o,i,c){if(0===r.length||c&&!n)return new DOMRect(0,0,0,0);var a=r[0],l=function(e,n){for(var r=e.length,o=e[r-1],i=r-1;i>=0;i--)if(n.isShow(e[i].id)){o=e[i];break}return o}(r,o);if(c){var s=Gd(a,i),u=Gd(l,i),d=document.getSelection();if(s===u)return Object(_d.e)(Object(Wd.K)(d,0));var f=Object(Wd.P)(d,Object(Wd.K)(d,0)),h=n,p=$e()(h,2),v=p[0],g=p[1],b=function(e){if(!i.hasBlockViewByBlockId(e.id))return new DOMRect(0,0,0,0);var n=i.getBlockViewByBlockId(e.id);if(e.type===Fi.j.TEXT){var r=document.createRange(),o=n.editor.selection.toDOMRange(Object(Wd.i)(i,e,!1));return r.setStart(o.startContainer,o.startOffset),r.setEnd(o.endContainer,o.endOffset),Object(_d.e)(r)}return Object(_d.e)(n.hostElement)},y=b(v),m=y.top,_=y.left,k=y.right,O=b(g),x=O.left,E=O.bottom,S=O.right;return E>=m&&S>=_?new DOMRect(_,m,S-_,E-m):f?new DOMRect(_,m,k-_,999):new DOMRect(x,E-999,S-x,999)}if(zd(a,i)===zd(l,i))return e;var C=Object(_d.e)(a.hostElement),I=C.top,B=C.left,T=Object(_d.e)(l.hostElement),w=T.bottom,R=T.right;return new DOMRect(B,I,R-B,w-I)}(e,n.current,r,o,i,c);return Object(kd.K)(l,s)?l:s}))}),[e,r,o,i,a]),u}var qd=[Yi.R.TopCenter,Yi.R.BottomCenter],Xd=[0,8],Yd=[!0,!1],Jd=function(e){var n=e.visible,r=e.target,o=e.selectedBlockTupleRef,i=e.blocks,c=e.onClose,a=e.mousePoint,l=e.boundary,s=e.fold,u=e.blockManager,d=e.selectionAPI,f=e.children,p=e.getSelectionsRange,v=e.forceUpdateTarget,g=d.isTextSelectionAcrossBlocks(),b=function(e,n,r,o,i){var c=Object(_d.l)(e,n,r,o),a=Object(me.useRef)(!1);return Object(me.useEffect)((function(){r&&Object(kd.w)(c)?a.current||(a.current=!0,i()):a.current=!1}),[c]),c}(r,u,n,l,v),y=Object(yd.S)(l,u,n,Ud.S),m=Kd(b,o,i,s,u,g,Object(me.useMemo)((function(){return n&&(null===r||void 0===r?void 0:r.collapsed)?p():void 0}),[null===r||void 0===r?void 0:r.collapsed,p,n])),_=Vd(n,a,m),k=Hd({visible:n,referencePoint:_,targetRect:m,boundaryRect:y}),O=$e()(k,2),x=O[0],E=O[1];return _e.a.createElement(bd.S,{visible:n,allowDirections:qd,offset:Xd,sticky:Yd,targetRect:m,zIndex:h.S.isLarkFeed?Qi.d:Vi.M,boundaryRect:y,calcDirection:x,calcPosition:E,onClose:c,blockManager:u,selectionAPI:d},f)};function Zd(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Qd={className:"text-toolbar"},$d={},ef=function(e){G()(r,e);var n=Zd(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).toolbarManager=$i.S,e.excludeSources=["MenuTrigger","Paste"],e}return H()(r,[{key:"getAfterSlot",value:function(){var e=this,n=this.getSlot();return function(r){return _u({blockManager:e.blockManager})?_e.a.createElement(n,r):null}}},{key:"getSlot",value:function(){var e,n=this,r=function(e){return k.o.includes(e.type)};return function(o){var i=o.recursionProps.editable,c=_e.a.useState(null),a=$e()(c,2),l=a[0],s=a[1],u=_e.a.useRef(null),d=_e.a.useState(null),f=$e()(d,2),p=f[0],v=f[1],g=Object(Gu.Y)(o.editorAPI).editMode,b=Object(uo.useSelector)(Cs.L,Ad.E),y=Object(uo.useSelector)(et.selectors.share.ifhaveCommentPermission),m=Object(me.useState)(!1),_=$e()(m,2),O=_[0],x=_[1],E=function(e){var n,r;return!(e.type===Fi.j.TEXT&&(null===(n=e.selection)||void 0===n?void 0:n.start)===(null===(r=e.selection)||void 0===r?void 0:r.end))},S=function(e,n){var r=Object(me.useState)(!0),o=$e()(r,2),i=o[0],c=o[1],a=Object(me.useRef)(!1);return Object(me.useEffect)((function(){if(h.S.isIPad){var r=function(){c(!1),a.current=!0},o=function(o){if(n.offSelectionChange(r),a.current){c(!0);var i=o.touches[0];a.current=!1,e({x:i.clientX,y:i.clientY})}},i=function(){n.onSelectionChange(r)};return document.addEventListener("touchstart",i),document.addEventListener("touchend",o),function(){document.addEventListener("touchstart",i),document.removeEventListener("touchend",o)}}}),[e,n]),i}(v,n.selectionAPI),C=Object(Ld.w)({selectionAPI:n.selectionAPI,blockManager:n.blockManager,recursive:!0,excludeSources:n.excludeSources,selectionFilter:E,fold:n.fold}),I=Object(me.useMemo)((function(){return C.filter((function(e){return r(e)}))}),[C]),B=Object(Ld.w)({selectionAPI:n.selectionAPI,blockManager:n.blockManager,recursive:!1,excludeSources:n.excludeSources,filter:r,selectionFilter:E,fold:n.fold}),T=n.selectionAPI.getContext(),w=Object(me.useMemo)((function(){var e=n.selectionAPI.getSelection();return S&&!n.selectionAPI.isCursor()&&!n.selectionAPI.isSingleTextSelection(e)&&g===Gu.N.Mouse&&n.toolbarManager.canShowPanel(qi.t.TextualBlockToolbar)&&!O&&((null===T||void 0===T?void 0:T.source)===Fi.q.Destroy||e.length>0)&&I.length>0&&!I.every((function(e){return e.model.isEmpty}))&&I.every((function(e){return!e.model.isRoot}))&&(null===T||void 0===T?void 0:T.source)!==Fi.q.Undo&&!((null===T||void 0===T?void 0:T.source)===Fi.q.TurnInto&&!n.toolbarManager.getPanelStatus(qi.t.TextualBlockToolbar))}),[I,null===T||void 0===T?void 0:T.source,g,O,S]),R=Object(me.useCallback)((function(){v(null)}),[]),M=Object(me.useCallback)((function(){x(!0),R()}),[]);Object(me.useEffect)((function(){var e=function(e){var n=e.event;if(n){var r={x:n.clientX,y:n.clientY};x(!1),v(r)}};return n.selectionAPI.on(Jr.j.start,M),n.selectionAPI.on(Jr.j.stop,e),function(){n.selectionAPI.off(Jr.j.start,M),n.selectionAPI.off(Jr.j.stop,e)}}),[M]),Object(me.useEffect)((function(){g===Gu.N.Keyboard&&R()}),[g,R]);var j=Object(me.useMemo)((function(){return Boolean(w&&p)}),[w,p]);Object(me.useEffect)((function(){var e=n.selectionAPI.isSingleTextSelection(n.selectionAPI.getSelection());!j&&l&&g===Gu.N.Mouse&&!e&&I.length>0&&Du(qi.t.TextualBlockToolbar,{padSelecting:S,cursor:n.selectionAPI.isCursor(),selecting:O,empty:I.every((function(e){return e.model.isEmpty})),hasRoot:I.some((function(e){return e.model.isRoot})),byUndo:(null===T||void 0===T?void 0:T.source)===Fi.q.Undo,afterTurninto:!((null===T||void 0===T?void 0:T.source)===Fi.q.TurnInto&&n.toolbarManager.getPanelStatus(qi.t.TextualBlockToolbar)),otherToolbarEffect:n.toolbarManager.canShowPanel(qi.t.TextualBlockToolbar),mouseInfo:!!p})}),[j,!l,I,null===T||void 0===T?void 0:T.source,g,O,S,!p]),Object(me.useEffect)((function(){if(w){var e=function(e){v((function(n){return null!==n&&void 0!==n?n:{x:e.clientX,y:e.clientY}}))};return document.addEventListener("mousemove",e),function(){document.removeEventListener("mousemove",e)}}}),[w,l]);var D=Object(Ki.S)(),A=$e()(D,2),P=A[0],L=A[1],N=Gi(L),F=Object(me.useCallback)((function(){var e=n.blockManager.layoutManager.getViewportBlocks();if(!e.length)return[];for(var r=n.blockManager.getBlockViewByBlockId(e[0]),o=r,i=e.length-1;i>=0;i--)if(n.fold.isShow(e[i])){o=n.blockManager.getBlockViewByBlockId(e[i]);break}return[r,o]}),[]),U=Object(me.useCallback)(Gt()(Wt.a.mark((function e(){var r,o,i,c,a,l,d;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==C.length){e.next=3;break}return u.current=null,e.abrupt("return",s(null));case 3:if((r=n.selectionAPI.getSelection().filter(E)).length&&n.blockManager.hasBlockViewByBlockId(r[0].id)){e.next=7;break}return u.current=null,e.abrupt("return",s(null));case 7:o=r[0],i=n.blockManager.getBlockViewByBlockId(o.id),c=o,a=i,l=r.length-1;case 12:if(!(l>=0)){e.next=20;break}if(!n.fold.isShow(r[l].id)){e.next=17;break}return c=r[l],a=n.blockManager.getBlockViewByBlockId(c.id),e.abrupt("break",20);case 17:l--,e.next=12;break;case 20:(d=document.createRange()).setStart(i.hostElement,0),d.setEnd(a.hostElement,a.hostElement.childNodes.length),u.current=[o,c],s(d);case 25:case"end":return e.stop()}}),e)}))),[C]),H=Object(me.useMemo)((function(){return Object(tt.debounce)((function(){U()}),100)}),[U]),V=Object(me.useCallback)((function(){v(null),H()}),[B,H]);Object(me.useEffect)((function(){return n.blockManager.addListener(gn.Fx,V),function(){n.blockManager.removeListener(gn.Fx,V)}}),[V]);var W=Object(me.useCallback)((function(n){window.clearTimeout(e),!1===n&&(e=window.setTimeout((function(){return U()})))}),[U]);Object(me.useEffect)((function(){W(!1)}),[W]);var z=Object(me.useCallback)((function(){s(null),R()}),[R]);Object(me.useEffect)((function(){return n.blockManager.addListener(Fd.F,W),n.blockManager.addListener(Qi.q,z),function(){n.blockManager.removeListener(Fd.F,W),n.blockManager.removeListener(Qi.q,z)}}),[z,W]),Object(me.useEffect)((function(){L()}),[L]);var G=Object(me.useCallback)((function(e,r){if(j&&I.length){var o=I[0],i=n.blockManager.getBlockViewByBlockId(r).id;Object(Wu.D)(o,i,n.blockManager)&&!Object(Ai.R)(i,n.blockManager,k.B.GRID_COLUMN)&&ln.S.emit(ln.p.COMMON.UPDATE_OVERLAY_POSITION)}}),[j,I]);Object(me.useEffect)((function(){var e=function(){s(null)};return ln.S.on(ln.p.COMMON.BLOCK_MENU_PANEL_SHOW,e),function(){ln.S.off(ln.p.COMMON.BLOCK_MENU_PANEL_SHOW,e)}}),[]),Object(me.useEffect)((function(){return n.blockManager.addListener(Nd.r.UNDO,N),n.blockManager.addListener(Nd.r.REDO,N),ln.S.on(Yr.f.TEXT_BLOCK_TOOLBAR,N),function(){n.blockManager.removeListener(Nd.r.UNDO,N),n.blockManager.removeListener(Nd.r.REDO,N),ln.S.off(Yr.f.TEXT_BLOCK_TOOLBAR,N)}}),[N]),Object(me.useEffect)((function(){return ln.S.on(Pi.o.ON_SCROLL,G),function(){ln.S.off(Pi.o.ON_SCROLL,G)}}),[G]);var K=Boolean(l&&j);Object(me.useEffect)((function(){l&&j&&Object(Wi.T)("ccm_doc_web_text_bubble_toolbar_view",Object(zi.F)(I[0].id,n.blockManager),{}),n.toolbarManager.setPanelStatus(qi.t.TextualBlockToolbar,!(!l||!j))}),[l,j,I]);var q=Object(me.useMemo)((function(){return{editable:i,commentable:y,data:{userId:b.toJS().id||""}}}),[i,y]);return _e.a.createElement(Jd,{visible:K,target:l,selectedBlockTupleRef:u,getSelectionsRange:F,forceUpdateTarget:U,blocks:B,mousePoint:p,onClose:z,boundary:n.boundary,fold:n.fold,blockManager:n.blockManager,selectionAPI:n.selectionAPI},_e.a.createElement(Xi.S,{panelType:qi.t.TextualBlockToolbar,fold:n.fold,comment:n.comment,contextBlocks:I,firstLevelblockList:B,contextExtraProps:$d,options:q,forceUpdateRef:P,menuProps:Qd,keyboard:!1,blocks:I,vertical:!0,source:Pd.G.web_text_bubble_toolbar,type:"edit_toolbar",rpEvent:"show_edit_toolbar",rpSource:rr.L.BLOCK,onClick:N,onRefresh:N,showDivider:!0,blockManager:n.blockManager,selectionAPI:n.selectionAPI,boundary:n.boundary}))}}}]),r}(Hi.A),tf=[Yi.R.TopCenter,Yi.R.BottomCenter],nf=[0,8],rf=[!0,!1],of=function(e){var n=e.visible,r=e.target,o=e.mousePoint,i=e.isMultipleClick,c=e.onClose,a=e.boundary,l=e.blockManager,s=e.selectionAPI,u=e.children,d=Object(_d.l)(r,l,n,a),f=Object(yd.S)(a,l,n,Ud.S),p=Hd({visible:n,referencePoint:Vd(n,o,d),targetRect:d,boundaryRect:f,isMultipleClick:i}),v=$e()(p,2),g=v[0],b=v[1];return _e.a.createElement(bd.S,{visible:n,allowDirections:tf,targetRect:d,boundaryRect:f,calcDirection:g,calcPosition:b,zIndex:h.S.isLarkFeed?Qi.d:Vi.M,offset:nf,sticky:rf,onClose:c,blockManager:l,selectionAPI:s},u)};r("dx_ppSI");function cf(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var af={},lf={className:"text-toolbar"},sf=function(e){G()(r,e);var n=cf(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).toolbarManager=$i.S,e}return H()(r,[{key:"getAfterSlot",value:function(){var e=this;return function(n){var r,o,i=Object(Gu.Y)(n.editorAPI).editMode,c=Object(uo.useSelector)(Cs.L,Ad.E),a=Object(uo.useSelector)(et.selectors.share.ifhaveCommentPermission),l=Object(me.useRef)(null),s=Object(me.useRef)(!1),u=Object(me.useState)(null),d=$e()(u,2),f=d[0],h=d[1],p=Object(me.useRef)(null),v=Object(me.useRef)(null),g=dd({blockManager:e.blockManager,selectionAPI:e.selectionAPI}),b=Object(me.useRef)(g);Object(me.useLayoutEffect)((function(){b.current=g}),[g]);var y=_e.a.useState(null),m=$e()(y,2),_=m[0],O=m[1],x=_e.a.useState(),E=$e()(x,2),S=E[0],C=E[1],I=zu(e.eventEmitter),B=$e()(I,1)[0],T=Object(Ki.S)(),w=$e()(T,2),R=w[0],M=w[1];Object(me.useEffect)((function(){var n,r=function(){n&&clearTimeout(n),n=setTimeout((function(){n=0,M()}))};return e.blockManager.addListener(Nd.r.UNDO,r),e.blockManager.addListener(Nd.r.REDO,r),function(){n&&clearTimeout(n),e.blockManager.removeListener(Nd.r.UNDO,r),e.blockManager.removeListener(Nd.r.REDO,r)}}),[M]),Object(me.useEffect)((function(){var e,n=function(){e&&clearTimeout(e),e=setTimeout((function(){e=0,M()}))};return ln.S.on(Yr.f.TEXT_TOOLBAR,n),function(){e&&clearTimeout(e),ln.S.off(Yr.f.TEXT_TOOLBAR,n)}}),[M]);var j=Object(me.useCallback)((function(){var e=window.getSelection();e&&!e.isCollapsed?O(e.getRangeAt(0).cloneRange()):O(null)}),[]),D=Gi(Object(me.useCallback)((function(){j(),M()}),[j,M])),A=Object(me.useCallback)((function(){D(),setTimeout((function(){return j()}))}),[D,j]),P=Object(me.useMemo)((function(){return Object(tt.debounce)((function(e,n){var r,o=null===e||void 0===e||null===(r=e.model)||void 0===r?void 0:r.getSelection();o&&!o.isCollapsed()&&(null===e||void 0===e?void 0:e.isFocus())&&(s.current||ln.X.mouseUp)?(n(),j()):(Object(Zi.M)(!1),O(null))}),10)}),[]);Object(me.useEffect)((function(){return function(){return P.cancel()}}),[P]);var L=Object(me.useCallback)((function(){P(b.current,M)}),[M,P]),N=Object(me.useMemo)((function(){return Object(tt.debounce)((function(e){L(),h(e)}),50)}),[L]);Object(me.useEffect)((function(){return function(){return N.cancel()}}),[N]);var F=Object(me.useCallback)((function(e,n){if(n){var r={x:e.clientX,y:e.clientY};N(r)}}),[N]),U=Object(me.useCallback)((function(){s.current=!1,O(null),Object(Zi.M)(!1),h(null)}),[]),H=i===Gu.N.Mouse&&(_ instanceof Range||_ instanceof HTMLElement)&&g&&g.editor&&!(null===(r=g.model.getSelection())||void 0===r?void 0:r.isCollapsed()),V=Object(me.useMemo)((function(){return Boolean(H&&f&&B)}),[H,f,B]),W=Object(me.useState)(!1),z=$e()(W,2),G=z[0],K=z[1];Object(me.useEffect)((function(){var e;!V&&i===Gu.N.Mouse&&!G&&_&&(_ instanceof Range||_ instanceof HTMLElement)&&Du(qi.t.TextualToolbar,{mouseInfo:!!f,dataReady:B,collapsed:Boolean(g&&(null===(e=g.model.getSelection())||void 0===e?void 0:e.isCollapsed())),hasBlock:!!g})}),[!V,G,_,i,!f,B,!g]);var q=Object(me.useCallback)((function(e){var n,r=e.model.id;(null===g||void 0===g?void 0:g.props.blockId)===r&&V&&C(null===g||void 0===g||null===(n=g.hostElement)||void 0===n?void 0:n.getBoundingClientRect())}),[g,V]);Object(me.useEffect)((function(){L()}),[null===S||void 0===S?void 0:S.left,null===S||void 0===S?void 0:S.right,null===S||void 0===S?void 0:S.top,null===S||void 0===S?void 0:S.bottom,null===g||void 0===g||null===(o=g.snapshot)||void 0===o?void 0:o.align,null===g||void 0===g?void 0:g.type]);var X=Object(me.useMemo)((function(){return Object(tt.debounce)((function(){var n,r;if(!v.current){var o=e.selectionAPI.getSelection(),i=o.length>0&&o[0].id===(null===g||void 0===g?void 0:g.id)&&o[0].type===Fi.j.TEXT&&(null===(n=o[0].selection)||void 0===n?void 0:n.start)!==(null===(r=o[0].selection)||void 0===r?void 0:r.end);p.current&&i&&(v.current=!0,L())}}),50)}),[g]);Object(me.useEffect)((function(){return X.cancel()}),[X]),Object(me.useEffect)((function(){if(H){var e=function(e){h((function(n){return n||{x:e.clientX,y:e.clientY}}))};return document.addEventListener("mousemove",e),function(){document.removeEventListener("mousemove",e)}}}),[H]),Object(me.useEffect)((function(){V&&g&&Object(Wi.T)("ccm_doc_web_text_bubble_toolbar_view",Object(zi.m)(g.id,e.blockManager),{})}),[V,g]);var Y=Object(me.useCallback)((function(n){var r,o,i=e.selectionAPI.getSelection();1===i.length&&i[0].id===(null===g||void 0===g?void 0:g.id)&&i[0].type===Fi.j.TEXT&&(null===(r=i[0].selection)||void 0===r?void 0:r.start)!==(null===(o=i[0].selection)||void 0===o?void 0:o.end)&&Object(Zi.M)(!0);var c=!1;if(g&&g.editor&&g.model.zoneState){var a,u=null===(a=g.model.getSelection())||void 0===a?void 0:a.toPosition();c=!!u&&0===u.start&&u.len===g.model.zoneState.totalWidth()}c&&l.current&&(s.current=!0,L())}),[g,i,L]),J=Object(me.useCallback)((function(e){v.current=!1;var n=Object(li.F)([{metaCtrlKey:!0,code:"KeyA"},{shiftKey:!0,code:"ArrowRight"},{shiftKey:!0,code:"ArrowLeft"},{shiftKey:!0,code:"ArrowUp"},{shiftKey:!0,code:"ArrowDown"},{metaCtrlKey:!0,shiftKey:!0,code:"ArrowLeft"},{metaCtrlKey:!0,shiftKey:!0,code:"ArrowRight"}]),r={code:e.code,key:e.key,altKey:e.altKey,shiftKey:e.shiftKey,ctrlKey:e.ctrlKey,metaKey:e.metaKey},o=Object(tt.isMatch)(r,n[0]),i=Object(tt.isMatch)(r,n[1])||Object(tt.isMatch)(r,n[2])||Object(tt.isMatch)(r,n[3])||Object(tt.isMatch)(r,n[4])||Object(tt.isMatch)(r,n[5])||Object(tt.isMatch)(r,n[6]);l.current=o,p.current=i}),[g]);Object(me.useEffect)((function(){if(g&&g.editor&&g.blockManager){var e=g.editor,n=g.model.zoneId;return e.on(Wc.L.SELECTION_CHANGE,Y,{zoneId:n}),function(){e.off(Wc.L.SELECTION_CHANGE,Y)}}}),[g,Y]),Object(me.useEffect)((function(){if(g&&g.editor&&g.blockManager){var e=function(){ln.X.mouseUp&&L()};return g.editor.on(Wc.L.SELECTION_CHANGE,e),function(){g.editor.off(Wc.L.SELECTION_CHANGE,e)}}}),[L,g]);var Z=Object(me.useCallback)((function(e){e.detail>1?K(!0):K(!1)}),[]);Object(me.useEffect)((function(){V||K(!1)}),[V]),Object(me.useEffect)((function(){if(g&&g.editor&&g.blockManager){var e=g.hostElement;return e.addEventListener("click",Z,!0),e.addEventListener("keydown",J,!0),q(g.props),g.blockManager.addListener(Ni.D,q),function(){e.removeEventListener("click",Z,!0),e.removeEventListener("keydown",J,!0),g.blockManager.removeListener(Ni.D,q)}}}),[g,J,q]),Object(me.useEffect)((function(){return ln.S.on(ln.p.COMMON.GLOBAL_MOUSE_UP_EVENT,F),document.addEventListener("mousemove",X,!0),function(){ln.S.off("mouseup",F),document.removeEventListener("mousemove",X,!0)}}),[F,X]),Object(me.useEffect)((function(){return e.boundary.addEventListener("mousedown",U,!0),function(){e.boundary.addEventListener("mousedown",U,!0)}}),[U]);var Q=Object(me.useCallback)((function(n,r){if(V&&g){var o=e.blockManager.getBlockViewByBlockId(r).id;Object(Wu.D)(g,o,e.blockManager)&&!Object(Ai.R)(o,e.blockManager,k.B.GRID_COLUMN)&&ln.S.emit(ln.p.COMMON.UPDATE_OVERLAY_POSITION)}}),[V,g]);Object(me.useEffect)((function(){return ln.S.on(Pi.o.ON_SCROLL,Q),function(){ln.S.off(Pi.o.ON_SCROLL,Q)}}),[Q]);var $=Object(me.useMemo)((function(){return g?[g]:[]}),[g]);e.toolbarManager.setPanelStatus(qi.t.TextualToolbar,V);var ee=Object(me.useMemo)((function(){var e=!1,n=null===g||void 0===g?void 0:g.model.getSelection();if(n){var r,o,i=null===g||void 0===g||null===(r=g.editor)||void 0===r||null===(o=r.getContentState())||void 0===o?void 0:o.getEntities({start:n.start,end:n.end});if(1===(null===i||void 0===i?void 0:i.length))e=void 0!==$e()(i,1)[0].attributes[ze.h.KEY]}return{editable:null===g||void 0===g?void 0:g.props.recursionProps.editable,commentable:a,data:{userId:c.toJS().id||""},isPageTitle:(null===g||void 0===g?void 0:g.type)===k.B.PAGE,isEquation:e}}),[g,a,c,_]),te=Object(me.useCallback)((function(){U()}),[U]);return _e.a.createElement(of,{visible:V,target:_,mousePoint:f,onClose:te,isMultipleClick:G,boundary:e.boundary,blockManager:e.blockManager,selectionAPI:e.selectionAPI},_e.a.createElement(Xi.S,{panelType:qi.t.TextualToolbar,contextBlocks:$,contextExtraProps:af,options:ee,forceUpdateRef:R,menuProps:lf,keyboard:!1,blocks:$,fold:e.fold,comment:e.comment,source:Pd.G.web_text_bubble_toolbar,vertical:!0,type:"edit_toolbar",rpEvent:"show_edit_toolbar",rpSource:rr.L.CONTENT,onClick:A,onRefresh:D,showDivider:!0,blockManager:e.blockManager,selectionAPI:e.selectionAPI,boundary:e.boundary}))}}}]),r}(Hi.A),uf=r("dx_B8Bh"),df=r("dx_o9oe"),ff=r("dx_SDvP"),hf=r("dx_QLV0"),pf=r("dx_f1fX"),vf=r("dx_qkDo"),gf=r("dx_WAOj"),bf=r("dx_vOIB"),yf=r("dx_Tsyy"),mf=r("dx_n8nr"),_f=r("dx_cmmV"),kf=r("dx_sb6Q"),Of=r("dx_BaTw");function xf(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Ef(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?xf(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xf(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Sf(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Cf(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cf(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Cf(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var If=ar()("drop:analyzeDropBlock"),Bf=ar()("drop:image");function Tf(e){return"block"===(null===e||void 0===e?void 0:e.type)}var wf,Rf=function(){function e(n,r,o){var i=this;F()(this,e),this.blockManager=n,this.dragContext=r,this.config=o,this.locate=void 0,this.getCheckBlockDemandResult=function(e){var n,r=Sf(e);try{for(r.s();!(n=r.n()).done;){var o=n.value,i=$e()(o,2),c=i[0],a=i[1],l=c.apply(void 0,s()(a));if(!0!==l)return l}}catch(u){r.e(u)}finally{r.f()}return!0},this.checkDropFileLimit=function(e,n){var r,o,c,a,l;if("file"!==(null===(r=i.dragContext)||void 0===r?void 0:r.type))return!0;var s=e.targetId,u=e.direction,d=s?i.blockManager.getBlockModelByBlockId(s):null;return!d||!((null===(o=n.target)||void 0===o||null===(c=o.closest)||void 0===c?void 0:c.call(o,".BITABLE_BLOCK_OVERLAY"))||(null===(a=n.target)||void 0===a||null===(l=a.closest)||void 0===l?void 0:l.call(a,".bitable-container"))||d.type===k.B.BITABLE&&u!==_f.j.bottom)},this.checkGridBlockDemand=function(e,n){var r=e.targetId,o=e.direction,c=r&&i.blockManager.getBlockModelByBlockId(r);if(!c)return!0;var a=[k.B.BITABLE,k.B.GRID,k.B.OKR,k.B.OBJECTIVE,k.B.KEY_RESULT,k.B.PROGRESS],l=o===_f.j.left||o===_f.j.right;if(Tf(i.dragContext)){var u=!Object(Of.t)([].concat(s()(i.dragContext.origin.map((function(e){return i.blockManager.getBlockModelByBlockId(e)}))),[c]).filter((function(e){return e.type!==k.B.TABLE})),(function(e){var n=e.type;return!a.includes(n)})),d=c.parent&&(Object(Cn.cV)(c.parent.id,i.blockManager)||Object(Cn.k)(c.parent.id,i.blockManager));if(u&&(l||d)){var f="string"===typeof u?i.blockManager.getBlockModelByBlockId(u):null;return(null===f||void 0===f?void 0:f.type)===k.B.BITABLE&&{reason:Fd.J.REFUSE_BITABLE_IN_GRID}}}var h=c.record.snapshot.type;if(h!==k.B.GRID&&h!==k.B.GRID_COLUMN)return!0;var p=o===_f.j.top||o===_f.j.bottom,v=h===k.B.GRID;if(!v&&p)return!1;var g=v?c:c.parent;if(!p){var b,y=null===(b=i.dragContext)||void 0===b?void 0:b.origin,m=g?g.children.length:1,_=!0,O=!0,x=new Set;if(!y)return m<yf.t;if(!y.every((function(e){var n,r=i.blockManager.getBlockModelByBlockId(e);return(null===(n=r.parent)||void 0===n?void 0:n.type)===k.B.GRID_COLUMN?(O=!1,x.add(r.parent.id)):_=!1,Number(_)^Number(O)})))return!1;if(O&&m>=yf.t)return!1;if(_)if(x.size+m>yf.t)return!1;if(g&&g.children.length>=yf.t)return!(n.altKey||!y)&&g.children.some((function(e){return e.children.every((function(e){return y.includes(e.id)}))}))}return!0},this.checkCalloutBlockDemand=function(e){var n,r=i.blockManager.getBlockModelByBlockId(e.targetId);return!r.parent||!Object(Xc.K)(r.parent.id,i.blockManager)||e.direction!==_f.j.left&&e.direction!==_f.j.right&&!("block"===(null===(n=i.dragContext)||void 0===n?void 0:n.type)&&(i.dragContext.draggingTypes.has(k.B.CALLOUT)||Array.from(i.dragContext.draggingTypes).some((function(e){return!qc.Lj[e]}))))},this.checkOKRBlockDemand=function(e){var n,r,o,c,a=i.blockManager.getBlockModelByBlockId(e.targetId);if([k.B.OBJECTIVE,k.B.KEY_RESULT,k.B.PROGRESS].includes(a.snapshot.type))return!1;if(!(a.parent&&Object(Ai.R)(a.id,i.blockManager,k.B.PROGRESS)))return!0;var l=!1;if("block"===(null===(n=i.dragContext)||void 0===n?void 0:n.type)&&i.dragContext.origin){var u=Object(Ai.e)(i.dragContext.origin,i.blockManager);l=s()(new Set(u.map((function(e){return e.type})))).every((function(e){return k.B3.includes(e)}))}var d="file"===(null===(r=i.dragContext)||void 0===r?void 0:r.type)&&null!==(o=null===(c=i.dragContext.dragEvent.dataTransfer)||void 0===c?void 0:c.items)&&void 0!==o?o:[],f=!Object(tt.isEmpty)(d)&&s()(d).every((function(e){return e.type.startsWith("image/")}));return l||f},this.checkTableBlockDemand=function(e){var n=[k.B.TABLE,k.B.SHEET,k.B.BITABLE,k.B.OKR];if(!Tf(i.dragContext))return!0;var r=!Object(Of.t)(s()(i.dragContext.origin.map((function(e){return i.blockManager.getBlockModelByBlockId(e)}))),(function(e){var r=e.type;return!n.includes(r)})),o=i.blockManager.getBlockModelByBlockId(e.targetId);return!(r&&o.parent&&Object(Ai.R)(o.parent.id,i.blockManager,k.B.TABLE))},this.checkQuoteContainerDemand=function(e){var n,r,o=i.blockManager.getBlockModelByBlockId(e.targetId);return!o.parent||!Object(Jc.T)(i.blockManager,o.parent.id)||e.direction!==_f.j.left&&e.direction!==_f.j.right&&("file"!==(null===(n=i.dragContext)||void 0===n?void 0:n.type)&&!("block"===(null===(r=i.dragContext)||void 0===r?void 0:r.type)&&Object(Jc.i)({blockManager:i.blockManager,blockId:i.dragContext.origin,condition:function(e){return Yc.r[e.type]}}).length))},this.checkBlockDepthLimit=function(e){var n=e.targetId,r=e.direction,o=e.dropToChild,c=e.parentId;if("bottom"===r&&o&&(c=n),c&&i.dragContext){var a=i.blockManager.getBlockModelByBlockId(c),l=i.dragContext.origin?Math.max.apply(Math,s()(i.dragContext.origin.map((function(e){var n=i.blockManager.getBlockModelByBlockId(e);return i.blockManager.getBlockMaxDepth(n)})))):1;return Object(bf.q)(a)+l<=gn.w+(o?0:1)}return!0},this.checkBitableOverlayLimit=function(e,n){var r=e.targetId,o=i.blockManager.getBlockViewByBlockIdNotCheck(r);if(!o||o.type!==k.B.BITABLE)return!0;var c=document.elementFromPoint(n.x,n.y);return!c||!o.isContainedInOverlay(c)},this.locate=new kf.S(n,o.scrollContainer,o.fold)}return H()(e,[{key:"analyzeDropBlock",value:function(e){var n,r=this.config.scrollContainer.getBoundingClientRect();if(e.x<0||e.y<0||e.x>r.right||e.y>r.bottom)return null;var o=e.y-r.top+this.config.scrollContainer.scrollTop,i=e.x-r.left+this.config.scrollContainer.scrollLeft;if(this.dropToOriginPosition(i,o))return null;var c=null,a=document.elementFromPoint(e.x,e.y),l=a&&mf.S.getClosestGridBlockId(a),s=a&&Object(ll.S)(a),u=s&&(Object(Xc.K)(s,this.blockManager)||Object(Ai.R)(s,this.blockManager,k.B.TABLE));if(l&&((Object(Ai.R)(l,this.blockManager,k.B.CELL)||!u)&&(c=this.analyzeDropAsideColumn(e,l),If("\u5206\u6790\u662f\u5426\u8981\u62d6\u5230 column \u5de6\u53f3",c),c)))return this.checkBlockDemand(c,e);if(c=this.analyzeDropAsideImage(e),If("\u5206\u6790\u662f\u5426\u62d6\u62fd\u5230 image \u5de6\u53f3",c),c)return c;var d=this.getClosetBlockByPosition(e,i,o);If("\u6839\u636e\u9f20\u6807\u4f4d\u7f6e\uff0c\u5c1d\u8bd5\u627e\u5230\u6700\u8fd1\u7684 block",d);var f=d&&this.blockManager.getRootBlockId();d&&f!==d||"block"!==(null===(n=this.dragContext)||void 0===n?void 0:n.type)||!this.dragContext.isDragByMenu||this.dragContext.originX-e.x<Fd.O&&(d=this.getClosetBlockByPosition(Ef(Ef({},e),{},{x:e.x+Fd.O7}),i+Fd.O7,o));if(d&&f!==d){var h=this.getCanDropBlock(d)||d;if(h){var p=this.blockManager.getBlockViewByBlockId(h);"page"===p.type&&p.props.parentId&&(h=p.props.parentId),"file"===p.type&&p.props.parentId&&(h=p.props.parentId)}If("\u6839\u636e\u53ef\u91ca\u653e\u533a\u57df\u9650\u5236\uff0c\u8c03\u6574\u540e",h);var v=this.analyzeYDirection(h,o).id;v&&(h=v),If("\u6839\u636eY\u8f74\u5750\u6807\u8c03\u6574\u540e",h);var g=this.analyzeXDirection(h,{x:i,y:o}),b=g.dropToChild,y=g.hintLevel,m=g.id,_=g.direction;m&&(h=m),If("\u6839\u636eX\u8f74\u5750\u6807\u8c03\u6574\u540e",h);var O=this.blockManager.getBlockModelByBlockId(h);if(this.checkSameBlockDraged(h))return null;var x=Object(Ai.f)(O.id,this.blockManager),E=x.target,S=x.parent,C=x.position;if(Object(Ai.R)(E.id,this.blockManager,k.B.OKR)&&E.snapshot.type===k.B.IMAGE&&(null===S||void 0===S?void 0:S.snapshot.type)===k.B.GRID_COLUMN&&_===_f.j.left)return null;c={targetId:E.id,parentId:null===S||void 0===S?void 0:S.id,position:C,direction:_,dropToChild:b,hintLevel:y},If("\u8ba1\u7b97\u51fa\u6765\u7684\u7ed3\u679c",c)}else{var I=this.findPageId(d||f);c=I?this.analyzeDropOutside(I,{x:i,y:o}):null,If("\u9f20\u6807\u5728\u7f16\u8f91\u5668\u5916",I,c)}return this.checkBlockDemand(c,e)}},{key:"checkBlockDemand",value:function(e,n){if(!e)return null;var r=[[this.checkOKRBlockDemand,[e,n]],[this.checkGridBlockDemand,[e,n]],[this.checkCalloutBlockDemand,[e]],[this.checkTableBlockDemand,[e]],[this.checkBlockDepthLimit,[e]],[this.checkBitableOverlayLimit,[e,n]],[this.checkDropFileLimit,[e,n]],[this.checkQuoteContainerDemand,[e]]],o=this.getCheckBlockDemandResult(r);return!0===o?(If("\u7ed9\u6700\u7ec8\u7ed3\u679c\u68c0\u67e5\u591a\u680f\u62d6\u62fd\u9650\u5236",!1,e),e):!1===o?null:o}},{key:"dropToOriginPosition",value:function(e,n){var r,o,i=this;return"file"!==(null===(r=this.dragContext)||void 0===r?void 0:r.type)&&("block"!==(null===(o=this.dragContext)||void 0===o?void 0:o.type)||this.dragContext.origin.some((function(r){var o=Object(Of.w)(i.blockManager,r,i.config.scrollContainer);return!(!o||!Object(Of.i)(o,e,n))})))}},{key:"getCanDropBlock",value:function(e){var n=this;if(!this.dragContext)throw new Error("mouseMouse without dragContext");if("file"!==this.dragContext.type){var r,o=[].concat(s()(this.blockManager.getBlockPath(e)),[e]),i=this.dragContext.draggingTypes;return o.some((function(e){var o=n.blockManager.getBlockViewByBlockId(e);if(!o)throw new Error("can not find block by id ".concat(e));var c=o.props.type,a=n.config.container[c];if(o.isTextBlock||"all"===a)return!1;if(!a)return r=e,!0;var l=a.includes,u=a.excludes,d=!0;return l&&(d=s()(i).every((function(e){return l.includes(e)}))),u&&(d=!s()(i).some((function(e){return u.includes(e)}))),!!d&&(r=e,!0)})),r}}},{key:"isDroppable",value:function(e){return!this.config.unDroppable.includes(e)}},{key:"fixDroppable",value:function(e,n){if(n===_f.j.bottom){var r=this.findInnerDroppable(e),o=this.blockManager.getBlockModelByBlockId(r);return o.children.length<=0?{id:o.id,direction:_f.j.bottom}:{id:o.children[0].id,direction:_f.j.top}}if(n===_f.j.top){var i=this.findOuterDroppable(e),c=this.blockManager.getBlockModelByBlockId(i);if(this.blockManager.getBlockModelByBlockId(e).record.snapshot.type===k.B.CELL){var a=this.findInnerDroppable(e),l=this.blockManager.getBlockModelByBlockId(a);return l.children.length<=0?{id:l.id,direction:_f.j.bottom}:{id:l.children[0].id,direction:_f.j.top}}return c.previousSibling?{id:c.previousSibling.id,direction:_f.j.bottom}:{id:i,direction:_f.j.top}}return{id:e,direction:n}}},{key:"findOuterDroppable",value:function(e){for(var n=this.blockManager.getBlockModelByBlockId(e);n.parent;){var r=this.blockManager.getBlockViewByBlockId(n.parent.id);if(this.isDroppable(r.type))break;n=n.parent}return n.id}},{key:"findInnerDroppable",value:function(e){for(var n=this.blockManager.getBlockModelByBlockId(e);n.children[0];){var r=this.blockManager.getBlockViewByBlockId(n.children[0].id);if(this.isDroppable(r.type))break;n=n.children[0]}return n.id}},{key:"getClosetBlockByPosition",value:function(e,n,r){var o=document.elementFromPoint(e.x,e.y);if(o){var i=Object(ll.S)(o);if(i)return this.locate.getClosestBlock(i,n,r)}}},{key:"findPageId",value:function(){var e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.blockManager.rootBlockId;if(!r&&"block"===(null===(e=this.dragContext)||void 0===e?void 0:e.type)&&(null===(n=this.dragContext.origin)||void 0===n?void 0:n.length)>0&&(r=this.dragContext.origin[0]),r){var o=this.blockManager.getBlockViewByBlockId(r);return o&&o.parentId?this.blockManager.getRootBlockId():r}}},{key:"checkSameBlockDraged",value:function(e){var n;if(!e||"block"!==(null===(n=this.dragContext)||void 0===n?void 0:n.type))return!1;var r=this.dragContext,o=this.blockManager.getBlockPath(e);return[e].concat(s()(o)).some((function(e){return r.origin.includes(e)}))}},{key:"analyzeDropAsideColumn",value:function(e,n){for(var r=this.blockManager.getBlockModelByBlockId(n),o=0;o<r.children.length;o++){var i=r.children[o],c=this.blockManager.getBlockViewByBlockId(i.id),a=c.getHostRect(),l=e.x-a.right,s=e.x-a.left;if(0===o&&s<yf.v)return{targetId:c.id,parentId:c.parentId,position:0,direction:_f.j.left,dropToChild:!1,hintLevel:1};if(s>2*a.width/3&&Math.abs(l)<yf.v)return{targetId:c.id,parentId:c.parentId,position:0,direction:_f.j.right,dropToChild:!1,hintLevel:1}}return null}},{key:"analyzeDropAsideImage",value:function(e){var n,r,o=document.elementFromPoint(e.x,e.y),i=o&&Object(ll.S)(o);if(Bf("\u9f20\u6807\u5bf9\u5e94\u7684block id",i,o),"block"!==(null===(n=this.dragContext)||void 0===n?void 0:n.type))return null;if(!i||(null===(r=this.dragContext)||void 0===r?void 0:r.origin.includes(i)))return null;var c=this.blockManager.getBlockViewByBlockId(i);if(c.type!==k.B.IMAGE||c.isElementInImageContainer(o))return Bf("\u9f20\u6807\u5bf9\u5e94\u7684\u4e0d\u662f\u56fe\u7247",c),null;Bf("\u9f20\u6807\u5bf9\u5e94\u7684\u56fe\u7247",i);var a=this.blockManager.getBlockModelByBlockId(i).parent;if(a&&!mf.S.isValidParentType(a.record.snapshot.type,a))return null;var l=c.getImageContainer().getBoundingClientRect();return Math.abs(e.y-l.top)<10?null:{targetId:c.id,parentId:c.parentId,position:0,direction:e.x<l.left?_f.j.left:_f.j.right,dropToChild:!1,hintLevel:1}}},{key:"findClosestY",value:function(e,n){var r,o=this;return e.some((function(e){var i=o.blockManager.layoutManager.getLayoutInfo(e);if(!i)return!1;var c=i.height,a=i.top,l=a+c;return a<n.y&&l>n.y&&(r=e,!0)})),r}},{key:"findClosestDroppableY",value:function(e,n){var r,o=this.findClosestY(e,n);if(o){var i=this.blockManager.getBlockModelByBlockId(o);if(i)return Fd.p.find((function(e){return i.snapshot.type===e}))&&!this.isDroppable(i.snapshot.type)&&(null===(r=i.children)||void 0===r?void 0:r.length)?this.findClosestDroppableY(i.children.map((function(e){return e.id})),n):o}}},{key:"analyzeDropOutside",value:function(e,n){var r=this.blockManager.getBlockViewByBlockId(e),o=this.blockManager.getBlockModelByBlockId(e),i=this.blockManager.rootBlockId===e?Object(Of.X)(r.contentElement||r.hostElement,this.config.scrollContainer):Object(Of.pT)(r,this.config.scrollContainer);if(!i)return null;var c=o.children.map((function(e){return e.id})),a=c.length>0;if(n.x<i.left||n.x>i.right){var l=this.findClosestDroppableY(c,n);if(l){var s,u,d,f=this.blockManager.getBlockModelByBlockId(l),h=n.x<i.left?_f.j.left:_f.j.right;return f.record.snapshot.type===k.B.GRID&&(l=h===_f.j.left?f.children[0].id:f.children[f.children.length-1].id,f=this.blockManager.getBlockModelByBlockId(l)),"block"===(null===(s=this.dragContext)||void 0===s?void 0:s.type)&&(null===(u=this.dragContext)||void 0===u?void 0:u.origin.includes(l))?null:{parentId:null===(d=f.parent)||void 0===d?void 0:d.id,targetId:l,direction:h,position:0,dropToChild:!1}}return null}return a&&(n.y>i.bottom||n.y<i.top)?i.top>n.y?{parentId:e,targetId:c[0],direction:_f.j.top,position:0,dropToChild:!1}:i.bottom<n.y?{parentId:e,targetId:c[c.length-1],direction:_f.j.bottom,position:c.length-1,dropToChild:!1}:null:a?null:{parentId:void 0,targetId:e,direction:_f.j.top,position:0,dropToChild:!0}}},{key:"analyzeYDirectionInParentBlock",value:function(e,n){var r=this.findInnerDroppable(e);If("analyzeYDirectionInParentBlock",r);var o=this.blockManager.getBlockModelByBlockId(r),i=this.blockManager.getBlockViewByBlockId(r),c=o.next;if(!c||!c.id)throw new Error("Struct exception, block:".concat(r," expect has children, but not found"));var a=this.blockManager.getBlockViewByBlockId(c.id),l=Object(Of.pT)(i,this.config.scrollContainer),s=Object(Of.pT)(a,this.config.scrollContainer);if(!l||!s)throw new Error("block: ".concat(i.id," rect invalid"));if(n>s.bottom)return this.isDroppable(i.type)?{yDirection:_f.j.bottom,id:r}:this.fixDroppable(i.id,_f.j.bottom);var u={top:l.top,bottom:s.top},d=this.calculateYDirection(u,n);return this.isDroppable(i.type)?o.previousSibling||d!==_f.j.top?d===_f.j.top?{yDirection:_f.j.top,id:o.id}:{yDirection:_f.j.top,id:c.id}:{yDirection:d,id:r}:this.fixDroppable(i.id,d)}},{key:"analyzeYDirection",value:function(e,n){var r,o=this.blockManager.getBlockModelByBlockId(e),i=this.blockManager.getBlockViewByBlockId(e),c=i.type===k.B.TABLE,a=i.type===k.B.VIEW,l=Object(Of.pT)(i,this.config.scrollContainer);if(!l)throw new Error("can not find rect by id ".concat(e));if(!c&&!a&&o.children&&o.children.length>0&&n<l.bottom)return this.analyzeYDirectionInParentBlock(e,n);var s=this.calculateYDirection(l,n);if(If("analyzeYDirection",s),s===_f.j.bottom||Object(Of.I)(o))return{yDirection:s,id:e};if(null===(r=o.previousSibling)||void 0===r?void 0:r.id){var u=this.blockManager.getBlockViewByBlockId(o.previousSibling.id);if(If(this.config.unDroppable,u.type,o.previousSibling.id),!this.config.unDroppable.includes(u.type))return{yDirection:_f.j.bottom,id:o.previousSibling.id}}return If("analyzeYDirection default"),{yDirection:s,id:e}}},{key:"calculateYDirection",value:function(e,n){return(e.top+e.bottom)/2>n?_f.j.top:_f.j.bottom}},{key:"analyzeXDirection",value:function(e,n){var r=this,o=n.x,i=n.y,c=this.blockManager.getBlockViewByBlockId(e),a=Object(Of.pT)(c,this.config.scrollContainer);if(!a||!c)throw new Error("can not find rect by id ".concat(e));var l=this.config.gap,s=o-a.left,u=!1,d=!1,f=Object(Ai.R)(e,this.blockManager,k.B.CALLOUT)||c.type===k.B.CALLOUT,h=mf.S.getClosestGridBlockId(c.hostElement);if(h){var p=this.blockManager.getBlockPath(e),v=p.indexOf(h);v>-1&&(d=!p.slice(v+1).some((function(e){return r.blockManager.getBlockViewByBlockId(e).type===k.B.TABLE})))}if(If("\u62d6\u52a8 distance \u8ddd\u79bb\uff1a".concat(s)),!d&&!f&&s>2*a.width/3)return{dropToChild:!1,id:e,direction:_f.j.right};if(Fd.V.find((function(n){var o,i=r.blockManager.getBlockModelByBlockIdNotCheck(e);return(null===i||void 0===i||null===(o=i.parent)||void 0===o?void 0:o.type)===n}))&&s<=Fd.O)return{dropToChild:!1,id:e,direction:_f.j.left};var g=this.blockManager.getRootBlockId(),b=function e(n,o){var i,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=r.blockManager.getBlockViewByBlockId(n),l=Object(Of.pT)(a,r.config.scrollContainer);if(!l)return n;var s=o-l.left,u=r.blockManager.getBlockModelByBlockId(n),d=(null===(i=u.parent)||void 0===i?void 0:i.id)!==g&&s<0&&Math.abs(s)>5;if(d){var f=r.findOuterDroppable(u.id);return f===n?n:f?e(f,o,c++):n}return n}(e,o),y=this.blockManager.getBlockViewByBlockId(b),m=this.blockManager.getBlockModelByBlockId(b),_=Object(Of.pT)(y,this.config.scrollContainer);if(!_)throw new Error("Analyze Drop Block failed, Block{".concat(b,"} getOffsetRect return null"));var O=this.calculateYDirection(_,i);return s>l&&o<a.right&&this.config.canDropToChild(m)&&(u=!0),{dropToChild:O!==_f.j.top&&u,hintLevel:O===_f.j.top?1:function e(n){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=r.blockManager.getBlockModelByBlockId(n);if(i&&!i.nextSibling){var c,a=null===(c=i.parent)||void 0===c?void 0:c.id,l=a?r.blockManager.getBlockViewByBlockId(a):null;return l&&l.id!==g&&r.isDroppable(l.type)?e(l.id,o+1):o}return o}(b),id:b,direction:O}}}]),e}(),Mf=r("dx_WRwK"),jf=r("dx_xFJs");!function(e){e[e.CREATED=0]="CREATED",e[e.NOTCREATE=1]="NOTCREATE",e[e.RETURN=2]="RETURN"}(wf||(wf={}));var Df=function(){function e(n,r){var o=this;F()(this,e),this.blockManager=n,this.fold=r,this.getRootRecordId=function(e){return o.blockManager.getBlockModelByBlockId(e).root.recordId},this.isDropToSamePage=function(e,n){return o.getRootRecordId(e)===o.getRootRecordId(n)}}return H()(e,[{key:"perform",value:function(e,n){if(e&&n&&n.parentId){var r=e.origin,o=n.parentId,i=n.dropToChild;return n.direction===_f.j.left||n.direction===_f.j.right?this.performDropAside(e,n):i||!this.isDropToSameLevel(r[0],o)?this.performDropToDifferentLevel(e,n):this.performDropToSameLevel(e,n)}}},{key:"isDropToSameLevel",value:function(e,n){return this.blockManager.getBlockViewByBlockId(e).props.parentId===n}},{key:"performDropAside",value:function(){var e=Gt()(Wt.a.mark((function e(n,r){var o,i,c,a,l,s,u,d,f,h,p,v,g,b,y=this;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.parentId&&this.blockManager.getBlockModelByBlockId(r.parentId),i=r.targetId&&this.blockManager.getBlockModelByBlockId(r.targetId),o&&i){e.next=4;break}return e.abrupt("return");case 4:if(c=i.record.snapshot.type===k.B.GRID_COLUMN,a=r.direction===_f.j.left,!c){e.next=25;break}if(l={},n.origin.every((function(e){var n=y.blockManager.getBlockModelByBlockId(e);if(!n.parent||n.parent.type!==k.B.GRID_COLUMN)return!1;var r=n.parent.id;return l[r]||(l[r]=[]),l[r].push(e),!0})),u=i.position,!(Object.keys(l).length<=1)){e.next=16;break}return e.next=13,Object(jf.t)({blockManager:this.blockManager,gridBlockId:i.parent.id,columnIndex:u+(a?0:1),getNewColumnChildrenBlockIds:function(e){return n.origin},beforeCreate:function(e){n.origin.forEach((function(n){var r=y.blockManager.getBlockModelByBlockId(n);e.removeChildren(r.parent.recordId,[r.recordId])}))},transactionName:"addGridColumnByDrop"});case 13:s=e.sent,e.next=20;break;case 16:return s=i.parent.id,d=Object.entries(l).map((function(e,n){var r=$e()(e,2),o=(r[0],r[1]);Object(jf.t)({blockManager:y.blockManager,gridBlockId:i.parent.id,columnIndex:u+n+(a?0:1),getNewColumnChildrenBlockIds:function(e){return o},beforeCreate:function(e){o.forEach((function(n){var r=y.blockManager.getBlockModelByBlockId(n);e.removeChildren(r.parent.recordId,[r.recordId])}))},transactionName:"addGridColumnByDrop"})})),e.next=20,Promise.all(d);case 20:return f=this.blockManager.getBlockModelByBlockId(s),h=[{parentId:s,position:0,length:f.children.length}],e.abrupt("return",h);case 25:return e.next=27,Object(jf.K)({blockManager:this.blockManager,fold:this.fold,dropTargetBlockId:i.id,dragBlockIds:n.origin,toLeft:a});case 27:return p=e.sent,v=this.blockManager.getBlockModelByBlockId(p),g=v.children[a?0:1],b=[{parentId:g.id,position:0,length:g.children.length}],e.abrupt("return",b);case 32:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"performDropToDifferentLevel",value:function(){var e=Gt()(Wt.a.mark((function e(n,r){var o,i,c,a,l,s,u,d,f,h,p,v,g=this;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.origin,i=r.parentId,c=r.targetId,a=r.dropToChild,l=r.position,s=r.direction,u=a?c:i){e.next=5;break}throw new Error("can not find drop target, ".concat(u));case 5:if(o=Object(Xc.B)(u,o,this.blockManager),(o=Object(jf.c)(u,o,this.blockManager)).length){e.next=9;break}return e.abrupt("return");case 9:return d=this.isDropToSamePage(o[0],u),f=this.blockManager.getRecordByBlockId(u).id,h={},o.forEach((function(e){h[e]=g.blockManager.getRecordByBlockId(e).id})),p="bottom"===s?this.tryFixPositionForFoldedHeading(c,l):l,v=[],e.next=17,this.blockManager.applyTransaction("performDropToDifferentLevel",(function(e){var n="bottom"===s?p+1:p;if(a){var r=g.blockManager.getBlockModelByBlockId(u);n=r.children.length}g.createGridOp({position:n,parentBlockId:u,selectedBlocks:o,op:e})!==wf.CREATED&&o.reverse().forEach((function(r){var o=d?h[r]:Object(Ai.L)({op:e,blockId:r,blockManager:g.blockManager,parentRecordId:f,recursive:!0}),i=g.blockManager.getRecordByBlockId(r).id;e.replace(i,["parent_id"],f),e.insert(f,["children",n],o)})),o.forEach((function(n){var r=g.blockManager.getBlockModelByBlockId(n);e.removeChildren(r.parent.recordId,[r.recordId])})),g.fold.isFolded(u)&&e.replace(f,["folded"],!1),v.push({parentId:u,position:n,length:o.length})}),{extra:{ignoreFold:!0}});case 17:return e.abrupt("return",v);case 18:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"createGridOp",value:function(e){var n,r=this,o=e.position,i=e.parentBlockId,c=e.op,a=e.selectedBlocks,l=new Mf.n(this.blockManager,a.map((function(e){return{id:e,type:Fi.j.BLOCK}})),a.reduce((function(e,n){var o=r.blockManager.getBlockModelByBlockId(n).record;return e[n]=_t()({},n,o),e}),{}));if(0===a.length||!l.hasPartial())return wf.RETURN;var s=l.getBlockIds(),u=l.getRecordMap(),d=this.blockManager.getRecordByBlockId(s[0]),f=null===(n=u[d.id])||void 0===n?void 0:n.snapshot;return(null===f||void 0===f?void 0:f.type)!==k.B.GRID?wf.RETURN:(Object(jf.h)({blockManager:this.blockManager,parentBlockId:i,index:o,columnNum:f.children.length,getColumnChildrenInfo:function(e,n){return u[f.children[n]].snapshot.children.map((function(e){return{isNewCreateChild:!1,id:e}}))},op:c}),wf.CREATED)}},{key:"tryFixPositionForFoldedHeading",value:function(e,n){var r=this.blockManager.getBlockViewByBlockId(e);if(r.type.includes("heading")&&this.fold.isFolded(e)){var o=this.fold.findFoldedBlocks(r.id),i=o[o.length-1];if(i)return this.blockManager.getBlockModelByBlockId(i).position}return n}},{key:"performDropToSameLevel",value:function(){var e=Gt()(Wt.a.mark((function e(n,r){var o,i,c,a,l,s,u,d,f,h,p,v=this;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.origin,i=r.parentId,c=r.direction,a=r.targetId,l=r.position,i){e.next=4;break}throw new Error("drop can not find parent Id");case 4:if(s=this.blockManager.getRecordByBlockId(i).id,o=Object(Xc.B)(i,o,this.blockManager),(o=Object(jf.c)(i,o,this.blockManager)).length){e.next=9;break}return e.abrupt("return");case 9:return u=c===_f.j.bottom?this.tryFixPositionForFoldedHeading(a,l):l,d=o.reduce((function(e,n){return e[n]=v.blockManager.getRecordByBlockId(n).id,e}),{}),f=[],h=[],o.forEach((function(e,n){var r=v.dragDirection(e,a);if("up"===r&&f.push(e),"down"===r&&h.push(e),!r){var i=o[n-1];f.includes(i)?f.push(e):h.push(e)}})),p=[],e.next=17,this.blockManager.applyTransaction("performDropToSameLevel",(function(e){var n=v.blockManager.getBlockModelByBlockId(i),r=n.children;if(f.length>0){f.forEach((function(n){var r=v.blockManager.getBlockModelByBlockId(n);e.removeChildren(r.parent.recordId,[r.recordId])}));var o="bottom"===c?u+1:u;o+f.length-1>=r.length&&o--,v.createGridOp({position:o,parentBlockId:i,selectedBlocks:f,op:e})!==wf.CREATED&&f.reverse().forEach((function(n){var r=d[n];v.blockManager.getRecord(r).snapshot.parent_id!==s&&e.replace(r,["parent_id"],s),e.insert(s,["children",o],r)})),p.push({parentId:i,position:o,length:f.length})}if(h.length>0){var a="bottom"===c?u+1:u;v.createGridOp({position:a,parentBlockId:i,selectedBlocks:h,op:e})!==wf.CREATED&&h.reverse().forEach((function(r){var o=d[r];v.blockManager.recordManager.hasRecord(o)&&(v.blockManager.recordManager.getRecord(o).snapshot.parent_id!==s&&e.replace(o,["parent_id"],s));e.insert(n.recordId,["children",a],o)})),Object(Gc.y)(e,h,v.blockManager),p.push({parentId:i,position:a-h.filter((function(e){return r.some((function(n){return n.id===e}))})).length,length:h.length})}}),{extra:{ignoreFold:!0}});case 17:return e.abrupt("return",p);case 18:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"dragDirection",value:function(e,n){if(e===n)return"up";var r=this.blockManager.layoutManager.getLayoutInfo(e,!0),o=this.blockManager.layoutManager.getLayoutInfo(n,!0);if(!r||!o)throw new Error("can not find drag rect or drop rect");return 0===r.width?"":r.top>=o.top+o.height&&r.top>o.top?"up":"down"}}]),e}(),Af=r("dx_FBWK");function Pf(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Lf(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lf(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Lf(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var Nf=function(){function e(n,r){F()(this,e),this.blockManager=n,this.fold=r,this.styleWrapperSelector="[data-tag=doc-wrapper]",this.uselessClassQueries=[Fd.g,"hovered","selected","active","highlight","preview-selected",fc.q.TABLE_SELECTED_FROM_EQUAL],this.uselessNode=[".fold-handler",".toolbar-container"]}return H()(e,[{key:"getSingleSnapshot",value:function(e,n){if(!e[0])return null;var r=this.getNodeRef(e[0],!0);if(r){var o=this.getSingleWrapper([r],n),i=r.cloneNode(!0);return this.removeUselessContent(i),o.appendChild(i),{node:o,options:{position:["left","top"]}}}return null}},{key:"getNormalSnapshot",value:function(e,n){var r=this;if(1===e.length&&this.blockManager.getBlockModelByBlockId(e[0]).type===k.B.IMAGE)return this.getSingleSnapshot(e,n);var o=e.filter((function(e){return r.fold.isShow(e)})).map((function(e){return r.getNodeRef(e,!1)})).filter((function(e){return!!e})),i=document.createDocumentFragment();o.forEach((function(e){return e&&i.appendChild(r.getParentSnapshot(e))}));var c=this.getWrapper(o,n);return c.appendChild(i),{node:c,options:{position:["left","top"]}}}},{key:"getNodeRef",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=this.blockManager.getBlockViewByBlockIdNotCheck(e);return o?o.type===k.B.IMAGE?o.getViewSnapshot(n):o.getViewSnapshot?o.getViewSnapshot():r?o.props.hostElementRef.current:null:null}},{key:"getParentSnapshot",value:function(e){var n=this,r=e.cloneNode(!0);return r.classList.add("drag-snapshot"),r.querySelectorAll("[".concat(gn.aO,"]")).forEach((function(e){var o,i=Number(e.getAttribute(gn.aO)),c=i&&n.getNodeRef(i,!1,!1),a=r.querySelector("[".concat(gn.aO,'="').concat(i,'"]'));c&&(null===a||void 0===a||null===(o=a.parentNode)||void 0===o||o.replaceChild(c.cloneNode(!0),a))})),this.removeUselessContent(r),r}},{key:"getSingleWrapper",value:function(e,n){var r=e&&Object(Of.G)(e),o=Object(Of.T)(r,Object(tt.pick)(n,["x","y"])),i=document.createElement("div");return this.styleSingleWrapper(i,r,o),i}},{key:"correctOffset",value:function(e,n){n.x*=e,n.y*=e}},{key:"styleSingleWrapper",value:function(e,n,r){var o=n.width,i=n.height,c=document.querySelector(this.styleWrapperSelector);c&&(e.className=c.classList.toString());var a=Object(Of.Xl)(o,i);r&&this.correctOffset(a,r);var l={borderRadius:"6px",boxShadow:"0 2px 16px 0 var(--shadow-default-md)",display:"block",overflow:"hidden",margin:"unset",wordBreak:"break-word",transformOrigin:"left top",transform:["translate(".concat((null===r||void 0===r?void 0:r.x)||0,"px, ").concat((null===r||void 0===r?void 0:r.y)||0,"px)"),"scale(".concat(a,")")].join(" "),position:"relative"};o&&(l.width="".concat(o,"px")),Object(Of.y)(e,l)}},{key:"getWrapper",value:function(e,n){var r=e&&Object(Of.G)(e),o=Object(Of.T)(r,Object(tt.pick)(n,["x","y"])),i=document.createElement("div");return e&&e[0]&&e[0].className&&(i.className="wrapper ".concat(e[0].className),"docx-isv-block"===e[0].className&&(o={x:0,y:0})),this.styleWrapper(i,r,o),i}},{key:"styleWrapper",value:function(e,n,r){var o=n.width,i=n.height,c=document.querySelector(this.styleWrapperSelector);c&&(e.className=c.classList.toString());var a=Object(Of.Xl)(o,i);r&&this.correctOffset(a,r);var l={borderRadius:"4px",boxShadow:"0 2px 16px 0 var(--shadow-default-md)",border:"solid 1px var(--line-border-card)",backgroundColor:Object(Af.getThemeColorByToken)("bg-body"),overflow:"hidden",display:"block",margin:"unset",wordBreak:"break-word",transformOrigin:"left top",transform:["translate(".concat((null===r||void 0===r?void 0:r.x)||0,"px, ").concat(((null===r||void 0===r?void 0:r.y)||0)+28,"px)"),"scale(".concat(a,")")].join(" ")};o&&(l.width="".concat(o,"px")),Object(Of.y)(e,l)}},{key:"removeUselessContent",value:function(e){this.removeUselessClass(e,this.uselessClassQueries),this.removeUselessNode(e,this.uselessNode)}},{key:"removeUselessClass",value:function(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=Pf(r);try{var i=function(){var r=n.value,o="string"===typeof r?{search:".".concat(r),matcher:function(e){return e===r}}:r,i=o.search,c=o.matcher,a=Array.from(e.querySelectorAll(i));e.matches(i)&&a.push(e);for(var l=0,s=a;l<s.length;l++){var u,d=s[l],f=Pf(Array.from(d.classList).filter(c));try{for(f.s();!(u=f.n()).done;){var h=u.value;d.classList.remove(h)}}catch(p){f.e(p)}finally{f.f()}}};for(o.s();!(n=o.n()).done;)i()}catch(c){o.e(c)}finally{o.f()}}},{key:"removeUselessNode",value:function(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=Pf(r);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(!i)break;for(var c=Array.from(e.querySelectorAll(i)),a=0,l=c;a<l.length;a++){var s=l[a];s.parentNode&&s.parentNode.removeChild(s)}}}catch(u){o.e(u)}finally{o.f()}}}]),e}(),Ff=Nf;function Uf(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Hf(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Uf(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uf(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var Vf=function(){function e(n){var r=this;F()(this,e),this.config=n,this.dragManager=void 0,this.dropManager=void 0,this.snapshotManager=void 0,this.dragContext=null,this.dropContext=null,this.dropFailContext=null,this.blockDraggingByMenu=void 0,this.notifiedDragging=!1,this.timer=void 0,this.originDragParentId=void 0,this.originNextBlock=void 0,this.hideBlockMenuHandler=function(){var e=!1;return{hideMenu:function(){e||(r.config.eventEmitter.emit(gn.t,{source:gn.S.DRAG}),e=!0)},cancel:function(){e=!1}}}(),this.onDragStart=function(e,n,o){if(r.isCrossEditor(n)||e.closest(".xgplayer-slider"))return!1;var i=r.analyzeDraggingBlock(e,n);return r.selectionAPI.deactivate(),0===i.length?(r.resetContext(!1),!1):(r.saveDragOrigin(i,n),r.delaySetDragStyle(),!0)},this.getSnapshot=function(e,n){return r.dragContext&&r.dragContext.origin.length>0?r.blockDraggingByMenu||r.dragContext.origin.length>1?r.snapshotManager.getNormalSnapshot(r.dragContext.origin,n):r.snapshotManager.getSingleSnapshot(r.dragContext.origin,n):null},this.onDragManagerDrop=function(e,n){return r.hideBlockMenuHandler.cancel(),r.dragContext},this.onDragMove=function(e,n){if(r.hideBlockMenuHandler.hideMenu(),r.setDragStyleImmediately(),r.notifiedDragging||(r.notifiedDragging=!0,r.blockManager.dispatch(Fd.F,!0)),!r.isCrossEditor(n))try{var o=new Rf(r.blockManager,r.dragContext,r.config).analyzeDropBlock(n);o&&"reason"in o?(r.dropFailContext=o,r.saveDropContext(null)):(r.dropFailContext=null,r.saveDropContext(o))}catch(i){console.error(i),r.saveDropContext(null)}},this.onDropManagerDrop=function(e,n,o){return r.config.blockManager.dispatch(Fd.jN,[r.dropContext,r.dragContext]),r.dropFailContext&&et.Toast.show({type:"warning",content:Fd.b[r.dropFailContext.reason]}),!0},this.onDropSuccess=function(e,n){var o=r.dragContext,i=r.dropContext;if(r.resetDraggingStyle(),r.resetContext(!0),o){var c=n.x,a=n.y,l=o.originX,s=o.originY;if(Math.abs(l-c)<=Fd.j&&Math.abs(s-a)<=Fd.j)return}var u=new Df(r.blockManager,r.fold);if(o){var d=r.blockManager.getBlockModelByBlockIdNotCheck(o.origin[0]);if(d){var f=o.origin.map((function(e){return{id:e,type:Ei.j.BLOCK}}));r.selectionAPI.setSelection(f),r.viewport.scrollToBlock(d.id)}}var h=u.perform(o,i);h&&h.then((function(e){if(e)return r.afterDropSuccess(e)})).catch((function(e){throw e})),r.cancelDelaySetDragStyle()},this.afterDropSuccess=function(){var e=Gt()(Wt.a.mark((function e(n){var o,i,c,a,l;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.selectionAPI.isCursor()||r.selectionAPI.removeAllSelection(),o=[],i=[],n.forEach((function(e){var n=e.parentId,c=e.position,a=e.length,l=r.blockManager.getBlockModelByBlockIdNotCheck(n);if(l){var s=l.children;Array(a).fill(0).forEach((function(e,n){var a=c+n,l=a>=s.length?s[s.length-1].id:s[a].id;if(r.blockManager.hasBlockViewByBlockId(l)){var u=r.blockManager.getBlockViewByBlockId(l);u.hostElement&&o.push(u.id),i.push(u)}})),r.reportDragEvent(r.originDragParentId,n,o),r.originDragParentId=u.V}})),c=null,i.length&&(a=i[i.length-1].id,l=r.blockManager.getBlockModelByBlockId(a),c=Object(pn.l)(l.type)?Object(Of.m)({model:l,fold:r.fold}):l),r.fold.handleBlockShow({midAffectedSib:r.originNextBlock,btmAffectedSib:c}),r.originNextBlock=void 0,r.selectionAPI.restoreFocus(),i.length&&setTimeout((function(){return Object(Ur.I)(i)}));case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),this.onDropFailed=function(){r.resetDraggingStyle(),r.resetContext(!1),r.cancelDelaySetDragStyle()},this.setBlockDraggingByMenu=function(e){r.blockDraggingByMenu=e},this.init()}return H()(e,[{key:"blockManager",get:function(){return this.config.blockManager}},{key:"fold",get:function(){return this.config.fold}},{key:"selectionAPI",get:function(){return this.config.selectionAPI}},{key:"viewport",get:function(){return this.config.viewport}}]),H()(e,[{key:"bindEvent",value:function(){var e=this.blockManager.addListener;e("MENU_TRIGGER_ENTER",this.setBlockDraggingByMenu),e("MENU_TRIGGER_LEAVE",this.setBlockDraggingByMenu)}},{key:"unbindEvent",value:function(){this.blockManager.removeListener("MENU_TRIGGER_ENTER",this.setBlockDraggingByMenu),this.blockManager.removeListener("MENU_TRIGGER_LEAVE",this.setBlockDraggingByMenu)}},{key:"init",value:function(){this.bindEvent(),this.dragManager=new pf.b({scrollContainer:this.config.scrollContainer,usePointerEvent:Object(vf.x)(),topDelta:this.config.pageTop+20,bottomDelta:20}),this.dropManager=new pf.Y({withoutDropTarget:!0}),this.dragManager.register(Object(Of.wd)(this.config.dragCls),{onDragStart:this.onDragStart,getSnapshot:this.getSnapshot,onDrop:this.onDragManagerDrop,onDropSuccess:this.onDropSuccess,onDropFailed:this.onDropFailed}),this.dropManager.register(".fake-drop-container",{onDragMove:this.onDragMove,onDrop:this.onDropManagerDrop}),this.dragManager.connect(this.dropManager),this.snapshotManager=new Ff(this.blockManager,this.fold)}},{key:"destroy",value:function(){this.unbindEvent(),this.dragManager.destroy(),this.dropManager.destroy(),this.cancelDelaySetDragStyle()}},{key:"delaySetDragStyle",value:function(){var e=this;this.timer=window.setTimeout((function(){e.timer=0,e.setDraggingStyleToDraggingBlocks(),e.blockManager.dispatch("dragstart")}),500)}},{key:"setDragStyleImmediately",value:function(){this.timer&&(window.clearTimeout(this.timer),this.timer=0,this.setDraggingStyleToDraggingBlocks())}},{key:"cancelDelaySetDragStyle",value:function(){this.timer&&(window.clearTimeout(this.timer),this.timer=0),this.blockManager.dispatch("dragend")}},{key:"isCrossEditor",value:function(e){var n=document.elementFromPoint(e.x,e.y);if(!n)return!1;var r=Object(ll.S)(n);return!!r&&!this.blockManager.hasBlockModelByBlockId(r)}},{key:"reportDragEvent",value:function(e,n,r){var o=this;r=r.reduce((function(e,n){e.push(n);var r,i=o.blockManager.getBlockModelByBlockId(n),c=i.type,a=i.children;c===k.B.VIEW&&e.push(null===a||void 0===a||null===(r=a[0])||void 0===r?void 0:r.id);return e}),[]).filter(Boolean);var i=Object(zi.T)(r,this.blockManager),c=Object(zi.m)(e,this.blockManager),a=Object(zi.m)(n,this.blockManager);e&&Object(Wi.P)("ccm_doc_content_page_click",c,{click:"drag",sub_click:"drag_out",object_block_data:i,action_object:"block"}),n&&Object(Wi.P)("ccm_doc_content_page_click",a,{click:"drag",sub_click:"drag_in",object_block_data:i,action_object:"block"})}},{key:"saveDragOrigin",value:function(e,n){var r,o=this,i=e.reduce((function(e,n){var r=o.blockManager.getBlockModelByBlockId(n);return r&&e.add(r.type),e}),new Set),c=this.blockManager.getBlockModelByBlockId(e[0]),a=this.blockManager.getBlockModelByBlockId(e[e.length-1]);this.originDragParentId=(null===c||void 0===c||null===(r=c.parent)||void 0===r?void 0:r.id)||u.V,this.originNextBlock=a.nextSibling||void 0,this.dragContext=Hf(Hf({type:"block"},this.dragContext),{},{dragging:!0,origin:e,draggingTypes:i,isDragByMenu:!!this.blockDraggingByMenu,originX:n.x,originY:n.y})}},{key:"setDraggingStyleToDraggingBlocks",value:function(){var e=this;this.dragContext&&this.dragContext.dragging&&this.dragContext.origin.forEach((function(n){var r=e.blockManager.getBlockViewByBlockIdNotCheck(n);r&&Object(Of.p)(r.hostElement,Fd.g)}))}},{key:"resetDraggingStyle",value:function(){var e,n=this;(null===(e=this.dragContext)||void 0===e?void 0:e.origin)&&this.dragContext.origin.forEach((function(e){var r=n.blockManager.getBlockViewByBlockIdNotCheck(e);r&&Object(Of.h)(r.hostElement,Fd.g)}))}},{key:"saveDropContext",value:function(e){Object(tt.isEqualWith)(this.dropContext,e)||(this.dropContext=e,this.blockManager.dispatch(Fd.W,[e,this.dragContext]))}},{key:"resetContext",value:function(e){this.dragContext=null,this.dropContext=null,this.dropFailContext=null,this.notifiedDragging&&(this.notifiedDragging=!1,this.blockManager.dispatch(Fd.F,!1)),this.blockManager.dispatch(Fd.W,null),this.selectionAPI.activate(),this.cancelDelaySetDragStyle()}},{key:"analyzeDraggingBlock",value:function(e,n){var r=this,o=[],i=Object(ll.S)(e);if(this.blockDraggingByMenu&&!i)if(this.isBlockSelected(this.blockDraggingByMenu.id)){var c=this.selectionAPI.getSelection();o=Object(tt.uniq)(c.map((function(e){return e.id})))}else{var a=this.blockDraggingByMenu.type.includes("heading")&&this.blockDraggingByMenu.record.snapshot.folded?this.fold.findFoldedBlocks(this.blockDraggingByMenu.id):[];o=[this.blockDraggingByMenu.id].concat(s()(a))}else{if(!this.blockDraggingByMenu&&Object(vf.x)())return[];if(i){var l=this.selectionAPI.getSelection().filter((function(e){return e.type===Ei.j.BLOCK})).map((function(e){return e.id}));o=this.isBlockSelected(i)?l:[i]}}return o=o.map((function(e){return Object(gf.d)(r.blockManager.getBlockViewByBlockIdNotCheck(e),r.blockManager).id}))}},{key:"isBlockSelected",value:function(e){var n=this.selectionAPI.getSelection(),r=this.blockManager.getBlockViewByBlockIdNotCheck(e);return n.some((function(n){return n.id===e&&n.type===Ei.j.BLOCK}))||!(!r||!r.hostElement.closest(".selected"))}}]),e}(),Wf=r("dx_HsgL"),zf=(r("dx_MCZe"),gn.X+4),Gf=Object(Af.getThemeColorByToken)("B500-BG"),Kf="".concat(Gf,"19"),qf=function(e){var n=e.position,r=e.dropContext,o=e.blockManager,i=e.options,c=i.scrollContainer,a=i.unDroppable;if(!n||!r)return null;var l=r.hintLevel,s=r.dropToChild,u=r.parentId,d=r.targetId,f=r.direction,h=s?d:u;if(!h)return null;var p=c.closest(".scale-container"),v=p&&p.style.transform,g=v?v.indexOf("scale"):-1,b=1;if(v&&g>=0){var y=v.indexOf(")",g);b=Number(v.slice(g+6,y))}var m=o.getBlockViewByBlockId(h),_=Object(Of.w)(o,h,c,b),O=o.getRootBlockId(),x=Object(Of.w)(o,O,c,b);if(!_||!x)return null;if(f===_f.j.left||f===_f.j.right){if(!o.hasBlockViewByBlockId(d))return null;var E,S=o.getBlockViewByBlockId(d),C=Object(Wf.Q)(S),I=C?Object(Of.X)(C,c,b):Object(Of.w)(o,d,c,b),B=o.getBlockModelByBlockId(d),T=f===_f.j.left?null===I||void 0===I?void 0:I.left:null===I||void 0===I?void 0:I.right;if(f===_f.j.right)T=B.record.snapshot.type===k.B.GRID_COLUMN&&B.nextSibling?(T||0)+.5*yf.v+1:(null===(E=B.parent)||void 0===E?void 0:E.type)===k.B.CELL?T||0:(T||0)+4;var w=0;if(f===_f.j.left){var R=getComputedStyle(S.hostElement).marginLeft;w=parseFloat(R.replace("px","")),T=(T||0)-(w=Object(tt.isNaN)(w)?0:w)-2-4}var M=S.type===k.B.GRID_COLUMN?4:0,j=M+4,D={position:"absolute",left:"".concat(T,"px"),top:"".concat(((null===I||void 0===I?void 0:I.top)||0)-j,"px"),width:"".concat(2,"px"),height:"".concat(((null===I||void 0===I?void 0:I.height)||0)+2*j,"px"),backgroundColor:Gf,pointerEvents:"none"},A=null;if((S instanceof Bs.N||S.type===k.B.GRID_COLUMN)&&I){var P=I.left-w-M,L=I.width+2*M;if(m.type===k.B.CELL&&m.parentId){var N,F=o.getBlockViewByBlockId(m.parentId),U=(null===(N=F.scrollManage)||void 0===N?void 0:N.getScrollContainer())||F.hostElement,H=Object(Of.X)(U,c,b);P=Math.max(P,H.left),L=Math.min(I.right,H.right)-P}var V={position:"absolute",top:"".concat(I.top-M,"px"),left:"".concat(P,"px"),height:"".concat(I.height+2*M,"px"),width:"".concat(L,"px"),background:Kf,borderRadius:"".concat(4,"px"),pointerEvents:"none"};A=_e.a.createElement("div",{style:V})}return _e.a.createElement(_e.a.Fragment,null,_e.a.createElement("div",{style:D}),A)}var W=null;if(f===_f.j.bottom&&l&&l>0&&m.type!==k.B.GRID_COLUMN&&m.type!==k.B.CALLOUT){var z=s?l:l-1;W=Array(z).fill(0).map((function(e,n){var r=s?-zf*n:-zf*(n+1),o=Math.floor(256*(1-1/(z+2))).toString(16);return _e.a.createElement("div",{key:n,className:"drag-hint",style:{left:"".concat(r,"px"),width:"".concat(zf,"px")}},_e.a.createElement("div",{className:"drag-hint-inner",style:{background:"".concat(Gf).concat(o)}}))}))}var G=null;if(O!==h&&m.type!==k.B.GRID_COLUMN&&m.type!==k.B.CALLOUT&&!a.includes(m.type)){var K={position:"absolute",top:"".concat(_.top,"px"),left:"".concat(_.left,"px"),height:"".concat(_.height,"px"),width:"".concat(_.width,"px"),background:Kf,borderRadius:"".concat(4,"px"),pointerEvents:"none"};G=_e.a.createElement("div",{style:K})}var q=n.left,X=n.top,Y=function(e,n){if(n!==_f.j.bottom&&n!==_f.j.top)return!1;var r=o.getBlockViewByBlockId(e),i=o.getBlockModelByBlockId(e);if("quote"!==r.type)return!1;var c=n===_f.j.bottom?i.next:i.previous;return c&&"quote"===c.record.snapshot.type}(d,f)?q+16:q,J=_.right,Z=0;if(m.type===k.B.CELL&&m.parentId){var Q,$=o.getBlockViewByBlockId(m.parentId),ee=(null===(Q=$.scrollManage)||void 0===Q?void 0:Q.getScrollContainer())||$.hostElement,te=Object(Of.X)(ee,c,b);te&&(Y=Math.max(te.left,Y),J=Math.min(te.right,J),Z=te.right>J?fc.K:Z)}else m.type===k.B.CALLOUT?Z=16:m.type===k.B.PROGRESS&&(Z=12);var ne={position:"absolute",left:"".concat(Y/b,"px"),top:"".concat(X/b,"px"),width:"".concat(J-Y-Z,"px"),height:"".concat(2,"px"),backgroundColor:Gf,pointerEvents:"none",zIndex:10};return _e.a.createElement(_e.a.Fragment,null,_e.a.createElement("div",{style:ne},W),G)},Xf=r("dx_QJAX");var Yf=function(){function e(n){var r=this;F()(this,e),this.options=n,this.dragContext=null,this.dropContext=null,this.handleOver=Object(tt.throttle)((function(e){var n=r.options.blockManager;if(function(e){var n;if(h.S.isSafari&&(null===(n=e.dataTransfer)||void 0===n?void 0:n.types.some((function(e){return"Files"===e}))))return!0;var r=e.dataTransfer;return!!r&&(!!(r.files&&r.files.length>0)||Array.prototype.slice.apply(r.items).some((function(e){return"file"===e.kind})))}(e)){r.dragContext={type:"file",pageToken:r.options.token,dragEvent:e};try{var o=new Rf(n,r.dragContext,r.options).analyzeDropBlock(e);o&&"reason"in o?r.saveDropContext(null):r.saveDropContext(o)}catch(i){console.error(i),r.saveDropContext(null)}}}),100),this.handleDragLeave=function(e){r.saveDropContext(null),r.handleOver.cancel()},this.handleDrop=function(e){var n;r.handleOver.cancel();var o=(null===(n=e.dataTransfer)||void 0===n?void 0:n.files)||[];if(o.length>0){var i=new Xf.S(r.options.blockManager,r.options.fold,r.options.fileUploader),c=r.dragContext,a=r.dropContext;i.perform(c,a,o)}r.saveDropContext(null)},this.preventBodyEvent=function(e){var n;((null===(n=e.dataTransfer)||void 0===n?void 0:n.files)||[]).length>0&&r.preventEvent(e)},this.preventEvent=function(e){e.preventDefault()},this.bindEvent()}return H()(e,[{key:"bindEvent",value:function(){var e=this.options.scrollContainer;e.addEventListener("dragover",this.handleOver),e.addEventListener("dragleave",this.handleDragLeave),e.addEventListener("drop",this.handleDrop),document.body.addEventListener("dragenter",this.preventEvent),document.body.addEventListener("dragover",this.preventEvent),document.body.addEventListener("drop",this.preventBodyEvent)}},{key:"destroy",value:function(){var e=this.options.scrollContainer;e.removeEventListener("dragover",this.handleOver),e.removeEventListener("dragleave",this.handleDragLeave),e.removeEventListener("drop",this.handleDrop),document.body.removeEventListener("dragenter",this.preventEvent),document.body.removeEventListener("dragover",this.preventEvent),document.body.removeEventListener("drop",this.preventBodyEvent)}},{key:"saveDropContext",value:function(e){this.dropContext!==e&&this.options.blockManager.dispatch(Fd.W,[e,this.dragContext]),this.dropContext=e}}]),e}();function Jf(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var Zf=ar()("drop:position"),Qf=function(e){G()(r,e);var n=Jf(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).dragManager=void 0,e.dragUploader=void 0,e}return H()(r,[{key:"getAfterSlot",value:function(){var e=this;return function(n){var r=n.recursionProps.editable,o=Object(me.useState)(null),i=$e()(o,2),c=i[0],a=i[1],l=Object(me.useState)(null),s=$e()(l,2),u=s[0],d=s[1],f=Object(me.useState)(void 0),h=$e()(f,2),p=h[0],v=h[1],g=function(n,r){var o;if(r||v(void 0),!n)return Zf("\u91cd\u7f6e drop position"),d(null),a(null);var i,c=n.targetId,l=n.direction,s=0;if(i=c===e.blockManager.rootBlockId?Object(Of.M)(e.blockManager,c,e.options.scrollContainer):Object(Of.w)(e.blockManager,c,e.options.scrollContainer)){if(l===_f.j.top){var u=e.blockManager.getBlockModelByBlockId(c);if(Object(Of.I)(u))s=i.top;else{var f=u.previousSibling;f&&(i=Object(Of.w)(e.blockManager,f.id,e.options.scrollContainer))&&(s=i.bottom)}}l===_f.j.bottom&&i&&(s=i.bottom);var h=e.blockManager.getRootBlockId(),p=Object(Of.w)(e.blockManager,h,e.options.scrollContainer);Zf("\u8ba1\u7b97\u7ed3\u679c",null===(o=i)||void 0===o?void 0:o.left,s),p&&i&&(a({left:i.left,top:s}),d(n)),v(r)}else Zf("\u627e\u4e0d\u5230 rect",c)};return Object(me.useEffect)((function(){if(r)return e.dragManager=new Vf(e.options),e.dragUploader=new Yf(e.options),function(){e.destroy()}}),[r]),Object(me.useEffect)((function(){return e.blockManager.addListener(Fd.W,g),function(){e.blockManager.removeListener(Fd.W,g)}}),[]),r?so.a.createPortal(_e.a.createElement(qf,{position:c,dropContext:u,blockManager:e.blockManager,options:e.options,dragContext:p}),document.getElementById("docx-draggable-rectangle-container")):null}}},{key:"destroy",value:function(){this.dragManager&&this.dragManager.destroy(),this.dragUploader&&this.dragUploader.destroy(),this.dragManager=null,this.dragUploader=null}}]),r}(Hi.A),$f=r("dx_tp1j"),eh=r("dx_T1AN");function th(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function nh(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?th(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):th(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function rh(e){return[[hf.S,e]]}function oh(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function ih(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?oh(Object(r),!0).forEach((function(n){_t()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oh(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var ch=function(e){var n=[].concat(s()(rh(e)),[[xa,e]]),r=[us.S,Cc(e)],o=[wc.S,e],i=Nr.S.checkShouldRegisComment()?[[Dc.M,e]]:[],c=function(e){return[[Oc.S,e]]}(e),a=[].concat(s()(n),s()(c),[o]),l=[].concat(s()(n),[r],s()(c),[o]),d=[].concat(s()(l),[[la.i,e]]),f=[ds.S,e],p=[].concat(s()(l),[f]),v=s()(l),g=[].concat(s()(n),[[Fa.c,e]],i,[[Tc.S,e]]),b=[].concat(s()(n),s()(Object(Ic.o)(k.B.IMAGE,e))),y=[].concat(s()(n),[[Fa.c,e],[jc.R,ih(ih({},e),{},{displayMode:k.J.BLOCK,autoNotifyRenderFinish:!0})],hu.S,[Tc.S,e]],i,[[Rc.S,e]]),m=[].concat(s()(n),[[Fa.c,e],[jc.R,ih(ih({},e),{},{displayMode:k.J.BLOCK})]],i,[hu.S,[Uc.S,e]]),_=[].concat(s()(n),[[Fa.c,e],[Tc.S,e]],i,[[Rc.S,e],hu.S]),O=[[Fa.c,e]].concat(s()(rh(e))),x=[].concat(s()(n),[[Fa.c,e],hu.S],i,[[Rc.S,e]]),E=[].concat(s()(n),[[kl,e]],s()(Object(Ic.o)(k.B.SHEET,e,{overrideProps:[[jc.R,{autoNotifyRenderFinish:!0}]]}))),S=[].concat(s()(n),[[gl,e]],s()(Object(Ic.o)(k.B.BITABLE,e,{overrideProps:[[jc.R,{autoNotifyRenderFinish:!0}]]}))),C=[].concat(s()(n),[[yl,e]],s()(Object(Ic.o)(k.B.MINDMAP,e,{overrideProps:[[jc.R,{autoNotifyRenderFinish:!0}]]})),[hu.S,[Rc.S,e]]),I=[].concat(s()(n),[[Fa.c,e],hu.S,[jc.R,ih(ih({},e),{},{displayMode:k.J.BLOCK})],[Tc.S,e]],i),B=[].concat(s()(n),[[Fa.c,e]],[[jc.T,ih(ih({},e),{},{displayMode:k.J.BLOCK,autoNotifyRenderFinish:!0})]],s()(Object(Ic.o)(k.B.TABLE,e)),s()(function(e){return[[sc,e],[_c,e]]}(e))),T=s()(n),w=[].concat(s()(n),s()(Object(Ic.o)(k.B.FILE,e)),[[Rc.S,e]]),R=[].concat(s()(n),s()(Object(Ic.o)(k.B.CHAT_CARD,e)),[[Rc.S,e]]),M=[].concat(s()(n),[[Fa.c,e]],s()(c),[hu.S,[Rc.S,e]]),j=[].concat(s()(n),[[Fa.c,e],[jc.R,ih(ih({},e),{},{displayMode:k.J.INLINE})]]),D=[].concat(s()(n),[[Fa.c,e],[jc.R,ih(ih({},e),{},{displayMode:k.J.BLOCK,autoNotifyRenderFinish:!0})],hu.S,[Tc.S,e]],i),A=[[Na,e],[Hc.S,e],[fs.S,e],[nl,e],[fu,e],[ls,e],[Pc.S,e],[Fc,e],[Ba,e]].concat(s()(function(e){var n;return[[sf,e],[ef,e],[$u,e],[wd,e],[ad,e],[eh.S,nh(nh({},e),{},{eventContainer:e.container,scrollContainer:e.boundary,ignoreClasses:["menu-trigger","overlay-mask","block-overlay","bidirection-link-list"],noResponseTarget:["column-resizer-item","column-gap"],blockFilters:[".backlink"]})],[Su,e],[Qf,nh(nh({},e),{},{dragCls:[Fd.N,Cu.I,"selected:not(.table-cell-block)",Cu.g],container:(n={},_t()(n,k.B.PAGE,"all"),_t()(n,k.B.GRID,"all"),_t()(n,k.B.GRID_COLUMN,"all"),_t()(n,k.B.CALLOUT,"all"),_t()(n,k.B.TABLE,"all"),_t()(n,k.B.CELL,"all"),_t()(n,k.B.OKR,"all"),_t()(n,k.B.OBJECTIVE,"all"),_t()(n,k.B.KEY_RESULT,"all"),_t()(n,k.B.PROGRESS,"all"),_t()(n,k.B.QUOTE_CONTAINER,"all"),_t()(n,k.B.TASK,"all"),n),unDraggable:[k.B.GRID_COLUMN,k.B.GRID],unDroppable:[k.B.GRID,k.B.GRID_COLUMN,k.B.FILE,k.B.VIEW,k.B.TABLE,k.B.CELL,k.B.OKR,k.B.OBJECTIVE,k.B.KEY_RESULT,k.B.PROGRESS],gap:36,isDraggingMenuTrigger:function(e){return!!(e&&e.className&&e.className.includes(Cu.I))},canDropToChild:function(e){return!(!Object(ca.Q)()||!Object(ca.i)()||e.type!==k.B.TASK)||!([k.B.TEXT].concat(s()(k.O)).includes(e.type)&&0===e.children.length&&!Object(uf.K)(e.parent.type))&&Object(uf.K)(e.type)},pageTop:gn.qT,pageLeft:gn.F,scrollContainer:e.boundary,token:e.blockManager.rootRecordId})]].concat(s()(h.S.isFeed?[]:[[mu.m,e]]),[[$f.S,e],[Dd,e]],s()(Object(df.a)()?[[ff.S,e]]:[]))}(e)),[[ss.S,ih(ih({},e),{},{rootId:e.blockManager.rootRecordId})],[Ac.x,e],[fl,e],[cl,e],[Mc.S,e]],s()(Object(Ja.J)()?[[Ya.x,e]]:[]),[[yu,e]]),P=[].concat(s()(n),[[Fa.c,e],hu.S],i),L=[].concat(s()(n),[[Fa.c,e],hu.S],i),N=[].concat(s()(n),[r,[Fa.c,e],hu.S],i),F=s()(rh(e)),U=Object(Bc.P)()?[[Xa,e]]:[],H=Object(Ua.Q)()?[].concat(s()(n),[[Fa.c,e],[Tc.S,e],[Dc.M,e]]):[],V=Object(Ua.i)()?[].concat(s()(n),[[Fa.c,e],[Tc.S,e],[Dc.M,e]]):[],W=[[u.P,A],[k.B.TEXT,l],[k.B.HEADING1,d],[k.B.HEADING2,d],[k.B.HEADING3,d],[k.B.HEADING4,d],[k.B.HEADING5,d],[k.B.HEADING6,d],[k.B.HEADING7,d],[k.B.HEADING8,d],[k.B.HEADING9,d],[k.B.IMAGE,b],[k.B.FILE,w],[k.B.IFRAME,m],[k.B.BOOKMARK,_],[k.B.BLANK,n],[k.B.CHAT_CARD,R],[k.B.BULLET,v],[k.B.DIVIDER,g],[k.B.QUOTE,a],[k.B.QUOTE_CONTAINER,O],[k.B.CALLOUT,x],[k.B.CODE,M],[k.B.ORDERED,p],[k.B.GRID,n],[k.B.GRID_COLUMN,n],[k.B.TODO,l],[k.B.FALLBACK,n],[k.B.DIAGRAM,y],[k.B.PENDING,j],[k.B.PAGE,U],[k.B.TABLE,B],[k.B.CELL,T],[k.B.SHEET,E],[k.B.BITABLE,S],[k.B.MINDMAP,C],[k.B.POLL,D],[k.B.OKR,P],[k.B.TASK,N],[k.B.VIEW,F],[k.B.JIRA_ISSUE,L],[k.B.WIKI_CATALOG,H],[k.B.WIKI_RECENT,V]];return h.S.isFeishuRooms&&!Object(et.getISVBlockInRoomsEnabled)()||W.push([k.B.ISV,I]),W},ah=r("dx_HOeV"),lh=r("dx_alfx"),sh=r("dx_qdTf");function uh(e){return{type:Xt.R.SwitchViewEditorsStatus,payload:{isOpen:e}}}var dh=r("dx_jNWT"),fh=r("dx_nAwp");var hh,ph=r("dx_VY1y"),vh=r("dx_xy70"),gh=r("dx_X279");!function(e){e.INIT="init",e.UPDATE="update"}(hh||(hh={}));var bh,yh,mh,_h,kh,Oh,xh,Eh,Sh,Ch=r("dx_zz3R"),Ih=function(){function e(n){var r=this;F()(this,e),this.userIds=new Set,this.timer=null,this.rxOp=void 0,this.userIdToUserInfoMap=new Map,this.blockIdToUserIdMap=new Map,this.blockIdToCallbackMap=new Map,this.debouncedFetchUserInfo=Object(tt.debounce)((function(){r.fetchUserInfo()}),100),this.fetchUserInfo=Gt()(Wt.a.mark((function e(){var n;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.batchFetchEditorsInfos(s()(r.userIds));case 2:n=e.sent,r.blockIdToCallbackMap.forEach((function(e,o){var i=r.blockIdToUserIdMap.get(o);if(i){var c=n.get(i);c&&([e[hh.INIT],e[hh.UPDATE]].forEach((function(e){e&&e(c)})),r.blockIdToCallbackMap.delete(o))}}));case 4:case"end":return e.stop()}}),e)}))),this.rxOp=n}return H()(e,[{key:"getAuthorInfo",value:function(e,n,r,o){var i=this.userIdToUserInfoMap.get(n);if(n)if(i)r(i);else{this.blockIdToUserIdMap.set(e,n);var c=this.blockIdToCallbackMap.get(e);c||(c={}),c[o]=r,this.blockIdToCallbackMap.set(e,c),this.userIds.add(n),this.debouncedFetchUserInfo()}else r({userId:n})}},{key:"batchFetchEditorsInfos",value:function(){var e=Gt()(Wt.a.mark((function e(n){var r,o,i=this;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=s()(n);case 1:if(!(r.length>0)){e.next=12;break}return o=r.splice(0,200),e.prev=3,e.delegateYield(Wt.a.mark((function e(){var n;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.rxOp.toPromise(i.fetchEditorsInfos(o));case 2:n=e.sent,Object.keys(n).forEach((function(e){i.userIdToUserInfoMap.set(e,{userId:e,userInfo:{name:n[e].name,enName:n[e].enName,isDesensitize:n[e].isDesensitize},color:et.userColorHelper.getColorByUserId(e)})}));case 4:case"end":return e.stop()}}),e)}))(),"t0",5);case 5:e.next=10;break;case 7:return e.prev=7,e.t1=e.catch(3),e.abrupt("return",this.userIdToUserInfoMap);case 10:e.next=1;break;case 12:return e.abrupt("return",this.userIdToUserInfoMap);case 13:case"end":return e.stop()}}),e,this,[[3,7]])})));return function(n){return e.apply(this,arguments)}}()},{key:"fetchEditorsInfos",value:function(){var e=Gt()(Wt.a.mark((function e(n){var r,o=this,i=arguments;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:3,e.abrupt("return",Ch.q.requestEditors(n).then((function(e){return e.data.details})).catch(function(){var e=Gt()(Wt.a.mark((function e(i){return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(rr.N)("dev_doc_fetch_editors_catch",{err:i,times:r}),!(r>0)){e.next=7;break}return e.next=4,Object(or.E)(3/r*1e3);case 4:return e.abrupt("return",o.fetchEditorsInfos(n,--r));case 7:throw new Error("meet error");case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this.userIds.clear(),this.timer&&clearTimeout(this.timer),this.timer=null,this.userIdToUserInfoMap.clear(),this.blockIdToUserIdMap.clear(),this.blockIdToCallbackMap.clear(),this.rxOp.destroy()}}]),e}(),Bh=Object(ce.s)(ah.a)((yh=function(){function e(){var n=this;F()(this,e),L()(this,"api",mh,this),L()(this,"modelService",_h,this),L()(this,"blockManager",kh,this),this.rxOp=new et.RxjsDestroyableOperator,this.subscriptions=[],this.blockIdToAuthorInfo=new Map,this.updateModelMap=new Map,this.destroyModelMap=new Map,this.blockIdToInitialBlockInfoMap=new Map,this.updateTimer=void 0,this.tableBlockIdToCellAuthorMap=new Map,this.userInfoFetcher=new Ih(this.rxOp),this.isViewEditors=void 0,this.isTranslated=void 0,this.unbindStoreUpdateEvent=void 0,this.isHoverAuthorArea=!1,this.authorArea=void 0,this.wikiSidebarWidth=0,this.blockIdToUpdateStyleCallbackMap=new Map,this.taskScheduler=new fh.T,this.authorChanged$=new tr.Z,this.authorInit$=new tr.Z,this.needShowEditorsStateChanged$=new tr.Z,this.forceDisconnectChanged$=new tr.Z,this.needShowCloseBtn$=new tr.Z,this.lang=et.i18nHelper.getLanguage(),this.getActualBlock=function(e){return k.Y.includes(e.type)&&e.children.length?e.children[0]:e},this.initBlockList=function(e,r){e.children.forEach((function(e){var o=n.getActualBlock(e),i=n.getBlockMainAuthor(o),c={blockId:e.id,authorId:i,foldedChildren:[]};r.push(c),i?n.blockIdToAuthorInfo.set(e.id,{userId:i}):n.blockIdToAuthorInfo.delete(e.id),Object(k.q)().includes(e.type)&&(e.snapshot.folded?n.initBlockList(e,c.foldedChildren):n.initBlockList(e,r))}))},this.initBlockStateMap=function(e){e.forEach((function(r,o){var i=r.blockId,c=r.authorId,a=e[o-1],l=e[o+1],s=(null===a||void 0===a?void 0:a.authorId)===c,u=(null===l||void 0===l?void 0:l.authorId)===c;Object(sh.i)(null===a||void 0===a?void 0:a.blockId,n.blockManager)&&(s=!1),Object(sh.i)(null===l||void 0===l?void 0:l.blockId,n.blockManager)&&(u=!1),n.blockIdToInitialBlockInfoMap.set(i,{blockId:i,authorInfo:{userId:c||""},sameAsPrevious:s,sameAsNext:u}),r.foldedChildren.length>0&&n.initBlockStateMap(r.foldedChildren)}))},this.handleMouseMove=Object(tt.throttle)((function(e){var r=e.clientX;if(n.authorArea){var o=n.authorArea[0],i=n.authorArea[1],c=r>=o&&r<=i;c!==n.isHoverAuthorArea&&(n.needShowCloseBtn$.next({blockId:n.modelService.rootBlockModel.children[0].id,needShowCloseBtn:c}),n.isHoverAuthorArea=c)}}),300),this.openViewEditors=function(){document.addEventListener("mousemove",n.handleMouseMove),n.bindBlockModelUpdateEvent(),n.initEditorsData()},this.closeViewEditors=function(){document.removeEventListener("mousemove",n.handleMouseMove),n.clearSubscriptions(),n.taskScheduler.destroy(),n.blockIdToUpdateStyleCallbackMap.clear(),n.blockIdToInitialBlockInfoMap.clear()},this.emitInitAuthor=function(e){var r,o=n.blockIdToInitialBlockInfoMap.get(e),i=n.blockManager.getBlockModelByBlockId(e);if(o)r=o.authorInfo.userId;else{var c=i;Object(sh.O)(i)&&(c=Object(sh.b)(i));var a=Object(sh.o)(i);r=n.getBlockMainAuthor(a||c)}r?n.getAuthorInfo(e,r,(function(r){n.taskScheduler.addTask((function(){r.userId?n.authorInit$.next({blockId:e,authorInfo:{userId:r.userId,userInfo:r.userInfo,color:r.color},sameAsPrevious:(null===o||void 0===o?void 0:o.sameAsPrevious)||!1,sameAsNext:(null===o||void 0===o?void 0:o.sameAsNext)||!1}):n.authorInit$.next(n.getEmptyAuthorInfo(e))}))}),hh.INIT):n.taskScheduler.addTask((function(){n.authorInit$.next({blockId:e,authorInfo:{userId:""},sameAsPrevious:!1,sameAsNext:!1})}))},this.initEditorsData=function(){var e=[];n.initBlockList(n.modelService.rootBlockModel,e),n.initBlockStateMap(e),s()(n.blockIdToInitialBlockInfoMap.keys()).forEach((function(e){n.emitInitAuthor(e)}))},this.bindBlockModelUpdateEvent=function(){n.subscriptions.push(n.modelService.blockModelUpdate$.subscribe(n.handleModelUpdate)),n.subscriptions.push(n.modelService.blockModelCreate$.subscribe(n.handleModelUpdate)),n.subscriptions.push(n.modelService.blockModelDestroy$.subscribe(n.handleModelDestroy))},this.bindStoreUpdateEvent=function(){n.unbindStoreUpdateEvent=Zt.a.subscribe(Gt()(Wt.a.mark((function e(){var r,o;return Wt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(dh.B)(Zt.a.getState()),o=et.selectors.translate.selectTranslateStatus(Zt.a.getState()).translated,n.isViewEditors===r&&n.isTranslated===o){e.next=9;break}return n.isViewEditors=r,n.isTranslated=o,n.needShowEditorsStateChanged$.next({isViewEditors:r,isTranslated:o}),e.next=8,Object(xi.i)();case 8:n.updateAuthorArea();case 9:case"end":return e.stop()}}),e)}))))},this.updateStyleNearDestroyedBlock=Object(tt.debounce)((function(){var e=Array.from(n.destroyModelMap.values()).map((function(e){return e.id}));n.updateBlockStyle(e)}),100),this.handleModelDestroy=function(e){var r=Object(sh.D)(e.model),o=Object(sh.A)(e.model);r&&n.destroyModelMap.set(r.id,r),o&&n.destroyModelMap.set(o.id,o),n.destroyModelMap.has(e.model.id)&&n.destroyModelMap.delete(e.model.id),n.updateStyleNearDestroyedBlock()},this.handleModelUpdate=function(e){e.model.type===k.B.PAGE&&e.model.next?n.updateAuthorInfo(e.model.next):(n.updateModelMap.set(e.model.id,e.model),n.updateTimer&&clearTimeout(n.updateTimer),n.updateTimer=window.setTimeout((function(){n.updateTimer=null;var e=Array.from(n.updateModelMap.values());n.updateModelMap.clear(),e.forEach((function(e){n.updateAuthorInfo(e)}))}),200))},this.updateAuthorInfo=function(e){var r=e;Object(sh.O)(e)&&(r=Object(sh.b)(e));var o=Object(sh.o)(e),i=n.getBlockMainAuthor(o||r),c={blockId:r.id};if(!i)return n.blockIdToAuthorInfo.delete(r.id),void n.taskScheduler.addTask((function(){n.authorChanged$.next({blockInfo:c})}));n.blockIdToAuthorInfo.set(r.id,{userId:i}),n.getAuthorInfo(r.id,i,(function(e){c.authorInfo=e,n.taskScheduler.addTask((function(){e.userId?n.authorChanged$.next({blockInfo:c}):n.authorChanged$.next({blockInfo:n.getEmptyAuthorInfo(r.id)})}))}),hh.UPDATE)},this.onViewEditorsMenuChange=function(e){Zt.a.dispatch(uh(e)),et.userPreference.addCurrentPreference(e),e?n.openViewEditors():n.closeViewEditors()},this.onWikiResizeChange=Object(tt.throttle)((function(e){e&&(n.wikiSidebarWidth=window.innerWidth-e.width,n.updateAuthorArea())}),500)}return H()(e,[{key:"getLanguage",value:function(){return this.lang}},{key:"setUpdateCallback",value:function(e,n){this.blockIdToUpdateStyleCallbackMap.set(e,n)}},{key:"updateBlockStyle",value:function(e){var n=this;e.forEach((function(e){if(e){var r=n.blockIdToUpdateStyleCallbackMap.get(e);r&&r()}}))}},{key:"getAuthorInfoByBlockId",value:function(e){return this.blockIdToAuthorInfo.get(e)}},{key:"getEmptyAuthorInfo",value:function(e){return{blockId:e,authorInfo:{userId:""},sameAsPrevious:!1,sameAsNext:!1}}},{key:"getAuthorInfo",value:function(e,n,r,o){this.userInfoFetcher.getAuthorInfo(e,n,r,o)}},{key:"getBlockMainAuthor",value:function(e){var n=e.snapshot.author;return ph.O.includes(e.type)||e.type===k.B.CELL?this.getContainerMainAuthor(e):ph.e0.includes(e.type)?this.getTextualBlockMainAuthor(e):n}},{key:"getTextualBlockMainAuthor",value:function(e){if(e.record.snapshot.text&&e.zoneState){var n=e.zoneState.content.ops,r="",o=new Map;return n.forEach((function(n){if(n.attributes){if(!n.attributes.fixEnter){var i=n.attributes.author,c=n.attributes["inline-component"]||n.attributes.inlineblock?1:n.insert.length,a=(o.get(i)||0)+c;o.set(i,a),(!r||o.get(r)<a)&&(r=i)}}else console.error("====> op.attributes is undefined! block id:",e.id)})),o.get(r)||(r=e.type===k.B.CODE?e.snapshot.author:""),r}}},{key:"getContainerMainAuthor",value:function(e){var n=new Map,r={},o="",i=function(e,r){var i=(n.get(e)||0)+r;n.set(e,i),(!o||n.get(o)<i)&&(o=e)},c=function(e,n,o){var i=(r[e][n]||0)+o;r[e][n]=i},a=function e(n){var o,a=s()(n.children),l=n.type,u=null===(o=Object(sh.o)(n))||void 0===o?void 0:o.id,d=!!u;if(ph.e0.includes(l)){var f=n.record.snapshot.text;if(!f)return;Object(lh.Z)(f.initialAttributedTexts,f.apool).deltas[0].ops.forEach((function(e){if(e.attributes){if(!e.attributes.fixEnter){var r=e.attributes.author,o=e.attributes["inline-component"]||e.attributes.inlineblock?1:e.insert.length;d?c(u,r,o):i(r,o)}}else console.error("====> op.attributes is undefined! block id:",n.id)}))}else if(ph.Ar.includes(l)){var h=n.snapshot.author;d?c(u,h,1):i(h,1)}else if(n.type===k.B.CELL){var p=n.id;r[p]={}}a.length&&a.forEach((function(n){e(n)}))},l=e.type===k.B.CELL,u=l?e.parent:null;e.type===k.B.TABLE&&(u=e);var d=u?this.tableBlockIdToCellAuthorMap.get(u.id):null;if(u?l&&d?(a(e),Object.keys(r).forEach((function(e){d[e]=r[e]}))):(a(u),this.tableBlockIdToCellAuthorMap.set(u.id,r)):a(e),u){var f={},h="",p=this.tableBlockIdToCellAuthorMap.get(u.id);p&&(Object.values(p).forEach((function(e){for(var n in e){var r=e[n],o=(f[n]||0)+r;f[n]=o,(!h||void 0!==f[h]&&f[h]<o)&&(h=n)}})),o=h)}return o=o||e.snapshot.author}},{key:"bindInitEvent",value:function(e){"on"===e?et.EventEmitter.on("viewEditorsMenuChange",this.onViewEditorsMenuChange):et.EventEmitter.off("viewEditorsMenuChange",this.onViewEditorsMenuChange)}},{key:"clearSubscriptions",value:function(){this.subscriptions.forEach((function(e){e.unsubscribe()})),this.subscriptions.length=0}},{key:"updateAuthorArea",value:function(){var e,n,r=(null===(e=this.api.config.get("getEditorStyle"))||void 0===e||null===(n=e())||void 0===n?void 0:n.marginLeft)||0,o=Number(r)+gn.r+gn.FT-gn.id-ph.a;this.authorArea=[o+ph.a+this.wikiSidebarWidth-gn.y,o+ph.a+this.wikiSidebarWidth]}},{key:"init",value:function(){var e=this;if(!h.S.isMobile){this.bindInitEvent("on"),this.bindStoreUpdateEvent();var n=et.userPreference.getPreferenceStatus()||!1;Zt.a.dispatch(uh(n)),n&&(vh.O.pipe(this.rxOp.takeUntil()).subscribe((function(){e.openViewEditors()})),this.bindBlockModelUpdateEvent()),!function(){var e=!1;try{et.wikiLinkInstance?e=et.wikiLinkInstance.isWiki():lr.isWiki&&(e=Object(lr.isWiki)())}catch(n){}return e}()?vh.O.pipe(this.rxOp.takeUntil()).subscribe((function(){e.updateAuthorArea()})):Object(gh.N)().onResize(this.onWikiResizeChange)}}},{key:"destroy",value:function(){this.bindInitEvent("off"),this.clearSubscriptions(),this.rxOp.destroy(),this.tableBlockIdToCellAuthorMap.clear(),this.blockIdToAuthorInfo.clear(),this.userInfoFetcher.destroy(),this.closeViewEditors(),this.unbindStoreUpdateEvent(),Object(gh.N)().offResize(this.onWikiResizeChange)}},{key:"isNeedShowEditors",get:function(){return this.isViewEditors&&!this.isTranslated}}]),e}(),mh=Z()(yh.prototype,"api",[u.Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_h=Z()(yh.prototype,"modelService",[u.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kh=Z()(yh.prototype,"blockManager",[it.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bh=yh))||bh;function Th(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=Y()(e);if(n){var i=Y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return q()(this,r)}}var wh=Object(u.H)({providers:[Bh]})((Sh=function(e){G()(r,e);var n=Th(r);function r(){var e;F()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),L()(e,"blockAuthorService",Eh,W()(e)),e}return H()(r,[{key:"init",value:function(){this.blockAuthorService.init()}},{key:"destroy",value:function(){this.blockAuthorService.destroy()}}]),r}(u.G),xh=Sh,Eh=Z()(xh.prototype,"blockAuthorService",[ah.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oh=xh))||Oh;function Rh(){return[].concat(s()(Object(Ke.D)()),s()(Ec()))}function Mh(){return h.S.isOpendoc?s()(Object(Ke.D)()):[].concat(s()(Object(Ke.D)()),s()(Object(Ke.B)([[Ge.v]])))}function jh(){var e=[[d.R,{authorId:Object(p.K)().userId||""}],[ze.Rf],[ze.Z],[ze.hi],[ze.hS],[ze.q],[f.j]];return Nr.S.checkShouldRegisComment()&&e.push([ze.W]),Object(Ke.B)(e)}function Dh(e){var n=[Object(u.Y)(A.i,{getTextEditorOptions:Sc}),Object(u.Y)(Le),Object(u.Y)(m.D,{getTextEditorOptions:jh}),Object(u.Y)(We.T,{getTextEditorOptions:Rh}),Object(u.Y)(C.R,{getTextEditorOptions:Rh}),Object(u.Y)(Fe.y,{getTextEditorOptions:Rh}),Object(u.Y)(M.D,{getTextEditorOptions:Rh}),Object(u.Y)(R.a,{getTextEditorOptions:Rh}),Object(u.Y)(qe.Y,{getTextEditorOptions:Rh}),Object(u.Y)(w.o,{getTextEditorOptions:Rh}),Object(u.Y)(x.S),Object(u.Y)(b.G),Object(u.Y)(v.S),Object(u.Y)(O.S),Object(u.Y)(Ue.S),Object(u.Y)(j.S),Object(u.Y)(Ne.Q),Object(u.Y)(D.S,{getTextEditorOptions:Mh}),Object(u.Y)(Ye.Z),Object(u.Y)(Je.l),Object(u.Y)(E.S),Object(u.Y)(Xe.S),Object(u.Y)(B.S),Object(u.Y)(I.S),Object(u.Y)(y.S),Object(u.Y)(g.S),Object(u.Y)(S.w),Object(u.Y)(He.A),Object(u.Y)(Fo),Object(u.Y)(_.T),Object(u.Y)($n.u,{loadableBlockTypes:[k.B.MINDMAP,k.B.BITABLE,k.B.SHEET,k.B.FILE,k.B.CODE,k.B.DIAGRAM]}),Object(u.Y)(Pt),Object(u.Y)(gt.E),Object(u.Y)(Lr),Object(u.Y)(Di.S),Object(u.Y)(Mi,e.undo),Object(u.Y)(zr),Object(u.Y)(vt),Object(u.Y)(ci),Object(u.Y)(Qo),Qn.forVirtualRender(),Object(u.Y)(ji.h),Object(u.Y)(bt.B,{getExtensions:ch})].concat(s()([wh]));return h.S.isOpendoc||(n.push(Object(u.Y)(T.S)),n.push(Object(u.Y)(Ve.Y))),n}},dx_KgXx:function(e,n,r){"use strict";r.d(n,"R",(function(){return s})),r.d(n,"v",(function(){return u}));r("dx_RIqP");var o=r("dx_J4zp"),i=r.n(o),c=r("dx_MWd8");function a(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return l(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw c}}}}function l(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function s(e){return e?"var(--".concat(e,")"):""}function u(e,n){if(n&&e){var r,o,l=a(e);try{for(l.s();!(o=l.n()).done;){var s=i()(o.value,2),u=s[0],d=s[1];if(n&&d&&Object(c.J)(n,d)){r=u;break}}}catch(f){l.e(f)}finally{l.f()}return r}}},dx_KgoN:function(e,n,r){},dx_Kkdw:function(e,n,r){},dx_Kkjd:function(e,n,r){"use strict";r.d(n,"J",(function(){return o})),r.d(n,"w",(function(){return c})),r.d(n,"V",(function(){return a}));var o,i=r("dx_UtDZ");!function(e){e.TABLE="table",e.FOLDABLE="foldable",e.NORMAL="normal"}(o||(o={}));var c=Object(i.getMinaConfig)("ccm.docx.allow_pre_edit",!1),a="docx_lazy_consumer_config"},dx_KvuI:function(e,n,r){"use strict";r.d(n,"s",(function(){return a}));var o=r("dx_QxNg");function i(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return c(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return l=e.done,e},e:function(e){s=!0,a=e},f:function(){try{l||null==r.return||r.return()}finally{if(s)throw a}}}}function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function a(e){var n=e.recordOps,r=e.checkModel,c={};return n.forEach((function(e){var n=r.children;if(r.recordId===e.id){var a=function(e){var n=e.ops[0];return Object(o.X)(n)&&0===n.p[1]?{isFirstOp:!0,nodeIndexHeightChange:0}:Object(o.ZH)(n)&&0===n.p[1]?{isFirstOp:!0,nodeIndexHeightChange:1}:{isFirstOp:!1,nodeIndexHeightChange:-1}}(e),l=a.isFirstOp,s=a.nodeIndexHeightChange;l&&(c.first=n[s]);var u=function(e,n){var r,c=n-1,a=i(e.ops);try{for(a.s();!(r=a.n()).done;){var l=r.value;if(Object(o.X)(l)&&l.p[1]===c+1)return{isEndOp:!0,nodeIndexHeightChange:c};if(Object(o.ZH)(l)&&l.p[1]&&l.p[1]===c)return{isEndOp:!0,nodeIndexHeightChange:c-1}}}catch(s){a.e(s)}finally{a.f()}return{isEndOp:!1,nodeIndexHeightChange:-1}}(e,n.length),d=u.isEndOp,f=u.nodeIndexHeightChange;d&&(c.last=n[f])}})),c}},dx_KzX9:function(e,n,r){},dx_L0LN:function(e,n,r){"use strict";r.d(n,"h",(function(){return h}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W7W2"),a=r.n(c),l=r("dx_a1gu"),s=r.n(l),u=r("dx_Nsbk"),d=r.n(u);function f(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var h=function(e){a()(r,e);var n=f(r);function r(){return i()(this,r),n.apply(this,arguments)}return r}(r("dx_Vvd7").y)},dx_L0Lv:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("g",{fill:"none",fillRule:"evenodd"},i.a.createElement("path",{fill:"#DEE0E3",d:"M57.407 8.114L6.539 17.083l8.263 46.86 50.867-8.97z"}),i.a.createElement("path",{fill:"#F5F6F7",d:"M21.913 19.722H61.67v38.191H21.913z"}),i.a.createElement("path",{fill:"#C3C6CB",fillRule:"nonzero",d:"M28.174 28.033h27.235v-1.125H28.174zm0 5.009h27.235v-1.125H28.174zm0 5.1h27.235v-1.125H28.174zm0 5.009h17.374v-1.125H28.174z"}),i.a.createElement("g",{transform:"translate(46 46)"},i.a.createElement("path",{fill:"#FFC60A",d:"M0 9a9 9 0 009 9 9 9 0 009-9 9 9 0 00-9-9 9 9 0 00-9 9z"}),i.a.createElement("rect",{width:1.688,height:1.688,x:8.156,y:11.813,fill:"#FFF",rx:.5}),i.a.createElement("rect",{width:1.688,height:5.625,x:8.156,y:4.5,fill:"#FFF",rx:.5})));n.S=function(e){return i.a.createElement("svg",c({width:72,height:72,viewBox:"0 0 72 72"},e),a)}},dx_L2tv:function(e,n,r){"use strict";(function(t){r.d(n,"P",(function(){return f}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_o1Cw"),c=r("dx_PcQO"),a=r("dx_UtDZ"),l=r("dx_cDcd"),s=r.n(l),u=r("dx_HbDg"),d=r("dx_THec"),f=function(){var e=Object(d.k)(),n=Object(l.useState)(!1),r=o()(n,2),f=r[0],h=r[1],p=Object(l.useCallback)((function(){u.S.collectCloseNotice(),u.S.disable()}),[]),v=Object(l.useCallback)((function(){u.S.collectCreateNewDoc(),h(!0),a.store.dispatch(Object(a.createBlankFile)({isCtrlOrMetaKeyClicked:!1,createType:a.NUM_SUITE_TYPE.DOCX,isFromTemplateCenter:!1,type:"CREATE"}))}),[]);return Object(l.useLayoutEffect)((function(){e&&u.S.collectNoticeVisible()}),[e]),e?s.a.createElement(i.ExclusiveNotice,{banner:!0,closable:!0,type:"warning",align:"center",level:200,action:s.a.createElement(c.Button,{type:"text",color:"primary",loading:f,style:{position:"static",margin:"-2px 0"},onClick:v},t("CreationDoc_DocX_Block_NewDoc")),message:t("CreationDoc_DocX_Block_NearLimit_Toast",void 0,void 0,"".concat(u.S.limitCount)),onClose:p}):null}}).call(this,r("dx_E9Eu"))},dx_L3LL:function(e,n,r){"use strict";r.d(n,"D",(function(){return p}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_h6a8"),s=r("dx_wmJb"),u=r("dx_b28D"),d=r("dx_z8d9"),f=r("dx_tylp"),h=Object(u.e)("catalogue:move"),p=function(){function e(n){i()(this,e),this.props=n,this.moving=new d.W,this.catalogTransition=void 0,this.oldWidth=0,this.debouncedExpandWidth=Object(l.debounce)(this.expandWidth.bind(this),500),this.debouncedUnlockWidth=Object(l.debounce)(this.unlockWidth.bind(this),1e3)}return a()(e,[{key:"handleExpandEnd",value:function(e){var n="".concat(e,".expandEnd");this.props.onExpandEnd(n),this.unlockWidthDebounced(n)}},{key:"lockWidth",value:function(e){if(this.props.canLockWidth()){var n=this.props.getEl();n&&(this.oldWidth=Object(s.d)(n),n.style.width="".concat(this.oldWidth,"px"),h("%s: lock width to %d",e,this.oldWidth))}}},{key:"unlockWidth",value:function(e){if(this.props.canUnlockWidth()&&this.oldWidth){var n=this.el;n&&(n.style.width="",n.style.transition="",h("%s: unlock width, oldWidth=%d",e,this.oldWidth)),this.oldWidth=0}}},{key:"start",value:function(e){var n=this;this.moving.start(d.D.EXPAND_WIDTH,e).then((function(e){return n.handleExpandEnd(e.caller)})).catch((function(n){return console.error("".concat(e,": fail to start expanding"),n)}))}},{key:"expandWidth",value:function(e){var n=this;if(this.props.canExpandWidth()){var r=this.el,o=this.oldWidth;if(!this.moving.isMoving&&o&&r){r.style.width="";var i=Object(s.d)(r);if(r.style.width="".concat(o,"px"),!(o>i))if(o!==i){var c="".concat(e,".expandWidth");this.start(c),h("%s: %d => %d",c,o,i),this.catalogTransition={animationEnabled:!0,beforeStart:function(){},onStart:function(){r.style.transition="width 0.5s",r.style.width="".concat(i,"px"),n.oldWidth=i},onEnd:function(){r.style.transition="",n.moving.stop("".concat(c,".transitionend"))}},Object(f.b)(r,this.catalogTransition)}else this.el&&!this.el.matches(":hover")&&this.props.onMouseLeaveCatalogue()}}}},{key:"unlockWidthImmediately",value:function(e){this.debouncedUnlockWidth.cancel(),this.unlockWidth(e)}},{key:"unlockWidthDebounced",value:function(e){this.props.canUnlockWidth()?this.debouncedUnlockWidth(e):this.debouncedUnlockWidth.cancel()}},{key:"expandWidthDebounced",value:function(e){if(this.props.canExpandWidth()){var n="".concat(e,".expandWidthDelayed");this.debouncedExpandWidth(n),this.unlockWidthDebounced(n)}else this.debouncedExpandWidth.cancel()}},{key:"el",get:function(){return this.props.getEl()}}]),e}()},dx_L41L:function(e,n,r){"use strict";var o=r("dx_J4zp"),i=r.n(o),c=r("dx_PcQO"),a=r("dx_TSYQ"),l=r.n(a),s=r("dx_h6a8"),u=r("dx_cDcd"),d=r.n(u),f=r("dx_w0wQ"),h=r("dx_yU7P"),p=(r("dx_P8LC"),/^[0-9]*(\.[0-9]?)?$/),v="okr-number-input";n.S=function(e){var n=e.disabled,r=e.editable,o=void 0===r||r,a=e.showBorder,g=e.showTooltip,b=void 0===g||g,y=e.minValue,m=void 0===y?-1/0:y,_=e.maxValue,k=void 0===_?1/0:_,O=e.prefix,x=e.value,E=void 0===x?0:x,S=e.inputWidth,C=void 0===S?42:S,I=e.suffix,B=e.hoverHint,T=e.rangeErrorHint,w=e.disabledHint,R=e.onChange,M=void 0===R?s.noop:R,j=e.onBlur,D=void 0===j?s.noop:j,A=e.onActive,P=void 0===A?s.noop:A,L=e.className,N=e.noDecimalNumber,F=void 0===N?100:N,U=e.autoFocus,H=void 0!==U&&U,V=e.onPreviewVisibleChange,W=e.getPopupContainer,z=Object(u.useState)(!1),G=i()(z,2),K=G[0],q=G[1],X=Object(u.useState)(Object(f.g)(E,F)),Y=i()(X,2),J=Y[0],Z=Y[1],Q=Object(u.useState)(H&&o&&!n),$=i()(Q,2),ee=$[0],te=$[1];Object(u.useEffect)((function(){var e=parseFloat(J);q(ee&&(m>e||k<e))}),[J,m,k,ee]);var ne=Object(h.r)((function(){ee||Z(Object(f.g)(E,F))}));Object(u.useEffect)((function(){ne()}),[E,ne]);var re=function(e){var n=e.target.value;if(!Number.isNaN(n)&&p.test(n)||""===n){Z(n);var r=parseFloat(""===n?"0":n);m<=r&&k>=r&&M(r)}},oe=function(){te(!1);var e=parseFloat(J),n=parseFloat(E);e=Number.isNaN(e)?n:e,e=Math.min(e,k),e=Math.max(e,m),Z(Object(f.g)(e,F)),M(e),D(e)};return d.a.createElement(c.Tooltip,{title:n?w:B,disabled:!b||ee||!o||K,hideAction:["mouseLeave","click"],getPopupContainer:W,onVisibleChange:V},d.a.createElement(c.Tooltip,{title:T,visible:!!T&&K,getPopupContainer:s.identity},d.a.createElement("div",{className:l()(v,L,{editable:o,editing:ee,disable:n,showBorder:a,hasError:K}),onClick:function(){o&&!n&&te(!0),P()}},O&&d.a.createElement("div",{className:"".concat(v,"__input-prefix")},O),ee?d.a.createElement("div",{className:"".concat(v,"__input")},d.a.createElement(c.Input,{type:"text",style:{width:C},value:J,onChange:re,onPressEnter:oe,onBlur:oe,autoFocus:!0}),I&&d.a.createElement("div",{className:"".concat(v,"__input-suffix")},I)):d.a.createElement(c.Tooltip,{title:B,disabled:!b||o,hideAction:["mouseLeave","click"],getPopupContainer:W,onVisibleChange:V},d.a.createElement("div",{className:"".concat(v,"__preview"),style:o?{width:C+(I?12:0)}:{}},J,I)))))}},dx_L6L1:function(e,n,r){"use strict";(function(t){r.d(n,"E",(function(){return a})),r.d(n,"L",(function(){return l})),r.d(n,"K",(function(){return s})),r.d(n,"X",(function(){return u}));var e=r("dx_UtDZ"),o=r("dx_yzqx"),i=r("dx_Fimk"),c=r("dx_Skfo");function a(e){Object(c.L)({guid:e,text:t("CreationDoc_ToDo_FollowedUCan")})}function l(n){(function(n){var r="".concat("TASK_BLOCK_CACHE_","_").concat(n,"_").concat(e.userHelper.getCurrentUser().get("id"));try{var o=parseInt(localStorage.getItem(r)||"")||0;if(o>=3)return!1;o++,localStorage.setItem(r,"".concat(o))}catch(i){}return!0})("create")&&(Object(i.N)("ccm_docs_toast_view",{sub_view:"success_create_task"}),Object(c.L)({guid:n,text:t("CreationDoc_ToDo_CreatedUCan"),onClick:function(){Object(i.N)("ccm_docs_toast_click",{click:"click_task_center",target:"none",sub_view:"success_create_task"})}}))}function s(){o.S.isMobile&&Object(c.L)({text:t("CreationDoc_Tasks_NoPermissionToEditTask_Toast")})}function u(){Object(c.L)({text:t("CreationDoc_Tasks_AssigneeLimitReached_Toast")})}}).call(this,r("dx_E9Eu"))},dx_L6LG:function(e,n,r){"use strict";r.d(n,"d",(function(){return o})),r.d(n,"F",(function(){return i})),r.d(n,"o",(function(){return c})),r.d(n,"f",(function(){return a})),r.d(n,"m",(function(){return l})),r.d(n,"T",(function(){return s})),r.d(n,"D",(function(){return u})),r.d(n,"n",(function(){return d})),r.d(n,"Q",(function(){return f}));var o="BLOCK_MODEL_CREATE",i="BLOCK_MODEL_UPDATE",c="BLOCK_MODEL_DESTROY",a="BLOCK_MODEL_STRUCT_UPDATE",l="BLOCK_MODEL_POSITION_UPDATE",s="BLOCK_VIEW_MOUNT",u="BLOCK_VIEW_UPDATE",d="BLOCK_VIEW_WILL_UNMOUNT",f="BLOCK_MANAGER_READY"},dx_L6LS:function(e,n,r){"use strict";r.d(n,"S",(function(){return u}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_D8nn"),s=r("dx_NMuw"),u=function(){function e(){i()(this,e)}return a()(e,[{key:"updateCatalogueItems",value:function(e){for(var n=[],r=0;r<e.length;r++){var o=e[r];n.push({recordId:o.recordId,level:o.level,sourceLevel:o.sourceLevel,text:o.text})}l.S.emit(s.v.CATALOGUE_UPDATE,n)}},{key:"updateActiveCatalogue",value:function(e){l.S.emit(s.v.CATALOGUE_ACTIVE_UPDATE,e)}},{key:"updateBoundaryIntersectionStatus",value:function(e){l.S.emit(s.v.CATALOGUE_BOUNDARY_INTERSECTION,e)}}]),e}()},dx_L6Lu:function(e,n,r){"use strict";r.d(n,"K",(function(){return s})),r.d(n,"C",(function(){return u})),r.d(n,"k",(function(){return d})),r.d(n,"V",(function(){return f})),r.d(n,"h",(function(){return h})),r.d(n,"t",(function(){return p})),r.d(n,"R",(function(){return v})),r.d(n,"F",(function(){return g})),r.d(n,"O",(function(){return b})),r.d(n,"M",(function(){return y}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_yzqx"),a=r("dx_B28d");function l(){return!c.S.firefox}function s(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e||l()?a.l:1}function u(e){return!(!e.closest(".".concat(a.Y1))&&!e.closest(".presentation-mode-mask .page-block-header"))}function d(e){for(var n=1,r=e;r&&"html"!==r.tagName.toLowerCase();){var o=window.getComputedStyle(r).zoom;n*=parseFloat(o)||1,r=r.parentElement}return n}function f(e){var n=e.getBoundingClientRect(),r=s();return u(e)?new DOMRect(r*n.x,r*n.y,r*n.width,r*n.height):n}function h(e){if(!e)return 0;var n=s(),r=e.clientHeight;return u(e)?r*n:r}function p(e){var n=s(),r=window.getComputedStyle(e),o=parseInt(r.marginTop,10)||0,i=parseInt(r.marginBottom,10)||0,c=parseFloat(r.height)||0,a=parseFloat(r.width)||0;return u(e)&&(o*=n,i*=n,a*=n,c*=n),{marginTop:o,marginBottom:i,width:a,height:c}}function v(e,n){var r=e.width,o=e.height,i=e.marginTop,c=e.marginBottom,a=e.visible,l=s();return u(n.wrapper)?{height:o/l,marginTop:i/l,marginBottom:c/l,width:r,visible:a}:e}function g(e,n){var r=e.height,o=e.marginBottom,i=e.marginTop,c=s();return u(n)?{height:r/c,marginBottom:o/c,marginTop:i/c}:e}function b(e){var n=e.getClientRects(),r=s();return u(e)?i()(n).map((function(e){return new DOMRect(r*e.x,r*e.y,r*e.width,r*e.height)})):i()(n)}function y(e){var n=e.recursionProps.isPresentationMode,r=e.model.type;if(n){var o=d(e.hostElementRef.current);if([a.B.SHEET,a.B.BITABLE].includes(r))return{hostElementZoom:o,scrollContainerZoom:1};if(r===a.B.TABLE)return{hostElementZoom:o,scrollContainerZoom:s()}}return{hostElementZoom:1,scrollContainerZoom:1}}},dx_L9Lc:function(e,n,r){"use strict";(function(t){r.d(n,"R",(function(){return G}));var e=r("dx_lSNA"),o=r.n(e),i=r("dx_lwsE"),c=r.n(i),a=r("dx_W8MJ"),l=r.n(a),s=r("dx_iWIM"),u=r.n(s),d=r("dx_W7W2"),f=r.n(d),h=r("dx_a1gu"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=r("dx_QxNg"),y=r("dx_Y7YZ"),m=r("dx_wOn8"),_=r("dx_TSYQ"),k=r.n(_),O=r("dx_UtDZ"),x=r("dx_h6a8"),E=r("dx_cDcd"),S=r.n(E),C=r("dx_h74D"),I=r("dx_USq6"),B=r("dx_LkLc"),T=r("dx_yzqx"),w=r("dx_SreQ"),R=r("dx_eSV8"),M=r("dx_aQ6g"),j=r("dx_KHvq"),D=r("dx_IdzY"),A=r("dx_pk3x"),P=r("dx_ZG9w"),L=r("dx_Ogyw"),N=r("dx_D8nn"),F=r("dx_sNGG"),U=r("dx_FwAy"),H=r("dx_c9zL");r("dx_KgoN");function V(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function W(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?V(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function z(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}var G=function(e){f()(r,e);var n=z(r);function r(){var e;c()(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(e=n.call.apply(n,[this].concat(i))).isSelecting=!1,e._placeHolder=void 0,e.contentRef=S.a.createRef(),e.pageBlockContentRef=S.a.createRef(),e.focusElementRef=S.a.createRef(),e.state={remoteWidthMode:void 0,isShowTitle:!0},e.handleSelectingTapMove=function(){var n;!e.isSelecting&&e.checkIsMove()&&(e.isSelecting=!0,null===(n=e.contentRef.current)||void 0===n||n.classList.add("isSelecting"))},e.handleSelectingTapStop=function(){var n;e.isSelecting&&(e.isSelecting=!1,null===(n=e.contentRef.current)||void 0===n||n.classList.remove("isSelecting"))},e.updateDocTitle=Object(x.debounce)((function(){var n=O.actions.suite.updateDocTitle;O.store.dispatch(n({token:e.record.id,type:Object(O.suiteTypeNum)(),title:Object(P.T)(e.model.zoneState)}))}),200),e.handlePageBlur=function(){var n,r;Object(w.P)()&&T.S.isInVC&&!T.S.isMobile&&("true"===(null===(n=e.focusElement)||void 0===n?void 0:n.contentEditable)&&document.activeElement===e.focusElement&&(null===(r=e.focusElement)||void 0===r||r.blur()))},e.handleError=function(n){var r=n.e,o=n.message,i=n.level;console.error("editor:",i,o,r),i===m.F.FATAL&&e.blockManager.emit(b.Ra.ERROR,{msg:o,code:b.e.COLLECT_FAILED,type:"textInput"}),Object(R.n)(r)},e}return l()(r,[{key:"blockViewDidMount",value:function(){var e;u()(g()(r.prototype),"blockViewDidMount",this).call(this);var n=this.props.pageBlockMounted;null===n||void 0===n||n(),N.S.on(N.p.COMMON.SELECTING_TAP_MOVE,this.handleSelectingTapMove),N.S.on(N.p.COMMON.SELECTING_TAP_STOP,this.handleSelectingTapStop),null===(e=this.focusElement)||void 0===e||e.addEventListener("blur",this.handlePageBlur);var o=!!this.props.editorAPI.config.get("isMain"),i=T.S.isMobile?document.scrollingElement:this.props.editorAPI.config.get("scroller");o&&i&&Object(H.x)(i,H.Q)}},{key:"blockViewDidUpdate",value:function(e,n){if(u()(g()(r.prototype),"blockViewDidUpdate",this).call(this,e,n),this.state.isShowTitle!==n.isShowTitle&&this.eventEmitter.emit(F.Y.THIRD_PARTY_CONTENT_CHANGE),this.isRoot&&(this.updateDocTitle(),this.translated&&O.EventEmitter.emit("UPDATE_TRANS_TITLE",[this.model.getText()]),this.maybeHeaderHeightChange(e)&&this.blockManager.layoutManager.notifyHeaderHeightChange()),!e.editable&&this.props.editable&&this.focusTitleIfDocIsEmpty(),"function"===typeof this.props.updatePageExistState){var o=this.props.record.snapshot.delete;!0===o?this.props.updatePageExistState(!1):!1===o&&this.props.updatePageExistState(!0)}}},{key:"blockViewWillUnmount",value:function(){var e;u()(g()(r.prototype),"blockViewWillUnmount",this).call(this),N.S.off(N.p.COMMON.SELECTING_TAP_MOVE,this.handleSelectingTapMove),N.S.off(N.p.COMMON.SELECTING_TAP_STOP,this.handleSelectingTapStop),null===(e=this.focusElement)||void 0===e||e.removeEventListener("blur",this.handlePageBlur)}},{key:"focusTitleIfDocIsEmpty",value:function(){if(!T.S.isInVC&&!T.S.isMobile&&Object(w.P)()&&Object(U.S)(this.blockManager)){var e=document.querySelector(".page-block");e&&e.focus()}}},{key:"checkIsMove",value:function(){var e=this.selectionAPI.getSelectionContext(),n=e.beginX,r=e.beginY,o=e.endX,i=e.endY,c=Math.abs(n-o),a=Math.abs(r-i);return c>10||a>10}},{key:"maybeHeaderHeightChange",value:function(e){return!Object(x.isEqual)(this.snapshot.text,e.record.snapshot.text)}},{key:"getDefaultEditorPluginOptions",value:function(){return A.z}},{key:"setBlockFocus",value:function(e){this.isRoot||u()(g()(r.prototype),"setBlockFocus",this).call(this,e)}},{key:"getRootContentEditable",value:function(){var e;return null!==(e=this.props.editable&&!T.S.isIOS)&&void 0!==e&&e}},{key:"render",value:function(){var e=this.props.recursionProps,n=e.isSSR,i=e.isPreview,c=e.hasCover,a=e.isPresentationMode,l=this.state.isShowTitle;return S.a.createElement("div",Object.assign({className:"page-block root-block","data-slate-editor":"true",ref:this.focusElementRef},Object(w.P)()?o()({contentEditable:this.getRootContentEditable(),spellCheck:"false"},"data-content-editable-root","true"):{}),!n&&S.a.createElement(B.S,{editable:this.editable,blockManager:this.blockManager,pageToken:this.record.id,snapshot:this.model.snapshot}),S.a.createElement(y.l,{editable:this.editable,copyable:this.props.recursionProps.copyable,businessKey:"docx",contentState:this.contentState,debounceFlush:0,modules:D.xj,listenEvents:A.DU,editor:this.editor,onError:this.handleError},l&&S.a.createElement("div",{className:M.i},!i&&!a&&S.a.createElement(I.S,{isSSR:n,hasCover:c,SelectionAPI:this.selectionAPI}),S.a.createElement("div",{className:k()("page-block-content",this.snapshot.align,L.B),ref:this.pageBlockContentRef},u()(g()(r.prototype),"render",this).call(this))),S.a.createElement("div",{className:"page-block-children",ref:this.contentRef},this.editorAPI.viewService.renderChildren(this.id,{recursionProps:W(W({},this.props.recursionProps),{},{level:1})}))))}},{key:"placeholder",get:function(){return this._placeHolder||t("doc.title_placeholder_default")},set:function(e){this._placeHolder=e}},{key:"focusElement",get:function(){return this.focusElementRef.current}},{key:"isTextEditable",get:function(){return this.editable}},{key:"contentElement",get:function(){return this.contentRef.current}},{key:"blockContentElement",get:function(){return this.pageBlockContentRef.current||void 0}},{key:"isWithBoundary",get:function(){return!0}}],[{key:"selectionTargetFilter",value:function(e){return!(e.closest&&e.closest(".page-block .cover")&&!e.classList.contains("empty"))}},{key:"getDerivedStateFromProps",value:function(e){var n=e.recursionProps,r=e.opendocContentConfig,o=n.isShortcut,i=n.isPDF,c=!(r&&!r.titleVisible);return{isShowTitle:(!o||i)&&c}}}]),r}(j.N);n.S=Object(C.connect)((function(e){return{opendocContentConfig:O.selectors.openDoc.getFeatureConfigSelector(O.FEATURE.CONTENT)(e)}}))(G)}).call(this,r("dx_E9Eu"))},dx_LA8U:function(e,n,r){"use strict";r.d(n,"p",(function(){return a})),r.d(n,"h",(function(){return l})),r.d(n,"e",(function(){return s})),r.d(n,"l",(function(){return u})),r.d(n,"O",(function(){return d})),r.d(n,"z",(function(){return h})),r.d(n,"g",(function(){return g}));r("dx_eSV8");var o=r("dx_B28d");function i(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return c(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,l=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return l=e.done,e},e:function(e){s=!0,a=e},f:function(){try{l||null==r.return||r.return()}finally{if(s)throw a}}}}function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function a(e){return e.allBlockViews.length}function l(e){var n,r=[],c=i(e.allBlockModels);try{for(c.s();!(n=c.n()).done;){var a=n.value;a.type===o.B.PENDING&&!0!==a.record.snapshot.allowFail&&r.push(a)}}catch(l){c.e(l)}finally{c.f()}return r}function s(e){var n,r={},o=i(e.allBlockViews);try{for(o.s();!(n=o.n()).done;){var c=n.value,a="".concat(c.type,"_block_count");r[a]=(Number(r[a])||0)+1}}catch(l){o.e(l)}finally{o.f()}return r}function u(e){return e.includes("heading")}function d(e){return o.D4.includes(e)}var f=new Set([o.B.TABLE]);function h(e){return f.has(e)}var p,v=["block_map","external_mention_url","mention_page_title","meta_map","user_map"];function g(e){var n=function(e,n){for(var r=e.length-1,o=Object.assign({},e[r--]),i=function(){var i=e[r--];n.forEach((function(e){var n=i[e];if(null!=n){o[e]=Object.assign({},o[e]||n);var r=o[e];Object.keys(n).forEach((function(e){if(!r[e]){var o=n[e];r[e]=o}}))}}))};r>-1;)i();return o}(e,v);return n.next_cursors=[],n.skip_blocks=[],n}!function(e){e.CONCURRENT_FALSE="CONCURRENT_FALSE",e.HAS_MORE_TRUE="HAS_MORE_TRUE",e.NEXT_CURSORS_COUNT_ERROR="NEXT_CURSORS_COUNT_ERROR",e.BLOCK_MAP_LACK="BLOCK_MAP_LACK"}(p||(p={}))},dx_LBAU:function(e,n,r){"use strict";(function(t){r.d(n,"Y",(function(){return y}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_Y0Yg"),c=r("dx_LWrV"),a=r("dx_PcQO"),l=r("dx_TSYQ"),s=r.n(l),u=r("dx_cDcd"),d=r.n(u),f=r("dx_yzqx"),h=r("dx_xPLQ"),p=r("dx_Cg1F"),v=r("dx_N4Vo"),g=r("dx_E7E0"),b=function(e){return"task-block__assignee-picker__".concat(e)};function y(e){var n=e.assignee,r=e.record,l=e.type,y=e.blockManager,m=e.disabled,_=e.toggleAssigneeCompleted,k=e.deletedAssignee,O=Object(u.useState)(!1),x=o()(O,2),E=x[0],S=x[1],C=Boolean(n.completed_milli_time),I=b("list"),B=Object(u.useCallback)((function(e){e.stopPropagation(),e.preventDefault(),S(!E),E||setTimeout((function(){var e,n=null===(e=document.querySelectorAll(".".concat(I," .ud__menu-normal-item")))||void 0===e?void 0:e[0];null===n||void 0===n||n.focus({preventScroll:!0})}))}),[E,I]),T=Object(u.useCallback)((function(){return document.querySelector("#docx-popup-container")||document.body}),[]);return d.a.createElement("span",{className:s()(b("user"),h.C)},d.a.createElement(g.i,{uid:n.assignee_id,record:r,type:l,showAvatar:!0,trigger:"click",hideAction:["click","mouseLeave"],blockManager:y,renderExternal:function(){return f.S.isMobile||m?null:d.a.createElement(a.Dropdown,{visible:E,openClassName:b("more-opened"),trigger:[],hideAction:["click"],placement:"bottomRight",overlayClassName:s()(I,"task-block-dropdown-keydown-menu"),destroyOnHide:!0,onVisibleChange:S,getPopupContainer:T,overlay:d.a.createElement(a.Menu,null,d.a.createElement(a.Menu.Item,{key:"complete",onClick:function(e){e.domEvent.preventDefault(),e.domEvent.stopPropagation(),_(n),S(!1)}},t(C?"CreationDoc_Tasks_CollabTask_MarkAsNotComplete":"CreationDoc_Tasks_MarkAsComplete_Button")),d.a.createElement(a.Menu.Item,{key:"remove",onClick:function(e){e.domEvent.preventDefault(),e.domEvent.stopPropagation(),k(n),S(!1)}},t("CreationDoc_Tasks_RemoveAssignee_Button")))},d.a.createElement(v.a,{tooltipProps:{title:t("CreationDoc_Tasks_IconHintMoreActions")},className:s()(b("remove-wrapper"),E&&"visible"),size:"small",icon:d.a.createElement(i.S,{onClick:B,className:b("more-icon")}),onClick:B,type:"icon"}))}}),Object(p.x)(n)&&d.a.createElement("span",{className:b("yes-filled-wrapper")},d.a.createElement(c.S,{className:b("yes-filled")})))}}).call(this,r("dx_E9Eu"))},dx_LCSr:function(e,n,r){"use strict";function o(e){var n=e.nodes,r=e.theme,o=e.structure,i=e.globalLineStyle,c={};if(1===n.length){var a=n[0],l="";if(Array.isArray(a.text))l=a.text.map((function(t){return t.text})).join("");else l=a.text;c.title=l,c.content={nodes:a.children}}else c.title="",c.content={nodes:n};return r&&(c.content.theme=r),o&&(c.content.structure=o),i&&(c.content.globalLineStyle=i),c}r.d(n,"O",(function(){return o}))},dx_LCTY:function(e,n,r){},dx_LMYO:function(e,n,r){"use strict";(function(t){r.d(n,"I",(function(){return g}));var e,o=r("dx_lSNA"),i=r.n(o),c=r("dx_Icqc"),a=r("dx_FBWK");function l(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?l(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}!function(e){e.BACK="doc_embedded_mindnote_exit",e.RECOVER="smartable_fullscreen_more",e.EXIT="exit",e.BACK_EXTRA_ID="docx_embedded_history_exit",e.DOCX_RESTORE_HISTORY="DOCX_RESTORE_HISTORY"}(e||(e={}));var u={back:null,recover:null};var d={titleConfig:{title:" ",position:"center",isLoading:!1},items:{left:[{id:e.BACK,enable:!0,extraId:e.BACK_EXTRA_ID}]},themeColor:Object(a.getThemeColorByToken)("bg-body"),shouldShowDivider:!1,callback:function(n){var r,o,i=n.id;i!==e.BACK&&i!==e.BACK_EXTRA_ID&&i!==e.EXIT?i!==e.RECOVER&&i!==e.DOCX_RESTORE_HISTORY||null===(r=u.recover)||void 0===r||r.call(u):null===(o=u.back)||void 0===o||o.call(u)}},f=s(s({},d),{},{titleConfig:{title:t("nav.tips.history_record"),position:"center",isLoading:!1}}),h=s({},f),p=!1;function v(e){e?(h=e,window.lark.biz.navigation.setCustomHeader(h)):(h=s({},p?d:f),window.lark.biz.navigation.setCustomHeader())}function g(){v()}Object(c.onUIStateChange)((function(){var e=Object(a.getThemeColorByToken)("bg-body");d.themeColor=e,f.themeColor=e,h.themeColor=e}))}).call(this,r("dx_E9Eu"))},dx_LNON:function(e,n,r){"use strict";r.d(n,"m",(function(){return a}));var o=r("dx_cDcd"),i=r.n(o),c=/<(\w+)\s*>(.*)<\/\1\s*>|<(\w+)\s* \/>|{{\s*(\w+)\s*}}/g;function a(e){var n=e.content,r=e.placeholders,o=void 0===r?{}:r,a=function(e){c.lastIndex=0;for(var n,r={elements:[],tagInfos:{}},o=0,i=0;n=c.exec(e);){(o=n.index)>i&&r.elements.push(e.slice(i,o));var a=n[1]||n[3]||n[4],l=n[2]||n[4]||"";r.elements.push(l),r.tagInfos[a]=r.elements.length-1,i=c.lastIndex}return i<e.length&&r.elements.push(e.slice(i)),r}(n),l=a.elements,s=a.tagInfos;return Object.keys(o).forEach((function(e){var n=s[e];if("number"===typeof n){var r=l[n];l[n]=o[e](r)}})),i.a.createElement(i.a.Fragment,null,l)}},dx_LS0b:function(e,n,r){"use strict";r.d(n,"S",(function(){return g}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Y27Y");function v(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var g=function(e){s()(r,e);var n=v(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).format=p.L.URI_LIST,e}return a()(r,[{key:"shouldCopy",value:function(){return!1}}]),r}(r("dx_ZTLK").S)},dx_LSI4:function(e,n,r){"use strict";r.d(n,"h",(function(){return a})),r.d(n,"y",(function(){return l}));var o=r("dx_fEKD"),i=r("dx_B28d"),c=r("dx_Mtob");function a(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.B.IMAGE;return Object(o.b)(e,n)}function l(e){var n=new URL(e);return n.host===c.R&&n.search.includes(c.u)}},dx_LSUT:function(e,n,r){"use strict";var o=r("dx_MIzm");r.d(n,"A",(function(){return o.A}))},dx_LSXc:function(e,n,r){"use strict";r.d(n,"U",(function(){return l})),r.d(n,"Z",(function(){return s}));var o,i=r("dx_FBWK"),c=r("dx_Zss7"),a=r.n(c);!function(e){e[e.BACKGROUND_ALPHA=.12]="BACKGROUND_ALPHA",e[e.COVER_ALPHA=.3]="COVER_ALPHA"}(o||(o={}));var l=[{labelColor:Object(i.getThemeColorByToken)("P400-FG"),textColor:Object(i.getThemeColorByToken)("P500-FG")},{labelColor:Object(i.getThemeColorByToken)("C500-FG"),textColor:Object(i.getThemeColorByToken)("C600-FG")},{labelColor:Object(i.getThemeColorByToken)("O600-FG"),textColor:Object(i.getThemeColorByToken)("O700-FG")},{labelColor:Object(i.getThemeColorByToken)("L600-FG"),textColor:Object(i.getThemeColorByToken)("L700-FG")},{labelColor:Object(i.getThemeColorByToken)("T600-FG"),textColor:Object(i.getThemeColorByToken)("T700-FG")},{labelColor:Object(i.getThemeColorByToken)("B400-FG"),textColor:Object(i.getThemeColorByToken)("text-link-hover")},{labelColor:Object(i.getThemeColorByToken)("V400-FG"),textColor:Object(i.getThemeColorByToken)("V500-FG")},{labelColor:Object(i.getThemeColorByToken)("R500-FG"),textColor:Object(i.getThemeColorByToken)("R600-FG")},{labelColor:Object(i.getThemeColorByToken)("Y600-FG"),textColor:Object(i.getThemeColorByToken)("Y700-FG")},{labelColor:Object(i.getThemeColorByToken)("G600-FG"),textColor:Object(i.getThemeColorByToken)("G700-FG")},{labelColor:Object(i.getThemeColorByToken)("W600-FG"),textColor:Object(i.getThemeColorByToken)("W700-FG")},{labelColor:Object(i.getThemeColorByToken)("I400-FG"),textColor:Object(i.getThemeColorByToken)("I500-FG")},{labelColor:Object(i.getThemeColorByToken)("V500-FG"),textColor:Object(i.getThemeColorByToken)("V600-FG")},{labelColor:Object(i.getThemeColorByToken)("R600-FG"),textColor:Object(i.getThemeColorByToken)("R700-FG")},{labelColor:Object(i.getThemeColorByToken)("Y700-FG"),textColor:Object(i.getThemeColorByToken)("Y800-FG")},{labelColor:Object(i.getThemeColorByToken)("G700-FG"),textColor:Object(i.getThemeColorByToken)("G800-FG")},{labelColor:Object(i.getThemeColorByToken)("W700-FG"),textColor:Object(i.getThemeColorByToken)("W800-FG")},{labelColor:Object(i.getThemeColorByToken)("I500-FG"),textColor:Object(i.getThemeColorByToken)("I600-FG")},{labelColor:Object(i.getThemeColorByToken)("C600-FG"),textColor:Object(i.getThemeColorByToken)("C700-FG")},{labelColor:Object(i.getThemeColorByToken)("O700-FG"),textColor:Object(i.getThemeColorByToken)("O800-FG")},{labelColor:Object(i.getThemeColorByToken)("L700-FG"),textColor:Object(i.getThemeColorByToken)("L800-FG")},{labelColor:Object(i.getThemeColorByToken)("T700-FG"),textColor:Object(i.getThemeColorByToken)("T800-FG")},{labelColor:Object(i.getThemeColorByToken)("text-link-hover"),textColor:Object(i.getThemeColorByToken)("text-link-normal")},{labelColor:Object(i.getThemeColorByToken)("P500-FG"),textColor:Object(i.getThemeColorByToken)("P600-FG")},{labelColor:Object(i.getThemeColorByToken)("C700-FG"),textColor:Object(i.getThemeColorByToken)("C800-FG")},{labelColor:Object(i.getThemeColorByToken)("text-link-normal"),textColor:Object(i.getThemeColorByToken)("text-link-pressed")},{labelColor:Object(i.getThemeColorByToken)("P600-FG"),textColor:Object(i.getThemeColorByToken)("P700-FG")},{labelColor:Object(i.getThemeColorByToken)("R700-FG"),textColor:Object(i.getThemeColorByToken)("R800-FG")},{labelColor:Object(i.getThemeColorByToken)("I600-FG"),textColor:Object(i.getThemeColorByToken)("I700-FG")},{labelColor:Object(i.getThemeColorByToken)("V600-FG"),textColor:Object(i.getThemeColorByToken)("V700-FG")}].map((function(e){return u(e)})),s=u({labelColor:Object(i.getThemeColorByToken)("text-caption"),textColor:Object(i.getThemeColorByToken)("N700-FG")});function u(e){var n=a()(e.labelColor).setAlpha(o.BACKGROUND_ALPHA).toRgbString(),r=a()(e.labelColor).setAlpha(o.COVER_ALPHA).toRgbString();return e.backgroundColor=n,e.coverColor=r,e}},dx_LSbp:function(e,n,r){"use strict";r.d(n,"a",(function(){return F}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_B28d"),g=r("dx_L0LN"),b=r("dx_N9dL"),y=r("dx_S1lH");function m(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var _=function(e){s()(r,e);var n=m(r);function r(e){return i()(this,r),n.call(this,e)}return r}(r("dx_KHvq").H);_.type=v.B.BULLET;var k,O=r("dx_xjz2"),x=r("dx_tt0H"),E=r("dx_JXmB"),S=Object(O.s)(x.U)(k=function e(){i()(this,e),this.blockType=v.B.BULLET,this.checkFunc=E.M})||k,C=r("dx_iWIM"),I=r.n(C),B=r("dx_TSYQ"),T=r.n(B),w=r("dx_cDcd"),R=r.n(w),M=r("dx_rQGm"),j=r("dx_vOIB"),D=r("dx_B8Bh");function A(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var P,L=function(e){s()(r,e);var n=A(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"render",value:function(){var e=(Object(j.q)(this.model)+3)%3,n=T()("bullet",{bulletUnedit:!this.editable});return R.a.createElement("div",{className:"list-wrapper bullet-list"},R.a.createElement("div",{className:T()(["list","list-style-group-".concat(e),"list-align-".concat(this.model.snapshot.align)]),ref:this.contentRef,onClick:this.handleClickOuterEditor},R.a.createElement("div",{contentEditable:!1,className:n,onClick:this.handleClickListStyle.bind(this)},R.a.createElement("div",{className:"bullet-dot-before"})),R.a.createElement("div",{className:"list-content"},I()(h()(r.prototype),"render",this).call(this))),this.model.children.length>0?R.a.createElement("div",{style:{paddingLeft:M.X-D.s-D.t,marginLeft:D.s},className:"list-children"},this.renderChildren()):null)}}]),r}(r("dx_EdHe").S);function N(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var F=Object(p.H)({providers:[S,{provide:b.RecordSnapshotCreator,useValue:{type:v.B.BULLET,create:y.N}}]})(P=function(e){s()(r,e);var n=N(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"blocks",get:function(){return[[_,{viewCreator:L,options:this.options.getTextEditorOptions()}]]}}]),r}(g.h))||P},dx_LTna:function(e,n,r){"use strict";r.d(n,"e",(function(){return c}));var o=r("dx_cDcd"),i=r("dx_AaSx"),c=function(e){var n=e.equationViewInstance;return{addSpanClass:Object(o.useCallback)((function(){var e,r,o=null===(e=n.current)||void 0===e||null===(r=e.getViewElement())||void 0===r?void 0:r.querySelectorAll("span");null===o||void 0===o||o.forEach((function(e){e.classList.add(i.M)}))}),[])}}},dx_LZf0:function(e,n,r){"use strict";r.d(n,"S",(function(){return u}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c),l=r("dx_zJC7"),s=r("dx_yz7B");r("dx_SvJl");function u(e){var n=Object(c.useState)(!1),r=i()(n,2),o=r[0],u=r[1],d=e.blockManager,f=e.headingModule,h=e.blockId,p=e.recordId,v=e.order,g=e.updateVisible;return o?a.a.createElement(l.S,{blockManager:d,headingModule:f,blockId:h,recordId:p,order:v,updateVisible:g}):a.a.createElement(s.S,{blockManager:d,headingModule:f,blockId:h,recordId:p,order:v,updateCanShowInput:u,updateVisible:g})}},dx_LbJg:function(e,n,r){"use strict";var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_O4O8"),h=r.n(f),p=r("dx_MmkF"),v=r("dx_oKt1"),g=r("dx_TTrq"),b=Object(p.f)("TokenManager"),y=function(){function e(){var n=this;s()(this,e),this.mapping={realToFake:{},fakeToReal:{}},this.eventBus=new h.a,this.getEventName=function(e){return"listener_".concat(e)},this.initMapping=a()(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b("initMapping start"),e.next=3,n.updateMappingFromDB();case 3:b("initMapping end");case 4:case"end":return e.stop()}}),e)}))),this.getRealTokenFromMemory=function(e){return(null===v.q||void 0===v.q?void 0:Object(v.q)(e))?n.mapping.fakeToReal[e]:e},this.getFakeTokenFromMemory=function(e){return(null===v.q||void 0===v.q?void 0:Object(v.q)(e))?e:n.mapping.realToFake[e]},this.getRealToken=function(){var e=a()(i.a.mark((function e(r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===v.q||void 0===v.q?void 0:Object(v.q)(r)){e.next=2;break}return e.abrupt("return",r);case 2:if(n.mapping.fakeToReal[r]){e.next=5;break}return e.next=5,n.updateMappingFromDB();case 5:return e.abrupt("return",n.mapping.fakeToReal[r]);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),this.getFakeToken=function(){var e=a()(i.a.mark((function e(r){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===v.q||void 0===v.q?void 0:Object(v.q)(r))){e.next=2;break}return e.abrupt("return",r);case 2:if(n.mapping.realToFake[r]){e.next=5;break}return e.next=5,n.updateMappingFromDB();case 5:return e.abrupt("return",n.mapping.realToFake[r]);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),this.refresh=function(){var e=a()(i.a.mark((function e(r,o){var c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.mapping.fakeToReal[r]=o,n.mapping.realToFake[o]=r,e.next=4,n.updateMappingFromDB();case 4:return e.next=6,n.getRealToken(r);case 6:if(c=e.sent){e.next=10;break}return b("can not get data after refresh"),e.abrupt("return");case 10:o&&o!==c&&b("the token from rn is different from the target token"),n.eventBus.emit(n.getEventName(r),c);case 12:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),this.addListener=function(e,r){Object(v.q)(e)&&n.eventBus.on(n.getEventName(e),r)},this.removeListener=function(e,r){Object(v.q)(e)&&n.eventBus.off(n.getEventName(e),r)}}return d()(e,[{key:"updateMappingFromDB",value:function(){var e=a()(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.u)();case 2:(n=e.sent)&&(this.mapping.fakeToReal=Object.assign(this.mapping.fakeToReal,n.fakeToReal),this.mapping.realToFake=Object.assign(this.mapping.realToFake,n.realToFake));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){b("tokenManager destroy"),this.mapping.fakeToReal={},this.mapping.realToFake={}}}]),e}();n.S=new y},dx_LcKp:function(e,n,r){"use strict";(function(t){r.d(n,"v",(function(){return pe}));var e,o,i,c,a,l=r("dx_o0o1"),s=r.n(l),u=r("dx_yXPU"),d=r.n(u),f=r("dx_lSNA"),h=r.n(f),p=r("dx_yG8O"),v=r.n(p),g=r("dx_RIqP"),b=r.n(g),y=r("dx_lwsE"),m=r.n(y),_=r("dx_PJYZ"),k=r.n(_),O=r("dx_iWIM"),x=r.n(O),E=r("dx_W8MJ"),S=r.n(E),C=r("dx_W7W2"),I=r.n(C),B=r("dx_a1gu"),T=r.n(B),w=r("dx_Nsbk"),R=r.n(w),M=r("dx_Uyc2"),j=r.n(M),D=(r("dx_A1AB"),r("dx_Vvd7")),A=r("dx_QxNg"),P=r("dx_M30o"),L=r("dx_BuQo"),N=r("dx_vdIl"),F=r("dx_UtDZ"),U=r("dx_h6a8"),H=r("dx_PQBD"),V=r("dx_zUqt"),W=r("dx_B28d"),z=r("dx_NMQJ"),G=r("dx_bPy9"),K=r("dx_x1WV"),q=r("dx_hSCS"),X=r("dx_bkVC"),Y=r("dx_sNGG"),J=r("dx_bEBp"),Z=r("dx_lROi"),Q=r("dx_UTG8"),$=r("dx_olwK"),ee=r("dx_cGa6"),te=r("dx_G3VO"),ne=r("dx_Orag"),re=r("dx_b1bI"),oe=r("dx_cJcU"),ie=r("dx_HlLk"),ce=r("dx_VQSE"),ae=r("dx_Cg1F"),le=r("dx_Cu6Q"),se=r("dx_fLyj"),ue=r("dx_CMSf");function de(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function fe(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?de(Object(r),!0).forEach((function(n){h()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):de(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function he(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=R()(e);if(n){var i=R()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return T()(this,r)}}var pe=(a=c=function(e){I()(r,e);var n=he(r);function r(e){var c;return m()(this,r),(c=n.call(this,e)).contentState=void 0,c.taskModel=void 0,c.matches=null,c.findKeyword=void 0,c.shouldRestore=!1,v()(c,"eventEmitter",o,k()(c)),v()(c,"blockManager",i,k()(c)),c.handleRecordChange=function(){var e=Object(re.c)(c.docToken,c.blockManager).getModel({guid:c.taskId,recordId:c.recordId});c.setTaskModel(e)},c.setTaskModel=function(e){e!==c.taskModel&&(c.taskModel.detach(k()(c)),c.taskModel=e,c.handleTaskModelChange(),c.taskModel.attach(k()(c)))},c.handleTaskModelChange=function(){var e=Object(ie.l)(c.contentState.toDeltaSet().get(N.x));if(!Object(ce.V)(e,c.taskData.rich_summary)){var n=Object(oe.Z)({richContent:c.taskData.rich_summary});c.contentState.setContent(n,{extra:{isNotUpdateModel:!0},nonundoable:!0})}c.applyLineThroughMark(Object(ae.G)(c.taskData)),c.forceUpdate()},c.handleEditorChange=function(e){var n,r,o,i,a=null===(n=e.options)||void 0===n||null===(r=n.extra)||void 0===r?void 0:r.isNotUpdateModel;if(!(null===(o=e.options)||void 0===o||null===(i=o.extra)||void 0===i?void 0:i.fromLineThrough)&&(c.applyLineThroughMark(Object(ae.G)(c.taskData)),c.matches=null,c.eventEmitter.emit(Y.Y.THIRD_PARTY_CONTENT_CHANGE),!a)){var l=Object(ie.l)(c.contentState.toDeltaSet().get(N.x));c.taskModel.apply({rich_summary:l})}},c}return S()(r,[{key:"docToken",get:function(){return this.modelService.rootRecordId}},{key:"taskData",get:function(){return this.taskModel.getData()}},{key:"currentUserId",get:function(){return F.userHelper.getCurrentUser().get("id")}},{key:"taskId",get:function(){return this.record.snapshot.task_id}},{key:"creatorId",get:function(){return this.taskData.creator_id}},{key:"taskDocxEditable",get:function(){return this.taskData.docx_editable}},{key:"assigneeIds",get:function(){return this.taskData.assignees_detail.map((function(e){return e.assignee_id}))}},{key:"followerIds",get:function(){return this.taskData.followers_detail.map((function(e){return e.follower_id}))}},{key:"isTaskEditable",get:function(){return!this.taskId||[this.creatorId].concat(b()(this.assigneeIds)).includes(this.currentUserId)||this.editorAPI.getService(D.j).get("editPermission")&&this.taskDocxEditable}},{key:"isTaskMember",get:function(){return[this.creatorId].concat(b()(this.assigneeIds),b()(this.followerIds)).includes(this.currentUserId)}},{key:"isFollowed",get:function(){return this.followerIds.includes(this.currentUserId)}},{key:"isReference",get:function(){var e;return Object(ee.O)()&&(null===(e=this.taskData.source)||void 0===e?void 0:e.block_id)!==this.record.id}},{key:"isDeleted",get:function(){return this.taskData.is_deleted}}]),S()(r,[{key:"onInit",value:function(e){this.taskModel=Object(re.c)(this.docToken,this.editorAPI.getService(K.a)).getModel({guid:this.taskId,recordId:this.recordId}),this.contentState=new L.O({deltaSet:Object(G.w)(Q.InputPipe.createEmptyClientVars()),modulesContainer:$.g,schema:ue.p}),this.handleTaskModelChange(),this.taskModel.attach(this),this.record.on(A.Ra.CHANGE,this.handleRecordChange),x()(R()(r.prototype),"onInit",this).call(this,e)}},{key:"toPlainText",value:function(){var e="";return this.contentState.getActiveZone().getContent().forEach((function(n){Object(P.X)(n)&&Object(le.P)(n)?e+=Object(le.G)(n):e+=n.insert})),e}},{key:"getText",value:function(){return this.isDeleted?t("CreationDoc_Tasks_Tasks_MenuOption"):this.toPlainText()||t("CreationDoc_Tasks_Tasks_MenuOption")}},{key:"applyLineThroughMark",value:function(e){var n=this.contentState.getActiveZone(),r={line:0,offset:0,zoneId:n.getZoneId()},o=fe(fe({},n.offsetToPoint(n.totalWidth())),{},{zoneId:n.getZoneId()});e?this.contentState.setAttributes({start:r,end:o},h()({},ne.z,"true"),{extra:{fromLineThrough:!0},nonundoable:!0}):this.contentState.setAttributes({start:r,end:o},h()({},ne.z,""),{extra:{fromLineThrough:!0},nonundoable:!0})}},{key:"replaceText",value:function(){var e=d()(s.a.mark((function e(n,r){var o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.matches=null,o=this.contentState.getActiveZone().replace(n,(null===r||void 0===r?void 0:r.text)||"",(null===r||void 0===r?void 0:r.mark)||{}),this.contentState.setContent(o.getContent());case 3:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"replaceAll",value:function(e,n){var r=this,o=n.map((function(n){var o=n.range;o[1]-o[0]<=0&&console.error("[Replace] illegal range: ".concat(o));var i=Object(te.J)(r.contentState,[o[0],o[0]+1]),c=r.contentState.getAttributes(i.start,i.end).toMap();return{range:o,toBeReplaced:{text:e,mark:c}}})),i=this.contentState.getActiveZone().multiReplace(o);return this.contentState.setContent(i.getContent()),Promise.resolve()}},{key:"find",value:function(e){var n=this;if(!this.matches||this.findKeyword!==e){var r=[],o="",i=0;this.contentState.getActiveZone().getContent().forEach((function(c){if(Object(P.X)(c)&&Object(le.P)(c)){r.push.apply(r,b()(n.generateTextBlockMatches(o,e,i))),i+=o.length,o="";var a=Object(le.G)(c);return r.push.apply(r,b()(n.generateTextBlockEmbedMatches(a,e,i))),void i++}o+=c.insert})),o&&r.push.apply(r,b()(this.generateTextBlockMatches(o,e,i))),this.matches=r,this.findKeyword=e}return b()(this.matches)}},{key:"generateTextBlockMatches",value:function(e,n,r){var o={blockManager:this.blockManager,blockId:this.id,key:n};return Object(Z.A)(e,n).map((function(e){return new J.I(fe(fe({},o),{},{range:[e.start+r,e.end+r]}))}))}},{key:"generateTextBlockEmbedMatches",value:function(e,n,r){var o={blockManager:this.blockManager,blockId:this.id,key:n};return Object(Z.A)(e,n).map((function(e){return new J.C(fe(fe({},o),{},{range:[r,r+1],offset:[e.start,e.end]}))}))}},{key:"onPasteRecordAfterApply",value:function(e){var n=this,r=e.taskId,o=e.recordId,i=e.pageToken,c=e.isReference,a=e.isDeleted,l=Object(X.h)(),s=l.from,u=l.pasteTimes;if(r)if(Object(F.isOnline)()){var d=this.blockManager.getBlockViewByBlockId(this.id);d&&d.showLoading();var f=Object(V.k)();se.W.handlePasteRecordAfterApply({authParams:{todo_guid:r,old_doc_token:i,new_doc_token:f,old_block_id:o,new_block_id:this.recordId,operation:[W.G.innerCutPaste].includes(s)&&1===u||s===W.G.outerCutPaste?"cut":""},currentBlockId:this.id,isReference:c,isDeleted:a},this.blockManager).then((function(e){var o=e.error;d&&d.hiddenLoading(),o?Object(H.K)(n.modelService,n.id,t("common.operation_failed")):n.blockManager.applyTransaction("updateTaskId",(function(e){e.replace(n.recordId,["task_id"],r)}),{undoable:!1})})).catch(U.noop)}else Object(H.K)(this.modelService,this.id,t("CreationDoc_Common_NetworkDisconnected_UnableToCreate"))}},{key:"onCopy",value:function(){return{taskId:this.snapshot.task_id,pageToken:this.docToken,recordId:this.recordId,isReference:!Object(ee.O)()||this.isReference,isDeleted:this.taskData.is_deleted}}},{key:"onDestroy",value:function(e){this.taskModel.detach(this),this.record.off(A.Ra.CHANGE,this.handleRecordChange),x()(R()(r.prototype),"onDestroy",this).call(this,e)}}]),r}(z.D),c.type=W.B.TASK,e=a,o=j()(e.prototype,"eventEmitter",[q.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=j()(e.prototype,"blockManager",[K.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e)}).call(this,r("dx_E9Eu"))},dx_LcdA:function(e,n,r){"use strict";var o=r("dx_E4Sc"),i=r("dx_cDcd"),c=r.n(i),a=r("dx_BaZy"),l=r.n(a);n.S=l()({loader:function(){return Promise.all([r.e("dx_jpN"),r.e("dx_Kpb")]).then(r.bind(null,"dx_q3YN"))},loading:function(){return c.a.createElement(o.S,null)}})},dx_Ldy2:function(e,n,r){},dx_LeqM:function(e,n,r){"use strict";r.d(n,"f",(function(){return s})),r.d(n,"z",(function(){return u}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_QxNg"),a=r("dx_K9Ia"),l=r("dx_VnDw"),s=new a.Z,u=s.pipe(Object(l.N)((function(e){var n=e.options,r=e.recordOps;return!(!e||n.from!==c.H.local)&&!!r.some((function(e){var n=!1,r=!1;return e.ops.some((function(e){var o=i()(e.p,1)[0];if("text"!==o&&"comments"!==o)return!0;if("text"===o){var c,a=[];if(e.subType)return!0;if(a=Object.values(e.action),r=a.some((function(e){var n=e.initialAttributedTexts.text[0].length;return void 0===c&&(c=n),c!==n})))return!0}else n=!0;return!1})),!(n&&!r)}))})))},dx_LjXK:function(e,n,r){"use strict";r.d(n,"K",(function(){return o}));var o=function(e){return e.docx&&e.docx.widthMode}},dx_LkLc:function(e,n,r){"use strict";var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_cDcd"),s=r("dx_h74D"),u=r("dx_yzqx"),d=r("dx_xWbU"),f=r("dx_LjXK");n.S=Object(s.connect)((function(e){return{widthMode:Object(f.K)(e)}}))((function(e){var n=e.editable,r=e.widthMode,o=e.blockManager,c=e.pageToken,s=e.snapshot,f=function(){var e=a()(i.a.mark((function e(r){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:if(a=(null===s||void 0===s?void 0:s.width_mode)||d.M.StandardWidth,r!==a&&!u.S.isFeed&&!u.S.isMobile){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,o.applyTransaction("switchWidthMode",(function(e){e.replace(c,["width_mode"],r)}),{undoable:!1});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),console.error("switch width mode: request failed");case 13:case"end":return e.stop()}}),e,null,[[5,10]])})));return function(n){return e.apply(this,arguments)}}();return Object(l.useEffect)((function(){f(r)}),[r]),null}))},dx_Lkek:function(e,n,r){"use strict";r.d(n,"n",(function(){return c}));var o=r("dx_B28d"),i=r("dx_fEKD");function c(){return Object(i.b)({comments:[],children:[]},o.B.CELL)}},dx_Llxv:function(e,n,r){"use strict";(function(t){var e=r("dx_PcQO"),o=r("dx_h6a8"),i=r("dx_cDcd"),c=r.n(i),a=r("dx_amgp"),l=r("dx_p1pd"),s=r("dx_MBBr"),u=(r("dx_b3bd"),"objective-status-editor");n.S=function(n){var r=n.displayProgressStatus,i=n.status,d=n.statusType,f=n.onConfirm,h=void 0===f?o.noop:f,p=n.onChange,v=void 0===p?o.noop:p,g=n.onPopoverVisibleChange,b=void 0===g?o.noop:g,y=n.getPopupContainer,m=n.onProgressTagHover,_=void 0===m?o.noop:m,k=d===a.l.USE_WORST?a.G.UNSET:i,O=c.a.createElement("div",{className:"".concat(u,"__wrapper")},c.a.createElement("div",{className:"".concat(u,"__progress-type-wrapper")},c.a.createElement("div",{className:"".concat(u,"__caption")},t("CreationDoc_Docs_OKR_StatusDefault")),c.a.createElement(e.Radio,{checked:d===a.l.USE_WORST,onChange:function(e){e.target.checked&&v({progressStatus:a.G.UNSET,statusType:a.l.USE_WORST})},value:a.l.USE_WORST},t("CreationDoc_Docs_OKR_StatusDefault_Desc"))),c.a.createElement("div",{className:"".concat(u,"__prgress-status-wrapper")},c.a.createElement("div",{className:"".concat(u,"__caption")},t("CreationDoc_Docs_OKR_StatusCustom")),c.a.createElement(s.S,{value:k,onChange:function(e){v({progressStatus:e,statusType:a.l.CUSTOM})}})));return c.a.createElement(e.Popover,{trigger:"click",onVisibleChange:function(e){b(e),e||h()},content:O,placement:"bottom",getPopupContainer:y},c.a.createElement("div",null,c.a.createElement(l.S,{status:r,onHover:_})))}}).call(this,r("dx_E9Eu"))},dx_Lqhf:function(e,n,r){"use strict";r.d(n,"D",(function(){return o})),r.d(n,"g",(function(){return i})),r.d(n,"d",(function(){return c}));var o,i,c;r("dx_Icqc");!function(e){e.Text="text",e.Background="background"}(o||(o={})),function(e){e.Text="text",e.LightBackground="lightBackground",e.DarkBackground="darkBackground",e.LightBorder="lightBorder",e.DarkBroder="darkBroder",e.PanelBorder="panelBorder",e.PanelBackground="panelBackground"}(i||(i={})),function(e){e.Text="text",e.Background="background",e.PanelBackground="panelBackground"}(c||(c={}))},dx_LtlN:function(e,n,r){"use strict";r.d(n,"Q",(function(){return v}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_B28d"),s=r("dx_Kkjd"),u=r("dx_NZ34"),d=r("dx_D77K"),f=function(){function e(n,r){i()(this,e),this.treeNodeMap=r,this.id=void 0,this.type=void 0,this.parentId=void 0,this.childrenIds=void 0,this.folded=void 0,this.depth=void 0,this.data=void 0,this.visited=!1,this.independentNodes=[],this.parent=null,this.firstChild=null,this.lastChild=null,this.prevSibling=null,this.nextSibling=null,this.offsetToParent=-1,this.updateData(n)}return a()(e,[{key:"updateData",value:function(e){var n,r;this.data=e,this.id=e.id,this.type=e.data.type,this.parentId=e.data.parent_id,this.childrenIds=Object(d.S)(e),this.folded=e.data.folded,this.depth=this.parentId?(null!==(n=null===(r=this.getNode(this.parentId))||void 0===r?void 0:r.depth)&&void 0!==n?n:0)+1:0}},{key:"getNode",value:function(e){return this.treeNodeMap[e]}},{key:"hasChildren",value:function(){return!!this.childrenIds&&this.childrenIds.length>0}},{key:"childIdAt",value:function(e){return this.hasChildren()?(e<0&&(e=this.childrenIds.length+e),this.childrenIds[e]):null}},{key:"childAt",value:function(e){var n=this.childIdAt(e);return n?this.treeNodeMap[n]:null}}]),e}();function h(e,n){var r=function(e,n){return Array.from(n).map((function(n){return e[n]}))}(e.treeNodeMap,n);!function(e,n){for(var r=e.independentNodes,o=new Set(r.map((function(e){return e.id}))),i=0;i<n.length;i++){var c=n[i];o.has(c.id)||r.push(c)}}(e,r)}function p(e,n,r,o,i,c){var a=o[n],s=e[n];s?(c.delete(n),a?a.type===l.B.PENDING&&a.updateData(s):(a=new f(s,o),o[n]=a)):a||(a=new f(function(e,n){return{id:e,version:0,data:{type:l.B.PENDING,parent_id:n}}}(n,null===i||void 0===i?void 0:i.id),o),o[n]=a),a.parent=i,a.offsetToParent=r;for(var u=a.childrenIds||[],d=0;d<u.length;d++){p(e,u[d],d,o,a,c)}!function(e,n){var r=e.childrenIds||[];if(!(r.length<=0)){e.firstChild=n[r[0]]||null,e.lastChild=n[r[r.length-1]]||null;for(var o=0;o<r.length;o++){var i=n[r[o]];i.prevSibling=n[r[o-1]]||null,i.nextSibling=n[r[o+1]]||null}}}(a,o)}var v=function(){function e(n){var r=this;i()(this,e),this.clientvarStorage=n,this.rootRecordId=void 0,this.tree=void 0,this.traverseStartNode=void 0,this.slicedSet=new Set,this.clientvarStorage.onDataAdd((function(e,n,o){if(r.tree){var i=n===s.J.TABLE?[e]:[];!function(e,n,r){var o=n.block_map,i=e.treeNodeMap;for(var c in o){var a=o[c],s=i[c];s?s.type===l.B.PENDING?s.updateData(a):r.includes(c)||console.error("[docx_data_init] duplicated data, id: ".concat(c,", type: ").concat(a.data.type,", node type: ").concat(s.type)):(s=new f(a,i),i[c]=s)}var u=new Set(Object.keys(o)),d=new Set;for(var v in o){var g=i[v],b=i[g.parentId];g.parent=b,b&&b.childrenIds&&(g.offsetToParent=b.childrenIds.indexOf(v)),g.offsetToParent>=0&&u.delete(v),p(o,v,g.offsetToParent,i,b,d)}h(i.__ROOT__,u)}(r.tree,o,i)}else r.tree=function(e,n){var r=e.block_map,o={},i=new Set(Object.keys(r));p(r,n,-1,o,null,i);var c=o[n];o.__ROOT__=c;var a=new Set;return i.forEach((function(e){var n=r[e].data.parent_id,i=o[n]||null;p(r,e,-1,o,i,a)})),h(c,i),c}(o,r.rootRecordId)}))}return a()(e,[{key:"setRootRecordId",value:function(e){this.rootRecordId=e}}]),a()(e,[{key:"getTree",value:function(){return this.tree}},{key:"split",value:function(e){var n=e.traverseStartRecordId,r=e.size,o=e.isFirstSlice,i=void 0!==o&&o,c=performance.now();this.traverseStartNode||(this.traverseStartNode=this.tree.getNode(this.rootRecordId)),n&&(this.traverseStartNode=this.tree.getNode(n)||this.traverseStartNode);var a={};this.traverseNode(this.traverseStartNode,r,a);var l=this.tree.getNode(this.rootRecordId);this.traverseIndependentNodes(l,a);var s=Object.keys(a).length;return Object(u.A)({split_start_id:n||"",split_size_expected:r===1/0?-1:r,split_size_actual:s,cost_time:performance.now()-c,isFirstSlice:i}),s<1?null:{block_map:a}}},{key:"destroy",value:function(){this.tree=void 0,this.traverseStartNode=void 0,this.slicedSet.clear(),this.clientvarStorage=void 0}},{key:"traverseNode",value:function(e,n,r){if(e&&e.type!==l.B.PENDING){0!==n||this.slicedSet.has(e.id)||(r[e.id]=e.data,this.slicedSet.add(e.id));var o=n-this.traverseChildren(e,0,n,r,!1),i=Math.ceil(o/2);o-=this.traverseSibling(e,0,i,r,!1),o-=this.traverseSibling(e,0,o,r,!0),this.traverseNode(e.parent,o,r)}}},{key:"traverseChildren",value:function(e,n,r,o,i){if(e&&e.type===l.B.TABLE&&this.clientvarStorage.has(e.id)&&(r=1/0),n>=r||!e||e.visited||e.type===l.B.PENDING)return n;var c=n;e.visited||this.slicedSet.has(e.id)||(c++,o[e.id]=e.data,this.slicedSet.add(e.id));for(var a=i?e.lastChild:e.firstChild;a&&c<r;)c=Math.max(c,this.traverseChildren(a,c,r,o,i)),a=i?a.prevSibling:a.nextSibling;return function(e){if(e.hasChildren()){for(var n=e.firstChild,r=!0;n;){if(!n.visited){r=!1;break}n=n.nextSibling}r&&(e.visited=!0)}else e.visited=!0}(e),c}},{key:"traverseSibling",value:function(e,n,r,o,i){if(n>=r||!e||e.type===l.B.PENDING)return n;for(var c=n,a=i?e.prevSibling:e.nextSibling;a;)c=Math.max(c,this.traverseChildren(a,c,r,o,i)),a=i?a.prevSibling:a.nextSibling;return c}},{key:"traverseIndependentNodes",value:function(e,n){var r=0;if(!e)return r;for(var o=e.independentNodes,i=0;i<o.length;i++){var c=o[i];r+=this.traverseChildren(c,0,1/0,n,!1)}return r}}]),e}()},dx_Lusj:function(e,n,r){"use strict";r.d(n,"G",(function(){return c}));var o=r("dx_cDcd"),i=r.n(o),c=function(){return i.a.createElement("svg",{className:"circular",viewBox:"25 25 50 50"},i.a.createElement("circle",{className:"path",cx:"50",cy:"50",r:"20",fill:"none",strokeWidth:"4",strokeMiterlimit:"10"}))}},dx_Lw5s:function(e,n,r){},dx_LxMw:function(e,n,r){"use strict";(function(t){r.d(n,"Z",(function(){return X}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_W7W2"),f=r.n(d),h=r("dx_a1gu"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=r("dx_lSNA"),y=r.n(b),m=r("dx_x56x"),_=r("dx_e4eN"),k=r("dx_uZlF"),O=r("dx_PM7Q"),x=r("dx_UtDZ"),E=r("dx_h6a8"),S=r("dx_cDcd"),C=r.n(S),I=r("dx_faye"),B=r.n(I),T=r("dx_C7Cb"),w=r("dx_xlCA"),R=r("dx_YzVl"),M=r("dx_A2Ao"),j=r("dx_HA1r"),D=r("dx_Np2v"),A=r("dx_lSlT"),P=r("dx_jBD0"),L=r("dx_z4Mb"),N=r("dx_VKNB"),F=r("dx_G3VO"),U=r("dx_xPLQ"),H=r("dx_prDn"),V=r("dx_sYmP"),W=r("dx_md5I");function z(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}function G(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function K(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?G(Object(r),!0).forEach((function(n){y()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function q(e,n){var r=Object(F.J)(e.getContentState(),n);return new k.A(K({editor:e},r))}var X=function(e){f()(r,e);var n=z(r);function r(e){var i;return l()(this,r),i=n.call(this,K(K({},e),{},{onSuggest:function(){var e;return(e=i).handleSuggestDebounce.apply(e,arguments),{close:i.close}}})),i.boundary=void 0,i.block=void 0,i.targetUid=void 0,i.target=void 0,i.triggerId=void 0,i.mountNode=void 0,i.onOpenMentionPanel=void 0,i.onMentionConfirm=void 0,i.close=function(){var e=i.triggerId;if(e){var n=Object(W.N)(i.editor,{trigger:e});i.toggleMark({trigger:e},n,!0)}i.target=void 0,i.triggerId="",i.handleSuggestDebounce.cancel(),i.mountNode&&(B.a.unmountComponentAtNode(i.mountNode),i.mountNode=void 0)},i.handleSuggestDebounce=Object(E.debounce)(function(){var e=c()(o.a.mark((function e(n){var r,c,a,l,s,u,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.mountNode,c=n.query,a=n.onConfirm,i.mountNode=r,i.triggerId){e.next=11;break}return l=Object(T.S)(),i.triggerId=l,s=i.editor.selection.getSelection(),u=s.start,e.next=8,i.toggleMark({trigger:l},{start:K(K({},u),{},{offset:u.offset-1}),end:u});case 8:d=i.block.hostElement.querySelector(".trigger-holder-".concat(l)),i.target=d,i.onOpenMentionPanel();case 11:B.a.render(C.a.createElement(L.Z,{selectionAPI:i.block.selectionAPI,boundary:i.block.boundary,blockManager:i.block.blockManager,query:c,target:i.target,onSelect:function(e,n){return a({data:e,needNotification:n})},onClose:i.close}),r);case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),100,{leading:!1,trailing:!0}),i.handleConfirm=Object(H.y)(function(){var e=c()(o.a.mark((function e(n){var r,c,a,l,s,u,d,f,h,p,v,g,b,y,k,O,E,S,C,I,B,T,P,L,N,F,H,W,z,G,K,X,Y,J,Z,Q,$,ee;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=n.data,a=n.needNotification,c){e.next=3;break}return e.abrupt("return");case 3:if((l=i.props.editor).flushInput(),s=l.selection.getSelection(),u=s.start,d=u.zoneId,f=l.getContentState(),h=null===(r=f.getZoneState(d))||void 0===r?void 0:r.getLine(u.line)){e.next=12;break}return e.abrupt("return");case 12:p=h.getModelText(),v=h.getOffset(),g=v.start,b=p.slice(0,u.offset).lastIndexOf("@"),y=g+b,k=new _.m({zoneId:d}).retain(y).delete(s.toPosition().start-y),O=c.type,E=c.entity,e.t0=O,e.next=e.t0===j.D.USER?21:e.t0===j.D.CHAT?33:e.t0===j.D.DOC?49:53;break;case 21:if(!a){e.next=23;break}return e.abrupt("break",54);case 23:if(C=(S=E).id,I=S.name,B=S.avatarUrl,T=S.isCrossTenant,w.n.setCache(E.id,{name:E.name,avatar_url:""}),P=i.generateData({avatar_url:B||"",cn_name:I,en_name:I,department:"",email:"",id:C,is_external:T||!1,type:x.TYPE_ENUM.USER,name:I,leaderName:""}),k.insert(" ",{dataMetaBlockProps:JSON.stringify(P)}),L=l.getContentState().getZoneState(d)){e.next=30;break}return e.abrupt("break",54);case 30:return N={start:L.offsetToPoint(y),end:L.offsetToPoint(y+1)},setTimeout((function(){M.S.addTaskMemberMentionNotify({id:C,name:I},(function(){try{var e,n=null===(e=i.props.editor.getContentState().getZoneState(d))||void 0===e?void 0:e.getEntities(N);if(!n)return;if(JSON.parse(n[0].attributes.dataMetaBlockProps).props.data.user.id===C){var r,o,c=l.selection.toDOMRange(q(l,[y,y+1]),{ignoreNormalize:!0});return null===c||void 0===c||null===(r=c.endContainer)||void 0===r||null===(o=r.parentElement)||void 0===o?void 0:o.closest("[".concat(m.n,"]"))}}catch(a){}}))})),e.abrupt("break",54);case 33:return F=E.id,e.prev=34,e.next=37,Object(V.n)(F,i.block.blockManager);case 37:if(!(H=e.sent).RespCode){e.next=41;break}return Object(R.F)({type:"error",content:D.X[H.RespCode]}),e.abrupt("break",54);case 41:Object(V.s)({chatId:F,chatToken:H.Token,block:i.block,blockManager:i.block.blockManager}),e.next=48;break;case 44:e.prev=44,e.t1=e.catch(34),z=D.X[null===e.t1||void 0===e.t1||null===(W=e.t1.data)||void 0===W?void 0:W.RespCode]||t("common.network_error"),Object(R.F)({type:"error",content:z});case 48:return e.abrupt("break",54);case 49:return K=(G=E).id,X=G.name,Y=G.type,J=G.url,Z=G.isCrossTenant,Q=Number(Object.keys(j.F).find((function(e){return j.F[e]===Y}))),J&&Q&&($=X,Q===x.TYPE_ENUM.DOCX&&(A.S.setTitle(K,X),$=void 0),A.S.setUrl(K,J),ee=i.generateData({type:Q,link:J,url:J,token:K,title:$||"",is_cross_tenant:Z||!1}),k.insert(" ",{dataMetaBlockProps:JSON.stringify(ee)})),e.abrupt("break",54);case 53:return e.abrupt("break",54);case 54:i.onMentionConfirm({id:c.id,needNotification:a,type:O}),f.apply(k),O===j.D.USER&&a&&Object(U.G)({id:E.id,name:E.name,hostElement:i.block.hostElement}),i.closeSuggest();case 58:case"end":return e.stop()}}),e,null,[[34,44]])})));return function(n){return e.apply(this,arguments)}}()),i.popupMountNode=Object(N.p)(),i.boundary=e.boundary,i.block=e.block,i.onMentionConfirm=e.onMentionConfirm,i.onOpenMentionPanel=e.onOpenMentionPanel,i}return u()(r,[{key:"editor",get:function(){return this.props.editor}},{key:"contentState",get:function(){return this.editor.getContentState()}}]),u()(r,[{key:"toggleMark",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this.props.editor.getContentState();if(r){var i=Object.keys(e).reduce((function(e,n){return e[n]="",e}),{});o.setAttributes(n,i)}else o.setAttributes(n,e)}},{key:"renderAt",value:function(e,n,r,o){return C.a.createElement(P.W,{boundary:this.boundary,block:this.block,zoneId:e,attributes:n,data:r,originData:o})}}]),r}(O.f)}).call(this,r("dx_E9Eu"))},dx_LzB7:function(e,n,r){"use strict";r.d(n,"g",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("block-query")},dx_M32A:function(e,n){},dx_M35M:function(e,n,r){"use strict";(function(t){r.d(n,"c",(function(){return b}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_ABP7"),l=r("dx_UZvu"),s=r("dx_cDcd"),u=r.n(s),d=r("dx_faye"),f=r.n(d),h=r("dx_CkQe"),p=r("dx_Vqq2"),v=r("dx_Xdvu");function g(e){var n=e.onClose;return Object(s.useEffect)((function(){return n}),[n]),null}function b(e,n,r,i){setTimeout(c()(o.a.mark((function s(){var d,b,y,m,_,k,O,x,E,S,C,I;return o.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return(d=document.querySelector(".task-block-clipboard-menu-container"))&&f.a.unmountComponentAtNode(d),(b=document.createElement("div")).classList.add("clipboard-menu-container","task-block-clipboard-menu-container"),document.body.appendChild(b),y=e[e.length-1].blockId,m=n.getBlockViewByBlockId(y),_=m.editorAPI.getService(v.a),k=_.fold,O=_.viewport,s.next=10,k.forceShowFoldedBlock(y,!0);case 10:return s.next=12,O.scrollToBlock(m.id);case 12:x=m.getHostRect(),E=x.bottom,S=x.right,C=[{icon:u.a.createElement(a.S,null),name:"paste_and _quote",type:h.F.MenuItemNormal,extra:{behavior:h.l.CreateNoOps},text:t("CreationDoc_Todo_PasteAndSyncTask_Button"),desc:t("CreationDoc_Todo_PasteAndSyncTask_Desc"),action:function(){}},{icon:u.a.createElement(l.S,null),name:"only_paste",type:h.F.MenuItemNormal,extra:{behavior:h.l.CreateNoOps},text:t("CreationDoc_Todo_PasteContentOnly_Button"),desc:t("CreationDoc_Todo_PasteContentOnly_Desc"),action:function(){}}],I=function(){var e=c()(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r(n.name);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),f.a.render(u.a.createElement(u.a.Fragment,null,u.a.createElement(p.O,{boundary:m.boundary,onClick:I,visible:!0,menuItems:C,top:E+2,left:S,host:b}),u.a.createElement(g,{onClose:i})),b);case 16:case"end":return s.stop()}}),s)}))),0)}}).call(this,r("dx_E9Eu"))},dx_M3MB:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M8.451 14.99l-3.563-.008a.25.25 0 01-.176-.427l3.444-3.444c.13-.13.341-.13.472 0l1.589 1.589 4.214-4.214a.333.333 0 01.57.235v6.029a.25.25 0 01-.25.25H8.52a.252.252 0 01-.07-.01zm-5.95 3.343a.833.833 0 01-.834-.833v-15c0-.46.373-.833.833-.833h15c.46 0 .834.373.834.833v15c0 .46-.373.833-.834.833h-15zm.833-1.666h13.333V3.332H3.334v13.333zM5 5h2.5v2.5H5V5z",fill:"currentColor"});n.S=function(e){return i.a.createElement("svg",c({width:20,height:20,viewBox:"0 0 20 20",fill:"none"},e),a)}},dx_M4Mk:function(e,n,r){"use strict";(function(t){var e=r("dx_cDcd"),o=r.n(e),i=r("dx_Md2h");r("dx_Durh");n.S=function(e){var n=e.tip,r="unsupport";return o.a.createElement("div",{className:r},o.a.createElement("div",{className:"".concat(r,"--left")},o.a.createElement(i.S,null)),o.a.createElement("div",{className:"".concat(r,"--right")},o.a.createElement("div",{className:"".concat(r,"--title")},o.a.createElement("div",null,n||t("block.placeholder.new_app")))))}}).call(this,r("dx_E9Eu"))},dx_M4lb:function(e,n,r){},dx_M7MP:function(e,n,r){"use strict";r.d(n,"p",(function(){return a})),r.d(n,"H",(function(){return s})),r.d(n,"N",(function(){return u})),r.d(n,"T",(function(){return d}));var o=r("dx_h6a8"),i=r("dx_ABiD"),c=r("dx_D8nn");function a(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,r=!1,o=requestAnimationFrame((function(){r||(r=!0,e("RAF"))})),i=setTimeout((function(){r||(r=!0,e("TIMEOUT"))}),n);return function(){cancelAnimationFrame(o),clearTimeout(i)}}function l(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return n=a((function(){n=a((function(){e()}),r)}),r),function(){n()}}function s(e,n){if(n.isFirstScreen)return e.apply(null),function(){return Object(o.noop)()};var r=o.noop,a=o.noop,s=function(){c.S.off(i.C.RENDER_DOCX_FIRST_SCREEN_SUCCESS,r),a&&a()};return r=function(){a=l((function(){s(),e.apply(null)}))},c.S.on(i.C.RENDER_DOCX_FIRST_SCREEN_SUCCESS,r),s}function u(e){var n=o.noop,r=o.noop,a=function(){c.S.off(i.C.RENDER_DOCX_FIRST_SCREEN_SUCCESS,n),r&&r()};return n=function(){r=l((function(){a(),e.apply(null)}))},c.S.on(i.C.RENDER_DOCX_FIRST_SCREEN_SUCCESS,n),a}function d(e,n){n&&!n.isFirstScreen||e.apply(null)}},dx_MBBr:function(e,n,r){"use strict";(function(t){var e=r("dx_PcQO"),o=r("dx_cDcd"),i=r.n(o),c=r("dx_amgp"),a=(r("dx_FrkR"),"okr-status-selector");n.S=function(n){var r=n.value,o=n.onChange;return i.a.createElement("div",{className:a},i.a.createElement(e.Radio.Group,{direction:"vertical",value:r,onChange:function(e){return null===o||void 0===o?void 0:o(e)}},i.a.createElement(e.Radio,{className:"".concat(a,"--normal"),value:c.G.ON_TRACK},t("CreationDoc_Docs_OKR_StatusCustom_Normal")),i.a.createElement(e.Radio,{className:"".concat(a,"--risk"),value:c.G.AT_RISK},t("CreationDoc_Docs_OKR_StatusOnly_AtRisk")),i.a.createElement(e.Radio,{className:"".concat(a,"--delay"),value:c.G.OFF_TRACK},t("CreationDoc_Docs_OKR_StatusOnly_Delayed"))))}}).call(this,r("dx_E9Eu"))},dx_MC5R:function(e,n,r){"use strict";r.d(n,"W",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("presentation-mode")},dx_MCZe:function(e,n,r){},dx_MG1i:function(e,n,r){"use strict";r.d(n,"j",(function(){return u}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r("dx_b28D"),l=r("dx_qHDV"),s=Object(a.e)("common:hook:use-selecting");function u(e){var n=Object(c.useState)(e.isSelecting()),r=i()(n,2),o=r[0],a=r[1];return Object(c.useEffect)((function(){var n=function(){s("set isSelecting to true"),a(!0)},r=function(){s("set isSelecting to false"),a(!1)};return e.on(l.j.start,n),e.on(l.j.stop,r),function(){e.off(l.j.start,n),e.off(l.j.stop,r)}}),[e]),o}},dx_MGAW:function(e,n,r){"use strict";r.d(n,"G",(function(){return v})),r.d(n,"U",(function(){return y}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_B28d"),a=r("dx_O1Ou"),l=r("dx_MUhB"),s=r("dx_moB4"),u=r("dx_YCIe"),d=r("dx_rdYh"),f=r("dx_IwME");function h(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function p(e,n){return function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?h(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({defaultState:u.B,retryOptions:{retryTimes:5,retryIntervalMs:500},recordIdsFromStateGetter:function(e,n){return e===a.X.SCROLL?Object.keys(n.offsetRatioMap):void 0},checkSame:function(n,r,o){return n===a.X.SCROLL&&Object(l.P)(r.offsetRatioMap,o.offsetRatioMap,d.X,e.vcController.blockManager,u.w,f.Q.ensureSame.bind(f.Q))}},n)}function v(e){return{vcModule:g(e).moduleName,offsetRatioObject:u.I.includes(e)}}function g(e){return new Map([[c.u.BITABLE,{moduleName:a.a.DocxBitable,retryOnVersionMatched:"fail-only"}],[c.u.SHEET,{moduleName:a.a.DocxSheet,retryOnVersionMatched:"fail-only"}],[c.u.TABLE,{moduleName:a.a.DocxTable,retryOnVersionMatched:"always"}]]).get(e)}function b(e){var n=g(e);s.X.addModuleConfigGetter((function(e){return p(e,n)}))}function y(e){e.forEach(b)}},dx_MGm1:function(e,n,r){"use strict";r.d(n,"B",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("docx-resource-scheduler-service")},dx_MGoZ:function(e,n,r){"use strict";r.d(n,"l",(function(){return Z}));var o=r("dx_yG8O"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_PJYZ"),d=r.n(u),f=r("dx_iWIM"),h=r.n(f),p=r("dx_W7W2"),v=r.n(p),g=r("dx_a1gu"),b=r.n(g),y=r("dx_Nsbk"),m=r.n(y),_=r("dx_Uyc2"),k=r.n(_),O=(r("dx_A1AB"),r("dx_lSNA")),x=r.n(O),E=r("dx_bLiB"),S=r("dx_h6a8"),C=r("dx_yzqx"),I=r("dx_BrJR"),B=r("dx_OUFY"),T=r("dx_K8h1"),w=r("dx_BH3T"),R=r("dx_g1Ip"),M=r("dx_JsDk"),j=r("dx_Xdvu"),D=r("dx_b28D"),A=r("dx_K9Ia"),P=Object(D.h)("block:block-mask-rect"),L=function(){function e(n){a()(this,e),this.hostBlock=n,this.hostRectInsetDelta=void 0,this.logId=void 0,this.hostRectInsetDeltaChange$=new A.Z,this.logId=n.logId}return s()(e,[{key:"getHostRectInsetDelta",value:function(){return this.hostRectInsetDelta||this.refreshHostRectInsetDelta("getHostRectInsetDelta")}},{key:"refreshHostRectInsetDelta",value:function(e){var n=this.calcHostRectInsetDelta(e),r=!Object(S.isEqual)(this.hostRectInsetDelta,n);return this.hostRectInsetDelta&&!r||(this.hostRectInsetDelta=n,this.hostRectInsetDeltaChange$.next(this.hostRectInsetDelta),P(this.logId,"%s: hostRectInsetDelta=%s/%s",e,n.leftDelta,n.rightDelta)),this.hostRectInsetDelta}},{key:"calcHostRectInsetDelta",value:function(e){var n=this,r=this.hostBlock,o=r.model,i=r.blockManager,c=r.props;if(!o.children.length)return{leftDelta:0,rightDelta:0};var a=c.recursionProps.fold,l=this.hostBlock.getRealHostRect(),s=l.left,u=l.right,d=[];return o.traverseInDepthFirstPreOrder((function(r){if(Object(w.T)(r.type))if(a.isFoldedOrFoldedBy(r.id))P(n.logId,"%s.calcHostRectInsetDelta: skip folded %s-%s",e,r.type,r.id);else{var o=i.getBlockViewByBlockIdNotCheck(r.id);if(o){var c=o.getExtendedContentRect();c.width&&(d.push("".concat(o.logId,"=").concat(c.left,"/").concat(c.right)),s=Math.min(s,c.left),u=Math.max(u,c.right))}}})),P(this.logId,"%s.calcHostRectInsetDelta, rect(left/right): %o %s=%s/%s, minLeft/maxRight=%s/%s",e,d,this.hostBlock.logId,l.left,l.right,s,u),{leftDelta:s-l.left,rightDelta:l.right-u}}}]),e}();var N=r("dx_OyqL"),F=Object(D.h)("block:block-mask-manager"),U=["selected","hovered","sync-selected","background","reminder-highlighted","block-flash"],H=["selected","hovered"],V=["sync-selected"],W=function(){function e(n){var r,o=this;a()(this,e),this.hostBlock=n,this.logId=void 0,this.maskContainers=new Map,this.maskRect=void 0,this.isMaskUpdateEnabled=void 0,this.toggleMask=function(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.hostElement;V.includes(e)&&!o.maskUpdater||(n?o.addMask(e,i,r):o.removeMask(e))},this.getMask=function(e,n){var r=n||o.maskContainers.get(e);return r?function(e,n){try{return e.querySelector(":scope > .".concat(n))}catch(r){return function(e,n){var r=null;return e.querySelectorAll(n).forEach((function(n){n.parentElement===e&&(r=r||n)})),r}(e,".".concat(n))}}(r,o.getMaskClass(e)):null},this.updateMaskStyle=function(e,n){if(o.maskRect){var r=o.maskRect.refreshHostRectInsetDelta(n),i=r.leftDelta,c=r.rightDelta;F(o.logId,"%s: maskInsetDelta=%s/%s",n,i,c),e.forEach((function(e){var n=e.style;n.left="".concat(i,"px"),n.right="".concat(c,"px")}))}},this.delayedRefreshMaskStyle=function(e){o.guardedRefreshMaskStyle("guard.".concat(e)),o.debouncedRefreshMaskStyle(e)},this.refreshMaskStyle=function(e){var n=o.getMaskTypes(),r=n.map((function(e){return o.getMask(e)})).filter((function(e){return e}));o.updateMaskStyle(r,"".concat(e,".refreshMask(").concat(n,")"))},this.debouncedRefreshMaskStyle=Object(S.debounce)(this.refreshMaskStyle,5,{maxWait:30}),this.guardedRefreshMaskStyle=Object(S.debounce)(this.refreshMaskStyle,500),this.logId=this.hostBlock.logId,this.isMaskUpdateEnabled=(r=n.type,Object(w.Q)(r)),this.isMaskUpdateEnabled&&(this.maskRect=new L(n))}return s()(e,null,[{key:"getMaskDom",value:function(){if(this.maskDom)return this.maskDom.cloneNode();var e=document.createElement("div");return e.setAttribute("contenteditable","false"),Object.assign(e.style,{position:"absolute",left:0,right:0,top:0,bottom:0,borderRadius:"4px",pointerEvents:"none"}),this.maskDom=e,this.maskDom.cloneNode()}}]),s()(e,[{key:"getHostRectInsetDelta",value:function(){var e;return null===(e=this.maskRect)||void 0===e?void 0:e.getHostRectInsetDelta()}},{key:"updateMaskDomStyle",value:function(e,n,r){e?(Object.assign(e.style,r||{}),this.updateMaskStyle([e],n)):this.updateMaskStyle([],n)}},{key:"addMask",value:function(n,r,o){var i;if(H.includes(n)){var c=this.getExclusiveMaskType();if(c&&c!==n)return F(this.logId,"skip adding exclusive mask %s, unequal to current(%s)",n,c),null}if(!this.hasMaskClass(n)){F(this.logId,"add %s mask, extraStyle=%o",n,o);var a=V.includes(n)?null:e.getMaskDom();return this.updateMaskDomStyle(a,"addMask(".concat(n,")"),o),a&&(a.className=this.getMaskClass(n),r.appendChild(a),this.maskContainers.set(n,r)),this.toggleMaskClass(n,!0),null===(i=this.maskUpdater)||void 0===i||i.addBlockListener(this.hostBlock.id,this.delayedRefreshMaskStyle),a}F(this.logId,"refresh style for already-existing mask %s, extraStyle=%o",n,o);var l=this.getMask(n,r);this.updateMaskDomStyle(l,"refreshMask(".concat(n,")"),o)}},{key:"removeMask",value:function(e){var n,r=this.getMask(e);(r||this.hasMaskClass(e))&&(F(this.logId,"remove %s mask",e),null===r||void 0===r||r.remove(),this.toggleMaskClass(e,!1),this.getMaskTypes().length||null===(n=this.maskUpdater)||void 0===n||n.removeBlockListener(this.hostBlock.id))}},{key:"toggleMaskClass",value:function(e,n){n?this.hostElement.classList.add(e):this.hostElement.classList.remove(e)}},{key:"hasMaskClass",value:function(e){return this.hostElement.classList.contains(e)}},{key:"getExclusiveMaskType",value:function(){var e=this;return H.find((function(n){return e.hasMaskClass(n)}))}},{key:"getMaskTypes",value:function(){var e=this;return U.filter((function(n){return e.hasMaskClass(n)}))}},{key:"getMaskClass",value:function(e){return"".concat(e,"-mask")}},{key:"hostRectInsetDeltaChange$",get:function(){var e;return null===(e=this.maskRect)||void 0===e?void 0:e.hostRectInsetDeltaChange$}},{key:"hostElement",get:function(){return this.hostBlock.hostElement}},{key:"maskUpdater",get:function(){return this.isMaskUpdateEnabled?this.hostBlock.editorAPI.getService(N.W,{optional:!0}):void 0}}]),e}();W.maskDom=null;var z,G,K,q=r("dx_B28d"),X=r("dx_L6Lu");function Y(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var J=x()({},q.B.TABLE,M.R.leftExtending),Z=(K=function(e){v()(r,e);var n=Y(r);function r(e){var o;return a()(this,r),o=n.call(this,e),i()(o,"editorContext",G,d()(o)),o.blockMaskManager=void 0,o.logId=void 0,o.getViewSnapshot=void 0,o.getAlignType=void 0,o.logId="".concat(o.type,"-").concat(o.id),o.blockMaskManager=new W(d()(o)),o}return s()(r,[{key:"getElementByClass",value:function(e){var n;return null===(n=this.hostElement)||void 0===n?void 0:n.querySelector(".".concat(e))}},{key:"getSelectionLocator",value:function(e){var n=this.hostElement.querySelectorAll(".docx-block-zero-space [data-zero-space]"),r=n[0],o=n[n.length-1];return(e?r:o)||this.hostElement}},{key:"setSelected",value:function(e){this.blockMaskManager.toggleMask("selected",e)}},{key:"setSyncSelected",value:function(e){this.blockMaskManager.toggleMask("sync-selected",e)}},{key:"setHovered",value:function(e){this.blockMaskManager.toggleMask("hovered",e,{backgroundColor:T.uY.BLOCK_BG_HOVER})}},{key:"getHostRect",value:function(){var e=this.props.recursionProps,n=e.rect,r=e.blockManager,o=r.getBlockViewByBlockId(r.rootBlockId).hostElement.getBoundingClientRect(),i=n.getBlockRect(this.id);return new DOMRect(o.left+i.left,o.top+i.top,i.width,i.height)}},{key:"getRealHostRect",value:function(){return this.hostElement.getBoundingClientRect()}},{key:"getLeftExtending",value:function(){return J[this.model.type]||0}},{key:"getContentRect",value:function(){return this.calcContentRect(0)}},{key:"getExtendedContentRect",value:function(){return this.calcContentRect(this.getLeftExtending(),this.isPresentationMode)}},{key:"getOverflowableContainer",value:function(){var e;return(null===(e=this.props.scrollManage)||void 0===e?void 0:e.getScrollContainer())||null}},{key:"calcContentRect",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=function(e){var n=e.getBoundingClientRect(),r=Object(X.k)(e);return new DOMRect(r*n.x,r*n.y,r*n.width,r*n.height)},i=function(e){return e.getBoundingClientRect()},c=r?o:i,a=function(){return n.contentElement?c(n.contentElement):new DOMRect(0,0,0,0)};if(!Object(w.T)(this.type))return a();var l=this.getOverflowableContainer(),s=null===l||void 0===l?void 0:l.firstElementChild;if(!l||!s)return a();if(l.classList.contains(B.M)&&!l.classList.contains(B.s))return a();if(l.classList.contains(R.q)&&l.closest("[data-bear-virtual-deactivated-child]"))return new DOMRect(0,0,0,0);var u=c(l),d=c(s),f=c(this.hostElement),h=u.left-(C.Z.isMobile?0:e),p=Object(S.clamp)(d.left-e,h,f.left),v=Object(S.clamp)(d.right,f.right,u.right),g=v-p;return new DOMRect(p,f.top,g,f.height)}},{key:"getText",value:function(){return""}},{key:"onResize",value:function(e){}},{key:"onFoldStateChange",value:function(e){}},{key:"getCommentRef",value:function(e){var n=Object(I.B)(e);return this.hostElement.querySelector(".block-comment.".concat(n))}},{key:"addCommentHighlight",value:function(e){this.getCommentRef(e)&&this.props.toggleCommentHighlight&&this.props.toggleCommentHighlight(!0)}},{key:"removeCommentHighlight",value:function(e,n){var r=this.getCommentRef(e);!r||n&&r.classList.contains(Object(I.B)(n))||this.props.toggleCommentHighlight&&this.props.toggleCommentHighlight(!1)}},{key:"blockViewWillUnmount",value:function(){h()(m()(r.prototype),"blockViewWillUnmount",this).call(this),this.hostElement&&(this.setSelected(!1),this.setSyncSelected(!1),this.setHovered(!1))}},{key:"renderChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.model.isDestroyed&&0!==this.model.children.length)return this.editorAPI.viewService.renderChildren(this.id,Object.assign({recursionProps:this.props.recursionProps},e))}},{key:"focusElement",get:function(){return null}},{key:"isWithBoundary",get:function(){return!1}},{key:"record",get:function(){return this.model.record}},{key:"snapshot",get:function(){return this.record.snapshot}},{key:"hostElement",get:function(){return this.props.hostElementRef.current}},{key:"contentElement",get:function(){var e;return null===(e=this.hostElement)||void 0===e?void 0:e.firstElementChild}},{key:"blockContentElement",get:function(){}},{key:"scrollElement",get:function(){return this.getElementByClass(T.u.CONTENT_SCROLLER)}},{key:"translated",get:function(){return!!this.props.recursionProps.translated}},{key:"blockManager",get:function(){return this.props.recursionProps.blockManager}},{key:"config",get:function(){return this.editorAPI.config}},{key:"editorAPI",get:function(){return this.props.editorAPI}},{key:"viewport",get:function(){return this.props.recursionProps.viewport}},{key:"selectionAPI",get:function(){return this.props.recursionProps.selectionAPI}},{key:"boundary",get:function(){return this.props.recursionProps.boundary}},{key:"editable",get:function(){return!1!==this.props.recursionProps.editable}},{key:"isMobileEditMode",get:function(){return this.props.recursionProps.isMobileEditMode}},{key:"vcController",get:function(){return this.props.recursionProps.vcController}},{key:"editPermission",get:function(){return!1!==this.props.recursionProps.editPermission}},{key:"eventEmitter",get:function(){return this.props.recursionProps.eventEmitter}},{key:"isHistory",get:function(){return!0===this.props.recursionProps.isHistory}},{key:"parentId",get:function(){return this.props.parentId}},{key:"isPresentationMode",get:function(){return!0===this.props.recursionProps.isPresentationMode}}],[{key:"getMaskDom",value:function(){return W.getMaskDom()}}]),r}(E.U),z=K,G=k()(z.prototype,"editorContext",[j.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),z)},dx_MIrL:function(e,n,r){"use strict";r.d(n,"p",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("layout-manager")},dx_MIzm:function(e,n,r){"use strict";r.d(n,"A",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("compatible-record-manager")},dx_MMMl:function(e,n,r){"use strict";var o=r("dx_MIrL");r.d(n,"p",(function(){return o.p}))},dx_MNju:function(e,n,r){},dx_MP54:function(e,n,r){"use strict";r.d(n,"S",(function(){return W}));var o,i=r("dx_J4zp"),c=r.n(i),a=r("dx_o0o1"),l=r.n(a),s=r("dx_yXPU"),u=r.n(s),d=r("dx_lwsE"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_Vvd7"),g=r("dx_QxNg"),b=r("dx_NOtv"),y=r.n(b),m=r("dx_h6a8"),_=r("dx_C7Cb"),k=r("dx_rQGm"),O=r("dx_PQBD"),x=r("dx_B28d"),E=r("dx_LA8U"),S=r("dx_YjoZ"),C=r("dx_D8nn"),I=r("dx_mljG"),B=r("dx_IcDz"),T=r("dx_lSNA"),w=r.n(T),R=r("dx_RIqP"),M=r.n(R),j=r("dx_Fimk"),D=r("dx_O1Ou"),A=r("dx_ozfA");!function(e){e.Fold="Fold"}(o||(o={}));var P=!0,L=D.a.DocxFold,N=function(){function e(n,r,i,c){var a=this;f()(this,e),this.blockManager=n,this.vcController=r,this.getFoldBlocksRecordIdByStatus=i,this.findFoldedBlocksByStatus=c,this.preFoldBlocks=[],this.unregister=void 0,this.handleFoldChange=Object(A.p)((function(){var e,n=a.getFoldBlocksRecordIdByStatus(P);Object(m.isEqual)(a.preFoldBlocks,n)||(null===(e=a.vcController)||void 0===e||e.sendState(L,o.Fold,{foldBlocks:n}),a.preFoldBlocks=n)})),this.checkFoldBlocksEqual=function(e,n){var r=function(e,n){return e>n?-1:1},o=e.filter((function(e){var n;return null===(n=a.blockManager.getBlockIdsByRecordId(e))||void 0===n?void 0:n[0]}));return M()(o).sort(r).toString()===M()(n).sort(r).toString()},this.replayHandler=function(e){var n=e.actionType,r=e.data,i=e.uuid;if(n===o.Fold){var c=r.foldBlocks,l=void 0===c?[]:c,s=l.map((function(e){var n;return null===(n=a.blockManager.getBlockIdsByRecordId(e))||void 0===n?void 0:n[0]})).filter((function(e){return!!e})),u=a.findFoldedBlocksByStatus(P);Object(m.difference)(u,s).forEach((function(e){a.blockManager.dispatch(k.Fx,[e,!1])})),s.forEach((function(e){a.blockManager.dispatch(k.Fx,[e,P])})),a.detect(i,l,a.getFoldBlocksRecordIdByStatus(P))}},this.bindingEvent(!0),this.register()}return p()(e,[{key:"bindingEvent",value:function(e){C.S[e?"on":"off"](k.Fx,this.handleFoldChange),this.blockManager[e?"addListener":"removeListener"](k.Fx,this.handleFoldChange)}},{key:"register",value:function(){var e=this;this.unregister=this.vcController.register({moduleName:L,defaultState:w()({},o.Fold,{foldBlocks:[]}),replayHandler:this.replayHandler,retryOnVersionMatched:"fail-only",retryOptions:{retryTimes:4,retryIntervalMs:250},checkSame:function(n,r,o){return e.checkFoldBlocksEqual(r.foldBlocks,o.foldBlocks)}})}},{key:"destroy",value:function(){var e;this.preFoldBlocks=[],this.bindingEvent(!1),null===(e=this.unregister)||void 0===e||e.call(this)}},{key:"detect",value:function(e,n,r){var o,i,c="[".concat(D.a.DocxFold,"]: fold data not same"),a=this.checkFoldBlocksEqual(n,r);a?null===(o=this.vcController)||void 0===o||o.reportReplay(D.s.SUCCESS,e):null===(i=this.vcController)||void 0===i||i.reportReplay(D.s.FAIL,e,c),!a&&Object(j.N)("vc_action_apply_dev",{code:1,info:c,action:D.a.DocxFold,string_param_1:JSON.stringify(r),string_param_2:JSON.stringify(n)})}}]),e}();function F(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return U(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function U(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var H=y()("fold"),V="AFTER_SHOW",W=function(){function e(n,r){var o=this;f()(this,e),this.blockManager=n,this.vcController=r,this.id=Object(_.S)(),this.foldStateMap=new Map,this.foldStatusMap=new Map,this.shouldShowBlockPool=new Set,this.calculatePool=[],this.showPool=new Set,this.subs=void 0,this.pendingInit=new Set,this.pendingUpdate=new Set,this.pendingDestroy=new Map,this.ready=!1,this.vcFollowHelper=void 0,this.isFolded=function(e){return!0===o.foldStatusMap.get(e)},this.isFoldedOrFoldedBy=function(e){return o.isFolded(e)||Boolean(o.findFoldedByBlock(e))},this.isShow=function(e){var n;if(null===(n=o.blockManager.getBlockModelByBlockIdNotCheck(e))||void 0===n?void 0:n.isRoot)return!0;var r=o.foldStateMap.get(e);return!0===(r?r.show:void 0)},this.isShowWithStruct=function(e){return o.foldStateMap.get(e.id)||o.handleInit(e,{isInit:!0}),o.isShow(e.id)},this.cacheIgnoreFoldedIds=[],this.getConfigFromBlockModelPayload=function(e){var n,r,o=e.options;return Object.assign({ignoreFold:(null===(n=o.extra)||void 0===n?void 0:n.ignoreFold)||o.from===g.H.remote,isOnlyHandleComment:null===(r=o.extra)||void 0===r?void 0:r.skipCommentHandleTransaction},o)},this.flushPending=function(e){var n=o.pendingDestroy,r=o.pendingInit,i=o.pendingUpdate;if(n.size||r.size||i.size){var c=o.getConfigFromBlockModelPayload(e);o.pendingDestroy=new Map,o.pendingInit=new Set,o.pendingUpdate=new Set,n.forEach((function(e){var n=e.model,r=e.parent,i=e.prev,a=e.next;o.handleDestroy(n,r,i,a,c)}));var a=new Set;r.forEach((function(e){a.has(e)||o.handleInitInCascading(e,c,a)})),i.forEach((function(e){var n=o.blockManager.getBlockModelByBlockIdNotCheck(e);n&&o.handleUpdate(n,c)}))}},this.handleBlockModelCreate=function(e){var n=e.model.id;o.ready&&(o.pendingDestroy.delete(n),o.pendingUpdate.add(n),o.foldStateMap.has(n)||o.pendingInit.add(n))},this.handleBlockModelDestroy=function(e){var n=e.model;if(o.ready){var r=n.parent,i=n.previousSibling,c=n.nextSibling;o.pendingInit.has(n.id)?o.pendingInit.delete(n.id):o.pendingDestroy.set(n.id,{model:n,parent:r,prev:i,next:c}),o.pendingUpdate.delete(n.id)}},this.handleBlockModelUpdate=function(e){var n=e.model.id;o.ready&&(o.pendingDestroy.has(n)||o.pendingUpdate.add(n))},this.handleReady=function(){o.ready=!0,o.blockManager.getBlockModelByBlockId(o.blockManager.rootBlockId).traverseInDepthFirstPreOrder((function(e){o.handleInit(e,{isInit:!0})}))},this.handleInit=function(e,n){H("init",e.id,e),o.initFoldStatus(e);var r=o.calculateFoldState(e);r&&(!(n.isInPaste||n.isInit||n.ignoreFold||n.from===g.H.silence||Object(O.R)(e.id,o.blockManager,x.r))&&(r.show=!0),o.save(r),n.from===g.H.remote&&x.h.includes(e.type)&&o.checkNext(r))},this.handleDestroy=function(e,n,r,i,c){!(c.isInUndoRedo||c.isInPaste||c.ignoreFold||c.from===g.H.silence||Object(O.R)(e.id,o.blockManager,x.r))&&n&&o.handleBlockShow({topAffectedSib:r,midAffectedSib:i,btmAffectedSib:e}),H("destroy",e.id,e),o.foldStatusMap.delete(e.id),o.foldStateMap.delete(e.id),o.showPool.delete(e.id),o.shouldShowBlockPool.delete(e.id),o.calculatePool=o.calculatePool.filter((function(n){return n!==e.id}));var a=o.calculatePool.indexOf(e.id);a>=0&&o.calculatePool.splice(a,1)},this.handleUpdate=function(){var e=u()(l.a.mark((function e(n,r){var i,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===r||void 0===r?void 0:r.isOnlyHandleComment)){e.next=2;break}return e.abrupt("return");case 2:if(H("update",n.id,n),o.calculatePool.includes(n.id)||(o.foldStatusMap.has(n.id)||o.initFoldStatus(n),o.calculatePool.push(n.id)),i=null===r||void 0===r?void 0:r.isMovingBlock,c=(null===r||void 0===r?void 0:r.isInUndoRedo)||(null===r||void 0===r?void 0:r.from)===g.H.silence||Object(O.R)(n.id,o.blockManager,x.r),a=i||o.isShow(n.id),c||!a){e.next=15;break}return o.shouldShowBlockPool.add(n.id),e.next=11,o.debounceUpdate();case 11:o.forceShowFoldedBlock(n.id,o.blockManager.editable),o.shouldShowBlockPool.delete(n.id),e.next=17;break;case 15:return e.next=17,o.debounceUpdate();case 17:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),this.calculateFoldState=function(n){var r=n.id,i=n.parent,c={isRoot:n.isRoot,relativeId:o.getRelativeBlockId(r),parentId:null===i||void 0===i?void 0:i.id,folded:o.foldStatusMap.get(r)};return e.calculateFoldState(n,c,o.foldStateMap,(function(e){var n;return null===(n=o.blockManager.getBlockModelByBlockIdNotCheck(e))||void 0===n?void 0:n.depth}))},this.doShow=function(){var e,n=[],r=F(o.showPool);try{for(r.s();!(e=r.n()).done;){var i=e.value,c=o.foldStateMap.get(i);if(n.push(c),o.showPool.delete(i),o.blockManager.hasBlockViewByBlockId(i)){var a=o.blockManager.getBlockViewByBlockId(i);a.hostElement&&(c&&o.toggleBlockShow(c,a.hostElement),o.blockManager.dispatch(V,[c],i),o.showPool.delete(i))}}}catch(l){r.e(l)}finally{r.f()}n.length&&(o.blockManager.addListenerOnce(B.m,(function(){n.forEach((function(e){e&&o.isShow(e.id)&&o.blockManager.dispatch(V,[e],e.id)}))})),o.blockManager.dispatch(B.s,[n]))},this.debounceShow=Object(A.p)(this.doShow),this.getRelativeBlockId=function(e){var n=o.blockManager.getBlockModelByBlockId(e),r=n.previousSibling||n.parent;return null===r||void 0===r?void 0:r.id},this.toggleBlockShow=function(e,n){return!!n&&(e.show?n.classList.remove("block-hidden"):n.classList.add("block-hidden"),!0)},this.reCalculateFoldState=function(){for(H("pool length",o.calculatePool.length);o.calculatePool.length>0;){var e=o.calculatePool.shift(),n=o.blockManager.getBlockModelByBlockIdNotCheck(e),r=n&&o.calculateFoldState(n);r&&!o.isEqual(o.foldStateMap.get(e),r)&&(o.save(r),o.checkChildren(r),o.checkNext(r))}},this.debounceUpdate=Object(A.p)(this.reCalculateFoldState),this.handleToggleFold=function(e,n){o.setFoldStatus(e,n),o.debounceUpdate()},this.findFoldedBlocksByStatus=function(e){var n,r=[],i=F(o.foldStatusMap.entries());try{for(i.s();!(n=i.n()).done;){var a=c()(n.value,2),l=a[0];a[1]===e&&r.push(l)}}catch(s){i.e(s)}finally{i.f()}return r},this.handleBlockShow=function(n){var r=n.topAffectedSib,i=n.midAffectedSib,c=n.btmAffectedSib;if(c&&o.handleUpdate(c,{isMovingBlock:!0}),i&&o.handleUpdate(i,{isMovingBlock:!0}),r){var a=o.findFoldedByBlock(null===r||void 0===r?void 0:r.id),l=a&&o.blockManager.getBlockModelByBlockIdNotCheck(a);l&&i&&!i.isDestroyed&&e.isGreaterHeadingLevel(l.type,i.type)&&o.handleUpdate(r,{isMovingBlock:!0})}},this.getFoldBlocksRecordIdByStatus=function(e){return o.findFoldedBlocksByStatus(e).map((function(e){var n;return null===(n=o.blockManager.getRecordByBlockId(e))||void 0===n?void 0:n.id})).filter((function(e){return!!e}))},this.init()}return p()(e,[{key:"init",value:function(){var e=this.blockManager.editorAPI.modelService;this.subs=[e.blockModelCreate$.subscribe(this.handleBlockModelCreate),e.blockModelDestroy$.subscribe(this.handleBlockModelDestroy),e.blockModelUpdate$.subscribe(this.handleBlockModelUpdate),e.initialDataReady$.subscribe(this.handleReady),e.change$.subscribe(this.flushPending)],this.blockManager.addListener(k.Fx,this.handleToggleFold),C.S.on(k.Fx,this.handleToggleFold),this.vcController&&(this.vcFollowHelper=new N(this.blockManager,this.vcController,this.getFoldBlocksRecordIdByStatus,this.findFoldedBlocksByStatus))}},{key:"destroy",value:function(){var e,n;null===(e=this.vcFollowHelper)||void 0===e||e.destroy(),null===(n=this.subs)||void 0===n||n.forEach((function(e){return e.unsubscribe()})),this.blockManager.removeListener(k.Fx,this.handleToggleFold),C.S.off(k.Fx,this.handleToggleFold),this.showPool.clear(),this.shouldShowBlockPool.clear(),this.calculatePool.length=0,this.foldStateMap=new Map,this.foldStatusMap=new Map}},{key:"getFoldStateMap",value:function(){return this.foldStateMap}},{key:"getFoldStateById",value:function(e){return this.foldStateMap.get(e)}},{key:"findFoldedBlocks",value:function(e){var n=this;if(!this.isFolded(e))return[];var r=this.blockManager.getBlockModelByBlockId(e);if(Object(x.q)().includes(r.type)&&!x.O.includes(r.type))return this.blockManager.getBlockModelByBlockId(e).children.map((function(e){return e.id}));if(!r.parent)return[];var o=r.parent.id;if(!o)return[];var i,a=[],l=F(this.foldStateMap.entries());try{for(l.s();!(i=l.n()).done;){var s=c()(i.value,2),u=s[0];if(e===s[1].foldedBy){var d=this.blockManager.getBlockModelByBlockId(u);d.parent&&d.parent.id===o&&a.push(u)}}}catch(f){l.e(f)}finally{l.f()}return a.sort((function(e,r){return n.blockManager.getBlockModelByBlockId(e).position>n.blockManager.getBlockModelByBlockId(r).position?1:-1}))}},{key:"findFoldedByBlock",value:function(e){var n=this.foldStateMap.get(e);if(n&&!n.show)return n.foldedBy}},{key:"isAncestorOf",value:function(e,n){var r;if(e===n)return!1;for(var o=null===(r=this.blockManager.getBlockModelByBlockIdNotCheck(n))||void 0===r?void 0:r.parent;o;){var i=o.id;if(i===e)return!0;o=this.blockManager.getBlockModelByBlockId(i).parent}return!1}},{key:"findClosestFoldsByBlock",value:function(n){var r,o=[],i=this.foldStateMap.get(n),c=null===(r=i)||void 0===r?void 0:r.type,a=!1;for(this.shouldShowBlockPool.has(n)&&(a=!0);i&&(a||!i.show)&&i.closestFolderId;){var l=i,s=l.closestFolderId,u=l.id;if(a=!1,i=this.foldStateMap.get(s)){var d=e.isGreaterHeadingLevel(i.type,c),f=this.isAncestorOf(s,u);!d&&!f||this.isShow(i.id)&&!i.folded||(o.push(s),c=i.type)}}return o}},{key:"waitUntilBlockShow",value:function(e,n){var r=this;return new Promise((function(o){var i=null,c=function n(c){c&&c.show&&(i&&window.clearTimeout(i),r.blockManager.removeListener(V,n,e),o())};r.blockManager.addListener(V,c,e),"number"===typeof n&&(i=window.setTimeout((function(){r.blockManager.removeListener(V,c,e),o()}),n))}))}},{key:"waitUntilBlocksUnfold",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;return new Promise((function(o){var i=new Set(e.filter((function(e){var r;return null===(r=n.foldStateMap.get(e))||void 0===r?void 0:r.folded})));if(!i.size)return o();var c=null,a=function e(r){r&&!r.folded&&(i.delete(r.id),i.size||(c&&window.clearTimeout(c),n.blockManager.removeListener(B.w,e),o()))};n.blockManager.addListener(B.w,a),"number"===typeof r&&(c=window.setTimeout((function(){n.blockManager.removeListener(B.w,a),o()}),r))}))}},{key:"enterIgnoreMode",value:function(){var e=this,n=this.findFoldedBlocksByStatus(!0);this.cacheIgnoreFoldedIds=n,n.forEach((function(n){return e.handleToggleFold(n,!1)}))}},{key:"exitIgnoreMode",value:function(){var e=this;this.cacheIgnoreFoldedIds.length&&this.cacheIgnoreFoldedIds.forEach((function(n){return e.handleToggleFold(n,!0)}))}},{key:"handleInitInCascading",value:function(e,n,r){for(var o=[];e&&!this.foldStateMap.has(e);){var i=this.blockManager.getBlockModelByBlockIdNotCheck(e);if(!i||i.isRoot||!i.record.snapshot.type)break;o.push(i),e=this.getRelativeBlockId(i.id)}for(;o.length;){var c=o.pop();r.add(c.id),this.handleInit(c,n)}}},{key:"initFoldStatus",value:function(e){var n,r=Object(A.B)(e);"boolean"===typeof r&&(this.initSetFoldStatus(e.id,r),null===(n=this.vcFollowHelper)||void 0===n||n.handleFoldChange())}},{key:"save",value:function(e){var n=this.foldStateMap.get(e.id);Object(m.isEqual)(n,e)||(H("\u4fdd\u5b58\u8ba1\u7b97\u7ed3\u679c",e.id,e),Object(S.C)()&&!n||(null===n||void 0===n?void 0:n.show)===e.show&&(null===n||void 0===n?void 0:n.folded)===e.folded||(this.showPool.add(e.id),this.debounceShow()),this.foldStateMap.set(e.id,e),I.W.setFoldState$.next(e),this.blockManager.dispatch(B.w,e,e.id),this.blockManager.dispatch(B.w,e),this.blockManager.hasBlockViewByBlockId(e.id)&&this.blockManager.getBlockViewByBlockId(e.id).onFoldStateChange(e))}},{key:"isEqual",value:function(e,n){return null===e&&null===n||(void 0===e&&void 0===n||!(!e||!n)&&Object.keys(e).every((function(r){return e[r]===n[r]})))}},{key:"checkChildren",value:function(e){var n=this.blockManager.getBlockModelByBlockId(e.id);n.children[0]&&this.calculatePool.push(n.children[0].id)}},{key:"checkNext",value:function(e){var n=this.blockManager.getBlockModelByBlockId(e.id);n.nextSibling&&this.calculatePool.push(n.nextSibling.id)}},{key:"initSetFoldStatus",value:function(e,n){this.foldStatusMap.set(e,n)}},{key:"setFoldStatus",value:function(e,n){n!==this.foldStatusMap.get(e)&&(this.initSetFoldStatus(e,n),this.calculatePool.includes(e)||this.calculatePool.push(e),I.W.setFoldStatus$.next({blockId:e,folded:n}))}},{key:"forceShowFoldedBlock",value:function(e,n){var r,o=this;if(!this.isShow(e)||this.shouldShowBlockPool.has(e)){var i=this.findClosestFoldsByBlock(e);if(i.length)return i.forEach((function(e){o.setFoldStatus(e,!1),n?o.blockManager.applyTransaction(k.Fx,(function(n){var r=o.blockManager.getRecordByBlockId(e).id;n.replace(r,["folded"],!1)})):C.S.emit(C.p.COMMON.FOLD_CHANGED_READONLY,{blockId:e,folded:!1})})),this.debounceUpdate(),null===(r=this.vcFollowHelper)||void 0===r||r.handleFoldChange(),this.waitUntilBlockShow(e)}}},{key:"forceShowFoldedBlockByItself",value:function(e){this.handleToggleFold(e,!1)}},{key:"forceShowAllFoldedBlock",value:function(){var e=this;this.findFoldedBlocksByStatus(!0).forEach((function(n){e.forceShowFoldedBlockByItself(n)}))}}],[{key:"initFoldState",value:function(e){var n=e.id,r=e.type,o=void 0===r?"":r,i=e.show,c=e.foldStatus,a={show:i,type:o,id:n,foldedBy:e.foldedBy,foldedByType:e.foldedByType};return"boolean"===typeof c&&(a.folded=c),a}},{key:"extendFoldState",value:function(n,r,o){var i=n.id,c=n.type,a=void 0===c?"":c,l=n.foldStatus,s=n.parentId,u=r.show,d=r.folded,f=r.foldedBy,h=r.foldedByType,p=r.type,v=r.id,g={id:i,type:a,closestFolderId:r.closestFolderId,foldedBy:r.foldedBy,foldedByType:r.foldedByType,show:r.show};return e.isGreaterHeadingLevel(p,n.type)&&(g.show=u?!d:u,d&&(g.foldedBy=f||v,g.foldedByType=h||p)),v===s&&"boolean"===typeof d&&(g.closestFolderId=v,!0===u&&(g.show=!d,d&&(g.foldedBy=v,g.foldedByType=p))),p.includes("heading")&&(g.closestFolderId=v),"boolean"===typeof l&&(g.folded=l),(null===o||void 0===o?void 0:o.has(i))&&(g.show=!0),g}},{key:"isGreaterHeadingLevel",value:function(e,n){var r=Object(O.V)(e),o=Object(O.V)(n);return null!==r&&(null===o||r<o)}}]),e}();W.calculateFoldState=function(e,n,r,o){var i,c=e.id,a=e.type,l=void 0===a?"":a,s=e.depth,u=n.isRoot,d=n.relativeId,f=n.parentId,h=void 0===f?v.V:f,p=n.folded;if(!u&&l){var g=p;g&&Object(A.s)(e,x.r)&&(g=!1);var b=d?r.get(d):void 0,y=null===(i=null===b||void 0===b?void 0:b.show)||void 0===i||i,m=null===b||void 0===b?void 0:b.foldedBy;if(m){var _,k=o(m),O=r.get(m);if("number"===typeof k&&s<=k)y=null!==(_=null===O||void 0===O?void 0:O.show)&&void 0!==_?_:y}return H("\u8ba1\u7b97\u6298\u53e0\u72b6\u6001",c),W.createFoldState({model:e,id:c,type:l,show:y,foldStatus:g,foldedBy:y?void 0:m,foldedByType:y||null===b||void 0===b?void 0:b.foldedByType,parentId:h},b)}},W.createFoldState=function(e,n){if(!n)return W.initFoldState(e);if(Object(A.s)(e.model,x.B.OKR))return W.initFoldState(e);var r=Object(E.l)(e.type),o=Object(O.V)(e.type),i=Object(O.V)(n.foldedByType||n.type),c=e.parentId!==n.id;return e.show&&c&&r&&i&&o<=i?W.initFoldState(e):W.extendFoldState(e,n)}},dx_MQsy:function(e,n,r){"use strict";r.d(n,"o",(function(){return V}));var o=r("dx_yG8O"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_PJYZ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_Uyc2"),m=r.n(y),_=(r("dx_A1AB"),r("dx_o0o1")),k=r.n(_),O=r("dx_yXPU"),x=r.n(O),E=r("dx_Vvd7"),S=r("dx_xjz2"),C=r("dx_nAwp"),I=r("dx_XCzS"),B=r("dx_N9dL"),T=r("dx_B28d"),w=r("dx_fEKD");var R,M,j,D,A,P,L=r("dx_KMlW"),N=r("dx_h8uR"),F=r("dx_Ykhn"),U=r("dx_t3tJ");function H(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var V=(R=Object(E.H)({providers:[{provide:N.b,useAsync:function(){var e=x()(k.a.mark((function e(){var n,o;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.e("dx_uwU3").then(r.bind(null,"dx_ReZS"));case 2:return n=e.sent,o=n.AuthConnector,e.abrupt("return",{provide:o,useValue:o.getInstance()});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{provide:B.RecordSnapshotCreator,useValue:{type:T.B.JIRA_ISSUE,create:function(e,n){return Object(w.b)(e,n)}}},{provide:C.T,useFactory:function(){return new C.T}}]}),M=Object(S.p)(),R((P=function(e){h()(r,e);var n=H(r);function r(){var e;a()(this,r);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return(e=n.call.apply(n,[this].concat(c))).blocks=[[L.S,{viewCreator:U.S}]],i()(e,"jiraAuthConnectorLoader",A,d()(e)),e}return s()(r,[{key:"init",value:function(){var e=x()(k.a.mark((function e(){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.jiraAuthConnectorLoader;case 2:if(n=e.sent,Object(I.P)()){e.next=5;break}return e.abrupt("return");case 5:n.setAuthInfo(F.e.Jira),n.fetchAuthStatus();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(E.y),D=P,A=m()(D.prototype,"jiraAuthConnectorLoader",[M,N.b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=D))||j)},dx_MUMK:function(e,n,r){"use strict";var o,i,c,a,l;r.d(n,"F",(function(){return o})),r.d(n,"K",(function(){return i})),r.d(n,"j",(function(){return c})),r.d(n,"f",(function(){return a})),r.d(n,"Fr",(function(){return l})),function(e){e.onArrowUp="onArrowUp",e.onArrowDown="onArrowDown",e.onArrowLeft="onArrowLeft",e.onArrowRight="onArrowRight",e.onShiftArrowUp="onShiftArrowUp",e.onShiftArrowDown="onShiftArrowDown",e.onShiftArrowLeft="onShiftArrowLeft",e.onShiftArrowRight="onShiftArrowRight",e.onAltShiftArrowUp="onAltShiftArrowUp",e.onAltShiftArrowDown="onAltShiftArrowDown",e.onAltShiftArrowLeft="onAltShiftArrowLeft",e.onAltShiftArrowRight="onAltShiftArrowRight",e.onDelete="onDelete",e.onBackspace="onBackspace",e.onDeleteWord="onDeleteWord",e.onBackspaceWord="onBackspaceWord",e.onEnter="onEnter",e.onShiftEnter="onShiftEnter",e.onTab="onTab",e.onUnTab="onUnTab",e.onBold="onBold",e.onItalic="onItalic",e.onUnderline="onUnderline",e.onStrikeThrough="onStrikeThrough",e.onTextHighlight="onTextHighlight",e.onLink="onLink",e.onInlineCode="onInlineCode",e.onMetaEnter="onMetaEnter",e.onSelectAll="onSelectAll",e.onKeyDown="onKeyDown",e.onNewPage="onNewPage",e.onInsertTable="onInsertTable",e.onTurnIntoHeading1="onTurnIntoHeading1",e.onTurnIntoHeading2="onTurnIntoHeading2",e.onTurnIntoHeading3="onTurnIntoHeading3",e.onTurnIntoHeading4="onTurnIntoHeading4",e.onTurnIntoHeading5="onTurnIntoHeading5",e.onTurnIntoHeading6="onTurnIntoHeading6",e.onTurnIntoHeading7="onTurnIntoHeading7",e.onTurnIntoHeading8="onTurnIntoHeading8",e.onTurnIntoHeading9="onTurnIntoHeading9",e.onTurnIntoOrdered="onTurnIntoOrdered",e.onTurnIntoBullet="onTurnIntoBullet",e.onTurnIntoTask="onTurnIntoTask",e.onTurnIntoQuote="onTurnIntoQuote",e.onTurnIntoCode="onTurnIntoCode",e.onTurnIntoText="onTurnIntoText",e.onTurnIntoCallout="onTurnIntoCallout",e.onAddReminder="onAddReminder",e.onAddDivider="onAddDivider",e.onMetaShiftEnter="onMetaShiftEnter",e.onShiftCmdUp="onShiftCmdUp",e.onShiftCtrlUp="onShiftCtrlUp",e.onShiftCtrlDown="onShiftCtrlDown",e.onShiftCmdDown="onShiftCmdDown",e.onExit="onExit",e.onCollapse="onCollapse",e.onExpand="onExpand",e.onToggleTask="onToggleTask",e.onMinus="onMinus",e.onComment="onComment",e.onSave="onSave",e.TextAlignLeft="textAlignLeft",e.TextAlignCenter="textAlignCenter",e.TextAlignRight="textAlignRight",e.onFind="onFind",e.onReplace="onReplace",e.onPresentationMode="onPresentationMode",e.onHelpSiderbar="onHelpSiderbar",e.onCopy="onCopy",e.onCut="onCut",e.onCtrlUp="onCtrlUp",e.onCtrlDown="onCtrlDown",e.onCtrlLeft="onCtrlLeft",e.onCtrlRight="onCtrlRight",e.onAdvancedSearch="onAdvancedSearch",e.onTurnIntoQuoteContainer="onTurnIntoQuoteContainer",e.onCmdUp="onCmdUp",e.onCmdDown="onCmdDown"}(o||(o={})),function(e){e.alignLeft="textAlignLeft",e.alignRight="textAlignRight",e.alignCenter="textAlignCenter",e.inlineCode="onInlineCode",e.h1="onTurnIntoHeading1",e.h2="onTurnIntoHeading2",e.h3="onTurnIntoHeading3",e.h4="onTurnIntoHeading4",e.h5="onTurnIntoHeading5",e.h6="onTurnIntoHeading6",e.h7="onTurnIntoHeading7",e.h8="onTurnIntoHeading8",e.h9="onTurnIntoHeading9",e.normalText="onTurnIntoText",e.orderedList="onTurnIntoOrdered",e.unorderedList="onTurnIntoBullet",e.checkbox="onTurnIntoTask",e.blockQuote="onTurnIntoQuote",e.strikethrough="onStrikeThrough",e.codeList="onTurnIntoCode",e.selectAllBlock="onSelectAll",e.moveDownBlock="onShiftCtrlDown",e.moveUpBlock="onShiftCtrlUp",e.commentAction="onComment",e.insertSeparator="onAddDivider",e.textHighLight="onTextHighlight"}(i||(i={})),function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"}(c||(c={})),function(e){e.startTab="start_tab",e.blockTab="block_tab",e.untab="untab",e.unalign="unalign",e.deleteText="delete_text",e.deleteBlock="delete_block"}(a||(a={})),function(e){e.Head="Head",e.Tail="Tail"}(l||(l={}))},dx_MUhB:function(e,n,r){"use strict";r.d(n,"w",(function(){return l})),r.d(n,"q",(function(){return s})),r.d(n,"E",(function(){return u})),r.d(n,"P",(function(){return d})),r.d(n,"t",(function(){return f}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_uxuX"),a=r("dx_UtDZ");function l(){a.statSuccess.apply(void 0,arguments)}function s(){a.statFail.apply(void 0,arguments)}function u(){a.statIgnore.apply(void 0,arguments)}function d(e,n,r,o){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.01,a=arguments.length>5?arguments[5]:void 0,l=Object.keys(e),s=Object.keys(n),u=function(o){return!!(null===a||void 0===a?void 0:a(o))||Math.abs((r(e,o)||0)-(r(n,o)||0))<=c};if(!l.length||!s.length)return!0;var d=s;if(o){var f=o.layoutManager.getViewportBlocks();if(!f.length)return!0;d=s.filter((function(e){var n=o.getBlockIdsByRecordId(e),r=i()(n,1)[0];return!!r&&f.includes(r)}))}return d.every(u)}function f(e,n){a.EventEmitter.emit("".concat(c.FOLLOW_EVENT,":").concat(c.FOLLOW_LOG),{level:"info",message:"[DOCX] - ".concat(e,": ").concat(n)})}},dx_MWd8:function(e,n,r){"use strict";r.d(n,"O",(function(){return c})),r.d(n,"f",(function(){return a})),r.d(n,"J",(function(){return l}));var o=r("dx_Zss7"),i=r.n(o);function c(e){return i()(e).toRgb()}function a(e,n){var r=i()(e);return"number"===typeof n&&r.setAlpha(n),r.toRgbString().replace(/\s+/g,"")}function l(e,n){var r=i()(e),o=i()(n);return r.toRgbString().replace(/\s+/g,"")===o.toRgbString().replace(/\s+/g,"")}},dx_MYIx:function(e,n,r){"use strict";var o=r("dx_MQsy");r.d(n,"o",(function(){return o.o}))},dx_MZZR:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8 15c3.643 0 6.667-1.343 6.667-3.315v-7.37C14.667 2.343 11.643 1 8 1S1.333 2.343 1.333 4.315v7.37C1.333 13.657 4.357 15 8 15zM2.603 4.315c0-.99 2.378-2.045 5.397-2.045 3.02 0 5.397 1.056 5.397 2.045v.03l-.001.001c-.05.98-2.409 2.014-5.396 2.014-3.02 0-5.397-1.056-5.397-2.045zm0 2C3.822 7.139 5.798 7.63 8 7.63c2.203 0 4.178-.491 5.397-1.315v1.713c-.045.98-2.406 2.017-5.397 2.017-2.962 0-5.306-1.016-5.394-1.989l-.003-.002v-1.74zm10.794 5.37V10c-1.219.824-3.194 1.315-5.397 1.315-2.202 0-4.178-.491-5.397-1.315v1.685c0 .99 2.378 2.045 5.397 2.045 3.02 0 5.397-1.056 5.397-2.045z",fill:"currentColor"});n.S=function(e){return i.a.createElement("svg",c({width:16,height:16,viewBox:"0 0 16 16",fill:"none"},e),a)}},dx_Md2h:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("g",{fill:"none",fillRule:"evenodd"},i.a.createElement("path",{fill:"#DEE0E3",d:"M57.407 8.114L6.539 17.083l8.263 46.86 50.867-8.97z"}),i.a.createElement("path",{fill:"#F5F6F7",d:"M21.913 19.722H61.67v38.191H21.913z"}),i.a.createElement("path",{fill:"#C3C6CB",fillRule:"nonzero",d:"M28.174 28.033h27.235v-1.125H28.174zm0 5.009h27.235v-1.125H28.174zm0 5.1h27.235v-1.125H28.174zm0 5.009h17.374v-1.125H28.174z"}),i.a.createElement("g",{transform:"translate(46 46)"},i.a.createElement("path",{fill:"#FFC60A",d:"M0 9a9 9 0 009 9 9 9 0 009-9 9 9 0 00-9-9 9 9 0 00-9 9z"}),i.a.createElement("rect",{width:1.688,height:1.688,x:8.156,y:11.813,fill:"#FFF",rx:.5}),i.a.createElement("rect",{width:1.688,height:5.625,x:8.156,y:4.5,fill:"#FFF",rx:.5})));n.S=function(e){return i.a.createElement("svg",c({width:72,height:72,viewBox:"0 0 72 72"},e),a)}},dx_MhLi:function(e,n,r){"use strict";r.d(n,"I",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("layout-node-builder")},dx_Mi7c:function(e,n){},dx_MiPk:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return m}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_TXb2"),l=r("dx_YOcb"),s=r("dx_ABAR"),u=r("dx_PcQO"),d=r("dx_cDcd"),f=r.n(d),h=r("dx_zEdG"),p=r("dx_CwnG"),v=r("dx_r61a"),g=r("dx_G6GV"),b=r("dx_XlRC"),y="list-modify-menu";function m(e){var n=e.blockManager,r=e.blockId,i=e.recordId,m=e.updateCanShowInput,_=e.updateVisible,k=Object(d.useMemo)((function(){return Object(b.x)(n,r)}),[n,r]),O=Object(d.useMemo)((function(){return{continueEnable:!(!Object(b.A)(n,r,v.b.UP)||!((null===k||void 0===k?void 0:k.isHeader)||Object(b.q)(n.getBlockModelByBlockId(r))&&1===(null===k||void 0===k?void 0:k.order))),createEnable:1!==(null===k||void 0===k?void 0:k.order)}}),[n,r,k]),x=O.continueEnable,E=O.createEnable,S=Object(d.useCallback)(c()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.applyTransaction("list:modify:continue",(function(e){e.replace(i,["seq"],"auto"),Object(g.L)(r,e,n)}));case 2:_(!1);case 3:case"end":return e.stop()}}),e)}))),[n,r]),C=Object(d.useCallback)(c()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.applyTransaction("list:modify:create",(function(e){e.replace(i,["seq"],"1"),Object(g.L)(r,e,n)}));case 2:_(!1);case 3:case"end":return e.stop()}}),e)}))),[n,r]),I=Object(d.useCallback)((function(){m(!0)}),[]),B=Object(d.useCallback)((function(e){var o={continue:"click_continue_number",create:"click_create_number",renumber:"click_edit_number"}[e],i=Object(p.m)(r,n);Object(h.P)("ccm_doc_ordered_set_number_click",i,{click:o,target:"none",sub_view:"ordered"})}),[n,r]),T=Object(d.useCallback)((function(e){var n=e.key;"continue"===n?S():"create"===n?C():"renumber"===n&&I(),B(n)}),[S,C,I,B]),w=[{key:"continue",disabled:!x,Icon:a.S,text:t("doc.list.continue_numbering")},{key:"create",disabled:!E,Icon:l.S,text:t("doc.list.start_a_new_list")},{key:"renumber",disabled:!1,Icon:s.S,text:t("doc.list.restart_numbering")}];return Object(d.useEffect)((function(){var e=Object(p.m)(r,n);Object(h.T)("ccm_doc_ordered_set_number_view",e,{is_support_continue_number:x?"true":"false",is_support_create_number:E?"true":"false",is_support_edit_number:"true",sub_view:"ordered"})}),[n,r,x,E]),f.a.createElement(u.Menu,{selectable:!1,className:"".concat(y),onClick:T},w.map((function(e){var n=e.key,r=e.disabled,o=e.Icon,i=e.text;return f.a.createElement(u.Menu.Item,{className:"".concat(y,"-item"),icon:f.a.createElement(o,{className:"".concat(y,"-icon")}),key:n,disabled:r},i)})))}}).call(this,r("dx_E9Eu"))},dx_Mj0E:function(e,n,r){"use strict";r.d(n,"Z",(function(){return _})),r.d(n,"Q",(function(){return k}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_UtDZ"),d=r("dx_hDVN"),f=r("dx_Sj0J"),h=r("dx_FH1m"),p=r("dx_Wkzy"),v=r("dx_bWl7"),g=r("dx_kZ3l"),b=r("dx_fEKD"),y=r("dx_B28d"),m=r("dx_nWLU");function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.B.BITABLE;return Object(b.b)(e,n)}function k(e){return O.apply(this,arguments)}function O(){return(O=s()(i.a.mark((function e(n){var r,o,c,l,s,b,_,k,O,x,E,S,C,I,B,T,w;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(u.isOnline)()){e.next=3;break}return console.error("[bitable] insertBitable failed when offline"),e.abrupt("return",{code:m.W.offlineError});case 3:if(r=n.viewType,o=n.blocks,c=n.blockManager,l=n.isAppend,s=n.mark,b=a()(o,1),_=b[0],k="",O=_,!l){e.next=12;break}return x={blockManager:c,blocks:o,newBlockType:y.B.TEXT},e.next=11,Object(d.S)(x);case 11:O=e.sent;case 12:return E=Object(f.N)(O,null!==s&&void 0!==s?s:{}),S=c.editorAPI.getService(p.x).getBridge(""),e.next=16,Object(h.q)(c,O,g.S(E),c.createInitModel(y.B.BITABLE,{token:k,createdSource:u.CreatedSource.USER_INSERT}));case 16:if(C=e.sent,console.info("[bitable] insertBitable:".concat(C)),C){e.next=20;break}return e.abrupt("return",{code:m.W.insertBlockError});case 20:return I=c.getBlockModelByBlockId(C),B=I.record.id,e.prev=22,e.next=25,null===S||void 0===S?void 0:S.addBitableBlock(B,r);case 25:if(e.t0=e.sent,e.t0){e.next=28;break}e.t0="";case 28:if(k=e.t0){e.next=31;break}return e.abrupt("return",{code:m.W.createTokenError});case 31:return T=Object(v.U)(k),w=T.token,e.next=34,null===S||void 0===S?void 0:S.loadBitableManager(w);case 34:c.editorAPI.getService(p.x).setNewInsertBlockMap(k),e.next=42;break;case 37:return e.prev=37,e.t1=e.catch(22),console.error("[bitable] addBitableBlock error",e.t1),c.hasBlockModelByBlockId(C)&&c.applyTransaction("deleteBitableBlock",(function(e){C&&e.removeChildren(I.parent.record.id,[B])})),e.abrupt("return",{code:m.W.createTokenError,error:e.t1});case 42:return c.applyTransaction("updateBitableBlock",(function(e){var n;try{n=c.getRecordByBlockId(C).id}catch(o){console.error("[bitable] getRecordByBlockId error",o);var r=Object(v.U)(k).id;return void(S&&r&&S.delBitableBlock(C,r))}e.replace(n,["token"],k)}),{undoable:!1}),c.editorAPI.getService(p.x).setBitableToken(k,B),e.abrupt("return",{code:m.W.success,newBlockId:C});case 45:case"end":return e.stop()}}),e,null,[[22,37]])})))).apply(this,arguments)}},dx_MlBN:function(e,n,r){},dx_MlPX:function(e,n,r){"use strict";var o;r.d(n,"g",(function(){return o})),function(e){e.LAYOUT_ITEM_CHANGE="LAYOUT_ITEM_CHANGE",e.LAYOUT_CHANGE="LAYOUT_CHANGE",e.DOC_COMMENT_SHOW_CHANGE="DOC_COMMENT_SHOW_CHANGE",e.DOC_COMMENT_SHOW_CHANGE_TRANSITION_END="DOC_COMMENT_SHOW_CHANGE_TRANSITION_END",e.CONTENT_OFFSET_CHANGED="CONTENT_OFFSET_CHANGED"}(o||(o={}))},dx_MmkF:function(e,n,r){"use strict";r.d(n,"f",(function(){return i}));var o=r("dx_yzqx");function i(e){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];if(!window._isDev&&o.S.isMobile){var c=function(e,n,o){var i="string"===typeof n?n:JSON.stringify(n);return"".concat(e," ").concat(i).concat(o===r.length-1?"":",")};console.info("".concat(r.reduce(c,"[".concat(e,"]"))))}else{var a;(a=console).log.apply(a,["[".concat(e,"]")].concat(r))}}}},dx_Mnld:function(e,n,r){"use strict";(function(t){r.d(n,"q",(function(){return e})),r.d(n,"v",(function(){return o}));var e={unrecognizedToast:t("CreationDoc_Docs_WebBookmark_Unrecognized_Toast"),unsupportToast:t("CreationDoc_Docs_WebBookmark_UnsupportWebInfo_Toast"),cannotPreviewToast:t("CreationDoc_Docs_WebBookmark_CannotPreview_Toast"),wrongLinkToast:t("CreationDoc_Docs_WebBookmark_WrongLink_Toast"),offlineToast:t("CreationDoc_Docs_WebBookmark_LostConnect_Toast")},o={FEISHU:"https://www.feishu.cn/",LARK:"https://www.larksuite.com/"}}).call(this,r("dx_E9Eu"))},dx_MoY1:function(e,n,r){"use strict";r.d(n,"y",(function(){return l})),r.d(n,"l",(function(){return s})),r.d(n,"t",(function(){return u})),r.d(n,"T",(function(){return d})),r.d(n,"s",(function(){return f}));var o=r("dx_UtDZ"),i=r("dx_h6a8"),c=r("dx_Fimk"),a=r("dx_ppc6");function l(e,n,r){Object(i.isObject)(n[0])||(n=n.map((function(e){return r.getBlockModelByBlockIdNotCheck(e)})).filter((function(e){return!!e}))),n.forEach((function(n){var r=n.parent,l=r.record.get(["children"]);if(!Object(i.isArray)(l)||-1===l.indexOf(n.recordId)){var s,u=n.editorAPI.getService(a.S).getSelection().map((function(e){var r=n.editorAPI.modelService.getBlockModelByBlockId(e.id);return r?{id:r.id,type:r.type,selType:e.type,selection:e.selection||null}:null}));Object(c.S)("doc_bug_track_mobile",{action:"remove_blocks_failed",info:JSON.stringify({blockId:n.id,recordId:Object(o.encryptTea)(n.recordId),blockType:n.type,parentId:r.id,parentType:r.type,children:Object(i.isArray)(l)?l.map((function(e){return Object(o.encryptTea)(e)})):l,isDestroyed:n.isDestroyed,modelChildren:null===(s=r.children)||void 0===s?void 0:s.map((function(e){return Object(o.encryptTea)(null===e||void 0===e?void 0:e.recordId)})),selection:u})})}e.removeChildren(r.recordId,[n.recordId])}))}function s(e,n,r,o){var i=e.createChildren(o.map((function(e){return Object.assign({parent_id:n},e)})));return e.insertChildren(n,r,i),i}function u(e,n,r,o){return e.insertChildren(n,r,o),o.forEach((function(r){e.replace(r,["parent_id"],n)})),o}function d(e,n,r,o){var c=o.map((function(r){return Object(i.isString)(r)?(e.replace(r,["parent_id"],n),r):e.create(Object.assign({parent_id:n},r))}));return e.insertChildren(n,r,c),c}function f(e,n,r){return e.create(Object.assign({parent_id:n},r))}},dx_MsqB:function(e,n,r){"use strict";r.d(n,"TaskBlockStatus",(function(){return o})),r.d(n,"FetchedStatus",(function(){return i}));var o,i;r("dx_RKa4");!function(e){e[e.New=0]="New",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized",e[e.Failed=3]="Failed"}(o||(o={})),function(e){e[e.none=0]="none",e[e.fetchting=1]="fetchting",e[e.success=2]="success",e[e.fail=3]="fail"}(i||(i={}))},dx_Mtob:function(e,n,r){"use strict";r.d(n,"m",(function(){return o})),r.d(n,"F",(function(){return i})),r.d(n,"a",(function(){return c})),r.d(n,"j",(function(){return a})),r.d(n,"R",(function(){return l})),r.d(n,"u",(function(){return s}));var o=r("dx_rQGm").L,i=50,c=32,a=10485760,l="mmbiz.qpic.cn",s="wx_"},dx_MuBQ:function(e,n,r){"use strict";var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_UtDZ"),s=r("dx_AA3h"),u=r("dx_yzqx"),d=function(){function e(){i()(this,e)}return a()(e,[{key:"initUserPermission",value:function(){u.S.isMobile&&(null===s.suiteUserManager||void 0===s.suiteUserManager||s.suiteUserManager.rebuildUserPermissionManager(!0))}},{key:"addUserPermission",value:function(e){l.suiteUserManager.addUser(e)}},{key:"removeUserPermission",value:function(e){l.suiteUserManager.removeUser(e)}}]),e}();n.S=new d},dx_Mzjv:function(e,n,r){"use strict";var o,i,c,a,l;r.d(n,"R",(function(){return o})),r.d(n,"c",(function(){return i})),r.d(n,"e",(function(){return c})),r.d(n,"w",(function(){return a})),r.d(n,"f",(function(){return l})),function(e){e.LeftTextCenter="leftTextCenter",e.RightTextCenter="rightTextCenter",e.LeftCenter="leftCenter",e.RightCenter="rightCenter",e.BottomLeft="bottomLeft",e.TopLeft="topLeft",e.BottomRight="bottomRight",e.TopRight="topRight",e.BottomCenter="bottomCenter",e.TopCenter="topCenter",e.None="none"}(o||(o={})),function(e){e[e.Top=0]="Top",e[e.Middle=1]="Middle",e[e.Bottom=2]="Bottom"}(i||(i={})),function(e){e.Slide="slide",e.Fade="fade",e.None="none"}(c||(c={})),function(e){e.SlideTop="slide-top",e.SlideBottom="slide-bottom",e.SlideLeft="slide-left",e.SlideRight="slide-right",e.Fade="delay-show",e.None="no-animation"}(a||(a={})),function(e){e.None="none",e.StickTop="stickyTop",e.Fixed="fixed",e.StickBottom="stickBottom",e.OutBox="outBox"}(l||(l={}))},dx_N03N:function(e,n,r){"use strict";r.d(n,"n",(function(){return s}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r("dx_a7X6"),l=r("dx_D8nn"),s=function(e){var n=Object(c.useState)(void 0),r=i()(n,2),o=r[0],s=r[1],u=Object(c.useCallback)((function(n){var r=n.get(e);s(r)}),[e]);return Object(c.useEffect)((function(){return u(a.h.counterIndexMap),l.S.on(l.p.COMMON.EQUATION_COUNTER_INDEX_UPDATE,u),function(){l.S.off(l.p.COMMON.EQUATION_COUNTER_INDEX_UPDATE,u)}}),[u]),o}},dx_N1aH:function(e,n,r){},dx_N25N:function(e,n,r){"use strict";r.d(n,"X",(function(){return o}));var o="ignore-enter-edit"},dx_N2Hh:function(e,n,r){"use strict";r.d(n,"e",(function(){return D})),r.d(n,"T",(function(){return N}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_NOtv"),v=r.n(p),g=r("dx_h6a8"),b=r("dx_yzqx");function y(e){var n,r,o,i=e.startContainer,c=e.endContainer,a=e.collapsed;return!!(i===c&&(null===i||void 0===i?void 0:i.parentNode)instanceof Element&&(null===(n=i.parentNode.parentElement)||void 0===n?void 0:n.classList.contains("docx-block-zero-space"))&&a)&&!!(null===(r=i.parentNode)||void 0===r||null===(o=r.attributes)||void 0===o?void 0:o["data-zero-space"])}var m=r("dx_B28d"),_=r("dx_ZG9w"),k=r("dx_FNDK"),O=r("dx_P58d"),x=r("dx_qHDV"),E=r("dx_iw8O"),S=r("dx_D8nn"),C=new function e(){var n=this;i()(this,e),this.visible=!1,this.swiping=!1,this.inMotion=!1,this.setVisible=function(e){n.visible=e},this.setSwiping=function(e){n.swiping=e},this.setInMotion=function(e){n.inMotion=e},this.isVisible=function(){return n.visible||n.isSwiping()},this.isRunning=function(){return n.visible||n.isInMotion()},this.isSwiping=function(){return n.swiping},this.isInMotion=function(){return n.swiping||n.inMotion}},I=r("dx_rQGm");function B(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return T(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function T(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function w(e){var n=e.endContainer,r=e.endOffset;if(!(n instanceof HTMLElement))return null;if(!n.closest(".docx-okr-block"))return null;var o,i=null,c=B(Array.from(n.childNodes).splice(0,r).reverse());try{for(c.s();!(o=c.n()).done;){var a=o.value;if(a instanceof HTMLElement){var l=a.querySelectorAll("[".concat(I.aO,"]"));if(l.length){i=l[l.length-1];break}}}}catch(s){c.e(s)}finally{c.f()}return i}var R=r("dx_Ph9x");function M(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var j=v()("multiTextSelection"),D=[m.B.TABLE,m.B.CELL,m.B.CALLOUT,m.B.QUOTE_CONTAINER,m.B.OKR,m.B.OBJECTIVE,m.B.KEY_RESULT,m.B.PROGRESS,m.B.TASK],A=[m.B.CELL],P=[m.B.OBJECTIVE,m.B.KEY_RESULT,m.B.PROGRESS],L=["column-gap-inner"],N=function(e){s()(r,e);var n=M(r);function r(e){var o;i()(this,r),(o=n.call(this,e)).unSelectableType=[],o.prevSelection=[],o.tmpPrevSelection=[],o.selectionUpdated=void 0,o.contextMenuSelChangeCount=0,o.isContextMenu=!1,o.onStart=function(e){o.prevSelection=o.context.getSelection()},o.onStop=function(e){var n=o.context.selectionContext.intersectSelectedBlocksMap.get(m.B.CELL);if(o.selectionUpdated&&!(null===n||void 0===n?void 0:n.length)){var r=o.tmpPrevSelection;o.context.store.stored=o.prevSelection,Object(k.E4)(r)&&(r=r.filter((function(e){return e.type===O.j.BLOCK}))),o.context.setSelection(r,{source:O.q.MultiTextSelection,force:!0}),Object(k.e)(r)&&b.S.isMobile&&b.S.isBytedanceApp&&S.s.emit(S.p.MOBILE.BLOCK_MENU.SHOW_BLOCK_MENU)}o.prevSelection=[],o.tmpPrevSelection=[],o.selectionUpdated=!1},o.onBeforeStart=function(e){var n;2!==(null===(n=e.event)||void 0===n?void 0:n.button)&&o.clearContextmenuContext()},o.onContextmenu=function(){o.isContextMenu=!0},o.onBrowserSelectionChange=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];o.contextMenuSelChangeCount++,o.onBrowserSelectionChangeImpl(e,n),2===o.contextMenuSelChangeCount&&o.isContextMenu&&o.clearContextmenuContext()};var c=o.context.options.unSelectableType||[];return o.unSelectableType=Object(g.difference)(c,P),o}return a()(r,[{key:"isIOSBlockMenuVisible",value:function(){return b.S.isIOS&&C.isVisible()&&Object(k.e)(this.context.getSelection())}},{key:"clearContextmenuContext",value:function(){this.isContextMenu=!1,this.contextMenuSelChangeCount=0}},{key:"onBrowserSelectionChangeImpl",value:function(e){var n,r,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.context.selectionContext.renderMode!==x.H.NORMAL){j(".onBrowserSelectionChange",e);var i=Array.from(this.context.selectionContext.intersectSelectedBlocksMap.values()).some((function(e){return e.length>0}));if(i)return j(".onBrowserSelectionChange[hasIntersectSelectedBlocks]: tmpPrevSelection=%O",this.tmpPrevSelection),this.tmpPrevSelection.length>0&&(this.diffRenderBlockSelection(this.tmpPrevSelection,[]),this.tmpPrevSelection=[]),this.selectionUpdated=!1,void(b.S.isMobile||(this.context.selectionContext.renderMode=x.H.NORMAL));var c=getSelection(),a=(null===c||void 0===c?void 0:c.rangeCount)?null===c||void 0===c?void 0:c.getRangeAt(0):void 0;if(!a||!c)return j(".onBrowserSelectionChange[noRange]"),void(!this.context.isSelecting&&!this.isIOSBlockMenuVisible()&&this.context.removeAllSelection());if(this.context.composingService&&this.context.composingService.isComposing&&!o)j(".onBrowserSelectionChange[isComposing]");else{var l=a.startContainer,s=a.endContainer,u=a.startOffset,d=a.endOffset,f=this.hasMultipleSelectionIgnoreDom(l,s);if(f)j(".onBrowserSelectionChange[hasIgnoreDom]");else{var h=this.context.blockManager.editorAPI.config.get("isBidirectionalLink");if(h)j(".onBrowserSelectionChange[isBidirectionalLink]");else{var p=document.querySelector("#docx-popup-container"),v=!!(null===p||void 0===p?void 0:p.contains(l));v&&this.context.removeAllSelection(!1);var g=l instanceof Element&&l.classList.contains("view-name-flex-input-container")&&l.closest(".bitable-toolbar-doc-wrapper");g&&this.context.removeAllSelection(!1);var O=null===(n=this.context.blockManager.getBlockViewByBlockIdNotCheck(this.context.blockManager.rootBlockId))||void 0===n?void 0:n.hostElement,S=!!(null===O||void 0===O?void 0:O.contains(l));if(S){var C=!1,I=w(a);I&&(C=!0);var B=this.context.selectionContext.tripleClick&&!this.context.isSelecting;B&&(j(".onBrowserSelectionChange[tripleClick]"),I=l,C=!0);var T=Object(E.S)(l),R=Object(E.S)(I||s);if(this.context.store.forward=!Object(k.P)(c,Object(k.K)(c,0)),!T||!R)return!this.context.isSelecting&&this.context.store.isTextSelectionAcrossBlocks(this.context.getSelection())&&this.context.removeAllSelection(),void j(".onBrowserSelectionChange[selectionNotInBlock]");if(T===R){if(this.isContextMenu&&this.isContextmenuOnBlockSelection(R))return;var M=this.modelService.getBlockModelByBlockId(T),D=y(a);if(!M)return;D&&this.context.restoreFocus();var A=m.x.includes(M.type);if(A&&!D)return j(".onBrowserSelectionChange[hitThirdPartyEditor]"),this.context.removeAllSelection(!1);if(!Object(_.i)(M)&&!D)return;if(M.type===m.B.TABLE&&D){var P=this.context.getSelection();return void(Object(k.e)(P)&&(j(".onBrowserSelectionChange: restoreFocus fro table zeroSpace"),this.context.restoreFocus()))}}var L=T===R&&l===s&&u===d&&(null===(r=this.context.blockManager.getBlockViewByBlockIdNotCheck(T))||void 0===r?void 0:r.isRoot);if(L){var N=Object(x.k)(l,"page-block-content");if(!N)return}this.buildMultipleSelection(c,T,R,C)}else j(".onBrowserSelectionChange[notSelectedInCurrentRoot]")}}}}}},{key:"isContextmenuOnBlockSelection",value:function(e){var n=this.context.getSelection();return Object(k.e)(n)&&!!this.context.getBlockInNestedSelection(e)}},{key:"hasMultipleSelectionIgnoreDom",value:function(e,n){return L.some((function(r){return e.nodeType===Node.ELEMENT_NODE&&(null===e||void 0===e?void 0:e.classList.contains(r))||n.nodeType===Node.ELEMENT_NODE&&(null===n||void 0===n?void 0:n.classList.contains(r))}))}},{key:"setTempSelection",value:function(e){this.context.store.stored=e;var n=this.tmpPrevSelection;this.diffRenderBlockSelection(n,e),this.tmpPrevSelection=e,this.selectionUpdated=!0,this.context.store.emit(x.N.CHANGE_WHEN_SELECTING,n,Object(g.cloneDeep)(e))}},{key:"diffRenderBlockSelection",value:function(e,n){var r=Object(k.h)(e,n),o=Object(k.h)(n,e);j(".diffRenderBlockSelection: toBeRemoved=%O, toBeAdded=%O",r,o),this.renderBlockSelection(r,o)}},{key:"renderBlockSelection",value:function(e,n){var r=this;e.forEach((function(e){e.type===O.j.BLOCK&&r.context.mainSelectionType.render(e,!1)})),n.forEach((function(e){e.type===O.j.BLOCK&&r.context.mainSelectionType.render(e,!0)}))}},{key:"isTextualBlock",value:function(e){return!(!e||!e.model.isTextBlock)}},{key:"getContainers",value:function(e){for(var n=[],r=this.modelService.getBlockModelByBlockId(e);r;)this.containerTypeList.includes(r.type)&&n.push(r.id),r=r.parent;return n}},{key:"getIterator",value:function(e,n){var r=this,o=n,i=this.getContainers(e),c=this.getContainers(o),a=this.modelService.getBlockModelByBlockId(e);if(i.length!==c.length||i[0]!==c[0]||i[0]===o||c[0]===e){var l=Object(g.differenceWith)(i,c,g.isEqual),s=Object(g.differenceWith)(c,i,g.isEqual),u=l[l.length-1],d=this.context.store.forward?l[l.length-1]:s[s.length-1],f=d?this.modelService.getBlockModelByBlockId(d):null;f&&this.singleContainerType.includes(f.type)?o=(a=f).id:u?a=this.modelService.getBlockModelByBlockId(u)||a:0===l.length&&s.length>1&&this.context.isSelecting?a=this.modelService.getBlockModelByBlockId(e):i.length===c.length&&(a=this.modelService.getBlockModelByBlockId(i[0])||a)}return{next:function e(){return a&&a.next&&a.id!==o?r.containerTypeList.includes(a.type)&&(function(){if(!a||c.includes(a.id))return a=null;for(var e=a;e.children.length;)e=e.children[e.children.length-1];a=e}(),null===a)?null:(a=a.next,r.unSelectableType.includes(a.type)?e():a):null},current:function(){return a}}}},{key:"getModelSelection",value:function(e,n,r){if(this.unSelectableType.includes(n.type))return null;var o=this.viewService.getBlockViewByBlockId(n.id);if(r!==O.j.BLOCK){if(o&&this.isTextualBlock(o)){var i,c=null===(i=o.model.domRangeToModelRange(e))||void 0===i?void 0:i.toPosition(),a=o.editor.getText().length,l=c?c.start:0,s=c?c.start+c.len:a;return{id:n.id,type:O.j.TEXT,selection:{start:l,end:s}}}if(!o&&n.isTextBlock)return{id:n.id,type:O.j.TEXT,selection:{start:0,end:n.getText().length}}}return{id:n.id,type:O.j.BLOCK}}},{key:"buildMultipleSelection",value:function(e,n,r,o){var i,c=[],a=this.getIterator(n,r),l=a.current();if(!l)return c;do{var s,u=void 0;(u=l.type===m.B.CODE&&n!==r?this.getModelSelection(e,l,O.j.BLOCK):this.getModelSelection(e,l))&&c.push(u),void 0===i&&(null===(s=u)||void 0===s?void 0:s.type)===O.j.TEXT&&(i=u.id),l=a.next()}while(l);var d=void 0===i?void 0:this.context.blockManager.getBlockViewByBlockIdNotCheck(i);d&&Object(_.f)(d)&&(this.context.store.isTextSelectionAcrossBlocks(c)?d.editor.setPreventUpdateDomSelection(!0):d.editor.setPreventUpdateDomSelection(!1)),this.context.isSelecting?this.setTempSelection(c):this.context.setSelection(c,{source:O.q.MultiTextSelection,force:o})}},{key:"modelService",get:function(){return this.context.blockManager.modelService}},{key:"viewService",get:function(){return this.context.blockManager.view}},{key:"containerTypeList",get:function(){return D}},{key:"singleContainerType",get:function(){return A}}]),r}(R.P)},dx_N2Lq:function(e,n,r){"use strict";r.d(n,"E",(function(){return s})),r.d(n,"g",(function(){return u}));var o,i=r("dx_J4zp"),c=r.n(i),a=r("dx_cDcd"),l=new(r("dx_D8nn").i);function s(e){l.trigger(o.TABLE_ADD_ROW_BAR_HOVER,[e])}function u(){var e=Object(a.useState)(!1),n=c()(e,2),r=n[0],i=n[1],s=Object(a.useCallback)((function(e){i(e)}),[]);return Object(a.useEffect)((function(){return l.on(o.TABLE_ADD_ROW_BAR_HOVER,s),function(){l.off(o.TABLE_ADD_ROW_BAR_HOVER,s)}}),[s]),r}!function(e){e.TABLE_ADD_ROW_BAR_HOVER="TABLE_ADD_ROW_BAR_HOVER"}(o||(o={}))},dx_N4Vo:function(e,n,r){"use strict";r.d(n,"b",(function(){return k})),r.d(n,"a",(function(){return O}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_QILm"),a=r.n(c),l=r("dx_zFsx"),s=r("dx_PcQO"),u=r("dx_TSYQ"),d=r.n(u),f=r("dx_cDcd"),h=r.n(f),p=r("dx_MUMK"),v=r("dx_OJCf"),g=(r("dx_TOwV"),new WeakMap);function b(e,n){"function"===typeof e?e(n):e.current=n}function y(e,n){if(e&&n){var r=g.get(e)||new WeakMap;g.set(e,r);var o=r.get(n)||function(r){b(e,r),b(n,r)};return r.set(n,o),o}return e||n}function m(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(2===n.length)return y(n[0],n[1])||null;var o=n.slice(1).reduce((function(e,n){return y(e,n)}),n[0]);return o||null}var _=r("dx_Bapk"),k=h.a.createContext({}),O=h.a.forwardRef((function(e,n){var r=e.tooltipProps,o=a()(e,["tooltipProps"]),c=Object(f.useRef)(null),u=Object(f.useContext)(k).block,g=Object(f.useCallback)((function(e){var n;Object(v.u)(e)===p.F.onEnter&&(e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),null===(n=c.current)||void 0===n||n.click())}),[]);return Object(f.useEffect)((function(){return l.Q.on("keydown",c.current,g,{priority:0}),function(){l.Q.off("keydown",c.current,g)}}),[g]),h.a.createElement(_.M,Object.assign({trigger:["hover"]},r||{title:""}),h.a.createElement(s.Button,Object.assign({},o,{className:d()(o.className,"task-block-tabable"),onKeyDownCapture:function(e){var n=Object(v.u)(e.nativeEvent);if([p.F.onBackspace,p.F.onArrowLeft,p.F.onArrowRight].includes(n)&&(e.stopPropagation(),e.preventDefault(),e.nativeEvent.preventDefault(),e.nativeEvent.stopPropagation(),e.nativeEvent.stopImmediatePropagation()),[p.F.onArrowLeft,p.F.onArrowRight].includes(n)){if(!u)return;var r=i()(u.hostElement.querySelectorAll(".task-block-tabable"));if(document.activeElement&&$(document.activeElement).hasClass("task-block-tabable")){var o,c=(n===p.F.onArrowRight?1:-1)+r.findIndex((function(e){return e===document.activeElement}));if(c<0||c>=r.length)return void(null===(o=u.editorInstance)||void 0===o||o.focus());r[c].focus({preventScroll:!0})}}},ref:m(c,n)})))}))},dx_N5N8:function(e,n,r){"use strict";r.d(n,"w",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("selection-service")},dx_N9dL:function(e,n,r){"use strict";var o=r("dx_QbKi");r.o(o,"RecordSnapshotCreator")&&r.d(n,"RecordSnapshotCreator",(function(){return o.RecordSnapshotCreator})),r.o(o,"RecordSnapshotFactoryModule")&&r.d(n,"RecordSnapshotFactoryModule",(function(){return o.RecordSnapshotFactoryModule})),r.o(o,"RecordSnapshotFactoryService")&&r.d(n,"RecordSnapshotFactoryService",(function(){return o.RecordSnapshotFactoryService}));var i=r("dx_h90h");r.d(n,"RecordSnapshotFactoryModule",(function(){return i.n}))},dx_NIiI:function(e,n,r){"use strict";r.d(n,"s",(function(){return $}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_TSYQ"),a=r.n(c),l=r("dx_h6a8"),s=r("dx_cDcd"),u=r.n(s);function d(){return d=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},d.apply(this,arguments)}var f=u.a.createElement("path",{d:"M5.664 11.624c0 .744-.244 1.344-.732 1.8-.456.432-1.036.648-1.74.648-.696 0-1.276-.216-1.74-.648-.48-.456-.72-1.056-.72-1.8V7.832c0-.744.24-1.344.72-1.8.464-.432 1.044-.648 1.74-.648.704 0 1.284.216 1.74.648.488.456.732 1.056.732 1.8v3.792zM4.44 7.868c0-.928-.416-1.392-1.248-1.392-.824 0-1.236.464-1.236 1.392v3.72c0 .928.412 1.392 1.236 1.392.832 0 1.248-.464 1.248-1.392v-3.72z",fill:"#3370FF"}),h=function(e){return u.a.createElement("svg",d({width:7,height:18,viewBox:"0 0 7 18",fill:"none"},e),f)};function p(){return p=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},p.apply(this,arguments)}var v=u.a.createElement("path",{d:"M3.036 14V6.788L1.368 8.252V6.896l1.668-1.44H4.26V14H3.036z",fill:"#3370FF"}),g=function(e){return u.a.createElement("svg",p({width:7,height:18,viewBox:"0 0 7 18",fill:"none"},e),v)};function b(){return b=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},b.apply(this,arguments)}var y=u.a.createElement("path",{d:"M.756 14v-1.092l3.288-3.996c.304-.368.456-.748.456-1.14 0-.864-.416-1.296-1.248-1.296-.36 0-.652.1-.876.3-.256.232-.384.572-.384 1.02H.768c0-.72.232-1.304.696-1.752.464-.44 1.06-.66 1.788-.66.736 0 1.332.216 1.788.648.456.44.684 1.024.684 1.752 0 .352-.068.672-.204.96-.112.232-.312.528-.6.888l-2.676 3.276h3.48V14H.756z",fill:"#3370FF"}),m=function(e){return u.a.createElement("svg",b({width:7,height:18,viewBox:"0 0 7 18",fill:"none"},e),y)};function _(){return _=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},_.apply(this,arguments)}var k=u.a.createElement("path",{d:"M5.736 11.6c0 .792-.256 1.412-.768 1.86-.48.416-1.096.624-1.848.624-.736 0-1.336-.192-1.8-.576-.52-.424-.792-1.032-.816-1.824h1.224c.024.432.172.76.444.984.248.208.564.312.948.312.928 0 1.392-.472 1.392-1.416 0-.936-.476-1.404-1.428-1.404H2.88V9.092h.204c.864 0 1.296-.432 1.296-1.296 0-.88-.42-1.32-1.26-1.32-.792 0-1.22.408-1.284 1.224H.612c.032-.712.288-1.28.768-1.704.464-.416 1.044-.624 1.74-.624.728 0 1.324.22 1.788.66.464.448.696 1.024.696 1.728 0 .864-.356 1.472-1.068 1.824.8.352 1.2 1.024 1.2 2.016z",fill:"#3370FF"}),O=function(e){return u.a.createElement("svg",_({width:7,height:18,viewBox:"0 0 7 18",fill:"none"},e),k)};function x(){return x=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},x.apply(this,arguments)}var E=u.a.createElement("path",{d:"M5.064 12.716V14H3.876v-1.284H.42v-1.14l3.012-6.12h1.32l-3 6.12h2.124V9.584h1.188v1.992h.912v1.14h-.912z",fill:"#3370FF"}),S=function(e){return u.a.createElement("svg",x({width:7,height:18,viewBox:"0 0 7 18",fill:"none"},e),E)};function C(){return C=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},C.apply(this,arguments)}var I=u.a.createElement("path",{d:"M5.748 11.144c0 .52-.04.932-.12 1.236-.112.4-.312.744-.6 1.032-.448.448-1.048.672-1.8.672-.776 0-1.384-.22-1.824-.66a2.033 2.033 0 01-.48-.756 3.214 3.214 0 01-.168-.876H1.98c.104.792.52 1.188 1.248 1.188.368 0 .664-.112.888-.336.16-.16.272-.384.336-.672a3.82 3.82 0 00.072-.828c0-.56-.084-.984-.252-1.272-.2-.344-.532-.516-.996-.516-.648 0-1.052.256-1.212.768H.948V5.456h4.608v1.092H2.052v2.256c.312-.328.784-.492 1.416-.492.656 0 1.168.184 1.536.552.296.296.5.656.612 1.08.088.32.132.72.132 1.2z",fill:"#3370FF"}),B=function(e){return u.a.createElement("svg",C({width:7,height:18,viewBox:"0 0 7 18",fill:"none"},e),I)};function T(){return T=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},T.apply(this,arguments)}var w=u.a.createElement("path",{d:"M5.724 11.468c0 .784-.236 1.416-.708 1.896-.464.472-1.068.708-1.812.708-.752 0-1.36-.228-1.824-.684-.472-.464-.708-1.088-.708-1.872 0-.32.06-.664.18-1.032.096-.296.248-.652.456-1.068l1.944-3.96H4.56L2.724 9.128c.208-.088.46-.132.756-.132.632 0 1.16.224 1.584.672.44.464.66 1.064.66 1.8zm-1.224.024c0-.984-.436-1.476-1.308-1.476-.864 0-1.296.492-1.296 1.476 0 .992.432 1.488 1.296 1.488.872 0 1.308-.496 1.308-1.488z",fill:"#3370FF"}),R=function(e){return u.a.createElement("svg",T({width:7,height:18,viewBox:"0 0 7 18",fill:"none"},e),w)};function M(){return M=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},M.apply(this,arguments)}var j=u.a.createElement("path",{d:"M2.988 14h-1.32l2.868-7.452H1.932v1.344H.756V5.456h5.088v1.092L2.988 14z",fill:"#3370FF"}),D=function(e){return u.a.createElement("svg",M({width:7,height:18,viewBox:"0 0 7 18",fill:"none"},e),j)};function A(){return A=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},A.apply(this,arguments)}var P=u.a.createElement("path",{d:"M5.832 11.588c0 .752-.256 1.36-.768 1.824-.496.44-1.12.66-1.872.66s-1.372-.22-1.86-.66C.82 12.948.564 12.34.564 11.588c0-.472.12-.888.36-1.248.2-.296.472-.548.816-.756a2.104 2.104 0 01-.72-.708 2.061 2.061 0 01-.312-1.128c0-.704.24-1.276.72-1.716.464-.432 1.052-.648 1.764-.648s1.304.216 1.776.648c.48.44.72 1.012.72 1.716 0 .424-.104.8-.312 1.128a2.104 2.104 0 01-.72.708c.344.208.616.46.816.756.24.36.36.776.36 1.248zm-1.236-.024c0-.4-.136-.736-.408-1.008a1.336 1.336 0 00-.996-.42c-.392 0-.724.14-.996.42a1.37 1.37 0 00-.408 1.008c0 .4.136.736.408 1.008.272.272.604.408.996.408s.724-.136.996-.408a1.37 1.37 0 00.408-1.008zm-.132-3.78c0-.376-.12-.688-.36-.936a1.215 1.215 0 00-.912-.372c-.84 0-1.26.436-1.26 1.308 0 .864.42 1.296 1.26 1.296.848 0 1.272-.432 1.272-1.296z",fill:"#3370FF"}),L=function(e){return u.a.createElement("svg",A({width:7,height:18,viewBox:"0 0 7 18",fill:"none"},e),P)};function N(){return N=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},N.apply(this,arguments)}var F=u.a.createElement("path",{d:"M5.724 7.94c0 .32-.06.664-.18 1.032a7.975 7.975 0 01-.456 1.068L3.144 14H1.836l1.836-3.672a1.973 1.973 0 01-.768.132c-.632 0-1.16-.224-1.584-.672-.432-.464-.648-1.064-.648-1.8 0-.784.236-1.416.708-1.896.464-.472 1.068-.708 1.812-.708.752 0 1.36.228 1.824.684.472.464.708 1.088.708 1.872zM4.5 7.964c0-.992-.436-1.488-1.308-1.488-.864 0-1.296.496-1.296 1.488 0 .984.432 1.476 1.296 1.476.872 0 1.308-.492 1.308-1.476z",fill:"#3370FF"}),U=function(e){return u.a.createElement("svg",N({width:7,height:18,viewBox:"0 0 7 18",fill:"none"},e),F)};function H(){return H=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},H.apply(this,arguments)}var V=u.a.createElement("path",{d:"M6.49 14l-2.4-4.212-1.44 1.728V14H1.354V5.456H2.65v4.296l3.492-4.296h1.584L4.954 8.804 8.014 14H6.49zm7.479 0l-1.8-3.6h-1.62V14H9.253V5.456h3.312c.8 0 1.444.236 1.932.708.48.456.72 1.052.72 1.788 0 .584-.164 1.08-.492 1.488a2.245 2.245 0 01-1.212.78L15.48 14h-1.512zm-.048-6.036c0-.896-.484-1.344-1.452-1.344h-1.92v2.676h1.92c.968 0 1.452-.444 1.452-1.332z",fill:"#3370FF"}),W=function(e){return u.a.createElement("svg",H({width:16,height:18,viewBox:"0 0 16 18",fill:"none"},e),V)};function z(){return z=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},z.apply(this,arguments)}var G=u.a.createElement("path",{d:"M8.983.528c-2.616 0-4.68.84-6.168 2.568C1.375 4.728.679 6.84.679 9.456c0 2.592.696 4.704 2.136 6.336 1.488 1.68 3.552 2.544 6.168 2.544 2.592 0 4.656-.84 6.168-2.52 1.44-1.632 2.16-3.744 2.16-6.36 0-2.64-.72-4.776-2.16-6.384C13.639 1.368 11.575.528 8.983.528zm0 2.304c1.824 0 3.24.576 4.224 1.776.96 1.176 1.464 2.784 1.464 4.848 0 2.04-.504 3.648-1.464 4.8-.984 1.176-2.4 1.776-4.224 1.776-1.824 0-3.24-.624-4.248-1.824-.96-1.176-1.44-2.76-1.44-4.752 0-2.016.48-3.6 1.44-4.776 1.008-1.248 2.424-1.848 4.248-1.848z",fill:"#fff"}),K=function(e){return u.a.createElement("svg",z({width:18,height:19,viewBox:"0 0 18 19",fill:"none"},e),G)};r("dx_aP6o");function q(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}var X={0:h,1:g,2:m,3:O,4:S,5:B,6:R,7:D,8:L,9:U},Y={l:{width:18,height:20},m:{width:16,height:18},s:{width:13,height:14}},J={l:{width:12,height:20},m:{width:10,height:18},s:{width:8,height:14}},Z={l:{width:8,height:20},m:{width:7,height:18},s:{width:6,height:14}},Q={l:{width:9,height:22},m:{width:8,height:20},s:{width:6,height:14}},$=u.a.forwardRef((function(e,n){var r=e.number,o=e.type,c=e.className,s=e.style,d=void 0===s?{}:s,f=e.size;if(Object(l.isUndefined)(r))return null;var h="KR"===o?Z:Q,p="KR"===o?Y:J,v="".concat(r).split("").map((function(e,n){return u.a.createElement(X[e],function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?q(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({key:"".concat(e,"-").concat(n),viewBox:"0 0 7 18"},h[f]||{}))}));return u.a.createElement("span",{className:a()(c,"okr-number"),style:d,ref:n},"KR"===o?u.a.createElement(W,Object.assign({},p[f]||{},{viewBox:"0 0 16 18"})):u.a.createElement(K,Object.assign({},p[f]||{},{viewBox:"0 0 18 19",style:{top:0}})),v)}))},dx_NLUy:function(e,n,r){"use strict";r.d(n,"p",(function(){return l}));var o=r("dx_lSNA"),i=r.n(o);r("dx_RIqP"),r("dx_h6a8"),r("dx_DKNI"),r("dx_vnlt"),r("dx_dVbY"),r("dx_c0wU"),r("dx_B28d"),r("dx_Elol"),r("dx_A7Ap"),r("dx_ZG9w"),r("dx_kZ3l"),r("dx_zghO"),r("dx_FNDK"),r("dx_PQBD"),r("dx_SreQ"),r("dx_b3bq");function c(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function a(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?c(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function l(e,n){var r=e.getSelection();if(r.length){var o=e.isSingleTextSelection(r);return function(){if(o){var e,i=r[0].id,c=(null===(e=r[0].selection)||void 0===e?void 0:e.start)||0;return n.getCaretRect(i,c)}var l=r[0],s=n.getBlockRect(l.id);if(1===r.length)return s;var u=r[r.length-1],d=n.getBlockRect(u.id);return a(a({},s),{},{height:d.bottom-s.top,bottom:d.bottom})}()}console.info("nothing selected")}},dx_NLqU:function(e,n,r){"use strict";r.d(n,"S",(function(){return a}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd");function a(e){var n=Object(c.useState)(!1),r=i()(n,2),o=r[0],a=r[1];return[o,Object(c.useCallback)((function(){a(e)}),[e]),Object(c.useCallback)((function(){a(!1)}),[])]}},dx_NMQJ:function(e,n,r){"use strict";(function(t){r.d(n,"D",(function(){return T}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_RIqP"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_W7W2"),f=r.n(d),h=r("dx_a1gu"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=r("dx_Vvd7"),y=r("dx_e4eN"),m=r("dx_M30o"),_=r("dx_alfx"),k=r("dx_vdIl"),O=r("dx_UtDZ"),x=r("dx_PQBD"),E=r("dx_UHze"),S=r("dx_ZG9w"),C=r("dx_IVxn"),I=r("dx_B28d");function B(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}var T=function(e){f()(r,e);var n=B(r);function r(e){return l()(this,r),n.call(this,e)}return u()(r,[{key:"onPasteRecordAfterApply",value:function(e,n){if(Object(O.isOnline)()||!I.N.includes(this.type));else{var r=n||t("CreationDoc_Common_NetworkDisconnected_UnableToCreate");Object(x.K)(this.modelService,this.id,r)}}},{key:"getText",value:function(){return""}},{key:"find",value:function(e){return this.children.reduce((function(n,r){return[].concat(c()(n),c()(r.find(e)))}),[])}}],[{key:"onRecordApply",value:function(e,n,r){if(n===I.G.innerCutPaste&&!r)return e;if(Object(S.S)(e)){var i=Object(_.Z)(e.text.initialAttributedTexts,e.text.apool);i.get(k.x).ops.forEach((function(e){e.attributes||(e.attributes={}),e.attributes=Object.entries(e.attributes).reduce((function(e,n){var r=o()(n,2),i=r[0],c=r[1];return/^comment-id-.*/.test(i)||(e[i]=c),e}),{})}));var c=i.get(k.x),a=(new y.m).retain(c.length(),{author:Object(E.K)().userId});e.text=Object(C.f)((new m.q).add("0",c.compose(a)))}return e.comments=[],e}}]),r}(b.q)}).call(this,r("dx_E9Eu"))},dx_NMuw:function(e,n,r){"use strict";r.d(n,"v",(function(){return i})),r.d(n,"j",(function(){return c})),r.d(n,"R",(function(){return a})),r.d(n,"m",(function(){return l})),r.d(n,"O",(function(){return s})),r.d(n,"z",(function(){return u}));var o=r("dx_B28d"),i={CATALOGUE_UPDATE:"catalogue_update",CATALOGUE_ACTIVE_UPDATE:"catalogue_active_update",CATALOGUE_BOUNDARY_INTERSECTION:"catalogue_boundary_intersection",CATALOGUE_RECT_CHANGE:"catalogue_rect_change",CATALOGUE_MOVE_START:"catalogue_move_start",CATALOGUE_MOVE_END:"catalogue_move_end"},c=90,a=[o.B.TABLE,o.B.CALLOUT,o.B.OKR],l=500,s=1e3,u=0},dx_NMyZ:function(e,n,r){"use strict";r.d(n,"Q",(function(){return w}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W7W2"),a=r.n(c),l=r("dx_a1gu"),s=r.n(l),u=r("dx_Nsbk"),d=r.n(u),f=r("dx_Vvd7"),h=r("dx_N9dL"),p=r("dx_B28d"),v=r("dx_RIqP"),g=r.n(v),b=r("dx_lSNA"),y=r.n(b),m=r("dx_C7Cb"),_=r("dx_fEKD"),k=r("dx_UTG8"),O=r("dx_ZeFe");function x(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function E(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?x(Object(r),!0).forEach((function(n){y()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var S,C,I=r("dx_J8b8"),B=r("dx_AiiH");function T(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var w=Object(f.H)({providers:[{provide:h.RecordSnapshotCreator,useValue:{type:p.B.POLL,create:function(e,n){var r={poll_type:e.poll_type,title:e.title||k.InputPipe.createEmptyClientVars(),is_anonymous:void 0!==e.is_anonymous&&e.is_anonymous,when_result_visible:e.when_result_visible||O.j.afterPoll};return e.option_ids?(r.option_ids=e.option_ids,r.option_map=e.option_map):r=function(e,n){for(var r=E(E({},e),{},{option_ids:g()(e.option_ids||[]),option_map:E({},e.option_map||{})}),o=n;o--;){var i=Object(m.S)();r.option_ids.push(i),r.option_map[i]={id:i,text:k.InputPipe.createEmptyClientVars()}}return E({},r)}(r,2),Object(_.b)(r,n)}}}]})((C=function(e){a()(r,e);var n=T(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).blocks=[[I.c,{viewCreator:B.Y}]],e}return r}(f.y),S=C))||S},dx_NOpe:function(e,n,r){"use strict";r.d(n,"S",(function(){return p}));var o=r("dx_TSYQ"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c),l=r("dx_Ogyw"),s=r("dx_Z8yN"),u=r("dx_c7yg"),d=r("dx_KXll"),f=r("dx_oggq"),h=r("dx_unUv");r("dx_fgPx");function p(e){var n=e.name,r=e.size,o=e.token,p=e.progress,v=e.fromSelf,g=e.isCopying,b=e.onPreviewClick,y=e.onClick,m=e.onMount,_=e.borderColor,k=e.display,O=Object(d.s)(n),x=Object(f.r)(O),E=Object(d.H)(o),S=E&&(v&&!g?a.a.createElement(h.M,{progress:p}):a.a.createElement(h.c,null)),C=i()(u.H,s.N,l.B,"file-card");return Object(c.useEffect)(m,[m]),Object(c.useEffect)((function(){Promise.resolve().then((function(){var n;null===(n=e.renderFinishCb)||void 0===n||n.call(e)}))}),[]),a.a.createElement("div",{className:C,onClick:y,style:{borderColor:_,display:k}},a.a.createElement("div",{className:"layout-column file-icon"},a.a.createElement(x,{width:"48",height:"48"})),a.a.createElement("div",{className:"layout-column layout-main-center flex"},a.a.createElement("div",{className:"file-name"},n),a.a.createElement("div",{className:"file-desc"},a.a.createElement(h.Z,{size:r,status:""}))),a.a.createElement("div",{className:"layout-row file-btn"},S,!E&&a.a.createElement(h.x,{onClick:b,isPresentationMode:e.isPresentationMode})))}},dx_NUzf:function(e,n,r){"use strict";function o(e,n){return e===n||!(!e||!n)&&(e.width===n.width&&e.height===n.height&&e.top===n.top&&e.left===n.left)}r.d(n,"P",(function(){return o}))},dx_NYvg:function(e,n,r){"use strict";r.d(n,"p",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("undo-manager")},dx_NZ34:function(e,n,r){"use strict";r.d(n,"b",(function(){return u})),r.d(n,"f",(function(){return d})),r.d(n,"A",(function(){return f})),r.d(n,"X",(function(){return h})),r.d(n,"K",(function(){return p})),r.d(n,"W",(function(){return v}));var o,i=r("dx_UtDZ"),c=r("dx_yzqx"),a=r("dx_Fimk"),l=r("dx_D77K");function s(e,n){n.stage=e,c.S.isMobile&&console.info("=====docx_concurrency_pre_fetch_state: ".concat(JSON.stringify(n))),Object(a.N)("ccm_doc_pre_edit_clientvar_apply_stage_dev",n)}function u(e){e.stage=o.LogDidNotAllDone,Object(a.N)("ccm_doc_pre_edit_clientvar_apply_stage_dev",e)}function d(e){e.task_id=e.task_id?Object(i.encryptTea)(e.task_id):"",e.isFirstSlice="".concat(e.isFirstSlice),s(o.StoreClientvar,e)}function f(e){e.split_start_id=e.split_start_id?Object(i.encryptTea)(e.split_start_id):"",e.isFirstSlice="".concat(e.isFirstSlice),s(o.SplitClientvar,e)}function h(e){e.task_data&&e.task_data.forEach((function(e){e.task_id=e.task_id?Object(i.encryptTea)(e.task_id):""})),e.isFirstSlice="".concat(e.isFirstSlice),e.isPreEditableEnable="".concat(e.isPreEditableEnable),s(o.ApplyClientvar,e)}function p(e){return e&&e.block_map?Object.keys(e.block_map).length:0}function v(e){return e&&e.block_map?Object.keys(e.block_map).map(l.w):[]}!function(e){e.StoreClientvar="storeClientvar",e.SplitClientvar="splitClientvar",e.ApplyClientvar="applyClientvar",e.LogDidNotAllDone="logDidNotAllDone"}(o||(o={}))},dx_NbrS:function(e,n,r){"use strict";r.d(n,"c",(function(){return l})),r.d(n,"R",(function(){return s})),r.d(n,"D",(function(){return u}));var o=r("dx_I11I"),i=r("dx_FHaN"),c=r("dx_RUmv"),a=r("dx_ZG9w");function l(e){var n=e.attributes,r=void 0===n?{}:n;return Boolean(r[i.O]||r[o.B])}function s(e){e&&(e[c.h.KEY]&&(delete e[c.h.KEY],delete e.objectID),delete e[o.B],delete e[i.O],delete e.inlineCode)}function u(e,n,r){Object(a.Z)(n).forEach((function(n){e.replace(n,["parent_id"],r)}))}},dx_Nc7r:function(e,n,r){"use strict";r.d(n,"w",(function(){return O}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_J4zp"),s=r.n(l),u=r("dx_Vvd7"),d=r("dx_h6a8"),f=r("dx_cDcd"),h=r.n(f),p=r("dx_b3bq"),v=r("dx_lwsE"),g=r.n(v),b=r("dx_W8MJ"),y=r.n(b),m=function(){function e(n){var r=this;g()(this,e),this.blockManager=n,this.childrenChangedSubscription=new Map,this.contentChangedSubscription=new Map,this.subs=void 0,this.onBlockModelStructUpdate=function(e){var n=e.model,o=r.childrenChangedSubscription.get(n.id);null===o||void 0===o||o.forEach((function(e){return e()}))},this.onBlockModelUpdate=function(e){var n=e.model,o=r.contentChangedSubscription.get(n.id);null===o||void 0===o||o.forEach((function(e){return e()}))},this.subs=[this.blockManager.modelService.blockModelUpdate$.subscribe(this.onBlockModelUpdate),this.blockManager.modelService.blockModelStructUpdate$.subscribe(this.onBlockModelStructUpdate)]}return y()(e,[{key:"observeChildrenChange",value:function(e,n){var r=this.childrenChangedSubscription.get(e)||[];return r.push(n),this.childrenChangedSubscription.set(e,r),function(){var e=r.findIndex((function(e){return e===n}));r.splice(e,1)}}},{key:"observeContentChange",value:function(e,n){var r=this.contentChangedSubscription.get(e)||[];return r.push(n),this.contentChangedSubscription.set(e,r),function(){var e=r.findIndex((function(e){return e===n}));r.splice(e,1)}}},{key:"observeChildrenChangeRecursive",value:function(e,n){var r=this,o=this.blockManager.getBlockModelByBlockId(e),i=[];return i.push(this.observeChildrenChange(e,n)),o.children.forEach((function(e){i.push(r.observeChildrenChangeRecursive(e.id,n))})),function(){return i.forEach((function(e){return e()}))}}},{key:"observeContentChangeRecursive",value:function(e,n){var r=this,o=this.blockManager.getBlockModelByBlockId(e),i=[];return i.push(this.observeContentChange(e,n)),o.children.forEach((function(e){i.push(r.observeContentChangeRecursive(e.id,n))})),function(){return i.forEach((function(e){return e()}))}}},{key:"observeChange",value:function(e,n){var r=[];return r.push(this.observeChildrenChange(e,n),this.observeContentChange(e,n)),function(){return r.forEach((function(e){return e()}))}}},{key:"observeChangeRecursive",value:function(e,n){var r=[];return r.push(this.observeChildrenChangeRecursive(e,n),this.observeContentChangeRecursive(e,n)),function(){return r.forEach((function(e){return e()}))}}},{key:"disconnect",value:function(){this.subs.forEach((function(e){return e.unsubscribe()}))}}]),e}(),_=[],k=function(e,n){if(e instanceof u.q&&n instanceof u.q)return e.id===n.id&&e.type===n.type};function O(e){var n=e.selectionAPI,r=e.blockManager,o=e.filter,c=e.selectionFilter,l=e.selectionType,u=e.recursive,f=void 0!==u&&u,v=e.excludeSources,g=void 0===v?_:v,b=e.fold,y=h.a.useState((function(){return n.getSelection()})),O=s()(y,2),x=O[0],E=O[1],S=h.a.useState(0),C=s()(S,2),I=C[0],B=C[1];h.a.useEffect((function(){var e=function(){return E(n.getSelection())};return n.onSelectionChange(e),function(){return n.offSelectionChange(e)}}),[n]);var T=h.a.useState([]),w=s()(T,2),R=w[0],M=w[1];h.a.useEffect((function(){var e=n.getContext(),i=[];if(!e||!g.includes(e.source)){var a=x.filter((function(e){return!c||c(e)})).map((function(e){return r.getBlockModelByBlockIdNotCheck(e.id)})).filter((function(e){return!!e&&(!o||o(e))}));i=Object(p.t)({fold:b,blockList:a,shouldIgnoreFold:a.length>1,blockManager:r,recursive:f}).filter((function(e){return!o||o(e)}))}var l=i.sort();M((function(e){return Object(d.isEqualWith)(l,e,k)?e:l}))}),[x,n,I,r,o,l,f,g,b]);var j=h.a.useRef(!1),D=h.a.useCallback((function(){j.current=!0}),[]);h.a.useEffect((function(){var e=r.modelService.change$.subscribe((function(){j.current&&(j.current=!1,B((function(e){return e+1})))}));return function(){return e.unsubscribe()}}),[r]),h.a.useEffect((function(){var e=new m(r);return n.getSelection().forEach((function(n){return e.observeChangeRecursive(n.id,D)})),function(){return e.disconnect()}}),[x,r,n,D]);var A=h.a.useState([]),P=s()(A,2),L=P[0],N=P[1],F=h.a.useRef(0);h.a.useEffect((function(){++F.current}),[R]);var U=h.a.useCallback(a()(i.a.mark((function e(){var n,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=F.current,e.next=3,Object(p.M)(R,r);case 3:o=e.sent,n===F.current&&N(o);case 5:case"end":return e.stop()}}),e)}))),[R,r]),H=h.a.useRef(U);h.a.useEffect((function(){H.current=U}),[U]);var V=h.a.useMemo((function(){return Object(d.debounce)((function(){return H.current()}))}),[]);return h.a.useEffect((function(){return function(){++F.current,V.cancel()}}),[V]),h.a.useEffect((function(){V()}),[R]),L}},dx_Nl4O:function(e,n,r){"use strict";(function(t){r.d(n,"B",(function(){return T}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_PJYZ"),l=r.n(a),s=r("dx_W7W2"),u=r.n(s),d=r("dx_a1gu"),f=r.n(d),h=r("dx_iWIM"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=r("dx_glkC"),y=r("dx_PcQO"),m=r("dx_TSYQ"),_=r.n(m),k=r("dx_cDcd"),O=r.n(k),x=r("dx_rQGm"),E=r("dx_tP01"),S=r("dx_B8Bh"),C=r("dx_EdHe"),I=r("dx_APSa");function B(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return f()(this,r)}}var T=function(e){u()(r,e);var n=B(r);function r(){var e,i;o()(this,r);for(var c=arguments.length,a=new Array(c),s=0;s<c;s++)a[s]=arguments[s];return(i=n.call.apply(n,[this].concat(a))).listModifyPanelRef=O.a.createRef(),i.listIconRef=O.a.createRef(),i.state={showListModifyPanel:!1},i.handleClick=function(e){var n=e.target;n.closest(".list-modify-menu")||n.closest(".list-modify-input")||e.target===i.listIconRef.current||i.updateVisible(!1)},i.handleClickListStyle=function(){p()((e=l()(i),g()(r.prototype)),"handleClickListStyle",e).call(e),i.state.showListModifyPanel||i.updateVisible(!0)},i.updateVisible=function(e){e?(i.setState({showListModifyPanel:!0}),document.addEventListener("click",i.handleClick)):(i.setState({showListModifyPanel:!1}),document.removeEventListener("click",i.handleClick))},i}return c()(r,[{key:"getOrderStringByOrderAndLevel",value:function(e,n){return n%3===0?Object(b.H)(e):n%3===1?"".concat(e):n%3===2?Object(b.k)(e):""}},{key:"getDocxPopupContainer",value:function(){return document.querySelector("#docx-popup-container")||document.body}},{key:"renderListModifyPanel",value:function(){return O.a.createElement(I.S,{blockManager:this.blockManager,SelectionAPI:this.selectionAPI,blockId:this.id,recordId:this.record.id,updateVisible:this.updateVisible})}},{key:"renderOrderIcon",value:function(){var e=this.props.recursionProps.isHistory,n=this.state.showListModifyPanel,r=!e&&this.editable,o=_()("order",{orderUnedit:!this.editable,hover:n,button:r});return r?O.a.createElement(y.Dropdown,{trigger:"click",placement:"bottomLeft",overlay:this.renderListModifyPanel(),getPopupContainer:this.getDocxPopupContainer,visible:n,ref:this.listModifyPanelRef,overlayClassName:"list-modify-panel ".concat(x.b3.LAZY_SELECTION_NODE),key:"".concat(this.id,"-").concat(this.props.order)},O.a.createElement(y.Tooltip,{title:t("doc.list.set_the_number"),placement:"top",mouseEnterDelay:300},O.a.createElement(y.Button,{type:"text",size:"large",color:"primary",className:o,onClick:this.handleClickListStyle,ref:this.listIconRef,contentEditable:!1},this.getOrderStringByOrderAndLevel(this.props.order||1,this.props.level||1),"."))):O.a.createElement("div",{contentEditable:!1,className:o,onClick:this.handleClickListStyle,key:"".concat(this.id,"-").concat(this.props.order)},this.getOrderStringByOrderAndLevel(this.props.order||1,this.props.level||1),".")}},{key:"render",value:function(){return O.a.createElement("div",{className:"list-wrapper ordered-list"},O.a.createElement("div",{className:_()(["list","list-align-".concat(this.model.snapshot.align)]),ref:this.contentRef,onClick:this.handleClickOuterEditor},this.renderOrderIcon(),O.a.createElement("div",{className:"list-content"},p()(g()(r.prototype),"render",this).call(this))),this.model.children.length>0?O.a.createElement("div",{style:{paddingLeft:x.X-S.s-S.t,marginLeft:S.s},className:"list-children"},this.renderChildren()):void 0)}},{key:"pageToken",get:function(){return Object(E.m)(this.blockManager)}}]),r}(C.S)}).call(this,r("dx_E9Eu"))},dx_Nn5p:function(e,n,r){"use strict";r.d(n,"n",(function(){return a})),r.d(n,"nU",(function(){return y})),r.d(n,"O",(function(){return m})),r.d(n,"o",(function(){return O}));var o,i,c=r("dx_xjz2"),a=Object(c.S3)("content-state-service"),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_M30o"),h=r("dx_e4eN"),p=r("dx_vdIl"),v=r("dx_IdzY"),g=r("dx_WI8P"),b=r("dx_h5hq"),y=Object(c.s)(a)(o=function(){function e(){s()(this,e),this._contentState=void 0;var n=(new f.q).add(p.x,(new h.m).insertEnter());this._contentState=new b.y({deltaSet:n,schema:g.S,modulesContainer:v.g})}return d()(e,[{key:"contentState",get:function(){return this._contentState}}]),e}())||o,m=Object(c.S3)("editor-kit"),_=r("dx_K6Kr"),k=r("dx_pk3x"),O=Object(c.s)(m)(i=function(){function e(n){s()(this,e),this.contentState=n,this._e=void 0;var r=new f.q;this._e=new _.u({initData:r,editable:!1,copyable:!1,businessKey:"docx",contentState:this.contentState,debounceFlush:0,modules:v.xj,listenEvents:k.DU,schema:g.S})}return d()(e,[{key:"editor",get:function(){return this._e}}]),e=a(e,void 0,0)||e}())||i},dx_Np2v:function(e,n,r){"use strict";(function(t){r.d(n,"L",(function(){return e})),r.d(n,"H",(function(){return o})),r.d(n,"X",(function(){return i}));var e="chat_card",o={1:t("etherpad.join_group_failed_need_verification"),2:t("etherpad.join_group_failed_invitation"),4011:t("etherpad.join_group_failed_invalid"),4012:t("etherpad.join_group_failed_already_in"),4013:t("CreationDoc_Docs_GroupCard_JoinFailed_Adjust"),4014:t("etherpad.join_group_failed_invitation"),4015:t("etherpad.join_group_failed_forbidden"),4017:t("etherpad.join_group_failed_organization"),4018:t("etherpad.join_group_failed_dissolved"),4019:t("etherpad.join_group_failed_no_found"),4023:t("etherpad.join_group_failed_unshare"),4034:t("etherpad.join_group_failed"),4037:t("etherpad.join_group_failed_organization"),5016:t("etherpad.join_group_failed_dissolved"),5020:t("etherpad.join_group_failed_need_verification"),6002:t("CreationDoc_Docs_GroupCard_JoinFailed"),1000002:t("etherpad.join_group_failed_unshare")},i={1:t("etherpad.insert_chatcard_failed"),4e3:t("etherpad.insert_chatcard_failed_not_in_group"),4011:t("etherpad.insert_chatcard_failed_unshare_setting"),4014:t("etherpad.insert_chatcard_failed_only_master"),4015:t("etherpad.join_group_failed_forbidden"),4019:t("etherpad.insert_chatcard_failed_disappeared")}}).call(this,r("dx_E9Eu"))},dx_NpE2:function(e,n,r){"use strict";r.d(n,"WF",(function(){return f})),r.d(n,"W",(function(){return h}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_Fimk"),d="$merge_spliter$",f=1e3,h=function(){function e(){var n=this;a()(this,e),this.mergeEvents={},this.reportTimers={},this.debounceReport=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=e.split(d)[0],i=n.mergeEvents[e];return r?(n.reportTimers[e]&&window.clearTimeout(n.reportTimers[e]),window.setTimeout((function(){Object(u.N)(o,i),delete n.mergeEvents[e]}),r)):(Object(u.N)(o,i),delete n.mergeEvents[e],null)}}return s()(e,[{key:"report",value:function(e,n,r){if(r&&r.delay){var o="".concat(e).concat(d).concat(r.mergeKey||"");if(this.mergeEvents[o]){if(r.mergeKey){this.mergeEvents[o][r.mergeKey]||(this.mergeEvents[o][r.mergeKey]=[]);var c,a=n[r.mergeKey];if(Array.isArray(a))(c=this.mergeEvents[o][r.mergeKey]).push.apply(c,i()(a));else this.mergeEvents[o][r.mergeKey].push(n[r.mergeKey])}}else this.mergeEvents[o]=n;var l=this.debounceReport(o,r.delay);l&&(this.reportTimers[o]=l)}else Object(u.N)(e,n)}},{key:"destroy",value:function(){var e=this;this.mergeEvents={},Object.keys(this.reportTimers).forEach((function(n){window.clearTimeout(e.reportTimers[n])}))}}]),e}()},dx_NsKf:function(e,n,r){"use strict";r.d(n,"u",(function(){return u}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_B28d"),a=r("dx_n4v0");function l(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?l(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.B.TEXT;return Object(a.D)(s({folded:!1},e),n)}},dx_Nv7e:function(e,n,r){"use strict";(function(t){r.d(n,"y",(function(){return d})),r.d(n,"a",(function(){return f})),r.d(n,"f",(function(){return h})),r.d(n,"T",(function(){return p})),r.d(n,"d",(function(){return v})),r.d(n,"B",(function(){return g})),r.d(n,"s",(function(){return y})),r.d(n,"F",(function(){return m})),r.d(n,"c",(function(){return _})),r.d(n,"yO",(function(){return k})),r.d(n,"A",(function(){return O}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_UtDZ"),l=r("dx_Dq30"),s=r("dx_YzVl"),u=r("dx_g14w");function d(e,n){var r=e?new URL(Object(u.S)(e)):"";if(n&&r){var o=r.searchParams;Object.keys(n).forEach((function(e){o.append(e,n[e])}))}return r.toString()}function f(e,n){try{var r=new URL(e),o=new URL(n);return r.origin===o.origin&&r.pathname===o.pathname}catch(i){return!1}}function h(e,n,r){var o=e;return o>0&&(o=0),o<-(n-r)&&(o=-(n-r)),Number(o.toFixed(0))}function p(e,n,r){return Number((((e||0)+(n-r)/2)/n).toFixed(6))}function v(e,n,r){if(!e||!n)return{};var o=e.offset_ratio_x,i=void 0===o?0:o,c=e.offset_ratio_y,a=void 0===c?0:c,l=n.naturalWidth,s=n.naturalHeight;if(!l||!s)return{};var u,d,f=Number((l/s).toFixed(6)),p=(null===r||void 0===r?void 0:r.width)||document.documentElement.clientWidth,v=(null===r||void 0===r?void 0:r.height)||.27*document.documentElement.clientHeight,g=0,b=0;return f>p/v?(d=v,g=h(g=-((u=l*(v/s))-p)/2+i*u,u,p)):(u=p,b=h(b=-((d=s*Number((p/l).toFixed(6)))-v)/2+a*d,d,v)),{width:Number(u.toFixed(0)),height:Number(d.toFixed(0)),marginLeft:Number(g.toFixed(0)),marginTop:Number(b.toFixed(0))}}function g(e){return b.apply(this,arguments)}function b(){return(b=c()(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){n||r(new Error("[image plugin] generateGifCover failed, no image src"));var o=new Image;o.onload=function(){var n=document.createElement("canvas"),r=o.width,i=o.height;n.width=r,n.height=i;var c=n.getContext("2d");c&&(c.drawImage(o,0,0,r,i),e(n.toDataURL()))},o.onerror=r,o.src=n})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){return"image/gif"===e}function m(e){if(!!!e.getRecord(e.getRootRecordId()).snapshot.cover)return 0;var n=document.querySelector(".".concat(l.P));return n?n.clientHeight:0}function _(e){if(!e)return null;var n=new URL(e),r=window.opendocSSRImage;if(r){var o=Object.keys(r).find((function(e){return e.match(n.pathname)}));return o?r[o]:null}return null}function k(){Object(s.F)({type:"error",content:t("CreationDoc_ECM_AdminDisableToast")})}function O(){var e=Object(a.getPermTypeAuthorityResult)(a.PermissionType.FILE_UPLOAD),n=Object(a.checkAuthoritySync)(a.PermissionType.FILE_UPLOAD)===a.AUTHORITY_TYPE.DENY;return!e&&n}}).call(this,r("dx_E9Eu"))},dx_O0KV:function(e,n,r){},dx_O1Ou:function(e,n,r){"use strict";var o,i,c,a,l,s;r.d(n,"a",(function(){return o})),r.d(n,"w",(function(){return i})),r.d(n,"X",(function(){return c})),r.d(n,"f",(function(){return a})),r.d(n,"Q",(function(){return l})),r.d(n,"s",(function(){return s})),function(e){e.DocxPosition="DocxPosition",e.DocComment="DocComment",e.DocxFold="DocxFold",e.DocxImage="DocxImage",e.DocxFile="DocxFile",e.DocxBoxPreview="DocxBoxPreview",e.DocxTable="DocxTable",e.DocxSheet="DocxSheet",e.DocxBitable="DocxBitable",e.DocxCode="DocxCode",e.Hover="Hover"}(o||(o={})),function(e){e.DOCX="docx"}(i||(i={})),function(e){e.SCROLL="scroll"}(c||(c={})),function(e){e.PRESENTER="presenter",e.FOLLOWER="follower"}(a||(a={})),function(e){e.MODULE="module",e.VC_BLOCK_HELPER="vc_block_helper"}(l||(l={})),function(e){e.SUCCESS="SUCCESS",e.FAIL="FAIL",e.IGNORE="IGNORE"}(s||(s={}))},dx_O3Oi:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M1.907 2.42h-.536C.614 2.42 0 3.033 0 3.79V8.63C0 9.385.614 10 1.371 10h7.258C9.386 10 10 9.385 10 8.629V3.79c0-.756-.614-1.37-1.371-1.37h-.536a3.186 3.186 0 00-6.186 0z",fill:"#fff"}),l=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.707 3.334H1.249a.417.417 0 00-.417.417v5c0 .229.186.416.417.416h7.5c.23 0 .416-.187.416-.416v-5a.417.417 0 00-.416-.417H7.29v-.208a2.291 2.291 0 10-4.583 0v.208zm3.543-.188v.188h-2.5v-.188c0-.726.56-1.313 1.25-1.313s1.25.587 1.25 1.313zm0 3.104a1.25 1.25 0 11-2.5 0 1.25 1.25 0 012.5 0z",fill:"#8F959E"});n.S=function(e){return i.a.createElement("svg",c({width:10,height:10,viewBox:"0 0 10 10",fill:"none"},e),a,l)}},dx_O49O:function(e,n,r){"use strict";var o=r("dx_UtDZ"),i=r("dx_BaZy"),c=r.n(i)()({loader:function(){return o.resourceSchedulerHelpers.scheduler.addTask({name:"okr_search_popover",action:function(){return Promise.all([r.e("dx_k3k"),r.e("dx_G1G"),r.e("dx_SFF")]).then(r.bind(null,"dx_Iotu"))}})},loading:function(){return null}});n.S=c},dx_O4OS:function(e,n,r){"use strict";r.d(n,"q",(function(){return k}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_cb6Q"),v=r("dx_N8Nu"),g=r("dx_cDcd"),b=r.n(g),y=r("dx_CqjN"),m=r("dx_vxyt");function _(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var k=function(e){s()(r,e);var n=_(r);function r(e){var o;return i()(this,r),(o=n.call(this)).props=e,o}return a()(r,[{key:"renderLine",value:function(e){var n=e.children,r=e.lineState,o=this.props,i=o.PlaceholderComponent,c=o.EndComponent,a=o.block,l=o.editor,s=function(e){a.editable&&e.target===e.currentTarget&&(e.stopPropagation(),e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),e.nativeEvent.stopPropagation(),e.nativeEvent.preventDefault(),Object(m.n)(l))},u=Object(y.i)({onClick:function(e){return s(e)}});return r.nextSibling()?n:b.a.createElement("div",{className:"task-block-end-line",onTouchStart:u,onTouchMove:u,onTouchEnd:u,onMouseDownCapture:s},r.isEmpty()&&b.a.createElement(p.z,null),!r.previousSibling()&&r.isEmpty()?b.a.createElement(i,null):null,n,b.a.createElement(c,null))}}]),r}(v.o)},dx_O5Om:function(e,n,r){"use strict";r.d(n,"w",(function(){return g}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_K9Ia"),d=r("dx_VnDw"),f=r("dx_Y67Y");function h(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function p(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?h(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var v=function(){function e(){a()(this,e),this.stateMap=new Map,this.singleStateChange$=new u.Z}return s()(e,[{key:"getState",value:function(e){return this.stateMap.get(e)||{}}},{key:"setState",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=n;if(!r){var i=this.getState(e);o=p(p({},i),n)}this.stateMap.set(e,o),this.singleStateChange$.next({id:e,state:o})}},{key:"setStartCopying",value:function(e){this.setState(e,{fromSelf:!0,isCopying:!0})}},{key:"setEndCopying",value:function(e){this.setState(e,{isCopying:!1})}},{key:"deleteState",value:function(e){this.stateMap.delete(e)}},{key:"clear",value:function(){this.stateMap.clear()}},{key:"onStateChangeOf",value:function(e){return this.singleStateChange$.pipe(Object(d.N)((function(n){return n.id===e})),Object(f.D)((function(e){return e.state})))}}]),e}(),g=new v},dx_O75l:function(e,n,r){"use strict";var o,i;r.d(n,"I",(function(){return o})),r.d(n,"r",(function(){return i})),function(e){e.undo="UNDO",e.redo="REDO"}(o||(o={})),function(e){e.BEFORE_UNDO_REDO="BEFORE_UNDO_REDO",e.AFTER_UNDO_REDO="AFTER_UNDO_REDO",e.UNDO="undo",e.REDO="redo"}(i||(i={}))},dx_O7Od:function(e,n,r){"use strict";r.d(n,"T",(function(){return o})),r.d(n,"E",(function(){return i})),r.d(n,"O",(function(){return c}));var o="draggable-btn",i="resizable-wrapper",c="resizable-dragging"},dx_O7R4:function(e,n,r){"use strict";r.d(n,"S",(function(){return hc}));var o=r("dx_QILm"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_o0o1"),s=r.n(l),u=r("dx_yXPU"),d=r.n(u),f=r("dx_lwsE"),h=r.n(f),p=r("dx_W8MJ"),v=r.n(p),g=r("dx_W7W2"),b=r.n(g),y=r("dx_a1gu"),m=r.n(y),_=r("dx_Nsbk"),k=r.n(_),O=r("dx_zFsx"),x=r("dx_cDcd"),E=r.n(x),S=r("dx_rQGm"),C=r("dx_yzqx"),I=r("dx_k9kc"),B=r("dx_rldU"),T=r("dx_tP01"),w=r("dx_XbJI"),R=r("dx_B28d"),M=r("dx_B8Bh"),j=r("dx_ZG9w"),D=r("dx_kZ3l"),A=r("dx_Vau3"),P=r("dx_acOG"),L=r("dx_zghO"),N=r("dx_lZWw"),F=r("dx_D8nn"),U=r("dx_J4zp"),H=r.n(U),V=r("dx_RIqP"),W=r.n(V),z=r("dx_Uyc2"),G=r.n(z),K=r("dx_QxNg"),q=r("dx_h6a8"),X=r("dx_PQBD"),Y=r("dx_MoY1"),J=r("dx_b3bq"),Z=r("dx_kP4l"),Q=r("dx_Fimk"),$=r("dx_IS8F"),ee=r("dx_vnlt"),te=r("dx_A7Ap"),ne=r("dx_bPy9"),re=r("dx_WAOj"),oe=r("dx_j6ji"),ie=r("dx_s04s"),ce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(n,r,o){var i=e.supportReadOnly,c=void 0!==i&&i,a=o.value;o.value=function(e){if(!c&&Object(q.isArray)(e)?e[0]&&e[0].blockManager.editable:e.blockManager.editable){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return a&&a.call.apply(a,[this,e].concat(r))}}}},ae=r("dx_Z7ZC"),le=r("dx_A3AG"),se=r("dx_furZ"),ue=r("dx_QBqw"),de=r("dx_N2Hh"),fe=r("dx_qx8A"),he=r.n(fe),pe=r("dx_MUMK");function ve(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function ge(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ve(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ve(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function be(e,n){return e.applyTransaction("keyevent:text:backspace",(function(e){ye(n,e)}))}function ye(e,n){var r=e.model.parent.recordId,o=e.model;Object(Y.y)(n,[o]),o.children.length>0&&Object(Y.t)(n,r,o.position,o.children.map((function(e){return e.recordId})))}function me(e,n,r,o){return _e.apply(this,arguments)}function _e(){return(_e=d()(s.a.mark((function e(n,r,o,i){var c,a,l,u,d,f,h,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.getBlockModelByBlockId(o[0].id),a=c.previousSibling,l=n.getBlockViewByBlockId(a.id),u=r.getSelection(),d=!0,f=o.map((function(e){return e.record.id})),h=a.children.length,e.next=9,n.applyTransaction("keyevent:block:tab",(function(e){Object(Y.y)(e,o.map((function(e){return e.model}))),Object(Y.t)(e,l.record.id,h,f)}));case 9:p=l.model.children.slice(h,h+f.length).map((function(e){return e.id})),Oe(r,n,d,u,p);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(e,n){var r=e.getSelection(),o=!0;return 1===r.length&&r[0].id===n[n.length-1].id||r.length===n.length&&r.every((function(e){return n.findIndex((function(n){return n.id===e.id}))>-1}))||e.isTextSelectionAcrossBlocks(r)||(r=[],o=!1),[r,o]}function Oe(e,n,r,o,i){if(r)if(e.isSingleTextSelection(o))e.setSelection([ge({},o[0])]);else if(e.isTextSelectionAcrossBlocks(o)){var c=[],a=o.length,l=n.getBlockModelByBlockId(i[0]);o.forEach((function(e,r){if(i.includes(e.id))return l=n.getBlockModelByBlockId(e.id),c.push(e);for(l=l.next;Object(ie.N)(l.type);)l=l.next;if(e.type===L.j.BLOCK)return c.push({id:l.id,type:L.j.BLOCK});var o=e.selection.end;r!==a-1&&(o=l.zoneState.totalWidth()),c.push({id:l.id,type:L.j.TEXT,selection:{start:0,end:o}})})),e.setSelection(c)}else e.setSelection(i.map((function(e){return{id:e,type:L.j.BLOCK}})));else e.removeAllSelection(),e.restoreFocus()}function xe(e,n,r,o,i,c,a){var l,s=n.record.id,u=n.id,d=n.parent,f=null===(l=o.getFoldStateById(u))||void 0===l?void 0:l.folded;if(!d)return{newRecordId:s,parentModel:n};var h=f?n.type:c||n.type,p=e.createInitModel(h,a||{text:i[1]});Object(ae.w)(r,n.record,i[0]);var v=n.position+1;R.O.includes(n.type)&&f&&(v=n.position+o.findFoldedBlocks(u).length+1);var g=n.children.length&&!f;return{newRecordId:g?Object(j.Wk)(r,s,0,p):Object(j.Wk)(r,d.record.id,v,p),parentModel:g?n:d}}function Ee(e,n,r){var o=r.model.zoneState.merge(n.snapshot.text).toAttributeText();Object(ae.w)(e,r.record,o),n.model.getInlineRecordIds().forEach((function(n){return e.replace(n,["parent_id"],r.record.id)})),ye(n,e)}function Se(e,n,r,o,i){var c=e&&o.getFoldStateById(e);if(c&&(!0===c.folded||c.foldedBy)&&r.push(c.foldedBy||c.id),r.length)return n.applyTransaction(i,(function(e){r.forEach((function(r){var o,i=null===(o=n.getRecordByBlockId(r))||void 0===o?void 0:o.id;i&&e.replace(i,["folded"],!1)}))})),o.waitUntilBlocksUnfold(r)}function Ce(e,n,r,o){return Ie.apply(this,arguments)}function Ie(){return(Ie=d()(s.a.mark((function e(n,r,o,i){var c,a,l,u,d,f,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=Object(ie.S)(n,r),a=null,!c){e.next=15;break}if(l=Object(ie.B)(c,r),u=l.indexOf(n),!((d=o?u+1:u-1)<0||d>l.length-1)){e.next=12;break}n=Object(ie.S)(n,r)||n,f=r.getBlockModelByBlockId(n),a=o?f.nextSibling:f.previous,e.next=13;break;case 12:return e.abrupt("return",l[d]);case 13:e.next=16;break;case 15:a=Te(n,r,o,i);case 16:if(a){e.next=18;break}return e.abrupt("return",null);case 18:if(r.hasBlockViewByBlockId(a.id)){e.next=21;break}return e.next=21,r.layoutManager.renderNodeById(a.id);case 21:if(!Object(ie.N)(a.type)){e.next=24;break}return h=Object(ie.B)(a.id,r),e.abrupt("return",o?h[0]:h[h.length-1]);case 24:return e.abrupt("return",a.id);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Be(){!he.a.getState().appState.helpSideBarVisible&&!C.S.isMobile||Object(se.m)(he.a.getState())||he.a.dispatch(Object(le.l)(!he.a.getState().docx.comment.helpPanelShown))}function Te(e,n,r,o){var i,c=n.getBlockModelByBlockId(e),a=o===L.j.BLOCK;r?i=de.e.includes(c.type)?function(e){var n=e;for(;n.children.length;)n=n.children[n.children.length-1];return n}(c).next:a?c.nextSibling:c.next:i=c.previous&&de.e.includes(c.previous.type)||a?c.previousSibling:c.previous;return i}function we(e,n){var r,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=n.getBlockModelByBlockId(e),c=!1,a=i.type===R.B.TEXT&&Reflect.get(i,"isEmpty"),l=null===(r=i.parent)||void 0===r?void 0:r.isRoot,s=!i.children.length;do{var u;c=i.type===R.B.CELL&&i.parent?Object(ue.E)(Reflect.get(i,"cellId"),i.parent.snapshot,pe.j.DOWN):i.position+1===(null===(u=i.parent)||void 0===u?void 0:u.children.length)}while((!o||s)&&c&&i.parent&&!i.parent.isRoot&&(i=i.parent));return{isHaveChildren:!s,isLastNoEmptyBlock:c&&!(a&&l)&&(!o||s),blockId:i.id}}function Re(e,n){e.triggerStartNewDocComment(n)}var Me,je,De,Ae,Pe,Le,Ne,Fe,Ue,He,Ve,We,ze,Ge,Ke,qe,Xe,Ye,Je,Ze,Qe,$e,et,tt,nt,rt,ot,it,ct=r("dx_OJCf"),at=r("dx_cDf5"),lt=r.n(at),st=r("dx_Vvd7"),ut=r("dx_m3ds"),dt=r("dx_NOtv"),ft=r.n(dt),ht=r("dx_jBAU"),pt=r("dx_hDVN"),vt=r("dx_c0wU"),gt=r("dx_w0wU"),bt=r("dx_BEcL"),yt=r("dx_kqrv"),mt=r("dx_Xdvu"),_t=r("dx_UTG8"),kt=r("dx_iSIC");function Ot(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function xt(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Ot(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ot(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Et(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return St(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return St(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function St(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var Ct,It,Bt,Tt,wt,Rt,Mt,jt,Dt,At,Pt,Lt,Nt,Ft,Ut,Ht,Vt,Wt,zt,Gt=ft()("keyevent:QuiceKeyEvents"),Kt=(Me=ce({supportReadOnly:!1}),je=ce({supportReadOnly:!1}),De=ce({supportReadOnly:!1}),Ae=ce({supportReadOnly:!1}),Pe=ce({supportReadOnly:!1}),Le=ce({supportReadOnly:!1}),Ne=ce({supportReadOnly:!1}),Fe=ce({supportReadOnly:!1}),Ue=ce({supportReadOnly:!1}),He=ce({supportReadOnly:!1}),Ve=ce({supportReadOnly:!1}),We=ce({supportReadOnly:!1}),ze=ce({supportReadOnly:!1}),Ge=ce({supportReadOnly:!1}),Ke=ce({supportReadOnly:!1}),qe=ce({supportReadOnly:!1}),Xe=ce({supportReadOnly:!1}),Ye=ce({supportReadOnly:!1}),Je=ce({supportReadOnly:!1}),Ze=ce({supportReadOnly:!1}),Qe=ce({supportReadOnly:!1}),$e=ce({supportReadOnly:!1}),et=ce({supportReadOnly:!1}),tt=ce({supportReadOnly:!1}),nt=ce({supportReadOnly:!1}),rt=ce({supportReadOnly:!1}),it=function(){function e(n,r){var o=this;h()(this,e),this.blockManager=n,this.selectionAPI=r,this.fold=void 0,this.isBlockActive=function(e){var n=o.fold.getFoldStateById(e.id);return!1!==(n&&n.show)&&!Object(ie.N)(e.type)}}return v()(e,[{key:"getSelectionRange",value:function(e){var n=null,r=st.V;if(!Array.isArray(e)&&Object(j.f)(e))n=e.model.getSelection(),r=e.id;else if(Array.isArray(e)&&1===e.length&&Object(j.f)(e[0])){var o=this.selectionAPI.getSelection();if(1===o.length&&o[0].id===e[0].id){var i=e[0];n=i.model.getSelection(),r=i.id}}var c=n?this.blockManager.getBlockViewByBlockId(r):void 0;return[n,c,null===c||void 0===c?void 0:c.model.parent]}},{key:"onCut",value:function(e,n){}},{key:"onCopy",value:function(e,n){}},{key:"buildCalloutChild",value:function(e){var n=this,r=new Map,o=e.filter((function(e){return n.blockManager.getBlockModelByBlockId(e.id).type===R.B.CALLOUT}));return o.length&&o.map((function(e){var o=n.blockManager.getBlockModelByBlockId(e.id),i=[];o.traverseInDepthFirstPreOrder((function(e){i.push(e.recordId)})),i.shift(),r.set(e.id,i)})),r}},{key:"deriveNewSelection",value:function(e,n){var r=this,o=[];e.forEach((function(e){var n=r.blockManager.modelService.getCacheRecordIdByBlockId(e.id);if(n){var o=r.blockManager.getBlockIdsByRecordId(n)[0];o&&o!==e.id&&(Gt("batchTurnintoWithMultipleSelection deriveNewSelection blockId change",e.id,o),e.id=o)}else Gt("batchTurnintoWithMultipleSelection deriveNewSelection recordId null",e.id)}));var i,c=Et(e);try{for(c.s();!(i=c.n()).done;){var a=i.value;!this.blockManager.hasBlockModelByBlockId(a.id)&&n.has(a.id)?o=o.concat(n.get(a.id).reduce((function(e,n){var o=r.blockManager.getBlockIdsByRecordId(n)[0];return e.push({id:o,type:L.j.TEXT,selection:{start:0,end:r.blockManager.getBlockViewByBlockId(o).editor.getText().length-1}}),e}),[])):this.blockManager.getBlockModelByBlockId(a.id).type===R.B.CODE?o.push({id:a.id,type:L.j.BLOCK}):o.push(a)}}catch(l){c.e(l)}finally{c.f()}return o}},{key:"batchTurnintoWithMultipleSelection",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v,g,b,y,m,_,k,O=this,x=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=x.length>2&&void 0!==x[2]?x[2]:null,i=this.selectionAPI.getSelection(),c={},this.selectionAPI.getSelection().forEach((function(e){c[e.id]=e})),a=Array.isArray(n)?n:[n],r!==R.B.CALLOUT&&r!==R.B.QUOTE_CONTAINER&&(a=Yt(a).filter((function(e){return Object(J.d)(e.model.id,O.fold,O.blockManager)}))),(l=a[a.length-1])&&Object(j.f)(l)&&(f=c[l.id])&&f.type===L.j.TEXT&&0===(null===(u=f.selection)||void 0===u?void 0:u.start)&&0===(null===(d=f.selection)||void 0===d?void 0:d.end)&&a.pop(),h=this.buildCalloutChild(i),r!==R.B.CALLOUT&&r!==R.B.QUOTE_CONTAINER){for(p=[],v=a.length-1;v>=0;v--)(g=a[v]).type!==R.B.QUOTE_CONTAINER&&g.type!==R.B.TASK?p.unshift(g):(b=g.model.children,y=Object(J.q)()&&Object(R.q)().includes(r),m=Object(J.t)({fold:this.fold,blockList:b,blockManager:this.blockManager,shouldIgnoreFold:!0,recursive:y}).map((function(e){return O.blockManager.getBlockViewByBlockId(e.id)})),p=p.concat(m));a=p}return _=a.every((function(e){return e.type===r})),e.next=13,Object(kt.S)(a,this.blockManager,_?R.B.TEXT:r,{},void 0,this.fold,o,!0);case 13:k=this.deriveNewSelection(i,h),this.selectionAPI.setSelection(k),setTimeout((function(){O.selectionAPI.isBlockSelection()&&ut.S.isBytedanceApp&&F.S.emit(F.p.MOBILE.BLOCK_MENU.SHOW_BLOCK_MENU)}));case 16:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"batchTurninto",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v,g,b,y,m,_,k,O,x,E,S,C,I,B,T,w,M,D=this,A=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=A.length>2&&void 0!==A[2]?A[2]:null,i=A.length>3&&void 0!==A[3]&&A[3],!this.selectionAPI.isTextSelectionAcrossBlocks(this.selectionAPI.getSelection())){e.next=5;break}return this.batchTurnintoWithMultipleSelection(n,r,o),e.abrupt("return");case 5:if(c=Array.isArray(n)?n:[n],a=this.blockManager.editorAPI.getService(P.N,{optional:!0}),u=function(e){return null===a||void 0===a?void 0:a.canBlockEdit(e.record,e.type,{type:"UPDATE_ATTRIBUTE",changedKey:"type",newValue:r})},!a||c.every((function(e){var n=D.blockManager.getBlockModelByBlockId(e.id),r=u(n);return r||(l=n.record),r}))){e.next=11;break}return Object(oe.A)({op_source:o||"turninto",op_type:"batchTurninto",edit_type:"UPDATE_ATTRIBUTE",interceptedRecord:l}),e.abrupt("return");case 11:if(d=[],f=this.getSelectionRange(n),h=H()(f,2),p=h[0],v=h[1],g=Object(j.U)(v),(b=g&&null!==p&&v.isFocus())&&g&&!(null===v||void 0===v?void 0:v.hostElement.classList.contains("hovered"))&&(d=Array.from(c)),!(d.length<=0)){e.next=23;break}return y=Object(J.dE)(this.fold,c,this.blockManager),m=y.blockList,_=y.isMultiSel,k=Object(J.q)()&&Object(R.q)().includes(r)&&!R.O.includes(r),e.next=21,Object(J.g)({blockList:m,fold:this.fold,blockManager:this.blockManager,shouldIgnoreFold:_,recursive:k});case 21:O=e.sent,d=O;case 23:if(x=d.every((function(e){return e.type===r})),E=Yt(d),1!==d.length||!R.O.includes(d[0].type)||r!==R.B.CALLOUT&&r!==R.B.QUOTE_CONTAINER){e.next=29;break}return e.next=28,Se(d[0].id,this.blockManager,[],this.fold,"TurnHeadingIntoCallout");case 28:this.selectionAPI.setSelection([]);case 29:return S=new Set,c.forEach((function(e){S.add(e.record.id),e.type===R.B.CALLOUT&&e.model.children.forEach((function(e){S.add(e.recordId)}))})),e.next=33,x&&r===R.B.CALLOUT?Object(kt.V)(E,this.blockManager):x&&r===R.B.QUOTE_CONTAINER?Object(te.z)({blockManager:this.blockManager,block:E}):Object(kt.S)(E,this.blockManager,x?R.B.TEXT:r,{},void 0,this.fold,o);case 33:if(C=e.sent,I=[],I=1===E.length&&1===C.length?C:C.filter((function(e){var n=D.blockManager.getBlockModelByBlockId(e);return S.has(n.recordId)})),I=Object(q.uniq)(I),this.fold&&C.forEach((function(e){D.fold.forceShowFoldedBlock(e,D.blockManager.editable)})),i){e.next=52;break}return e.next=41,this.blockManager.editorAPI.getService(mt.a).viewport.scrollToBlock(C[0]);case 41:if(r!==R.B.CALLOUT){e.next=47;break}if(!b||!p){e.next=47;break}return B=this.blockManager.getBlockModelByBlockId(C[0]),(T=B.children.find((function(e){return e.isTextBlock})))&&(w=p.toPosition(),this.selectionAPI.setSelection([{id:T.id,type:L.j.TEXT,selection:{start:w.start,end:w.start+w.len}}],{source:L.q.TurnInto})),e.abrupt("return");case 47:if(!(b&&p&&v)){e.next=51;break}return M=p.toPosition(),this.selectionAPI.setSelection([{id:v.id,type:L.j.TEXT,selection:{start:M.start,end:M.start+M.len}}],{source:L.q.TurnInto}),e.abrupt("return");case 51:this.selectionAPI.setSelection(I.map((function(e){return{id:e,type:L.j.BLOCK}})),{source:L.q.TurnInto});case 52:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"insertUneditableBlock",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i,c,a,l,u,d,f,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=Array.isArray(n)?n:[n],a=this.getParentBlockIfInCallout(c[0]),l=this.blockManager.getBlockModelByBlockId(a.id),!(u=null===l||void 0===l||null===(i=l.parent)||void 0===i?void 0:i.record.id)){e.next=14;break}if(!Object(vt.K)(null===(d=c[0])||void 0===d?void 0:d.id,this.blockManager)){e.next=12;break}return e.next=8,this.blockManager.applyTransaction(o,(function(e){Object(Y.l)(e,u,l.position+1,[r])}));case 8:(f=l.nextSibling)&&(h=this.blockManager.getBlockViewByBlockId(null===f||void 0===f?void 0:f.id),Object(pt.S)({blockManager:this.blockManager,blocks:[h],newBlockType:R.B.TEXT})),e.next=14;break;case 12:return e.next=14,this.insertBlock(o,n,r);case 14:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"getParentBlockIfInCallout",value:function(e){if(Object(vt.K)(e.id,this.blockManager)){var n=Object(vt.H)(e.id,this.blockManager);return this.blockManager.getBlockViewByBlockId(n.id)}return e}},{key:"onTurnIntoHeading1",value:function(e,n){return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.HEADING1,R.B.HEADING1)}},{key:"onTurnIntoHeading2",value:function(e,n){return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.HEADING2,R.B.HEADING2)}},{key:"onTurnIntoHeading3",value:function(e,n){return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.HEADING3,R.B.HEADING3)}},{key:"onTurnIntoHeading4",value:function(e,n){return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.HEADING4,R.B.HEADING4)}},{key:"onTurnIntoHeading5",value:function(e,n){return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.HEADING5,R.B.HEADING5)}},{key:"onTurnIntoHeading6",value:function(e,n){return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.HEADING6,R.B.HEADING6)}},{key:"onTurnIntoHeading7",value:function(e,n){return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.HEADING7,R.B.HEADING7)}},{key:"onTurnIntoHeading8",value:function(e,n){return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.HEADING8,R.B.HEADING8)}},{key:"onTurnIntoHeading9",value:function(e,n){return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.HEADING9,R.B.HEADING9)}},{key:"onTurnIntoOrdered",value:function(e,n){return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.ORDERED,R.B.ORDERED)}},{key:"onTurnIntoBullet",value:function(e,n){return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.BULLET)}},{key:"onTurnIntoQuote",value:function(e,n){var r=this;n.preventDefault(),n.stopImmediatePropagation();var o=Array.isArray(e)?e:[e];if(![R.B.PROGRESS].find((function(e){var n;return Object(X.R)(null===(n=o[0])||void 0===n?void 0:n.id,r.blockManager,e)})))return this.batchTurninto(e,R.B.QUOTE)}},{key:"onTurnIntoQuoteContainer",value:function(e,n){var r=this;if(n.preventDefault(),n.stopImmediatePropagation(),e=Array.isArray(e)?e:[e],![R.B.PROGRESS].find((function(n){var o;return Object(X.R)(null===(o=e[0])||void 0===o?void 0:o.id,r.blockManager,n)})))return this.batchTurninto(e,R.B.QUOTE_CONTAINER)}},{key:"onTurnIntoTask",value:function(e,n){return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.TODO)}},{key:"onTurnIntoCode",value:function(e,n){var r=this;n.preventDefault(),n.stopImmediatePropagation();var o=Array.isArray(e)?e:[e],i=[],c=[];if(![R.B.CALLOUT,R.B.PROGRESS].find((function(e){return Object(X.R)(o[0].id,r.blockManager,e)}))&&!!!o.every((function(e){return Object(te.T)(r.blockManager,e.id)})))return o.forEach((function(e){(e.type===R.B.CODE?i:c).push(e)})),i.length===o.length?this.batchTurninto(i,R.B.TEXT):this.batchTurninto(c,R.B.CODE)}},{key:"onTurnIntoText",value:function(e,n,r){var o;return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.TEXT,null!==(o=null===r||void 0===r?void 0:r.triggerSource)&&void 0!==o?o:R.B.TEXT)}},{key:"onTurnIntoCallout",value:function(e,n){return n.preventDefault(),n.stopImmediatePropagation(),this.batchTurninto(e,R.B.CALLOUT)}},{key:"onAddReminder",value:function(e,n){n.preventDefault(),n.stopImmediatePropagation();var r=(Array.isArray(e)?e:[e])[0];if(r){var o=r.model.getSelection();o&&F.S.emit(yt.i,r,o)}}},{key:"onAddDivider",value:function(e,n){var r=this;n.preventDefault(),n.stopImmediatePropagation();var o=Array.isArray(e)?e:[e],i=o[0];if((1!==o.length||Object(j.f)(i)&&i.type!==R.B.CODE)&&(![R.B.CALLOUT,R.B.PROGRESS,R.B.QUOTE_CONTAINER].find((function(e){return Object(X.R)(i.id,r.blockManager,e)}))||ut.S.isMobile||ut.S.isIPad)){var c=Object(gt.s)({});this.insertUneditableBlock(e,c,"addDivider")}}},{key:"onInsertTable",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v,g;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),r.stopImmediatePropagation(),o=this.blockManager,i=Array.isArray(n)?n:[n],c=i[0],a=[R.B.CELL,R.B.CALLOUT],!i[0].props.parentId){e.next=10;break}if(!(l=this.blockManager.getBlockViewByBlockId(i[0].props.parentId)).parentId||!a.includes(l.type)){e.next=10;break}return e.abrupt("return");case 10:return e.next=12,this.insertBlock("addTable",n,this.blockManager.createInitModel(R.B.TEXT));case 12:if(u=e.sent){e.next=15;break}return e.abrupt("return");case 15:if(this.blockManager.hasBlockViewByBlockId(u)){e.next=18;break}return e.next=18,this.blockManager.layoutManager.renderNodeById(u);case 18:return d=o.getBlockViewByBlockId(u),f=function(e,n){Object(Y.y)(e,[n.model])},h={blockManager:o,block:d,options:{column:2,row:2}},Object.assign(h,{beforeInsert:f}),e.next=24,Object(bt.C)(h);case 24:p=c.model.isEmpty,v=this.blockManager.getBlockModelByBlockId(c.id),g=!!v.children.length,p&&!g&&this.blockManager.applyTransaction("removeEmptyLine",(function(e){Object(Y.y)(e,[c.model])}));case 28:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onNewPage",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,f,h=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),o=(Array.isArray(n)?n:[n]).filter((function(e){return Object(j.f)(e)})),i={source:"inline_newpage_btn",event_type:"mouseclick"},e.prev=3,e.next=6,Promise.all(o.map(function(){var e=d()(s.a.mark((function e(n){var r,o,c,a,l,u,d,f,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.model.zoneState,o=n.getTextEditorSelection(),c=n.model.getAttributes(o.start,o.end).toMap(),!(a=c.inlineblock)||1!==Object(j.F)(r)){e.next=10;break}if(l=h.blockManager.getRecord(a),u=l&&(l.snapshot.children||[])[0],h.blockManager.getRecord(u).snapshot.type!==R.B.PAGE){e.next=10;break}return e.abrupt("return",null);case 10:return d=o.toPosition(),f=r.getModelText().slice(d.start,d.start+d.len).replace(/[\u200B|\n]/g,"").trim(),e.next=14,qt(f,h.blockManager,n);case 14:(p=e.sent)&&F.S.emit(S.W0,xt({token:p},i));case 16:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),F.S.emit(S.W0,i);case 11:if(!(c=o[o.length-1])){e.next=19;break}if(l=c.model.zoneState.totalWidth(),u=null===(a=c.model.getSelection())||void 0===a?void 0:a.toPosition()){e.next=17;break}return e.abrupt("return");case 17:f=1===o.length&&c.isFocus()?xt(xt({},u),{},{start:u.start+1,len:0}):xt(xt({},u),{},{start:l,len:0}),c.model.setSelection(f,!0);case 19:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onHelpSiderbar",value:function(){Be()}},{key:"onToggleTask",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),r.stopImmediatePropagation(),o=(Array.isArray(n)?n:[n]).filter((function(e){return e.type===R.B.TODO})),i=Array.from(new Set(o.map((function(e){return e.record.snapshot.done})))),e.abrupt("return",this.blockManager.applyTransaction("toggle",(function(e){o.forEach((function(n){return e.replace(n.record.id,["done"],1!==i.length||!i[0])}))})));case 5:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onCmdUp",value:function(){var e=this.blockManager.getRootBlockId();this.selectionAPI.setSelection([{type:L.j.TEXT,id:e,selection:{start:0,end:0}}])}},{key:"onCmdDown",value:function(){var e=d()(s.a.mark((function e(){var n,r,o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.blockManager.getBlockModelByBlockId(this.blockManager.rootBlockId);case 1:if((n=Object(q.last)(n.children))&&n.children.length){e.next=5;break}return e.abrupt("break",7);case 5:e.next=1;break;case 7:return r=n.isTextBlock,e.next=10,this.blockManager.editorAPI.getService(mt.a).viewport.scrollToBlock(n.id);case 10:if(!r){e.next=20;break}if(o=n.zoneState.length(),i=this.blockManager.getBlockViewByBlockIdNotCheck(n.id)){e.next=17;break}return e.next=16,this.blockManager.layoutManager.renderNodeById([n.id]);case 16:i=this.blockManager.getBlockViewByBlockId(n.id);case 17:i.model.setSelection({start:o,len:0},!0),e.next=21;break;case 20:this.selectionAPI.setSelection([{type:L.j.BLOCK,id:n.id}],{source:L.q.HOTKEY});case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"focusOnBlock",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i,c,a,l,u,d=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=d.length>3&&void 0!==d[3]?d[3]:[],!this.isContainer(n.type)){e.next=3;break}return e.abrupt("return",this.focusOnContainer(n,r,o));case 3:if(this.blockManager.layoutManager.getViewportBlocks().includes(n.id)){e.next=6;break}return e.next=6,this.blockManager.layoutManager.scrollToSelection(n.id);case 6:if(!Object(j.U)(n)||!r){e.next=20;break}if(c=i.length>0?i:this.selectionAPI.getSelection(),a=c[0]){e.next=11;break}return e.abrupt("return");case 11:if(l=a.id,u=this.blockManager.getBlockViewByBlockIdNotCheck(l),!(a.type===L.j.BLOCK&&Object(j.U)(u))){e.next=17;break}return this.selectionAPI.setSelection([{type:L.j.BLOCK,id:n.id}]),e.abrupt("return");case 17:u&&Object(j.U)(u)?D.d(u.model,n.model,!o):D.u(n.model),e.next=21;break;case 20:Object(j.U)(n)?o?D.u(n.model):D.Z(n.model):n&&this.selectionAPI.setSelection([{type:L.j.BLOCK,id:n.id}]);case 21:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"findSiblingContainer",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.blockManager.getBlockModelByBlockId(e),o=n?r.nextSibling:r.previousSibling;if(o&&this.isContainer(o.record.snapshot.type))return this.blockManager.getBlockViewByBlockId(o.id)}},{key:"focusOnContainer",value:function(){var e=d()(s.a.mark((function e(n){var r,o,i,c,a=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(a.length>1&&void 0!==a[1])||a[1],o=!(a.length>2&&void 0!==a[2])||a[2],n.type!==R.B.TABLE){e.next=6;break}return e.abrupt("return",this.focusOnTable(n,r,o));case 6:if(n.type!==R.B.OKR){e.next=11;break}return i=this.findSpecificBlockViewInContainerByBlockId(n.id,o,(function(e){return![R.B.PROGRESS,R.B.KEY_RESULT,R.B.OBJECTIVE].includes(e.type)})),e.abrupt("return",i&&this.focusOnBlock(i,r,o));case 11:return c=n.model.children[o?0:n.model.children.length-1],e.abrupt("return",this.focusOnBlock(this.blockManager.getBlockViewByBlockId(c.id),r,o));case 13:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"focusOnTable",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=e.record.snapshot,i=Object(ue.c)(o),c=o.rows_id,a=o.columns_id,l=r?0:c.length-1,s=i[l][0];if(s.cellId!==s.sourceCellId){var u=Object(ue.j)(s.sourceCellId),d=H()(u,1),f=d[0];l=c.indexOf(f)}var h=this.blockManager.getBlockModelByBlockId(e.id).children[l*a.length],p=r?0:h.children.length-1,v=h.children[p];return v?this.focusOnBlock(this.blockManager.getBlockViewByBlockId(v.id),n,r):this.focusOnEmptyCell(e.id,h.record.id)}},{key:"focusOnEmptyCell",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(bt.a)({blockManager:this.blockManager,tableBlockId:n,cellRecordId:r,offset:0});case 2:o=e.sent,i=this.blockManager.getBlockViewByBlockId(o),Object(j.U)(i)&&i.focus();case 5:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"insertBlock",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i,c,a,l,u,d,f,h,p,v=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Array.isArray(r)?r:[r],c=i[0],a=this.blockManager.getBlockModelByBlockId(c.id),l=null===a||void 0===a?void 0:a.parent,a&&l){e.next=6;break}return e.abrupt("return",null);case 6:if(u=l.id,d=l.record.id,u){e.next=10;break}return e.abrupt("return",null);case 10:return f=0,h="",e.next=14,this.blockManager.applyTransaction(n,(function(e){if(v.selectionAPI.isBlockSelection(v.selectionAPI.getSelection())){f=a.position+i.length;var n=Object(Y.T)(e,d,f,[o]),r=H()(n,1);h=r[0]}else{var l=c.model.isEmpty,s=c.model.getSelection();if(!s)return null;var u=D.C(s),p=D.X(s),g=c.model.zoneState.split(s),b=[g[0].toAttributeText(),g[1].toAttributeText()],y=!!a.children.length;if(l||u){e.replace(c.record.id,["text"],b[1]),c.model.setSelection(xt(xt({},s.toPosition()),{},{start:0,len:0})),f=a.position;var m=Object(Y.T)(e,d,f,[o]),_=H()(m,1);h=_[0]}else if(p){e.replace(c.record.id,["text"],b[0]),y?(d=c.record.id,f=0):f=a.position+1;var k=Object(Y.T)(e,d,f,[o]),O=H()(k,1);h=O[0]}else{var x=v.blockManager.createInitModel(R.B.TEXT,{text:b[1]});if(e.replace(c.record.id,["text"],b[0]),y){var E=Object(Y.T)(e,c.record.id,0,[x]),S=H()(E,1);h=S[0],d=c.record.id,f=0}else{Object(Y.T)(e,d,a.position+1,[x]),f=a.position+1;var C=Object(Y.T)(e,d,f,[o]),I=H()(C,1);h=I[0]}}}}));case 14:return p=this.blockManager.getBlockIdsByRecordId(h)[0],e.abrupt("return",p);case 16:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"findSpecificBlockViewInContainerByBlockId",value:function(e){var n=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=arguments.length>2?arguments[2]:void 0,i=this.blockManager.getBlockModelByBlockId(e);if(i.children.length){o=o||function(){return!0};for(var c=r?0:i.children.length-1,a=function(){var e=n.blockManager.getBlockViewByBlockId(i.children[c].id),a=function(){return!!o&&o(e)},l=function(){var i=n.findSpecificBlockViewInContainerByBlockId(e.id,r,o);if(i)return i},s=void 0;if(r?s=a()?e:l():!(s=l())&&a()&&(s=e),s)return{v:s}};r?c<i.children.length:c>=0;r?c++:c--){var l=a();if("object"===lt()(l))return l.v}}}},{key:"isEscapeFromContainer",value:function(e,n,r){if(r)return!1;for(var o=e;o.model.children.length;){if(o.model.children[0]===n.model)return!0;o=this.blockManager.getBlockViewByBlockId(o.model.children[0].id)}return!1}},{key:"isContainer",value:function(e){return[R.B.TABLE,R.B.OKR,R.B.CALLOUT,R.B.QUOTE_CONTAINER].includes(e)}},{key:"focusClosestBlockOnMultiRow",value:function(){var e=d()(s.a.mark((function e(n){var r,o,i,c,a,l,u=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(u.length>1&&void 0!==u[1])||u[1],o=!(u.length>2&&void 0!==u[2])||u[2],i=u.length>3&&void 0!==u[3]?u[3]:[],c=n[o?n.length-1:0],!(a=this.findSiblingContainer(c.id,o))){e.next=7;break}return e.abrupt("return",this.focusOnContainer(a,r,o));case 7:return(l=this.blockManager.findClosestBlockViewByBlockId(c.id,o,this.isBlockActive))&&this.isContainer(l.type)&&this.isEscapeFromContainer(l,c,o)&&(l=this.blockManager.findClosestBlockViewByBlockId(l.id,o,this.isBlockActive)),e.abrupt("return",l&&this.focusOnBlock(l,r,o,i));case 10:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),e}(),ot=it,G()(ot.prototype,"onCut",[Me],Object.getOwnPropertyDescriptor(ot.prototype,"onCut"),ot.prototype),G()(ot.prototype,"onCopy",[je],Object.getOwnPropertyDescriptor(ot.prototype,"onCopy"),ot.prototype),G()(ot.prototype,"onTurnIntoHeading1",[De],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoHeading1"),ot.prototype),G()(ot.prototype,"onTurnIntoHeading2",[Ae],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoHeading2"),ot.prototype),G()(ot.prototype,"onTurnIntoHeading3",[Pe],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoHeading3"),ot.prototype),G()(ot.prototype,"onTurnIntoHeading4",[Le],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoHeading4"),ot.prototype),G()(ot.prototype,"onTurnIntoHeading5",[Ne],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoHeading5"),ot.prototype),G()(ot.prototype,"onTurnIntoHeading6",[Fe],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoHeading6"),ot.prototype),G()(ot.prototype,"onTurnIntoHeading7",[Ue],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoHeading7"),ot.prototype),G()(ot.prototype,"onTurnIntoHeading8",[He],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoHeading8"),ot.prototype),G()(ot.prototype,"onTurnIntoHeading9",[Ve],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoHeading9"),ot.prototype),G()(ot.prototype,"onTurnIntoOrdered",[We],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoOrdered"),ot.prototype),G()(ot.prototype,"onTurnIntoBullet",[ze],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoBullet"),ot.prototype),G()(ot.prototype,"onTurnIntoQuote",[Ge],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoQuote"),ot.prototype),G()(ot.prototype,"onTurnIntoQuoteContainer",[Ke],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoQuoteContainer"),ot.prototype),G()(ot.prototype,"onTurnIntoTask",[qe],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoTask"),ot.prototype),G()(ot.prototype,"onTurnIntoCode",[Xe],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoCode"),ot.prototype),G()(ot.prototype,"onTurnIntoText",[Ye],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoText"),ot.prototype),G()(ot.prototype,"onTurnIntoCallout",[Je],Object.getOwnPropertyDescriptor(ot.prototype,"onTurnIntoCallout"),ot.prototype),G()(ot.prototype,"onAddReminder",[Ze],Object.getOwnPropertyDescriptor(ot.prototype,"onAddReminder"),ot.prototype),G()(ot.prototype,"onAddDivider",[Qe],Object.getOwnPropertyDescriptor(ot.prototype,"onAddDivider"),ot.prototype),G()(ot.prototype,"onInsertTable",[$e],Object.getOwnPropertyDescriptor(ot.prototype,"onInsertTable"),ot.prototype),G()(ot.prototype,"onNewPage",[et],Object.getOwnPropertyDescriptor(ot.prototype,"onNewPage"),ot.prototype),G()(ot.prototype,"onToggleTask",[tt],Object.getOwnPropertyDescriptor(ot.prototype,"onToggleTask"),ot.prototype),G()(ot.prototype,"onCmdUp",[nt],Object.getOwnPropertyDescriptor(ot.prototype,"onCmdUp"),ot.prototype),G()(ot.prototype,"onCmdDown",[rt],Object.getOwnPropertyDescriptor(ot.prototype,"onCmdDown"),ot.prototype),ot);function qt(e,n,r){return Xt.apply(this,arguments)}function Xt(){return(Xt=d()(s.a.mark((function e(n,r,o){var i,c,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=o.model.zoneState,c=o.getTextEditorSelection(),r.getBlockModelByBlockId(o.id).parent){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,ht.S.createPage({create_type:ht.Q.NEW_PAGE,title:_t.InputPipe.deserializePlainText(n||"")});case 7:return a=e.sent,e.next=10,r.applyTransaction("replaceTextToInlineBlock",(function(e){var n=Object(Y.s)(e,o.record.id,{type:R.B.REFERENCE,children:[a.data.id]}),r=i.replace(c,"",{inlineblock:n}).toAttributeText();e.replace(o.record.id,["text"],r)}));case 10:return e.abrupt("return",a.data.id);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Yt(e){return e.filter((function(e){return Object(j.U)(e)||e.type===R.B.CALLOUT||e.type===R.B.QUOTE_CONTAINER||e.type===R.B.TASK}))}function Jt(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Zt(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zt(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Zt(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function Qt(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var $t=L.q.ARROW_PRESS,en=(Ct=ce({supportReadOnly:!1}),It=ce({supportReadOnly:!1}),Bt=ce({supportReadOnly:!1}),Tt=ce({supportReadOnly:!1}),wt=ce({supportReadOnly:!1}),Rt=ce({supportReadOnly:!1}),Mt=ce({supportReadOnly:!1}),jt=ce({supportReadOnly:!1}),Dt=ce({supportReadOnly:!1}),At=ce({supportReadOnly:!1}),Pt=ce({supportReadOnly:!1}),Lt=ce({supportReadOnly:!1}),Nt=ce({supportReadOnly:!1}),Ft=ce({supportReadOnly:!1}),Ut=ce({supportReadOnly:!1}),Ht=ce({supportReadOnly:!1}),Vt=ce({supportReadOnly:!1}),zt=function(e){b()(r,e);var n=Qt(r);function r(e,o,i,c,a){var l;return h()(this,r),(l=n.call(this,e,o)).blockManager=e,l.selectionAPI=o,l.fold=i,l.commentModule=c,l.viewport=a,l.cancelScrollToBlock=void 0,l.getGridColumnPrevLine=function(e,n){var r,o,i=l.blockManager.getBlockModelByBlockId(n),c=l.blockManager.getBlockModelByBlockId(i.parent.id),a=c.children[0].id===n,s=e[0].id===i.children[0].id,u=l.blockManager.getBlockModelByBlockId(e[0].id);return s?o=r=a?c.previous:i.previous:(r=u.previous,o=u.previousSibling),{prev:r,prevSibling:o}},l.setCollectParams=function(e,n,r){var o=null===e||void 0===e?void 0:e.collector;if(o){var i={value1:n};void 0!==r&&(i.value2=r),o.setExtraData({action_value:i},!0)}},l}return v()(r,[{key:"findTargetBlockId",value:function(e,n){var r=this.blockManager.getBlockModelByBlockId(e),o="firstChild"===n?(r.children||[])[0]:r[n];if(!o)return null;var i=this.blockManager.getBlockModelByBlockId(o.id);if(R.j.includes(i.type))return null;var c=this.fold.getFoldStateById(e),a=this.fold.getFoldStateById(o.id);if((null===a||void 0===a?void 0:a.foldedBy)&&"previous"===n)return a.foldedBy;if(c&&c.folded&&"next"===n){var l=this.fold.findFoldedBlocks(e),s=this.blockManager.getBlockModelByBlockId(l[l.length-1]);return this.findTargetBlockId(s.id,"next")}return Object(ie.N)(i.type)?"next"===n?this.findTargetBlockId(i.id,"firstChild")||this.findTargetBlockId(i.id,"next"):this.findTargetBlockId(i.id,n):i.id}},{key:"textAlignLeft",value:function(e,n){this.alignBlock(e,n,R.D.LEFT)}},{key:"textAlignCenter",value:function(e,n){this.alignBlock(e,n,R.D.CENTER)}},{key:"textAlignRight",value:function(e,n){this.alignBlock(e,n,R.D.RIGHT)}},{key:"alignBlock",value:function(e,n,r){var o=this;n.preventDefault();var i,c=e.map((function(e){return o.blockManager.getBlockModelByBlockId(e.id)})),a=Jt(Object($.C)({blocks:c,blockManager:this.blockManager,recursive:!0,fold:this.fold}));try{var l=function(){var e=i.value;e.record.snapshot.align!==r&&o.blockManager.applyTransaction("changeAlign",(function(n){n.replace(e.recordId,["align"],r)}))};for(a.s();!(i=a.n()).done;)l()}catch(s){a.e(s)}finally{a.f()}F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}},{key:"onCtrlUp",value:function(e,n){var r=this.findSiblingContainer(e[e.length-1].id,!1);if(r)this.focusOnContainer(r,!0,!1);else{var o=this.blockManager.findClosestBlockViewByBlockId(e[0].id,!1,this.isBlockActive);o&&Object(j.U)(o)?Object(D.u)(o.model):o&&this.selectionAPI.setSelection([{type:L.j.BLOCK,id:o.id}]),n.preventDefault()}}},{key:"onCtrlDown",value:function(e,n){var r=this.findSiblingContainer(e[e.length-1].id,!0);if(r)this.focusOnContainer(r,!0,!0);else{var o=this.blockManager.findClosestBlockViewByBlockId(e[e.length-1].id,!0,this.isBlockActive);o&&Object(j.U)(o)?Object(D.u)(o.model):o&&this.selectionAPI.setSelection([{type:L.j.BLOCK,id:o.id}]),n.preventDefault()}}},{key:"handleArrowUpOrDown",value:function(e,n,r){var o=this;if(0===e.length)return!0;n.preventDefault();var i=this.selectionAPI.getSelection();Object(ct.c)((function(){return o.focusClosestBlockOnMultiRow(e,!0,r,i)}),this.selectionAPI)}},{key:"onArrowUp",value:function(e,n){return this.handleArrowUpOrDown(e,n,!1)}},{key:"onArrowDown",value:function(e,n,r){var o=we(e[e.length-1].id,this.blockManager,!1),i=o.isLastNoEmptyBlock,c=o.blockId;return i?(Object(X.A)(this.blockManager,this.selectionAPI,this.viewport,c),void n.preventDefault()):!(!r||!r.propagationToTableCell)||this.handleArrowUpOrDown(e,n,!0)}},{key:"onArrowLeft",value:function(e,n){var r;if(0===e.length)return!0;n.preventDefault();var o=e[0].id,i=this.findTargetBlockId(o,"parent"),c=this.blockManager.getBlockModelByBlockId(o);if(1===e.length&&Object(R.q)().includes(c.type)&&!0!==(null===(r=this.fold.getFoldStateById(o))||void 0===r?void 0:r.folded)&&this.blockManager.getBlockModelByBlockId(o).children.length)return e[0].blockManager.editable?this.blockManager.applyTransaction("updateFolded",(function(e){e.replace(c.recordId,["folded"],!0)})):(this.blockManager.dispatch(S.Fx,[c.id,!0]),F.S.emit(F.p.COMMON.FOLD_CHANGED_READONLY,{blockId:c.record.id,folded:!0})),void this.selectionAPI.setSelection([{id:o,type:L.j.BLOCK}],{source:$t});i&&this.selectionAPI.setSelection([{id:i,type:L.j.BLOCK}],{source:$t})}},{key:"onArrowRight",value:function(e,n){var r;if(0===e.length)return!0;n.preventDefault();var o=e[0].id,i=this.blockManager.getBlockModelByBlockId(o),c=this.findTargetBlockId(o,"firstChild");if(c&&1===e.length&&Object(R.q)().includes(i.type)&&!0===(null===(r=this.fold.getFoldStateById(o))||void 0===r?void 0:r.folded))return e[0].blockManager.editable?this.blockManager.applyTransaction("updateFolded",(function(e){e.replace(i.record.id,["folded"],!1)})):(this.blockManager.dispatch(S.Fx,[i.id,!1]),F.S.emit(F.p.COMMON.FOLD_CHANGED_READONLY,{blockId:i.record.id,folded:!1})),void this.selectionAPI.setSelection([{id:o,type:L.j.BLOCK}],{source:$t});c&&this.selectionAPI.setSelection([{id:c,type:L.j.BLOCK}],{source:$t})}},{key:"onShiftArrowUp",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v,g,b,y,m,_;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(o=this.cancelScrollToBlock)||void 0===o||o.call(this),i=this.selectionAPI,c=this.blockManager,a=this.fold,l=i.getSelection(),r.preventDefault(),r.stopPropagation(),u=Object(J.dE)(a,l,c),u.isMultiSel||(i.forward=!1),!i.forward){e.next=16;break}for(d=l.pop();d&&!a.isShow(d.id);)d=l.pop();return Object(ct.c)((function(){i.setSelection(l)}),i),f=l[l.length-1].id,(h=a.findFoldedByBlock(f))&&(f=h),this.cancelScrollToBlock=this.viewport.scrollToBlockWithAnimation(f),e.abrupt("return");case 16:return p=l[0].id,e.next=19,Ce(p,c,!1,L.j.BLOCK);case 19:if(!(v=e.sent)){e.next=27;break}return b=[],(y=a.getFoldStateById(v))&&!y.show&&(null===(g=y.foldedByType)||void 0===g?void 0:g.startsWith("heading"))&&y.foldedBy?(m=a.findFoldedBlocks(y.foldedBy),b=[{id:y.foldedBy,type:L.j.BLOCK}].concat(W()(m.map((function(e){return{id:e,type:L.j.BLOCK}})))),v=y.foldedBy):b=[{id:v,type:L.j.BLOCK}],Object(ct.c)((function(){i.setSelection(b.concat(l))}),i),this.cancelScrollToBlock=this.viewport.scrollToBlockWithAnimation(v),e.abrupt("return");case 27:(_=tn(p,c))&&(Object(ct.c)((function(){i.setSelection(_)}),i),this.cancelScrollToBlock=this.viewport.scrollToBlockWithAnimation(_[0].id));case 29:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onShiftArrowDown",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v,g;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(o=this.cancelScrollToBlock)||void 0===o||o.call(this),i=this.selectionAPI,c=this.blockManager,a=this.fold,l=i.getSelection(),r.preventDefault(),r.stopPropagation(),u=Object(J.dE)(a,l,this.blockManager),u.isMultiSel||(i.forward=!0),i.forward){e.next=15;break}for(l.shift(),d=l.shift();d&&!a.isShow(d.id);)d=l.shift();return l.unshift(d),Object(ct.c)((function(){i.setSelection(l)}),i),this.cancelScrollToBlock=this.viewport.scrollToBlockWithAnimation(d.id),e.abrupt("return");case 15:return f=l[l.length-1].id,e.next=18,Ce(f,c,!0,L.j.BLOCK);case 18:if(!(h=e.sent)){e.next=26;break}return p=[],this.blockManager.getBlockViewByBlockId(h).type.startsWith("heading")?(v=a.findFoldedBlocks(h),p=[{id:h,type:L.j.BLOCK}].concat(W()(v.map((function(e){return{id:e,type:L.j.BLOCK}}))))):p=[{id:h,type:L.j.BLOCK}],Object(ct.c)((function(){i.setSelection(l.concat(p))}),i),this.cancelScrollToBlock=this.viewport.scrollToBlockWithAnimation(h),e.abrupt("return");case 26:(g=tn(f,c))&&(Object(ct.c)((function(){i.setSelection(g)}),i),this.cancelScrollToBlock=this.viewport.scrollToBlockWithAnimation(g[0].id));case 28:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onDelete",value:function(e,n){this.onBackspace(e,n)}},{key:"onBackspace",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i,c,a,l,u,d,f,h,p,v,g,b,y,m,_,k,O,x,E,S,B,T,w,M,D,A=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(re.Z)(n,this.blockManager.editorAPI),a=n[0].id,l=this.blockManager.getBlockModelByBlockId(a),u=null===(i=l.parent)||void 0===i?void 0:i.id,d=(null===(c=l.parent)||void 0===c?void 0:c.record.snapshot.type)===R.B.GRID_COLUMN,f=this.selectionAPI,d?(v=this.getGridColumnPrevLine(n,u),g=v.prev,b=v.prevSibling,h=g,p=b):Object(te.M)(a,this.blockManager)?(h=l.parent.previous,p=l.parent.previousSibling):(h=l.previous,p=l.previousSibling),r.preventDefault(),r.stopPropagation(),y=null,(null===o||void 0===o?void 0:o.mouse)&&(m=n.filter((function(e){return A.blockManager.hasBlockViewByBlockId(e.id)}))).length>0&&(y=m.map((function(e){return{id:e.id,type:L.j.BLOCK}}))),!u){e.next=36;break}if(!(_=this.blockManager.editorAPI.getService(P.N,{optional:!0}))||n.every((function(e){var n,r=A.blockManager.getBlockModelByBlockId(e.id),o=_.canBlockEdit(null===(n=r.parent)||void 0===n?void 0:n.record,r.type,{type:"DELETE_CHILD",index:r.position});return o||(k=r.record),o}))){e.next=16;break}return Object(oe.A)({op_source:(null===o||void 0===o?void 0:o.mouse)?I.G.add_panel:"keyboard",op_type:(null===o||void 0===o?void 0:o.mouse)?"delete":"backspace",edit_type:"DELETE_CHILD",interceptedRecord:k}),e.abrupt("return");case 16:return e.next=18,this.blockManager.applyTransaction("keyevent:block:backspace",(function(e){n.forEach((function(n){Object(Y.y)(e,[n.model])}))}),{onBeforeChange:function(){f.removeAllSelection(),delete this.onBeforeChange},from:K.H.local,extra:{undoSelection:y}});case 18:if(!h){e.next=36;break}for(E=h.id,S=[R.B.CALLOUT,R.B.TABLE,R.B.OKR],(B=this.fold.getFoldStateById(E))&&B.foldedBy&&(E=B.foldedBy),p&&S.includes((null===(O=p)||void 0===O||null===(x=O.record.snapshot.type)||void 0===x?void 0:x.toString())||"")&&(E=p.id),T=this.blockManager.getBlockViewByBlockId(E);Object(ie.N)(T.type);)w=T.id,M=this.blockManager.getBlockViewByBlockId(w).props.parentId,T=this.blockManager.getBlockViewByBlockId(M);if(!Object(j.U)(T)){e.next=32;break}D=T.model.zoneState.totalWidth()-1,this.selectionAPI.setSelection([{type:L.j.TEXT,id:T.id,selection:{start:D,end:D}}]),C.S.isAndroid&&window.lark.biz.util.showKeyBoard({callback:q.noop}),e.next=35;break;case 32:if(T.type!==R.B.CELL){e.next=34;break}return e.abrupt("return");case 34:this.selectionAPI.setSelection([{type:L.j.BLOCK,id:T.id}]);case 35:setTimeout((function(){F.S.trigger(F.p.MOBILE.COMMON.SCROLL_TO_VIEW,[!1])}),200);case 36:this.setCollectParams(o,pe.f.deleteBlock);case 37:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"onEnter",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(re.Z)(n,this.blockManager.editorAPI),!(o=W()(n).reverse().find((function(e){return Object(j.U)(e)})))){e.next=8;break}i=o.model.zoneState.getModelText().length,o.model.setSelection({start:i,len:0},!0),r.preventDefault(),e.next=18;break;case 8:if(c=this.blockManager.getBlockModelByBlockId(n[n.length-1].id),a=c.parent){e.next=12;break}return e.abrupt("return");case 12:return r.preventDefault(),l=c.position+1,e.next=16,this.blockManager.applyTransaction("keyevent:block:enter",(function(e){Object(Y.l)(e,a.recordId,l,[d.blockManager.createInitModel(R.B.TEXT)])}));case 16:u=this.blockManager.getBlockViewByBlockId(a.children[l].id),Object(j.U)(u)&&this.selectionAPI.setSelection([{type:L.j.TEXT,id:u.id,selection:{start:0,end:0}}]);case 18:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onTab",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i,c,a,l,u,d,f,h,p,v,g,b,y,m,_=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),i=n,n=Object(re.Z)(n,this.blockManager.editorAPI),c=n,a=H()(c,1),l=a[0],u=Object(Z.T)(l,o),d=pe.f.blockTab,f=u===Z.z.BLOCK_INDENT?"true":"false",u===Z.z.BLOCK_INDENT||u===Z.z.INNER_TAB?(me(this.blockManager,this.selectionAPI,n,i),Object(Q.N)("ccm_doc_content_page_click",{click:"double_tab_brother_block"})):(h=Object(Z.S)(),p=h.getState(),v=p.showingTips,g=p.blockId,b=p.prevBrotherBlockIds,v&&g===l.id?(y=n.map((function(e){return e.id})),m=[].concat(W()(b.reverse()),W()(y)).map((function(e){return _.blockManager.getBlockViewByBlockId(e)})),me(this.blockManager,this.selectionAPI,m,i),h.reset()):this.showTabFailTips(l,u)),this.setCollectParams(o,d,f),F.S.emit(F.p.COMMON.TAB_STATUS_CHANGE);case 10:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"onUnTab",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i,c,a,l,u,d,f,h,p,v,g,b,y,m,_,k,O;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),n=Object(re.Z)(n,this.blockManager.editorAPI),i=this.blockManager.getBlockModelByBlockId(n[0].id),c=i.parent,a=null===c||void 0===c?void 0:c.parent,c&&a){e.next=8;break}return this.setCollectParams(o,pe.f.blockTab,"false"),e.abrupt("return");case 8:if(l=this.blockManager.getBlockViewByBlockId(c.id),u=this.blockManager.getBlockViewByBlockId(a.id),Object(R.q)().includes(l.type)){e.next=13;break}return this.setCollectParams(o,pe.f.blockTab,"false"),e.abrupt("return");case 13:return d=this.selectionAPI.getSelection(),!0,f=n.map((function(e){return e.record.id})),h=n[n.length-1],p=this.blockManager.getBlockModelByBlockId(h.id),v=p.parent,g=[],v&&(g=v.children.slice(p.position+1)),b=c,y=c.nextSibling,m=c.position+1,_=this.blockManager.applyTransaction("keyevent:block:untab",(function(e){Object(Y.y)(e,n.map((function(e){return e.model}))),Object(Y.y)(e,g),Object(Y.t)(e,u.record.id,m,f),g.length>0&&(Object(R.q)().includes(h.type)?Object(Y.t)(e,h.record.id,p.children.length,g.map((function(e){return e.record.id}))):Object(Y.t)(e,u.record.id,m+f.length,g.map((function(e){return e.record.id}))))})),k=u.model,this.fold.handleBlockShow({topAffectedSib:b,midAffectedSib:k.children[m],btmAffectedSib:y}),O=k.children.slice(m,m+f.length).map((function(e){return e.id})),Oe(this.selectionAPI,this.blockManager,true,d,O),this.setCollectParams(o,pe.f.blockTab,"true"),F.S.emit(F.p.COMMON.TAB_STATUS_CHANGE),e.abrupt("return",_);case 32:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"onShiftCmdUp",value:function(e){for(var n=this,r=this.blockManager.rootBlockId,o=this.blockManager.getBlockModelByBlockId(r).children,i=e[e.length-1].model;i.parent&&i.parent.id!==r;)i=i.parent;var c=o.slice(0,i.position+1),a=Object(ie.h)(c.map((function(e){return e.id})),this.blockManager);Object(ct.c)((function(){n.selectionAPI.setSelection(a)}),this.selectionAPI)}},{key:"onShiftCmdDown",value:function(e){for(var n=this,r=this.blockManager.rootBlockId,o=this.blockManager.getBlockModelByBlockId(r).children,i=e[0].model;i.parent&&i.parent.id!==r;)i=i.parent;var c=o.slice(i.position),a=Object(ie.h)(c.map((function(e){return e.id})),this.blockManager);Object(ct.c)((function(){n.selectionAPI.setSelection(a)}),this.selectionAPI)}},{key:"onSelectAll",value:function(e,n,r){if(n.preventDefault(),(!this.blockManager.lazyRecordStatus||this.blockManager.lazyRecordStatus.isAllDone)&&(F.S.emit(F.p.MOBILE.BLOCK_MENU.HIDE_BLOCK_MENU),this.selectionAPI.selectAll(),F.S.emit(F.p.MOBILE.BLOCK_MENU.SHOW_BLOCK_MENU),r)){var o=r.collector;o&&o.setExtraData({action_value:{value1:ct.e.SELECT_ALL_PAGE}},!0)}}},{key:"onBold",value:function(e,n,r){n.preventDefault();var o=e.filter((function(e){return Object(j.U)(e)}));this.markAllBlock(o,"bold",r),F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}},{key:"onItalic",value:function(e,n,r){n.preventDefault();var o=e.filter((function(e){return Object(j.U)(e)}));this.markAllBlock(o,"italic",r),F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}},{key:"onUnderline",value:function(e,n,r){n.preventDefault();var o=e.filter((function(e){return Object(j.U)(e)}));this.markAllBlock(o,"underline",r),F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}},{key:"onStrikeThrough",value:function(e,n,r){n.preventDefault();var o=e.filter((function(e){return Object(j.U)(e)}));this.markAllBlock(o,"strikethrough",r),F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}},{key:"onComment",value:function(e,n){n.preventDefault(),this.commentModule.getCommentable()&&Re(this.commentModule,{selectedBlocks:this.selectionAPI.getSelection(),callSource:"BlockKeyEvents"})}},{key:"onTextHighlight",value:function(e,n,r){var o;n.preventDefault();var i=e.filter((function(e){return Object(j.U)(e)})),c=(null===(o=window.User)||void 0===o?void 0:o.id)||"",a=Object(ee.M)(c),l=a.color,s=a.backgroundColor;this.markAllBlock(i,"textHighlightBackground",r,s),this.markAllBlock(i,"textHighlight",r,l),F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}},{key:"onInlineCode",value:function(e,n,r){var o=e.filter((function(e){return Object(j.U)(e)}));this.markAllBlock(o,"inlineCode",r),F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}},{key:"onExit",value:function(e){var n=e.filter((function(e){return Object(j.U)(e)}));if(n.length){var r=n[n.length-1],o=r.model.zoneState.totalWidth();r.model.setSelection({start:o,len:0},!0)}}},{key:"onShiftCtrlUp",value:function(e){var n=this,r=ke(this.selectionAPI,e),o=H()(r,2),i=o[0],c=o[1],a=e.map((function(e){var r,o=null===(r=n.blockManager.getBlockModelByBlockId(e.id))||void 0===r?void 0:r.parent;return o&&"view"===o.type?o:n.blockManager.getBlockModelByBlockId(e.id)})),l=a.map((function(e){var n;return null===(n=e.parent)||void 0===n?void 0:n.id})),s=a[0].parent,u=this.blockManager.getBlockModelByBlockId(a[0].id),d=this.blockManager.getBlockModelByBlockId(a[a.length-1].id),f=u.parent.record.id,h=d.nextSibling,p=u.previousSibling,v=Math.max(0,u.position-1);if(f&&1===Array.from(new Set(l)).length){var g=this.blockManager.applyTransaction("moveblock",(function(e){Object(Y.y)(e,a),Object(Y.t)(e,f,v,a.map((function(e){return e.record.id})))})),b=p;this.fold.handleBlockShow({topAffectedSib:b,midAffectedSib:p,btmAffectedSib:h});var y=s.children.slice(v,v+a.length).map((function(e){return e.id}));return Oe(this.selectionAPI,this.blockManager,c,i,y),this.viewport.scrollToBlock(y[0]),g}}},{key:"onShiftCtrlDown",value:function(e){var n=this,r=ke(this.selectionAPI,e),o=H()(r,2),i=o[0],c=o[1],a=e.map((function(e){var r,o=null===(r=n.blockManager.getBlockModelByBlockId(e.id))||void 0===r?void 0:r.parent;return o&&"view"===o.type?o:n.blockManager.getBlockModelByBlockId(e.id)})),l=a.map((function(e){var n;return null===(n=e.parent)||void 0===n?void 0:n.id})),s=this.blockManager.getBlockModelByBlockId(a[0].id),u=s.parent.record.id,d=s.parent,f=Math.min(d.children.length-a.length,s.position+1);if(u&&1===Array.from(new Set(l)).length){var h=this.blockManager.getBlockModelByBlockId(a[a.length-1].id).nextSibling,p=this.blockManager.getBlockModelByBlockId(a[0].id).previousSibling,v=this.blockManager.applyTransaction("moveblock",(function(e){a.forEach((function(n){e.removeChildren(n.parent.record.id,[n.record.id])})),e.insertChildren(u,f,a.map((function(e){return e.record.id})))}));this.fold.handleBlockShow({midAffectedSib:p,btmAffectedSib:h});var g=d.children.slice(f,f+a.length).map((function(e){return e.id}));return Oe(this.selectionAPI,this.blockManager,c,i,g),this.viewport.scrollToBlock(g[g.length-1]),v}}},{key:"onMinus",value:function(e,n){this.onTurnIntoBullet(e,n)}},{key:"markAllBlock",value:function(e,n,r){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"true",c=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=arguments.length>5?arguments[5]:void 0,s=[],u=l;if(c){var d=Object(J.dE)(this.fold,e,this.blockManager),f=d.blockList,h=d.isMultiSel;s=f,u=h}else s=e;var p,v=[],g=!0,b=Jt(s);try{var y=function(){var e=p.value,c=e.model.zoneState,l=[0,c.getModelText().length-1],s=Object(D.j)(e,l),d=Object(ne.G)(e.model.zoneState,s)[n]===i,f=o.blockManager.getBlockModelByBlockId(e.id),h=c.isEmpty(),b=f.children.map((function(e){return o.blockManager.hasBlockViewByBlockId(e.id)||o.blockManager.layoutManager.renderNodeByIdSync(e.id),o.blockManager.getBlockViewByBlockId(e.id)})).filter((function(e){return Object(j.U)(e)&&!R.j.includes(e.type)&&(u||Object(J.d)(e.id,o.fold,o.blockManager))})),y=b.length>0,m=h&&y;if(h&&!y)return"continue";var _=o.markAllBlock(b,n,r,i,!1,u),k=H()(_,2),O=k[0],x=k[1];if((m||d)&&O||(g=!1),r){var E=r.collector;E&&E.setExtraData({action_value:{value1:g?"false":"true"}},!0)}v.push.apply(v,W()(x||[])),v.push((function(r){return e.model.toggleMark(a()({},n,i),s,r)}))};for(b.s();!(p=b.n()).done;)y()}catch(m){b.e(m)}finally{b.f()}return c?v.forEach((function(e){return e(g)})):[g,v]}},{key:"showTabFailTips",value:function(e,n){Object(Z.J)(this.blockManager,n,e.id,Z.d.above_block,!0,!0,!0)}}]),r}(Kt),Wt=zt,G()(Wt.prototype,"textAlignLeft",[Ct],Object.getOwnPropertyDescriptor(Wt.prototype,"textAlignLeft"),Wt.prototype),G()(Wt.prototype,"textAlignCenter",[It],Object.getOwnPropertyDescriptor(Wt.prototype,"textAlignCenter"),Wt.prototype),G()(Wt.prototype,"textAlignRight",[Bt],Object.getOwnPropertyDescriptor(Wt.prototype,"textAlignRight"),Wt.prototype),G()(Wt.prototype,"onDelete",[Tt],Object.getOwnPropertyDescriptor(Wt.prototype,"onDelete"),Wt.prototype),G()(Wt.prototype,"onBackspace",[wt],Object.getOwnPropertyDescriptor(Wt.prototype,"onBackspace"),Wt.prototype),G()(Wt.prototype,"onEnter",[Rt],Object.getOwnPropertyDescriptor(Wt.prototype,"onEnter"),Wt.prototype),G()(Wt.prototype,"onTab",[Mt],Object.getOwnPropertyDescriptor(Wt.prototype,"onTab"),Wt.prototype),G()(Wt.prototype,"onUnTab",[jt],Object.getOwnPropertyDescriptor(Wt.prototype,"onUnTab"),Wt.prototype),G()(Wt.prototype,"onBold",[Dt],Object.getOwnPropertyDescriptor(Wt.prototype,"onBold"),Wt.prototype),G()(Wt.prototype,"onItalic",[At],Object.getOwnPropertyDescriptor(Wt.prototype,"onItalic"),Wt.prototype),G()(Wt.prototype,"onUnderline",[Pt],Object.getOwnPropertyDescriptor(Wt.prototype,"onUnderline"),Wt.prototype),G()(Wt.prototype,"onStrikeThrough",[Lt],Object.getOwnPropertyDescriptor(Wt.prototype,"onStrikeThrough"),Wt.prototype),G()(Wt.prototype,"onTextHighlight",[Nt],Object.getOwnPropertyDescriptor(Wt.prototype,"onTextHighlight"),Wt.prototype),G()(Wt.prototype,"onInlineCode",[Ft],Object.getOwnPropertyDescriptor(Wt.prototype,"onInlineCode"),Wt.prototype),G()(Wt.prototype,"onShiftCtrlUp",[Ut],Object.getOwnPropertyDescriptor(Wt.prototype,"onShiftCtrlUp"),Wt.prototype),G()(Wt.prototype,"onShiftCtrlDown",[Ht],Object.getOwnPropertyDescriptor(Wt.prototype,"onShiftCtrlDown"),Wt.prototype),G()(Wt.prototype,"onMinus",[Vt],Object.getOwnPropertyDescriptor(Wt.prototype,"onMinus"),Wt.prototype),Wt);function tn(e,n){var r=n.getBlockModelByBlockId(e).parent;if(r){r=n.getBlockModelByBlockId(Object(ie.x)(r.id,n,!1)||r.id);var o=n.getBlockViewByBlockId(r.id);if((!o||!Object(ie.N)(o.type))&&r.id!==n.rootBlockId)return[{id:r.id,type:L.j.BLOCK}]}}var nn=r("dx_I8yo");function rn(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var on=function(e){b()(r,e);var n=rn(r);function r(e,o){var i;return h()(this,r),(i=n.call(this,e,o)).selectionAPI=o,i}return v()(r,[{key:"onSelectAll",value:function(e,n){var r=document.activeElement;if(r){if("true"===r.getAttribute("contenteditable"))return;var o=r.tagName.toLowerCase();if(["textarea","input","op-block"].includes(o))return}if(e.preventDefault(),this.selectionAPI.selectAll(),n){var i=n.collector;i&&i.setExtraData({action_value:{value1:ct.e.SELECT_ALL_PAGE}},!0)}}},{key:"onHelpSiderbar",value:function(){Be()}}]),r}(nn.S);function cn(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var an,ln,sn,un,dn,fn,hn,pn,vn,gn,bn,yn,mn,_n,kn,On,xn,En,Sn,Cn,In,Bn,Tn,wn,Rn,Mn,jn,Dn,An,Pn,Ln,Nn,Fn,Un,Hn,Vn,Wn,zn,Gn,Kn,qn,Xn,Yn,Jn,Zn,Qn,$n,er,tr,nr,rr,or,ir,cr,ar,lr,sr,ur=function(e){b()(r,e);var n=cn(r);function r(e,o,i,c,a){var l;return h()(this,r),(l=n.call(this,e,o,i,c,a)).blockManager=e,l.selectionAPI=o,l.fold=i,l.commentModule=c,l.viewport=a,l}return v()(r,[{key:"onSelectAll",value:function(e,n,r){if(n.preventDefault(),!this.selectionAPI.isSelecting()){var o=e[0];if((null===r||void 0===r?void 0:r.target[0]).id===o.id&&o.props.parentId)return!0;if(F.S.emit(F.p.MOBILE.BLOCK_MENU.HIDE_BLOCK_MENU),this.selectionAPI.setSelection([{type:L.j.BLOCK,id:o.id}]),F.S.emit(F.p.MOBILE.BLOCK_MENU.SHOW_BLOCK_MENU),r){var i=r.collector;i&&i.setExtraData({action_value:{value1:ct.e.UN_SELECT_ALL_PAGE}},!0)}}}}]),r}(en),dr=r("dx_iWIM"),fr=r.n(dr),hr=r("dx_awlV"),pr=(r("dx_Efpq"),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(n,r,o){var i=e.isComposing,c=void 0!==i&&i,a=e.isCollapsed,l=e.selection,s=o.value;o.value=function(e,n,r){var o=n instanceof CustomEvent&&n.detail.isMobileEvent;if(Object(j.f)(e)&&e.editor.getStatus("isComposing")===c&&(o||n.keyCode!==hr.G.PROCESSING_INPUT)&&(!0===n.ignoreSrcElementChecked||n.srcElement instanceof Element||o)){var i=e.model.getSelection();if("start"!==l||!i||i.isCollapsed()&&D.C(i))if("end"!==l||!i||i.isCollapsed()&&D.X(i)){if(("all"!==l||!e.blockManager.editable||e.model.isSelectingAll())&&("cover-start"!==l||!(e.blockManager.editable&&i&&!D.C(i)||i&&!i.isCollapsed()&&!i.isBackward))&&("cover-end"!==l||!(e.blockManager.editable&&i&&!D.X(i)||i&&!i.isCollapsed()&&i.isBackward))&&(void 0===a||!i||i.isCollapsed()===a))return s&&s.call(this,e,n,r)}else e.model.isEmpty&&e.editor.__handleDOMSelectionChange();else e.model.isEmpty&&e.editor.__handleDOMSelectionChange()}}}}),vr=(r("dx_KHvq"),r("dx_agns")),gr=r("dx_SreQ"),br=r("dx_eSV8"),yr=r("dx_ObwN"),mr=r("dx_an0K"),_r=r("dx_rCbK"),kr=r("dx_l6hu"),Or=r("dx_vOIB"),xr=r("dx_NsKf"),Er=r("dx_D0JG"),Sr=r("dx_QJ6a"),Cr=r("dx_iCf4"),Ir=r("dx_iw8O"),Br=r("dx_ozfA");function Tr(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function wr(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Tr(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tr(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Rr(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var Mr,jr,Dr,Ar,Pr=(an=ce({supportReadOnly:!1}),ln=pr(),sn=ce({supportReadOnly:!1}),un=pr(),dn=ce({supportReadOnly:!1}),fn=pr(),hn=ce({supportReadOnly:!1}),pn=pr(),vn=pr(),gn=pr(),bn=pr(),yn=pr(),mn=pr(),_n=pr(),kn=pr({selection:"start"}),On=pr({selection:"end"}),xn=ce({supportReadOnly:!1}),En=pr({selection:"end"}),Sn=ce({supportReadOnly:!1}),Cn=pr({selection:"start"}),In=ce({supportReadOnly:!1}),Bn=pr(),Tn=ce({supportReadOnly:!1}),wn=pr(),Rn=ce({supportReadOnly:!1}),Mn=pr(),jn=ce({supportReadOnly:!1}),Dn=pr(),An=ce({supportReadOnly:!1}),Pn=pr(),Ln=ce({supportReadOnly:!1}),Nn=pr(),Fn=ce({supportReadOnly:!1}),Un=pr(),Hn=ce({supportReadOnly:!1}),Vn=pr(),Wn=pr({isCollapsed:!1}),zn=ce({supportReadOnly:!1}),Gn=ce({supportReadOnly:!1}),Kn=ce({supportReadOnly:!1}),qn=ce({supportReadOnly:!1}),Xn=pr(),Yn=ce({supportReadOnly:!1}),Jn=pr(),Zn=pr({selection:"cover-start"}),Qn=pr({selection:"cover-start"}),$n=pr({selection:"cover-end"}),er=pr({selection:"cover-end"}),tr=ce({supportReadOnly:!1}),nr=pr(),rr=pr(),or=ce({supportReadOnly:!1}),ir=pr(),cr=ce({supportReadOnly:!1}),ar=pr(),sr=function(e){b()(r,e);var n=Rr(r);function r(e,o,i,c,a){var l;return h()(this,r),(l=n.call(this,e,o)).blockManager=e,l.selectionAPI=o,l.fold=i,l.commentModule=c,l.viewport=a,l.setCollectParams=function(e,n,r){var o=null===e||void 0===e?void 0:e.collector;if(o){var i={value1:n};void 0!==r&&(i.value2=r),o.setExtraData({action_value:i},!0)}},l}return v()(r,[{key:"onShiftCtrlUp",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v,g,b;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),a=this.selectionAPI.getSelection(),l=null===(o=a[0].selection)||void 0===o?void 0:o.start,u=null===(i=a[0].selection)||void 0===i?void 0:i.end,d=n.id,f=this.blockManager.getBlockModelByBlockId(d),h=f.parent,p=f.previousSibling,v=p.position,!h||!p||p===h){e.next=12;break}return e.next=11,this.blockManager.applyTransaction("keyevent:text:altup",(function(e){Object(Y.y)(e,[n.model]),Object(Y.t)(e,h.recordId,v,[n.record.id])}));case 11:d=h.children[v].id;case 12:g=this.blockManager.getBlockModelByBlockId(d),this.fold.handleBlockShow({topAffectedSib:g.previousSibling,midAffectedSib:g.nextSibling,btmAffectedSib:null===(c=g.nextSibling)||void 0===c?void 0:c.nextSibling}),"number"===typeof l&&"number"===typeof u&&((b=this.blockManager.getBlockViewByBlockIdNotCheck(d)).model.setSelection({start:l,len:u-l},!0),this.viewport.scrollToBlock(b.id));case 15:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onShiftCtrlDown",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v,g;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),c=this.selectionAPI.getSelection(),a=null===(o=c[0].selection)||void 0===o?void 0:o.start,l=null===(i=c[0].selection)||void 0===i?void 0:i.end,u=n.id,d=this.blockManager.getBlockModelByBlockId(u),f=d.parent,h=d.nextSibling,p=h.position,!f||!h){e.next=12;break}return e.next=11,this.blockManager.applyTransaction("keyevent:text:altdown",(function(e){Object(Y.y)(e,[n.model]),Object(Y.t)(e,f.recordId,p,[n.record.id])}));case 11:u=f.children[p].id;case 12:v=this.blockManager.getBlockModelByBlockId(u),this.fold.handleBlockShow({midAffectedSib:v.previousSibling,btmAffectedSib:v.nextSibling}),"number"===typeof a&&"number"===typeof l&&((g=this.blockManager.getBlockViewByBlockIdNotCheck(u)).model.setSelection({start:a,len:l-a},!0),this.viewport.scrollToBlock(g.id));case 15:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onMetaEnter",value:function(e,n){R.M.includes(e.type)||(n.preventDefault(),n.stopPropagation(),this.insertTextBlock(e,1))}},{key:"onMetaShiftEnter",value:function(e,n){R.M.includes(e.type)||(n.preventDefault(),n.stopPropagation(),this.insertTextBlock(e,0))}},{key:"onShiftCmdUp",value:function(e){var n=[R.B.CELL,R.B.CALLOUT,R.B.GRID_COLUMN];if(e.props.parentId){var r=this.blockManager.getBlockViewByBlockId(e.props.parentId);if(n.includes(r.type))return!0}var o=this.blockManager.rootBlockId,i=this.blockManager.getBlockModelByBlockId(o).children,c=e.model.getSelection();if(c){for(var a=e,l=c.isCollapsed()&&D.C(c)?0:1,s=Object(Or.q)(this.blockManager.getBlockModelByBlockId(e.id)),u=0;u<s-1;u++)a=this.blockManager.getBlockViewByBlockId(a.props.parentId);var d=i.slice(0,a.model.position+l),f=Object(ie.h)(d.map((function(e){return e.id})),this.blockManager);this.selectionAPI.setSelection(f)}}},{key:"onShiftCmdDown",value:function(e){var n=[R.B.CELL,R.B.CALLOUT,R.B.GRID_COLUMN];if(e.props.parentId){var r=this.blockManager.getBlockViewByBlockId(e.props.parentId);if(n.includes(r.type))return!0}var o=this.blockManager.rootBlockId,i=this.blockManager.getBlockModelByBlockId(o).children,c=e.model.getSelection();if(c){for(var a=e,l=c.isCollapsed()&&D.X(c)?1:0,s=Object(Or.q)(this.blockManager.getBlockModelByBlockId(e.id)),u=0;u<s-1;u++)a=this.blockManager.getBlockViewByBlockId(a.props.parentId);var d=i.slice(this.blockManager.getBlockModelByBlockId(a.id).position+l),f=Object(ie.h)(d.map((function(e){return e.id})),this.blockManager);this.selectionAPI.setSelection(f)}}},{key:"onCtrlUp",value:function(e,n,r){return this.onArrowUp(e,n,r)}},{key:"onCtrlDown",value:function(e,n,r){return this.onArrowDown(e,n,r)}},{key:"onCtrlLeft",value:function(e,n,r){n.preventDefault();var o=this.selectionAPI.getSelection()[0].selection,i=e.model.getSelection();if(i)if(i.isCollapsed()&&D.C(i))this.onArrowLeft(e,n,r);else{if(!o)return;if(o.start!==o.end){var c=o.start,a=[{id:e.id,type:L.j.TEXT,selection:{start:c,end:c}}];this.selectionAPI.setSelection(a)}else{var l=o.start-1,s=[{id:e.id,type:L.j.TEXT,selection:{start:l,end:l}}];this.selectionAPI.setSelection(s)}}}},{key:"onCtrlRight",value:function(e,n,r){n.preventDefault();var o=this.selectionAPI.getSelection()[0].selection,i=e.model.getSelection();if(i){var c=D.X(i);if(i.isCollapsed()&&c)this.onArrowRight(e,n,r);else{if(!o)return;if(o.start!==o.end){var a=o.end,l=[{id:e.id,type:L.j.TEXT,selection:{start:a,end:a}}];this.selectionAPI.setSelection(l)}else{var s=o.start+1,u=[{id:e.id,type:L.j.TEXT,selection:{start:s,end:s}}];this.selectionAPI.setSelection(u)}}}}},{key:"onArrowUp",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.target[0],e.next=3,this.shouldJump(i,!1);case 3:if(!(c=e.sent)||this.shouldHandleArrowUpOrDown(n,!1,o)){e.next=6;break}return e.abrupt("return",!0);case 6:c&&(this.jumpToClosetBlockAndCaret(i,pe.j.UP),r.preventDefault());case 7:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"onArrowDown",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i,c,a,l,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.target[0],e.next=3,this.shouldJump(i,!0);case 3:if(c=e.sent,a=we(n.id,this.blockManager),l=a.isLastNoEmptyBlock,u=a.blockId,!c||!l){e.next=9;break}return Object(X.A)(this.blockManager,this.selectionAPI,this.viewport,u),r.preventDefault(),e.abrupt("return");case 9:if(!(o.propagationToTableCell||c&&!this.shouldHandleArrowUpOrDown(n,!0,o))){e.next=11;break}return e.abrupt("return",!0);case 11:c&&(this.jumpToClosetBlockAndCaret(n,pe.j.DOWN),r.preventDefault());case 12:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"onArrowLeft",value:function(e,n,r){if(r.target[0].id===e.id&&!this.shouldHandleArrowUpOrDown(e,!1,r))return!0;this.jumpToClosetBlockAndCaret(e,pe.j.LEFT),n.preventDefault()}},{key:"onArrowRight",value:function(e,n,r){if(r.target[0].id===e.id&&!this.shouldHandleArrowUpOrDown(e,!1,r))return!0;this.blockManager.dispatch(_r.b),document.querySelector(".docx-menu-wrapper")||this.jumpToClosetBlockAndCaret(e,pe.j.RIGHT),n.preventDefault()}},{key:"onDelete",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),(o=this.blockManager.getBlockModelByBlockId(n.id)).next&&o.children){e.next=4;break}return e.abrupt("return");case 4:i=o.next.id,e.prev=5,c=this.blockManager.getBlockViewByBlockId(i),e.next=15;break;case 9:return e.prev=9,e.t0=e.catch(5),Object(br.n)(e.t0),this.blockManager.applyTransaction("keyevent:text:delete",(function(e){Object(Y.y)(e,[i],p.blockManager)}),{undoable:!1}),r.preventDefault(),e.abrupt("return");case 15:if(c){e.next=17;break}return e.abrupt("return");case 17:return e.next=19,this.blockManager.layoutManager.renderNodeById(i);case 19:a=this.blockManager.getBlockViewByBlockId(i),(l=this.fold.getFoldStateById(a.id))&&l.foldedBy&&(a=this.blockManager.getBlockViewByBlockId(l.foldedBy));case 22:if(!Object(ie.N)(a.type)){e.next=30;break}if(d=a.id,f=null===(u=this.blockManager.getBlockModelByBlockId(d).next)||void 0===u?void 0:u.id){e.next=27;break}return e.abrupt("break",30);case 27:a=this.blockManager.getBlockViewByBlockId(f),e.next=22;break;case 30:if(Object(j.U)(a)&&a.type!==R.B.CODE){e.next=36;break}if(n.model.isEmpty&&be(this.blockManager,n),a.type!==R.B.CELL){e.next=34;break}return e.abrupt("return");case 34:return this.selectionAPI.setSelection([{type:L.j.BLOCK,id:a.id}]),e.abrupt("return");case 36:return h=n.model.zoneState.totalWidth()-1,e.next=39,this.blockManager.applyTransaction("keyevent:text:backspace",(function(e){Ee(e,a,n)}));case 39:n.model.setSelection({start:h,len:0},!0);case 40:case"end":return e.stop()}}),e,this,[[5,9]])})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onBackspace",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i,c,a,l,u,d,f,h,p,v,g,b,y,m,_,k,O,x,E,S,C,I,B,T,w=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),a=new KeyboardEvent(r.type,r),l=new vr.w(a,a.target),n.editor.triggerEditorEvent(Er.f.STOPPED_KEYDOWN,l),n.type!==R.B.TEXT||!Object(Z.R)(n)){e.next=9;break}return e.next=7,this.setTextIndent(n,!1);case 7:return this.setCollectParams(o,pe.f.untab,pe.f.startTab),e.abrupt("return");case 9:if(u=this.blockManager.getBlockModelByBlockId(n.id),!(d=u.record.snapshot.align)||d===R.D.LEFT){e.next=15;break}return this.blockManager.applyTransaction("blockTextAlign",(function(e){e.replace(n.record.id,["align"],d===R.D.RIGHT?R.D.CENTER:R.D.LEFT)})),this.setCollectParams(o,pe.f.unalign),e.abrupt("return");case 15:if(u.previous&&u.parent){e.next=17;break}return e.abrupt("return");case 17:return f=u.previous.id,e.next=20,this.blockManager.layoutManager.renderNodeById(f);case 20:if(h=this.blockManager.getBlockViewByBlockIdNotCheck(f)){e.next=26;break}return this.blockManager.applyTransaction("keyevent:text:backspace",(function(e){return Object(Y.y)(e,[f],w.blockManager)}),{undoable:!1}),r.preventDefault(),this.setCollectParams(o,pe.f.deleteBlock),e.abrupt("return");case 26:if(p=null===(i=u.previousSibling)||void 0===i?void 0:i.id,v=p&&this.blockManager.getBlockViewByBlockId(p),g=R.Z.find((function(e){return v&&v.type===e})),!v||!g){e.next=37;break}for(b=h.props.parentId,y=b&&this.blockManager.getBlockViewByBlockId(b);y&&y.type!==g;)b=y.props.parentId,y=b&&this.blockManager.getBlockViewByBlockId(b);return n.model.isEmpty&&be(this.blockManager,n),y&&this.selectionAPI.setSelection([{id:y.id,type:L.j.BLOCK}],{source:L.q.Backspace}),this.setCollectParams(o,pe.f.deleteBlock),e.abrupt("return");case 37:h.type===R.B.GRID_COLUMN&&u.previous.previous&&(h=this.blockManager.getBlockViewByBlockId(u.previous.previous.id)),(m=this.fold.getFoldStateById(h.id))&&m.foldedBy&&(h=this.blockManager.getBlockViewByBlockId(m.foldedBy));case 41:if(!Object(ie.N)(h.type)){e.next=48;break}if(_=h.model.previous){e.next=45;break}return e.abrupt("break",48);case 45:h=this.blockManager.getBlockViewByBlockId(_.id),e.next=41;break;case 48:if((null===(c=u.previousSibling)||void 0===c?void 0:c.record.snapshot.type)===R.B.CALLOUT&&(h=this.blockManager.getBlockViewByBlockId(u.previousSibling.id)),h.type!==R.B.QUOTE_CONTAINER){e.next=62;break}if(1!==h.model.children.length){e.next=62;break}return e.prev=52,k=this.blockManager.getBlockViewByBlockId(u.id),this.batchTurninto(k,R.B.QUOTE_CONTAINER),this.setCollectParams(o,pe.f.deleteBlock),e.abrupt("return");case 59:return e.prev=59,e.t0=e.catch(52),e.abrupt("return");case 62:if(Object(vt.K)(u.id,this.blockManager)||Object(ue.x)(this.blockManager.getBlockViewByBlockId(u.id),this.blockManager)){e.next=72;break}O=u.previous;case 64:if(!O||O.type===R.B.PAGE){e.next=72;break}if(![R.B.CALLOUT,R.B.TABLE].includes(O.type)){e.next=69;break}return f=O.id,h=this.blockManager.getBlockViewByBlockIdNotCheck(f),e.abrupt("break",72);case 69:O=O.parent,e.next=64;break;case 72:if(Object(j.U)(h)&&h.type!==R.B.CODE){e.next=84;break}if(n.model.isEmpty&&(be(this.blockManager,n),this.setCollectParams(o,pe.f.deleteBlock)),h.type!==R.B.CELL){e.next=77;break}return 1===h.props.model.children.length&&h.props.model.children[0].type===R.B.TEXT&&setTimeout((function(){w.selectionAPI.setSelection([{id:h.props.model.children[0].id,type:L.j.TEXT,selection:{start:0,end:0}}])})),e.abrupt("return");case 77:if(h.type!==R.B.CODE){e.next=82;break}return x=h.model.zoneState,E=x.totalWidth()-1,this.selectionAPI.setSelection([{id:h.id,type:L.j.TEXT,selection:{start:E,end:E}}]),e.abrupt("return");case 82:return this.selectionAPI.setSelection([{type:L.j.BLOCK,id:h.id}],{source:L.q.Backspace}),e.abrupt("return");case 84:if(S=u.parent,C=S.parent,R.h.includes(S.type)||u.nextSibling||!C){e.next=90;break}return e.next=89,this.onUnTab(n,r,o);case 89:return e.abrupt("return");case 90:return I=h.model.zoneState,B=I.totalWidth()-1,T=this.blockManager.applyTransaction("keyevent:text:backspace",(function(e){Ee(e,n,h)})),e.next=95,T;case 95:this.selectionAPI.setSelection([{id:h.id,type:L.j.TEXT,selection:{start:B,end:B}}],{source:L.q.Backspace}),this.setCollectParams(o,pe.f.deleteBlock);case 97:case"end":return e.stop()}}),e,this,[[52,59]])})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"onShiftEnter",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(C.S.isIOS||C.S.isIPad&&!yr.S.isIPadLarkHandware())){e.next=4;break}return e.next=3,this.onEnter(n,r);case 3:return e.abrupt("return");case 4:if(o=n.model,i=n.model.getSelection()){e.next=8;break}return e.abrupt("return");case 8:return n.model.replaceEditorText(i,"\n",{}),e.next=11,n.blockManager.layoutManager.waitForNextPaint();case 11:c=i.toPosition(),o.setSelection(wr(wr({},c),{},{start:c.start+1,len:0}),!0),a=new vr.w(r,r.target),n.editor.triggerEditorEvent(Er.f.AFTER_SHIFT_ENTER,a);case 15:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onEnter",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v,g,b,y,m,_,k,O,x,E,S,C,I,B=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.model,i=o.parent,c=null===i||void 0===i?void 0:i.parent,i){e.next=5;break}return e.abrupt("return");case 5:if(a=new vr.w(r,r.target),l=n.editor.triggerEditorEvent(Er.f.ENTER,a),u=l.shouldStop,d=l.shouldPrevent,!u||!d){e.next=9;break}return e.abrupt("return");case 9:if(r.preventDefault(),f=n.id,h=this.blockManager.getBlockViewByBlockId(i.id),i.type!==R.B.QUOTE_CONTAINER||!o.zoneState.isEmpty()||i.children[i.children.length-1].id!==n.id){e.next=20;break}return e.next=15,Object(te.z)({blockManager:this.blockManager,block:n});case 15:return p=e.sent,f=p[0],v=this.blockManager.getBlockViewByBlockId(f),Object(j.U)(v)&&v.model.setSelection({start:0,len:0},!0),e.abrupt("return");case 20:if(g=Object(R.q)().includes(h.type),b=o.zoneState,y=!o.children.length&&b.isEmpty(),m=!o.nextSibling&&o.previousSibling,!(y&&m&&g&&c)){e.next=29;break}_=this.blockManager.applyTransaction("keyevent:text:enter",(function(e){Object(Y.y)(e,[n.model]),Object(Y.t)(e,c.recordId,i.position+1,[n.record.id])})),f=c.children[i.position+1].id,e.next=38;break;case 29:if(k=n.model.getSelection()){e.next=32;break}return e.abrupt("return");case 32:O=b.split(k),x=[O[0].toAttributeText(),O[1].toAttributeText()],E=D.C(k),S="",_=this.blockManager.applyTransaction("keyevent:text:enter",(function(e){if(E){var n=Object(xr.u)({text:x[0]});Object(ae.w)(e,o.record,x[1]),Object(Y.l)(e,i.recordId,o.position,[n]),S=o.recordId}else{var r=xe(B.blockManager,o,e,B.fold,x);S=r.newRecordId}})),f=this.blockManager.getBlockIdsByRecordId(S)[0];case 38:return e.next=40,_;case 40:C=this.blockManager.getBlockViewByBlockId(f),Object(j.U)(C)&&(this.selectionAPI.setSelection([{type:L.j.TEXT,id:f,selection:{start:0,end:0}}]),F.S.emit(F.p.COMMON.ADJUST_VIEWPORT)),I=new vr.w(r,r.target),n.editor.triggerEditorEvent(Er.f.AFTER_ENTER,I);case 44:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onTab",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i,c,a,l,u,d,f,h,p,v,g,b,y,m,_=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=Object(Z.T)(n,o),a=!1,l=pe.f.blockTab,u="false",e.t0=c,e.next=e.t0===Z.z.INNER_TAB?7:e.t0===Z.z.BLOCK_INDENT?8:e.t0===Z.z.TEXT_INDENT?13:19;break;case 7:return e.abrupt("break",24);case 8:return r.preventDefault(),e.next=11,this.handleBlockIndent(n);case 11:return u="true",e.abrupt("break",24);case 13:return r.preventDefault(),e.next=16,this.setTextIndent(n,!0);case 16:return u="true",l=pe.f.startTab,e.abrupt("break",24);case 19:r.preventDefault(),d=n.model,f=null===(i=d.parent)||void 0===i?void 0:i.record.snapshot.type,(a=!(!f||![R.B.CELL,R.B.GRID_COLUMN].includes(f)))||(h=Object(Z.S)(),p=h.getState(),v=p.showingTips,g=p.blockId,b=p.prevBrotherBlockIds,v&&g===n.id?(y=[g].concat(W()(b)).reverse().map((function(e){return _.blockManager.getBlockViewByBlockId(e)})),m=Object(re.Z)(y,this.blockManager.editorAPI),me(this.blockManager,this.selectionAPI,m,y),h.reset(),Object(Q.N)("ccm_doc_content_page_click",{click:"double_tab_brother_block"})):this.showTabFailTips(n,c));case 24:return this.setCollectParams(o,l,u),F.S.emit(F.p.COMMON.TAB_STATUS_CHANGE),e.abrupt("return",a);case 27:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"handleBlockIndent",value:function(){var e=d()(s.a.mark((function e(n){var r,o,i,c,a,l,u,d,f,h,p,v,g=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.blockManager.getBlockModelByBlockId(n.id),o=r.previousSibling,i=this.blockManager.getBlockViewByBlockId(o.id),c=[n.id],R.O.includes(n.type)&&c.push.apply(c,W()(this.fold.findFoldedBlocks(n.id))),a=n.model.getSelection(),l=c.map((function(e){return g.blockManager.getBlockModelByBlockId(e).record.id})),u=o.children.length,!(d=this.blockManager.editorAPI.getService(P.N,{optional:!0}))||c.every((function(e){var n=g.blockManager.getBlockModelByBlockId(e);if(!n||!n.parent)return!0;var r=d.canBlockEdit(n.parent.record,n.parent.type||"",{type:"DELETE_CHILD",index:n.position});return r||(f=n.parent.record),r}))){e.next=12;break}return Object(oe.A)({op_source:"keyboard",op_type:"indent",edit_type:"DELETE_CHILD",interceptedRecord:f}),e.abrupt("return");case 12:return this.blockManager.applyTransaction("keyevent:text:tab",(function(e){Object(Y.y)(e,c,g.blockManager),Object(Y.t)(e,i.model.record.id,u,l),l.forEach((function(n){e.replace(n,["parent_id"],i.model.record.id)}))}),{mergeMode:K.f.SPLIT}),e.next=15,Object(K.E)(0);case 15:h=i.model.children.slice(u,u+l.length).map((function(e){return e.id})),p=this.blockManager.getBlockViewByBlockId(h[0]),Object(j.U)(p)&&a&&(v=a.toPosition(),this.selectionAPI.setSelection([{id:p.id,type:L.j.TEXT,selection:{start:v.start,end:v.start+v.len}}]));case 18:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"setTextIndent",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.blockManager.applyTransaction("keyevent:text:tab",(function(e){e.replace(n.record.id,["text_indent"],r?1:0)}));case 2:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"showTabFailTips",value:function(e,n){Object(Z.J)(this.blockManager,n,e.id,Z.d.above_block,!0,!0,!0)}},{key:"onUnTab",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i,c,a,l,u,d,f,h,p,v,g,b,y,m,_,k=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!R.M.includes(n.type)){e.next=2;break}return e.abrupt("return");case 2:if(i=n.id,c=n.record.id,!1!==(null===o||void 0===o?void 0:o.mouse)||!Object(Z.R)(n)||!Object(Z.I)(n)){e.next=9;break}return r.preventDefault(),e.next=7,this.setTextIndent(n,!1);case 7:return this.setCollectParams(o,pe.f.untab,pe.f.startTab),e.abrupt("return");case 9:if(!R.M.includes(n.type)){e.next=11;break}return e.abrupt("return");case 11:if(a=this.blockManager.getBlockModelByBlockId(i),l=a.parent,u=null===l||void 0===l?void 0:l.parent,l&&u){e.next=17;break}return r.preventDefault(),e.abrupt("return",!0);case 17:if(r.preventDefault(),d=this.blockManager.getBlockViewByBlockId(l.id),f=this.blockManager.getBlockViewByBlockId(u.id),Object(R.q)().includes(d.type)){e.next=22;break}return e.abrupt("return",!0);case 22:return h=l.children.slice(a.position+1).map((function(e){return e.id})),p=h.map((function(e){return k.blockManager.getBlockModelByBlockId(e).record.id})),v=n.model.getSelection(),g=l.position+1,b=l,y=l.nextSibling,this.setCollectParams(o,pe.f.untab,pe.f.blockTab),e.next=31,this.blockManager.applyTransaction("keyevent:text:untab",(function(e){Object(Y.y)(e,[i].concat(W()(h)),k.blockManager),Object(Y.t)(e,f.record.id,g,[c]),h.length&&(Object(R.q)().includes(n.type)?Object(Y.t)(e,c,a.children.length,p):Object(Y.t)(e,f.record.id,g+1,p))}));case 31:m=f.model.children[g],this.fold.handleBlockShow({topAffectedSib:b,midAffectedSib:m,btmAffectedSib:y}),_=this.blockManager.getBlockViewByBlockId(m.id),Object(j.U)(_)&&v&&_.model.setSelection(v,!0),F.S.emit(F.p.COMMON.TAB_STATUS_CHANGE);case 36:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"onSelectAll",value:function(e,n,r){n.preventDefault();var o=r.collector;if(r.target[0].id===e.id)return!!e.model.isSelectingAll()||(e.model.selectAll(),o&&o.setExtraData({action_value:{value1:ct.e.UN_SELECT_ALL_PAGE}},!0),Object(ct.E)(),!1);var i=[R.B.CELL,R.B.CALLOUT,R.B.GRID_COLUMN,R.B.PROGRESS];if(e.props.parentId){var c=this.blockManager.getBlockViewByBlockId(e.props.parentId);if(c.props.parentId&&!i.includes(c.type))return!0}this.selectionAPI.setSelection([{id:e.id,type:L.j.BLOCK}]),o&&o.setExtraData({action_value:{value1:ct.e.UN_SELECT_ALL_PAGE}},!0)}},{key:"onBold",value:function(e,n,r){n.preventDefault(),this.toggleMark(e,"bold",r),F.S.emit(ct.f.TEXT_TOOLBAR)}},{key:"onItalic",value:function(e,n,r){n.preventDefault(),this.toggleMark(e,"italic",r),F.S.emit(ct.f.TEXT_TOOLBAR)}},{key:"onUnderline",value:function(e,n,r){n.preventDefault(),this.toggleMark(e,"underline",r),F.S.emit(ct.f.TEXT_TOOLBAR)}},{key:"onStrikeThrough",value:function(e,n,r){n.preventDefault(),this.toggleMark(e,"strikethrough",r),F.S.emit(ct.f.TEXT_TOOLBAR)}},{key:"onComment",value:function(e,n){n.preventDefault(),this.commentModule.getCommentable()&&Re(this.commentModule,{selectedBlocks:this.selectionAPI.getSelection(),callSource:"TextBlockKeyEvents"})}},{key:"textAlignLeft",value:function(e,n){this.alignBlock(e,R.D.LEFT,n)}},{key:"textAlignCenter",value:function(e,n){this.alignBlock(e,R.D.CENTER,n)}},{key:"textAlignRight",value:function(e,n){this.alignBlock(e,R.D.RIGHT,n)}},{key:"onTextHighlight",value:function(e,n,r){var o;n.preventDefault();var i=(null===(o=window.User)||void 0===o?void 0:o.id)||"",c=Object(ee.M)(i),a=c.color,l=c.backgroundColor;this.toggleMark(e,"textHighlightBackground",r,l),this.toggleMark(e,"textHighlight",r,a),F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}},{key:"onInlineCode",value:function(e,n,r){n.preventDefault(),n.stopImmediatePropagation(),this.toggleMark(e,"inlineCode",r),F.S.emit(ct.f.TEXT_TOOLBAR)}},{key:"onShiftArrowUp",value:function(e){Object(gr.P)()||this.selectionAPI.setSelection([{id:e.id,type:L.j.BLOCK}])}},{key:"onShiftArrowLeft",value:function(e,n){Object(gr.P)()?this.selectAdjacentBlock(e,!0,n):this.selectionAPI.setSelection([{id:e.id,type:L.j.BLOCK}])}},{key:"selectAdjacentBlock",value:function(e,n,r){var o=this.selectionAPI.getSelection(),i=n?e.model.previous:e.model.next;if(i){var c=Object(j.i)(i),a={id:i.id,type:c?L.j.TEXT:L.j.BLOCK};if(c){var l=i.getText().length,s={start:l,end:l};a.selection=n?s:{start:0,end:0}}n?o.unshift(a):o.push(a),this.selectionAPI.setSelection(o),r.preventDefault()}}},{key:"onShiftArrowDown",value:function(e){Object(gr.P)()||this.selectionAPI.setSelection([{id:e.id,type:L.j.BLOCK}])}},{key:"onShiftArrowRight",value:function(e,n){Object(gr.P)()?this.selectAdjacentBlock(e,!1,n):this.selectionAPI.setSelection([{id:e.id,type:L.j.BLOCK}])}},{key:"onLink",value:function(e,n){n.preventDefault(),Object(Cr.g)(e.model);var r=e.id,o="".concat(Date.now());if(Object(kr.i)(e)){var i=e.model.getSelection();if(i){this.selectionAPI.isCursor(this.selectionAPI.getSelection())||e.model.setAttributes(i,a()({},Sr.h,o),{extra:{shouldCollab:!1}});var c=e.model.zoneState.getModelText(),l=i.isCollapsed(),s=i.toPosition(),u={token:o,text:c.slice(s.start,s.start+s.len),selection:i,renderType:l?mr.N.basic:mr.N.onlyLink};e.blockManager.dispatch(mr.q,[r,u]),F.S.emit(ct.f.TEXT_TOOLBAR)}}}},{key:"onExit",value:function(e){document.querySelector(".docx-menu-wrapper")||this.selectionAPI.setSelection([{id:e.id,type:L.j.BLOCK}])}},{key:"onCollapse",value:function(e,n){if(n.preventDefault(),Object(Br.sM)(e.id,this.blockManager))return this.blockManager.applyTransaction("collapse",(function(n){return n.replace(e.record.id,["folded"],!0)}))}},{key:"onExpand",value:function(e,n){n.preventDefault(),(Object(R.q)().includes(e.type)||R.O.includes(e.type))&&this.blockManager.applyTransaction("expand",(function(n){return n.replace(e.record.id,["folded"],!1)}))}},{key:"toggleMark",value:function(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"true",i=e.model.getSelection();if(i){var c=!1,a=Object(ne.G)(e.model.zoneState,i);if(i.isCollapsed()){var l=D.h(i),s=l.start,u=e.model.contentState.getInlineStyleOverride({zoneId:i.start.zoneId,start:s});c=a[n]===o||u[n]===o}else{var d=Object(j.w)(e.model,i);c=a[n]===o||d[n]===o}var f=r.collector;f&&f.setExtraData({action_value:{value1:c?"false":"true"}},!0),e.editor.toggleAttribute(n,o)}}},{key:"alignBlock",value:function(e,n,r){r.preventDefault();var o=C.S.isMobile&&!this.selectionAPI.isCollapsedTextSelection(),i=Object($.C)({blocks:[this.blockManager.getBlockModelByBlockId(e.id)],blockManager:this.blockManager,recursive:!o,fold:this.fold});this.blockManager.applyTransaction("blockTextAlign",(function(e){i.forEach((function(r){return e.replace(r.record.id,["align"],n)}))})),F.S.emit(ct.f.TEXT_TOOLBAR)}},{key:"shouldHandleArrowUpOrDown",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,o=this.blockManager.findClosestBlockViewByBlockId(e.id,n,this.isBlockActive);return!o||![R.B.CELL].includes(o.type)||(r.propagationToTableCell=!0,!1)}},{key:"shouldJump",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.model.getSelection()){e.next=3;break}return e.abrupt("return",!1);case 3:if(D.O(o)){e.next=6;break}return e.abrupt("return",!0);case 6:if(i=!r&&D.R(o),c=r&&D.k(o),!(o.isCollapsed()&&(r?!c&&D.uq(o):i))){e.next=19;break}if(!D.J(o)){e.next=19;break}return e.next=14,Object(K.E)(0);case 14:if(a=window.getSelection(),!(l=(null===a||void 0===a?void 0:a.anchorNode)&&Object(Ir.S)(a.anchorNode))||n.editorAPI.modelService.getBlockModelByBlockId(l)!==n.model){e.next=18;break}return e.abrupt("return",!1);case 18:return e.abrupt("return",!0);case 19:return e.abrupt("return",i||c);case 20:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"jumpToClosetBlockAndCaret",value:function(e,n){var r=n===pe.j.DOWN||n===pe.j.RIGHT,o=n===pe.j.UP||n===pe.j.DOWN;if(r&&Object(R.q)().includes(e.type)&&e.model.children.length){var i=this.blockManager.getBlockViewByBlockId(e.model.children[0].id);if(this.isBlockActive(i))return void this.focusOnBlock(this.blockManager.getBlockViewByBlockId(e.model.children[0].id),o,r)}var c=this.findSiblingContainer(e.id,r);if(c)this.focusOnContainer(c,o,r);else{var a=this.blockManager.findClosestBlockViewByBlockId(e.id,r,this.isBlockActive);if(a)return this.isContainer(a.type)&&this.isEscapeFromContainer(a,e,r)?this.jumpToClosetBlockAndCaret(a,n):void this.focusOnBlock(a,o,r)}}},{key:"insertTextBlock",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.blockManager.getBlockModelByBlockId(n.id),i=o.parent,c=[].concat(W()(R.BM),[R.B.QUOTE]).includes(n.type),!i){e.next=9;break}return e.next=6,this.blockManager.applyTransaction("keyevent:text:inserttext",(function(e){Object(Y.l)(e,i.record.id,o.position+r,[u.blockManager.createInitModel(c?n.type:R.B.TEXT)])}));case 6:a=i.children[o.position+r].id,l=this.blockManager.getBlockViewByBlockId(a),Object(j.U)(l)&&l.focus();case 9:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()}]),r}(Kt),lr=sr,G()(lr.prototype,"onShiftCtrlUp",[an,ln],Object.getOwnPropertyDescriptor(lr.prototype,"onShiftCtrlUp"),lr.prototype),G()(lr.prototype,"onShiftCtrlDown",[sn,un],Object.getOwnPropertyDescriptor(lr.prototype,"onShiftCtrlDown"),lr.prototype),G()(lr.prototype,"onMetaEnter",[dn,fn],Object.getOwnPropertyDescriptor(lr.prototype,"onMetaEnter"),lr.prototype),G()(lr.prototype,"onMetaShiftEnter",[hn,pn],Object.getOwnPropertyDescriptor(lr.prototype,"onMetaShiftEnter"),lr.prototype),G()(lr.prototype,"onCtrlUp",[vn],Object.getOwnPropertyDescriptor(lr.prototype,"onCtrlUp"),lr.prototype),G()(lr.prototype,"onCtrlDown",[gn],Object.getOwnPropertyDescriptor(lr.prototype,"onCtrlDown"),lr.prototype),G()(lr.prototype,"onCtrlLeft",[bn],Object.getOwnPropertyDescriptor(lr.prototype,"onCtrlLeft"),lr.prototype),G()(lr.prototype,"onCtrlRight",[yn],Object.getOwnPropertyDescriptor(lr.prototype,"onCtrlRight"),lr.prototype),G()(lr.prototype,"onArrowUp",[mn],Object.getOwnPropertyDescriptor(lr.prototype,"onArrowUp"),lr.prototype),G()(lr.prototype,"onArrowDown",[_n],Object.getOwnPropertyDescriptor(lr.prototype,"onArrowDown"),lr.prototype),G()(lr.prototype,"onArrowLeft",[kn],Object.getOwnPropertyDescriptor(lr.prototype,"onArrowLeft"),lr.prototype),G()(lr.prototype,"onArrowRight",[On],Object.getOwnPropertyDescriptor(lr.prototype,"onArrowRight"),lr.prototype),G()(lr.prototype,"onDelete",[xn,En],Object.getOwnPropertyDescriptor(lr.prototype,"onDelete"),lr.prototype),G()(lr.prototype,"onBackspace",[Sn,Cn],Object.getOwnPropertyDescriptor(lr.prototype,"onBackspace"),lr.prototype),G()(lr.prototype,"onShiftEnter",[In,Bn],Object.getOwnPropertyDescriptor(lr.prototype,"onShiftEnter"),lr.prototype),G()(lr.prototype,"onEnter",[Tn,wn],Object.getOwnPropertyDescriptor(lr.prototype,"onEnter"),lr.prototype),G()(lr.prototype,"onTab",[Rn,Mn],Object.getOwnPropertyDescriptor(lr.prototype,"onTab"),lr.prototype),G()(lr.prototype,"onUnTab",[jn,Dn],Object.getOwnPropertyDescriptor(lr.prototype,"onUnTab"),lr.prototype),G()(lr.prototype,"onBold",[An,Pn],Object.getOwnPropertyDescriptor(lr.prototype,"onBold"),lr.prototype),G()(lr.prototype,"onItalic",[Ln,Nn],Object.getOwnPropertyDescriptor(lr.prototype,"onItalic"),lr.prototype),G()(lr.prototype,"onUnderline",[Fn,Un],Object.getOwnPropertyDescriptor(lr.prototype,"onUnderline"),lr.prototype),G()(lr.prototype,"onStrikeThrough",[Hn,Vn],Object.getOwnPropertyDescriptor(lr.prototype,"onStrikeThrough"),lr.prototype),G()(lr.prototype,"onComment",[Wn],Object.getOwnPropertyDescriptor(lr.prototype,"onComment"),lr.prototype),G()(lr.prototype,"textAlignLeft",[zn],Object.getOwnPropertyDescriptor(lr.prototype,"textAlignLeft"),lr.prototype),G()(lr.prototype,"textAlignCenter",[Gn],Object.getOwnPropertyDescriptor(lr.prototype,"textAlignCenter"),lr.prototype),G()(lr.prototype,"textAlignRight",[Kn],Object.getOwnPropertyDescriptor(lr.prototype,"textAlignRight"),lr.prototype),G()(lr.prototype,"onTextHighlight",[qn,Xn],Object.getOwnPropertyDescriptor(lr.prototype,"onTextHighlight"),lr.prototype),G()(lr.prototype,"onInlineCode",[Yn,Jn],Object.getOwnPropertyDescriptor(lr.prototype,"onInlineCode"),lr.prototype),G()(lr.prototype,"onShiftArrowUp",[Zn],Object.getOwnPropertyDescriptor(lr.prototype,"onShiftArrowUp"),lr.prototype),G()(lr.prototype,"onShiftArrowLeft",[Qn],Object.getOwnPropertyDescriptor(lr.prototype,"onShiftArrowLeft"),lr.prototype),G()(lr.prototype,"onShiftArrowDown",[$n],Object.getOwnPropertyDescriptor(lr.prototype,"onShiftArrowDown"),lr.prototype),G()(lr.prototype,"onShiftArrowRight",[er],Object.getOwnPropertyDescriptor(lr.prototype,"onShiftArrowRight"),lr.prototype),G()(lr.prototype,"onLink",[tr,nr],Object.getOwnPropertyDescriptor(lr.prototype,"onLink"),lr.prototype),G()(lr.prototype,"onExit",[rr],Object.getOwnPropertyDescriptor(lr.prototype,"onExit"),lr.prototype),G()(lr.prototype,"onCollapse",[or,ir],Object.getOwnPropertyDescriptor(lr.prototype,"onCollapse"),lr.prototype),G()(lr.prototype,"onExpand",[cr,ar],Object.getOwnPropertyDescriptor(lr.prototype,"onExpand"),lr.prototype),lr);function Lr(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var Nr=(Mr=ce({supportReadOnly:!1}),jr=ce({supportReadOnly:!1}),Dr=pr(),Ar=function(e){b()(r,e);var n=Lr(r);function r(){return h()(this,r),n.apply(this,arguments)}return v()(r,[{key:"onEnter",value:function(){var e=d()(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"onBackspace",value:function(){var e=d()(s.a.mark((function e(n){var r,o,i,c,a,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.model.getSelection()){e.next=3;break}return e.abrupt("return");case 3:o=r.start,i=o.offset,c=o.line,a=n.model.zoneState,l=a.getLine(0),0===c&&l&&r.isCollapsed()&&0===i&&this.selectionAPI.setSelection([{type:L.j.BLOCK,id:n.id}],{source:L.q.Backspace});case 8:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"onArrowUp",value:function(){var e=d()(s.a.mark((function e(n,o,i){var c,a,l,u,d,f,h;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=n.model.getSelection()){e.next=3;break}return e.abrupt("return");case 3:if(a=c.start,l=a.offset,u=a.line,d=n.model.zoneState,f=d.getLine(0),!(0===u&&f&&c.isCollapsed()&&l===f.length()-1)){e.next=15;break}if(this.shouldHandleArrowUpOrDown(n,!1,i)){e.next=10;break}return e.abrupt("return",!0);case 10:h=i.target[0],this.jumpToClosetBlockAndCaret(h,pe.j.UP),o.preventDefault(),e.next=16;break;case 15:return e.abrupt("return",fr()(k()(r.prototype),"onArrowUp",this).call(this,n,o,i));case 16:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()}]),r}(Pr),G()(Ar.prototype,"onEnter",[Mr],Object.getOwnPropertyDescriptor(Ar.prototype,"onEnter"),Ar.prototype),G()(Ar.prototype,"onBackspace",[jr],Object.getOwnPropertyDescriptor(Ar.prototype,"onBackspace"),Ar.prototype),G()(Ar.prototype,"onArrowUp",[Dr],Object.getOwnPropertyDescriptor(Ar.prototype,"onArrowUp"),Ar.prototype),Ar);function Fr(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var Ur,Hr,Vr,Wr,zr,Gr,Kr,qr,Xr,Yr=function(e){b()(r,e);var n=Fr(r);function r(e,o){var i;return h()(this,r),(i=n.call(this,e,o)).blockManager=e,i.selectionAPI=o,i}return v()(r,[{key:"onTab",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.jumpToColumn({blocks:n,event:r,forward:!0}));case 1:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onUnTab",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.jumpToColumn({blocks:n,event:r,forward:!1}));case 1:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"jumpToColumn",value:function(){var e=d()(s.a.mark((function e(n){var r,o,i,c,a,l,u,d,f,h,p;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.blocks,o=n.forward,i=n.event,c=r[0],a=this.blockManager.getBlockModelByBlockId(c.id),l=a.parent){e.next=6;break}return e.abrupt("return");case 6:if(!(u=o?a.nextSibling:a.previousSibling)){e.next=15;break}i.preventDefault(),d=this.blockManager.getBlockViewByBlockIdNotCheck(u.id),(f=u.children).length>0&&(d=o?this.blockManager.getBlockViewByBlockIdNotCheck(f[0].id):this.blockManager.getBlockViewByBlockIdNotCheck(f[f.length-1].id)),d&&this.focusOnBlock(d,!1,o),e.next=22;break;case 15:if(h=o?l.nextSibling:l.previousSibling){e.next=18;break}return e.abrupt("return",!o);case 18:return i.preventDefault(),(p=this.blockManager.getBlockViewByBlockIdNotCheck(h.id))&&this.focusOnBlock(p,!1,o),e.abrupt("return");case 22:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"onSelectAll",value:function(e,n,r){if(F.S.emit(F.p.MOBILE.BLOCK_MENU.HIDE_BLOCK_MENU),n.preventDefault(),this.selectionAPI.selectAll(),r){var o=r.collector;o&&o.setExtraData({action_value:{value1:ct.e.SELECT_ALL_PAGE}},!0)}}}]),r}(Kt);function Jr(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var Zr,Qr,$r,eo,to,no=(Ur=ce({supportReadOnly:!1}),Hr=pr({selection:"start"}),Vr=ce({supportReadOnly:!1}),Wr=pr(),zr=pr({selection:"cover-start"}),Gr=pr({selection:"cover-start"}),Kr=pr({selection:"cover-end"}),qr=pr({selection:"cover-end"}),Xr=function(e){b()(r,e);var n=Jr(r);function r(){return h()(this,r),n.apply(this,arguments)}return v()(r,[{key:"onBackspace",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v,g,b,y;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),o=new KeyboardEvent(r.type,r),i=new vr.w(o,o.target),n.editor.triggerEditorEvent(Er.f.STOPPED_KEYDOWN,i),c=n.record.snapshot.folded?[n.id]:[],a=this.blockManager.getBlockModelByBlockId(n.id),l=a.previous,u=a.previousSibling,d=n.record.snapshot,f=d.seq,h=d.seq_level,!f){e.next=13;break}return e.next=12,this.blockManager.applyTransaction("keyevent:heading:backspace",(function(e){e.remove(n.record.id,["seq"]),h&&e.remove(n.record.id,["seq_level"])}));case 12:return e.abrupt("return");case 13:if(!u){e.next=19;break}if(!((p=this.blockManager.getBlockViewByBlockId(u.id))&&Object(j.f)(p)&&R.hd.includes(p.type)&&p.model.isEmpty&&0===u.children.length&&this.fold.isShow(p.id))){e.next=19;break}return e.next=18,this.blockManager.applyTransaction("keyevent:heading:backspace",(function(e){Object(Y.y)(e,[p.model])}));case 18:return e.abrupt("return");case 19:if(Se((null===l||void 0===l?void 0:l.id)||st.V,this.blockManager,c,this.fold,"keyevent:heading:backspace"),v=this.blockManager.editorAPI.getService(P.N,{optional:!0}),g=a.record,!v||v.canBlockEdit(a.record,a.type,{type:"UPDATE_ATTRIBUTE",changedKey:"type",newValue:"text"})){e.next=25;break}return Object(oe.A)({op_source:"keyboard",op_type:"backspace",edit_type:"UPDATE_ATTRIBUTE",interceptedRecord:g}),e.abrupt("return");case 25:return e.next=27,Object(kt.S)(n,this.blockManager,R.B.TEXT);case 27:if(b=e.sent,y=this.blockManager.getBlockViewByBlockId(b[0]),this.blockManager.layoutManager.isBlockActive(y.id)){e.next=32;break}return e.next=32,this.viewport.scrollToBlock(y.id);case 32:Object(j.U)(y)&&y.focus();case 33:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onEnter",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v,g,b,y,m,_,k,O,x,E,S,C,I,B=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.blockManager.getBlockModelByBlockId(n.id),i=o.parent){e.next=4;break}return e.abrupt("return");case 4:if(c=new vr.w(r,r.target),a=n.editor.triggerEditorEvent(Er.f.ENTER,c),l=a.shouldStop,u=a.shouldPrevent,!l||!u){e.next=8;break}return e.abrupt("return");case 8:if(d=n.record.id,f=this.fold.getFoldStateById(n.id),h=o.record.snapshot,p=h.seq,v=void 0===p?void 0:p,g=h.seq_level,b=void 0===g?void 0:g,y=n.model.isEmpty,m=n.model.getSelection()){e.next=15;break}return e.abrupt("return");case 15:return _=n.model.zoneState.split(m),k=[_[0].toAttributeText(),_[1].toAttributeText()],O=D.C(m),x=D.X(m),E=this.selectionAPI.isCursor(),S=n.model.isSelectingAll()&&!E,e.next=23,this.blockManager.applyTransaction("keyevent:heading:enter",(function(e){if(O&&!S)if(e.replace(n.record.id,["text"],k[1]),y)if(v)e.remove(n.record.id,["seq"]),b&&e.remove(n.record.id,["seq_level"]);else{var r={text:k[0]};d=xe(B.blockManager,o,e,B.fold,k,R.B.TEXT,r).newRecordId}else{var c=n.type,a={text:k[0]};v&&(e.replace(o.recordId,["seq"],"auto"),b&&e.replace(o.recordId,["seq_level"],"auto"),a.seq=v,a.seq_level=b||"auto"),Object(j.Wk)(e,i.recordId,o.position,B.blockManager.createInitModel(c,a))}else{var l={text:k[1]};!v||!(null===f||void 0===f?void 0:f.folded)&&x||(l.seq="auto",l.seq_level="auto"),d=xe(B.blockManager,o,e,B.fold,k,x?R.B.TEXT:void 0,l).newRecordId}}));case 23:C=this.blockManager.getBlockViewsByRecordId(d)[0],Object(j.U)(C)&&this.selectionAPI.setSelection([{type:L.j.TEXT,id:C.id,selection:{start:0,end:0}}]),I=new vr.w(r,r.target),n.editor.triggerEditorEvent(Er.f.AFTER_ENTER,I);case 27:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"setSelection",value:function(e){var n=this.fold.findFoldedBlocks(e.id).map((function(e){return{id:e,type:L.j.BLOCK}}));this.selectionAPI.setSelection([{id:e.id,type:L.j.BLOCK}].concat(W()(n)))}},{key:"onShiftArrowUp",value:function(e){Object(gr.P)()||this.setSelection(e)}},{key:"onShiftArrowLeft",value:function(e){Object(gr.P)()||this.setSelection(e)}},{key:"onShiftArrowDown",value:function(e){Object(gr.P)()||this.setSelection(e)}},{key:"onShiftArrowRight",value:function(e){Object(gr.P)()||this.setSelection(e)}}]),r}(Pr),G()(Xr.prototype,"onBackspace",[Ur,Hr],Object.getOwnPropertyDescriptor(Xr.prototype,"onBackspace"),Xr.prototype),G()(Xr.prototype,"onEnter",[Vr,Wr],Object.getOwnPropertyDescriptor(Xr.prototype,"onEnter"),Xr.prototype),G()(Xr.prototype,"onShiftArrowUp",[zr],Object.getOwnPropertyDescriptor(Xr.prototype,"onShiftArrowUp"),Xr.prototype),G()(Xr.prototype,"onShiftArrowLeft",[Gr],Object.getOwnPropertyDescriptor(Xr.prototype,"onShiftArrowLeft"),Xr.prototype),G()(Xr.prototype,"onShiftArrowDown",[Kr],Object.getOwnPropertyDescriptor(Xr.prototype,"onShiftArrowDown"),Xr.prototype),G()(Xr.prototype,"onShiftArrowRight",[qr],Object.getOwnPropertyDescriptor(Xr.prototype,"onShiftArrowRight"),Xr.prototype),Xr),ro=r("dx_r61a"),oo=r("dx_XlRC");function io(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function co(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?io(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):io(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ao(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var lo,so,uo,fo,ho,po,vo,go,bo,yo,mo,_o,ko,Oo,xo,Eo,So,Co,Io=(Zr=ce({supportReadOnly:!1}),Qr=pr({selection:"start"}),$r=ce({supportReadOnly:!1}),eo=pr(),to=function(e){b()(r,e);var n=ao(r);function r(){return h()(this,r),n.apply(this,arguments)}return v()(r,[{key:"onBackspace",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),o=new KeyboardEvent(r.type,r),i=new vr.w(o,o.target),n.editor.triggerEditorEvent(Er.f.STOPPED_KEYDOWN,i),c=this.blockManager.getBlockModelByBlockId(n.id),c.parent){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,Object(kt.S)(n,this.blockManager,R.B.TEXT);case 10:a=e.sent,l=this.blockManager.getBlockViewByBlockId(a[0]),Object(j.U)(l)&&l.focus();case 13:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onEnter",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v,g,b,y,m,_,k,O,x,E,S,C,I,B=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),o=n.model,i=o.parent,c=null===i||void 0===i?void 0:i.parent,i){e.next=6;break}return e.abrupt("return");case 6:if(a=new vr.w(r,r.target),l=n.editor.triggerEditorEvent(Er.f.ENTER,a),u=l.shouldStop,d=l.shouldPrevent,!u||!d){e.next=10;break}return e.abrupt("return");case 10:if(f=n.model.zoneState,h=this.blockManager.getBlockViewByBlockId(i.id),p=Object(M.K)(h.type),v=R.g.includes(h.type),g=n.id,b=i.position+1,!((y=n.model.isEmpty)&&p&&c)){e.next=23;break}return e.next=20,this.blockManager.applyTransaction("keyevent:list:enter",(function(e){var n=i.children.slice(o.position+1);Object(Y.y)(e,[o].concat(W()(n))),Object(Y.t)(e,o.recordId,o.children.length,n.map((function(e){return e.recordId}))),Object(Y.t)(e,c.recordId,b,[o.recordId])}));case 20:g=c.children[b].id,e.next=41;break;case 23:if(!y||!v){e.next=31;break}return e.next=26,Object(kt.S)(n,this.blockManager,R.B.TEXT);case 26:m=e.sent,_=H()(m,1),g=_[0],e.next=41;break;case 31:if(k=n.model.getSelection()){e.next=34;break}return e.abrupt("return");case 34:return O=f.split(k),x=[O[0].toAttributeText(),O[1].toAttributeText()],E=D.C(k),S="",e.next=40,this.blockManager.applyTransaction("keyevent:list:enter",(function(e){if(E){var r={};Object(oo.i)(o)&&Object.assign(r,{seq:o.record.get(["seq"])});var i=B.blockManager.createInitModel(n.type,co({text:x[0]},r));e.replace(o.recordId,["seq"],"auto"),Object(oo.Y)(B.blockManager,n.id,ro.b.DOWN).forEach((function(n){var r=B.blockManager.getRecordByBlockId(n.blockId);e.replace(r.id,["seq"],"auto")})),e.replace(o.recordId,["text"],x[1]),Object(j.Wk)(e,h.record.id,o.position,i)}else{var c=xe(B.blockManager,o,e,B.fold,x);S=c.newRecordId}}));case 40:S&&(g=this.blockManager.getBlockIdsByRecordId(S)[0]);case 41:g&&(C=this.blockManager.getBlockViewByBlockId(g),Object(j.U)(C)&&this.selectionAPI.setSelection([{type:L.j.TEXT,id:g,selection:{start:0,end:0}}]),Object(j.U)(C)&&C.focus(),I=new vr.w(r,r.target),n.editor.triggerEditorEvent(Er.f.AFTER_ENTER,I));case 42:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onSelectAll",value:function(e,n,r){n.preventDefault();var o=r.collector;if(r.target[0].id===e.id)return!!e.model.isSelectingAll()||(e.model.selectAll(),o&&o.setExtraData({action_value:{value1:ct.e.UN_SELECT_ALL_PAGE}},!0),Object(ct.E)(),!1);var i=[R.B.CELL,R.B.CALLOUT,R.B.GRID_COLUMN];if(e.parentId){var c=this.blockManager.getBlockViewByBlockId(e.parentId);if(c.parentId&&!i.includes(c.type))return!0}this.selectionAPI.setSelection([{id:e.id,type:L.j.BLOCK}]),o&&o.setExtraData({action_value:{value1:ct.e.UN_SELECT_ALL_PAGE}},!0)}}]),r}(Pr),G()(to.prototype,"onBackspace",[Zr,Qr],Object.getOwnPropertyDescriptor(to.prototype,"onBackspace"),to.prototype),G()(to.prototype,"onEnter",[$r,eo],Object.getOwnPropertyDescriptor(to.prototype,"onEnter"),to.prototype),to),Bo=r("dx_hB37"),To=r("dx_FBWK"),wo=r("dx_BrJR"),Ro=r("dx_FNDK"),Mo=r("dx_P58d"),jo=r("dx_ppc6"),Do=r("dx_Vkod"),Ao=r("dx_UydN");function Po(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Lo(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Lo(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Lo(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function No(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Fo(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?No(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):No(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Uo(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var Ho,Vo,Wo,zo=(lo=ce({supportReadOnly:!1}),so=ce({supportReadOnly:!1}),uo=ce({supportReadOnly:!1}),fo=ce({supportReadOnly:!1}),ho=ce({supportReadOnly:!1}),po=ce({supportReadOnly:!1}),vo=ce({supportReadOnly:!1}),go=ce({supportReadOnly:!1}),bo=ce({supportReadOnly:!1}),yo=ce({supportReadOnly:!1}),mo=ce({supportReadOnly:!1}),_o=ce({supportReadOnly:!1}),ko=ce({supportReadOnly:!1}),Oo=ce({supportReadOnly:!1}),xo=ce({supportReadOnly:!1}),Eo=ce({supportReadOnly:!1}),So=ce({supportReadOnly:!1}),Co=function(e){b()(r,e);var n=Uo(r);function r(e,o,i,c,a){var l;return h()(this,r),(l=n.call(this,e,o)).blockManager=e,l.selectionAPI=o,l.fold=i,l.commentModule=c,l.viewport=a,l}return v()(r,[{key:"onEnter",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,this.deleteMultipleSelection(n);case 3:return e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onShiftEnter",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.next=3,this.deleteMultipleSelection(n);case 3:return e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onBackspace",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),this.deleteMultipleSelection(n);case 2:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onDelete",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),this.deleteMultipleSelection(n);case 2:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onBackspaceWord",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),this.deleteMultipleSelection(n);case 2:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onDeleteWord",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),this.deleteMultipleSelection(n);case 2:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onShiftArrowUp",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.selectionAPI.getSelection(),i=o[0],c=o[o.length-1],!this.selectionAPI.forward||c.type!==Mo.j.BLOCK){e.next=8;break}this.collapseSelection(pe.Fr.Tail),r.preventDefault(),e.next=12;break;case 8:if(this.selectionAPI.forward||i.type!==Mo.j.BLOCK){e.next=12;break}return e.next=11,this.extendSelection(pe.Fr.Head,{textOffset:"all"});case 11:r.preventDefault();case 12:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onShiftArrowDown",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.selectionAPI.getSelection(),i=o[0],c=o[o.length-1],!this.selectionAPI.forward||c.type!==Mo.j.BLOCK){e.next=9;break}return e.next=6,this.extendSelection(pe.Fr.Tail,{textOffset:"all"});case 6:r.preventDefault(),e.next=21;break;case 9:if(!this.selectionAPI.forward||c.type!==Mo.j.TEXT){e.next=20;break}if(!(0===(null===(a=c.selection)||void 0===a?void 0:a.start)&&0===c.selection.end)){e.next=18;break}if(u=c.id,null===(l=this.blockManager.getBlockViewByBlockId(u))||void 0===l?void 0:l.model.isEmpty){e.next=18;break}return e.next=17,this.extendSelection(pe.Fr.Tail,{textOffset:0});case 17:r.preventDefault();case 18:e.next=21;break;case 20:this.selectionAPI.forward||i.type!==Mo.j.BLOCK||(this.collapseSelection(pe.Fr.Head),r.preventDefault());case 21:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onShiftArrowLeft",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.selectionAPI.getSelection(),i=o[0],c=o[o.length-1],!this.selectionAPI.forward){e.next=11;break}if(c.type===Mo.j.BLOCK||Object(Ro.hy)(c,this.blockManager,this.selectionAPI)){e.next=7;break}return e.abrupt("return");case 7:this.collapseSelection(pe.Fr.Tail),r.preventDefault(),e.next=17;break;case 11:if(i.type===Mo.j.BLOCK||Object(Ro.F)(i,this.blockManager,this.selectionAPI)){e.next=14;break}return e.abrupt("return");case 14:return e.next=16,this.extendSelection(pe.Fr.Head,{textOffset:0});case 16:r.preventDefault();case 17:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"setSelectionCrossEquation",value:function(e,n){var r=this.selectionAPI.forward?e[e.length-1]:e[0];if(Object(j.f)(r)){var o=r.model.getSelection();if(!o)return;if(this.selectionAPI.forward){var i=r.model.zoneState,c=i.getModelText().length;if(i.getEntities({start:o.end,end:Fo({},i.offsetToPoint(c))})[0].attributes.equation){var a=this.selectionAPI.getSelection(),l=[].concat(W()(a.slice(0,a.length-1)),[{id:r.id,selection:{start:a[a.length-1].selection.start,end:a[a.length-1].selection.end+1},type:Mo.j.TEXT}]);this.selectionAPI.setSelection(l),n.preventDefault()}}else{if(r.model.zoneState.getEntities(o)[0].attributes.equation){var s=this.selectionAPI.getSelection(),u=[{id:r.id,selection:{start:s[0].selection.start+1,end:s[0].selection.end},type:Mo.j.TEXT}].concat(W()(s.slice(1)));this.selectionAPI.setSelection(u),n.preventDefault()}}}}},{key:"onShiftArrowRight",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=this.selectionAPI.getSelection(),i=o[0],c=o[o.length-1],this.setSelectionCrossEquation(n,r),!this.selectionAPI.forward){e.next=13;break}if(c.type===Mo.j.BLOCK||Object(Ro.C)(c,this.blockManager,this.selectionAPI)){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,this.extendSelection(pe.Fr.Tail,{textOffset:c.type===Mo.j.BLOCK?1:0});case 10:r.preventDefault(),e.next=18;break;case 13:if(i.type===Mo.j.BLOCK||Object(Ro.Y)(i,this.blockManager,this.selectionAPI)){e.next=16;break}return e.abrupt("return");case 16:this.collapseSelection(pe.Fr.Head),r.preventDefault();case 18:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onAltShiftArrowUp",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.onShiftArrowUp(n,r);case 1:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onAltShiftArrowDown",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onShiftArrowDown(n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onAltShiftArrowLeft",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onShiftArrowLeft(n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onAltShiftArrowRight",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.onShiftArrowRight(n,r);case 2:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"constructExtendBlock",value:function(e,n){var r=n.isForward,o=n.textOffset,i=this.blockManager.getBlockModelByBlockId(e);if(Object(j.i)(i)){var c=i.zoneState.getModelText().length-1,a=r?{start:0,end:Math.max(0,"all"===o?c:Math.min(o,c))}:{start:"all"===o?0:Math.max(0,c-o),end:Math.max(0,c)};return{type:Mo.j.TEXT,id:i.id,selection:a}}return{type:Mo.j.BLOCK,id:i.id}}},{key:"collapseSelection",value:function(e){var n=this.selectionAPI.getSelection();e===pe.Fr.Head?n.shift():e===pe.Fr.Tail&&n.pop(),this.selectionAPI.setSelection(n)}},{key:"extendSelection",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.selectionAPI.getSelection(),i=o[0],c=o[o.length-1],a=n===pe.Fr.Tail,l=a?c:i,e.next=7,Ce(l.id,this.blockManager,a,Mo.j.TEXT);case 7:if(u=e.sent){e.next=10;break}return e.abrupt("return");case 10:if(d=this.constructExtendBlock(u,{isForward:this.selectionAPI.forward,textOffset:r.textOffset}),n===pe.Fr.Head?o.unshift(d):n===pe.Fr.Tail&&o.push(d),this.blockManager.layoutManager.isBlockActive(u)){e.next=15;break}return e.next=15,this.viewport.scrollToBlock(u);case 15:this.selectionAPI.setSelection(o);case 16:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"deleteMultipleSelection",value:function(){var e=d()(s.a.mark((function e(n){var r,o,i,c,a,l,u,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n[0].editorAPI.getService(jo.S),o=n[0].editorAPI.getService(P.N,{optional:!0}),i=null,!o||n.every((function(e){var n,r=null===(n=e.editorAPI.modelService.getBlockModelByBlockId(e.id))||void 0===n?void 0:n.parent,i=e.editorAPI.modelService.getBlockModelByBlockId(e.id);if(!r||!i)return!0;var a=o.canBlockEdit(r.record,r.type,{type:"DELETE_CHILD",index:i.position});return a||(c=r.record),a}))){e.next=6;break}return Object(oe.A)({op_source:"keyboard",op_type:"backspace",edit_type:"DELETE_CHILD",interceptedRecord:c}),e.abrupt("return");case 6:return e.next=8,n[0].model.applyTransaction("multiple:deleteMultipleSelection",(function(e){i=Object(Ao.a)(e,n,n[0].editorAPI)}));case 8:(a=i)&&(l=a.position,u=void 0===l?0:l,a.id?r.setSelection([{id:a.id,type:Mo.j.TEXT,selection:{start:u,end:u}}],{source:"deleteMultipleSelection",force:!0}):a.recordId&&(d=n[0].editorAPI.modelService.getBlockModelsByRecordId(a.recordId)[0].id,r.setSelection([{id:d,type:Mo.j.TEXT,selection:{start:u,end:u}}])));case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},{key:"onBold",value:function(e,n,r){if(n.preventDefault(),!e.some((function(e){return e.isRoot}))){var o=e.filter((function(e){return Object(j.U)(e)}));this.markAllBlock(o,"bold",r),F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}}},{key:"onItalic",value:function(e,n,r){if(n.preventDefault(),!e.some((function(e){return e.isRoot}))){var o=e.filter((function(e){return Object(j.U)(e)}));this.markAllBlock(o,"italic",r),F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}}},{key:"onUnderline",value:function(e,n,r){if(n.preventDefault(),!e.some((function(e){return e.isRoot}))){var o=e.filter((function(e){return Object(j.U)(e)}));this.markAllBlock(o,"underline",r),F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}}},{key:"onStrikeThrough",value:function(e,n,r){if(n.preventDefault(),!e.some((function(e){return e.isRoot}))){var o=e.filter((function(e){return Object(j.U)(e)}));this.markAllBlock(o,"strikethrough",r),F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}}},{key:"onTextHighlight",value:function(e,n,r){var o;if(n.preventDefault(),!e.some((function(e){return e.isRoot}))){var i=e.filter((function(e){return Object(j.U)(e)})),c=(null===(o=window.User)||void 0===o?void 0:o.id)||"",a=Object(ee.J)(c).color||"",l=Object(ee.J)(c).backgroundColor||Object(To.getAlphaColor)(Object(To.getThemeColorByToken)("S300-BG"),.8);this.markAllBlock(i,"textHighlightBackground",r,l),this.markAllBlock(i,"textHighlight",r,a),F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}}},{key:"onInlineCode",value:function(e,n,r){if(!e.some((function(e){return e.isRoot}))){var o=e.filter((function(e){return Object(j.U)(e)&&!Object(wo.l)(e)}));this.markAllBlock(o,"inlineCode",r),F.S.emit(ct.f.TEXT_BLOCK_TOOLBAR)}}},{key:"onTab",value:function(e,n,r){var o=this,i=Object(ct.o)(this.selectionAPI.getSelection()),c=Object(Do.d)(this.blockManager,i,!1).newSelectedBlockIds;new en(this.blockManager,this.selectionAPI,this.fold,this.commentModule,this.viewport).onTab(c.map((function(e){return o.blockManager.getBlockViewByBlockId(e)})),n,r),F.S.emit(F.p.COMMON.TAB_STATUS_CHANGE)}},{key:"onUnTab",value:function(e,n,r){var o=this,i=Object(ct.o)(this.selectionAPI.getSelection()),c=Object(Do.d)(this.blockManager,i,!1).newSelectedBlockIds;new en(this.blockManager,this.selectionAPI,this.fold,this.commentModule,this.viewport).onUnTab(c.map((function(e){return o.blockManager.getBlockViewByBlockId(e)})),n,r),F.S.emit(F.p.COMMON.TAB_STATUS_CHANGE)}},{key:"textAlignLeft",value:function(e){this.alignBlocks(e,R.D.LEFT)}},{key:"textAlignCenter",value:function(e){this.alignBlocks(e,R.D.CENTER)}},{key:"textAlignRight",value:function(e){this.alignBlocks(e,R.D.RIGHT)}},{key:"alignBlocks",value:function(e,n){var r={};this.selectionAPI.getSelection().forEach((function(e){r[e.id]=e})),e=e.filter((function(e){var n,o,i=r[e.id];return!i||i.type!==Mo.j.TEXT||(null===(n=i.selection)||void 0===n?void 0:n.start)!==(null===(o=i.selection)||void 0===o?void 0:o.end)})),this.blockManager.applyTransaction("changeMultipleBlocksAlign",(function(r){e.filter((function(e){return!R.uN.includes(e.type)})).forEach((function(e){e.model.snapshot.align!==n&&r.replace(e.record.id,["align"],n)}))}))}},{key:"markAllBlock",value:function(e,n,r){var o=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"true";e=e.filter((function(e){return Object(J.d)(e.model.id,o.fold,o.blockManager)}));var c=[],a=!0,l={};this.selectionAPI.getSelection().forEach((function(e){l[e.id]=e}));var s,u=Po(e);try{var d=function(){var e=s.value,o=void 0,u=l[e.id];if((null===u||void 0===u?void 0:u.type)===Mo.j.BLOCK){var d=[0,e.model.zoneState.getModelText().length-1];o=Object(D.j)(e,d)}else o=e.model.getSelection();if(!o)return"continue";if(o.isCollapsed()&&D.C(o)||o.isCollapsed()&&D.X(o))return"continue";var f,h=Po(e.model.zoneState.getEntities(o));try{var p=function(){var r=f.value;if(!Reflect.has(r.attributes,"equation")&&"\n"!==r.text){var o=Object(ne.G)(e.model.zoneState,r)[n]===i;o||(a=!1),c.push((function(c){var a=new Bo.A({editor:e.editor,start:r.start,end:r.end,state:e.model.zoneState});o?c&&e.editor.toggleAttribute(n,"",a):!c&&e.editor.toggleAttribute(n,i,a)}))}};for(h.s();!(f=h.n()).done;)p()}catch(g){h.e(g)}finally{h.f()}if(r){var v=r.collector;v&&v.setExtraData({action_value:{value1:a?"false":"true"}},!0)}};for(u.s();!(s=u.n()).done;)d()}catch(f){u.e(f)}finally{u.f()}return c.forEach((function(e){return e(a)}))}},{key:"handleArrowUpOrDown",value:function(e,n,r){if(0===e.length)return!0;n.preventDefault(),this.focusClosestBlockOnMultiRow(e,!0,r)}},{key:"onArrowUp",value:function(e,n){return this.handleArrowUpOrDown(e,n,!1)}},{key:"onArrowDown",value:function(e,n){var r=we(e[e.length-1].id,this.blockManager),o=r.isLastNoEmptyBlock,i=r.blockId;return o?(Object(X.A)(this.blockManager,this.selectionAPI,this.viewport,i),void n.preventDefault()):this.handleArrowUpOrDown(e,n,!0)}},{key:"onComment",value:function(e,n){n.preventDefault(),this.commentModule.getCommentable()&&Re(this.commentModule,{selectedBlocks:this.selectionAPI.getSelection(),callSource:"MutlipleKeyEvent"})}}]),r}(Kt),G()(Co.prototype,"onEnter",[lo],Object.getOwnPropertyDescriptor(Co.prototype,"onEnter"),Co.prototype),G()(Co.prototype,"onShiftEnter",[so],Object.getOwnPropertyDescriptor(Co.prototype,"onShiftEnter"),Co.prototype),G()(Co.prototype,"onBackspace",[uo],Object.getOwnPropertyDescriptor(Co.prototype,"onBackspace"),Co.prototype),G()(Co.prototype,"onDelete",[fo],Object.getOwnPropertyDescriptor(Co.prototype,"onDelete"),Co.prototype),G()(Co.prototype,"onBackspaceWord",[ho],Object.getOwnPropertyDescriptor(Co.prototype,"onBackspaceWord"),Co.prototype),G()(Co.prototype,"onDeleteWord",[po],Object.getOwnPropertyDescriptor(Co.prototype,"onDeleteWord"),Co.prototype),G()(Co.prototype,"onBold",[vo],Object.getOwnPropertyDescriptor(Co.prototype,"onBold"),Co.prototype),G()(Co.prototype,"onItalic",[go],Object.getOwnPropertyDescriptor(Co.prototype,"onItalic"),Co.prototype),G()(Co.prototype,"onUnderline",[bo],Object.getOwnPropertyDescriptor(Co.prototype,"onUnderline"),Co.prototype),G()(Co.prototype,"onStrikeThrough",[yo],Object.getOwnPropertyDescriptor(Co.prototype,"onStrikeThrough"),Co.prototype),G()(Co.prototype,"onTextHighlight",[mo],Object.getOwnPropertyDescriptor(Co.prototype,"onTextHighlight"),Co.prototype),G()(Co.prototype,"onInlineCode",[_o],Object.getOwnPropertyDescriptor(Co.prototype,"onInlineCode"),Co.prototype),G()(Co.prototype,"onTab",[ko],Object.getOwnPropertyDescriptor(Co.prototype,"onTab"),Co.prototype),G()(Co.prototype,"onUnTab",[Oo],Object.getOwnPropertyDescriptor(Co.prototype,"onUnTab"),Co.prototype),G()(Co.prototype,"textAlignLeft",[xo],Object.getOwnPropertyDescriptor(Co.prototype,"textAlignLeft"),Co.prototype),G()(Co.prototype,"textAlignCenter",[Eo],Object.getOwnPropertyDescriptor(Co.prototype,"textAlignCenter"),Co.prototype),G()(Co.prototype,"textAlignRight",[So],Object.getOwnPropertyDescriptor(Co.prototype,"textAlignRight"),Co.prototype),Co),Go=function(){function e(n,r){h()(this,e),this.selectionAPI=r}return v()(e,[{key:"onSelectAll",value:function(e,n){if(e.preventDefault(),this.selectionAPI.selectAll(),n){var r=n.collector;r&&r.setExtraData({action_value:{value1:ct.e.SELECT_ALL_PAGE}},!0)}}},{key:"onHelpSiderbar",value:function(){Be()}}]),e}();function Ko(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var qo,Xo,Yo,Jo=(Ho=ce({supportReadOnly:!1}),Vo=ce({supportReadOnly:!1}),Wo=function(e){b()(r,e);var n=Ko(r);function r(){return h()(this,r),n.apply(this,arguments)}return v()(r,[{key:"onEnter",value:function(){var e=d()(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"onBackspace",value:function(){var e=d()(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),r}(en),G()(Wo.prototype,"onEnter",[Ho],Object.getOwnPropertyDescriptor(Wo.prototype,"onEnter"),Wo.prototype),G()(Wo.prototype,"onBackspace",[Vo],Object.getOwnPropertyDescriptor(Wo.prototype,"onBackspace"),Wo.prototype),Wo);function Zo(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var Qo,$o,ei,ti,ni,ri=(qo=ce({supportReadOnly:!1}),Xo=ce({supportReadOnly:!1}),Yo=function(e){b()(r,e);var n=Zo(r);function r(){return h()(this,r),n.apply(this,arguments)}return v()(r,[{key:"onEnter",value:function(){var e=d()(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"onBackspace",value:function(){var e=d()(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"onSelectAll",value:function(e,n,r){n.preventDefault();var o=e[0];if(F.S.emit(F.p.MOBILE.BLOCK_MENU.HIDE_BLOCK_MENU),this.selectionAPI.setSelection(this.blockManager.getBlockModelByBlockId(o.id).children.map((function(e){return{type:L.j.BLOCK,id:e.id}}))),F.S.emit(F.p.MOBILE.BLOCK_MENU.SHOW_BLOCK_MENU),r){var i=r.collector;i&&i.setExtraData({action_value:{value1:ct.e.UN_SELECT_ALL_PAGE}},!0)}}}]),r}(en),G()(Yo.prototype,"onEnter",[qo],Object.getOwnPropertyDescriptor(Yo.prototype,"onEnter"),Yo.prototype),G()(Yo.prototype,"onBackspace",[Xo],Object.getOwnPropertyDescriptor(Yo.prototype,"onBackspace"),Yo.prototype),Yo);function oi(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var ii=(Qo=ce({supportReadOnly:!1}),$o=pr(),ei=ce({supportReadOnly:!1}),ti=pr({selection:"start"}),ni=function(e){b()(r,e);var n=oi(r);function r(){return h()(this,r),n.apply(this,arguments)}return v()(r,[{key:"onEnter",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v,g,b,y,m,_,k=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),o=this.blockManager.getBlockModelByBlockId(n.id),i=o.parent){e.next=5;break}return e.abrupt("return");case 5:if(c=new vr.w(r,r.target),a=n.editor.triggerEditorEvent(Er.f.ENTER,c),l=a.shouldStop,u=a.shouldPrevent,!l||!u){e.next=9;break}return e.abrupt("return");case 9:if(d=n.model.isEmpty,f=n.id,!d){e.next=19;break}return e.next=14,Object(kt.S)(n,this.blockManager,R.B.TEXT,{},{mergeMode:K.f.SPLIT,from:K.H.local});case 14:h=e.sent,p=H()(h,1),f=p[0],e.next=28;break;case 19:if(v=n.model.getSelection()){e.next=22;break}return e.abrupt("return");case 22:return g=n.model.zoneState.split(v),b=[g[0].toAttributeText(),g[1].toAttributeText()],y=o.position+1,e.next=27,this.blockManager.applyTransaction("keyevent:quote:enter",(function(e){var r=k.blockManager.createInitModel(n.type,{text:b[1]});e.replace(n.record.id,["text"],b[0]),Object(j.Wk)(e,i.record.id,y,r)}));case 27:f=i.children[y].id;case 28:m=this.blockManager.getBlockViewByBlockId(f),Object(j.U)(m)&&this.selectionAPI.setSelection([{type:L.j.TEXT,id:f,selection:{start:0,end:0}}]),Object(j.U)(m)&&m.focus(),_=new vr.w(r,r.target),n.editor.triggerEditorEvent(Er.f.AFTER_ENTER,_);case 33:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onBackspace",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),o=new KeyboardEvent(r.type,r),i=new vr.w(o,o.target),n.editor.triggerEditorEvent(Er.f.STOPPED_KEYDOWN,i),c=this.blockManager.getBlockModelByBlockId(n.id),c.parent){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,Object(kt.S)(n,this.blockManager,R.B.TEXT);case 10:a=this.blockManager.getBlockViewByBlockId(n.id),Object(j.U)(a)&&a.focus();case 12:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()}]),r}(Pr),G()(ni.prototype,"onEnter",[Qo,$o],Object.getOwnPropertyDescriptor(ni.prototype,"onEnter"),ni.prototype),G()(ni.prototype,"onBackspace",[ei,ti],Object.getOwnPropertyDescriptor(ni.prototype,"onBackspace"),ni.prototype),ni);function ci(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var ai,li,si,ui,di,fi,hi,pi,vi=function(e){b()(r,e);var n=ci(r);function r(){return h()(this,r),n.apply(this,arguments)}return v()(r,[{key:"onSelectAll",value:function(e,n,r){n.preventDefault();var o=e[0];if((null===r||void 0===r?void 0:r.target[0]).id===o.id&&o.props.parentId)return!0;if(F.S.emit(F.p.MOBILE.BLOCK_MENU.HIDE_BLOCK_MENU),this.selectionAPI.setSelection([{type:L.j.BLOCK,id:o.id}]),F.S.emit(F.p.MOBILE.BLOCK_MENU.SHOW_BLOCK_MENU),r){var i=r.collector;i&&i.setExtraData({action_value:{value1:ct.e.UN_SELECT_ALL_PAGE}},!0)}}}]),r}(en);function gi(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var bi,yi,mi,_i,ki,Oi,xi,Ei,Si,Ci,Ii,Bi,Ti,wi,Ri,Mi,ji,Di,Ai,Pi,Li,Ni,Fi,Ui,Hi,Vi,Wi,zi,Gi,Ki,qi,Xi,Yi=(ai=ce({supportReadOnly:!1}),li=pr(),si=pr(),ui=pr(),di=ce({supportReadOnly:!1}),fi=ce({supportReadOnly:!1}),hi=ce({supportReadOnly:!1}),pi=function(e){b()(r,e);var n=gi(r);function r(){return h()(this,r),n.apply(this,arguments)}return v()(r,[{key:"onBold",value:function(e,n){n.preventDefault()}},{key:"onItalic",value:function(e,n){n.preventDefault()}},{key:"onUnderline",value:function(e,n){n.preventDefault()}},{key:"onStrikeThrough",value:function(e,n){n.preventDefault()}},{key:"onNewPage",value:function(){var e=d()(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"onTab",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),this.createFirstLineIfNecessaryAndFocus(n);case 2:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onUnTab",value:function(){var e=d()(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"onEnter",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l,u,d,f,h,p,v=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=new vr.w(r,r.target),i=n.editor.triggerEditorEvent(Er.f.ENTER,o),c=i.shouldStop,a=i.shouldPrevent,!c||!a){e.next=4;break}return e.abrupt("return");case 4:if(l=n.model.zoneState,u=n.model.getSelection()){e.next=8;break}return e.abrupt("return");case 8:return d=l.split(u),f=[d[0].toAttributeText(),d[1].toAttributeText()],e.next=12,this.blockManager.applyTransaction("keyevent:root:enter",(function(e){Object(ae.w)(e,n.record,f[0]),Object(j.Wk)(e,n.record.id,0,v.blockManager.createInitModel(R.B.TEXT,{text:f[1]}))}));case 12:h=this.blockManager.getBlockViewByBlockId(n.model.children[0].id),Object(j.U)(h)&&this.selectionAPI.setSelection([{type:L.j.TEXT,id:h.id,selection:{start:0,end:0}}]),p=new vr.w(r,r.target),n.editor.triggerEditorEvent(Er.f.AFTER_ENTER,p);case 16:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onArrowUp",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),!(i=this.getTargetStruct(o,!1))){e.next=5;break}return this.focus(i,!1),e.abrupt("return");case 5:this.focusOnBlock(n,!0,!1);case 6:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"onArrowDown",value:function(){var e=d()(s.a.mark((function e(n,r,o){var i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.preventDefault(),o.propagation){e.next=5;break}return r.preventDefault(),this.createFirstLineIfNecessaryAndFocus(n),e.abrupt("return");case 5:(i=this.getTargetStruct(o,!0))&&this.focus(i);case 7:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"onSelectAll",value:function(e,n,r){var o=this,i=r.collector;if(n.preventDefault(),r.propagation){if(this.blockManager.lazyRecordStatus&&!this.blockManager.lazyRecordStatus.isAllDone)return;Object(ct.c)((function(){o.selectionAPI.selectAll()}),this.selectionAPI),i&&i.setExtraData({action_value:{value1:ct.e.SELECT_ALL_PAGE}},!0)}else this.selectionAPI.setSelection([{id:e.id,type:L.j.TEXT,selection:{start:0,end:e.model.zoneState.totalWidth()}}]),i&&i.setExtraData({action_value:{value1:ct.e.UN_SELECT_ALL_PAGE}},!0)}},{key:"textAlignLeft",value:function(e,n){this.alignHeaderBlock(e,R.D.LEFT,n)}},{key:"textAlignCenter",value:function(e,n){this.alignHeaderBlock(e,R.D.CENTER,n)}},{key:"textAlignRight",value:function(e,n){this.alignHeaderBlock(e,R.D.RIGHT,n)}},{key:"alignHeaderBlock",value:function(e,n,r){r.preventDefault();var o=[Object($.C)({blocks:[this.blockManager.getBlockModelByBlockId(e.id)],blockManager:this.blockManager,recursive:!0,fold:this.fold})[0]];this.blockManager.applyTransaction("blockTextAlign",(function(e){o.forEach((function(r){return e.replace(r.record.id,["align"],n)}))})),F.S.emit(ct.f.TEXT_TOOLBAR)}},{key:"createFirstLineIfNecessaryAndFocus",value:function(e){var n=this,r=this.blockManager.getBlockModelByBlockId(e.id).children[0];r?this.focus(r,!0):this.blockManager.applyTransaction("keyevent:root:arrowdown",(function(r){Object(Y.l)(r,e.record.id,0,[n.blockManager.createInitModel(R.B.TEXT)])})).then((function(){var r=n.blockManager.getBlockViewByBlockId(e.model.children[0].id);Object(j.U)(r)&&r.model.setSelection({start:0,len:0},!0)})).catch((function(e){console.error("[Key Event]",e)}))}},{key:"focus",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.blockManager.getBlockViewByBlockId(e.id);r.type===R.B.TABLE?this.focusOnTable(r,!0,n):this.focusOnBlock(r,!0,n)}},{key:"getTargetStruct",value:function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.currentTarget[0],o=e.target[n?e.target.length-1:0],i=this.blockManager.getBlockPath(o.id);i.push(o.id);var c=i.indexOf(r.id),a=i[c+1];if(!a)return null;var l=this.blockManager.getBlockModelByBlockId(a);return n?l.nextSibling:l.previousSibling}}]),r}(Pr),G()(pi.prototype,"onEnter",[ai,li],Object.getOwnPropertyDescriptor(pi.prototype,"onEnter"),pi.prototype),G()(pi.prototype,"onArrowUp",[si],Object.getOwnPropertyDescriptor(pi.prototype,"onArrowUp"),pi.prototype),G()(pi.prototype,"onArrowDown",[ui],Object.getOwnPropertyDescriptor(pi.prototype,"onArrowDown"),pi.prototype),G()(pi.prototype,"textAlignLeft",[di],Object.getOwnPropertyDescriptor(pi.prototype,"textAlignLeft"),pi.prototype),G()(pi.prototype,"textAlignCenter",[fi],Object.getOwnPropertyDescriptor(pi.prototype,"textAlignCenter"),pi.prototype),G()(pi.prototype,"textAlignRight",[hi],Object.getOwnPropertyDescriptor(pi.prototype,"textAlignRight"),pi.prototype),pi),Ji=r("dx_cEo5"),Zi=r("dx_b28D");function Qi(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return $i(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $i(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function $i(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function ec(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var tc,nc,rc=Object(Zi.e)("keyevent:TableBlockKeyEvents"),oc=(bi=ce({supportReadOnly:!1}),yi=ce({supportReadOnly:!1}),mi=ce({supportReadOnly:!1}),_i=ce({supportReadOnly:!1}),ki=ce({supportReadOnly:!1}),Oi=ce({supportReadOnly:!1}),xi=ce({supportReadOnly:!1}),Ei=ce({supportReadOnly:!1}),Si=ce({supportReadOnly:!1}),Ci=ce({supportReadOnly:!1}),Ii=ce({supportReadOnly:!1}),Bi=ce({supportReadOnly:!1}),Ti=ce({supportReadOnly:!1}),wi=ce({supportReadOnly:!1}),Ri=ce({supportReadOnly:!1}),Mi=ce({supportReadOnly:!1}),ji=ce({supportReadOnly:!1}),Di=ce({supportReadOnly:!1}),Ai=ce({supportReadOnly:!1}),Pi=ce({supportReadOnly:!1}),Li=ce({supportReadOnly:!1}),Ni=ce({supportReadOnly:!1}),Fi=ce({supportReadOnly:!1}),Ui=ce({supportReadOnly:!1}),Hi=ce({supportReadOnly:!1}),Vi=ce({supportReadOnly:!1}),Wi=ce({supportReadOnly:!1}),zi=ce({supportReadOnly:!1}),Gi=ce({supportReadOnly:!1}),Ki=ce({supportReadOnly:!1}),Xi=function(e){b()(r,e);var n=ec(r);function r(e,o,i){var c;return h()(this,r),(c=n.call(this,e,o)).blockManager=e,c.selectionAPI=o,c.fold=i,c.handleTurnIntoAction=function(){var e=d()(s.a.mark((function e(n,r,o){var i,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),r.stopImmediatePropagation(),i=Object(ue.m)(n,c.blockManager),a=c.selectionAPI.getSelection(),e.next=6,c.batchTurninto(i,o,null,!0);case 6:c.selectionAPI.setSelection(a);case 7:case"end":return e.stop()}}),e)})));return function(n,r,o){return e.apply(this,arguments)}}(),c}return v()(r,[{key:"jumpToCell",value:function(){var e=d()(s.a.mark((function e(n){var r,o,i,c,a,l,u,f,h,p,v,g,b,y,m,_,k,O,x=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.blocks,o=n.forward,i=n.isVertical,c=n.canAppendRow,a=n.event,l=r[0],u=l.model,f=u.parent){e.next=6;break}return e.abrupt("return");case 6:if(h=function(){return i?o?pe.j.DOWN:pe.j.UP:o?pe.j.RIGHT:pe.j.LEFT},p=function(){var e=d()(s.a.mark((function e(){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.parentId,rc("jumpToCell.appendTableRow: tableId=%s",n),e.t0=n,!e.t0){e.next=6;break}return e.next=6,Object(bt.k)(x.blockManager,n);case 6:return e.abrupt("return");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),v=h(),g=function(){var e=x.getAdjacentCellIndex(l.id,v);if(e){var n=e.cellIndex;rc("jumpToCell(%s), newCell=%s",v,n),a.preventDefault();var r=f.children[n];if(0===r.children.length)x.focusOnEmptyCell(f.id,r.record.id);else{var c=o?r.children[0]:x.getLastChild(r,!0);if(c){var s=x.blockManager.getBlockViewByBlockId(c.id);x.focusOnBlock(s,i,o)}}return e}},!g()){e.next=13;break}return e.abrupt("return");case 13:if(!o||!c){e.next=18;break}return e.next=16,p();case 16:return g(),e.abrupt("return");case 18:if((b=o?f.nextSibling:f.previousSibling)||v!==pe.j.DOWN&&v!==pe.j.RIGHT||!Object(ue.E)(l.cellId,f.snapshot,v)||(b=(null===(y=f.parent)||void 0===y?void 0:y.type)!==R.B.GRID_COLUMN||(null===(m=f.parent)||void 0===m?void 0:m.nextSibling)?(null===(O=f.parent)||void 0===O?void 0:O.nextSibling)||null:(null===(_=f.parent)||void 0===_||null===(k=_.parent)||void 0===k?void 0:k.nextSibling)||null),b){e.next=23;break}return rc("jumpToCell(%s): fail to find sibling",v),e.abrupt("return",!o);case 23:if(a.preventDefault(),b.type!==R.B.GRID){e.next=27;break}return this.focusClosestBlockOnMultiRow([this.blockManager.getBlockViewByBlockId(b.id)],!0,o),e.abrupt("return");case 27:this.focusOnBlock(this.blockManager.getBlockViewByBlockId(b.id),i,o);case 28:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"getLastChild",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.children;if(0===r.length)return null;var o=r[r.length-1];return n&&o.children.length>0?this.getLastChild(o,n):o}},{key:"alignBlock",value:function(e,n){var r=this,o=Object($.C)({blocks:e.map((function(e){return r.blockManager.getBlockModelByBlockId(e.id)})),blockManager:this.blockManager,recursive:!0,fold:this.fold});this.blockManager.applyTransaction("blockTextAlign",(function(e){o.forEach((function(r){return e.replace(r.record.id,["align"],n)}))}))}},{key:"textAlignLeft",value:function(e,n){n.preventDefault(),this.alignBlock(e,R.D.LEFT)}},{key:"textAlignRight",value:function(e,n){n.preventDefault(),this.alignBlock(e,R.D.RIGHT)}},{key:"textAlignCenter",value:function(e,n){n.preventDefault(),this.alignBlock(e,R.D.CENTER)}},{key:"onCtrlUp",value:function(e,n){this.onArrowUp(e,n)}},{key:"onCtrlDown",value:function(e,n){this.onArrowDown(e,n)}},{key:"onArrowUp",value:function(e,n){return this.jumpToCell({blocks:e,event:n,forward:!1,isVertical:!0})}},{key:"onArrowDown",value:function(e,n){return this.jumpToCell({blocks:e,event:n,forward:!0,isVertical:!0})}},{key:"onArrowLeft",value:function(e,n){return this.jumpToCell({blocks:e,event:n,forward:!1,isVertical:!1})}},{key:"onArrowRight",value:function(e,n){return this.jumpToCell({blocks:e,event:n,forward:!0,isVertical:!1})}},{key:"onDelete",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.onBackspace(n,r);case 1:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onBackspace",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),o=[],n.forEach((function(e){o.push.apply(o,W()(i.blockManager.getBlockModelByBlockId(e.id).children.map((function(e){return e.id}))))})),this.blockManager.applyTransaction("keyevent:text:backspace",(function(e){Object(Y.y)(e,o,i.blockManager)})),F.N.emit(S.E);case 5:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onEnter",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i,c,a,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),o=n[0],i=this.blockManager.getBlockModelByBlockId(o.id),e.next=5,this.blockManager.applyTransaction("keyevent:table:enter",(function(e){c=Object(bt.n)(e,i.record.id)}));case 5:c&&(a=this.blockManager.getBlockIdsByRecordId(c)[0],this.blockManager.hasBlockViewByBlockId(a)&&(l=this.blockManager.getBlockViewByBlockId(a),Object(j.U)(l)&&this.selectionAPI.setSelection([{type:L.j.TEXT,id:l.id,selection:{start:0,end:0}}])));case 6:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onSelectAll",value:function(e,n,r){if(n.preventDefault(),!this.selectionAPI.isSelecting()){var o=e[0],i=null===r||void 0===r?void 0:r.target[0];F.S.emit(F.p.MOBILE.BLOCK_MENU.HIDE_BLOCK_MENU);var c=i.id===o.id&&o.props.parentId;if(this.selectionAPI.setSelection([{type:L.j.BLOCK,id:c?o.props.parentId:o.id}]),F.S.emit(F.p.MOBILE.BLOCK_MENU.SHOW_BLOCK_MENU),!c&&r){var a=r.collector;a&&a.setExtraData({action_value:{value1:ct.e.UN_SELECT_ALL_PAGE}},!0)}}}},{key:"onShiftCmdUp",value:function(e,n){return e||n.preventDefault(),!0}},{key:"onShiftCmdDown",value:function(e,n){return e||n.preventDefault(),!0}},{key:"onShiftCtrlUp",value:function(){return!0}},{key:"onShiftCtrlDown",value:function(){return!0}},{key:"onBold",value:function(e,n,r){n.preventDefault();var o=Object(ue.G)(e,this.blockManager);this.markAllBlock(o,"bold",r)}},{key:"onItalic",value:function(e,n,r){n.preventDefault();var o=Object(ue.G)(e,this.blockManager);this.markAllBlock(o,"italic",r)}},{key:"onUnderline",value:function(e,n,r){n.preventDefault();var o=Object(ue.G)(e,this.blockManager);this.markAllBlock(o,"underline",r)}},{key:"onStrikeThrough",value:function(e,n,r){var o=Object(ue.G)(e,this.blockManager);this.markAllBlock(o,"strikethrough",r)}},{key:"onInlineCode",value:function(e,n,r){var o=Object(ue.G)(e,this.blockManager).filter((function(e){return Object(j.U)(e)}));this.markAllBlock(o,"inlineCode",r)}},{key:"onTurnIntoBullet",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.BULLET)}},{key:"onTurnIntoTask",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.TODO)}},{key:"onTurnIntoHeading1",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.HEADING1)}},{key:"onTurnIntoHeading2",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.HEADING2)}},{key:"onTurnIntoHeading3",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.HEADING3)}},{key:"onTurnIntoHeading4",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.HEADING4)}},{key:"onTurnIntoHeading5",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.HEADING5)}},{key:"onTurnIntoHeading6",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.HEADING6)}},{key:"onTurnIntoHeading7",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.HEADING7)}},{key:"onTurnIntoHeading8",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.HEADING8)}},{key:"onTurnIntoHeading9",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.HEADING9)}},{key:"onTurnIntoQuote",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.QUOTE)}},{key:"onTurnIntoOrdered",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.ORDERED)}},{key:"onTurnIntoCode",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.CODE)}},{key:"onTurnIntoText",value:function(e,n){return this.handleTurnIntoAction(e,n,R.B.TEXT)}},{key:"onTab",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.jumpToCell({blocks:n,event:r,forward:!0,isVertical:!1,canAppendRow:!0}));case 1:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onUnTab",value:function(){var e=d()(s.a.mark((function e(n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.jumpToCell({blocks:n,event:r,forward:!1,isVertical:!1}));case 1:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"getAdjacentCellIndex",value:function(e,n){var r=this.blockManager.getBlockModelByBlockId(e),o=this.blockManager.getBlockViewByBlockId(e),i=r.parent;if(!i)return null;var c=i.record.snapshot,a=Object(ue.B)(o.cellId,c),l=H()(a,2),s=l[0],u=l[1],d=Object(ue.c)(c)[s][u],f=s,h=u;switch(n){case pe.j.UP:f-=1;break;case pe.j.DOWN:f+=d.rowSpan;break;case pe.j.LEFT:(h-=1)<0&&(h=c.columns_id.length-1,f-=1);break;case pe.j.RIGHT:(h+=d.colSpan)>=c.columns_id.length&&(h=0,f+=d.rowSpan)}if(Object(ue.TM)([f,h],c)){var p=this.fixClosestCell({snapshot:c,rowIndex:f,colIndex:h,direction:n,cellRecordId:r.record.id}),v=H()(p,2),g=v[0],b=v[1];return{rowIndex:g,colIndex:b,cellIndex:g*c.columns_id.length+b}}return null}},{key:"fixClosestCell",value:function(e){var n=e.snapshot,r=e.rowIndex,o=e.colIndex,i=Object(ue.c)(n)[r][o];if(i.cellId!==i.sourceCellId){var c=Object(ue.j)(i.sourceCellId),a=H()(c,2),l=a[0],s=a[1];return[n.rows_id.indexOf(l),n.columns_id.indexOf(s)]}return[r,o]}},{key:"markAllBlock",value:function(e,n,r){var o,i=this,c=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],l=[],s=!0,u=Qi(e);try{var d=function(){var e=o.value;if(console.log(e,e.editor),e.model.isEmpty)return"continue";var c=e.model.zoneState.getModelText(),u=new Ji.e({zoneId:e.model.zoneId,editor:e.editor,start:0,len:c.length-1}).toRange(),d="true"===Object(ne.G)(e.model.zoneState,u)[n],f=i.blockManager.getBlockModelByBlockId(e.id).children.map((function(e){return i.blockManager.getBlockViewByBlockId(e.id)})).filter((function(e){return Object(j.U)(e)&&!R.j.includes(e.type)})),h=i.markAllBlock(f,n,r,!1),p=H()(h,2),v=p[0],g=p[1];d&&v||(s=!1),l.push.apply(l,W()(g||[])),l.push((function(r){return e.model.toggleMark(a()({},n,"true"),u,r)}))};for(u.s();!(o=u.n()).done;)d()}catch(h){u.e(h)}finally{u.f()}if(r){var f=r.collector;f&&f.setExtraData({action_value:{value1:s?"false":"true"}},!0)}return c?l.forEach((function(e){return e(s)})):[s,l]}}]),r}(Kt),qi=Xi,G()(qi.prototype,"textAlignLeft",[bi],Object.getOwnPropertyDescriptor(qi.prototype,"textAlignLeft"),qi.prototype),G()(qi.prototype,"textAlignRight",[yi],Object.getOwnPropertyDescriptor(qi.prototype,"textAlignRight"),qi.prototype),G()(qi.prototype,"textAlignCenter",[mi],Object.getOwnPropertyDescriptor(qi.prototype,"textAlignCenter"),qi.prototype),G()(qi.prototype,"onDelete",[_i],Object.getOwnPropertyDescriptor(qi.prototype,"onDelete"),qi.prototype),G()(qi.prototype,"onBackspace",[ki],Object.getOwnPropertyDescriptor(qi.prototype,"onBackspace"),qi.prototype),G()(qi.prototype,"onEnter",[Oi],Object.getOwnPropertyDescriptor(qi.prototype,"onEnter"),qi.prototype),G()(qi.prototype,"onShiftCmdUp",[xi],Object.getOwnPropertyDescriptor(qi.prototype,"onShiftCmdUp"),qi.prototype),G()(qi.prototype,"onShiftCmdDown",[Ei],Object.getOwnPropertyDescriptor(qi.prototype,"onShiftCmdDown"),qi.prototype),G()(qi.prototype,"onShiftCtrlUp",[Si],Object.getOwnPropertyDescriptor(qi.prototype,"onShiftCtrlUp"),qi.prototype),G()(qi.prototype,"onShiftCtrlDown",[Ci],Object.getOwnPropertyDescriptor(qi.prototype,"onShiftCtrlDown"),qi.prototype),G()(qi.prototype,"onBold",[Ii],Object.getOwnPropertyDescriptor(qi.prototype,"onBold"),qi.prototype),G()(qi.prototype,"onItalic",[Bi],Object.getOwnPropertyDescriptor(qi.prototype,"onItalic"),qi.prototype),G()(qi.prototype,"onUnderline",[Ti],Object.getOwnPropertyDescriptor(qi.prototype,"onUnderline"),qi.prototype),G()(qi.prototype,"onStrikeThrough",[wi],Object.getOwnPropertyDescriptor(qi.prototype,"onStrikeThrough"),qi.prototype),G()(qi.prototype,"onInlineCode",[Ri],Object.getOwnPropertyDescriptor(qi.prototype,"onInlineCode"),qi.prototype),G()(qi.prototype,"onTurnIntoBullet",[Mi],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoBullet"),qi.prototype),G()(qi.prototype,"onTurnIntoTask",[ji],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoTask"),qi.prototype),G()(qi.prototype,"onTurnIntoHeading1",[Di],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoHeading1"),qi.prototype),G()(qi.prototype,"onTurnIntoHeading2",[Ai],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoHeading2"),qi.prototype),G()(qi.prototype,"onTurnIntoHeading3",[Pi],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoHeading3"),qi.prototype),G()(qi.prototype,"onTurnIntoHeading4",[Li],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoHeading4"),qi.prototype),G()(qi.prototype,"onTurnIntoHeading5",[Ni],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoHeading5"),qi.prototype),G()(qi.prototype,"onTurnIntoHeading6",[Fi],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoHeading6"),qi.prototype),G()(qi.prototype,"onTurnIntoHeading7",[Ui],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoHeading7"),qi.prototype),G()(qi.prototype,"onTurnIntoHeading8",[Hi],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoHeading8"),qi.prototype),G()(qi.prototype,"onTurnIntoHeading9",[Vi],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoHeading9"),qi.prototype),G()(qi.prototype,"onTurnIntoQuote",[Wi],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoQuote"),qi.prototype),G()(qi.prototype,"onTurnIntoOrdered",[zi],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoOrdered"),qi.prototype),G()(qi.prototype,"onTurnIntoCode",[Gi],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoCode"),qi.prototype),G()(qi.prototype,"onTurnIntoText",[Ki],Object.getOwnPropertyDescriptor(qi.prototype,"onTurnIntoText"),qi.prototype),qi);function ic(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var cc=(tc=ce({supportReadOnly:!1}),nc=function(e){b()(r,e);var n=ic(r);function r(){return h()(this,r),n.apply(this,arguments)}return v()(r,[{key:"onEnter",value:function(){var e=d()(s.a.mark((function e(n,r){var o,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.preventDefault(),i=n[0],null===(o=i.editorInstance)||void 0===o||o.focusAtEnd();case 3:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()}]),r}(en),G()(nc.prototype,"onEnter",[tc],Object.getOwnPropertyDescriptor(nc.prototype,"onEnter"),nc.prototype),nc);function ac(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function lc(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ac(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ac(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function sc(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return uc(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return uc(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function uc(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function dc(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var fc=[pe.F.onBold,pe.F.onItalic,pe.F.onUnderline,pe.F.onStrikeThrough,pe.F.onTurnIntoBullet,pe.F.onTurnIntoOrdered,pe.F.onTurnIntoQuote,pe.F.onTurnIntoTask,pe.F.onTurnIntoText,pe.F.onTurnIntoCode,pe.F.onTurnIntoHeading1,pe.F.onTurnIntoHeading2,pe.F.onTurnIntoHeading3,pe.F.onTurnIntoHeading4,pe.F.onTurnIntoHeading5,pe.F.onTurnIntoHeading6,pe.F.onTurnIntoHeading7,pe.F.onTurnIntoHeading8,pe.F.onTurnIntoHeading9,pe.F.TextAlignLeft,pe.F.TextAlignRight,pe.F.TextAlignCenter,pe.F.onTab,pe.F.onUnTab,pe.F.onInlineCode,pe.F.onTurnIntoCode],hc=function(e){b()(r,e);var n=dc(r);function r(){return h()(this,r),n.apply(this,arguments)}return v()(r,[{key:"getEffect",value:function(){var e=this,n=this.blockManager,r=this.selectionAPI,o=this.options,c=o.fold,a=o.commentModule,l=o.viewport,u=o.priority,f=void 0===u?0:u;window.sessionStorage.removeItem("bear-selectall-tips-once");var h=[{selectionType:L.j.TEXT,condition:function(e){return R.hd.includes(e.type)},rules:new Pr(n,r,c,a,l)},{selectionType:L.j.TEXT,condition:function(e){return R.O.includes(e.type)},rules:new no(n,r,c,a,l)},{selectionType:L.j.TEXT,condition:function(e){return Object(M.K)(e.type)},rules:new Io(n,r,c,a,l)},{selectionType:L.j.TEXT,condition:function(e){return e.type===R.B.CODE},rules:new Nr(n,r,c,a,l)},{selectionType:L.j.TEXT,condition:function(e){return e.type===R.B.QUOTE},rules:new ii(n,r,c,a,l)},{selectionType:L.j.TEXT,condition:function(e){return R.j.includes(e.type)},rules:new Yi(n,r,c,a,l)},{selectionType:"multipleSelection",condition:function(e){return!0},rules:new zo(n,r,c,a,l)},{selectionType:L.j.BLOCK,condition:function(e){return 1===e.length&&e[0].type===R.B.CALLOUT},rules:new ur(n,r,c,a,l)},{selectionType:L.j.BLOCK,condition:function(e){return 1===e.length&&e[0].type===R.B.QUOTE_CONTAINER},rules:new vi(n,r,c,a,l)},{selectionType:L.j.BLOCK,condition:function(e){return e.every((function(e){return e.type===R.B.CELL}))},rules:new oc(this.blockManager,this.selectionAPI,c)},{selectionType:L.j.BLOCK,condition:function(e){return e.every((function(e){return e.type===R.B.GRID_COLUMN}))},rules:new Yr(this.blockManager,this.selectionAPI)},{selectionType:L.j.BLOCK,condition:function(e){return e.every((function(e){return[R.B.OBJECTIVE,R.B.KEY_RESULT].includes(e.type)}))},rules:new Jo(n,r,c,a,l)},{selectionType:L.j.BLOCK,condition:function(e){return e.every((function(e){return[R.B.PROGRESS].includes(e.type)}))},rules:new ri(n,r,c,a,l)},{selectionType:L.j.BLOCK,condition:function(e){return 1===e.length&&e[0].type===R.B.TASK&&e[0].editable},rules:new cc(n,r,c,a,l)},{selectionType:L.j.BLOCK,condition:function(e){return!0},rules:new en(n,r,c,a,l)},{selectionType:"NONE",condition:function(e){return 0===e.length},rules:new Go(n,r)}],p=new on(n,r),v=new nn.S(n,r),g=function(){var n=d()(s.a.mark((function n(r){var o,i,c,a,l,u,d,f,p,v,g,b;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:o=r.isSingleTextSelection,i=r.isTextSelectionAcrossBlocks,c=r.currentTarget,a=r.e,l=r.name,u=r.mouse,d=sc(h),n.prev=2,d.s();case 4:if((f=d.n()).done){n.next=41;break}if(p=f.value,0!==c.length||"NONE"===p.selectionType){n.next=8;break}return n.abrupt("continue",39);case 8:if(0!==c.length||"NONE"!==p.selectionType){n.next=12;break}return console.log("trigger handler: ".concat(l,", selection: none")),e.log(u,l),n.abrupt("return",p.rules[l]&&p.rules[l](a,r));case 12:if(!(o&&p.selectionType===L.j.TEXT&&Object(j.f)(c[0])&&p.condition(c[0]))){n.next=21;break}if(!p.rules[l]){n.next=20;break}return console.log("trigger handler: ".concat(l,", selection: text")),e.log(u,l,c[0].id),n.next=18,p.rules[l](c[0],a,r);case 18:return v=n.sent,n.abrupt("return",v);case 20:return n.abrupt("return");case 21:if(!i||"multipleSelection"!==p.selectionType||!p.condition(c)){n.next=30;break}if(!p.rules[l]){n.next=29;break}return console.log("trigger handler: ".concat(l,", selection: multiple")),e.log(u,l,c[0].id),n.next=27,p.rules[l](c,a,r);case 27:return g=n.sent,n.abrupt("return",g);case 29:return n.abrupt("return");case 30:if(o&&!r.propagation||p.selectionType!==L.j.BLOCK||!p.condition(c)){n.next=39;break}if(!p.rules[l]){n.next=38;break}return console.log("trigger handler: ".concat(l,", selection: block")),e.log(u,l,c[0].id),n.next=36,p.rules[l](c,a,r);case 36:return b=n.sent,n.abrupt("return",b);case 38:return n.abrupt("return");case 39:n.next=4;break;case 41:n.next=46;break;case 43:n.prev=43,n.t0=n.catch(2),d.e(n.t0);case 46:return n.prev=46,d.f(),n.finish(46);case 49:return n.abrupt("return",!0);case 50:case"end":return n.stop()}}),n,null,[[2,43,46,49]])})));return function(e){return n.apply(this,arguments)}}(),b=function(){var r=d()(s.a.mark((function r(o){var i,c,a,l,u,d,f,h,p,v,y;return s.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=o.name,!fc.includes(i)){r.next=10;break}if(c=e.selectionAPI.getSelection().map((function(n){return e.blockManager.getBlockModelByBlockId(n.id)})),!0!==c.some((function(e){return!n.hasBlockViewByBlockId(e.id)}))){r.next=10;break}return r.next=7,Object(T.x)(c,e.blockManager);case 7:a=r.sent,o.currentTarget=a,o.target=a;case 10:return r.next=12,g(o);case 12:if(!0!==(l=r.sent)||!o.isTextSelectionAcrossBlocks){r.next=22;break}return u=e.selectionAPI.getSelection(),d=u.filter((function(n){return e.blockManager.hasBlockViewByBlockId(n.id)})).map((function(n){return e.blockManager.getBlockViewByBlockId(n.id)})),f=e.selectionAPI.isSingleTextSelection(u),h=e.selectionAPI.isTextSelectionAcrossBlocks(u),r.next=20,b(lc(lc({},o),{},{currentTarget:d,isSingleTextSelection:f,isTextSelectionAcrossBlocks:h}));case 20:return p=r.sent,r.abrupt("return",p);case 22:if(!(!0===l&&o.currentTarget.length>0)){r.next=29;break}if(!(v=Object(N.f)(o.currentTarget.map((function(n){return{id:n.id,path:e.blockManager.getBlockPath(n.id)}}))))||!e.blockManager.hasBlockViewByBlockId(v)){r.next=29;break}return r.next=27,b(lc(lc({},o),{},{propagation:!0,currentTarget:[e.blockManager.getBlockViewByBlockId(v)]}));case 27:return y=r.sent,r.abrupt("return",y);case 29:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),y=function(){var e=d()(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:C.S.isMobile&&r.isCursor()&&requestAnimationFrame((function(){F.S.trigger(F.p.MOBILE.COMMON.SCROLL_TO_VIEW,[!1])}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var o=d()(s.a.mark((function o(i){var c,a,l,u,d,f,h,g,m,_,k,O,x,E,C,T,M,j,A,N,U,H,V,W,z,G,K,q,X,Y,J,Z,Q,$,ee=arguments;return s.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(a=ee.length>1&&void 0!==ee[1]&&ee[1],l=ee.length>2&&void 0!==ee[2]?ee[2]:null,u=ee.length>3&&void 0!==ee[3]?ee[3]:null,!i.isDispatchFromEditableExtension){o.next=5;break}return o.abrupt("return");case 5:if(d=Object(ct.u)(i,a),f=n.editorAPI.getService(P.N,{optional:!0}),h=F.X.active,g=F.X.isTriggerredByClick,m=!h&&g?F.X.selectedBlocks:e.selectionAPI.getSelection(),g&&(F.X.isTriggerredByClick=!1),_=r.isSingleTextSelection(m),k=r.isTextSelectionAcrossBlocks(m),O=m.filter((function(n){return e.blockManager.hasBlockViewByBlockId(n.id)})).map((function(n){return e.blockManager.getBlockViewByBlockId(n.id)})),x=a?l&&l.source:I.G.content_page,!f||!1!==f.keyEventsInterceptor.canEdit(d,O,{isSingleTextSelection:_,mouse:a,source:x||""})){o.next=17;break}return[pe.F.onTab,pe.F.onUnTab].indexOf(d)>-1&&i.preventDefault(),o.abrupt("return");case 17:if(E=!r.isFocus(),C=!a||l&&l.collect,T=d&&I.M[d],M=Object(I.Gw)(T),d&&!E&&(!Object(ct.w)()||a)){o.next=26;break}return d&&(null===(j=p[d])||void 0===j||j.call(p,i)),!E&&y(),C&&T&&d&&p[d]&&Object(I.Fi)({actionType:T,sendImmediately:M,blocks:[],blockManager:n,source:x,category:null===l||void 0===l?void 0:l.category,click:a?I.c.block_action:I.c.hotkey_action,actionObject:B.u.BLOCK}),o.abrupt("return");case 26:if(a||F.S.emit(S.t,{source:S.S.KEY_EVENTS}),A=null,!C){o.next=56;break}if(N={},T!==I.F.enter){o.next=49;break}if(!(m.filter((function(e){return e.type===L.j.BLOCK})).length>0)){o.next=37;break}N.value1="true",N.value4="unknow",o.next=47;break;case 37:if(U=O[0]){o.next=41;break}return(null===(H=window.getSelection())||void 0===H?void 0:H.getRangeAt(0).commonAncestorContainer).classList.contains("table-content-padding")&&i.preventDefault(),o.abrupt("return");case 41:N.value1="false",N.value3="undefined"!==typeof U.record.snapshot.seq?"order":"none",N.value2="undefined"!==typeof U.record.snapshot.folded?"".concat(!U.record.snapshot.folded):"true",W=(V=U).editor,z=V.model,G=z.getSelection(),W&&G?(K=D.C(G),q=D.X(G),z.isSelectingAll()?(N.value1="true",delete N.value2,delete N.value3,N.value4="unknow"):(X="unknow",X=K?"start":q?"end":"mid",N.value4=X)):N.value4="unknow";case 47:o.next=54;break;case 49:Y=null===T||void 0===T?void 0:T.split("_").pop(),J=Object(w.h)(O),Z=Y&&J(Y),Q=O.every((function(e){return R.O.includes(e.type)&&e.record.snapshot.seq}))&&Y===R.B.ORDERED,N={value1:Z||Q?"false":"true"};case 54:d===pe.F.onTurnIntoQuoteContainer&&($=Object(w.P)(O,n),N={value1:$(R.B.QUOTE_CONTAINER)?"false":"true"}),A=Object(I.Fi)({actionType:T,sendImmediately:M,blocks:O,blockManager:n,source:x,category:null===l||void 0===l?void 0:l.category,click:a?I.c.block_action:I.c.hotkey_action,actionObject:_?B.u.TEXT:B.u.BLOCK,actionValue:N});case 56:return o.next=58,b({isSingleTextSelection:_,isTextSelectionAcrossBlocks:k,target:O,currentTarget:O,mouse:a,name:d,e:i,propagation:!1,collector:A,triggerSource:u});case 58:return A&&!M&&A.send(),null===(c=v[d])||void 0===c||c.call(v,i),o.next=62,y();case 62:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}(),_=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=ct.P.find((function(n){return n.handler===e}));if(o){o.handler,o.enabled,o.name,o.printKey;var c=i()(o,["handler","enabled","name","printKey"]);return m(lc(lc({},c),{},{ignoreSrcElementChecked:!0,preventDefault:function(){},stopImmediatePropagation:function(){},stopPropagation:function(){}}),!0,n,r)}};return function(){return E.a.useEffect((function(){return O.Q.on("keydown",document,m,{priority:f}),document.addEventListener("mobile-keydown",m),n.addListener(ct.y,_),function(){O.Q.off("keydown",document,m),document.removeEventListener("mobile-keydown",m),n.removeListener(ct.y,_)}}),[]),null}}},{key:"log",value:function(e,n,r){e||F.S.emit(S.e,{operation_method:S.mu.SHORTCUT,source:"other",action:n,blockManager:this.blockManager,block_id:r})}}]),r}(A.A)},dx_O87h:function(e,n,r){"use strict";(function(t){var e=r("dx_J4zp"),o=r.n(e),i=r("dx_TSYQ"),c=r.n(i),a=r("dx_UtDZ"),l=r("dx_h6a8"),s=r("dx_cDcd"),u=r.n(s),d=r("dx_h74D"),f=r("dx_lXkh"),h=r("dx_Nv7e"),p=r("dx_rQGm"),v=r("dx_E2oU"),g=r("dx_k2kp"),b=r("dx_EuEb"),y=r("dx_qKh5"),m=r("dx_D8nn"),_=r("dx_qx8A"),k=r.n(_),O=r("dx_h3h2"),x=r("dx_T17T"),E=r("dx_nd1Q"),S=(r("dx_Y1Yv"),r("dx_JMEe")),C=a.renderHelpers.MultiStageRenderContainer,I=a.renderHelpers.DocxStage,B=a.renderHelpers.Business;n.S=function(e){var n=Object(d.useSelector)(v.M),r=Object(d.useSelector)(a.selectIsOnline),i=Object(d.useSelector)(v.n),_=Object(d.useSelector)(a.selectors.share.selectCanEditInvolvingEditMode),T=_&&Object(y.r)()?Object(g.R)(k.a.getState())===y.n.EDITING:_,w=Object(d.useSelector)(a.selectors.translate.selectTranslateStatus),R=Object(s.useRef)(null),M=Object(s.useRef)(),j=Object(s.useState)(!1),D=o()(j,2),A=D[0],P=D[1],L=c()("doc-cover-entry",{"doc-cover-entry-disable":!r,"doc-cover-entry-active":A}),N=Object(l.throttle)((function(){r&&!Object(h.A)()?(P(!0),Object(E.a)(),m.S.emit(p.l9),M.current&&M.current.randomCover()):Object(h.A)()&&Object(h.yO)()}),4e3,{trailing:!1}),F=Object(s.useCallback)((function(){P(!1)}),[P]);Object(s.useEffect)((function(){r||F()}),[r,F]),Object(s.useEffect)((function(){n&&P(!1)}),[n]);var U=!Object(b.t)()||n||i||!T||w.had_enter_translate_mode;return u.a.createElement(S.L,e,U?null:u.a.createElement("div",{ref:R,className:L,onClick:N},u.a.createElement(f.S,null),u.a.createElement("span",null,t("CreationDoc_Docs_DocCover_AddCover_Button"))),u.a.createElement(x.S,{trigger:R.current,extend:!1,onClose:F,ignoreClass:["doc-cover-entry"]},u.a.createElement(C,{renderOnTimeout:!0,business:B.Docx,renderWhen:I.Done},u.a.createElement(O.S,{cRef:M,popoverActived:A,uiShow:!1,onHide:F}))))}}).call(this,r("dx_E9Eu"))},dx_O8UM:function(e,n,r){"use strict";r.d(n,"G",(function(){return l}));var o=r("dx_Icqc"),i=r("dx_jDMf");r.d(n,"m",(function(){return i.m})),r.d(n,"s",(function(){return i.s})),r.d(n,"S",(function(){return i.S}));var c=r("dx_lhRo");r.d(n,"v",(function(){return c.v})),r.d(n,"U",(function(){return c.U})),r.d(n,"h",(function(){return c.h}));var a=r("dx_DXiY");r.d(n,"P",(function(){return a.P})),r.d(n,"D",(function(){return a.D}));var l="menu_ud_icon";Object(a.M)(Object(o.getCurrentThemeType)()),Object(c.N)(Object(o.getCurrentThemeType)()),Object(i.M)(Object(o.getCurrentThemeType)()),Object(o.onUIStateChange)((function(e){var n="DARK"===(e.mode&&e.mode.toUpperCase())?o.ThemeType.DARK:o.ThemeType.LIGHT;Object(a.M)(n),Object(c.N)(n),Object(i.M)(n)}))},dx_ODGH:function(e,n,r){},dx_OEIU:function(e,n,r){"use strict";r.d(n,"r",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("lazy-record-status")},dx_OJCf:function(e,n,r){"use strict";(function(t){r.d(n,"P",(function(){return O})),r.d(n,"u",(function(){return E})),r.d(n,"y",(function(){return S})),r.d(n,"G",(function(){return C})),r.d(n,"f",(function(){return _})),r.d(n,"w",(function(){return I})),r.d(n,"E",(function(){return B})),r.d(n,"c",(function(){return T})),r.d(n,"e",(function(){return k})),r.d(n,"o",(function(){return M}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_lSNA"),l=r.n(a),s=r("dx_QILm"),u=r.n(s),d=r("dx_UtDZ"),f=r("dx_yzqx"),h=r("dx_cGa6"),p=r("dx_zghO"),v=r("dx_D8nn"),g=r("dx_awlV"),b=r("dx_MUMK");function y(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function m(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?y(Object(r),!0).forEach((function(n){l()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var _,k,O=[{code:"ArrowUp",handler:b.F.onArrowUp},{code:"ArrowDown",handler:b.F.onArrowDown},{code:"ArrowLeft",handler:b.F.onArrowLeft},{code:"ArrowRight",handler:b.F.onArrowRight},{ctrlKey:!0,code:"KeyB",keyCode:g.G.B,handler:b.F.onCtrlLeft,enabled:f.S.isMac||f.S.isIPad},{ctrlKey:!0,code:"KeyP",keyCode:g.G.P,handler:b.F.onCtrlUp,enabled:f.S.isMac||f.S.isIPad},{ctrlKey:!0,code:"KeyN",keyCode:g.G.N,handler:b.F.onCtrlDown,enabled:f.S.isMac||f.S.isIPad},{ctrlKey:!0,code:"KeyF",keyCode:g.G.F,handler:b.F.onCtrlRight,enabled:f.S.isMac||f.S.isIPad},{shiftKey:!0,code:"ArrowUp",handler:b.F.onShiftArrowUp},{shiftKey:!0,code:"ArrowDown",handler:b.F.onShiftArrowDown},{shiftKey:!0,code:"ArrowLeft",handler:b.F.onShiftArrowLeft},{shiftKey:!0,code:"ArrowRight",handler:b.F.onShiftArrowRight},{altKey:f.S.isMac,ctrlKey:!f.S.isMac,shiftKey:!0,code:"ArrowUp",handler:b.F.onAltShiftArrowUp},{altKey:f.S.isMac,ctrlKey:!f.S.isMac,shiftKey:!0,code:"ArrowDown",handler:b.F.onAltShiftArrowDown},{altKey:f.S.isMac,ctrlKey:!f.S.isMac,shiftKey:!0,code:"ArrowLeft",handler:b.F.onAltShiftArrowLeft},{altKey:f.S.isMac,ctrlKey:!f.S.isMac,shiftKey:!0,code:"ArrowRight",handler:b.F.onAltShiftArrowRight},{metaCtrlKey:!0,shiftKey:!0,code:"KeyP",keyCode:g.G.P,handler:b.F.onPresentationMode},{metaCtrlKey:!0,code:"KeyF",keyCode:g.G.F,handler:b.F.onFind},{metaCtrlKey:!0,shiftKey:!0,code:"KeyH",keyCode:g.G.H,handler:b.F.onReplace},{metaCtrlKey:!0,shiftKey:!0,code:"ArrowUp",handler:b.F.onShiftCmdUp},{metaCtrlKey:!0,shiftKey:!0,code:"ArrowDown",handler:b.F.onShiftCmdDown},{ctrlKey:f.S.isMac,shiftKey:!0,altKey:!f.S.isMac,code:"ArrowUp",handler:b.F.onShiftCtrlUp,hotkey:!(f.S.isLark&&f.S.isMobile)},{ctrlKey:f.S.isMac,shiftKey:!0,altKey:!f.S.isMac,code:"ArrowDown",handler:b.F.onShiftCtrlDown,hotkey:!(f.S.isLark&&f.S.isMobile)},{altKey:!0,code:"KeyC",keyCode:g.G.C,handler:b.F.onToggleTask},{metaCtrlKey:!0,code:"ArrowUp",handler:b.F.onCmdUp},{metaCtrlKey:!0,code:"ArrowDown",handler:b.F.onCmdDown},{metaCtrlKey:!0,code:"KeyA",keyCode:g.G.A,handler:b.F.onSelectAll,hotkey:!(f.S.isLark&&f.S.isMobile)},{code:"Escape",handler:b.F.onExit},{code:"Tab",handler:b.F.onTab},{shiftKey:!0,code:"Tab",handler:b.F.onUnTab},{key:"Delete",handler:b.F.onDelete},{ctrlKey:!0,code:"KeyD",keyCode:g.G.D,handler:b.F.onDelete,enabled:f.S.isMac||f.S.isIPad},{metaCtrlKey:!0,key:"Delete",handler:b.F.onDelete},{ctrlKey:!0,key:"Delete",handler:b.F.onDelete},{ctrlKey:!0,code:"KeyK",keyCode:g.G.K,handler:b.F.onDelete,enabled:f.S.isMac||f.S.isIPad},{key:"Backspace",handler:b.F.onBackspace},{ctrlKey:!0,code:"KeyH",keyCode:g.G.H,handler:b.F.onBackspace,enabled:f.S.isMac||f.S.isIPad},{metaCtrlKey:!0,key:"Backspace",handler:b.F.onBackspace},{ctrlKey:!0,key:"Backspace",handler:b.F.onBackspace},{shiftKey:!0,key:"Backspace",handler:b.F.onBackspace},{key:"Enter",handler:b.F.onEnter},{shiftKey:!0,key:"Enter",handler:b.F.onShiftEnter},{metaCtrlKey:!0,key:"Enter",handler:b.F.onMetaEnter},{metaCtrlKey:!0,shiftKey:!0,key:"Enter",handler:b.F.onMetaShiftEnter},{altKey:!0,key:"Backspace",handler:b.F.onBackspaceWord},{altKey:!0,key:"Delete",handler:b.F.onDeleteWord},{metaCtrlKey:!0,code:"KeyB",keyCode:g.G.B,handler:b.F.onBold,name:t("editorbar.bold")},{metaCtrlKey:!0,code:"KeyI",keyCode:g.G.I,handler:b.F.onItalic,name:t("common.italic")},{metaCtrlKey:!0,code:"KeyU",keyCode:g.G.U,handler:b.F.onUnderline,name:t("common.underline")},{metaCtrlKey:!0,shiftKey:!0,code:"KeyX",keyCode:g.G.X,handler:b.F.onStrikeThrough,name:t("common.strikethrough"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,altKey:!0,code:"KeyH",keyCode:g.G.H,handler:b.F.onTextHighlight,name:t("toolbox.item.textHighlight"),hotkey:!(f.S.isLark&&f.S.isMobile)},{ctrlKey:!0,metaCtrlKey:!0,code:"KeyC",keyCode:g.G.C,shiftKey:!f.S.isMac,handler:b.F.onInlineCode,name:t("common.inline_code"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,code:"KeyK",keyCode:g.G.K,handler:b.F.onLink,name:t("CreationDoc_Docs_WebBookmark_DisplayAs_Link_Button")},{metaCtrlKey:!0,altKey:!0,code:"Digit0",keyCode:g.G._0,handler:b.F.onTurnIntoText,name:t("slide.insertText.default"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,altKey:!0,code:"Digit1",keyCode:g.G._1,handler:b.F.onTurnIntoHeading1,name:t("common.first_level_heading"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,altKey:!0,code:"Digit2",keyCode:g.G._2,handler:b.F.onTurnIntoHeading2,name:t("common.second_level_heading"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,altKey:!0,code:"Digit3",keyCode:g.G._3,handler:b.F.onTurnIntoHeading3,name:t("common.third_level_heading"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,altKey:!0,code:"Digit4",keyCode:g.G._4,handler:b.F.onTurnIntoHeading4,name:t("common.forth_level_heading"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,altKey:!0,code:"Digit5",keyCode:g.G._5,handler:b.F.onTurnIntoHeading5,name:t("common.fifth_level_heading"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,altKey:!0,code:"Digit6",keyCode:g.G._6,handler:b.F.onTurnIntoHeading6,name:t("common.sixth_level_heading"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,altKey:!0,code:"Digit7",keyCode:g.G._7,handler:b.F.onTurnIntoHeading7,name:t("common.seventh_level_heading"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,altKey:!0,code:"Digit8",keyCode:g.G._8,handler:b.F.onTurnIntoHeading8,name:t("common.eighth_level_heading"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,altKey:!0,code:"Digit9",keyCode:g.G._9,handler:b.F.onTurnIntoHeading9,name:t("common.ninth_level_heading"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,altKey:!0,code:"KeyT",keyCode:g.G.T,handler:b.F.onTurnIntoTask,name:Object(h.Q)()?t("CreationDoc_Tasks_ChecklistReplaceTodo_MenuOption"):t("common.checkbox"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,shiftKey:!0,code:"Digit7",keyCode:g.G._7,handler:b.F.onTurnIntoOrdered,name:t("common.ordered_list"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,shiftKey:!0,code:"Digit8",keyCode:g.G._8,handler:b.F.onTurnIntoBullet,name:t("common.unordered_list"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,altKey:!0,code:"KeyC",keyCode:g.G.C,handler:b.F.onTurnIntoCode,name:t("help.siderbar.code_block"),hotkey:!(f.S.isLark&&f.S.isMobile)},{code:"Minus",keyCode:g.G.DASH,handler:b.F.onMinus},{metaCtrlKey:!0,shiftKey:!0,code:"Period",keyCode:g.G.PERIOD,printKey:">",handler:b.F.onTurnIntoQuoteContainer,name:t("common.reference")},{metaCtrlKey:!0,shiftKey:!0,code:"FakeKey",handler:b.F.onTurnIntoCallout},{metaCtrlKey:!0,altKey:!0,code:"KeyS",keyCode:g.G.S,handler:b.F.onAddDivider,name:t("common.divider"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,altKey:!0,code:"KeyN",keyCode:g.G.N,handler:b.F.onNewPage,name:t("wiki.space-add-doc")},{metaCtrlKey:!0,altKey:!0,code:"KeyW",keyCode:g.G.W,handler:b.F.onAddReminder,name:t("CreationDoc_Docs_Reminder_Tab")},{metaCtrlKey:!0,altKey:!0,code:"KeyA",keyCode:g.G.A,handler:b.F.onInsertTable},{metaCtrlKey:!0,shiftKey:!0,code:"KeyL",keyCode:g.G.L,handler:b.F.TextAlignLeft,hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,shiftKey:!0,code:"KeyE",keyCode:g.G.E,handler:b.F.TextAlignCenter,hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,shiftKey:!0,code:"KeyR",keyCode:g.G.R,handler:b.F.TextAlignRight,hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,code:"KeyC",keyCode:g.G.C,handler:b.F.onCopy,name:t("CreationDoc_DocX_help_siderbar_shortcuts_copy_text")},{metaCtrlKey:!0,code:"KeyX",keyCode:g.G.X,handler:b.F.onCut,name:t("CreationDoc_DocX_help_siderbar_shortcuts_cut_text")},{metaCtrlKey:!0,altKey:!0,code:"KeyM",keyCode:g.G.M,handler:b.F.onComment,name:t("CreationDoc_DocX_MenuOption_Comment"),hotkey:!(f.S.isLark&&f.S.isMobile)},{metaCtrlKey:!0,shiftKey:!1,code:"KeyS",keyCode:g.G.S,handler:b.F.onSave},{metaCtrlKey:!0,code:"Slash",keyCode:g.G.FORWARD_SLASH,handler:b.F.onHelpSiderbar},{metaCtrlKey:!0,shiftKey:!0,code:"KeyF",keyCode:g.G.F,handler:b.F.onAdvancedSearch}].filter((function(e){return!1!==e.enabled})).map((function(e){var n=!(!e.ctrlKey&&(f.S.isMac||f.S.isIPad||!e.metaCtrlKey)),r=!!(e.metaKey||(f.S.isMac||f.S.isIPad)&&e.metaCtrlKey),o=(e.metaCtrlKey,e.metaKey,u()(e,["metaCtrlKey","metaKey"]));return f.S.isMac||f.S.isIPad?m(m({shiftKey:!1,altKey:!1},o),{},{metaKey:r,ctrlKey:n}):m(m({shiftKey:!1,altKey:!1},o),{},{ctrlKey:n})})),x=new Map,E=function(e,n){if(e instanceof CustomEvent&&e.detail.isMobileEvent)return b.K[e.detail.mobileEventName];if(x.has(e))return x.get(e);var r=e,o={code:r.code,key:r.key,keyCode:r.keyCode,altKey:r.altKey,shiftKey:r.shiftKey,ctrlKey:r.ctrlKey,metaKey:r.metaKey},i=O.find((function(e){e.handler,e.enabled,e.name,e.printKey,e.hotkey;var n=u()(e,["handler","enabled","name","printKey","hotkey"]);if(n.keyCode&&n.code){n.code;var r=u()(n,["code"]);return Object.keys(r).every((function(e){return o[e]===r[e]}))}return Object.keys(n).every((function(e){return o[e]===n[e]}))}));return!1!==n||!1!==(null===i||void 0===i?void 0:i.hotkey)?(x.set(e,null===i||void 0===i?void 0:i.handler),setTimeout((function(){x.clear()})),null===i||void 0===i?void 0:i.handler):void 0},S="keyevents",C=function(e,n,r){r&&r.assignedSelection&&(v.X.isTriggerredByClick=!0);var o=r&&r.collectContext,i=r&&r.triggerSource,c=[n];o?c.push(o):c.push(null),i&&c.push(i),e.dispatch(S,c)};function I(){var e,n,r=null===(e=window.getSelection())||void 0===e||null===(n=e.focusNode)||void 0===n?void 0:n.parentElement;if(!r)return!1;for(var o=0,i=[".sheet-block-container"];o<i.length;o++){var c=i[o];if(r.closest(c))return!0}return!1}function B(){var e=f.S.isMac||f.S.isIPad;window.localStorage.getItem("bear-selectall-tips")||window.sessionStorage.getItem("bear-selectall-tips-once")||(d.Toast.show({key:"tips",type:"info",duration:5e3,content:t(e?"CreationDoc_DocX_MultiSelectAll_toast_mac":"CreationDoc_DocX_MultiSelectAll_toast_win"),cancelable:!0,cancelText:t("CreationDoc_DocX_MultiSelectAll_no_btn"),onCancel:function(){return window.localStorage.setItem("bear-selectall-tips","1")},closeAfterCancel:!0}),window.sessionStorage.setItem("bear-selectall-tips-once","1"),window.onbeforeunload=function(){return window.sessionStorage.removeItem("bear-selectall-tips-once")})}function T(e,n){return w.apply(this,arguments)}function w(){return(w=c()(o.a.mark((function e(n,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return R((function(){v.S.emit(v.p.MOBILE.BLOCK_MENU.HIDE_BLOCK_MENU)}),r),e.next=3,n();case 3:r.isBlockSelection()&&v.S.emit(v.p.MOBILE.BLOCK_MENU.SHOW_BLOCK_MENU);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e,n){var r=n.forward;e(),n.forward=r}function M(e){var n,r=e;if(r.length<1)return r;var o=r[r.length-1];return o.type===p.j.TEXT&&0===(null===(n=o.selection)||void 0===n?void 0:n.start)&&0===o.selection.end&&r.pop(),r}!function(e){e.TEXT_TOOLBAR="text-toolbar",e.TEXT_BLOCK_TOOLBAR="text-block-toolbar"}(_||(_={})),function(e){e.SELECT_ALL_PAGE="select_all_page",e.UN_SELECT_ALL_PAGE="un_select_all_page"}(k||(k={}))}).call(this,r("dx_E9Eu"))},dx_OM1j:function(e,n,r){"use strict";r.d(n,"w",(function(){return d}));var o=r("dx_QILm"),i=r.n(o),c=r("dx_PcQO"),a=r("dx_TSYQ"),l=r.n(a),s=r("dx_cDcd"),u=r.n(s),d=(r("dx_JcnR"),function(e){var n=e.children,r=e.overlayClassName,o=e.className,a=e.content,s=e.delay,d=void 0===s?300:s,f=e.maxWidth,h=void 0===f?420:f,p=i()(e,["children","overlayClassName","className","content","delay","maxWidth"]);return u.a.createElement(c.Tooltip,Object.assign({checkOverflow:!0,maxWidth:h,mouseEnterDelay:d,overlayClassName:l()("okr-block__ellipsis-overlay",r),title:a,showArrow:!1,placement:"topLeft",trigger:"hover"},p),u.a.createElement("div",{className:l()("okr-block__ellipsis",o)},n||a))})},dx_ONjz:function(e,n,r){"use strict";r.d(n,"N",(function(){return c})),r.d(n,"V",(function(){return a})),r.d(n,"l",(function(){return l}));var o=r("dx_sXyB"),i=r.n(o),c=[["ABAP",["ABAP"]],["Ada",["Ada"]],["Apache",["Apache","ApacheConf"]],["Apex",["Apex"]],["Assembly language",["ASM"]],["TypeScript",["TS","TSX","TypeScript"]],["Bash",["ASH","BASH","CSH","SH","TCSH","ZSH"]],["C",["C","H"]],["CMake",["cmake","cmake.in"]],["COBOL",["COBOL"]],["CoffeeScript",["CoffeeScript","Coffee","Cson","Iced"]],["C++",["C++","CC","HH","CPP"]],["C#",["CS","CSharp"]],["CSS",["CSS"]],["D",["D"]],["Diff",["diff","patch"]],["Dart",["Dart"]],["Delphi",["Delphi","DFM","DPR","PAS","Pascal"]],["Dockerfile",["Docker","Dockerfile"]],["Erlang",["Erl","Erlang"]],["Fortran",["F90","F95","Fortran"]],["Go",["Go","GoLang"]],["Django",["Django","JinJa"]],["GraphQL",["graphql"]],["Groovy",["Groovy"]],["Haskell",["Haskell","HS"]],["HTML",["HTML"]],["HTMLBars",["HTMLBars"]],["HTTP",["HTTP","HTTPS"]],["Java",["Java"]],["JavaScript",["JavaScript"]],["JavaScript",["JS"]],["JavaScript",["JSX"]],["JSON",["JSON"]],["Java",["JSP"]],["Julia",["Julia"]],["Kotlin",["Kotlin","KT"]],["LaTeX",["Math","LaTeX","TeX"]],["Lisp",["Lisp"]],["Lua",["Lua"]],["Makefile",["MAK","Makefile","MK"]],["Markdown",["Markdown","MD"]],["MATLAB",["MATLAB"]],["Nginx",["Nginx"]],["Objective-C",["OC","OBJC","ObjectiveC","MM"]],[r("dx_z0z2").E,["PlainText","Plain","Text","Txt"]],["Perl",["Perl","PL","PM"]],["PHP",["PHP"]],["Prolog",["Prolog"]],["Properties",["properties","Properties"]],["ProtoBuf",["Proto","ProtoBuf"]],["Python",["Py","Python"]],["R",["R"]],["Ruby",["RB","Ruby"]],["Rust",["RS","Rust"]],["SAS",["SAS"]],["Scala",["Scala"]],["Scheme",["Scheme"]],["SCSS",["SCSS"]],["Shell",["Shell"]],["Solidity",["solidity","sol"]],["SQL",["SQL"]],["Swift",["Swift"]],["TOML",["ini","toml"]],["Thrift",["Thrift"]],["VBScript",["VBS","VBScript"]],["Visual Basic",["VisualBasic"]],["XML",["XML","SVG"]],["YAML",["YAML","YML"]],["PowerShell",["PowerShell","PS"]],["OpenGL Shading Language",["glsl"]],["Gherkin",["gherkin"]]],a={Plaintext:"Plain Text",HTML:"HTML"},l=Array.from(new Set(i()(Array,c).sort().reduce((function(e,n,r){return 0===r&&e.unshift(a.Plaintext),n[0]===a.Plaintext?e:e.concat(n[0])}),[])))},dx_OOTY:function(e,n,r){},dx_OPAz:function(e,n,r){"use strict";r.d(n,"H",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("sheet-blockdep-loader")},dx_OUFY:function(e,n,r){"use strict";var o;r.d(n,"o",(function(){return o})),r.d(n,"f",(function(){return i})),r.d(n,"n",(function(){return c})),r.d(n,"M",(function(){return a})),r.d(n,"z",(function(){return l})),r.d(n,"s",(function(){return s})),function(e){e.ON_SCROLL="ON_SCROLL",e.ON_CATALOGUE_RECT_CHANGE="ON_CATALOGUE_RECT_CHANGE"}(o||(o={}));var i=3,c="scrollable-wrapper",a="scrollable-container",l="scrollable-item",s="scrollable-rect-ready"},dx_OYpu:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return T}));var e=r("dx_lSNA"),o=r.n(e),i=r("dx_lwsE"),c=r.n(i),a=r("dx_W8MJ"),l=r.n(a),s=r("dx_W7W2"),u=r.n(s),d=r("dx_a1gu"),f=r.n(d),h=r("dx_Nsbk"),p=r.n(h),v=r("dx_m3ds"),g=r("dx_S6Pn"),b=r("dx_TSYQ"),y=r.n(b),m=r("dx_cDcd"),_=r.n(m),k=r("dx_y5yU"),O=r("dx_TwmW"),x=r("dx_xk1y"),E=r("dx_UoSD"),S=r("dx_gLp6");function C(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=p()(e);if(n){var i=p()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return f()(this,r)}}var I=Object(k.r)(g.S,{theme:"light"}),B="docx-diagram-displayer",T=function(e){u()(r,e);var n=C(r);function r(){var e;c()(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(e=n.call.apply(n,[this].concat(i))).svgContainer=null,e}return l()(r,[{key:"renderNoContent",value:function(){return _.a.createElement("div",{className:"".concat(B,"_no-content")},_.a.createElement(I,{className:"".concat(B,"_no-content-img")}),_.a.createElement("span",null,t("CreationDoc_Docs_Diagram.NoContent.Desc")))}},{key:"componentDidUpdate",value:function(e){var n=this.props,r=n.svg,o=n.width,i=void 0===o?0:o;if((e.width!==i||e.svg!==r)&&r&&this.svgContainer){var c=parseInt(r.getAttribute("width")||"0",10),a=parseInt(r.getAttribute("height")||"0",10),l=a/c;c<i?(this.svgContainer.style.width="".concat(c,"px"),this.svgContainer.style.height="".concat(a,"px"),this.svgContainer.style.paddingBottom="0"):(this.svgContainer.style.paddingBottom="".concat(100*l,"%"),this.svgContainer.style.width="100%",this.svgContainer.style.height="0",this.svgContainer.style.position="relative")}}},{key:"render",value:function(){var e,n=this,r=this.props,i=r.selected,c=r.isBlankDiagram,a=r.svg,l=r.diagramType;return _.a.createElement("div",{className:y()(B,(e={},o()(e,"".concat(B,"_selected"),i),o()(e,"".concat(B,"_blank"),c()),o()(e,"".concat(B,"_safari"),v.S.isSafari),e)),style:{maxWidth:"100%",borderColor:this.borderColor},onMouseDown:this.props.onClick},_.a.createElement("div",{className:"".concat(B,"_logo")},l===S.O.FLOWCHART&&_.a.createElement(_.a.Fragment,null,_.a.createElement(x.S,null),_.a.createElement("span",null,t("CreationDoc_Docs_FlowDiagram_Title"))),l===S.O.UML&&_.a.createElement(_.a.Fragment,null,_.a.createElement(E.S,null),_.a.createElement("span",null,t("CreationDoc_Docs_UMLDiagram_Title")))),a&&(c()?this.renderNoContent():_.a.createElement("div",{ref:function(e){return Object(O.h)()&&(n.svgContainer=e)},className:"".concat(B,"_svg"),dangerouslySetInnerHTML:{__html:a.outerHTML}})))}},{key:"borderColor",get:function(){var e=this.props,n=e.selected,r=e.syncCursorSelected,o=e.syncCursorBorderColor;return!n&&r?o:void 0}}]),r}(m.Component)}).call(this,r("dx_E9Eu"))},dx_ObwN:function(e,n,r){"use strict";var o,i=r("dx_lwsE"),c=r.n(i),a=r("dx_yzqx");!function(e){e[e.System=0]="System",e[e.Handware=1]="Handware",e[e.CustomInput=2]="CustomInput"}(o||(o={}));n.S=new function e(){var n=this;c()(this,e),this.status=o.System,this.keyboardStatusChange=function(e){console.info("[KeyboardStatus] status change, callback response:",e),e&&(n.status=e.keyBoardType)},this.getStatus=function(){return console.info("[KeyboardStatus] get status",n.status),n.status},this.isIPadLarkHandware=function(){return!(!a.S.isBytedanceApp||!a.S.isIPad)&&n.getStatus()===o.Handware},a.S.isIPad&&a.S.isBytedanceApp&&window.lark.biz.keyboard.getType({callback:this.keyboardStatusChange})}},dx_OcvB:function(e,n,r){"use strict";r.d(n,"g",(function(){return l})),r.d(n,"I",(function(){return s}));var o=r("dx_cDcd"),i=r.n(o),c=r("dx_BaZy"),a=r.n(c),l=a()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_pudZ"))},loading:function(){return null},render:function(e,n){var r=e.default;return i.a.createElement(r,n)}}),s=a()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_zgZl"))},loading:function(){return null},render:function(e,n){var r=e.default;return i.a.createElement(r,n)}})},dx_Ofv4:function(e,n,r){"use strict";(function(t){var e=r("dx_PcQO"),o=r("dx_TSYQ"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c),l=r("dx_amgp"),s=r("dx_I9Iq"),u=(r("dx_Ifm4"),"okr-progress-tag"),d=Object(c.forwardRef)((function(n,r){var o=n.progress,c=n.status,d=n.editable,f=void 0===d||d,h=n.showTooltip,p=void 0===h||h,v=n.onHover,g=function(e,n){if(n>0)switch(e){case l.G.AT_RISK:return t("CreationDoc_Docs_OKR_Status_ProgressNumRisk",{progress:String(n)});case l.G.OFF_TRACK:return t("CreationDoc_Docs_OKR_Status_ProgressNumDelayed",{progress:String(n)});default:return t("CreationDoc_Docs_OKR_Status_ProgressNumNormal",{progress:String(n)})}else switch(e){case l.G.ON_TRACK:return t("CreationDoc_Docs_OKR_StatusCustom_Normal");case l.G.AT_RISK:return t("CreationDoc_Docs_OKR_StatusCustom_AtRisk");case l.G.OFF_TRACK:return t("CreationDoc_Docs_OKR_StatusCustom_Delayed");default:return t("CreationDoc_Docs_OKR_Status_None")}}(c,o);return a.a.createElement(e.Tooltip,{title:f&&g,offset:8,disabled:!p,onVisibleChange:function(e){e&&v()}},a.a.createElement("div",{className:i()(u,{editable:f}),ref:r},a.a.createElement(s.S,{className:"".concat(u,"__circle"),status:c,percent:o})))}));n.S=d}).call(this,r("dx_E9Eu"))},dx_Ogyw:function(e,n,r){"use strict";r.d(n,"B",(function(){return l})),r.d(n,"I",(function(){return u}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l="flash-block-content";function s(e){return(e.getBlockWrapper&&e.getBlockWrapper()?e.getBlockWrapper():function(e){if(!e.querySelector(".".concat(l,":not(.block)")))return e;for(var n=[],r=e;r;){if(r.classList.contains(l))return r;r=(n=n.concat(Array.prototype.slice.call(r.children).filter((function(e){return!e.classList.contains("block")})))).shift()}return e}(e.hostElement))||e.hostElement}function u(e){return d.apply(this,arguments)}function d(){return(d=a()(i.a.mark((function e(n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){n.forEach((function(e){return e.blockMaskManager.toggleMask("block-flash",!0,void 0,s(e))})),setTimeout((function(){n.forEach((function(e){return e.blockMaskManager.toggleMask("block-flash",!1)})),e()}),1e3)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},dx_OpCt:function(e,n,r){},dx_Orag:function(e,n,r){"use strict";r.d(n,"z",(function(){return y})),r.d(n,"y",(function(){return m})),r.d(n,"U",(function(){return _}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_N8Nu"),v=r("dx_TSYQ"),g=r.n(v);r("dx_w9nV");function b(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var y="".concat("clientside-","-task-block-line-through"),m="task-block-line-through",_=function(e){s()(r,e);var n=b(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).name="TodoLineThrough",e}return a()(r,[{key:"match",value:function(e){return e===r.KEY}},{key:"render",value:function(e){var n=g()(e.class,m);return e.class=n,e.children}}]),r}(p.o);_.KEY=y},dx_Otgx:function(e,n,r){"use strict";r.d(n,"M",(function(){return b}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f);function p(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function v(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?p(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function g(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var b=function(e){s()(r,e);var n=g(r);function r(e){var o,i=e.editor,c=e.undoDispatcher;a()(this,r),o=n.call(this);var l={unregister:c.unregister.bind(c),undo:c.undo.bind(c),redo:c.redo.bind(c),do:c.do.bind(c),register:function(e){c.register(v(v({},e),{},{onUndo:function(){e.undo(),i.focus()},onRedo:function(){e.redo(),i.focus()}}))}};return i.undoModule.setUndoDispatcher(l),o}return r}(r("dx_N8Nu").o)},dx_Otwn:function(e,n,r){"use strict";r.d(n,"S",(function(){return w}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_cDcd"),b=r("dx_h74D"),y=r("dx_MWd8"),m=r("dx_z8zm"),_=r("dx_O8UM"),k=r("dx_aRuT"),O=r("dx_Lqhf"),x=r("dx_KgXx"),E=r("dx_B28d"),S=r("dx_Vau3"),C=r("dx_hIkB"),I=r("dx_QWnh");r("dx_nsra");function B(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function T(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var w=function(e){d()(r,e);var n=T(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).getPresentationModeStyle=function(e,n){if(e!==C.h.PAGINATION)return{};var r=n.hostElement.querySelector(".".concat(E.S0));if(!r)return{};var o=Object(I.W)(n).zoom,i=parseFloat(r.style.marginLeft),c=parseFloat(r.style.marginRight),a=parseFloat(r.style.marginTop),l=parseFloat(r.style.marginBottom);return{marginLeft:"".concat(i*o,"px"),marginRight:"".concat(c*o,"px"),marginTop:"".concat(a*o,"px"),marginBottom:"".concat(l*o,"px")}},e}return s()(r,[{key:"getEffect",value:function(){var e=this;return function(n){var r=n.record,o=n.model,c=r.snapshot,a=o.id,l=function(e){if(!e)return e;var n=Object(_.s)(O.d.Background),r=Object(x.v)(n,e);!r&&k.C.some((function(n){return Object(y.J)(n,e)}))&&(r=k.u.DARK_NEUTRAL_BACKGROUND);var o=r&&Object(_.S)(O.d.Background).get(r);return Object(x.R)(o)||e}(c.background_color),s=Object(b.useSelector)(m.E);Object(g.useEffect)((function(){var n=e.blockManager.getBlockViewByBlockIdNotCheck(a);if(n){var r=n.blockMaskManager,o=e.getPresentationModeStyle(s,n);r.toggleMask("background",Boolean(l),function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?B(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({backgroundColor:l},o))}}),[l,a,s]),Object(g.useEffect)((function(){var n=e.blockManager.getBlockViewByBlockIdNotCheck(a);return function(){n&&n.blockMaskManager.toggleMask("background",!1)}}),[a,s])}}}]),r}(S.A)},dx_OxKN:function(e,n,r){},dx_OyqL:function(e,n,r){"use strict";r.d(n,"W",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("BlockMaskUpdater")},dx_OzdR:function(e,n,r){},dx_P55d:function(e,n,r){"use strict";r.d(n,"S",(function(){return K}));var o,i=r("dx_o0o1"),c=r.n(i),a=r("dx_RIqP"),l=r.n(a),s=r("dx_yXPU"),u=r.n(s),d=r("dx_lwsE"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_dIhn");!function(e){e.High="High",e.Low="Low"}(o||(o={}));var g="cover",b=r("dx_lSNA"),y=r.n(b),m=r("dx_Uyc2"),_=r.n(m),k=r("dx_W7W2"),O=r.n(k),x=r("dx_a1gu"),E=r.n(x),S=r("dx_Nsbk"),C=r.n(S),I=r("dx_UtDZ"),B=r("dx_ukKW"),T=r("dx_IFC7"),w=function(){function e(n,r){f()(this,e),this.uuid=void 0,this.token=void 0,this.isHD=void 0,this.originSrc=void 0,this.mimeType=void 0,this.logger=void 0,this.needBlob=B.y,this.blobUrl=null,this.token=n.token,this.isHD=n.isHD,this.logger=r}return p()(e,[{key:"fetchImageResource",value:function(e,n){var r=this;return this.fetchCdn().then((function(e){var n=r.convertToBlobUrl(e);return r.blobUrl=n,{src:n,status:r.logger.fetchStatus}})).catch(function(){var o=u()(c.a.mark((function o(i){var a;return c.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:if(console.error("[image plugin] fetch failed",i),a=r.generateOriginSrc(e,n),!r.needBlob){o.next=7;break}return o.next=5,r.getBlobUrl(a);case 5:a=o.sent,r.blobUrl=a;case 7:return o.abrupt("return",{src:a,status:r.logger.fetchStatus});case 8:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}())}},{key:"getBlobUrl",value:function(){var e=u()(c.a.mark((function e(n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(T.K)(n);case 2:return r=e.sent,e.abrupt("return",URL.createObjectURL(r));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},{key:"convertToBlobUrl",value:function(e){var n=new DataView(e),r=new Blob([n],{type:Object(B.e)(e)});return URL.createObjectURL(r)}},{key:"afterFetch",value:function(){this.logger.destroy()}},{key:"destroy",value:function(){this.blobUrl&&URL.revokeObjectURL(this.blobUrl),this.blobUrl=null}}]),e}(),R=r("dx_h6a8"),M=r("dx_AAGW");function j(e){return D.apply(this,arguments)}function D(){return(D=u()(c.a.mark((function e(n){var r,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(R.chunk)(n,200),o=Object(I.prependAPI)("/api/box/file/cdn_url/"),e.next=4,Promise.all(r.map((function(e){return M.S.post(o,e)})));case 4:return i=e.sent,e.abrupt("return",i.map((function(e){return e.data})).flat());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e){return e.map((function(e){return{file_token:e.token,platform:"pc",type:e.isHD?"":g}}))}function P(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=C()(e);if(n){var i=C()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return E()(this,r)}}var L,N,F,U=function(e){O()(r,e);var n=P(r);function r(e,o){var i;return f()(this,r),(i=n.call(this,e,o)).cdnInfo=null,e.cdnInfo&&(i.cdnInfo=e.cdnInfo),i}return p()(r,[{key:"generateOriginSrc",value:function(e,n){return this.isHD?Object(B.T)(this.token,n):Object(B.c)({fileId:this.token,recordId:n,width:e.width,height:e.height,scale:e.scale})}},{key:"fetchCdn",value:function(){var e=u()(c.a.mark((function e(){var n,r,o,i,a,l,s,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.cdnInfo){e.next=5;break}return e.next=4,this.fetchSingleCdnConfig();case 4:n=e.sent;case 5:return r=this.parseCdnConfig(n),o=r.needDecrypt,i=r.cdnUrl,a=r.key,l=r.iv,this.logger.logFetchCdnStart(),e.next=9,this.fetchCdnResource(i,o);case 9:if(s=e.sent,this.logger.logFetchCdnEnd(s),!o){e.next=20;break}return this.logger.logDecryptStart(),e.next=15,Object(B.U)({data:s,key:a,iv:l,algorithm:"AES-GCM"});case 15:return u=e.sent,this.logger.logDecryptEnd(!!u),e.abrupt("return",u);case 20:return this.logger.logNoNeedDecrypt(),e.abrupt("return",s);case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"fetchSingleCdnConfig",value:function(){var e=u()(c.a.mark((function e(){var n,r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={file_token:this.token,platform:"pc",type:this.isHD?"":g},this.logger.logFetchCdnConfigStart(),e.next=4,j([n]);case 4:return r=e.sent,o=r&&r[0],this.logger.logFetchCdnConfigEnd(!!o),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parseCdnConfig",value:function(e){var n=e.url,r=e.cipher_type,o=e.secret,i=e.nonce;return{needDecrypt:"0"!==r,cdnUrl:n,key:o,iv:Object(B.i)(i)}}},{key:"fetchCdnResource",value:function(){var e=u()(c.a.mark((function e(n,r){var o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(I.request)({url:n,method:"get",ignoreInterceptors:!0,responseType:"arraybuffer",withCredentials:!r,timeout:6e4});case 2:return o=e.sent,e.abrupt("return",o.data);case 4:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()}]),r}(w),H=r("dx_K2Kl"),V=function(){function e(n){f()(this,e),this.uuid=void 0,this.fetchStatus={},this.timer=new H.S,this.uuid=n}return p()(e,[{key:"logFetchCdnConfigStart",value:function(){this.timer.start("fetchCdnConfig_".concat(this.uuid)),this.fetchStatus.request_cdn_url_necessary=!0}},{key:"logFetchCdnConfigEnd",value:function(e){this.fetchStatus.request_cdn_url_fail=!e,this.fetchStatus.request_cdn_url_time_cost=this.timer.end("fetchCdnConfig_".concat(this.uuid))}},{key:"logFetchCdnStart",value:function(){this.timer.start("fetchCdn_".concat(this.uuid)),this.fetchStatus.request_cdn_necessary=!0}},{key:"logFetchCdnEnd",value:function(e){var n=!!e;this.fetchStatus.request_cdn_fail=!n,this.fetchStatus.request_cdn_time_cost=this.timer.end("fetchCdn_".concat(this.uuid)),this.fetchStatus.cdn_size=e.byteLength}},{key:"logDecryptStart",value:function(){this.timer.start("decrypt_".concat(this.uuid)),this.fetchStatus.decrypt_necessary=!0}},{key:"logNoNeedDecrypt",value:function(){this.fetchStatus.decrypt_necessary=!1}},{key:"logDecryptEnd",value:function(e){this.fetchStatus.decrypt_fail=!e,this.fetchStatus.decrypt_time_cost=this.timer.end("decrypt_".concat(this.uuid))}},{key:"destroy",value:function(){this.fetchStatus={},this.timer.clear()}}]),e}();function W(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function z(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?W(Object(r),!0).forEach((function(n){y()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var G=(L=function(e){var n=e.duration,r=new Set,o=null;function i(e){return a.apply(this,arguments)}function a(){return a=u()(c.a.mark((function e(n){var r,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=[],n.forEach((function(e){e.cdnInfo||r.push(e)})),!r.length){e.next=8;break}return e.next=5,j(A(r));case 5:o=e.sent,i=o.reduce((function(e,n){return e[n.file_token]=n,e}),{}),n.forEach((function(e){i[e.token]&&(e.cdnInfo=i[e.token])}));case 8:return e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)}))),a.apply(this,arguments)}return function(e,a,l){var s=l.value;"function"===typeof s&&(l.value=function(e,a){var l=this;!function(e){r.add(e)}(e),o||(o=window.setTimeout(u()(c.a.mark((function e(){var n,u,d,f,h;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Set(r),r.clear(),o=null,u=performance.now(),e.prev=3,e.next=6,i(n);case 6:d=e.sent,f=performance.now()-u,h={request_cdn_url_necessary:!0,request_cdn_url_fail:!d,request_cdn_url_time_cost:f.toString()},d.forEach((function(e){return s.call(l,e,a,h)})),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),console.error("[image fetcher] batch fetch drive cdn config failed",e.t0),n.forEach((function(e){return s.call(l,e,a)}));case 16:return e.abrupt("return");case 17:case"end":return e.stop()}}),e,null,[[3,12]])}))),n))})}}({duration:10}),F=function(){function e(n){f()(this,e),this.config=null,this.fetcherInstances=new Map,this.timerId=null,this.fetchContextQueue=[],this.config=n}return p()(e,[{key:"fetchWithInterval",value:function(){for(var e=this,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];this.fetchContextQueue.push(r);var i=function n(){!e.timerId&&e.fetchContextQueue.length&&(e.timerId=window.setTimeout((function(){var r=e.fetchContextQueue.shift();r&&e.fetch.apply(e,l()(r)),e.timerId=null,n()}),10))};i()}},{key:"fetch",value:function(){var e=u()(c.a.mark((function e(n,r,o){var i,a,l,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=new U(n,this.getLogger(n.uuid))){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,i.fetchImageResource(n,r);case 5:a=e.sent,l=a.src,s=a.status,this.config&&this.config.sendFinishedMsg&&this.config.sendFinishedMsg(n,{src:l,fetchCdnLogStatus:z(z({},s),o||{})}),i.afterFetch(),this.fetcherInstances.set(r,i);case 11:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"sendImage",value:function(e,n){this.fetchWithInterval(e,n,void 0)}},{key:"getLogger",value:function(e){return new V(e)}},{key:"delete",value:function(e){var n=this.fetcherInstances.get(e);n&&n.destroy()}},{key:"destroy",value:function(){this.fetcherInstances.forEach((function(e){return e.destroy()})),this.fetcherInstances.clear(),this.fetchContextQueue.length=0,this.timerId=null}}]),e}(),N=F,_()(N.prototype,"fetchWithInterval",[L],Object.getOwnPropertyDescriptor(N.prototype,"fetchWithInterval"),N.prototype),N),K=function(){function e(){f()(this,e),this.statusMap=new Map,this.preloadQueue=[],this.idleCallbackId=null,this.preloadCount=0,this.maxPreloadCount=50,this.callbackListMap=new Map,this.scheduler=new G({sendFinishedMsg:this.onFetchFinished.bind(this)})}return p()(e,[{key:"fetch",value:function(e,n,r,o){var i=this.getCachedResult(e);if(i)return i.isFromCache=!0,o(i);var c=this.getMapKey(e),a=this.statusMap.get(c);if(!a||!a.isFetching){var l=this.preloadQueue.find((function(n){return n.token===e.token}));l&&(e.cdnInfo=l.cdnInfo),this.scheduler.sendImage(e,n),this.statusMap.set(c,{isFetching:!0,success:!1})}this.addCallback(e,o)}},{key:"addCallback",value:function(e,n){var r=this.getMapKey(e),o=this.callbackListMap.get(r)||[];o.push(n),this.callbackListMap.set(r,o)}},{key:"onFetchFinished",value:function(e,n){var r=this.getMapKey(e),o=this.callbackListMap.get(r);o&&o.length>0&&o.forEach((function(e){return e(n)})),this.callbackListMap.set(r,[]),this.statusMap.set(r,{isFetching:!1,success:!!n.src,result:n})}},{key:"getCachedResult",value:function(e){var n=this.getMapKey(e),r=this.statusMap.get(n);return r&&r.success?r.result:null}},{key:"getMapKey",value:function(e){return"".concat(e.token,"-").concat(e.isHD)}},{key:"fetchCdnInfos",value:function(){var e=u()(c.a.mark((function e(n){var r,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(A(n));case 2:o=e.sent,i=o.reduce((function(e,n){return e[n.file_token]=n,e}),{}),n.forEach((function(e){e.cdnInfo=i[e.token]})),(r=this.preloadQueue).push.apply(r,l()(n)),this.startPreload();case 7:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"startPreload",value:function(){this.idleCallbackId||0===this.preloadQueue.length||this.preloadCount>this.maxPreloadCount||(this.idleCallbackId=Object(v.f)(this.preloadImage.bind(this)))}},{key:"preloadImage",value:function(){var e=this,n=this.preloadQueue.shift();n&&this.fetch(n,n.uuid,{},(function(){e.preloadCount++,e.idleCallbackId=null,e.startPreload()}))}},{key:"delete",value:function(e,n){var r=this.getMapKey(e);this.scheduler.delete(n),this.statusMap.delete(r),this.callbackListMap.delete(r)}},{key:"destroy",value:function(){this.scheduler.destroy(),this.statusMap.clear(),this.callbackListMap.clear()}}]),e}()},dx_P58d:function(e,n,r){"use strict";var o,i;r.d(n,"j",(function(){return o})),r.d(n,"q",(function(){return i})),function(e){e.BLOCK="block",e.TEXT="text"}(o||(o={})),function(e){e.TextSelection="TextSelection",e.Undo="Undo",e.Redo="Redo",e.TurnInto="TurnInto",e.RectArea="RectArea",e.ExternalInvoke="ExternalInvoke",e.Destroy="Destroy",e.TableHeader="TableHeader",e.MultiTextSelection="MultiTextSelection",e.ARROW_PRESS="arrowPress",e.HOTKEY="hotkey",e.Backspace="Backspace"}(i||(i={}))},dx_P5PS:function(e,n,r){"use strict";r.d(n,"e",(function(){return i})),r.d(n,"W",(function(){return c})),r.d(n,"Z",(function(){return a}));var o=r("dx_UtDZ"),i=new Set(window.slottedBlockTypes||Object(o.getMinaConfig)("docx_block_ssr_config",{slotted_block_types:[]}).slotted_block_types);function c(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m";return"<%=".concat(n,"[").concat(e,"]%>")}function a(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m";return"<%=".concat(n,"[outside_").concat(e,"]%>")}},dx_P74U:function(e,n,r){"use strict";r.d(n,"z",(function(){return M}));var o,i,c,a=r("dx_o0o1"),l=r.n(a),s=r("dx_yXPU"),u=r.n(s),d=r("dx_lwsE"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_lSNA"),g=r.n(v),b=r("dx_EDG4"),y=r("dx_UtDZ"),m=r("dx_h6a8"),_=r("dx_zUqt"),k=r("dx_Fimk"),O=r("dx_O1Ou"),x=r("dx_moB4"),E=r("dx_miEo"),S=r("dx_hgIo");function C(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function I(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?C(Object(r),!0).forEach((function(n){g()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}!function(e){e.PREVIEW="preview"}(o||(o={})),function(e){e.DRIVE_UPDATE="drive_update"}(i||(i={})),function(e){e.OPEN="open",e.CLOSE="close"}(c||(c={}));var B=O.a.DocxFile,T=O.a.DocxBoxPreview,w=g()({},o.PREVIEW,{id:"",type:c.CLOSE}),R=g()({},i.DRIVE_UPDATE,{driveUpdateRecordIdMap:{},driveUpdateMap:{}});x.X.addModuleConfigGetter((function(e){return{moduleName:B,defaultState:w,retryOnVersionMatched:"fail-only",retryOptions:{retryTimes:5,retryIntervalMs:200},recordIdsFromStateGetter:function(e,n){if(e===o.PREVIEW){var r=n.id;return r?[r]:[]}},checkSame:function(e,n,r){return e===o.PREVIEW&&(n.type===r.type&&(n.id===r.id||r.type===c.CLOSE&&n.id!==r.id))},requiredBlockNotRegisterReplayHandler:function(n){var r=n.actionType,i=n.data,a=n.uuid;r===o.PREVIEW&&(i.type===c.CLOSE&&(S.G.closeFilePreviewer("",E.Y.VC_NO_REGISTER),e.vcController.reportReplay(O.s.SUCCESS,a)))}}})),x.X.addModuleConfigGetter((function(){return{moduleName:T,defaultState:R,retryOnVersionMatched:"fail-only",recordIdsFromStateGetter:function(e,n){if(e===i.DRIVE_UPDATE)return Object.keys(n.driveUpdateRecordIdMap)},checkSame:function(e,n,r){if(e===i.DRIVE_UPDATE){var o=n.driveUpdateRecordIdMap,c=r.driveUpdateRecordIdMap;return!Object.keys(o).some((function(e){return!Object(m.isEqual)(o[e],c[e])}))}return!1}}}));var M=function(){function e(n,r,a,s,d,h){var p=this;f()(this,e),this.vcController=n,this.recordId=r,this.blockId=a,this.previewFileFullScreen=s,this.closeFilePreviewer=d,this.checkPreviewStatus=h,this.unregisterDocxFileModuleFn=void 0,this.unregisterDocxBoxPreviewModuleFn=void 0,this.docxFileModuleReplayHandler=function(){var e=u()(l.a.mark((function e(n){var r,i,a,s,u,d,f,h;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.actionType,i=n.data,a=n.uuid,r!==o.PREVIEW){e.next=24;break}if(u=(s=i).id,d=s.type,!u||u===p.recordId){e.next=5;break}return e.abrupt("return");case 5:e.t0=d,e.next=e.t0===c.OPEN?8:e.t0===c.CLOSE?20:23;break;case 8:return e.prev=8,e.next=11,p.previewFileFullScreen(E.o.REPLAY);case 11:p.reportPreviewStatus(!0,a),e.next=19;break;case 14:e.prev=14,e.t1=e.catch(8),h="[".concat(B,"]: preview file error: ").concat(e.t1.toString()),null===(f=p.vcController)||void 0===f||f.reportReplay(O.s.FAIL,a,h),Object(k.N)("vc_action_apply_dev",{code:1,info:h,action:B,string_param_1:JSON.stringify("string"===typeof e.t1?e.t1:e.t1 instanceof Error?e.t1.message:""),string_param_2:JSON.stringify(i)});case 19:return e.abrupt("break",24);case 20:return p.closeFilePreviewer(E.Y.VC),p.reportPreviewStatus(!1,a),e.abrupt("break",24);case 23:return e.abrupt("break",24);case 24:case"end":return e.stop()}}),e,null,[[8,14]])})));return function(n){return e.apply(this,arguments)}}(),this.docxFileModulePresenterHandler=function(e){var n=e.actionType,r=e.data;n===o.PREVIEW&&p.sendVcPosition(O.f.PRESENTER,r)},this.sendDocxFilePreviewState=function(e){var n,r;e?null===(n=p.vcController)||void 0===n||n.fullscreenSelectionHelper.enter(p.blockId):null===(r=p.vcController)||void 0===r||r.fullscreenSelectionHelper.exit(p.blockId),p.innerSendDocxFilePreviewState(e)},this.innerSendDocxFilePreviewState=Object(m.debounce)((function(e){var n,r={id:p.recordId,type:e?c.OPEN:c.CLOSE};null===(n=p.vcController)||void 0===n||n.sendState(B,o.PREVIEW,r)}),50),this.getDocxBoxPreviewModuleReplayHandler=function(e,n,r){return function(o){var c=o.actionType,a=o.data,l=o.uuid;if(c===i.DRIVE_UPDATE){var s,u=a,d=u.driveUpdateRecordIdMap,f=u.driveUpdateMap;if(0===Object.keys(d).length&&0===Object.keys(f).length)return void p.vcController.reportReplay(O.s.IGNORE,l,"default data");var h=null!==(s=null===d||void 0===d?void 0:d[e])&&void 0!==s?s:null===f||void 0===f?void 0:f[n];if(!h)return;null===r||void 0===r||r.triggerReceiveVCFollowState(I({uuid:l},h))}}},this.handleVCFollowFinished=function(e){var n=e.uuid,r=e.status,o=e.message;n&&p.vcController&&("success"===r?p.vcController.reportReplay(O.s.SUCCESS,n):"fail"===r?p.vcController.reportReplay(O.s.FAIL,n,o||""):p.vcController.reportReplay(O.s.IGNORE,n,o||""))},this.registerDocxFileModule(r)}return p()(e,[{key:"destroy",value:function(){var e;this.unregisterDocxBoxPreviewModule(),null===(e=this.unregisterDocxFileModuleFn)||void 0===e||e.call(this)}},{key:"registerDocxFileModule",value:function(e){this.unregisterDocxFileModuleFn=this.vcController.register({recordId:e,moduleName:B,defaultState:w,retryOnVersionMatched:"fail-only",replayHandler:this.docxFileModuleReplayHandler,presenterHandler:this.docxFileModulePresenterHandler})}},{key:"reportPreviewStatus",value:function(e,n){var r,o;this.checkPreviewStatus()===e?null===(r=this.vcController)||void 0===r||r.reportReplay(O.s.SUCCESS,n):null===(o=this.vcController)||void 0===o||o.reportReplay(O.s.FAIL,n,"[".concat(B,"]: check preview status diff"))}},{key:"sendVcPosition",value:function(e,n){var r,o=n.id,i=n.type;null===(r=this.vcController)||void 0===r||r.sendPosition(e,{space:i===c.OPEN?o:Object(y.encryptTea)(Object(_.k)())})}},{key:"registerDocxBoxPreviewModule",value:function(e,n,r){var o;r.on(b.BOX_PREVIEW_EVENTS.VC_FOLLOW_FINISHED,this.handleVCFollowFinished),this.unregisterDocxBoxPreviewModuleFn=null===(o=this.vcController)||void 0===o?void 0:o.register({recordId:e,moduleName:T,defaultState:R,replayHandler:this.getDocxBoxPreviewModuleReplayHandler(e,n,r),retryOnVersionMatched:"fail-only"})}},{key:"unregisterDocxBoxPreviewModule",value:function(){var e;null===(e=this.unregisterDocxBoxPreviewModuleFn)||void 0===e||e.call(this),this.unregisterDocxBoxPreviewModuleFn=void 0}},{key:"sendDocxBoxPreviewDriveUpdateState",value:function(e,n,r){var o=this.vcController.getState(T,i.DRIVE_UPDATE);this.vcController.sendState(T,i.DRIVE_UPDATE,{driveUpdateRecordIdMap:I(I({},null===o||void 0===o?void 0:o.driveUpdateRecordIdMap),{},g()({},e,r)),driveUpdateMap:I(I({},null===o||void 0===o?void 0:o.driveUpdateMap),{},g()({},n,r))})}}]),e}()},dx_P8LC:function(e,n,r){},dx_P9db:function(e,n,r){"use strict";r.d(n,"u",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("lazy-renderer")},dx_PEV2:function(e,n,r){"use strict";r.d(n,"S",(function(){return s}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_e4eN"),s=function(){function e(n,r){i()(this,e),this.editor=n,this.blockModel=r}return a()(e,[{key:"toTextClientVars",value:function(){return this.blockModel.zoneState.toAttributeText()}},{key:"indent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,n=this.editor.getContentState(),r=this.blockModel.getSelection(),o=[];if(!r)return o;var i=r.start,c=r.end,a=n.getZoneState(i.zoneId);if(!a)return o;for(var s=i.line===c.line?-i.offset:0,u=new l.m({zoneId:i.zoneId}),d=i.line;d<=c.line;d++){var f=a.getLine(d).getOffset();u=u.retain(f.start-s).insert(new Array(e).fill(" ").join("")),s=f.start,o.push(e)}return this.blockModel.apply(u),o}},{key:"unindent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,n=this.editor.getContentState(),r=this.blockModel.getSelection(),o=[];if(!r)return o;var i=r.start,c=r.end,a=n.getZoneState(i.zoneId);if(!a)return o;for(var s=new RegExp(" {1,".concat(e.toString(),"}$")),u=new l.m({zoneId:i.zoneId}),d=0,f=i.line;f<=c.line;f++){var h=a.getLine(f).getOffset(),p=a.getLine(f).getModelText();i.line===c.line?p=p.slice(0,i.offset):s=new RegExp("^ {1,".concat(e.toString(),"}"));var v=p.match(s);if(v){var g=v[0].length;i.line===c.line&&(d=-(i.offset-g)),u=u.retain(h.start-d).delete(g),d=h.start+g,o.push(g)}else o.push(0)}return this.blockModel.apply(u),o}}]),e}()},dx_PFuV:function(e,n,r){"use strict";(function(t){r.d(n,"s",(function(){return o}));var e=r("dx_Bv2G"),o=new Map([[e.F.CROSS_BRAND,t("CreationDoc_MultiGeo_900004511")],[e.F.CROSS_TENANT,t("CreationDoc_MultiGeo_900004510")]])}).call(this,r("dx_E9Eu"))},dx_PIlC:function(e,n,r){"use strict";r.d(n,"e",(function(){return a})),r.d(n,"P",(function(){return l})),r.d(n,"n",(function(){return s})),r.d(n,"U",(function(){return u})),r.d(n,"G",(function(){return d})),r.d(n,"I",(function(){return f}));var o=r("dx_FnUg"),i=r("dx_xs2W"),c=r("dx_Fimk"),a=function(){Object(i.T)(Object(o.L)(o.J.LATEX)),Object(c.N)("ccm_doc_equation_edit_page_click",{click:"click_equation_help",target:"none"})},l=function(e){e?Object(c.N)("ccm_doc_equation_edit_page_view",{}):Object(c.N)("ccm_doc_equation_edit_page_click",{click:"exit_equation_edit_view",target:"none"})},s={ADD:"inline_add",DELETE:"inline_delete",EDIT:"inline_edit"},u=function(e){Object(c.N)("ccm_doc_inline_component_edit_click",{click:e,target:"none",inline_type:"equation",domain:"text"})},d=function(){Object(c.N)("ccm_doc_content_page_click",{click:"click_inline_component",target:"ccm_doc_equation_edit_page_view",inline_type:"equation"})},f=function(e){if(e)return e.trim().split(/\s+/).map((function(e){return".".concat(e)})).join("")}},dx_PQBD:function(e,n,r){"use strict";(function(t){r.d(n,"A",(function(){return g})),r.d(n,"V",(function(){return y})),r.d(n,"LC",(function(){return m})),r.d(n,"b",(function(){return _})),r.d(n,"u",(function(){return O})),r.d(n,"L",(function(){return E})),r.d(n,"e",(function(){return S})),r.d(n,"R",(function(){return C})),r.d(n,"w",(function(){return I})),r.d(n,"Y",(function(){return B})),r.d(n,"i",(function(){return T})),r.d(n,"K",(function(){return w})),r.d(n,"f",(function(){return R})),r.d(n,"B",(function(){return M})),r.d(n,"o",(function(){return j}));var e=r("dx_o0o1"),o=r.n(e),i=(r("dx_RIqP"),r("dx_cDf5"),r("dx_lSNA")),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=(r("dx_QxNg"),r("dx_h6a8"),r("dx_bUYd")),u=r("dx_g0R0"),d=r("dx_B28d"),f=r("dx_ZG9w"),h=r("dx_zghO"),p=r("dx_XlRC"),v=r("dx_MoY1");function g(e,n,r,o){return b.apply(this,arguments)}function b(){return b=l()(o.a.mark((function e(n,r,i,c){var a,l,s,u,f,p,g,b,y=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=!(y.length>4&&void 0!==y[4])||y[4],s=!(y.length>5&&void 0!==y[5])||y[5],u=y.length>6?y[6]:void 0,f=n.getBlockModelByBlockId(c),p=null===(a=f.parent)||void 0===a?void 0:a.record.id){e.next=7;break}return e.abrupt("return");case 7:return g=l?f.position+1:f.position,e.next=10,n.applyTransaction("insertNewLine",(function(e){Object(v.l)(e,p,g,[n.createInitModel(d.B.TEXT)]),n.layoutManager.getReconciler().debouncePaint()}),{undoable:!u});case 10:if(b=f.parent.children[g].id,!s||!b){e.next=17;break}return e.next=14,n.layoutManager.renderNodeById(b);case 14:return e.next=16,i.scrollToBlock(b,(function(){return Promise.resolve()}));case 16:r.setSelection([{type:h.j.TEXT,id:b,selection:{start:0,end:0}}]);case 17:return e.abrupt("return",b);case 18:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}var y=function(e){var n="heading";return e&&e.includes(n)?Number(e.slice(n.length)):null};function m(e){return!(!e||e.type!==d.B.TEXT||!e.model.isEmpty)}function _(e,n){for(var r=e.getBlockModelByBlockId(n);r;){var o=r.parent;if(!o)return r.id;if(!d.h.includes(o.type)||o.type===d.B.PAGE)return r.id;r=r.parent}return r.id}var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789_-".split("");function O(e){var n=5381,r=e.length-1;if("string"===typeof e)for(;r>-1;r--)n+=(n<<5)+e.charCodeAt(r);else for(;r>-1;r--)n+=(n<<5)+e[r];var o=2147483647&n,i="";do{i+=k[63&o]}while(o>>=6);return i}var x=["reference"];function E(e){var n=e.op,r=e.blockId,o=e.blockManager,i=e.recursive,c=e.parentRecordId,a=o.getBlockModelByBlockId(r),l=o.getRecordByBlockId(r);if(i)for(var s=0,u=a.children.length;s<u;s++){var d=a.children[s],h=E({op:n,blockId:d.id,blockManager:o,recursive:!x.includes(d.record.snapshot.type),parentRecordId:c});l.snapshot.children[s]=h}Object(f.S)(l.snapshot)&&Object(f.fq)(l.snapshot.text,(function(e,r){var i=o.getRecord(r).snapshot;return Object(v.s)(n,c,i)}));var p=o.createInitModel(l.snapshot.type,l.snapshot);return Object(v.s)(n,c,p)}function S(e,n){var r=[];return e.forEach((function(e){var o=n.getBlockModelByBlockId(e);if(o){r.push(o);var i=o.children;if(i){var c=S(i.map((function(e){return e.id})),n);r=r.concat(c)}}})),r}function C(e,n,r){for(var o=Array.isArray(r)?r:[r],i=n.getBlockModelByBlockIdNotCheck(e);i&&i.parent;){if(o.includes(i.parent.record.snapshot.type))return!0;i=i.parent}return!1}function I(e){var n;return(n={},c()(n,d.B.HEADING1,"heading1"),c()(n,d.B.HEADING2,"heading2"),c()(n,d.B.HEADING3,"heading3"),c()(n,d.B.HEADING4,"heading4"),c()(n,d.B.HEADING5,"heading5"),c()(n,d.B.HEADING6,"heading6"),c()(n,d.B.HEADING7,"heading7"),c()(n,d.B.HEADING8,"heading8"),c()(n,d.B.HEADING9,"heading9"),c()(n,d.B.HEADINGN,"headingn"),c()(n,d.B.QUOTE,"quote"),c()(n,d.B.LINK,"link"),c()(n,d.B.IMAGE,t("sheet.smartable_attachment_field_default_name")),c()(n,d.B.BULLET,"bullet"),c()(n,d.B.ORDERED,"ordered"),c()(n,d.B.DIVIDER,"divider"),c()(n,d.B.CODE,"code"),c()(n,d.B.PAGE,"page"),c()(n,d.B.PLAYGROUND,"playground"),c()(n,d.B.REFERENCE,"reference"),c()(n,d.B.SELECTION,"selection"),c()(n,d.B.SNAPSHOT,"snapshot"),c()(n,d.B.TOPIC,"topic"),c()(n,d.B.TEXT,"text"),c()(n,d.B.GRID,"grid"),c()(n,d.B.GRID_COLUMN,"grid_column"),c()(n,d.B.CALLOUT,"callout"),c()(n,d.B.TODO,"todo"),c()(n,d.B.USER,"user"),c()(n,d.B.MENTION_DOC,"mention_doc"),c()(n,d.B.CHAT_CARD,t("common.chat")),c()(n,d.B.ASSOC_ROOT,"assoc_root"),c()(n,d.B.ASSOC_NODE,"assoc_node"),c()(n,d.B.DIAGRAM,"diagram"),c()(n,d.B.TABLE,"table"),c()(n,d.B.CELL,"table_cell"),c()(n,d.B.IFRAME,"iframe"),c()(n,d.B.SHEET,t("common.sheet")),c()(n,d.B.BITABLE,t("common.bitable")),c()(n,d.B.FILE,t("CreationDoc_DocX_Menu_Insert_video_option")),c()(n,d.B.UML,"uml"),c()(n,d.B.FLOWCHART,"flowchart"),c()(n,d.B.VIEW,"view"),c()(n,d.B.REMINDER,"reminder"),c()(n,d.B.MINDMAP,t("mindnote.block_menu_item_name")),n)[e]}function B(e){var n=function(e){var n=e;switch(e.type){case d.B.FILE:return e.file;case d.B.IMAGE:return e.image;case d.B.CHAT_CARD:return{token:e.chat_token,status:n.status};default:return n}}(e);return(null===n||void 0===n?void 0:n.status)===d.UY.CLONE_FAILED}function T(e,n,r){for(var o=e.getBlockModelByBlockId(n);o&&o.type!==r;){var i=o.parent;o=i||null}return o}function w(e,n,r,o){e.hasBlockModelByBlockId(n)&&e.applyTransaction("thirdPartyPasteError",(function(r){if(n){var o=e.getBlockModelByBlockId(n);r.removeChildren(o.parent.recordId,[o.recordId])}}));var i=new Error(r),c=o?Object(u.G)(o,i):Object(u.G)(i);Object(s.h)({content:r,errorContext:c})}function R(e,n){for(var r=n.getBlockModelByBlockId(e),o=r.parent,i=r.position,c=r;o;){if(n.getBlockViewByBlockId(o.id).type!==d.B.VIEW)break;c=o,i=o.position,o=o.parent}return{parent:o,position:i,target:c}}function M(e,n){var r=e.type;if(n===d.B.ORDERED){var o=Object(p.o)(e),i=d.O.includes(r);return r===n||i&&Object(p.a)(o)}return r===n}function j(e,n){for(var r=!1,o=n;o;){if(o.type===e){r=!0;break}o=o.parent}return r}}).call(this,r("dx_E9Eu"))},dx_PRjj:function(e,n,r){"use strict";r.d(n,"P",(function(){return R})),r.d(n,"D",(function(){return M})),r.d(n,"v",(function(){return j}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_o0o1"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_W7W2"),v=r.n(p),g=r("dx_a1gu"),b=r.n(g),y=r("dx_Nsbk"),m=r.n(y),_=r("dx_Nv7e"),k=r("dx_rQGm"),O=r("dx_yzqx"),x=r("dx_B28d"),E=r("dx_kZ3l"),S=r("dx_KTtu"),C=r("dx_lROi"),I=r("dx_Dw4b"),B=r("dx_m0BX");function T(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var w=O.S.isMobile?0:k.mM,R=function(e){v()(r,e);var n=T(r);function r(e){var o;return d()(this,r),(o=n.call(this,e)).range=void 0,o.type=S.V.TextBlock,o.range=e.range,o}return h()(r,[{key:"replaceWith",value:function(){var e=s()(a.a.mark((function e(n){var r,o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isReplaceable){e.next=2;break}return e.abrupt("return");case 2:return r=this.currentBlockModel,this.range[1]-this.range[0]<=0&&console.error("[Replace] illegal range: ".concat(this.range)),o=E.JI(r.zoneState,[this.range[0],this.range[0]+1]),i=r.getAttributes(o.start,o.end).toMap(),e.next=8,r.replaceText(this.range,{text:n,mark:i});case 8:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"scrollIntoView",value:function(e,n,r,o){var c=this,l=this.blockId,u=n.getRecordByBlockId(this.blockId).id;return e.scrollToRecord(u,s()(a.a.mark((function e(){var s,u,d,f,h,p,v,g,b,y,m,k,O,E;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=i()(c.range,2),u=s[0],d=s[1],f=r.getCaretRect(l,u,l,!0),h=r.getCaretRect(l,d,l,!1),p=r.getBlockRect(l).top+Object(_.F)(n)+w,v=p+f.top,g=p+h.bottom,b={startTop:v,endBottom:g,scrollContainer:o},y=n.getBlockModelByBlockId(c.blockId),(m=y.record.snapshot).type!==x.B.CODE||m.wrap||(k=n.getBlockViewByBlockId(c.blockId),O=k.hostElement,(E=O.querySelector(".editor-kit-container"))&&(b.left=f.left,b.right=h.right,b.horizonScrollContainer=E)),Object(B.E)(b);case 10:case"end":return e.stop()}}),e)}))))}},{key:"isReplaceable",get:function(){return!0}}]),r}(I.S),M=function(e){v()(r,e);var n=T(r);function r(e){var o;return d()(this,r),(o=n.call(this,e)).contentOffset=void 0,o.type=S.V.TextEmbedBlock,o.contentOffset=e.offset,o}return h()(r,[{key:"scrollIntoView",value:function(e,n,r,o){var i=this,c=this.blockId,l=n.getRecordByBlockId(this.blockId).id;return e.scrollToRecord(l,s()(a.a.mark((function e(){var l,s,u,d,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=i.blockManager.getBlockViewByBlockId(c),s=Object(C.C)({block:l,rect:r,range:i.range,offset:i.contentOffset}),u=r.getBlockRect(c).top+Object(_.F)(n)+w,d=u+s.top,f=u+s.bottom,Object(B.E)({startTop:d,endBottom:f,scrollContainer:o});case 6:case"end":return e.stop()}}),e)}))))}},{key:"isReplaceable",get:function(){return!1}}]),r}(R),j=function(e){v()(r,e);var n=T(r);function r(){return d()(this,r),n.apply(this,arguments)}return h()(r,[{key:"isReplaceable",get:function(){return!1}}]),r}(R)},dx_PVfG:function(e,n,r){},dx_Pa9M:function(e,n,r){"use strict";r.d(n,"t",(function(){return o})),r.d(n,"R",(function(){return i})),r.d(n,"J",(function(){return a}));var o,i,c=r("dx_B28d");!function(e){e.FORCE_UPDATE="FORCE_UPDATE"}(o||(o={})),function(e){e.UP="UP",e.DOWN="DOWN"}(i||(i={}));var a=[c.B.PAGE,c.B.CALLOUT,c.B.TABLE,c.B.CELL,c.B.OBJECTIVE,c.B.KEY_RESULT,c.B.PROGRESS]},dx_PciH:function(e,n,r){"use strict";r.d(n,"L",(function(){return v}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_O1Ou");function h(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}var p=function(){function e(n,r,o){var i=this;s()(this,e),this.action=n,this.vcController=r,this.dataGetter=o,this.targetLen=1,this.result=[],this.reported=!1,this.raceTimer=void 0,this.startTimeStamp=Date.now(),this.isSomeBlocksInViewportNotReport=function(){var e=i.vcController.blockManager;if(!e)return i.result.length<i.targetLen;var n=e.layoutManager.getViewportBlocks();return Object.keys(i.dataGetter(i.action)).some((function(r){var o=e.getBlockIdsByRecordId(r),c=a()(o,1)[0];return!!c&&(!!n.includes(c)&&!i.result.find((function(e){return e.recordId===r})))}))};var c=this.dataGetter(n);this.targetLen=Object.keys(c).length,this.startRace()}return d()(e,[{key:"report",value:function(e,n){this.reported&&console.info("debug: ShareActionReporter report after destroyed"),this.result.push(function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?h(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({type:e},n)),this.detect()}},{key:"forceDetect",value:function(e){this.detect(!0,e)}},{key:"detect",value:function(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1?arguments[1]:void 0;if(this.reported)return this.reset();var o=this.isSomeBlocksInViewportNotReport();if(n||!o){this.stopRace();var c=this.result.reduce((function(e,n){return e[n.type].push(n),e}),(e={},i()(e,f.s.SUCCESS,[]),i()(e,f.s.FAIL,[]),i()(e,f.s.IGNORE,[]),e)),a=this.action.uuid;if(c[f.s.FAIL].length){var l=c[f.s.FAIL];return this.vcController.reportReplay(f.s.FAIL,a,this.getReportInfo(l),this.getMaxTimestamp(l)),this.reset()}if(o&&(!r||Date.now()-this.startTimeStamp>3e3))return this.vcController.reportReplay(f.s.FAIL,a,"shareReporter: Some block in viewport not report",Date.now()),this.reset();if(c[f.s.IGNORE].length===this.result.length||r){var s=c[f.s.IGNORE];return this.vcController.reportReplay(f.s.IGNORE,a,r||this.getReportInfo(s),this.getMaxTimestamp(s)),this.reset()}var u=c[f.s.SUCCESS];this.vcController.reportReplay(f.s.SUCCESS,a,this.getMaxTimestamp(u)),this.reset()}}},{key:"getMaxTimestamp",value:function(e){var n=e.filter((function(e){return e.timestamp}));if(!n.length)return Date.now();var r=Math.max.apply(null,n.map((function(e){return e.timestamp})));return Number.isNaN(r)?Date.now():r}},{key:"getReportInfo",value:function(e){return e.length&&e[e.length-1].info||"shareReporter default info"}},{key:"startRace",value:function(){var e=this;this.raceTimer=setTimeout((function(){e.forceDetect()}),15e3)}},{key:"stopRace",value:function(){this.raceTimer&&clearTimeout(this.raceTimer),this.raceTimer=void 0}},{key:"reset",value:function(){this.reported=!0,this.stopRace()}}]),e}(),v=new(function(){function e(){s()(this,e),this.map=new Map,this.actionToUUidMap=new Map}return d()(e,[{key:"get",value:function(e,n,r){var o=e.uuid;if(this.map.has(o))return this.map.get(o);var i=this.actionToUUidMap.get(e.actionType);if(i){var c=this.map.get(i);null===c||void 0===c||c.forceDetect("next action arrive"),this.map.delete(i)}this.actionToUUidMap.set(e.actionType,o);var a=new p(e,n,r);return this.map.set(o,a),a}},{key:"has",value:function(e){return this.map.has(e.uuid)}}]),e}())},dx_Pgxt:function(e,n,r){"use strict";(function(t){r.d(n,"u",(function(){return F}));var e,o,i,c,a,l=r("dx_lSNA"),s=r.n(l),u=r("dx_RIqP"),d=r.n(u),f=r("dx_yG8O"),h=r.n(f),p=r("dx_lwsE"),v=r.n(p),g=r("dx_W8MJ"),b=r.n(g),y=r("dx_Uyc2"),m=r.n(y),_=(r("dx_A1AB"),r("dx_xjz2")),k=r("dx_h6a8"),O=r("dx_yzqx"),x=r("dx_ukKW"),E=r("dx_b28D"),S=r("dx_B28d"),C=r("dx_F5s4"),I=r("dx_dOu9"),B=r("dx_mYvZ"),T=r("dx_x1WV"),w=r("dx_hSCS"),R=r("dx_EqZO"),M=r("dx_D8nn"),j=r("dx_P55d"),D=r("dx_d6al"),A=r("dx_k8kI");function P(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function L(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?P(Object(r),!0).forEach((function(n){s()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var N=Object(E.e)("imageManager"),F=Object(_.s)(I.Y)((a=function(){function e(){var n=this;v()(this,e),this.collectorManager=new C.U,this.externalSaver=new B.S(this.collectorManager),this.handleLayoutPaint=Object(k.debounce)((function(){var e=n.getImageBlocks(),r=e.imageBlocksInViewportAndBuffer,o=e.imageBlocksInViewport,i=e.imageBlocksNotInViewport;r.forEach((function(e){e.loadImage(),N("======loadImage",e)})),o.forEach((function(e){Object(x.s)(e.model.snapshot.image.mimeType)&&e.showOriginalGif()})),i.forEach((function(e){Object(x.s)(e.model.snapshot.image.mimeType)&&e.showCoverGif()}))}),100),h()(this,"blockManager",i,this),this.imageFetcher=new j.S,this.imageInfoMap=new Map,this.deleteTaskMap=new Map,this.gifCoverUrlCacheMap=new Map,h()(this,"eventEmitter",c,this),this.objUrlList=new Map,this.isOnline=!0,this.handleUpdateOnlineStatus=function(){var e=navigator.onLine;e!==n.isOnline&&(n.isOnline=e,n.getImageBlocks().allImageBlocks.forEach((function(n){return n.updateOnlineStatus(e)})))},this.handleBeforeunload=function(e){if(n.getImageBlocks().allImageBlocks.some((function(e){return e.isUploading}))){var r=t("editor.leave_page_warning_message");return e.returnValue=r}},this.onOrientationChange=function(){n.getImageBlocks().allImageBlocks.forEach((function(e){return e.onOrientationChange()}))}}return b()(e,[{key:"getImageBlocks",value:function(){var e=this,n=this.blockManager.layoutManager.getBufferBlocks(),r=this.blockManager.layoutManager.getViewportBlocks(),o=[].concat(d()(n),d()(r)),i=this.getBlocksFromIds(o).filter((function(e){return e.type===S.B.IMAGE})),c=i.filter((function(e){return r.includes(e.id)})),a=this.getBlocksFromIds(d()(this.imageInfoMap.keys()).map((function(n){return e.blockManager.getBlockIdsByRecordId(n)[0]}))).filter((function(e){return!r.includes(e.id)}));return{imageBlocksInViewportAndBuffer:i,imageBlocksInViewport:c,imageBlocksNotInViewport:a,allImageBlocks:[].concat(d()(c),d()(a))}}},{key:"init",value:function(){this.blockManager.addListener(A.w2,this.handleLayoutPaint),this.eventEmitter.on(R.R.CLIENTVAR_SLICE_RESPONSE,this.genPreloadImageInfo.bind(this)),window.addEventListener("online",this.handleUpdateOnlineStatus),window.addEventListener("offline",this.handleUpdateOnlineStatus),window.addEventListener("orientationchange",this.onOrientationChange),O.S.isMobile||window.addEventListener("beforeunload",this.handleBeforeunload)}},{key:"genPreloadImageInfo",value:function(e){var n=e.clientvar,r=Object.values(n.block_map).filter((function(e){var n=e.id;return e.data.type===S.B.IMAGE&&!Object(D.Q)(n)})).map((function(e){var n=e.id,r=e.data.image,o=r.token,i=r.width,c=r.height,a=r.mimeType,l=r.scale,s=r.size;return{uuid:n,token:o,isHD:Object(x.s)(a)&&!Object(x.Vb)({mimeType:a,size:s})||Object(x.w)(i,c),width:i,height:c,scale:l}}));this.imageFetcher.fetchCdnInfos(r)}},{key:"destroy",value:function(){window.removeEventListener("online",this.handleUpdateOnlineStatus),window.removeEventListener("offline",this.handleUpdateOnlineStatus),window.removeEventListener("orientationchange",this.onOrientationChange),O.S.isMobile||window.removeEventListener("beforeunload",this.handleBeforeunload),this.deleteTaskMap.clear(),this.imageFetcher.destroy(),this.imageInfoMap.clear(),this.gifCoverUrlCacheMap.forEach((function(e){e&&URL.revokeObjectURL(e)})),this.gifCoverUrlCacheMap.clear(),this.collectorManager.destroy(),this.externalSaver.destroy(),this.handleLayoutPaint.cancel(),this.blockManager.removeListener(A.w2,this.handleLayoutPaint)}},{key:"setGifCoverUrlCache",value:function(e,n){this.gifCoverUrlCacheMap.set(e,n)}},{key:"getGifCoverUrlCache",value:function(e){return this.gifCoverUrlCacheMap.get(e)}},{key:"deleteGifCoverUrlCache",value:function(e){return this.gifCoverUrlCacheMap.delete(e)}},{key:"getImageInfo",value:function(e){return this.imageInfoMap.get(e)||{url:"",isHD:!1}}},{key:"fetch",value:function(e,n,r,o){return this.imageFetcher.fetch(e,n,r,o)}},{key:"add",value:function(e,n){var r=this.deleteTaskMap.get(e);return r?(clearTimeout(r),r=null,this.deleteTaskMap.delete(e),this.imageInfoMap.get(e)):(this.imageInfoMap.set(e,n),null)}},{key:"update",value:function(e,n){var r=this.getImageInfo(e);this.imageInfoMap.set(e,L(L({},r),n))}},{key:"delete",value:function(e,n,r){var o=this,i=setTimeout((function(){o.performDeleteTask(e,n,r),i=null,o.deleteTaskMap.delete(n)}),3e3);this.deleteTaskMap.set(n,i)}},{key:"performDeleteTask",value:function(e,n,r){this.externalSaver.stopTask(n),this.imageInfoMap.delete(n),this.collectorManager.delete(r),this.gifCoverUrlCacheMap.delete(n),this.imageFetcher.delete(e,n);var o=this.objUrlList.get(n);o&&URL.revokeObjectURL(o),this.objUrlList.delete(n),O.S.isMobile&&M.S.emit(M.p.MOBILE.IMAGE.DELETE_IMAGE,n)}},{key:"getBlocksFromIds",value:function(e){var n=this,r=[];return e.forEach((function(e){try{var o=n.blockManager.getBlockViewByBlockId(e);r.push(o)}catch(i){return}})),r}}]),e}(),o=a,i=m()(o.prototype,"blockManager",[T.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=m()(o.prototype,"eventEmitter",[w.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e=o))||e}).call(this,r("dx_E9Eu"))},dx_Ph9x:function(e,n,r){"use strict";r.d(n,"P",(function(){return s}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_qHgq"),s=function(){function e(n){i()(this,e),this.context=n}return a()(e,[{key:"setup",value:function(){this.onBeforeStart&&this.context.on(l.j.beforeStart,this.onBeforeStart),this.onContextmenu&&this.context.on(l.j.contextmenu,this.onContextmenu),this.context.on(l.j.start,this.onStart),this.onMove&&this.context.on(l.j.move,this.onMove),this.context.on(l.j.stop,this.onStop),this.onBrowserSelectionChange&&this.context.on(l.j.browserSelectionChange,this.onBrowserSelectionChange)}},{key:"destroy",value:function(){this.onBeforeStart&&this.context.off(l.j.beforeStart,this.onBeforeStart),this.onContextmenu&&this.context.off(l.j.contextmenu,this.onContextmenu),this.context.off(l.j.start,this.onStart),this.onMove&&this.context.off(l.j.move,this.onMove),this.context.off(l.j.stop,this.onStop),this.onBrowserSelectionChange&&this.context.off(l.j.browserSelectionChange,this.onBrowserSelectionChange)}}]),e}()},dx_PhLz:function(e,n,r){"use strict";r.d(n,"E",(function(){return a})),r.d(n,"q",(function(){return l}));var o=r("dx_fEKD"),i=r("dx_B28d"),c=r("dx_c7yg");function a(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.B.FILE;return Object(o.b)(e,n)}function l(e,n){var r=e.size,o=e.mime_type,i=e.name,l=e.token,s=e.status,u={token:n?l:c.v,mimeType:o,size:r,name:i};return void 0!==s&&(u.status=s),a({file:u},c.O)}},dx_PiBr:function(e,n,r){"use strict";var o=r("dx_lwLI");r.d(n,"F",(function(){return o.F}));var i=r("dx_c5KA");r.d(n,"R",(function(){return i.R}))},dx_Pk2m:function(e,n,r){},dx_PtCP:function(e,n,r){"use strict";r.d(n,"w",(function(){return u}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_k2kP"),s=r("dx_eSV8");function u(e,n,r){return d.apply(this,arguments)}function d(){return(d=a()(i.a.mark((function e(n,r,o){var c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(l.generateTagOptionsByType)({token:n,version:o,resourceType:"DOCX_POLL"}),e.next=3,l.default.register(c,r);case 3:return console.log("[POLL]: register msg box"),e.next=6,l.default.onError(c,(function(e){console.error("[MessageBoxError]:",e),Object(s.n)(e)}));case 6:return e.abrupt("return",(function(){return f(n,r)}));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e,n){return h.apply(this,arguments)}function h(){return(h=a()(i.a.mark((function e(n,r){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Object(l.generateTagOptionsByType)({token:n,resourceType:"DOCX_POLL"}),console.log("[POLL]: deregister msg box"),e.next=4,l.default.deregister(o,r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},dx_PtL9:function(e,n,r){var o={"./de-DE.js":["dx_XF1r","dx_wT7I"],"./en-US.js":["dx_KKa9","dx_PFQC"],"./es-ES.js":["dx_yMO0","dx_OMsI"],"./fr-FR.js":["dx_E45E","dx_VLX0"],"./hi-IN.js":["dx_QDdZ","dx_Ni8w"],"./id-ID.js":["dx_zw5z","dx_wsWk"],"./it-IT.js":["dx_UPCh","dx_otrh"],"./ja-JP.js":["dx_FYNv","dx_XQmv"],"./ko-KR.js":["dx_cea7","dx_E9tM"],"./pt-BR.js":["dx_R6V1","dx_RpzY"],"./ru-RU.js":["dx_acQc","dx_fpi8"],"./th-TH.js":["dx_RS8r","dx_gVY9"],"./vi-VN.js":["dx_QFGm","dx_C39P"],"./zh-CN.js":["dx_KiGe","dx_Dm60"],"./zh-HK.js":["dx_VXff","dx_wLGn"],"./zh-TW.js":["dx_UnCx","dx_cQoW"]};function i(e){if(!r.o(o,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=o[e],i=n[0];return r.e(n[1]).then((function(){return r(i)}))}i.keys=function(){return Object.keys(o)},i.id="dx_PtL9",e.exports=i},dx_Py0N:function(e,n,r){"use strict";r.d(n,"R",(function(){return B}));var o,i=r("dx_lwsE"),c=r.n(i),a=r("dx_W8MJ"),l=r.n(a),s=r("dx_W7W2"),u=r.n(s),d=r("dx_a1gu"),f=r.n(d),h=r("dx_Nsbk"),p=r.n(h),v=r("dx_lSNA"),g=r.n(v),b=r("dx_BkdS"),y=r("dx_TSYQ"),m=r.n(y),_=r("dx_O8UM"),k=r("dx_DXiY"),O=r("dx_l8lP"),x=r("dx_Lqhf");r("dx_iZpP");function E(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function S(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?E(Object(r),!0).forEach((function(n){g()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function C(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=p()(e);if(n){var i=p()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return f()(this,r)}}var I=(o={},g()(o,"".concat(Object(_.P)(x.D.Text).get(O.j.COLOR_PINK_TEXT)),"R600"),g()(o,"".concat(Object(_.P)(x.D.Text).get(O.j.COLOR_ORANGE_TEXT)),"O600"),g()(o,"".concat(Object(_.P)(x.D.Text).get(O.j.COLOR_YELLOW_TEXT)),"Y600"),g()(o,"".concat(Object(_.P)(x.D.Text).get(O.j.COLOR_GREEN_TEXT)),"G600"),g()(o,"".concat(Object(_.P)(x.D.Text).get(O.j.COLOR_BLUE_TEXT)),"B600"),g()(o,"".concat(Object(_.P)(x.D.Text).get(O.j.COLOR_PURPLE_TEXT)),"P600"),g()(o,"".concat(Object(_.P)(x.D.Text).get(O.j.COLOR_GRAY_TEXT)),"N500"),o),B=function(e){u()(r,e);var n=C(r);function r(e){return c()(this,r),n.call(this,S(S({},e),{},{customizedAttributeKey:r.KEY}))}return l()(r,[{key:"render",value:function(e){var n=e.children,o=e.attributes[r.KEY],i=I[o],c=Object(k.r)(x.D.Text,o),a="textHighlight";return c&&(a="".concat(a," textHighlight-").concat(c)),i&&(a="".concat(a," textHighlight-").concat(i)),e.class=m()(e.class,a),n}}]),r}(b.G);B.KEY="textHighlight"},dx_Py6Q:function(e,n,r){"use strict";r.d(n,"C",(function(){return a}));var o=r("dx_aRuT"),i=r("dx_JFYx"),c=r("dx_l8lP"),a=[c.j.COLOR_DEFAULT_TEXT,c.j.COLOR_DEFAULT_BACKGROUND,i.T.Default,i.P.Default,i.b.Default,o.u.COLOR_DEFAULT_TEXT,o.u.COLOR_DEFAULT_BACKGROUND]},dx_Pz0G:function(e,n,r){"use strict";r.d(n,"S",(function(){return s}));var o=r("dx_TSYQ"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c),l=r("dx_B28d");r("dx_KHsp");function s(e){if(e&&e.displayMode===l.J.INLINE)return a.a.createElement("div",{className:i()("docx-block-loading docx-block-loading-inline",e.className)},a.a.createElement("div",{className:"inline-mode"},a.a.createElement("div",{className:"docx-block-inline-placeholder-expand"})),e.children);var n=i()("docx-block-loading",{"align-center":e.align===l.D.CENTER||void 0===e.align,"align-left":e.align===l.D.LEFT,"align-right":e.align===l.D.RIGHT},e.className),r=e.loadingIconScale;return a.a.createElement("div",{className:n,style:e.style},a.a.createElement("div",{className:"docx-block-mode"},a.a.createElement("div",{className:"docx-block-spin",style:{transform:"scale(".concat(.225*(r||1),") translate3d(0, 0, 0) rotate(-90deg)")}},a.a.createElement("span",{className:"rectangle-1"},a.a.createElement("span",null)),a.a.createElement("span",{className:"circle"}),a.a.createElement("span",{className:"rectangle-2"},a.a.createElement("span",null))),e.children))}},dx_Q4WO:function(e,n,r){"use strict";r.d(n,"B",(function(){return O})),r.d(n,"b",(function(){return E})),r.d(n,"j",(function(){return S})),r.d(n,"E",(function(){return I})),r.d(n,"Bd",(function(){return B})),r.d(n,"bi",(function(){return T})),r.d(n,"l",(function(){return w})),r.d(n,"U",(function(){return R})),r.d(n,"o",(function(){return M}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_o0o1"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_RIqP"),d=r.n(u),f=r("dx_h6a8"),h=r("dx_PQBD"),p=r("dx_BrJR"),v=r("dx_B28d"),g=r("dx_xFJs"),b=r("dx_n8nr"),y=r("dx_QBqw"),m=r("dx_F0F4");function _(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return k(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function k(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var O=function(e,n,r){var o=e.record.snapshot,i=o.folded,c=o.type;return i&&c.includes("heading")?r.findFoldedBlocks(e.id).reduce((function(e,r){if(!n.hasBlockViewByBlockId(r))return e;var o=n.getBlockViewByBlockId(r);return v.B.GRID===o.type?e.push.apply(e,d()(function(e,n){var r=n.getBlockModelByBlockId(e.id);return Object(f.flattenDeep)(r.children.map((function(e){return e.children.map((function(e){return n.getBlockViewByBlockId(e.id)}))})))}(o,n))):e.push(o),e}),[e]):[e]},x=function(){var e=s()(a.a.mark((function e(n,r){var o,i,c,l,s,u,d,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=r.getBlockModelByBlockId(n.id),i=[],c=_(o.children),e.prev=3,c.s();case 5:if((l=c.n()).done){e.next=27;break}s=l.value,u=_(s.children),e.prev=8,u.s();case 10:if((d=u.n()).done){e.next=17;break}return f=d.value,e.next=14,r.layoutManager.renderNodeById(f.id);case 14:i.push(r.getBlockViewByBlockId(f.id));case 15:e.next=10;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(8),u.e(e.t0);case 22:return e.prev=22,u.f(),e.finish(22);case 25:e.next=5;break;case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(3),c.e(e.t1);case 32:return e.prev=32,c.f(),e.finish(32);case 35:return e.abrupt("return",i);case 36:case"end":return e.stop()}}),e,null,[[3,29,32,35],[8,19,22,25]])})));return function(n,r){return e.apply(this,arguments)}}(),E=function(){var e=s()(a.a.mark((function e(n,r,o,i){var c,l,s,u,f,h,p,v;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=[],(l=Array.isArray(n)?n:[n]).forEach((function(e){var n=e.record.snapshot,r=n.folded,i=n.type;r&&i.includes("heading")&&(c=c.concat(o.findFoldedBlocks(e.id)))})),!(c.length<1)){e.next=6;break}return null===i||void 0===i||i(l),e.abrupt("return");case 6:s=[],u=_(c),e.prev=8,u.s();case 10:if((f=u.n()).done){e.next=19;break}if(h=f.value,r.hasBlockViewByBlockId(h)){e.next=15;break}return e.next=15,r.layoutManager.renderNodeById(h);case 15:(p=r.getBlockViewByBlockId(h))instanceof b.S?s.push(x(p,r)):s.push(Promise.resolve([p]));case 17:e.next=10;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(8),u.e(e.t0);case 24:return e.prev=24,u.f(),e.finish(24);case 27:return e.next=29,Promise.all(s);case 29:v=e.sent,null===i||void 0===i||i(v.reduce((function(e,n){return e.push.apply(e,d()(n)),e}),l));case 31:case"end":return e.stop()}}),e,null,[[8,21,24,27]])})));return function(n,r,o,i){return e.apply(this,arguments)}}();function S(e,n){return e&&e.parentId?[Object(p.w)(e,n,!0),Object(p.w)(e,n,!1)]:[!1,!1]}function C(e,n){if(!e||!e.props.cellInfo)return!1;var r=e.props.cellInfo.cellId;if(!r)return!1;var o=e.props.parentId;if(!o)return!1;var c=n.getRecordByBlockId(o);if(!c)return!1;var a=c.snapshot.columns_id,l=Object(y.j)(r);return i()(l,2)[1]===a[0]}function I(e,n){var r;if(!e||!e.parentId)return!1;var o=function(e,n){var r=n.getBlockModelByBlockId(e);return[v.B.VIEW,v.B.QUOTE_CONTAINER].includes(r.type)&&(r=r.parent),r}(e.parentId,n);return(null===(r=n.getRecordByBlockId(o.id))||void 0===r?void 0:r.snapshot.type)===v.B.CELL&&C(n.getBlockViewByBlockId(o.id),n)}function B(e,n){var r=Object(h.R)(e,n,v.B.GRID_COLUMN),o=Object(g.M)(e,n);return!(!r||!o)&&!o.gridColumnBlock.previousSibling}function T(e,n){if(!e||!e.parentId)return m.b.None;var r=e.parentId,o=n.getBlockModelByBlockId(r);if(o.type===v.B.GRID_COLUMN){var i=n.getBlockModelByBlockId(r).parent,c=n.getBlockViewByBlockId(i.id),a=i.parent.id,l=C(n.getBlockViewByBlockId(a),n),s=c.hostElement.querySelectorAll(".grid-vertical").length,u=o.id,d=i.children[0].id;return s||u===d?l?m.b.FirstGridColumn:m.b.None:m.b.NormalGridColumn}return m.b.None}function w(e){return!(!e||!e.model.parent)&&e.model.parent.type===v.B.QUOTE_CONTAINER}function R(e){var n=e.block,r=e.parent,o=e.blockManager;if(!r||!n)return!1;for(var i=o.getBlockModelByBlockIdNotCheck(n.id);i;){if(i.id===r.id)return!0;i=i.parent}return!1}function M(e,n){var r=e.orgX,o=e.orgY,i=e.dirX,c=e.dirY,a=n.minX,l=n.minY,s=n.maxX,u=n.maxY;return(0===i||i>0&&r+i<=s||i<0&&r+i>=a)&&(0===c||c>0&&o+c<=u||c<0&&o+c>=l)}},dx_Q5XO:function(e,n,r){"use strict";function o(e){return e.docx.editable.editing}r.d(n,"R",(function(){return o}))},dx_Q64Q:function(e,n,r){"use strict";r.d(n,"q",(function(){return m})),r.d(n,"e",(function(){return k})),r.d(n,"R",(function(){return x}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_M30o"),a=r("dx_alfx"),l=r("dx_h6a8"),s=r("dx_C7Cb"),u=r("dx_xlCA"),d=r("dx_XfTi");function f(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function h(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?f(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function p(e,n){var r=Object(l.get)(n,d.G),o=Object(l.map)(r.ops,(function(n){var r=function(e,n){var r;return Object(l.forEach)(Object(l.castArray)(n),(function(n){if(n.match(e))return r=n,!1})),r}(n.attributes,e);return r?r.formatter(n):n}));return h(h({},n),{},i()({},d.G,h(h({},n[d.G]),{},{ops:o})))}function v(e){return Object(l.curry)(p)(e)}var g=r("dx_w0wQ");function b(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function y(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?b(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var m=function(e){return Object(a.P)(new c.q(e),{filterInitialAttributedText:!0})},_=v([{match:function(e){var n=Object(l.get)(e,"dataMetaBlockProps");if(n){var r=Object(g.K)(n);if("mentionBlock"===Object(l.get)(r,"blockType"))return!0}return!1},formatter:function(e){var n=Object(l.get)(e,"attributes.dataMetaBlockProps");if(n){var r=Object(g.K)(n),o={type:"mention_doc",id:Object(l.get)(r,"blockId",""),data:{file_type:Object(l.get)(r,"props.type"),raw_url:decodeURIComponent(Object(l.get)(r,"props.url")||Object(l.get)(r,"props.link","")),tenant_id:"",title:Object(l.get)(r,"props.title",""),token:Object(l.get)(r,"props.token","")}};return y(y({},e),{},{attributes:{author:"","inline-component":JSON.stringify(o)}})}return e}},{match:function(e){var n=Object(l.get)(e,"dataMetaBlockProps");if(n){var r=Object(g.K)(n);if("AT_USER_BLOCK"===Object(l.get)(r,"blockType"))return!0}return!1},formatter:function(e){var n=Object(l.get)(e,"attributes.dataMetaBlockProps");if(n){var r=Object(g.K)(n),o={type:"user",id:Object(l.get)(r,"blockId",""),data:{uid:Object(l.get)(r,"props.data.user.id",""),cn_name:Object(l.get)(r,"props.data.user.cn_name",""),en_name:Object(l.get)(r,"props.data.user.en_name","")}};return y(y({},e),{},{attributes:{author:"","inline-component":JSON.stringify(o)}})}return e}},{match:function(e){return Object(l.has)(e,"hyperlink")},formatter:function(e){if(Object(l.get)(e,"attributes.hyperlink")){var n={author:"","link-id":Object(s.S)()};return y(y({},e),{},{attributes:n})}return e}},{match:function(e){return"1"===Object(l.get)(e,"lmkr")},formatter:function(e){return y(y({},e),{},{insert:""})}},{match:function(){return!0},formatter:function(e){return y(y({},e),{},{attributes:{author:""}})}}]),k=Object(l.flow)([_,function(e){return y(y({},e),{},i()({},d.G,y(y({},e[d.G]),{},{ops:Object(l.map)(e[d.G].ops,(function(n,r){if(r===Object(l.size)(e[d.G].ops)-1){var o=n.insert;if(o&&Object(l.isString)(o))return y(y({},n),{},{insert:o.replace(/\n$/,"")})}return n}))})))}]),O=v([{match:function(e){var n=Object(l.get)(e,"inline-component");if(n){var r=Object(g.K)(n);if("mention_doc"===Object(l.get)(r,"type"))return!0}return!1},formatter:function(e){var n=Object(l.get)(e,"attributes.inline-component");if(n){var r=Object(g.K)(n);return y(y({},e),{},{insert:Object(l.get)(r,"data.title","")})}return e}},{match:function(e){var n=Object(l.get)(e,"inline-component");if(n){var r=Object(g.K)(n);if("user"===Object(l.get)(r,"type"))return!0}return!1},formatter:function(e){var n=Object(l.get)(e,"attributes.inline-component");if(n){var r=Object(g.K)(n),o=Object(l.get)(r,"data.uid",""),i=u.n.getCache(o),c="";return c=i?Object(g.I)({zhText:i.name,enText:i.en_name||""}):Object(g.I)({zhText:Object(l.get)(r,"data.cn_name",""),enText:Object(l.get)(r,"data.en_name","")}),y(y({},e),{},{insert:"@".concat(c)})}return e}}]);function x(e){var n=function(e){return Object(a.Z)(e.initialAttributedTexts,e.apool).deltas}(e),r=O(n);return Object(l.join)(Object(l.map)(r[d.G].ops,(function(e){return e.insert||""})),"")}},dx_Q8xN:function(e,n,r){},dx_Q9QG:function(e,n,r){"use strict";r.d(n,"S",(function(){return d}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_B28d"),a=r("dx_vOIB"),l=r("dx_HX5J");function s(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return u(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function u(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var d=function(){var e,n,r=(e={},i()(e,c.B.ORDERED,{stringify:function(e,n,r,o){var i=o.orderMap.get(n.record.id)||"1",c=Object(a.q)(r)||1;return"".concat(Object(l.Q)(2*(c-1))).concat(i,". ").concat(e)}}),i()(e,c.B.BULLET,{stringify:function(e,n,r){var o=Object(a.q)(r)||1;return"".concat(Object(l.Q)(2*(o-1)),"- ").concat(e)}}),i()(e,c.B.TODO,{stringify:function(e,n,r){var o=Object(a.q)(r)||1,i=n.record.snapshot.done;return"".concat(Object(l.Q)(2*(o-1)),"[").concat(i?"x":"","] ").concat(e)}}),i()(e,c.B.TEXT,{stringify:function(e,n,r){var o=Object(a.q)(r)||1;return Object(l.Q)(2*(o-1))+e}}),e),o={stringify:function(e,n,r,o,i){if(i&&r.record.snapshot.seq){var c=i.getOrderText(r.record.id);return"".concat(c," ").concat(e)}return e}},u=s(c.O);try{for(u.s();!(n=u.n()).done;){r[n.value]=o}}catch(d){u.e(d)}finally{u.f()}return r}()},dx_QBF8:function(e,n,r){"use strict";r.d(n,"y",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("client-var-cache")},dx_QBqw:function(e,n,r){"use strict";r.d(n,"c",(function(){return x})),r.d(n,"E6",(function(){return E})),r.d(n,"H",(function(){return S})),r.d(n,"b",(function(){return C})),r.d(n,"f",(function(){return I})),r.d(n,"b0",(function(){return B})),r.d(n,"B",(function(){return T})),r.d(n,"E",(function(){return w})),r.d(n,"TM",(function(){return R})),r.d(n,"C",(function(){return M})),r.d(n,"xp",(function(){return j})),r.d(n,"J",(function(){return D})),r.d(n,"j",(function(){return A})),r.d(n,"xo",(function(){return P})),r.d(n,"G",(function(){return L})),r.d(n,"I",(function(){return N})),r.d(n,"m",(function(){return F})),r.d(n,"Jd",(function(){return U})),r.d(n,"N",(function(){return H})),r.d(n,"sH",(function(){return V})),r.d(n,"cV",(function(){return W})),r.d(n,"k",(function(){return z})),r.d(n,"V",(function(){return G})),r.d(n,"q",(function(){return K})),r.d(n,"P",(function(){return q})),r.d(n,"S",(function(){return Y})),r.d(n,"o",(function(){return J})),r.d(n,"s",(function(){return Z})),r.d(n,"y",(function(){return Q})),r.d(n,"i",(function(){return $})),r.d(n,"Q",(function(){return ee})),r.d(n,"T",(function(){return te})),r.d(n,"x",(function(){return ne}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_Vvd7"),s=r("dx_h6a8"),u=r("dx_C7Cb"),d=r("dx_Fimk"),f=r("dx_b28D"),h=r("dx_MUMK"),p=r("dx_B28d"),v=r("dx_ZG9w"),g=r("dx_zghO"),b=r("dx_bbfH"),y=r("dx_oQO4");function m(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return _(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function _(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var k=Object(f.h)("table:utils"),O=Object(f.e)("table:utils");function x(e){var n={},r=e.rows_id,o=e.columns_id,i=e.cell_set;if(!Object.keys(i).length)return[];try{return r.map((function(e,c){return o.map((function(a,l){var s=e+a,u=i[s],f=u.block_id,h=u.merge_info,p=void 0===h?b.d:h,v=p.row_span,g=p.col_span,y=n[s];if(y)y!==s&&(v>1||g>1)&&(v=b.d.row_span,g=b.d.col_span,Object(d.N)("doc_bug_track_mobile",{action:"invalid_merge_data_table",info:JSON.stringify({sourceCellId:y,cellId:s})}));else if(v>1||g>1){for(var m=c;m<c+v;m++)for(var _=l;_<l+g;_++){var k=r[m]+o[_];n[k]=s}y=s}else y=s;return{cellId:s,sourceCellId:y,cellRecordId:f,rowSpan:v,colSpan:g}}))}))}catch(c){console.error("GetTableLayoutInfo Error: ",c)}return[]}function E(e){var n=e.columns_id,r=e.column_set;return n.map((function(e){return r[e].column_width}))}function S(){return"".concat("col").concat(Object(u.S)())}function C(){return"".concat("row").concat(Object(u.S)())}function I(e){return Array(e).fill(0).map(S)}function B(e){return Array(e).fill(0).map(C)}function T(e,n){var r=n.rows_id,o=n.columns_id,i=A(e),c=a()(i,2),l=c[0],s=c[1];return[r.indexOf(l),o.indexOf(s)]}function w(e,n,r){var o=n.rows_id,i=n.columns_id,c=A(e),l=a()(c,2),s=l[0],u=l[1];switch(r){case h.j.UP:return 0===o.indexOf(s);case h.j.RIGHT:return o.indexOf(s)===o.length-1&&i.indexOf(u)===i.length-1;case h.j.DOWN:return o.indexOf(s)===o.length-1;case h.j.LEFT:return 0===o.indexOf(s)&&0===i.indexOf(u);default:return!1}}function R(e,n){var r=a()(e,2),o=r[0],i=r[1];return!(o<0||i<0)&&!(o>=n.rows_id.length||i>=n.columns_id.length)}function M(e){var n,r=e.cellIds,o=e.layoutInfo,i=e.snapshot,c=i.rows_id,l=i.columns_id,s=0,u=0,d=0,f=0,h=!1,p=m(r);try{for(p.s();!(n=p.n()).done;){var v=A(n.value),g=a()(v,2),b=g[0],y=g[1],_=c.indexOf(b),k=l.indexOf(y),O=o[_][k],x=O.rowSpan,E=O.colSpan,S=_+x-1,C=k+E-1;h?(s=Math.min(s,_),d=Math.min(d,k),u=Math.max(u,S),f=Math.max(f,C)):(h=!0,s=_,u=S,d=k,f=C)}}catch(I){p.e(I)}finally{p.f()}return{startRow:s,startCol:d,endRow:u,endCol:f}}function j(e){var n=M(e),r=e.layoutInfo,o=e.snapshot;return function e(n,i){for(var c=n.startRow,a=n.startCol,l=n.endRow,s=n.endCol,u=[],d=c;d<=l;d++)for(var f=a;f<=s;f++){var h=r[d][f],p=h.cellId,v=h.sourceCellId,g=h.rowSpan,b=h.colSpan;(p!==v||g>1||b>1)&&!i.includes(v)&&(i.push(v),u.push(v))}if(u.length){var y=M({cellIds:u,layoutInfo:r,snapshot:o}),m=y.startRow,_=y.startCol,k=y.endRow,O=y.endCol;return e({startRow:Math.min(c,m),startCol:Math.min(a,_),endRow:Math.max(l,k),endCol:Math.max(s,O)},i)}return{startRow:c,startCol:a,endRow:l,endCol:s}}(n,[])}function D(e,n,r){for(var o=j({cellIds:e.map((function(e){return e.cellId})),layoutInfo:n,snapshot:r}),i=o.startRow,c=o.startCol,a=o.endRow,l=o.endCol,s=[],u=i;u<=a;u++)for(var d=c;d<=l;d++){var f=n[u][d];s.push(f.cellRecordId)}return s}function A(e){var n=e.length;return[e.slice(0,n/2),e.slice(n/2)]}function P(e){var n=2*b.K,r=2*b.g4,o=e.colIdx,c=e.tableData,a=e.cellBlockMinWidthMap,l=c.columns_id,s=c.rows_id,u=c.cell_set,d=l[o];return s.map((function(e){return e+d})).reduce((function(e,n){var r=u[n].block_id;if(!a[r])return e;var o=a[r],c=Object.values(o);return Math.max.apply(Math,[e].concat(i()(c)))}),0)+n+r}function L(e,n){return N(e,n,(function(e){return p.o.includes(e.record.snapshot.type)}))}function N(e,n,r){return e.filter((function(e){return n.getBlockModelByBlockId(e.id).type===p.B.CELL})).reduce((function(e,o){return e.push.apply(e,i()(n.getBlockModelByBlockId(o.id).findDescendantAll(r||function(){return!0}))),e}),[]).map((function(e){return n.getBlockViewByBlockIdNotCheck(e.id)})).filter(Boolean)}function F(e,n){return e.filter((function(e){return n.getBlockModelByBlockId(e.id).type===p.B.CELL})).reduce((function(e,r){return e.push.apply(e,i()(n.getBlockModelByBlockId(r.id).children)),e}),[]).map((function(e){return n.getBlockViewByBlockIdNotCheck(e.id)})).filter(Boolean)}function U(e){var n=e.selectedLineIds,r=e.blockManager,o=e.headerType,c=e.tableInfo,l=c.tableId,u=c.tableSnapshot,d=r.getBlockModelByBlockIdNotCheck(l);if(!d||!n.length)return[];var f=o===y.v.COLUMN,h={};Object(s.forIn)(u.cell_set,(function(e,n){h[e.block_id]=n}));var p=function(e,n){var r=n.cellsLayout,o=n.tableSnapshot,c=new Map,l=new Map;return Object(s.forIn)(o.cell_set,(function(n,s){var u=T(s,o),d=a()(u,2),f=d[0],h=d[1];if(-1!==f&&-1!==h){var p=r[f][h],v=e?p.colSpan:p.rowSpan;if(!(v<=1)){var g=function(e,n,r,o,c){if(n<=1)return[r];var l=T(r,c),s=a()(l,2),u=s[0],d=s[1];return i()(Array(n)).map((function(n,r){return(e?o[u][d+r]:o[u+r][d]).cellId}))}(e,v,s,r,o);g.length&&(g.forEach((function(e,n){c.set(e,s)})),l.set(s,g))}}})),{cellToMainCellId:c,mainCellToCellIds:l}}(f,c),v=p.cellToMainCellId,b=p.mainCellToCellIds,m=Object(s.memoize)((function(e){return(b.get(e)||[e]).every((function(e){return r=e,n.some((function(e){return function(e,n){return e.indexOf(n)>=0}(r,e)}));var r}))}));return d.children.filter((function(e){var n=r.getBlockModelByBlockId(e.id);if("blank"===n.type)return!1;var o=h[n.recordId];if(!o)return!1;var i=v.get(o)||o;return m(i)})).map((function(e){return{type:g.j.BLOCK,id:e.id}}))}function H(e){var n=Object(s.sortBy)(e);return[n[0],n[n.length-1]]}function V(e){return e.type===p.B.TABLE}function W(e,n){for(var r=n.getBlockModelByBlockIdNotCheck(e);r&&r.parent;){if(r.record.snapshot.type===p.B.GRID_COLUMN)return!0;r=r.parent}return!1}function z(e,n){for(var r=n.getBlockModelByBlockIdNotCheck(e);r&&r.parent;){if(r.record.snapshot.type===p.B.GRID)return!0;r=r.parent}return!1}function G(e,n){if(!e.hasBlockModelByBlockId(n))return l.V;var r=e.getBlockPath(n);return[].concat(i()(r),[n]).find((function(n){return e.getBlockModelByBlockId(n).type===p.B.TABLE}))}function K(e,n,r,o){var i=G(e,n);if(i&&r){var c=e.getBlockViewByBlockId(i),a=c.props.scrollManage;if(a){var l=a.getScrollManage(),s=l.scrollModel,u=l.logId;if(s.isModelReady()){var d=s.totalScrollLeft,f=c.getHostRect(),h=e.getBlockViewByBlockId(e.rootBlockId).getHostRect(),p=f.x-h.x,v=r.left-p+d,g=r.right-p+d;k(u,"%s.scrollHorizontal: left=%s, right=%s, tableOffsetLeft=%s",o,v,g,p),a.setAfterRender({key:"scrollHorizontal",value:function(){var e=s.getOffsetToShowRect(v,g);k(u,"%s.scrollHorizontal(afterRender): %s, scroll=%s",o,e,s.totalScrollLeft),e&&l.scrollByDistance(e,o)}})}}}}function q(e,n,r,o){var i=r.rows_id,c=r.columns_id,a=r.cell_set["".concat(i[n]).concat(c[e])].block_id,l=o.getBlockIdsByRecordId(a)[0];return o.getBlockModelByBlockId(l)}function X(e,n){if(e.includes(n-1)){for(var r=n-2;r>=0;r--)if(!e.includes(r))return r}else for(var o=e[0];o<n;o++)if(!e.includes(o))return o;return-1}function Y(e,n,r,o,i){O(".focusByHasSelectedColsOrRows: selColIndexes=%o, selRowIndexes=%o, totalCol=%d, totalRow=%d",e,n,r,o);var c=i.tableBlock,s=i.blockManager,u=i.selectionAPI,d=l.V,f=function(e,n,r,o){var i=!!e.length,c=!!n.length;return e.length===r||n.length===o||!i&&!c?[-1,-1]:i&&!c?[0,X(e,r)]:!i&&c?[X(n,o),0]:[X(n,o),X(e,r)]}(e,n,r,o),h=a()(f,2),p=h[0],b=h[1];if(!(p<0||b<0))try{d=q(b,p,c.record.snapshot,s).children[0].id;var y=s.getBlockViewByBlockId(d);if(O(".focusByHasSelectedColsOrRows.toFocusBlock: toFocusBlock=%o",y),Object(v.U)(y)){var m=y.model.zoneState.totalWidth()-1;O(".focusByHasSelectedColsOrRows.toFocusBlock.editable: size=%d",m),y.model.setSelection({start:m,len:0},!0)}else O(".focusByHasSelectedColsOrRows.toFocusBlock.notEditable: id=%s",d),u.setSelection([{type:g.j.BLOCK,id:d}])}catch(_){console.error("[doc table focusByHasSelectedColsOrRows error]",_)}}function J(e,n){var r=n.record.snapshot,o=r.columns_id,i=r.rows_id,c=function(n,r){return n.reduce((function(n,o,i){return e.filter((function(e){var n=e.cellId;return null===n||void 0===n?void 0:n.includes(o)})).length===r&&n.push(i),n}),[])};return{allSelectedColIndexes:c(o,i.length),allSelectedRowIndexes:c(i,o.length)}}function Z(e,n){return e.getBlockModelByBlockId(n).cellId}function Q(e,n){return"".concat(e).concat(n)}function $(e){var n=/(row.+)(col.+)/.exec(e);return[n[1],n[2]]}function ee(e){var n=(e||{}).cell_set,r={};return Object.keys(n).map((function(e){var o=n[e].block_id;r[o]=e})),r}function te(e){var n=e.rows_id,r=e.columns_id,o=e.cell_set;return function(e,n){var r=[];if(e.length&&n.length){var o,i=m(e);try{for(i.s();!(o=i.n()).done;){var c,a=o.value,l=m(n);try{for(l.s();!(c=l.n()).done;){var s=c.value;r.push("".concat(a).concat(s))}}catch(u){l.e(u)}finally{l.f()}}}catch(u){i.e(u)}finally{i.f()}}return r}(n||[],r||[]).map((function(e){var n;return null===o||void 0===o||null===(n=o[e])||void 0===n?void 0:n.block_id})).filter(Boolean)}var ne=function e(n,r){var o=n.parentId;if(!o)return!1;var i=r.getBlockViewByBlockIdNotCheck(o);return!!i&&(i.type===p.B.CELL||e(i,r))}},dx_QHTI:function(e,n,r){"use strict";r.d(n,"S",(function(){return O})),r.d(n,"u",(function(){return x})),r.d(n,"d",(function(){return E})),r.d(n,"k",(function(){return S})),r.d(n,"N",(function(){return C})),r.d(n,"P",(function(){return I})),r.d(n,"p",(function(){return B}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_UtDZ"),s=r("dx_h6a8"),u=r("dx_zB2q"),d=r.n(u),f=r("dx_C7Cb"),h=r("dx_xlCA"),p=r("dx_eSV8"),v=r("dx_bWl7"),g=r("dx_B28d"),b=r("dx_UTG8");function y(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function m(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?y(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var _=0;function k(){return _++,"".concat(Object(p.I)(12),"-").concat(_)}function O(e,n){var r,o,i=e.type,c=e.record.snapshot;switch(n=null===(r=n)||void 0===r?void 0:r.toLocaleLowerCase(),i){case g.B.FILE:o=S(c,n);break;case g.B.DIAGRAM:o=function(e){var n=e.diagram,r=m(m({},n),{},{lastEditTime:0});return{blockType:"DIAGRAM_BLOCK",initData:escape(JSON.stringify(r)),props:{diagramType:n.diagramType,viewType:"card"}}}(c);break;case g.B.BITABLE:o=function(e){var n,r=Object(v.U)(e.record.snapshot.token).id;return{initData:null===(n=e.bridge)||void 0===n?void 0:n.handleCopy(r)}}(e);break;case g.B.ISV:o=function(e){var n=e.editorAPI.viewService.getBlockViewByBlockId(e.id);return{blockId:e.id,blockType:"ISV_BLOCK",props:{data:{blockTypeId:null===n||void 0===n?void 0:n.blockTypeId,AppBlockId:"",schema:null===n||void 0===n?void 0:n.onCopy()}}}}(e);break;case g.B.MINDMAP:o=function(e){var n,r=e.record.snapshot.height,o=e.editorAPI.viewService.getBlockViewByBlockId(e.id),i=null===o||void 0===o||null===(n=o.bridge)||void 0===n?void 0:n.handleCopy(e.id);return{blockType:"MINDNOTE_BLOCK",initData:escape(JSON.stringify(i)),props:{renderSource:"doc",size:{width:730,height:r,originalWidth:730,originalHeight:404,isModified:!0},resizeType:5,sliderType:1}}}(e);break;case g.B.CHAT_CARD:o=function(e,n){var r=(e.editorAPI.viewService.getBlockViewByBlockId(e.id)||{}).chatCardInfo;return{blockType:"CHAT_CARD_BLOCK",props:{data:{author:l.userHelper.getCurrentUser().get("id"),chatId:n.chat_id,chatToken:"none",icon:r?r.icon:"none"}}}}(e,c);break;case g.B.IFRAME:o=function(e){var n=e.iframe,r=n.component,o=n.original_height,i=n.original_width,c=n.height,a=n.width,l=r.type,s=r.original_text,u=r.url,d=i===a&&o===c;return{blockType:"IFRAME_BLOCK",props:{data:{type:l,url:u,originalText:decodeURIComponent(s)},resizeType:2,size:{originalHeight:o,originalWidth:i,height:c,width:a,isModified:d}}}}(c);break;case g.B.BOOKMARK:o=function(e){var n=e.bookmark,r=n.title,o=n.url,i=n.cover_height,c=n.cover_url,a=n.cover_width,l=n.icon,s=n.summary;return{blockType:"LINK_BLOCK",props:{data:{cover_height:i,cover_url:c,cover_width:a,summary:s,title:r,url:o,icon:l,linkProvider:"smartLink",linkType:"bookmark",entityId:""},displayMode:"block",viewType:"card"}}}(c);break;case g.B.POLL:o=function(e){var n=e.poll_type,r=e.option_map,o=e.option_ids,i=e.title,c=e.when_result_visible,a=(new Date).getTime(),l={title:b.InputPipe.getPlainText(i),type:n,voteMap:{},voteOptions:o,voteOptionMap:o.reduce((function(e,n){return e[n]={id:n,text:b.InputPipe.getPlainText(r[n].text),createdAt:a,updatedAt:a,votes:[]},e}),{}),voteResultVisible:c};return{blockType:"POLL_BLOCK",props:{},initData:escape(JSON.stringify(l))}}(c);break;case g.B.JIRA_ISSUE:o=B(c,n)}if(o)return o.blockId=Object(f.S)(),JSON.stringify(o)}function x(e){var n=e.uid,r=h.n.getCache(n);return r?{blockType:"AT_USER_BLOCK",blockId:Object(f.S)(),props:{displayMode:"inline",data:{mentionNotify:!0,user:{avatar_url:r.avatar_url,cn_name:r.name,en_name:r.en_name,id:n,name:r.name,type:0,not_notify:!1,is_external:!1}}}}:{}}function E(e){var n=e.expire_time,r=e.is_whole_day,o=e.notify_time;return{blockType:"REMINDER_BLOCK",blockId:Object(f.S)(),props:{data:{expireTime:n,isWholeDay:r,notifyTime:o,shouldNotify:!1},displayMode:"inline"}}}function S(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"card",r=e.file,o=r.token,i=r.name,c=r.size,a=(i.split(".").pop()||"").toLocaleLowerCase();return{blockId:Object(f.S)(),blockType:"FILE_CARD_BLOCK",props:{data:{fileId:k(),fileInfo:{driveKey:o,name:i,size:c,type:a,useDriveStorage:!0,actualType:d.a.lookup(i)||"",uploadOwner:l.userHelper.getCurrentUser().get("id")}},displayMode:"inline"===n?"inline":"block",fromCopy:!0,viewType:n}}}function C(e){return{blockId:Object(f.S)(),blockType:"EQUATION_BLOCK",initData:{},props:{data:{equation:e},displayMode:"inline",viewType:"inline"}}}function I(e){var n=e.raw_url,r=e.file_type,o=e.token,c={link:encodeURIComponent(n),token:o,type:r,uuid:k()};return Object.entries(c).map((function(e){var n=i()(e,2),r=n[0],o=n[1];return"mention-".concat(r,"_").concat(o)})).join(" ")}function B(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inline",r=Object(s.pick)(e,["issueKey","issueRecordMap","jiraIssueId","lastSyncTime","linkUrl","typeIconUrl"]);return{blockId:Object(f.S)(),blockType:"JIRA_ISSUE_BLOCK",props:{viewType:n,displayMode:n},initData:escape(JSON.stringify(r))}}},dx_QJ6a:function(e,n,r){"use strict";r.d(n,"e",(function(){return i})),r.d(n,"b",(function(){return c})),r.d(n,"u",(function(){return a})),r.d(n,"h",(function(){return l})),r.d(n,"J",(function(){return s})),r.d(n,"j",(function(){return u})),r.d(n,"f",(function(){return d})),r.d(n,"n",(function(){return f})),r.d(n,"E",(function(){return h})),r.d(n,"I",(function(){return p})),r.d(n,"R",(function(){return v})),r.d(n,"U",(function(){return g}));var o=r("dx_yNB7"),i="link",c="auto-url",a="unlink",l="".concat(o.l,"link-selection"),s="".concat(o.l,"mock-selection"),u="".concat(o.l,"link-hover"),d="".concat(o.l,"loading-link-title"),f="link-selection-token-",h="auto-url-line",p="auto-url-start",v="auto-url-length",g="link-id"},dx_QJAX:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return A}));var e=r("dx_RIqP"),o=r.n(e),i=r("dx_lSNA"),c=r.n(i),a=r("dx_J4zp"),l=r.n(a),s=r("dx_o0o1"),u=r.n(s),d=r("dx_yXPU"),f=r.n(d),h=r("dx_lwsE"),p=r.n(h),v=r("dx_W8MJ"),g=r.n(v),b=r("dx_YzVl"),y=r("dx_MoY1"),m=r("dx_zEdG"),_=r("dx_CwnG"),k=r("dx_tP01"),O=r("dx_B28d"),x=r("dx_e8ez"),E=r("dx_KXll"),S=r("dx_xFJs"),C=r("dx_yaFe"),I=r("dx_dOu9"),B=r("dx_Ai6r"),T=r("dx_QRvo"),w=r("dx_nFCg"),R=r("dx_EjFk"),M=r("dx_cmmV");function j(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function D(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?j(Object(r),!0).forEach((function(n){c()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var A=function(){function e(n,r,o){p()(this,e),this.blockManager=n,this.fold=r,this.fileUploader=o}return g()(e,[{key:"perform",value:function(e,n,r){if(r instanceof FileList&&(r=Array.from(r)),r=this.filterFiles(r),e&&n&&(n.parentId||n.targetId===this.blockManager.rootBlockId))return n.direction===M.j.left||n.direction===M.j.right?this.performDropAside(e,n,r):this.performDrop(e,n,r)}},{key:"isImage",value:function(e){var n=e.type;return/^image\/(gif|jpg|jpeg|bmp|png)$/.test(n)}},{key:"filterFiles",value:function(e){var n=this;return e.filter((function(e){return!(!n.isImage(e)&&!Object(w.b)(e))||(Object(b.F)({type:"error",content:Object(w.G)(e)},!1),!1)}))}},{key:"genPlaceholderSnapshots",value:function(){var e=f()(u.a.mark((function e(n,r){var o,i=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.map((function(e){return i.isImage(e)?Object(B.y)(e).catch((function(e){return Object(b.F)({type:"error",content:"".concat(t("common.upload_image_failed")," ").concat(String(e.msg||"")),dom:r},!1),null})):Object(x.x)(e)})),e.abrupt("return",Promise.all(o));case 2:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"filterIneffectiveSnapshots",value:function(e,n){var r=[],o=e.filter((function(e,o){return e&&r.push(n[o]),e}));return{files:r,snapshots:o}}},{key:"genAndFilterPlaceholderSnapshots",value:function(){var e=f()(u.a.mark((function e(n,r){var o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.genPlaceholderSnapshots(n,r);case 2:return o=e.sent,e.abrupt("return",this.filterIneffectiveSnapshots(o,n));case 4:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"uploadFiles",value:function(){var e=f()(u.a.mark((function e(n,r,o,i){var c,a,l,s,d=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=this.blockManager,a=c.editorAPI.getService(I.Y),l=Object(k.m)(c),s=r.map((function(e,r){var s=n[r];if(d.isImage(s))return Object(B.e)(c,new R.J({pageToken:l}),a,"performDropImage",e,s,T.Z.Drag,i).catch((function(e){console.log(e),Object(b.F)({type:"error",content:"".concat(t("common.upload_image_failed")),dom:o},!1)}));var u,f=c.getBlockModelByBlockId(e),h=(null===(u=f.record.snapshot)||void 0===u?void 0:u.type)===O.B.VIEW?f.findDescendant((function(e){return e.type===O.B.FILE})):f;return h?d.fileUploader.uploadOnly({file:s,recordId:h.recordId,event:void 0,source:T.Z.Drag}):Promise.reject(new Error("no file block struct."))})),e.next=6,Promise.all(s);case 6:case"end":return e.stop()}}),e,this)})));return function(n,r,o,i){return e.apply(this,arguments)}}()},{key:"reportDragFileOrImageEvent",value:function(e){var n=this;e&&e.length>0&&e.forEach((function(e){var r=Object(_.F)(n.blockManager.getBlockIdsByRecordId(e.id)[0],n.blockManager);Object(m.P)("ccm_doc_content_page_click",r,{click:"block_drag_upload",action_type:"add_".concat(e.type)})}))}},{key:"performDrop",value:function(){var e=f()(u.a.mark((function e(n,r,o){var i,c,a,s,d,h,p,v,g,m,_,k,S,I,B,T,w,R,M,j,D=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.targetId&&this.blockManager.getBlockModelByBlockId(r.targetId),c=r.parentId,a=r.targetId,s=r.dropToChild,d=r.position,h=r.direction,p=s?a:c){e.next=5;break}throw new Error("can not find drop target, ".concat(p));case 5:if(i){e.next=7;break}return e.abrupt("return");case 7:return v=this.blockManager,g=v.getBlockViewByBlockId(p),m=g.record.id,_=[],k=[],S=[],I=[],B=[],T=function(){if(I.length)return I;k.forEach((function(e,n){B.push({id:e,type:S[n]}),D.blockManager.getBlockIdsByRecordId(e).forEach((function(e){I.push(e)}))}))},e.prev=16,e.next=19,this.genAndFilterPlaceholderSnapshots(o,g.hostElement);case 19:return w=e.sent,R=w.files,M=w.snapshots,j=[],e.next=25,v.applyTransaction("performDropImageOrFile",(function(e){var n="bottom"===h?d+1:d;if(s){var r=D.blockManager.getBlockModelByBlockId(p);n=r.children.length}M.forEach((function(r,o){if(Object(E.z)(r)){var i=Object(x.E)(e,r,m,n),c=l()(i,2),a=c[0],s=c[1];_.push(a),k.push(s),j.push(s),S.push(O.B.FILE)}else{var u=Object(y.s)(e,g.record.id,r);e.insertChildren(g.record.id,n,[u]);var d=window.URL.createObjectURL(R[o]);v.editorAPI.getService(C.V).addData(u,d),k.push(u),B.push({id:u,type:O.B.IMAGE})}n++})),D.fold.isFolded(p)&&e.replace(g.record.id,["folded"],!1)}),{afterTransactionAccepted:function(){var e=f()(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return T(),e.next=3,D.uploadFiles(R,I,g.hostElement);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()});case 25:j.forEach((function(e){return Object(x.qC)(e,D.blockManager)})),T(),this.reportDragFileOrImageEvent(B),e.next=35;break;case 30:e.prev=30,e.t0=e.catch(16),console.log(e.t0),v.applyTransaction("remove-errors",(function(e){k.forEach((function(n,r){e.removeChildren(_[r],[n])}))})),Object(b.F)({type:"error",content:"".concat(t("mention.uploader_failure")),dom:g.hostElement});case 35:case"end":return e.stop()}}),e,this,[[16,30]])})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"performDropAside",value:function(){var e=f()(u.a.mark((function e(n,r,i){var c,a,l,s,d,h,p,v,g,m,_,k,E,C,I,B,T,w,R,j,A,P,L,N,F,U,H,V,W,z,G,K=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=r.targetId&&this.blockManager.getBlockModelByBlockId(r.targetId)){e.next=3;break}return e.abrupt("return");case 3:return a=this.blockManager,l=a.getBlockViewByBlockId(r.targetId),s=c.record.snapshot.type===O.B.GRID_COLUMN,d=r.direction===M.j.left,h=[],p=[],v=[],e.prev=10,e.next=13,this.genAndFilterPlaceholderSnapshots(i,l.hostElement);case 13:if(g=e.sent,m=g.files,_=g.snapshots,k={record:{snapshot:_[0],id:""}},!s){e.next=30;break}return C=c.parent.id,I=c.position+(d?0:1),B=a.getBlockViewByBlockId(C),T=(null===(E=B.hostElement.parentElement)||void 0===E?void 0:E.clientWidth)||730,B.currentMultiBlockInLineValue===k.record.snapshot.type&&(w=c.parent,(R=w.children.map((function(e){return e.children[0]}))).splice(I,0,k),(v=Object(S.T)(B.currentMultiBlockInLineValue,T,R)||[]).length>2&&Object(S.q)(!0)),j=v.length>2?{sizeMap:v}:{},e.next=26,Object(S.t)(D(D({},j),{},{blockManager:a,gridBlockId:C,columnIndex:I,getNewColumnChildrenRecordIds:function(e,n){var r=Object(x.G)(e,n,_);return h=r.placeholderRecordIds,v.length>1&&e.replace(r.childrenRecordIds[0],["image","scale"],v[I].scale),r.childrenRecordIds},transactionName:"performDropImageOrFileAside",afterTransactionAccepted:function(){var e=f()(u.a.mark((function e(){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,v.length>2&&(n=v[I].scale),r=n?{scale:n}:{},p=h.map((function(e){return a.getBlockIdsByRecordId(e)[0]})),e.next=6,K.uploadFiles(m,p,l.hostElement,r);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),afterTransaction:function(){Object(x.q)(h,_,K.blockManager)}}));case 26:return A=e.sent,e.abrupt("return",A);case 30:return L=c.parent,N=a.getBlockViewByBlockId(r.targetId),F=(null===(P=N.hostElement.parentElement)||void 0===P?void 0:P.clientWidth)||730,U=d?0:1,H=[],(V=c.type.includes("heading")&&c.record.snapshot.folded)&&(H=this.fold.findFoldedBlocks(c.id)),c.type===k.record.snapshot.type&&(W=d?[k,c]:[c,k],v=Object(S.T)(c.type,F,W)||[]),v.length>1&&Object(S.q)(!0),z=v.length>1?{widthRatioMap:v.map((function(e){return e.widthRatio}))}:{},e.next=42,Object(S.n)(D(D({},z),{},{blockManager:a,parentBlockId:L.id,index:c.position,columnNum:2,focusColumnIndex:U,beforeCreate:function(e){[c.id].concat(o()(H)).forEach((function(n){var r=K.blockManager.getBlockModelByBlockId(n);e.removeChildren(r.parent.recordId,[r.recordId])})),v.length>1&&v.forEach((function(n){n.id&&e.replace(n.id,["image","scale"],n.scale)}))},getColumnChildrenInfo:function(e,n,r){if(n===U){var i=Object(x.G)(e,r,_);return h=i.placeholderRecordIds,v.length>1&&e.replace(i.childrenRecordIds[0],["image","scale"],v[n].scale),i.childrenRecordIds.map((function(e){return{id:e,isNewCreateChild:!0}}))}var l=[];return V&&(l=H.map((function(e){return a.getRecordByBlockId(e).id}))),[c.record.id].concat(o()(l)).map((function(e){return{id:e,isNewCreateChild:!1}}))},transactionName:"performDropImageOrFileAside",afterTransactionAccepted:function(){var e=f()(u.a.mark((function e(){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,v.length>1&&(n=d?v[0].scale:v[1].scale),r=n?{scale:n}:{},p=h.map((function(e){return a.getBlockIdsByRecordId(e)[0]})),e.next=6,K.uploadFiles(m,p,l.hostElement,r);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),afterTransaction:function(){Object(x.q)(h,_,K.blockManager)}}));case 42:return G=e.sent,e.abrupt("return",G);case 44:e.next=52;break;case 46:e.prev=46,e.t0=e.catch(10),console.log(e.t0),p=h.map((function(e){return a.getBlockIdsByRecordId(e)[0]})),a.applyTransaction("removeErrorBlocks",(function(e){Object(y.y)(e,p,a)})),Object(b.F)({type:"error",content:"".concat(t("mention.uploader_failure")),dom:l.hostElement});case 52:case"end":return e.stop()}}),e,this,[[10,46]])})));return function(n,r,o){return e.apply(this,arguments)}}()}]),e}()}).call(this,r("dx_E9Eu"))},dx_QLV0:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return q}));var e,o,i,c,a=r("dx_yG8O"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_PJYZ"),p=r.n(h),v=r("dx_W7W2"),g=r.n(v),b=r("dx_a1gu"),y=r.n(b),m=r("dx_Nsbk"),_=r.n(m),k=r("dx_Uyc2"),O=r.n(k),x=(r("dx_A1AB"),r("dx_J4zp")),E=r.n(x),S=r("dx_xjz2"),C=r("dx_OKGb"),I=r("dx_PcQO"),B=r("dx_TSYQ"),T=r.n(B),w=r("dx_UtDZ"),R=r("dx_cDcd"),M=r.n(R),j=r("dx_rQGm"),D=r("dx_qdTf"),A=r("dx_yzqx"),P=r("dx_jNWT"),L=r("dx_lvfY"),N=r("dx_B28d"),F=r("dx_Vau3"),U=r("dx_upU1"),H=r("dx_D8nn"),V=r("dx_VY1y"),W=r("dx_HOeV");r("dx_C7nA");function z(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=_()(e);if(n){var i=_()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return y()(this,r)}}var G=w.UserPopover,K=function(e){var n,r,o,i,c,a,l,s,u,d,f=e.model,h=e.blockManager,p=e.blockAuthorService,v=e.initInfo,g=Object(R.useState)(null===(n=v.authorInfo)||void 0===n?void 0:n.userId),b=E()(g,2),y=b[0],m=b[1],_=Object(R.useState)(v.sameAsPrevious),k=E()(_,2),O=k[0],x=k[1],S=Object(R.useState)(v.sameAsNext),B=E()(S,2),A=B[0],P=B[1],F=Object(R.useState)(!1),W=E()(F,2),z=W[0],K=W[1],q=Object(R.useState)(0),X=E()(q,2),Y=X[0],J=X[1],Z=Object(R.useState)(0),Q=E()(Z,2),$=Q[0],ee=Q[1],te=Object(R.useState)(!1),ne=E()(te,2),re=ne[0],oe=ne[1],ie=Object(R.useState)(void 0),ce=E()(ie,2),ae=ce[0],le=ce[1],se=Object(R.useState)(!1),ue=E()(se,2),de=ue[0],fe=ue[1],he=Object(R.useRef)(),pe=Number((null===(r=f.editorAPI.config.get("getEditorStyle"))||void 0===r||null===(o=r())||void 0===o?void 0:o.marginLeft)||0),ve=Object(R.useRef)(!1),ge=j.r+pe+j.FT,be=Object(R.useMemo)((function(){return h.getBlockViewByBlockId(f.id).props.scrollManage}),[h,f.id]),ye=j.id+Y+$;if(be){var me=be.getScrollModel().mainMaxScrollLeft||ye;ye=Math.min(ye,j.id+me)}var _e=ge-(ye-Y)-V.a,ke=function(){var e,n,r,o,i,c,a,l;he.current={uid:null===(e=v.authorInfo)||void 0===e?void 0:e.userId,color:null===(n=v.authorInfo)||void 0===n?void 0:n.color,name:"zh"===p.getLanguage()?null===(r=v.authorInfo)||void 0===r||null===(o=r.userInfo)||void 0===o?void 0:o.name:null===(i=v.authorInfo)||void 0===i||null===(c=i.userInfo)||void 0===c?void 0:c.enName,isDesensitize:null===(a=v.authorInfo)||void 0===a||null===(l=a.userInfo)||void 0===l?void 0:l.isDesensitize}};void 0===he.current&&ke();var Oe=Object(R.useCallback)((function(){K(!0)}),[]),xe=Object(R.useCallback)((function(){K(!1)}),[]),Ee=Object(R.useCallback)((function(){var e,n,r=Object(D.D)(f),o=Object(D.A)(f),i=(null===r||void 0===r?void 0:r.id)&&p.getAuthorInfoByBlockId(r.id),c=(null===o||void 0===o?void 0:o.id)&&p.getAuthorInfoByBlockId(o.id),a=!!i&&(null===(e=he.current)||void 0===e?void 0:e.uid)===i.userId,l=!!c&&(null===(n=he.current)||void 0===n?void 0:n.uid)===c.userId;Object(D.i)(null===r||void 0===r?void 0:r.id,h)&&(a=!1),Object(D.i)(null===o||void 0===o?void 0:o.id,h)&&(l=!1),Object(D.i)(f.id,h)&&(a=!1,l=!1),x(a),P(l)}),[f,p,h]),Se=Object(R.useMemo)((function(){return!(!f.parent||!Object(N.q)().includes(f.parent.type)||O)}),[O]),Ce=Object(R.useCallback)((function(){p.onViewEditorsMenuChange(!1)}),[]),Ie=Object(R.useMemo)((function(){return!(Object(D.O)(f)||Object(U.L)(f.id,h)||de||!y)}),[y,de]),Be=Object(R.useMemo)((function(){return!Object(D.O)(f)&&f.parent&&Object(N.q)().includes(f.parent.type)&&!y}),[y]),Te=f.record.snapshot.folded,we=null===f||void 0===f||null===(i=f.children)||void 0===i?void 0:i.length,Re=Object(R.useMemo)((function(){if(!A)return!1;var e=f.next&&N.U6.has(f.next.type);return!(Object(N.q)().includes(f.type)&&!f.snapshot.folded&&f.children.length>0&&!e)}),[A,Te,we]),Me=Object(R.useCallback)((function(e,n){var r=h.getBlockModelByBlockId(e);if(ve.current!==n&&(ve.current=n,r.parent&&Object(N.q)().includes(r.parent.type)&&N.U6.has(r.type))){var o,i=h.getBlockViewByBlockId(r.parent.id).hostElement,c=null===(o=i.querySelector(".text-editor"))||void 0===o?void 0:o.clientHeight;c&&(i.querySelector(".author-host").style.height="".concat(c,"px"))}}),[ve]),je=Object(R.useCallback)((function(e){e.blockId===f.id&&(e.offset<0&&(e.offset=0),0===e.offset?(Ee(),le(!1)):e.offset>0&&(x(!1),P(!1),le(!0)),ee(e.offset),Me(e.blockId,e.offset>0))}),[f.id,Ee,Me]);Object(R.useEffect)((function(){if(V.J.includes(f.type)&&!Object(D.O)(f))return H.S.on(V.Y,je),function(){H.S.off(V.Y,je)}}),[je,f]);var De=f.record.snapshot.align;Object(R.useEffect)((function(){try{if(f.type===N.B.IFRAME){var e=h.getBlockViewByBlockId(f.id);je({blockId:f.id,offset:e.getExceededWidth(f.snapshot.iframe.width)})}}catch(n){}}),[De]),Object(R.useEffect)((function(){if(!Object(D.O)(f)){var e=function(){var e=Object(D.D)(f),n=Object(D.A)(f);p.updateBlockStyle([null===e||void 0===e?void 0:e.id,f.id,null===n||void 0===n?void 0:n.id])};p.setUpdateCallback(f.id,(function(){return Ee()}));var n=setTimeout((function(){e()}),200),r=[];if(r.push(p.authorChanged$.subscribe((function(r){var o=r.blockInfo;if(o.blockId===f.id){var i,c,a,l=o.authorInfo;if(l&&!l.userId&&ke(),l&&l.userId)he.current={uid:l.userId,color:l.color,name:"zh"===p.getLanguage()?null===(i=l.userInfo)||void 0===i?void 0:i.name:null===(c=l.userInfo)||void 0===c?void 0:c.enName,isDesensitize:null===(a=l.userInfo)||void 0===a?void 0:a.isDesensitize};m(null===l||void 0===l?void 0:l.userId),clearTimeout(n),e()}}))),r.push(p.needShowCloseBtn$.subscribe((function(e){e.blockId!==f.id?re&&oe(!1):oe(e.needShowCloseBtn)}))),r.push(p.forceDisconnectChanged$.subscribe((function(e){var n=e.forceDisconnect,r=Object(D.D)(f),o=Object(D.A)(f);(null===r||void 0===r?void 0:r.id)===e.blockId&&(n?x(!1):Ee()),(null===o||void 0===o?void 0:o.id)===e.blockId&&(n?P(!1):Ee())}))),f.type===N.B.BITABLE)try{var o=h.getBlockViewByBlockId(f.id),i=!!o.getIsHalfFullScreen();je({blockId:f.id,offset:o.mainScrollLeft}),fe(i),le(i)}catch(u){}if(f.type===N.B.IFRAME)try{var c=h.getBlockViewByBlockId(f.id);je({blockId:f.id,offset:c.getExceededWidth(c.getContentRect().width)}),le(c.isLeftSideOverflowEditor)}catch(u){}if(f.type===N.B.TABLE)try{var a,l=null===(a=h.getBlockViewByBlockId(f.id).scrollManage)||void 0===a?void 0:a.getScrollStatus();l&&l.scrollLeft>0&&(je({blockId:f.id,offset:l.scrollLeft}),le(!0))}catch(u){}if(f.type===N.B.SHEET)try{var s=h.getBlockViewByBlockId(f.id);je({blockId:f.id,offset:s.actualScrollLeft}),le(s.actualScrollLeft>0)}catch(u){}return function(){if(f.parent){var e=Object(D.X)(f);(N.hI.includes(f.type)&&f.type!==N.B.QUOTE||f.type===N.B.DIVIDER||f.type===N.B.TASK)&&(e-=2),J(e)}}(),Me(f.id,!0),function(){r.forEach((function(e){return e.unsubscribe()}))}}}),[]),Object(R.useEffect)((function(){if(f.type===N.B.BITABLE){var e=function(e){var n=e.blockId;if(f.id===n){var r=!!h.getBlockViewByBlockId(f.id).getIsHalfFullScreen();de!==r&&fe(r),ae!==r&&le(r)}};return H.S.on(V.j,e),function(){H.S.off(V.j,e)}}}),[de,ae]),Object(R.useEffect)((function(){void 0!==ae&&p.forceDisconnectChanged$.next({blockId:f.id,forceDisconnect:ae})}),[ae]),Object(R.useEffect)((function(){if(Ie&&Te){var e=Object(D.A)(f);p.updateBlockStyle([f.id,null===e||void 0===e?void 0:e.id])}}),[Te,Ie]);var Ae=Object(R.useRef)(null),Pe=function(){var e=Ae.current;(null===e||void 0===e?void 0:e.classList.contains(V.vM))||null===e||void 0===e||e.classList.add(V.vM)},Le=function(){var e=Ae.current;null===e||void 0===e||e.classList.remove(V.vM)};Object(R.useEffect)((function(){var e,n;return null===(e=Ae.current)||void 0===e||e.addEventListener("mouseenter",Pe),null===(n=Ae.current)||void 0===n||n.addEventListener("mouseleave",Le),function(){var e,n;null===(e=Ae.current)||void 0===e||e.removeEventListener("mouseenter",Pe),null===(n=Ae.current)||void 0===n||n.removeEventListener("mouseleave",Le)}}),[]);var Ne=Object(N.q)().includes(f.type)?V.M:V.C,Fe=!!(null===(c=he.current)||void 0===c?void 0:c.isDesensitize);return M.a.createElement("div",{className:"author-host"},M.a.createElement("div",{className:T()("author-wrapper",{extend:A}),ref:Ae,contentEditable:!1,style:{color:null===(a=he.current)||void 0===a?void 0:a.color,right:ye,width:_e}},re&&M.a.createElement(I.Tooltip,{placement:"top",title:t("CreationDoc_ViewEditors_Close_tooltips")},M.a.createElement("div",{className:"close-btn",onClick:Ce,style:{right:-($+V.v)}},M.a.createElement(C.S,null))),Ie?M.a.createElement("div",{className:T()("author-line",{"no-border-radius":A}),style:{backgroundColor:null===(l=he.current)||void 0===l?void 0:l.color}},Se&&M.a.createElement("div",{className:"author-line-mask",style:{top:-Ne,height:Ne}}),Re&&M.a.createElement("div",{className:"author-line-extend",style:{backgroundColor:null===(s=he.current)||void 0===s?void 0:s.color}})):Be&&M.a.createElement("div",{className:"author-line-mask",style:{height:"calc(100% + ".concat(Ne,"px)"),bottom:0}}),Ie&&!O&&M.a.createElement(G,{prefixCls:"cooperater-user-popover",source:w.SOURCE_ENUM.DOCX,token:he.current.uid,name:he.current.name,trigger:"hover",placement:"rt",align:{offset:[22,-4]},usePopover:!Fe,mouseEnterDelay:300},M.a.createElement("div",{className:"author-name",style:{backgroundColor:z&&(null===(u=he.current)||void 0===u?void 0:u.color)?Object(L.I)(he.current.color,10):"transparent"},onMouseEnter:Oe,onMouseLeave:xe},null===(d=he.current)||void 0===d?void 0:d.name))))},q=(e=Object(S.d)(W.a),c=function(e){g()(r,e);var n=z(r);function r(){var e;u()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return e=n.call.apply(n,[this].concat(c)),l()(e,"blockAuthorService",i,p()(e)),e}return f()(r,[{key:"getBeforeSlot",value:function(){var e=this.blockAuthorService,n=this.options.blockManager;return function(r){var o=Object(R.useState)((function(){var e=Object(P.B)(w.store.getState()),n=w.selectors.translate.selectTranslateStatus(w.store.getState()).translated;return e&&!n})),i=E()(o,2),c=i[0],a=i[1],l=Object(R.useState)(null),s=E()(l,2),u=s[0],d=s[1],f=function(e){if(r.model.id===e.blockId&&!u){var n=e.authorInfo,o=e.sameAsPrevious,i=e.sameAsNext;d({authorInfo:n,sameAsPrevious:o,sameAsNext:i})}};return Object(R.useEffect)((function(){var n=[];return n.push(e.needShowEditorsStateChanged$.subscribe((function(e){var n=e.isViewEditors,r=e.isTranslated;a(n&&!r)}))),n.push(e.authorInit$.subscribe(f)),function(){n.forEach((function(e){return e.unsubscribe()}))}}),[]),Object(R.useEffect)((function(){c?u||e.emitInitAuthor(r.model.id):d(null)}),[c]),V.A.includes(r.type)?null:c&&!A.S.isMobile&&u?M.a.createElement(K,{initInfo:u,model:r.model,blockManager:n,blockAuthorService:e}):null}}}]),r}(F.A),o=c,i=O()(o.prototype,"blockAuthorService",[e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o)}).call(this,r("dx_E9Eu"))},dx_QLXn:function(e,n,r){"use strict";r.d(n,"X",(function(){return l})),r.d(n,"t",(function(){return s})),r.d(n,"o",(function(){return u})),r.d(n,"g",(function(){return d}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_SreQ"),a=r("dx_DdSJ"),l=function(e){var n,r;return null===(n=window.SERVER_DATA)||void 0===n||null===(r=n.ccmCommonSetting)||void 0===r?void 0:r[e]},s=function(e){return[a.n.EDITING,a.n.READING].includes(e)},u=function(e){return e.editable?e.docsModePrefer&&s(e.docsModePrefer)?e.docsModePrefer:e.docsMemory&&s(e.docsMemory)?e.docsMemory:(n=e.openFrom,Object.values(a.r).includes(n)||e.isEmptyDocs?a.n.EDITING:Object(c.t)()?a.n.READING:a.n.EDITING):a.n.READING;var n};function d(e){if(1===e.length)return e[0].id;for(var n=function(n){var r=e[0].path[n];return e.every((function(e){return e.path[n]===r}))},r=0,o=Math.min.apply(Math,i()(e.map((function(e){return e.path.length}))));n(r)&&r<o;)++r;return e[0].path[r-1]}},dx_QPuw:function(e,n,r){"use strict";var o=r("dx_AOXH");r.d(n,"q",(function(){return o.q}))},dx_QRvo:function(e,n,r){"use strict";var o,i;r.d(n,"Z",(function(){return o})),r.d(n,"q",(function(){return i})),r.d(n,"O",(function(){return c})),r.d(n,"G",(function(){return a})),r.d(n,"f",(function(){return l})),r.d(n,"s",(function(){return s})),function(e){e.SidePanel="SidePanel",e.Slash="Slash",e.Drag="Drag",e.Paste="Paste"}(o||(o={})),function(e){e.Success="Success",e.Fail="Fail"}(i||(i={}));var c=10737418240,a=250,l=/(?:[?*<>:"/\\|]+)/,s="docx_file"},dx_QU39:function(e,n,r){"use strict";r.d(n,"T",(function(){return c}));var o=r("dx_UtDZ"),i=r("dx_h6a8");function c(){var e=o.localStorageUtil.getItem("__template__"),n=!0;e&&Object(i.isBoolean)(e.visible)&&(n=e.visible),o.store.dispatch(Object(o.toggleTemplateVisible)(n))}},dx_QVce:function(e,n,r){"use strict";(function(t){r.d(n,"z",(function(){return s}));var e=r("dx_K5vg"),o=r("dx_cDcd"),i=r.n(o),c=r("dx_y5yU"),a=r("dx_m5Ht"),l=Object(c.r)(e.S,{theme:"light"});function s(e){var n=e.loadedStatus,r=e.showVCRoomsUpdateTips,c=e.isLoadFail,s=void 0!==c&&c,u=e.isShortcut,d=void 0!==u&&u,f=e.isHistory,h=void 0!==f&&f,p=e.isForceRefreshing,v=void 0!==p&&p,g=e.getBlockName,b=e.renderShortcut,y=e.renderPlaceholder,m=e.renderRefreshPlaceholder,_=e.renderSSRContent,k=Object(o.useCallback)((function(e){return i.a.createElement("div",{className:"error-view"},i.a.createElement("div",{className:"error-view-img"},i.a.createElement(l,null)),i.a.createElement("div",{className:"error-view-text"},e))}),[]);if(n===a.z.creating){if(v)return m()}else{if(n===a.z.success)return d?b():h?y():null;if(r)return k(t("CreationDoc_Rooms_CannotLoadISV_UpdateRooms"));if(s)return k(t("CreationDoc_Docs_ISV_LoadingFailed_Title",{},"",g()||""))}return _()}}).call(this,r("dx_E9Eu"))},dx_QWnh:function(e,n,r){"use strict";r.d(n,"Q",(function(){return l})),r.d(n,"x",(function(){return s})),r.d(n,"N",(function(){return u})),r.d(n,"i",(function(){return d})),r.d(n,"R",(function(){return f})),r.d(n,"W",(function(){return h}));var o=r("dx_Vvd7"),i=r("dx_B28d"),c=r("dx_L6Lu"),a=r("dx_MMMl");function l(e){var n=e.getService(a.p).getViewportBlocks();return n.length>0?e.getService(o.p).getBlockViewByBlockId(n[0]):e.viewService.rootBlockView}function s(){return{width:window.innerWidth,height:window.innerHeight}}function u(){return.075*s().width}function d(){return.075*s().height}function f(){var e=s(),n=u(),r=d();return{width:e.width-2*n,height:e.height-2*r}}function h(e){if(e.type===i.B.PAGE)return{zoom:Object(c.K)(),inherit:!1};var n=e.hostElement.closest(".".concat(i.Y1)),r=e.hostElement.querySelector(".".concat(i.S0)),o=Array.from(e.hostElement.children).some((function(e){return e.classList.contains(i.Y1)}));return{zoom:r?Object(c.k)(r):o||n?Object(c.K)():1,inherit:!!n}}},dx_QXBh:function(e,n,r){"use strict";r.d(n,"P",(function(){return c}));var o=r("dx_h6a8"),i=r("dx_cDcd"),c=function(e){var n=e.blockId,r=e.selectionAPI,c=e.onIsSelectedChange,a=e.getEquationRange;Object(i.useEffect)((function(){var e=Object(o.debounce)((function(e,r){var o,i=r.find((function(e){return e.id===n}));if(n&&(null===i||void 0===i?void 0:i.selection)){var l=null===(o=a())||void 0===o?void 0:o.toPosition();l&&(l.start>=i.selection.start&&l.start+l.len<=i.selection.end?c(!0):c(!1))}else c(!1)}),20);return r.onSelectionChangeWhenSelecting(e),r.onSelectionChange(e),function(){e.cancel(),r.offSelectionChangeWhenSelecting(e),r.offSelectionChange(e)}}),[r,c,a,n])}},dx_QXYb:function(e,n,r){},dx_QZfp:function(e,n,r){"use strict";function o(e,n){try{return JSON.parse(e)}catch(r){return console.error(e),n||null}}r.d(n,"K",(function(){return o}))},dx_QbKi:function(e,n,r){"use strict";var o=r("dx_GnmH");r.d(n,"RecordSnapshotFactoryService",(function(){return o.y}));var i=r("dx_Sm0n");r.d(n,"RecordSnapshotCreator",(function(){return i.q}));var c=r("dx_Mi7c");r.o(c,"RecordSnapshotFactoryModule")&&r.d(n,"RecordSnapshotFactoryModule",(function(){return c.RecordSnapshotFactoryModule}))},dx_QbWy:function(e,n,r){"use strict";r.d(n,"y",(function(){return o})),r.d(n,"h",(function(){return i})),r.d(n,"O",(function(){return c})),r.d(n,"h8",(function(){return a})),r.d(n,"A",(function(){return l})),r.d(n,"Q",(function(){return s})),r.d(n,"q",(function(){return u})),r.d(n,"V",(function(){return d}));var o="HEART",i="",c=8,a=24,l=32,s=1e3,u=Math.tan(15*Math.PI/180),d=100},dx_Qhqg:function(e,n){},dx_QnNH:function(e,n,r){},dx_QtxU:function(e,n,r){},dx_Qz0W:function(e,n,r){"use strict";r.d(n,"J",(function(){return u}));var o=r("dx_VkAN"),i=r.n(o),c=r("dx_vF1F"),a=r("dx_cDcd"),l=r.n(a);function s(){var e=i()(["\n      width: 24px;\n      height: 24px;\n      border-radius: 50%;\n      background: linear-gradient(110deg, var(--N900-5) 30%, var(--N900-10) 50%, var(--N900-5) 70%);\n    "]);return s=function(){return e},e}var u=function(e){return l.a.createElement("div",Object.assign({className:Object(c.Z)(s())},e))}},dx_QzB0:function(e,n,r){"use strict";r.d(n,"H",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("docs-mode")},dx_R0R3:function(e,n,r){"use strict";r.d(n,"Y",(function(){return o})),r.d(n,"m",(function(){return i}));var o=5e3,i="TASK_DELETED_CANCEL_TOAST_KEY"},dx_R1R5:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o),c=r("dx_faye"),a=r.n(c),l=r("dx_H1q2"),s=r("dx_Fimk"),u=r("dx_g0R0"),d=r("dx_Kkjd"),f=r("dx_uT6L"),h=r("dx_bME5"),p=!1;Object(h.Q)(),n.S=function(e){var n=e.error,r=e.type,o=e.msg,c=e.code,h=void 0===c?0:c,v=e.scmDocx,g=e.scm,b=e.url,y=e.queryParams,m=e.requestId,_=e.ttLogId,k=e.editable,O=e.detail,x=e.isDev,E=void 0===x?Object(l.w)():x;if(p)return console.log("oops modal is showing"),null;p=!0;var S=Object(l.S)(h)||l.x.CopyRefresh;!E&&Object(s.N)("docx_sdk_oops_dev",{code:h,type:r,msg:o,requestId:m,ttLogId:_,scmDocx:v,scm:g,oopsType:S,detail:O,fg:{allow_pre_edit:d.w}});var C=document.createElement("div");document.body.appendChild(C);var I=function e(){a.a.unmountComponentAtNode(C),C.parentNode&&C.parentNode.removeChild(C),window.removeEventListener("popstate",e),p=!1};return window.addEventListener("popstate",I),a.a.render(i.a.createElement(f.S,{code:h,type:S,editable:k,getErrorContext:function(){var e={code:h,url:b,queryParams:y,requestId:m,ttLogId:_,msg:o};return{error:Object(u.W)(n,e)}},onUnmount:I}),C),I}},dx_R2Rp:function(e,n,r){"use strict";(function(t){r.d(n,"P",(function(){return c})),r.d(n,"D",(function(){return a})),r.d(n,"B",(function(){return l})),r.d(n,"Pm",(function(){return s}));var e,o=r("dx_hB4y"),i=r("dx_oZYG"),c="INSERT_COL_RIGHT",a="INSERT_COL_LEFT",l="INSERT_ROW_DOWN",s="INSERT_ROW_UP";Object(o.v)(t("CreationMobile_Docs_InsertTable_InsertColumn_Right_Button")),Object(o.v)(t("CreationMobile_Docs_InsertTable_InsertColumn_Left_Button")),Object(o.v)(t("CreationMobile_Docs_InsertTable_InsertColumn_Button")),Object(o.v)(t("CreationMobile_Docs_InsertTable_DeleteColumn_Button")),Object(o.v)(t("CreationMobile_Docs_InsertTable_InsertRow_Down_Button")),Object(o.v)(t("CreationMobile_Docs_InsertTable_InsertRow_Up_Button")),Object(o.v)(t("CreationMobile_Docs_InsertTable_InsertRow_Button")),Object(o.v)(t("CreationMobile_Docs_InsertTable_DeleteRow_Button")),i.k,i.S,i.l;!function(e){e.ShowMenu="showMenu",e.Terminate="terminate",e.CallNative="callNative"}(e||(e={}))}).call(this,r("dx_E9Eu"))},dx_R53K:function(e,n,r){"use strict";var o,i,c=r("dx_lwsE"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_N9dL"),g=r("dx_B28d"),b=r("dx_a48a"),y=r("dx_GbKl"),m=r("dx_l4lV");function _(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var k=Object(p.H)({providers:[{provide:v.RecordSnapshotCreator,useValue:{type:g.B.BOOKMARK,create:b.v}}]})((i=function(e){s()(r,e);var n=_(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).blocks=[[y.S,{viewCreator:m.S}]],e}return r}(p.y),o=i))||o,O=k;n.S=O},dx_R7AN:function(e,n,r){"use strict";r.d(n,"X",(function(){return O})),r.d(n,"W",(function(){return x}));var o=r("dx_sXyB"),i=r.n(o),c=r("dx_RIqP"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_N8Nu"),m=r("dx_yNB7"),_=r("dx_eGDr");r("dx_O0KV");function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var O="inlineCode",x=function(e){h()(r,e);var n=k(r);function r(){var e;s()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).name="TextComment",e}return d()(r,[{key:"match",value:function(e){return e.startsWith(_.Zz)||e.startsWith(_.i7)||e===_.l4}},{key:"render",value:function(e){var n=e.attributes,r=e.children,o=new Set;for(var c in n)Object.prototype.hasOwnProperty.call(n,c)&&(c.startsWith(_.Zz)&&(o.add("text-comment"),o.add(c)),c.startsWith(_.i7)&&(o.add("text-comment"),o.add("local-comment"),o.add(c.slice(m.l.length))),c===_.l4&&o.add("comment-hl"),c===O&&o.add("comment-inline-code-wrapper"));var l=i()(Array,a()(o)).join(" ");return e.class+=" ".concat(l),r}}]),r}(y.o)},dx_R7Rv:function(e,n,r){"use strict";r.d(n,"F",(function(){return x})),r.d(n,"h",(function(){return E}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_h6a8"),v=r("dx_cDcd"),g=r.n(v),b=r("dx_Pz0G"),y=r("dx_wbyu"),m=r("dx_luPr"),_=r("dx_B28d"),k=r("dx_qUru");function O(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var x=function(e){return g.a.createElement("div",{style:e.style},g.a.createElement(y.S,{displayMode:_.J.BLOCK,onClickRetry:e.onClickRetry||p.noop,blockError:e.blockError}))},E=function(e){s()(r,e);var n=O(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).isRendered=!1,e.updateComponent=function(n){if(e.props.blockId===n){var r,o;if(e.props.scheduler.isBlockError(n))null===(r=(o=e.props).onBlockFetchFail)||void 0===r||r.call(o);e.isRendered||!e.props.scheduler.canBlockRender(e.props.blockId)||e.props.scheduler.isBlockError(e.props.blockId)||(m.R.reportBlockLoadStage(m.F.JS_READY,{id:e.props.blockId,time:Date.now()}),e.isRendered=!0),e.setState({})}},e.handleRetry=function(){e.props.scheduler.retryFetchBlock(e.props.blockId)},e.renderFinishCb=function(){e.props.scheduler.onBlockDidRender(e.props.blockId)},e}return a()(r,[{key:"componentDidMount",value:function(){this.props.eventEmitter.addListener(k.n,this.updateComponent)}},{key:"componentWillUnmount",value:function(){this.props.eventEmitter.removeListener(k.n,this.updateComponent)}},{key:"render",value:function(){return this.props.scheduler.isBlockError(this.props.blockId)?this.errorPlaceholder:this.props.scheduler.canBlockRender(this.props.blockId)?this.props.renderContent(this.contentComponent,this.renderFinishCb):this.loadingPlaceholder}},{key:"loadingPlaceholder",get:function(){return this.props.renderLoadingPlaceholder?this.props.renderLoadingPlaceholder():g.a.createElement("div",{className:"docx-block-loading-container docx-block-loading-container-block-loading",style:n||{width:"600px",maxWidth:"100%",height:"220px"}},g.a.createElement(b.S,Object.assign({displayMode:_.J.BLOCK},r)),e);var e,n,r}},{key:"errorPlaceholder",get:function(){return this.props.renderErrorPlaceholder?this.props.renderErrorPlaceholder():g.a.createElement(x,{style:{width:"100%",height:"220px"},onClickRetry:this.handleRetry,blockError:{id:this.props.blockId,type:this.props.blockType}})}},{key:"contentComponent",get:function(){return this.props.scheduler.getBlockComponent(this.props.blockType)}}]),r}(g.a.Component)},dx_RKa4:function(e,n){},dx_RO6e:function(e,n,r){},dx_RPzs:function(e,n,r){"use strict";r.d(n,"Y",(function(){return le}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_yG8O"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_PJYZ"),h=r.n(f),p=r("dx_iWIM"),v=r.n(p),g=r("dx_W8MJ"),b=r.n(g),y=r("dx_W7W2"),m=r.n(y),_=r("dx_a1gu"),k=r.n(_),O=r("dx_Nsbk"),x=r.n(O),E=r("dx_Uyc2"),S=r.n(E),C=(r("dx_A1AB"),r("dx_uxuX")),I=r("dx_O5Wm"),B=r("dx_J61J"),T=r("dx_cvuT"),w=r("dx_d7d4"),R=r("dx_I4IM"),M=r.n(R),j=r("dx_h6a8"),D=r("dx_cDcd"),A=r.n(D),P=r("dx_rQGm"),L=r("dx_Fimk"),N=r("dx_luPr"),F=r("dx_GsbX"),U=r("dx_B28d"),H=r("dx_KHvq"),V=r("dx_Hgli"),W=r("dx_bPy9");function z(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=x()(e);if(n){var i=x()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return k()(this,r)}}var G,K,q=function(e){m()(r,e);var n=z(r);function r(e){var o;return d()(this,r),(o=n.call(this,e)).blockManager=void 0,o.blockManager=e.blockManager,o}return b()(r,[{key:"isCodeBlockZoneState",value:function(e){var n=e.getZoneId(),r=this.blockManager.getBlockModelByBlockId(Object(W.j)(n));return r&&r.type===U.B.CODE}}]),r}(V.W),X=r("dx_pk3x"),Y=r("dx_R7Rv"),J=r("dx_YRGG"),Z=r("dx_sNGG"),Q=r("dx_O1Ou"),ee=r("dx_MUhB"),te=r("dx_S6zS");r("dx_T5T1"),r("dx_uhh0");function ne(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function re(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ne(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ne(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function oe(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=x()(e);if(n){var i=x()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return k()(this,r)}}var ie,ce=Object(D.memo)((function(e){var n=e.renderFinishCb,r=e.codeBlockViewRef,o=e.id;return Object(D.useLayoutEffect)((function(){r.current&&(r.current.highlightBlock(o),n(),N.R.reportBlockLoadStage(N.F.TTU,{id:o,time:(new Date).getTime()}))}),[r.current]),null})),ae=Q.a.DocxCode;!function(e){e.SCROLL="scroll"}(ie||(ie={}));var le=(G=function(e){m()(r,e);var n=oe(r);function r(e){var o;return d()(this,r),o=n.call(this,e),s()(o,"scheduler",K,h()(o)),o.unregisterVc=void 0,o.lastVCAction=void 0,o.replayingUUID=void 0,o.pendingVCAction=void 0,o.popupContainer=document.getElementById("docx-popup-container")||document.body,o.codeBlockViewRef=A.a.createRef(),o.hasEnterBufferEver=!1,o.handleScroll=function(){o.props.recursionProps.eventEmitter.emit(Z.Y.HIGHLIGHT_UPDATE),o.calcScrollStateToVc()},o.calcScrollStateToVc=Object(j.debounce)((function(){if(o.vcController){var e=o.editorContainer,n=e.scrollLeft/(e.scrollWidth-e.clientWidth),r={offsetRatioMap:re(re({},(o.vcController.getState(ae,ie.SCROLL)||{offsetRatioMap:{}}).offsetRatioMap),{},a()({},o.record.id,n))};o.vcController.sendState(ae,ie.SCROLL,r)}}),80),o.registerVc=function(){var e;o.unregisterVc=null===(e=o.vcController)||void 0===e?void 0:e.register({moduleName:ae,defaultState:a()({},ie.SCROLL,{offsetRatioMap:{}}),replayHandler:o.replayHandler,retryOnVersionMatched:"always",cycleHandler:o.cycleHandler,checkSame:function(e,n,r){return e===ie.SCROLL&&Object(ee.P)(n.offsetRatioMap,r.offsetRatioMap,(function(e,n){return e[n]}),o.blockManager)}})},o.cycleHandler=function(e){e!==C.STOP_FOLLOW&&e!==C.START_RECORD||(o.lastVCAction=void 0,o.pendingVCAction=void 0)},o.replayHandler=function(e){var n=e.actionType,r=e.data,i=e.uuid,c=e.isRecord;if(n===ie.SCROLL){var a=r.offsetRatioMap[o.record.id];console.debug("debug: replay code scroll",i);var l=h()(o).vcController;if("number"!==typeof a)return null===l||void 0===l?void 0:l.reportReplay(Q.s.IGNORE,i,"[".concat(ae,"]: offsetRatioMap is empty"));if(o.replayingUUID)return o.pendingVCAction&&(null===l||void 0===l||l.reportReplay(Q.s.IGNORE,o.pendingVCAction.uuid,"[".concat(ae,"]: prev scroll not finish, next action coming"))),void(o.pendingVCAction={actionType:n,data:r,uuid:i,isRecord:c});var s=0;if(void 0!==a){var u=o.editorContainer;s=a*(u.scrollWidth-u.clientWidth)}!c&&(o.lastVCAction={actionType:n,data:r,uuid:i,isRecord:c});var d=Date.now();s!==o.editorContainer.scrollLeft?(o.replayingUUID=i,$(o.editorContainer).animate({scrollLeft:s},{complete:function(){null===l||void 0===l||l.reportReplay(Q.s.SUCCESS,i,d),o.replayPendingVCAction()},fail:function(){var e="[".concat(ae,"]: animate fail");null===l||void 0===l||l.reportReplay(Q.s.FAIL,i,e,d),o.replayPendingVCAction(),Object(L.N)("vc_action_apply_dev",{code:1,info:e,action:ae,string_param_1:JSON.stringify(o.editorContainer.scrollLeft),string_param_2:JSON.stringify(r)})}})):null===l||void 0===l||l.reportReplay(Q.s.IGNORE,i,"[".concat(ae,"]: same scrollLeft"))}},o.setScrollLeft=function(e){e!==o.editorContainer.scrollLeft&&$(o.editorContainer).animate({scrollLeft:e})},o.getScrollLeft=function(){return o.editorContainer.scrollLeft},o.registerPlugins=function(){var e=h()(o),n=e.editor,r=e.blockManager,c=new F.S({editor:n,blockManager:r});return[].concat(i()(o.register()),[[q,{editor:n,blockManager:r,i18n:X.i}],[B.k,{editor:n}],[T.X,{editor:n,logger:c}]])},N.R.reportBlockLoadStage(N.F.INIT,{id:o.model.id,time:(new Date).getTime(),type:o.model.type}),o}return b()(r,[{key:"placeholder",get:function(){return""}},{key:"isShortcut",get:function(){return!0===this.props.recursionProps.isShortcut}},{key:"asyncCalc",get:function(){return this.isShortcut}}],[{key:"getChildrenRecordListFromBlockStruct",value:function(){return[]}}]),b()(r,[{key:"blockViewDidMount",value:function(){if(v()(x()(r.prototype),"blockViewDidMount",this).call(this),this.registerVc(),this.parentId){var e=this.blockManager.getBlockViewByBlockId(this.parentId);if(e.type===U.B.GRID_COLUMN){var n=e;n.blockEl.style.minWidth||n.setBlockStyle()}}}},{key:"enterBuffer",value:function(){this.hasEnterBufferEver||(this.hasEnterBufferEver=!0),this.lastVCAction&&this.replayHandler(this.lastVCAction)}},{key:"blockViewDidUpdate",value:function(e,n){if(v()(x()(r.prototype),"blockViewDidUpdate",this).call(this,e,n),e.record.snapshot.language!==this.props.record.snapshot.language){var o=this.props.blockId;this.codeBlockViewRef.current&&this.codeBlockViewRef.current.highlightBlock(o)}}},{key:"blockViewWillUnmount",value:function(){var e,n,o;(v()(x()(r.prototype),"blockViewWillUnmount",this).call(this),null===(e=this.unregisterVc)||void 0===e||e.call(this),this.lastVCAction=void 0,this.replayingUUID)&&(null===(n=this.vcController)||void 0===n||n.reportReplay(Q.s.IGNORE,this.replayingUUID,"[".concat(ae,"]: replaying action not finish until block unmount")),this.replayingUUID=void 0);this.pendingVCAction&&(null===(o=this.vcController)||void 0===o||o.reportReplay(Q.s.IGNORE,this.pendingVCAction.uuid,"[".concat(ae,"]: pending action not start until block unmount")),this.pendingVCAction=void 0)}},{key:"replayPendingVCAction",value:function(){if(this.replayingUUID=void 0,this.pendingVCAction){var e=this.pendingVCAction;this.pendingVCAction=void 0,this.replayHandler(e)}}},{key:"renderComponent",value:function(e){var n=this.renderChildren();return A.a.createElement(A.a.Fragment,null,v()(x()(r.prototype),"render",this).call(this),e&&A.a.createElement(ce,{id:this.id,codeBlockViewRef:this.codeBlockViewRef,renderFinishCb:e}),n?A.a.createElement("div",{style:{paddingLeft:P.X}},n):null)}},{key:"renderZoneView",value:function(e){var n=this.editor,r=this.asyncCalc,o=Object(W.v)(this.props.blockId),i=this.props,c=i.record,a=i.recursionProps,l=i.syncCursorBgColor,s=i.syncCursorSelected,u=i.syncCursorBorderColor,d=re(re({editor:n,zoneId:o,editable:a.editable,copyable:a.copyable,language:w.V[this.model.language]||this.model.language,wrap:Boolean(c.snapshot.wrap),syncCursorSelected:s,syncCursorBorderColor:u,syncCursorBgColor:l,register:this.registerPlugins,i18n:X.i,popupContainer:this.popupContainer,block:this},e),{},{scrollFollowCaret:!0,asyncCalc:r,ButtonComponent:M.a});return A.a.createElement(I.o.Provider,{value:n},A.a.createElement(te.y,Object.assign({},d,{ref:this.codeBlockViewRef})))}},{key:"render",value:function(){var e=this;return this.props.recursionProps.isHistory?this.renderComponent((function(){return null})):A.a.createElement(Y.h,{blockId:this.props.blockId,blockType:U.B.CODE,eventEmitter:this.props.recursionProps.eventEmitter,scheduler:this.scheduler,renderLoadingPlaceholder:function(){return e.renderComponent()},renderContent:function(n,r){return e.renderComponent(r)}})}},{key:"editorContainer",get:function(){return this.model.zoneState.getContainer()}}]),r}(H.N),K=S()(G.prototype,"scheduler",[J.b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G)},dx_RUmv:function(e,n,r){"use strict";(function(t){r.d(n,"w",(function(){return H})),r.d(n,"k",(function(){return V})),r.d(n,"K",(function(){return z})),r.d(n,"h",(function(){return G}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_VkAN"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_iWIM"),f=r.n(d),h=r("dx_W7W2"),p=r.n(h),v=r("dx_a1gu"),g=r.n(v),b=r("dx_Nsbk"),y=r.n(b),m=r("dx_QILm"),_=r.n(m),k=r("dx_LcNA"),O=r("dx_DZiK"),x=r("dx_Q1BS"),E=r("dx_X0Q3"),S=r("dx_fMYK"),C=r("dx_dUaq"),I=r("dx_h6a8"),B=r("dx_cDcd"),T=r.n(B),w=r("dx_BaZy"),R=r.n(w),M=r("dx_iHWM"),j=r("dx_eSV8"),D=r("dx_D8nn"),A=r("dx_ZG9w"),P=r("dx_a4ad");r("dx_Bl2A"),r("dx_nJBA"),r("dx_cToQ");function L(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return N(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return N(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function N(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function F(){var e=c()(["displaystyle "],["\\displaystyle "]);return F=function(){return e},e}function U(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=y()(e);if(n){var i=y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return g()(this,r)}}var H=function(){return T.a.createElement("div",{className:"equation-block-error-placeholder"},T.a.createElement(C.S,null),T.a.createElement("span",{className:"equation-block-error-placeholder-text"},t("CreationDoc_Docs_Equation.placeholder.error")))},V=function(e){var n=t("CreationDoc_Docs_Equation.placeholder.edit");return e||(n=t("CreationDoc_Docs_Equation.placeholder.view")),T.a.createElement("div",{className:"equation-block-placeholder"},n)},W=T.a.createElement("div",{className:"equation-block-loading"},T.a.createElement("div",{className:"equation-block-loading-inner"})),z=R()({loader:function(){return r.e("dx_Nbz").then(r.bind(null,"dx_GGI7"))},loading:function(){return W},render:function(e,n){var r=n.instanceRef,o=_()(n,["instanceRef"]),i=e.default;return T.a.createElement(i,Object.assign({},o,{ref:r}))}}),G=function(e){p()(r,e);var n=U(r);function r(e){var o;return l()(this,r),(o=n.call(this,e)).commentModule=void 0,o.editor=void 0,o.blockManager=void 0,o.selectionAPI=void 0,o.handleContentChange=function(e){var n=e.previous,i=e.current,c=e.options;if("transformEquationId"!==(null===c||void 0===c?void 0:c.type)){var a=n.getEntities([["equation"]]),l=i.getEntities([["equation"]]),s=new Set,u=new Set;a.forEach((function(e){s.add(e.attributes.objectID)})),l.forEach((function(e){u.add(e.attributes.objectID)})),s.forEach((function(e){var n;u.has(e)||(null===(n=r.counterMap)||void 0===n||n.delete(e),o.calculateEquationCounter())}))}},o.handleBlockModelUpdate=function(e){var n=e.model;o.clearCounterMapDataByRecordId(n.recordId),o.updateBlockEquationCounter(n),o.calculateEquationCounter()},o.handleBlockModelDestroy=function(e){var n=e.model.recordId;o.clearCounterMapDataByRecordId(n),o.calculateEquationCounter()},o.calculateEquationCounter=Object(I.debounce)((function(){if(r.counterMap){var e=new Map,n={};r.counterMap.forEach((function(r){var i=r.positionPath,c=e.get(r.recordId);if(c)i=c.concat(r.positionPath);else{var a=function(e){var n=[],r=e,o=e.parent;do{if(o){var i=r.position;n.unshift(i),r=o,o=o.parent}}while(null!==o&&o!==r);return n}(o.blockManager.getBlockModelsByRecordId(r.recordId)[0]);e.set(r.recordId,a),i=a.concat(r.positionPath)}i.reduce((function(e,n,o){return e[n]||(e[n]={children:{},current:[]}),o===i.length-1&&e[n].current.push(r),e[n].children}),n)}));var i=0;!function e(n){Object.keys(n).sort((function(e,n){return Number(e)-Number(n)})).forEach((function(o){var c=n[o],a=c.current,l=c.children;a.sort((function(e,n){return Number(e)-Number(n)})).forEach((function(e){r.counterIndexMap.set(e.objectID,i),i+=e.counterNum})),Object.keys(l).length>0&&e(l)}))}(n),D.S.emit(D.p.COMMON.EQUATION_COUNTER_INDEX_UPDATE,r.counterIndexMap)}}),1e3),o.updateCurrentBlockEquationCounter=Object(I.debounce)((function(e){o.updateBlockEquationCounter(e),o.calculateEquationCounter()}),500),o.handleEquationDidRender=function(){window.setTimeout((function(){window.dispatchEvent(Object(M.x)("equationDidRender"))}),20)},o.destroy=function(){o.editor.off(k.L.CONTENT_CHANGE,o.handleContentChange)},o.editor=e.editor,o.blockManager=e.blockManager,o.selectionAPI=e.selectionAPI,o.commentModule=e.recursionProps.commentModule,o.editor.on(k.L.CONTENT_CHANGE,o.handleContentChange),r.counterMap||(o.initEquationCounter(),e.blockManager.modelService.blockModelUpdate$.subscribe(o.handleBlockModelUpdate),e.blockManager.modelService.blockModelDestroy$.subscribe(o.handleBlockModelDestroy)),o}return u()(r,[{key:"renderToString",value:function(e){try{var n=Object(P.q)();return n?n.renderToString("".concat(String.raw(F())).concat(e),{displayMode:!0,leqno:!1,fleqn:!1,throwOnError:!0,strict:"warn",trust:!1,output:"html"}):void Object(P.X)()}catch(r){return!1}}},{key:"clearCounterMapDataByRecordId",value:function(e){var n;null===(n=r.counterMap)||void 0===n||n.forEach((function(n,o){var i;n.recordId===e&&(null===(i=r.counterMap)||void 0===i||i.delete(o))}))}},{key:"getEquationCounterNum",value:function(e){var n=this.renderToString(e);return n?(n.match(/eqn-num/g)||[]).length:0}},{key:"checkExistEquationCounter",value:function(e){return e.indexOf("{equation}")>-1||e.indexOf("{align}")>-1||e.indexOf("{alignat}")>-1||e.indexOf("{gather}")>-1}},{key:"updateBlockEquationCounter",value:function(e){var n=this;if(Object(A.i)(e)){var i=e.zoneState.getEntities([[r.KEY]]);0!==i.length&&Object(P.X)().then((function(){var c={},a=0;if(i.map((function(e,o){var i=e.attributes[r.KEY];if(n.checkExistEquationCounter(i)){var l=n.getEquationCounterNum(i);if(l>0){var s=e.attributes.objectID;c[s]=[o,l],a+=l}}})),0!==a){var l=[];if(r.counterMap)for(var s in c){var u=o()(c[s],2),d=u[0],f=u[1];l.push(d),r.counterMap.set(s,{counterNum:f,recordId:e.recordId,objectID:s,positionPath:l})}}})).catch((function(e){return Object(j.n)("updateBlockEquationCounter occur error: ".concat(String(e))),null}))}}},{key:"initEquationCounter",value:function(){var e=this;r.counterMap=new Map;var n=this.blockManager;!function n(r){var o,i=L(r);try{for(i.s();!(o=i.n()).done;){var c=o.value;e.updateBlockEquationCounter(c),c.children&&n(c.children)}}catch(a){i.e(a)}finally{i.f()}}(n.getBlockModelByBlockId(n.rootBlockId).children),this.calculateEquationCounter()}},{key:"getPlaceholder",value:function(){return W}},{key:"getCommentModule",value:function(){return this.commentModule}},{key:"render",value:function(e){var n,o=e.op,i=e.index,c=e.zoneId,a=e.lineState,l=e.attributes,s=l.equation,u=l.objectID;if("string"!==typeof s)return e.children;if("string"===typeof u)e.key=u;else{var d=a.getOps().indexOf(o);e.key="equation-".concat(c,"-line-").concat(i,"-op-").concat(d)}if(e.class+=" docx-equation-block",e.domAttributes.objectId=u,!(null===(n=r.counterMap)||void 0===n?void 0:n.has(u)))try{var h=this.blockManager.getBlockModelByBlockId(Number(c));h&&this.updateCurrentBlockEquationCounter(h)}catch(k){console.error("[update block equation counter failed]: ".concat(k))}var p=this.editorAPI,v=p.config.get("isSSR"),g=p.config.get("isShortcut"),b=p.config.get("isPDF"),m=p.config.get("isHistory");if(v)return this.getPlaceholder();if(g||b||m){var _=Object(E.C)(s)?O.r.block:O.r.inline;return e.class+=" equation-display-".concat(_),T.a.createElement(x.S,null,T.a.createElement("div",{className:"editor-kit-equation-block"},T.a.createElement(z,{value:s,viewDisplay:_,placeholder:V(this.editor.isEditable()),errorPlaceholder:H(),onDidRender:this.handleEquationDidRender,getKatex:P.X})))}return f()(y()(r.prototype),"render",this).call(this,e)}},{key:"editorAPI",get:function(){return this.blockManager.editorAPI}},{key:"commentable",get:function(){var e;return!1!==(null===(e=this.commentModule)||void 0===e?void 0:e.getCommentable())&&void 0}}]),r}(S.h);G.initEquationSet=new Set,G.toolboxInsertEquationSet=new Set,G.counterMap=void 0,G.counterIndexMap=new Map}).call(this,r("dx_E9Eu"))},dx_Rr9s:function(e,n,r){"use strict";(function(t){r.d(n,"C",(function(){return m})),r.d(n,"S",(function(){return k}));var e=r("dx_lSNA"),o=r.n(e),i=r("dx_lwsE"),c=r.n(i),a=r("dx_W8MJ"),l=r.n(a),s=r("dx_UtDZ"),u=r("dx_h6a8"),d=r("dx_bUYd"),f=r("dx_ahlY"),h=r("dx_T3tg"),p=r("dx_eGDr"),v=r("dx_upU1"),g=r("dx_Je9X");function b(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function y(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?b(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var m="FEED_MENTION_DELETE_KEY",_="FEED_NOTIFICATION_LOADING",k=function(){function e(){var n=this;c()(this,e),this.isAllDataReady=!1,this.isEditorMount=!1,this.scroller=void 0,this.commentModule=void 0,this.blockManager=void 0,this.viewport=void 0,this.defaultClickedCommentSource=void 0,this.lastClickedCommentOptions=null,this.controller=void 0,this.setMessagePositions=void 0,this.retryCommentClick=function(){if(n.lastClickedCommentOptions){var e=n.lastClickedCommentOptions,r=e.commentId,o=e.offsetTop;n.tryToActiveComment(r,o,y({},n.lastClickedCommentOptions))}},this.handleCommentPositionChange=function(){var e,r=n.commentModule.getDocComments(!0,!0),o=n.getPositionList().filter((function(e){var n=e.commentId;return r.has(n)}));null===(e=n.setMessagePositions)||void 0===e||e.call(n,o),n.retryCommentClick()}}return l()(e,[{key:"getPositionList",value:function(){return this.commentModule.getPositionList().map((function(e){var n=Object(u.cloneDeep)(e),r=n.context,o=void 0===r?{}:r;return o.top=(o.top||0)+Object(f.y)(),n}))}},{key:"showLoadingToast",value:function(){var e,n=null===(e=this.blockManager)||void 0===e?void 0:e.editorAPI.getService(h.e);null===n||void 0===n||n.startApplyAllMode(),s.Toast.show({key:_,type:"loading",content:t("common.loading"),duration:0})}},{key:"showDeletedToast",value:function(e){s.Toast.destroy(_),Object(d.v)({key:_,type:"error",closable:!0,content:e||t("feed.comment_deleted")})}},{key:"showResolvedToast",value:function(){s.Toast.destroy(_),Object(d.y)({key:_,type:"info",duration:1e3,closable:!0,content:t("CreationDoc_Common_Notifications_CommentResolved_toast")})}},{key:"tryToActiveComment",value:function(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=o.replyId,c=this.commentModule.eventCollector.collectEvent,a={activeCommentId:e,isAllDataReady:this.isAllDataReady,isRecordChangeDebounceUpdated:this.commentModule.isRecordChangeDebounceUpdated,defaultClickedCommentSource:this.defaultClickedCommentSource,clickOption:this.lastClickedCommentOptions},l=!!this.commentModule.getPositionByCommentId(e),u=this.commentModule.getCommentByCommentId(e);if(!l){if(this.commentModule.isThirdPartyTypeComment(e)){var d=Array.from(this.commentModule.getRecordsByCommentId(e)||[]),v=d[0];return v?this.commentModule.isThirdPartyCommentLoaded(v)?(c(p.l.feedJump,y(y({},a),{},{msg:"failed, thirdparty comment not found"})),this.handleJumpToDeletedComment(e,n,i)):(this.lastClickedCommentOptions=y(y({},o),{},{commentId:e,offsetTop:n}),c(p.l.feedJump,y(y({},a),{},{msg:"loading, thirdparty block loading"})),this.showLoadingToast()):(c(p.l.feedJump,y(y({},a),{},{msg:"failed, thirdparty block not found"})),this.handleJumpToDeletedComment(e,n,i))}return c(p.l.feedJump,y(y({},a),{},{msg:"failed, block not found"})),this.handleJumpToDeletedComment(e,n,i)}if(i&&u&&!u.replyList.find((function(e){return e.replyId===i})))return c(p.l.feedJump,y(y({},a),{},{msg:"failed, reply deleted"})),this.showDeletedToast();c(p.l.feedJump,y(y({},a),{},{msg:"success"}));var b=null===(r=this.blockManager)||void 0===r?void 0:r.editorAPI.getService(h.e);null===b||void 0===b||b.stopApplyAllMode();var m=document.querySelector(g.C),k=m?Object(f.y)()-n-m.offsetHeight:Object(f.y)()-n;this.commentModule.activateComment(e,void 0,this.defaultClickedCommentSource,k),this.lastClickedCommentOptions=null,s.Toast.destroy(_)}},{key:"handleJumpToDeletedComment",value:function(e,n,r){if(this.isAllDataReady&&this.commentModule.isRecordChangeDebounceUpdated&&this.commentModule.getIsReady()){var o;this.lastClickedCommentOptions=null;var i=null===(o=this.blockManager)||void 0===o?void 0:o.editorAPI.getService(h.e);null===i||void 0===i||i.stopApplyAllMode();var c=this.commentModule.getCommentByCommentId(e);if(!c)return this.showDeletedToast(t("CreationDoc_Common_Notifications_commentDeleted_content"));if(Object(v.O)(c))return this.showResolvedToast();this.showDeletedToast()}else this.lastClickedCommentOptions={commentId:e,offsetTop:n,replyId:r},this.showLoadingToast()}}]),e}()}).call(this,r("dx_E9Eu"))},dx_Rux1:function(e,n,r){"use strict";r.d(n,"E",(function(){return l}));var o=r("dx_B28d"),i=r("dx_fEKD"),c=r("dx_bbfH"),a=r("dx_QBqw");function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{column:c.A,row:c.g},n=e.column,r=e.row,l=Object(a.f)(n),s=Object(a.b0)(r);return Object(i.b)({columns_id:l,rows_id:s,column_set:l.reduce((function(e,n){return e[n]={column_width:c.ug},e}),{}),cell_set:{}},o.B.TABLE)}},dx_RvQP:function(e,n,r){"use strict";r.d(n,"W",(function(){return s}));var o=r("dx_cDcd"),i=r("dx_yzqx"),c=r("dx_CqjN"),a=r("dx_PIlC"),l=r("dx_zghO"),s=function(e){var n=e.block,r=e.selectionAPI,s=e.equationViewInstance,u=e.equationEditorOverlayClassName,d=e.isEditMode,f=e.editorEditable,h=e.containerEditor,p=e.onIsEditModeChange,v=e.onIsSelectedChange,g=e.getEquationRange,b=Object(o.useRef)(null),y=Object(o.useCallback)((function(e){if(!1===e&&(b.current=null,i.S.isIOS||i.S.isSafari)){var r=document.querySelector("[data-content-editable-root]");if(document.activeElement!==r&&r.isContentEditable){r.focus({preventScroll:!0});var o=g();o&&(null===n||void 0===n||n.model.setSelection({start:o.end,end:o.end},!1)),null===n||void 0===n||n.focus()}}null===p||void 0===p||p(e),Object(a.P)(e)}),[n,p,g,h]),m=Object(o.useCallback)((function(e){var o,c;if(!f||d){var h=e.target,p=null===(o=s.current)||void 0===o?void 0:o.getViewElement(),m=null===p||void 0===p?void 0:p.contains(h);if(f||m){if(!b.current){var _=Object(a.I)(u);b.current=_?document.querySelector(_):null}var k=null===(c=b.current)||void 0===c?void 0:c.contains(h);if(m||k||y(!1),!i.S.isMobile)if(k)r.removeAllSelection();else if(m){var O;y(!1),v(!0);var x=null===(O=g())||void 0===O?void 0:O.toPosition();if(!x||!(null===n||void 0===n?void 0:n.id))return;r.setSelection([{type:l.j.TEXT,id:n.id,selection:{start:x.start,end:x.start+x.len}}])}}else v(!1)}}),[u,d,y,r,n,v,f,g,s]),_=Object(o.useMemo)((function(){return Object(c.i)({onClick:m,onLongPress:m,clickDuration:450,longPressDuration:450})}),[m]);return Object(o.useEffect)((function(){return document.addEventListener("click",m),i.S.isMobile&&(document.addEventListener("touchstart",_),document.addEventListener("touchend",_)),function(){document.removeEventListener("click",m),i.S.isMobile&&(document.removeEventListener("touchstart",_),document.removeEventListener("touchend",_))}}),[m,_]),{handleEquationEditorVisibleChange:y}}},dx_S0SF:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M13.642 5.037l-.006-.006.308-.308a.833.833 0 00.002-1.177L11.084.67l-.001-.001a.833.833 0 00-1.179 0l-.588.588.009.008L.667 9.988v3.179c0 .46.373.833.833.833h3.178l8.964-8.963zm-2.728.324L9.235 3.68l1.239-1.262 1.686 1.695-1.246 1.247zm-2.846-.49L9.736 6.54l-5.76 5.766h-.003l-1.612-1.612v-.003l5.707-5.82zM1.5 15.667a.833.833 0 100 1.666h15a.833.833 0 000-1.666h-15z",fill:"currentColor"});n.S=function(e){return i.a.createElement("svg",c({width:18,height:18,viewBox:"0 0 18 18",fill:"none"},e),a)}},dx_S0Si:function(e,n,r){"use strict";r.d(n,"L",(function(){return o})),r.d(n,"N",(function(){return s}));var o,i=r("dx_b28D"),c=r("dx_D8nn"),a=r("dx_j92N"),l=Object(i.h)("scrollable:scrollManage:hookInstance");!function(e){e.COMMENT_SCROLL="comment_scroll",e.VC_REPLAY="vc_replay"}(o||(o={}));var s=function(e){l(e.logId,"creatHook");var n=new c.i;return{getScrollContainer:function(){return e.getScrollContainer()},getScrollModel:function(){return e.scrollModel},getScrollManage:function(){return e},emitSubScroll:function(r,o){l(e.logId,"%s.emitSubScroll: %o",o,r),n.emit("SubScroll",r,o)},onSubScroll:function(e){return n.on("SubScroll",e),function(){n.removeListener("SubScroll",e)}},executeSubScroll:Object(a.I)((function(r,o){l(e.logId,"%s.executeSubScroll: deltaX=%o",o,r),n.emit("ExecuteSubScroll",r,o)})),registerSubScroll:function(e){return n.on("ExecuteSubScroll",e),function(){n.removeListener("ExecuteSubScroll",e)}},executeScroll:Object(a.I)((function(e,r){n.emit("ExecuteScroll",e,r)})),registerScroll:function(e){return n.on("ExecuteScroll",e),function(){n.removeListener("ExecuteScroll",e)}},emitScroll:function(r,o){l(e.logId,"%s.emitScroll: scrollLeft=%s scrollWidth=%s",o,r.scrollLeft,r.scrollWidth),n.emit("Scroll",r,o)},onScroll:function(e){return n.on("Scroll",e),function(){n.removeListener("Scroll",e)}},removeScroll:function(e){n.removeListener("Scroll",e)},destroy:function(){n.removeAllListeners()},onSubViewChange:function(e){return n.on("SubViewChange",e),function(){n.removeListener("SubViewChange",e)}},emitSubViewChange:function(e){n.emit("SubViewChange",e)},onShadowStyleChange:function(e){return n.on("ShadowStyleChange",e),function(){n.removeListener("ShadowStyleChange",e)}},emitShadowStyleChange:function(e){n.emit("ShadowStyleChange",e)},emitShadowChange:function(r){l(e.logId,"emitShadowChange: %s",r),n.emit("ShadowChange",r)},onShadowChange:function(e){return n.on("ShadowChange",e),function(){n.removeListener("ShadowChange",e)}},emitSetWrapperClass:function(e){n.emit("SetWrapperClass",e)},onSetWrapperClass:function(e){return n.on("SetWrapperClass",e),function(){n.removeListener("SetWrapperClass",e)}},setIsNeedNativeScroll:function(r){l(e.logId,"setIsNeedNativeScroll: %s",r),n.emit("setIsNeedNativeScroll",r)},onIsNeedNativeScrollChange:function(e){return n.on("setIsNeedNativeScroll",e),function(){n.removeListener("setIsNeedNativeScroll",e)}},setIsShowScrollBar:function(e){n.emit("setIsShowScrollBar",e)},onSetIsShowScrollBar:function(e){return n.on("setIsShowScrollBar",e),function(){n.removeListener("setIsShowScrollBar",e)}},getScrollContainerWidth:function(){return e.scrollModel.scrollContainerWidth},getScrollStatus:function(){return e.scrollModel.mainScrollStatus||{scrollWidth:0,clientWidth:0,scrollLeft:0}},onGridChange:function(e){return n.on("GridChange",e),function(){n.removeListener("GridChange",e)}},emitGridChange:function(){n.emit("GridChange")},setIsNeedPaddingLeft:function(r){l(e.logId,"setIsNeedPaddingLeft: %s",r),n.emit("setPositionDefaultX",r)},onIsNeedPaddingLeft:function(e){return n.on("setPositionDefaultX",e),function(){n.removeListener("setPositionDefaultX",e)}},setAfterRender:function(e){n.emit("setAfterRender",e)},onAfterRender:function(e){return n.on("setAfterRender",e),function(){n.removeListener("setAfterRender",e)}},getMaxScrollLeft:function(){return e.scrollModel.totalMaxScrollLeft||0}}}},dx_S0qQ:function(e,n,r){"use strict";var o,i;r.d(n,"n",(function(){return o})),r.d(n,"K",(function(){return i})),function(e){e[e.REFRESH=0]="REFRESH",e[e.COPY=1]="COPY",e[e.CONTACT=2]="CONTACT",e[e.CANCEL=3]="CANCEL",e[e.CREATE=4]="CREATE"}(o||(o={})),function(e){e.REFRESH="refresh",e.COPY="copy_full_text",e.CONTACT="contact_us",e.CANCEL="cancel",e.CREATE="create"}(i||(i={}))},dx_S1St:function(e,n,r){"use strict";r.d(n,"H",(function(){return w}));var o,i,c,a=r("dx_lSNA"),l=r.n(a),s=r("dx_Siqi"),u=r("dx_h6a8"),d=r("dx_zB2q"),f=r.n(d),h=r("dx_QZfp"),p=r("dx_B28d"),v=r("dx_Tsyy"),g=r("dx_IdzY"),b=r("dx_s1qv"),y=r("dx_UTG8"),m=r("dx_Q64Q");!function(e){e.UNSUPPORT="unsupport",e.TEXT="text",e.ORDER="order",e.BULLET="bullet",e.TASK="task",e.INDENT="indent",e.IMAGE="image"}(o||(o={})),function(e){e.UNSUPPORT="unsupport",e.TEXT="text",e.LINK="link",e.ATUSER="atuser",e.ATSUITE="atsuite",e.IMAGE="image"}(i||(i={})),function(e){e.DOC="doc",e.SHEET="sheet",e.BITABLE="bitable",e.MINDNOTE="mindnote",e.FILE="file",e.SLIDE="slide",e.WIKI="wiki",e.DOCX="docx"}(c||(c={}));var _,k=r("dx_WJxF");var O=(_={},l()(_,o.TEXT,p.B.TEXT),l()(_,o.ORDER,p.B.ORDERED),l()(_,o.BULLET,p.B.BULLET),l()(_,o.TASK,p.B.TODO),l()(_,o.INDENT,p.B.TEXT),_),x=function(){return document.createElement("span")},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{node:x(),data:e,payload:{},context:{},children:[]}};function S(e,n){n.bold&&Object.assign(e,{bold:"true"}),n.italic&&Object.assign(e,{italic:"true"}),n.underline&&Object.assign(e,{underline:"true"}),n.strikethrough&&Object.assign(e,{strikethrough:"true"}),n.textcolor&&function(e,n){var r=Object(k.E)(n);if(r)e.textHighlight=r;else{var o=Object(k.N)(n,"text");o&&(e.textHighlight=o)}}(e,n.textcolor),n.backcolor&&function(e,n){var r=Object(k.c)(n);if(r)e.textHighlightBackground=r;else{var o=Object(k.N)(n,"background");o&&(e.textHighlightBackground=o)}}(e,n.backcolor)}var C=function(e){switch(e.opType){case i.TEXT:var n={};return S(n,e.options),{text:e.options.text,type:g.B.PLAINTEXT,mark:n};case i.LINK:var r={};return S(r,e.options),r.link=e.options.url,{text:e.options.text,type:g.B.PLAINTEXT,mark:r};case i.ATUSER:var o={};return o[b.INLINE_COMPONENT_MARK]=JSON.stringify(Object(b.generateInlineComponent)(b.INLINE_COMPONENT_TYPE.USER,{uid:e.options.id})),S(o,e.options),{text:" ",type:g.B.EMBED,mark:o};case i.ATSUITE:var c={},a=decodeURIComponent(e.options.url),l=Object(s.M)(a,!0)||{},d=l.token,f=l.type,h=l.mentionTypeNum;return d&&f&&!Object(u.isUndefined)(h)?(c[b.INLINE_COMPONENT_MARK]=JSON.stringify(Object(b.generateInlineComponent)(b.INLINE_COMPONENT_TYPE.DOC,{file_type:h,token:d,tenant_id:"",raw_url:a,title:e.options.text})),S(c,e.options),{text:" ",type:g.B.EMBED,mark:c}):{text:"",type:g.B.PLAINTEXT};default:return{text:" ",type:g.B.PLAINTEXT}}},I=function(e){var n=e.options,r=n.token,o=n.width,i=n.height,c=n.size,a=n.imageType;return{height:Math.floor(Number(i)),width:Math.floor(Number(o)),mimeType:a,name:"".concat(r,".").concat(f.a.extension(a)),scale:1,size:c,token:r}},B=function(e){var n=Object(h.K)(e),r=E(),i={parent:null,leaf:[],level:0,node:r,okrLineIndex:-1},c=i;return n.forEach((function(e,r){switch(e.lineType===o.INDENT&&e.lineOptions.level++,function(e,n){if(n)if(e.lineOptions.level){var r=e.lineOptions.level,o=n.lineOptions.level||1;if(r>o)c=c.leaf[c.leaf.length-1]||i;else if(r<o&&r<c.level+1)for(;c.parent&&(c=c.parent).level+1!==r;);}else c=i;else c=i}(e,n[r-1]),e.lineType){case o.TEXT:var a=E({type:O[e.lineType],nodes:e.lineContent.map((function(e){return C(e)}))}),l={parent:i,leaf:[],level:1,node:a,okrLineIndex:r};i.node.children.push(a),i.leaf.push(l);break;case o.ORDER:case o.BULLET:case o.TASK:case o.INDENT:var s=E({type:O[e.lineType],nodes:e.lineContent.map((function(e){return C(e)}))});e.lineType===o.ORDER?(s.context.orderedListNumber=e.lineOptions.start,s.context.orderedListId=e.lineOptions["ol-id"]):e.lineType===o.TASK&&(s.data.done=e.lineOptions.done);var u={parent:c,leaf:[],level:c.level+1,node:s,okrLineIndex:r};c.node.children.push(s),c.leaf.push(u);break;case o.IMAGE:var d,f=[];if(0===e.lineContent.length);else if(1===e.lineContent.length){var h=E(),g=h.payload,b=h.data;b.type=p.B.IMAGE,b.image=I(e.lineContent[0]),b.align="center",g.fileToken=e.lineContent[0].options.token,g.src=e.lineContent[0].options.src,f.push(h)}else{for(var m,_,k=x(),S=e.lineContent,B=0,T=0,w=[];B<S.length;){B%v.t===0&&(m=B,_={data:{type:p.B.GRID},children:[],payload:{},context:{},node:k},T=S.slice(m,m+v.t).reduce((function(e,n){return e+Number(n.options.width)}),0),w.push(_));var R=S[B],M=I(R),j={data:{type:p.B.GRID_COLUMN,width_ratio:Number(R.options.width)/T},children:[{data:{image:M,type:p.B.IMAGE,align:"center"},context:{},payload:{src:R.options.src,fileToken:R.options.token},children:[],node:k}],payload:{},context:{},node:k};_.children.push(j),B++}f.push.apply(f,w)}var D={parent:i,leaf:[],level:1,node:f[f.length-1],okrLineIndex:r};(d=i.node.children).push.apply(d,f),i.leaf.push(D);break;default:var A=E({type:p.B.TEXT,text:y.InputPipe.createEmptyClientVars()}),P={parent:i,leaf:[],level:1,node:A,okrLineIndex:r};i.node.children.push(A),i.leaf.push(P)}})),r.children};function T(e){return{node:x(),data:{type:p.B.OBJECTIVE,text:Object(m.q)(Object(m.e)(Object(h.K)(e.content))),objective_info:{id:e.id,confidential:e.confidential,pos:e.pos,deadline:e.deadline||0,score:e.score,visible:e.visible,weight:e.weight,progress_rate:{mode:e.progress_rate.mode,current:e.progress_rate.current,percent:e.progress_rate.percent,progress_status:e.progress_rate.progress_status,start:e.progress_rate.start,status_type:e.progress_rate.status_type,target:e.progress_rate.target}},locked:!0},payload:{},context:{},children:e.kr_infos.map((function(e){return function(e){return{node:x(),data:{type:p.B.KEY_RESULT,text:Object(m.q)(Object(m.e)(Object(h.K)(e.content))),kr_info:{id:e.id,confidential:e.confidential,pos:e.pos,deadline:e.deadline||0,score:e.score,visible:e.visible,weight:e.weight,progress_rate:{mode:e.progress_rate.mode,current:e.progress_rate.current,percent:e.progress_rate.percent,progress_status:e.progress_rate.progress_status,start:e.progress_rate.start,status_type:e.progress_rate.status_type,target:e.progress_rate.target}},locked:!0},payload:{},context:{},children:[(n=e.progress_content,{node:x(),data:{type:p.B.PROGRESS,text:y.InputPipe.createEmptyClientVars()},payload:{},context:{},children:B(n)})]};var n}(e)}))}}function w(e){return{node:x(),data:{type:p.B.OKR,text:y.InputPipe.createEmptyClientVars(),okr_info:{id:e.id,people_user_id:e.people_user_id,period_display_status:e.period_display_status,period_name_en:e.period_name_en,period_name_zh:e.period_name_zh,settings:{progress_rate_setting:e.settings.progress_rate_setting,enable_score_o_without_kr:e.settings.enable_score_o_without_kr,enable_score:e.settings.enable_score,weight_target:e.settings.weight_target},source:3,sync_time:0,tenant_id:e.tenant_id,user_id:e.user_id,version:2,visible_settings:{fill_visible:e.visible_settings.fill_visible,progress_status_visible:e.visible_settings.progress_status_visible,score_visible:e.visible_settings.score_visible}},locked:!0},alive:!0,payload:{},context:{},children:e.objective_infos.map((function(e){return T(e)}))}}},dx_S1iY:function(e,n,r){"use strict";(function(t){r.d(n,"D",(function(){return s}));var e=r("dx_UtDZ"),o=r("dx_cDcd"),i=r("dx_h74D"),c=r("dx_bUYd"),a=r("dx_yzqx"),l="DOCX_NETWORK_TOAST_KEY",s=function(){var n=Object(i.useSelector)(e.selectors.network.selectNetworkState).connected,r=Object(o.useRef)(!1);return Object(o.useEffect)((function(){r.current?function(n){a.S.isMobile||(n?e.Toast.remove(l):Object(c.v)({key:l,content:t("common.disconnected_tips"),duration:0,closable:!0}))}(n):r.current=!0}),[n]),n}}).call(this,r("dx_E9Eu"))},dx_S1lH:function(e,n,r){"use strict";r.d(n,"N",(function(){return s})),r.d(n,"C",(function(){return u}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_n4v0");function a(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function l(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?a(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function s(e,n){return Object(c.D)(l({level:1,folded:!1},e),n)}function u(e,n){return s(l({seq:"auto"},e),n)}},dx_S3cA:function(e,n,r){"use strict";function o(){return function(e){var n;return(null===(n=window.clientFeatures)||void 0===n?void 0:n[e])||!1}("ccm.docx.auto_space_enabled")}r.d(n,"A",(function(){return o}))},dx_S5Se:function(e,n,r){"use strict";r.d(n,"J",(function(){return f})),r.d(n,"E",(function(){return h})),r.d(n,"Y",(function(){return p})),r.d(n,"e",(function(){return v})),r.d(n,"h",(function(){return g})),r.d(n,"U",(function(){return b})),r.d(n,"u",(function(){return y})),r.d(n,"s",(function(){return m})),r.d(n,"JQ",(function(){return _})),r.d(n,"W",(function(){return x}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_QxNg"),s=r("dx_h6a8"),u=r("dx_B28d"),d=r("dx_fCRr");function f(e,n){var r=e.getBlockModelByBlockId(n[0]),o=e.getBlockModelByBlockId(n[n.length-1]);if(o.position-r.position+1!==n.length){var i=r.parent;return i?i.children.slice(r.position,o.position+1).filter((function(e){return u.o.includes(e.type)})).map((function(e){return e.id})):n}return n}function h(e,n){var r=n.ops.filter(l.X);if(1===r.length){var o=r[0].action.li;if(o){var i=e.getBlockModelsByRecordId(o),c=a()(i,1)[0];if(c&&0===c.position)return{isNextSiblingOrderedHeaderNotToBeMerge:!1}}}return{isNextSiblingOrderedHeaderNotToBeMerge:!0}}function p(e,n){var r=n.ops.filter(l.X).map((function(e){return e.action.li})).sort((function(n,r){var o=e.getBlockModelsByRecordId(n)[0],i=e.getBlockModelsByRecordId(r)[0];return o?i?o.position-i.position:-1:1})),o=r.filter((function(n){return e.recordManager.hasRecord(n)&&e.getRecord(n).snapshot.type===u.B.ORDERED})),i=o.map((function(n){return e.getBlockIdsByRecordId(n)[0]})).filter(Boolean);return{recordIds:r,orderedRecordIds:o,orderedBlockIds:i}}function v(e,n){var r=n.ops.filter(l.ZH).sort((function(e,n){return e.p[1]-n.p[1]})).map((function(e){return e.action.ld})),o=r.filter((function(n){return e.getRecord(n).snapshot.type===u.B.ORDERED})),i=o.map((function(n){return e.getBlockIdsByRecordId(n)[0]})).filter(Boolean);return{recordIds:r,orderedRecordIds:o,orderedBlockIds:i}}function g(e,n){var r=[],o=n.ops,c=0,a=[];return e.forEach((function(e,n){var l=o.find((function(n){return n.action.ld===e}));0===n||(null===l||void 0===l?void 0:l.p[1])===c?a.push(e):(r.push(i()(a)),a=[e]),c=null===l||void 0===l?void 0:l.p[1]})),a.length&&r.push(i()(a)),r}function b(e,n){n.forEach((function(n,r){e.set(r,n)}))}function y(e){return Object(s.flatMap)(e,(function(e){return e.ops.filter(l.X)}))}function m(e){return Object(s.flatMap)(e,(function(e){return e.ops.filter(l.ZH)}))}function _(e,n){var r=n.indexOf(d.R.REMOVE),o=-1!==r?r:e.length,i=e.slice(0,o),c=e.slice(o);return{insertRecordOps:i,removeRecordOps:c,insertOps:y(i),removeOps:m(c)}}function k(e){var n=function(e){return Object(s.flatMap)(e,(function(e){return e.ops.filter(l.P)}))}(e);return n.some((function(e){return"seq"===e.p[0]&&"auto"!==e.action.od}))}function O(e){var n=function(e){return Object(s.flatMap)(e,(function(e){return e.ops.filter(l.y)}))}(e);return n.some((function(e){return"seq"===e.p[0]&&"auto"!==e.action.oi}))}function x(e,n,r){if(Object(s.isString)(n[0])){var o=n.map((function(e){return r.getRecord(e)}));return i()(o).reverse().find((function(e){return!!e.snapshot.seq&&"auto"!==e.snapshot.seq}))}return O(e)||k(e)}},dx_S6dX:function(e,n,r){"use strict";r.d(n,"K",(function(){return h})),r.d(n,"f",(function(){return p})),r.d(n,"e",(function(){return v})),r.d(n,"s",(function(){return g})),r.d(n,"r",(function(){return b})),r.d(n,"c",(function(){return y})),r.d(n,"h",(function(){return m})),r.d(n,"I",(function(){return _})),r.d(n,"w",(function(){return k})),r.d(n,"E",(function(){return O}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_QILm"),a=r.n(c),l=r("dx_h6a8"),s=r("dx_nQiu"),u=r("dx_Mzjv");function d(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function f(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?d(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function h(e,n){var r=e.left,o=e.top,i=e.right,c=e.bottom,a=n.left,l=n.top,s=n.right,u=n.bottom;return r===a&&o===l&&i===s&&c===u}function p(){var e=window.getSelection();if(!e||!e.anchorNode||!e.focusNode)return null;var n=e.anchorNode.compareDocumentPosition(e.focusNode),r=!n&&e.anchorOffset>e.focusOffset||n===Node.DOCUMENT_POSITION_PRECEDING,o=document.createRange();return o.setStart(e.focusNode,Math.max(0,r?e.focusOffset:e.focusOffset-1)),o.setEnd(e.focusNode,Math.max(0,e.focusOffset)),o}var v=function(){return{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}};function g(e){var n=e.positionInfo,r=e.sticky,o=a()(e,["positionInfo","sticky"]);if(!r)return n;r=Object(l.isArray)(r)?r:[!0,!0];var i=m(f(f({},o),{},{positionInfo:n}));return Object.keys(i).forEach((function(e){i[e]<0||("top"!==e&&"bottom"!==e||r[1]&&r[1]===e)&&("left"!==e&&"right"!==e||r[0])&&(Object(l.isUndefined)(n[e])?n[function(e){switch(e){case"top":return"bottom";case"bottom":return"top";case"left":return"right";case"right":return"left";default:return""}}(e)]-=i[e]:n[e]+=i[e])})),n}function b(e){var n=e.targetRect,r=e.contentRect,o=e.direction,i=e.offsetInfo,c=e.viewportInfo,a=c.width,l=c.height,s=e.bodyRect;switch(o){case u.R.LeftTextCenter:return{right:a-n.x+i[0]+s.left,top:n.y-i[1]-r.height/2-s.top};case u.R.RightTextCenter:return{left:n.x+n.width+i[0]-s.left,top:n.y-i[1]-r.height/2-s.top};case u.R.LeftCenter:return{right:a-n.x+i[0]+s.left,top:n.y-i[1]-(r.height-n.height)/2-s.top};case u.R.RightCenter:return{left:n.x+n.width+i[0]-s.left,top:n.y-i[1]-(r.height-n.height)/2-s.top};case u.R.BottomLeft:return{top:n.y+n.height+i[1]-s.top,left:n.x+i[0]-s.left};case u.R.TopLeft:return{bottom:l-n.y+i[1]+s.top,left:n.x+i[0]-s.left};case u.R.BottomCenter:return{top:n.y+n.height+i[1]-s.top,left:n.x+i[0]+(n.width-r.width)/2-s.left};case u.R.TopCenter:return{bottom:l-n.y+i[1]+s.top,left:n.x+i[0]+(n.width-r.width)/2-s.left};case u.R.None:default:return{left:-1,top:-1}}}function y(e){switch(e){case u.R.LeftTextCenter:return u.R.RightTextCenter;case u.R.RightTextCenter:return u.R.LeftTextCenter;case u.R.LeftCenter:return u.R.RightCenter;case u.R.BottomLeft:return u.R.TopLeft;case u.R.TopLeft:return u.R.BottomLeft;case u.R.BottomRight:return u.R.TopRight;case u.R.TopRight:return u.R.BottomRight;case u.R.BottomCenter:return u.R.TopCenter;case u.R.TopCenter:return u.R.BottomCenter;case u.R.None:default:return u.R.None}}function m(e){var n=e.contentRect,r=e.positionInfo,o=e.viewportInfo,i=e.boundaryRect,c=e.bodyRect,a=Object(l.isUndefined)(r.left)?i.left+r.right+n.width-o.width:i.left-r.left,s=Object(l.isUndefined)(r.left)?o.width-r.right-i.left-i.width:r.left+n.width-i.left-i.width,u=Object(l.isUndefined)(r.top)?i.top+r.bottom+n.height-o.height:i.top-r.top,d=Object(l.isUndefined)(r.top)?o.height-r.bottom-i.top-i.height:r.top+n.height-i.top-i.height;return{left:a,right:s,top:u-c.top,bottom:d+c.top}}function _(e,n){return n.height<=2*s.Y?e.y>n.top+n.height/2?u.c.Bottom:u.c.Top:e.y<=n.top+s.Y?u.c.Top:e.y>=n.top+n.height-s.Y?u.c.Bottom:u.c.Middle}function k(e){return 0===e.x&&0===e.y&&0===e.width&&0===e.height}function O(e){return 0!==e.width||0!==e.height}},dx_S6zS:function(e,n,r){"use strict";(function(t){r.d(n,"y",(function(){return R}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_iWIM"),f=r.n(d),h=r("dx_W7W2"),p=r.n(h),v=r("dx_a1gu"),g=r.n(v),b=r("dx_Nsbk"),y=r.n(b),m=r("dx_LcNA"),_=r("dx_clPT"),k=r("dx_d7d4"),O=r("dx_o8x0"),x=r("dx_PcQO"),E=r("dx_AA3h"),S=r("dx_yzqx"),C=r("dx_by6m"),I=r("dx_nddJ"),B=r("dx_F0qy"),T=r("dx_bPy9");function w(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=y()(e);if(n){var i=y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return g()(this,r)}}var R=function(e){p()(r,e);var n=w(r);function r(e){var i;return l()(this,r),(i=n.call(this,e)).block=void 0,i.docxHighlightController=void 0,i.hasIdentified=void 0,i.asyncCalc=void 0,i.handleContentChange=function(e){if(!i.hasIdentified){var n=e.options,r=e.previous,o=e.current,c=n.type,a=r.getZoneState(Object(T.v)(i.block.id)),l=o.getZoneState(Object(T.v)(i.block.id));a&&l&&"pasteTextIntoTextualBlock"===c&&a.isEmpty()&&!l.isEmpty()&&i.getLanguage()===_.E&&i.docxHighlightController.identifyCodeLanguage(i.block.id).then((function(e){var n=e.language;return i.hasIdentified=!0,i.setLanguage(n)})).catch((function(e){console.warn(e)}))}},i.handleScroll=function(){i.block.handleScroll()},i.setLanguage=function(){var e=c()(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.setItem(_.i,n),e.next=3,i.block.blockManager.applyTransaction("codeblock:set-lang",(function(e){return e.replace(i.block.record.id,["language"],n)}));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i.handleLanguageChange=function(e){i.setLanguage(e),Object(C.w)(I.G.codeLanguageSwitch,i.block,i.block.blockManager,{actionValue:{value1:e}})},i.handleWrapChange=function(){Object(C.w)(I.G.codeAutoWrap,i.block,i.block.blockManager,{actionValue:{value1:String(!i.getWrap())}}),setTimeout((function(){i.block.blockManager.applyTransaction("codeblock:set-wrap",(function(e){return e.replace(i.block.record.id,["wrap"],!i.block.model.record.snapshot.wrap)}))}),100)},i.handleCopy=function(){var e,n;i.isEmptyCode||(null===(e=i.block.editorContext.clipboard)||void 0===e||e.copyBlockText(i.block.id),S.S.isMobile&&S.S.isBytedanceApp?E.toastHelper.showToast({type:E.toastHelper.EToastType.SUCCESS,message:t("common.copied"),duration:1}):x.toast.success({type:"success",content:t("common.copied")}),Object(C.w)(I.G.codeCopy,i.block,i.block.blockManager),i.block.selectionAPI.removeAllSelection(),null===(n=window.getSelection())||void 0===n||n.removeAllRanges())},i.showMobileLanguagePicker=function(){window.lark.biz.util.selectCodeBlockLanguage({value:i.getLanguage()||_.E,list:k.l,callback:function(e){var n=e.value;i.handleLanguageChange(n)}})},i.onMouseDownHeader=function(e){var n;S.S.isMobile&&(e.stopPropagation(),e.preventDefault(),i.block.selectionAPI.removeAllSelection(),null===(n=window.getSelection())||void 0===n||n.removeAllRanges())},i.block=e.block,i.asyncCalc=e.asyncCalc,i.hasIdentified=!1,i}return u()(r,[{key:"componentDidMount",value:function(){f()(y()(r.prototype),"componentDidMount",this).call(this);var e=this.block,n=e.editor,o=e.blockManager;this.docxHighlightController=new B.t({editor:n,blockManager:o,blockId:this.block.id}),this.isEmptyCode&&this.getLanguage()===_.E||(this.hasIdentified=!0)}},{key:"componentWillUnMount",value:function(){f()(y()(r.prototype),"componentWillUnmount",this).call(this),this.docxHighlightController.reset()}},{key:"highlightBlock",value:function(e){this.asyncCalc?this.docxHighlightController.highlightBlock(e):this.docxHighlightController.highlightBlockWithRIC(e)}},{key:"bindEvent",value:function(e){f()(y()(r.prototype),"bindEvent",this).call(this,e);var n=this.props.editor;e&&!this.hasIdentified?n.on(m.L.CONTENT_CHANGE,this.handleContentChange):n.off(m.L.CONTENT_CHANGE,this.handleContentChange)}},{key:"handleRemainWindowResize",value:function(){f()(y()(r.prototype),"handleRemainWindowResize",this).call(this),this.block.calcScrollStateToVc()}},{key:"codeModel",get:function(){return this.block.blockManager.getBlockModelByBlockId(this.block.id)}},{key:"codeText",get:function(){return this.codeModel.getText()}},{key:"isEmptyCode",get:function(){return"\n"===this.codeText}}]),r}(O.B)}).call(this,r("dx_E9Eu"))},dx_S8Sa:function(e,n,r){"use strict";r.d(n,"S",(function(){return M}));var o,i,c,a,l=r("dx_J4zp"),s=r.n(l),u=r("dx_yG8O"),d=r.n(u),f=r("dx_lwsE"),h=r.n(f),p=r("dx_W8MJ"),v=r.n(p),g=r("dx_PJYZ"),b=r.n(g),y=r("dx_W7W2"),m=r.n(y),_=r("dx_a1gu"),k=r.n(_),O=r("dx_Nsbk"),x=r.n(O),E=r("dx_Uyc2"),S=r.n(E),C=(r("dx_A1AB"),r("dx_xjz2")),I=r("dx_cDcd"),B=r.n(I),T=r("dx_Vau3"),w=r("dx_Frpz");function R(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=x()(e);if(n){var i=x()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return k()(this,r)}}var M=(o=Object(C.S)(),a=function(e){m()(r,e);var n=R(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return e=n.call.apply(n,[this].concat(i)),d()(e,"syncCursorSelectState",c,b()(e)),e}return v()(r,[{key:"getWrapper",value:function(e){var n=this;return function(r){var o,i=r.model,c=n.syncCursorSelectState,a=Object(I.useState)((function(){return null===c||void 0===c?void 0:c.get(i.id)})),l=s()(a,2),u=l[0],d=l[1];return Object(I.useEffect)((function(){var e=function(e){d(e)};return null===c||void 0===c||c.onStateChange(i.id,e),function(){null===c||void 0===c||c.offStateChange(i.id,e)}}),[c,i]),B.a.createElement(e,Object.assign({},r,{syncCursorSelected:null!==(o=null===u||void 0===u?void 0:u.selected)&&void 0!==o&&o,syncCursorBorderColor:null===u||void 0===u?void 0:u.borderColor,syncCursorBgColor:null===u||void 0===u?void 0:u.bgColor}))}}}]),r}(T.A),i=a,c=S()(i.prototype,"syncCursorSelectState",[o,w.W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i)},dx_SDvP:function(e,n,r){"use strict";r.d(n,"j",(function(){return S})),r.d(n,"S",(function(){return C}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_UtDZ"),b=r("dx_cDcd"),y=r.n(b),m=r("dx_Vau3"),_=r("dx_D8nn"),k=r("dx_Mzjv"),O=r("dx_z3zX"),x=r("dx_J3jD");function E(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var S="OPEN_MENTION_SHARE",C=function(e){d()(r,e);var n=E(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"getWrapper",value:function(e){var n=this;return function(r){var o=y.a.useState(),c=i()(o,2),a=c[0],l=c[1],s=y.a.useState(),u=i()(s,2),d=u[0],f=u[1],h=y.a.useState(),p=i()(h,2),v=p[0],m=p[1],E=y.a.useRef(null),C=Object(b.useCallback)((function(){l(null),f(null),m(null)}),[]),I=Object(b.useCallback)((function(){E.current&&window.clearTimeout(E.current)}),[]),B=Object(b.useCallback)((function(){I(),C()}),[I,C]),T=Object(b.useCallback)((function(e,n){if(n&&n.token&&e&&n.componentId&&n.title){var r=e.hostElement.querySelector('[data-component-id="'.concat(n.componentId,'"]'));r&&(I(),E.current=window.setTimeout(C,4e3),l(r),f(n),m(e))}}),[C]);Object(b.useEffect)((function(){return n.blockManager.addListener(S,T),function(){n.blockManager.removeListener(S,T)}}),[]),Object(b.useEffect)((function(){return _.S.on(_.p.COMMON.CLOSE_MENTION_SHARE_PANEL,C),function(){_.S.off(_.p.COMMON.CLOSE_MENTION_SHARE_PANEL,C)}}),[C]);var w=Object(b.useCallback)((function(e){e.target&&g.domHelper.parents(e.target,"mention-share-container")||C()}),[C]);return Object(b.useEffect)((function(){return document.addEventListener("mousedown",w),function(){document.removeEventListener("mousedown",w)}}),[w]),y.a.createElement(y.a.Fragment,null,y.a.createElement(e,r),a&&d&&v?y.a.createElement(O.S,{visible:!0,blockManager:n.blockManager,reverse:!0,boundary:n.boundary,selectionAPI:n.selectionAPI,target:a,direction:k.R.TopCenter,onClose:C,sticky:[!0,!1]},y.a.createElement("div",{className:"mention-share-container",onMouseEnter:function(){I()},onMouseLeave:function(){I(),E.current=window.setTimeout(C,2e3)}},y.a.createElement(x.k,{showType:"insert",token:d.token,type:g.MENTION_TO_SUITE[d.mentionType]||d.mentionType,title:d.title,onClickShare:B}))):null)}}}]),r}(m.A)},dx_SGLR:function(e,n,r){"use strict";r.d(n,"Z",(function(){return l})),r.d(n,"n",(function(){return s}));var o=r("dx_Je9X"),i=r("dx_D8nn"),c=r("dx_BBFf");function a(e){return e===c.I.NORMAL}function l(e,n){a(n)&&i.S.trigger(o.F.COVER_INTERSECTION_CHANGE,[{scene:n,height:Math.floor(e)}])}function s(e,n){var r;if(a(n)){e<0&&(e=0);var i=null===(r=document.querySelector(o.C))||void 0===r?void 0:r.getBoundingClientRect();!i||(null===i||void 0===i?void 0:i.bottom)<0||l(e,n)}}},dx_SIER:function(e,n,r){},dx_SMoc:function(e,n,r){"use strict";r.d(n,"h",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("docs-mode-adapter")},dx_SOoV:function(e,n,r){"use strict";var o;r.d(n,"n",(function(){return o})),function(e){e[e.ELEMENT=1]="ELEMENT",e[e.TEXT=3]="TEXT"}(o||(o={}))},dx_SUdB:function(e,n,r){"use strict";r.d(n,"U",(function(){return f})),r.d(n,"p",(function(){return h})),r.d(n,"n",(function(){return p})),r.d(n,"l",(function(){return v})),r.d(n,"I",(function(){return g})),r.d(n,"b",(function(){return b})),r.d(n,"F",(function(){return y}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_QILm"),a=r.n(c),l=r("dx_yzqx");function s(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function u(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?s(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var d=-1!==window.navigator.userAgent.indexOf("Macintosh")||l.S.isIPad,f=d?"metaKey":"ctrlKey",h="Ctrl",p="Shift",v=d?"\u2325":"Alt",g="\u2318",b=d?g:"Ctrl";function y(e){return e.map((function(e){var n=!!(e.ctrlKey||!d&&e.metaCtrlKey),r=!!(e.metaKey||d&&e.metaCtrlKey),o=(e.metaCtrlKey,e.metaKey,a()(e,["metaCtrlKey","metaKey"]));return u(u({shiftKey:!1,altKey:!1},o),{},d?{metaKey:r,ctrlKey:n}:{ctrlKey:n})}))}},dx_SXeD:function(e,n,r){"use strict";r.d(n,"Y",(function(){return f})),r.d(n,"E",(function(){return h})),r.d(n,"X",(function(){return p})),r.d(n,"n",(function(){return v})),r.d(n,"l",(function(){return g})),r.d(n,"G",(function(){return b})),r.d(n,"m",(function(){return y})),r.d(n,"k",(function(){return m})),r.d(n,"y",(function(){return _})),r.d(n,"V",(function(){return k}));var o=r("dx_UtDZ"),i=r("dx_h6a8"),c=r("dx_v7vG"),a=r("dx_M7MP"),l=r("dx_hoya"),s=r("dx_d6al"),u=o.feelgoodHelper.tryShowDocxFeelgood,d=o.feelgoodHelper.disableDocxFeelgood;function f(e,n){return Object(l.r)()?e&&n:e||n}function h(){o.resourceSchedulerHelpers?o.resourceSchedulerHelpers.scheduler.addTask({name:"DocxFeelgood",action:function(){return new Promise((function(e){u(),e(!0)}))}}):u()}function p(){d()}function v(e,n){var r=e.scroller;if(!r)return n;if("string"===typeof r){var o=".".concat(r);return n.closest(o)||n}return r.current||n}function g(e,n){return v(e,n)}function b(){Object(i.noop)()}function y(){Object(i.noop)()}function m(e,n,r){if(window.__SSR__||r.isInWiki){var i=document.querySelector(".scrollbar-container.etherpad-container-wrapper"),l=null===i||void 0===i?void 0:i.scrollTop;Object(s.v)();var u=Date.now();Object(a.p)((function(e){var n=Date.now();c.S.collectRemoveSSRRAFDuration(n-u,e)}),0),setTimeout((function(){var e,i=Date.now();if(c.S.collectRemoveSSRTimeoutDuration(i-u),r.isInWiki?null===o.removeWikiSSR||void 0===o.removeWikiSSR||Object(o.removeWikiSSR)("docx"):null===(e=window.__SSR__)||void 0===e||e.clean(),c.S.collectRemoveSSRSuccessByNextRender({current:i}),l&&!r.locate){var a=l-n.getContentAboveRootHeight();n.getViewportHelper().setScrollTop(a)}}))}}var _=function(e){o.noticeMsgHandler.register(o.ENTITY_TYPE.DOCX,e.props.token)},k=function(e){o.noticeMsgHandler.deregister()}},dx_SZT7:function(e,n,r){"use strict";r.d(n,"H",(function(){return i}));var o=r("dx_yzqx"),i={leftMargin:106,rightMargin:o.Z.isLark&&!o.Z.isInVC?60:40,showScrollbarOnHover:!0,sliderHeight:7,sliderMinWidth:24,sliderToBottom:3,enableSliderDragging:!0}},dx_Sa3H:function(e,n,r){"use strict";var o=r("dx_BaZy"),i=r.n(o)()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_zBt0"))},loading:function(){return null}});n.S=i},dx_SbhA:function(e,n,r){"use strict";r.d(n,"D",(function(){return T}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_B28d"),g=r("dx_L0LN"),b=r("dx_N9dL"),y=r("dx_S1lH");function m(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var _=function(e){s()(r,e);var n=m(r);function r(e){return i()(this,r),n.call(this,e)}return r}(r("dx_KHvq").H);_.type=v.B.ORDERED;var k,O,x=r("dx_xjz2"),E=r("dx_tt0H"),S=r("dx_JXmB"),C=Object(x.s)(E.U)(k=function e(){i()(this,e),this.blockType=v.B.ORDERED,this.checkFunc=S.M})||k,I=r("dx_Nl4O");function B(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var T=Object(p.H)({providers:[C,{provide:b.RecordSnapshotCreator,useValue:{type:v.B.ORDERED,create:y.C}}]})(O=function(e){s()(r,e);var n=B(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"blocks",get:function(){return[[_,{viewCreator:I.B,options:this.options.getTextEditorOptions()}]]}}]),r}(g.h))||O},dx_SeGt:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return R}));var e=r("dx_lSNA"),o=r.n(e),i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_W7W2"),p=r.n(h),v=r("dx_a1gu"),g=r.n(v),b=r("dx_Nsbk"),y=r.n(b),m=r("dx_UtDZ"),_=r("dx_bUYd"),k=r("dx_T3tg"),O=r("dx_eGDr"),x=r("dx_Ayao"),E=r("dx_D8nn"),S=r("dx_A8lo"),C=r("dx_Rr9s");function I(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function B(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?I(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function T(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=y()(e);if(n){var i=y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return g()(this,r)}}var w="scrollToMessagePosition",R=function(e){p()(r,e);var n=T(r);function r(){var e;return u()(this,r),(e=n.call(this)).handleSetListMethod=function(n){var r=n.setMessagePositions;e.setMessagePositions=r},e.handleEditorMount=function(n){var r=n.blockManager,o=n.viewport;e.blockManager=r,e.viewport=o,e.isEditorMount=!0},e.handleNoticeCenterMsg=function(){var n=l()(c.a.mark((function n(r){var o,i;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=r.comment_id,i=r.mention_id,!o){n.next=4;break}return e.activateComment(r),n.abrupt("return");case 4:if(!i){n.next=7;break}return e.activateMention(r),n.abrupt("return");case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.activateComment=function(){var n=l()(c.a.mark((function n(r){var o,i,a,l,s,u,d,f;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o=r.notice_type,i=r.comment_id,a=r.reply_id,l=r.reaction_key,s=r.from_user.user_id,u=e.commentModule.getCommentByCommentId(i),!(6===o&&l&&s&&a&&u)){n.next=8;break}if(d=u.replyList,f=d.find((function(e){return e.replyId===a})),f.reactions.find((function(e){return e.reactionKey===l&&e.userList.find((function(e){return e.userId===s}))}))){n.next=8;break}return n.abrupt("return",e.showDeletedToast(t("CreationDoc_Common_Notifications_ReactionCanceled_toast")));case 8:if(!(null===u||void 0===u?void 0:u.isWhole)){n.next=14;break}if(!u||!u.finished){n.next=12;break}return Object(_.y)({key:"FEED_NOTIFICATION_LOADING",type:"info",duration:1e3,closable:!0,content:t("CreationDoc_Common_Notifications_CommentResolved_toast")}),n.abrupt("return");case 12:return e.commentModule.highlightWholeComment(i,a,{withScroll:!0}),n.abrupt("return");case 14:e.tryToActiveComment(i,0,{replyId:a,reactionKey:l,userId:s});case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.activateMention=function(){var n=l()(c.a.mark((function n(r){var o,i,a,l,s,u;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=null===(o=e.blockManager)||void 0===o?void 0:o.editorAPI.getService(k.e),e.isAllDataReady&&e.isEditorMount&&e.blockManager){n.next=4;break}return null===i||void 0===i||i.startApplyAllMode(),n.abrupt("return");case 4:return a=r.mention_id,l=r.extra,s=l,l&&"string"===typeof l&&(s=JSON.parse(l)),n.next=9,S.c.find(a,s,e.blockManager,"pc-web");case 9:if(u=n.sent,null===i||void 0===i||i.stopApplyAllMode(),void 0!==u){n.next=14;break}return e.showToast(),n.abrupt("return");case 14:S.c.scroll(B(B({},u),{},{mentionId:a,extra:l,mentionOffsetTop:0}),{viewport:e.viewport,blockManager:e.blockManager},e.showToast,"pc-web");case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.showToast=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];m.Toast.remove(C.C),m.Toast[e?"info":"error"]({key:C.C,duration:1e3,closable:!0,content:t("feed.mention_deleted")})},e.setCommentModule=function(n){var r=n.scroller,o=n.commentModule;e.scroller=r,e.commentModule=o,E.S.on(x.M.COMMENT_POSITION_CHANGE_PC,e.handleCommentPositionChange)},e.destroy=function(){var n;null===(n=e.controller)||void 0===n||n.destroy(),e.controller=null,m.EventEmitter.off(w,e.handleNoticeCenterMsg),E.S.off(x.M.COMMENT_POSITION_CHANGE_PC,e.handleCommentPositionChange)},e.defaultClickedCommentSource=O.M.noticeCenter,e.controller=new m.MessageController(m.EventEmitter),e.controller.onSetListMethod(e.handleSetListMethod),m.EventEmitter.on(w,e.handleNoticeCenterMsg),e}return f()(r,[{key:"handleAllDataReady",value:function(){this.isAllDataReady=!0,this.retryCommentClick()}}]),r}(C.S)}).call(this,r("dx_E9Eu"))},dx_Sj0J:function(e,n,r){"use strict";r.d(n,"d",(function(){return f})),r.d(n,"Q",(function(){return p})),r.d(n,"N",(function(){return v})),r.d(n,"A",(function(){return g}));var o=r("dx_J4zp"),i=r.n(o),c=(r("dx_RIqP"),r("dx_LcNA")),a=r("dx_uZlF"),l=r("dx_h6a8"),s=r("dx_cDcd"),u=r.n(s),d=(r("dx_bPy9"),r("dx_kZ3l"));function f(e,n){var r=e.model.zoneState,o=r.getEntities([]).filter((function(e){var r={text:e.text,mark:e.attributes};return n(r)}));if(0===o.length)return d.j(e,[0,r.totalWidth()-1]);var i=r.pointToOffset(o[0].start)||0,c=r.pointToOffset(o[o.length-1].end)||0;return d.j(e,[i,c])}function h(e,n){var r={start:{line:0,offset:0},end:{line:e.length(),offset:e.getLine(e.length()-1).length()}};return e.getEntities(r).filter((function(e){var r=e.attributes;return!!r&&Object(l.isMatch)(r,n)}))}function p(e,n){var r=e.model.zoneState,o=h(r,n);return 0===o.length?null:[r.pointToOffset(o[0].start)||0,r.pointToOffset(o[o.length-1].end)||0]}function v(e,n){var r,o=e.model.zoneState,i=h(o,n),c=(r=0===i.length?new a.A({editor:e.editor,start:{zoneId:o.getZoneId(),line:0,offset:0},end:{zoneId:o.getZoneId(),line:o.length()-1,offset:o.getLine(o.length()-1).length()-1},state:o}):new a.A({editor:e.editor,start:i[0].start,end:i[i.length-1].end,state:o})).toPosition.bind(r);return r.toPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return c(e)},r}function g(e,n){var r=u.a.useState([0,0]),o=i()(r,2),a=o[0],s=o[1],f=u.a.useCallback((function(){var r=d.S(v(e,n));Object(l.isEqual)(r,a)||s(r)}),[e,n,a]);return u.a.useEffect((function(){if(e&&e.editor&&!e.model.isDestroyed){var n=e.model.zoneId;return e.editor.on(c.L.CONTENT_CHANGE,f,{zoneId:n}),f(),function(){e.editor.off(c.L.CONTENT_CHANGE,f)}}}),[e,f]),a}},dx_Skfo:function(e,n,r){"use strict";(function(t){r.d(n,"L",(function(){return h}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_FBWK"),l=r("dx_UtDZ"),s=r("dx_E7EG"),u=r("dx_cDcd"),d=r.n(u),f=r("dx_nq8x");function h(e){return p.apply(this,arguments)}function p(){return(p=c()(o.a.mark((function e(n){var r,i,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.guid,i=n.text,c=n.onClick,l.Toast.show({content:d.a.createElement("span",null,i,r&&d.a.createElement("span",{style:{color:Object(a.getThemeColorByToken)("B500"),marginLeft:10,cursor:"pointer"},onClick:function(e){e.stopPropagation(),e.nativeEvent.stopPropagation();var n=Object(s.S)(window,"globalConfig.common.domain.applink",{});Object(f.n)("https://".concat(n,"/client/todo/detail?guid=").concat(r,"&mode=app")),null===c||void 0===c||c(e)}},t("CreationDoc_ToDo_Go"))),duration:3e3,key:"toastCreateTodoSuccess",type:"success"});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}).call(this,r("dx_E9Eu"))},dx_SkpS:function(e,n,r){"use strict";r.d(n,"Z",(function(){return x}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_UtDZ"),d=r("dx_h6a8"),f=r("dx_zEdG"),h=r("dx_s1qv"),p=r("dx_FHaN"),v=r("dx_h0h1"),g=r("dx_bPy9"),b=r("dx_kZ3l"),y=r("dx_D8nn"),m=r("dx_c3cO"),_=r("dx_ZMwq");function k(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function O(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?k(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var x=new(function(){function e(){var n=this;a()(this,e),this.block=null,this.reminderInfo=null,this.popoverType=null,this.isMouseInReminderPopover=!1,this.reminderRef=null,this.users=[],this.isPopoverVisible=!1,this.debounceHideSimplePopover=Object(d.debounce)((function(){n.triggerClosePopoverEvent()}),m.M,{trailing:!0}),this.debounceShowSimplePopover=Object(d.debounce)((function(){n.triggerOpenPopoverEvent()}),m.g,{trailing:!0}),this.onMouseEnterPopover=function(){n.assert(),n.isMouseInReminderPopover=!0,n.popoverType===_.E.Simple&&n.debounceHideSimplePopover.cancel()},this.onMouseLeavePopover=function(){n.assert(),n.isMouseInReminderPopover=!1,n.popoverType===_.E.Simple&&n.debounceHideSimplePopover()},this.handleDocumentMouseDown=function(e){if(n.popoverType===_.E.Intact&&n.block&&!n.isMouseInReminderPopover){var r=e.target;if(!(e.target&&r.classList.contains("docx-reminder-inline-component")))if(!(e.target&&u.domHelper.parents(e.target,"docx-reminder-popover")))e.target&&u.domHelper.parents(e.target,"add-reminder")||setTimeout((function(){return n.triggerClosePopoverEvent()}),300)}},this.handleSelectionChange=function(){var e=window.getSelection(),r=null===e||void 0===e?void 0:e.anchorNode;if(r){var o=n.focusNodeIsReminder(r);n.popoverType!==_.E.Intact||o||n.triggerClosePopoverEvent()}}}return s()(e,[{key:"init",value:function(){this.bindEvent()}},{key:"showPopover",value:function(e){var n=e.block,r=e.reminderInfo,o=e.type,i=e.users,c=e.reminderRef;if(this.debounceHideSimplePopover.cancel(),this.block&&this.reminderInfo&&this.popoverType&&this.users&&this.reminderRef&&this.isPopoverVisible){var a={blockId:this.block.id,reminderInfo:this.reminderInfo,type:this.popoverType,users:this.users},l={blockId:n.id,reminderInfo:r,type:o,users:i};if(!Object(d.isEqual)(a,l))return this.setData({block:n,reminderInfo:r,type:o,users:i,reminderRef:c}),void this.triggerUpdatePopoverEvent({prev:a,curr:l})}this.setData({block:n,reminderInfo:r,type:o,users:i,reminderRef:c}),o===_.E.Simple?this.debounceShowSimplePopover():this.triggerOpenPopoverEvent()}},{key:"hidePopover",value:function(e){var n;e===(null===(n=this.reminderInfo)||void 0===n?void 0:n.id)&&this.block&&this.reminderInfo&&this.popoverType&&(this.popoverType===_.E.Simple?(this.debounceShowSimplePopover.cancel(),this.debounceHideSimplePopover()):this.triggerClosePopoverEvent())}},{key:"updatePopover",value:function(e){var n=e.block,r=e.reminderInfo,o=e.users,i=e.reminderRef;if(this.block&&this.reminderInfo&&this.popoverType&&this.isPopoverVisible){if(this.reminderInfo.id!==r.id)return;var c={blockId:this.block.id,reminderInfo:this.reminderInfo,type:this.popoverType,users:this.users},a={blockId:n.id,reminderInfo:r,type:this.popoverType,users:o};Object(d.isEqual)(c,a)||(this.setData({block:n,reminderInfo:r,type:this.popoverType,users:o,reminderRef:i}),this.triggerUpdatePopoverEvent({prev:c,curr:a}))}}},{key:"updateReminder",value:function(e){if(this.assert(),this.block&&this.block.isTextEditable){var n=e.expireTime,r=e.isWholeDay,o=e.notifyTime,i=e.reminderId,c=e.shouldNotify,a=e.action,l=this.block.model.zoneState,s=l.getContent().ops.find((function(e){var n=Object(h.parseInlineComponentDataByNode)(e);return!(!n||n.id!==i)}));if(s){var u,d,y=Object(g.J)(l,s),m={id:i,type:p.k.REMINDER,data:{expire_time:n,is_whole_day:r,should_notify:c,notify_time:o,create_user_id:this.reminderInfo.data.create_user_id}};if(this.setData({block:this.block,reminderInfo:m,type:this.popoverType,users:this.users,reminderRef:this.reminderRef}),Object(v.G)(this.block,Object(b.A)(y),{reminderProps:m,openPopover:!1,focus:!1}),a)Object(f.P)("ccm_doc_reminder_panel_click",{record_id:null===(u=this.block)||void 0===u?void 0:u.record.id,block_type:null===(d=this.block)||void 0===d?void 0:d.type},{click:"click_time_option",target:"none",sub_click:a})}}}},{key:"reset",value:function(){this.block=null,this.reminderInfo=null,this.popoverType=null,this.reminderRef=null,this.isMouseInReminderPopover=!1,this.users=[],this.isPopoverVisible=!1}},{key:"destroy",value:function(){this.reset(),this.unBindEvent(),this.debounceHideSimplePopover.cancel(),this.debounceShowSimplePopover.cancel()}},{key:"setData",value:function(e){var n=e.block,r=e.reminderInfo,o=e.type,i=e.users,c=e.reminderRef;this.block=n,this.users=i,this.reminderInfo=r,this.popoverType=o,this.reminderRef=c}},{key:"bindEvent",value:function(){y.S.on(m.X.POPOVER_MOUSE_ENTER,this.onMouseEnterPopover),y.S.on(m.X.POPOVER_MOUSE_LEAVE,this.onMouseLeavePopover),document.addEventListener("mousedown",this.handleDocumentMouseDown),document.addEventListener("selectionchange",this.handleSelectionChange)}},{key:"unBindEvent",value:function(){y.S.off(m.X.POPOVER_MOUSE_ENTER,this.onMouseEnterPopover),y.S.off(m.X.POPOVER_MOUSE_LEAVE,this.onMouseLeavePopover),document.removeEventListener("mousedown",this.handleDocumentMouseDown),document.removeEventListener("selectionchange",this.handleSelectionChange)}},{key:"focusNodeIsReminder",value:function(e){if(u.domHelper.parents(e,"docx-reminder-popover")||u.domHelper.parents(e,"docx-reminder-inline-component"))return!0;if(!this.block)return!1;var n=this.block.model.getSelection();if(!n)return!1;if(n.start.offset!==n.end.offset||n.start.offset<=0)return!1;var r=this.block.model.zoneState.getEntities({start:O(O({},n.start),{},{offset:n.start.offset-1}),end:n.end});return 0!==r.length&&this.hasReminderAttribute(r[0])}},{key:"hasReminderAttribute",value:function(e){return p.O in e.attributes&&"reminder"===JSON.parse(e.attributes[p.O]).type}},{key:"triggerClosePopoverEvent",value:function(){y.S.emit(m.X.CLOSE_POPOVER),this.reset()}},{key:"triggerOpenPopoverEvent",value:function(){this.isPopoverVisible=!0,y.S.emit(m.X.OPEN_POPOVER)}},{key:"triggerUpdatePopoverEvent",value:function(e){y.S.emit(m.X.UPDATE_POPOVER,e)}},{key:"assert",value:function(){console.assert(this.popoverType,"must have popover type"),console.assert(this.block,"must have block type"),console.assert(this.reminderInfo,"must have reminderInfo"),console.assert(this.users.length,"must have users type"),console.assert(this.reminderRef,"must have reminderRef")}}]),e}())},dx_Sm0n:function(e,n,r){"use strict";r.d(n,"q",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("record-snapshot-creator")},dx_So6W:function(e,n,r){"use strict";(function(t){var e=r("dx_J4zp"),o=r.n(e),i=r("dx_O1SO"),c=r("dx_D4Da"),a=r("dx_PcQO"),l=r("dx_TSYQ"),s=r.n(l),u=r("dx_h6a8"),d=r("dx_cDcd"),f=r.n(d),h=r("dx_Q64Q"),p=r("dx_MZZR"),v=r("dx_m5zM"),g=r("dx_OM1j"),b=r("dx_JM9i"),y=r("dx_cXYu"),m=r("dx_tOIf"),_=(r("dx_nheZ"),"okrx-block-visible-setting");n.S=function(e){var n=e.enableScore,r=e.progressRateVisible,l=e.scoreVisible,k=e.progressVisible,O=e.okrVisibilitySetting,x=e.disabled,E=e.onSettingPopVisibleChange,S=e.onScoreVisibleChange,C=e.onProgressVisibleChange,I=e.onProgressRateVisibleChange,B=e.onKRVisibleChange,T=e.onTiggerClick,w=void 0===T?u.noop:T,R=Object(d.useState)(!1),M=o()(R,2),j=M[0],D=M[1],A=Object(u.some)(O,(function(e){return"KR"===e.type})),P=A&&Object(u.some)(O,(function(e){return!e.visible}))||!l||!k||!r,L=t(n?"CreationDoc_Docs_OKR_Display_Tooltips1":"CreationDoc_Docs_OKR_Display_Tooltips2");return f.a.createElement(a.Tooltip,{title:L,placement:"top",hideAction:["click","blur"],disabled:j},f.a.createElement(a.Popover,{placement:"bottom",trigger:"click",overlayClassName:"".concat(_,"__popover"),visible:j,getPopupContainer:u.identity,onVisibleChange:function(e){x||(D(e),E(e))},content:f.a.createElement("div",{className:"".concat(_,"__wrapper standard-scrollbar common-scrollbar")},f.a.createElement("div",{className:"".concat(_,"__caption")},t("CreationDoc_Docs_OKR_Setting_Function")),f.a.createElement("ul",{className:"".concat(_,"__list")},f.a.createElement("li",{className:s()("".concat(_,"__list-item"),{invisible:!r})},f.a.createElement("span",{className:"".concat(_,"__list-item-icon-box")},f.a.createElement(v.S,{className:"".concat(_,"__list-item-icon ").concat(_,"__list-item-icon_progress")})),f.a.createElement("span",{className:"".concat(_,"__list-item-content")},t("CreationDoc_Docs_OKR_Status")),f.a.createElement(m.U,{visible:r,onVisibleChange:I})),n&&f.a.createElement("li",{className:s()("".concat(_,"__list-item"),{invisible:!l})},f.a.createElement("span",{className:"".concat(_,"__list-item-icon-box")},f.a.createElement(p.S,{className:"".concat(_,"__list-item-icon")})),f.a.createElement("span",{className:"".concat(_,"__list-item-content")},t("CreationDoc_Docs_OKR_Score")),f.a.createElement(m.U,{visible:l,onVisibleChange:S})),f.a.createElement("li",{className:s()("".concat(_,"__list-item"),{invisible:!k||!A})},f.a.createElement("span",{className:"".concat(_,"__list-item-icon-box")},f.a.createElement(i.S,{className:"".concat(_,"__list-item-icon")})),f.a.createElement("span",{className:"".concat(_,"__list-item-content")},t("CreationDoc_Docs_OKR_ProgressField")),A?f.a.createElement(m.U,{visible:k,onVisibleChange:C}):f.a.createElement(a.Tooltip,{title:t("CreationDoc_Docs_OKR_ProgressField_Tooltips"),placement:"top"},f.a.createElement("span",null,f.a.createElement(m.U,{visible:!1,onVisibleChange:u.noop,style:{cursor:"not-allowed",verticalAlign:"top"}}))))),f.a.createElement("div",{className:"".concat(_,"__caption")},t("CreationDoc_Docs_OKR_Setting_KR")),f.a.createElement("ul",{className:"".concat(_,"__list")},O.map((function(e){var n=e.type,r=e.pos,o=e.text,i=e.visible,c=e.objectiveId,a=e.targetId,l=i?"light":"gray",u="KR"===n,d=Object(h.R)(o);return f.a.createElement("li",{className:s()("".concat(_,"__list-kr-item"),{visible:!1}),key:a},f.a.createElement(b.S,{type:n,size:"m",order:r,theme:u?l:"primary",className:s()({visibleKRSeq:i&&u,invisibleKRSeq:!i&&u,objective:!u})}),f.a.createElement(g.w,{className:"".concat(_,"__list-item-content"),content:d},f.a.createElement("span",null,d)),u&&f.a.createElement(m.U,{visible:i,onVisibleChange:function(e){B({objectiveId:c,targetId:a,visible:e})}}))}))))},f.a.createElement(y.C,{icon:f.a.createElement(c.S,null),text:t("CreationDoc_Docs_OKR_Setting_Display_Btn"),isActive:j&&!x,isHighlight:P,style:{marginLeft:"8px"},onClick:w})))}}).call(this,r("dx_E9Eu"))},dx_SpiB:function(e,n,r){"use strict";(function(t){r.d(n,"c",(function(){return s})),r.d(n,"p",(function(){return u})),r.d(n,"i",(function(){return d})),r.d(n,"L",(function(){return f})),r.d(n,"ie",(function(){return h})),r.d(n,"Lj",(function(){return p})),r.d(n,"Z",(function(){return v}));var e,o=r("dx_lSNA"),i=r.n(o),c=r("dx_RIqP"),a=r.n(c),l=r("dx_B28d"),s={categories:{recent:t("block.poll_emoji_recent"),people:t("block.poll_emoji_people"),nature:t("block.poll_emoji_nature"),foods:t("block.poll_emoji_foods"),activity:t("block.poll_emoji_activity"),places:t("block.poll_emoji_places"),objects:t("block.poll_emoji_objects"),symbols:t("block.poll_emoji_symbols"),flags:t("block.poll_emoji_flags"),custom:t("block.poll_emoji_custom")}},u=["bulb","pushpin","white_check_mark","negative_squared_cross_mark","heart","+1","tada","no_entry_sign","exclamation"],d=18,f=["bulb","+1","star2","tada","pushpin","books","pencil2","writing_hand","heart","round_pushpin","baguette_bread","soccer","musical_keyboard","musical_score","umbrella_on_ground","art","first_place_medal","trophy","gift","sunrise","camping","beach_with_umbrella","desert_island","bullettrain_front","glass_of_milk","chestnut","cake","bread","unicorn_face","monkey_face"],h=["1F600","1F601","1F602","1F603","1F604","1F605","1F606","1F609","1F60A","1F60B","1F60E","1F60D","1F618","1F617","1F619","1F61A","1F642","1F917","1F914","1F610","1F611","1F636","1F644","1F60F","1F623","1F625","1F62E","1F910","1F62F","1F62A","1F62B","1F634","1F60C","1F61B","1F61C","1F61D","1F612","1F613","1F614","1F615","1F643","1F911","1F632","1F641","1F616","1F61E","1F61F","1F624","1F622","1F62D","1F626","1F627","1F628","1F629","1F62C","1F630","1F631","1F633","1F635","1F621","1F620","1F637","1F912","1F915","1F607","1F913","1F608","1F47F","1F479","1F47A","1F480","1F47B","1F47D","1F47E","1F916","1F4A9","1F63A","1F638","1F639","1F63B","1F63C","1F63D","1F640","1F63F","1F63E","1F648","1F649","1F64A","1F476","1F466","1F467","1F468","1F469","1F474","1F475","1F46E","1F482","1F477","1F478","1F473","1F472","1F471","1F470","1F47C","1F385","1F64D","1F64E","1F645","1F646","1F481","1F64B","1F647","1F486","1F487","1F6B6","1F3C3","1F483","1F46F","1F6C0","1F6CC","1F464","1F465","1F3C7","1F3C2","1F3C4","1F6A3","1F3CA","1F6B4","1F6B5","1F46B","1F46C","1F46D","1F48F","1F491","1F46A","1F4AA","1F448","1F449","1F446","1F595","1F447","1F596","1F918","270B","1F44C","1F44D","1F44E","270A","1F44A","1F44B","1F44F","1F450","1F64C","1F64F","1F485","1F442","1F443","1F463","1F440","1F445","1F444","1F48B","1F498","1F493","1F494","1F495","1F496","1F497","1F499","1F49A","1F49B","1F49C","1F49D","1F49E","1F49F","1F48C","1F4A4","1F4A2","1F4A3","1F4A5","1F4A6","1F4A8","1F4AB","1F4AC","1F4AD","1F453","1F454","1F455","1F456","1F457","1F458","1F459","1F45A","1F45B","1F45C","1F45D","1F392","1F45E","1F45F","1F460","1F461","1F462","1F451","1F452","1F3A9","1F393","1F4FF","1F484","1F48D","1F48E","1F435","1F412","1F436","1F415","1F429","1F43A","1F431","1F408","1F981","1F42F","1F405","1F406","1F434","1F40E","1F984","1F42E","1F402","1F403","1F404","1F437","1F416","1F417","1F43D","1F40F","1F411","1F410","1F42A","1F42B","1F418","1F42D","1F401","1F400","1F439","1F430","1F407","1F43B","1F428","1F43C","1F43E","1F983","1F414","1F413","1F423","1F424","1F425","1F426","1F427","1F438","1F40A","1F422","1F40D","1F432","1F409","1F433","1F40B","1F42C","1F41F","1F420","1F421","1F419","1F41A","1F980","1F40C","1F41B","1F41C","1F41D","1F41E","1F982","1F490","1F338","1F4AE","1F339","1F33A","1F33B","1F33C","1F337","1F331","1F332","1F333","1F334","1F335","1F33E","1F33F","1F340","1F341","1F342","1F343","1F347","1F348","1F349","1F34A","1F34B","1F34C","1F34D","1F34E","1F34F","1F350","1F351","1F352","1F353","1F345","1F346","1F33D","1F344","1F330","1F35E","1F9C0","1F356","1F357","1F354","1F35F","1F355","1F32D","1F32E","1F32F","1F373","1F372","1F37F","1F371","1F358","1F359","1F35A","1F35B","1F35C","1F35D","1F360","1F362","1F363","1F364","1F365","1F361","1F366","1F367","1F368","1F369","1F36A","1F382","1F370","1F36B","1F36C","1F36D","1F36E","1F36F","1F37C","2615","1F375","1F376","1F37E","1F377","1F378","1F379","1F37A","1F37B","1F374","1F52A","1F3FA","1F383","1F384","1F386","1F387","2728","1F388","1F389","1F38A","1F38B","1F38D","1F38E","1F38F","1F390","1F391","1F380","1F381","1F3AB","1F3C6","1F3C5","26BD","26BE","1F3C0","1F3D0","1F3C8","1F3C9","1F3BE","1F3B1","1F3B3","1F3CF","1F3D1","1F3D2","1F3D3","1F3F8","1F3AF","26F3","1F3A3","1F3BD","1F3BF","1F3AE","1F3B2","1F0CF","1F004","1F3B4","1F30D","1F30E","1F30F","1F310","1F5FE","1F30B","1F5FB","1F3E0","1F3E1","1F3E2","1F3E3","1F3E4","1F3E5","1F3E6","1F3E8","1F3E9","1F3EA","1F3EB","1F3EC","1F3ED","1F3EF","1F3F0","1F492","1F5FC","1F5FD","26EA","1F54C","1F54D","1F54B","26F2","26FA","1F301","1F303","1F304","1F305","1F306","1F307","1F309","1F30C","1F3A0","1F3A1","1F3A2","1F488","1F3AA","1F3AD","1F3A8","1F3B0","1F682","1F683","1F684","1F685","1F686","1F687","1F688","1F689","1F68A","1F69D","1F69E","1F68B","1F68C","1F68D","1F68E","1F690","1F691","1F692","1F693","1F694","1F695","1F696","1F697","1F698","1F699","1F69A","1F69B","1F69C","1F6B2","1F68F","26FD","1F6A8","1F6A5","1F6A6","1F6A7","2693","26F5","1F6A4","1F6A2","1F6EB","1F6EC","1F4BA","1F681","1F69F","1F6A0","1F6A1","1F680","1F6AA","1F6BD","1F6BF","1F6C1","231B","23F3","231A","23F0","1F55B","1F567","1F550","1F55C","1F551","1F55D","1F552","1F55E","1F553","1F55F","1F554","1F560","1F555","1F561","1F556","1F562","1F557","1F563","1F558","1F564","1F559","1F565","1F55A","1F566","1F311","1F312","1F313","1F314","1F315","1F316","1F317","1F318","1F319","1F31A","1F31B","1F31C","1F31D","1F31E","2B50","1F31F","1F320","26C5","1F300","1F308","1F302","2614","26A1","26C4","1F525","1F4A7","1F30A","1F507","1F508","1F509","1F50A","1F4E2","1F4E3","1F4EF","1F514","1F515","1F3BC","1F3B5","1F3B6","1F3A4","1F3A7","1F4FB","1F3B7","1F3B8","1F3B9","1F3BA","1F3BB","1F4F1","1F4F2","1F4DE","1F4DF","1F4E0","1F50B","1F50C","1F4BB","1F4BD","1F4BE","1F4BF","1F4C0","1F3A5","1F3AC","1F4FA","1F4F7","1F4F8","1F4F9","1F4FC","1F50D","1F50E","1F52C","1F52D","1F4E1","1F4A1","1F526","1F3EE","1F4D4","1F4D5","1F4D6","1F4D7","1F4D8","1F4D9","1F4DA","1F4D3","1F4D2","1F4C3","1F4DC","1F4C4","1F4F0","1F4D1","1F516","1F4B0","1F4B4","1F4B5","1F4B6","1F4B7","1F4B8","1F4B3","1F4B9","1F4B1","1F4B2","1F4E7","1F4E8","1F4E9","1F4E4","1F4E5","1F4E6","1F4EB","1F4EA","1F4EC","1F4ED","1F4EE","1F4DD","1F4BC","1F4C1","1F4C2","1F4C5","1F4C6","1F4C7","1F4C8","1F4C9","1F4CA","1F4CB","1F4CC","1F4CD","1F4CE","1F4CF","1F4D0","1F512","1F513","1F50F","1F510","1F511","1F528","1F52B","1F3F9","1F527","1F529","1F517","1F489","1F48A","1F6AC","1F5FF","1F52E","1F3E7","1F6AE","1F6B0","267F","1F6B9","1F6BA","1F6BB","1F6BC","1F6BE","1F6C2","1F6C3","1F6C4","1F6C5","1F6B8","26D4","1F6AB","1F6B3","1F6AD","1F6AF","1F6B1","1F6B7","1F4F5","1F51E","1F503","1F504","1F519","1F51A","1F51B","1F51C","1F51D","1F6D0","1F54E","1F52F","2648","2649","264A","264B","264C","264D","264E","264F","2650","2651","2652","2653","26CE","1F500","1F501","1F502","23E9","23EA","1F53C","23EB","1F53D","23EC","1F3A6","1F505","1F506","1F4F6","1F4F3","1F4F4","1F531","1F4DB","1F530","2B55","2705","274C","274E","2795","2796","2797","27B0","27BF","2753","2754","2755","2757","1F51F","1F4AF","1F520","1F521","1F522","1F523","1F524","1F18E","1F191","1F192","1F193","1F194","1F195","1F196","1F197","1F198","1F199","1F19A","1F201","1F236","1F22F","1F250","1F239","1F21A","1F232","1F251","1F238","1F234","1F233","1F23A","1F235","25FD","25FE","2B1B","2B1C","1F536","1F537","1F538","1F539","1F53A","1F53B","1F4A0","1F518","1F532","1F533","26AA","26AB","1F534","1F535"].reduce((function(e,n){return e[n]=!0,e}),{}),p=[].concat(a()(l.O),a()(l.BM),a()(l.hd),[l.B.QUOTE,l.B.QUOTE_CONTAINER,l.B.TASK]).reduce((function(e,n){return e[n]=!0,e}),{}),v=(e={},i()(e,l.B.TEXT,"emoji-for-text"),i()(e,l.B.HEADING1,"emoji-for-heading1"),i()(e,l.B.HEADING2,"emoji-for-heading2"),i()(e,l.B.HEADING3,"emoji-for-heading3"),i()(e,l.B.HEADING4,"emoji-for-heading4"),i()(e,l.B.BULLET,"emoji-for-bullet"),i()(e,l.B.TODO,"emoji-for-task"),i()(e,l.B.QUOTE,"emoji-for-quote"),i()(e,l.B.ORDERED,"emoji-for-order"),e)}).call(this,r("dx_E9Eu"))},dx_SqMK:function(e,n,r){},dx_SvJl:function(e,n,r){},dx_Svtu:function(e,n,r){"use strict";r.d(n,"w",(function(){return c})),r.d(n,"S",(function(){return a})),r.d(n,"k",(function(){return l})),r.d(n,"z",(function(){return s})),r.d(n,"t",(function(){return u})),r.d(n,"f",(function(){return d})),r.d(n,"X",(function(){return f}));var o=r("dx_xWWg"),i=r("dx_C7Cb");function c(e){return{id:Object(i.S)(),element:{tag:o.t.TEXT,property:{text:{content:e}}}}}function a(e){return{id:Object(i.S)(),element:{tag:o.t.A,property:{anchor:e}}}}function l(e){return{id:Object(i.S)(),element:{tag:o.t.AT,property:{at:e}}}}function s(e){return{id:Object(i.S)(),element:{tag:o.t.P,property:{paragraph:{}},child_ids:e,style:{},style_keys:[],wide_style:{}}}}function u(e,n,r){var i,c,a,l,s,u,d=r.id,f=r.element,h=e.elements.dictionary[n];h?null===(s=h.child_ids)||void 0===s||s.push(d):null===(u=e.element_ids)||void 0===u||u.push(d);e.elements.dictionary[d]=f;var p="";switch(f.tag){case o.t.AT:var v,g;null===e||void 0===e||null===(v=e.at_ids)||void 0===v||v.push(d),p=(null===(g=f.property.at)||void 0===g?void 0:g.content)||"";break;case o.t.TEXT:p=(null===(i=f.property.text)||void 0===i?void 0:i.content)||"";break;case o.t.A:var b=f;p=(null===(c=b.property.anchor)||void 0===c?void 0:c.content)||(null===(a=b.property.anchor)||void 0===a?void 0:a.href)||"",null===(l=e.anchor_ids)||void 0===l||l.push(d);break;default:p=""}e.inner_text=e.inner_text.concat(p)}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=[],r={dictionary:{}};if(e){var o=Object(i.S)();n.push(o),r.dictionary[o]=c(e)}return{element_ids:n,inner_text:e,elements:r,image_ids:[],at_ids:[],anchor_ids:[],media_ids:[],docs_ids:[]}}function f(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=d(e),r={element_entity_ref:{}};return{rich_text:n,doc_entity:r}}},dx_Sz6v:function(e,n,r){},dx_T17T:function(e,n,r){"use strict";var o=r("dx_OcOZ"),i=r("dx_TSYQ"),c=r.n(i),a=r("dx_cDcd"),l=r.n(a),s=r("dx_faye"),u=r.n(s),d=r("dx_yzqx"),f=r("dx_Dq30");r("dx_F5FD");function h(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return p(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function p(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var v="cover-panel-popover-content-wrapper";n.S=function(e){var n=Object(a.useRef)(null),r=Object(a.useRef)(null),i=e.trigger,s=e.extend,p=e.children,g=e.ignoreClass,b=e.onClose;return Object(a.useLayoutEffect)((function(){return n.current=i&&s&&r.current?Object(o.n)(i,r.current,{placement:"bottom",modifiers:[{name:"offset",options:{offset:[0,f.Y]}},{name:"preventOverflow",options:{padding:56}},{name:"flip",options:{padding:5,boundary:document.querySelector("#mainBox")}},{name:"computeStyles",options:{gpuAcceleration:!1}}]}):null,function(){n.current&&(n.current.destroy(),n.current=null)}})),Object(a.useEffect)((function(){var e=function(e){(function(e){for(var n=e.target,r=g.concat(v);n;){var o,i=h(r);try{for(i.s();!(o=i.n()).done;){var c=o.value;if(n.classList.contains(c))return!1}}catch(a){i.e(a)}finally{i.f()}n=n.parentElement}return!0})(e)&&(d.S.isSafari?window.requestAnimationFrame((function(){b&&b()})):b&&b())};return window.addEventListener("mousedown",e),function(){window.removeEventListener("mousedown",e)}}),[b,g]),Object(a.useEffect)((function(){var e=function(e){"Escape"===e.code&&s&&(e.stopPropagation(),b&&b())};return window.addEventListener("keydown",e,!0),function(){window.removeEventListener("keydown",e,!0)}}),[s,b]),u.a.createPortal(l.a.createElement("div",{ref:r,className:c()(v,{collapse:!s})},p),document.querySelector("#mainBox"))}},dx_T1AN:function(e,n,r){"use strict";r.d(n,"v",(function(){return M})),r.d(n,"t",(function(){return j})),r.d(n,"K",(function(){return D})),r.d(n,"S",(function(){return A}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_NOtv"),g=r.n(v),b=r("dx_h6a8"),y=r("dx_rQGm"),m=r("dx_yzqx"),_=r("dx_eSV8"),k=r("dx_OUFY"),O=r("dx_B28d"),x=r("dx_BH3T"),E=r("dx_Vau3"),S=r("dx_Z8yN"),C=r("dx_sb6Q"),I=r("dx_D8nn"),B=r("dx_U5UJ"),T=r("dx_iw8O");function w(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var R=g()("hover"),M="HOVER_BLOCK_CHANGED",j="RESET_HOVER_EVENT",D="IFRAME_BLOCK_HOVER",A=function(e){s()(r,e);var n=w(r);function r(e){var o;return i()(this,r),(o=n.call(this,e)).current=null,o.exactCurrent=null,o.listeners=[],o.locate=void 0,o.scrollTimer=void 0,o.handleHideBlockMenu=function(){I.X.active=!0},o.handleOpenBlockMenu=function(){I.X.active=!1},o.shouldDisable=function(){var e=o.options.eventContainer;return!o.isEditable||o.options.selectionAPI.isSelecting()||!!e.querySelector(".cover-setting.open")},o.handleMouseLeave=function(e){if(!o.shouldDisable()&&I.X.active){var n=e.relatedTarget;if(n){var r=o.options,i=r.blockFilters;if(r.ignoreClasses.some((function(e){return Object(_.Z)(n,e)})))return;if(i.some((function(e){return n.closest(e)})))return}o.reset()}},o.handleDragStatusChange=function(e){e?(I.X.active=!1,o.reset()):I.X.active=!0},o.handleScroll=function(){o.options.shouldDisable&&o.options.shouldDisable()||(o.scrollTimer||(I.X.active=!1,o.reset()),window.clearTimeout(o.scrollTimer),o.scrollTimer=window.setTimeout((function(){o.scrollTimer=void 0,I.X.active=!0}),200))},o.handleRequestReset=function(e){o.reset()},o.handleIframeBlockHover=function(e){I.X.active&&o.saveBlockAndNotify(e,e)},o.handleMouseMove=function(e){o.options.shouldDisable&&o.options.shouldDisable()?o.reset():o.throttleMouseMove(e)},o.throttleMouseMove=Object(b.throttle)((function(e){var n,r,i=e.target;if(e.target&&I.X.active&&!(null===(n=document.querySelector("#docx-popup-container"))||void 0===n?void 0:n.contains(i))&&(document.querySelector(".bear-web-x-container").contains(i)||(null===(r=document.querySelector(".presentation-mode-mask"))||void 0===r?void 0:r.contains(i)))&&(!o.options.noResponseTarget||!o.options.noResponseTarget.some((function(e){return Object(_.Z)(i,e)}))))if(o.options.ignoreClasses.some((function(e){return Object(_.Z)(i,e)})))o.reset();else{var c=o.options.scrollContainer.getBoundingClientRect();if(m.S.isBytedanceApp||!(e.pageX<=y.F))if(!o.options.blockFilters.some((function(n){return!!e.target.closest(n)}))){var a,l=Object(T.S)(e.target);if(!l)l=null===(a=o.blockManager.getBlockModelsByRecordId(o.blockManager.rootRecordId)[0])||void 0===a?void 0:a.id;if(l){var s=o.blockManager.getBlockModelByBlockId(l),u=e.clientX,d=e.clientX-c.left+o.options.scrollContainer.scrollLeft,f=e.clientY-c.top+o.options.scrollContainer.scrollTop;if(o.blockManager.hasBlockViewByBlockId(l)){var h=o.blockManager.getBlockViewByBlockId(l),p=Object(x.Q)(h.type)&&s.children.length>0;if(h&&!o.isContainerBlock(h)&&!o.isViewBlock(h)&&!p){var v=o.getHotpotRect(h);return u<v.left||u>v.right?void o.reset():void o.saveBlockAndNotify(h,h)}}if(s.type!==O.B.GRID){R("-------------------"),R("id1",l);var g=o.findContainer(l,e)||l;if(R("containerId",g),l=o.locate.getClosestBlock(g,d,f),R("id2",l),l&&o.blockManager.hasBlockViewByBlockId(l))"table"!==o.blockManager.getBlockViewByBlockId(l).type&&(l=o.locate.findClosestY(l,f));if(R("id3",l),R("-------------------"),l&&o.blockManager.hasBlockViewByBlockId(l)){var b=o.blockManager.getBlockViewByBlockId(l),k=o.getHotpotRect(b);if(u<k.left||u>k.right)return void o.reset();b&&o.saveBlockAndNotify(b,null)}}}}}}),50,{trailing:!1}),o.findContainer=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=o.findParentGridColumnOrTableId(e,n);if(R("parent grid columnId",i),!i)return i;var c=o.blockManager.getBlockViewByBlockId(i);R("parent grid column type",c.type);var a=c.getHostRect();if(n.pageX<a.left+a.width)return R("in left half",i),i;var l=o.blockManager.getBlockModelByBlockId(i);return l.nextSibling&&!r?l.nextSibling.id:i},o.reset=function(){o.throttleMouseMove.cancel();o.saveBlockAndNotify(null,null)},o.setup(),o}return a()(r,[{key:"setup",value:function(){this.locate=new C.S(this.blockManager,this.options.scrollContainer,this.options.fold),this.listeners=this.options.listeners||this.listeners,this.blockManager.addListener(j,this.handleRequestReset),this.blockManager.addListener(S.F,this.handleDragStatusChange),this.blockManager.addListener(y.ln,this.handleDragStatusChange),this.blockManager.addListener(D,this.handleIframeBlockHover);var e=this.options.scrollContainer;e.addEventListener("mousemove",this.handleMouseMove),e.addEventListener("mouseleave",this.handleMouseLeave),e.addEventListener("scroll",this.handleScroll),I.S.on(k.o.ON_SCROLL,this.handleScroll),this.options.eventEmitter.on(y.R,this.handleDragStatusChange),this.options.eventEmitter.on(y.V0,this.handleOpenBlockMenu),this.options.eventEmitter.on(y.s,this.handleHideBlockMenu),this.options.eventEmitter.on(y.l9,this.reset)}},{key:"addListener",value:function(e){this.listeners.push(e)}},{key:"destroy",value:function(){this.throttleMouseMove.cancel(),this.listeners.length=0,this.current=null,this.blockManager.removeListener(j,this.handleRequestReset),this.blockManager.removeListener(S.F,this.handleDragStatusChange),this.blockManager.removeListener(y.ln,this.handleDragStatusChange),this.blockManager.removeListener(D,this.handleIframeBlockHover);var e=this.options.scrollContainer;e.removeEventListener("mousemove",this.handleMouseMove),e.removeEventListener("mouseleave",this.handleMouseLeave),e.removeEventListener("scroll",this.handleScroll),I.S.removeListener(k.o.ON_SCROLL,this.handleScroll),this.options.eventEmitter.off(y.R,this.handleDragStatusChange),this.options.eventEmitter.off(y.V0,this.handleOpenBlockMenu),this.options.eventEmitter.off(y.s,this.handleHideBlockMenu),this.options.eventEmitter.off(y.l9,this.reset)}},{key:"isContainerBlock",value:function(e){var n=[O.B.PAGE,O.B.TABLE,O.B.GRID,O.B.GRID_COLUMN,O.B.CALLOUT,O.B.QUOTE_CONTAINER];return e&&n.includes(e.type)}},{key:"isViewBlock",value:function(e){return e.type===O.B.VIEW}},{key:"getHotpotRect",value:function(e){var n=e.getHostRect(),r=e.getContentRect(),o=r.width?r:n,i=[o.left,n.left],c=[o.width,n.width],a=document.querySelector(B.t);if(a){var l=a.getBoundingClientRect();i.push(l.left),c.push(l.width)}var s=Math.min.apply(null,i);c.push(o.right-s);var u=Math.max.apply(null,c);return new DOMRect(s-y.PX,o.top,u+y.PX,o.height)}},{key:"saveBlockAndNotify",value:function(e,n){var r=this;if(e!==this.current||n!==this.exactCurrent){this.listeners.forEach((function(n){n(r.current,e)}));var o=this.current;this.current=e,this.exactCurrent=n,this.blockManager.dispatch(M,[o,this.current,this.exactCurrent])}}},{key:"findParentGridColumnOrTableId",value:function(e,n){for(var r=this.blockManager.getRootBlockId(),o=this.blockManager.getBlockModelByBlockId(e),i=p.V;null!==o;){if(o.type===O.B.GRID_COLUMN){i=o.id;break}if(o.type===O.B.GRID){i=this.locate.findClosestX(o.id,n.pageX,"grid_column");break}var c=o.parent;if(o.type===O.B.CALLOUT&&(null===c||void 0===c?void 0:c.type)===O.B.CELL){i=o.id;break}if(o.type===O.B.TABLE){i=o.id;break}if(o.type===O.B.CELL){i=o.id;break}o.id!==r?o=o.parent:o=null}return i}},{key:"isEditable",get:function(){return this.blockManager.editable}}]),r}(E.A)},dx_T1GN:function(e,n,r){e.exports=r.p+"module/media/server_error.0069f0d8.png"},dx_T3T0:function(e,n,r){"use strict";r.d(n,"S",(function(){return h}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_h6a8"),a=r("dx_cDcd"),l=r("dx_a2aT"),s=r("dx_nQiu"),u=r("dx_Mzjv"),d=r("dx_S6dX"),f=r("dx_i4Kt");function h(e){var n=e.visible,r=Object(l.S)(n),o=Object(a.useState)(r),h=i()(o,2),p=h[0],v=h[1],g=function(e){var n=Object(f.G)(e).height;return Object(a.useMemo)((function(){return n<=s.W?s.Z:n>=s.L?s.N:Math.round(s.Z+.31*(n-s.W))}),[n])}(n);return[Object(a.useCallback)((function(e){var n=e.adaptiveSize,o=e.contentRect,i=n[u.R.LeftCenter].height;if(n[u.R.LeftCenter].width<o.width){var c=n[u.R.TopLeft].height,a=n[u.R.BottomLeft].height;return a<s.LB&&c<s.LB?(v(Math.min(r,i)),u.R.RightCenter):a<r&&a<g&&c>a?(v(Math.min(r,c)),u.R.TopLeft):(v(Math.min(r,a)),u.R.BottomLeft)}return v(Math.min(r,i)),u.R.LeftCenter}),[r]),Object(a.useCallback)((function(e){var n=e.contentRect,r=e.offsetInfo,o=e.viewportInfo,i=e.targetRect,a=e.direction,l=e.boundaryRect,s=e.bodyRect,u=Object(d.r)({contentRect:n,offsetInfo:r,viewportInfo:o,targetRect:i,direction:a,bodyRect:s}),f=Object(d.h)({positionInfo:u,viewportInfo:o,boundaryRect:l,contentRect:n,bodyRect:s});return["left","right"].some((function(e){return a.toLowerCase().startsWith(e)}))&&(f.top>0&&(Object(c.isUndefined)(u.top)?u.bottom-=f.top:u.top+=f.top),f.bottom>0&&(Object(c.isUndefined)(u.top)?u.bottom+=f.bottom:u.top-=f.bottom)),u}),[]),p]}},dx_T3tg:function(e,n,r){"use strict";var o=r("dx_hEqA");r.d(n,"M",(function(){return o.M}));var i=r("dx_OEIU");r.d(n,"r",(function(){return i.r}));var c=r("dx_P9db");r.d(n,"u",(function(){return c.u}));var a=r("dx_EhSK");r.d(n,"K",(function(){return a.K}));var l=r("dx_ij4R");r.d(n,"e",(function(){return l.e}))},dx_T4T0:function(e,n,r){"use strict";r.d(n,"V",(function(){return d}));var o=r("dx_QILm"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_jtB3"),d=function(){function e(n,r){a()(this,e),this.type=n,this.config=r}return s()(e,[{key:"getLayoutNodeConfig",value:function(e,n){var r=this.config||{},o=r.calculateModel,c=void 0===o?u.j.VERTICAL:o,a=i()(r,["calculateModel"]);return Object.assign(a,{calculateModel:n&&!n.show?u.j.IGNORE:c})}}]),e}()},dx_T5T1:function(e,n,r){},dx_T7To:function(e,n,r){"use strict";r.d(n,"H",(function(){return i})),r.d(n,"R",(function(){return c}));var o=r("dx_UtDZ");function i(){return Object(o.getMinaConfig)("ccm.docx.checklist.quickbutton",!1)}function c(){return Object(o.getMinaConfig)("ccm.docx.checkboxshape",!1)}},dx_TAqX:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return I}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_LcNA"),p=r("dx_UtDZ"),v=r("dx_h6a8"),g=r("dx_cDcd"),b=r.n(g),y=r("dx_yzqx"),m=r("dx_l6la"),_=r("dx_eSV8"),k=r("dx_FvGq"),O=r("dx_Vau3"),x=r("dx_TJ6m"),E=r("dx_hvnm"),S=r("dx_QU39");r("dx_t4JV");function C(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var I=function(e){l()(r,e);var n=C(r);function r(e){var i;return o()(this,r),(i=n.call(this,e)).firstChildBlockId=void 0,i.firstChildBlockView=void 0,i.isFirstLineEmpty=void 0,i.wrapperId=Object(_.I)(),i.rootBlockId=void 0,i.setup=function(){i.rootBlockId=i.blockManager.rootBlockId,i.bindEvent(),i.initStorageState()},i.handleBlockMount=function(e){var n=i.firstChildBlockId&&i.blockManager.model.getCacheRecordIdByBlockId(i.firstChildBlockId);e.recordId===n&&(i.unbindFirstChildEditorEvent(),i.bindFirstChildEditorEvent(),i.updateFistLineState())},i.handlePageChange=function(){i.getFirstChildBlockId()!==i.firstChildBlockId&&(i.unbindFirstChildEvent(),i.bindFirstChildEvent()),i.updateFistLineState()},i.updateFistLineState=function(){Object(E.X)(i.blockManager)?i.updateEmptyState(!0):i.updateEmptyState(!1)},i.updateFistLineStateThrottled=Object(v.throttle)(i.updateFistLineState,300,{leading:!1}),i.blockManager.editorAPI.modelService.isInitialDataReady()?i.setup():i.blockManager.addListener(k.Q,i.setup),i}return c()(r,[{key:"initStorageState",value:function(){Object(S.T)()}},{key:"getFirstChildBlockId",value:function(){var e;return null===(e=this.blockManager.getBlockModelByBlockId(this.rootBlockId).children[0])||void 0===e?void 0:e.id}},{key:"getFirstChildBlockView",value:function(){if(this.firstChildBlockId)return this.blockManager.getBlockViewByBlockIdNotCheck(this.firstChildBlockId)}},{key:"bindEvent",value:function(){this.blockManager.addListener(k.f,this.handlePageChange,this.rootBlockId),this.blockManager.addListener(k.T,this.handleBlockMount),this.bindFirstChildEvent(),this.updateFistLineState()}},{key:"unbindEvent",value:function(){this.blockManager.removeListener(k.f,this.handlePageChange,this.rootBlockId),this.blockManager.removeListener(k.T,this.handleBlockMount),this.unbindFirstChildEvent()}},{key:"bindFirstChildEvent",value:function(){this.firstChildBlockId=this.getFirstChildBlockId(),this.firstChildBlockId&&this.blockManager.addListener(k.F,this.updateFistLineState,this.firstChildBlockId),this.bindFirstChildEditorEvent()}},{key:"unbindFirstChildEvent",value:function(){this.firstChildBlockId&&(this.blockManager.removeListener(k.F,this.updateFistLineState,this.firstChildBlockId),this.firstChildBlockId=void 0),this.unbindFirstChildEditorEvent()}},{key:"bindFirstChildEditorEvent",value:function(){if(this.firstChildBlockView=this.getFirstChildBlockView()||null,this.firstChildBlockView&&this.firstChildBlockView.editor){var e=this.firstChildBlockView,n=e.editor,r=e.model.zoneId;n.on(h.L.COMPOSITION_START,this.updateFistLineState,{zoneId:r}),n.on(h.L.CONTENT_CHANGE,this.updateFistLineState,{zoneId:r}),n.on(h.L.COMPOSITION_END,this.updateFistLineStateThrottled,{zoneId:r})}}},{key:"unbindFirstChildEditorEvent",value:function(){if(this.firstChildBlockView&&this.firstChildBlockView.editor){var e=this.firstChildBlockView.editor;e.off(h.L.COMPOSITION_START,this.updateFistLineState),e.off(h.L.CONTENT_CHANGE,this.updateFistLineState),e.off(h.L.COMPOSITION_END,this.updateFistLineStateThrottled)}this.firstChildBlockView=null}},{key:"updateEmptyState",value:function(e){if(this.isFirstLineEmpty!==e){var n=document.querySelector("#placeholder-wrapper-".concat(this.wrapperId)),r=this.isFirstLineEmpty;e?(this.isFirstLineEmpty=!0,n&&n.classList.add("first-line-empty")):(this.isFirstLineEmpty=!1,n&&n.classList.remove("first-line-empty")),r!==this.isFirstLineEmpty&&p.store.dispatch(Object(m.m)(e))}}},{key:"getWrapper",value:function(e){var n=this;return function(r){var o,i=Boolean(null===(o=r.recursionProps)||void 0===o?void 0:o.editable),c=n.blockManager,a=n.isFirstLineEmpty?"first-line-empty":"";return b.a.createElement("div",{className:a,id:"placeholder-wrapper-".concat(n.wrapperId)},b.a.createElement("div",{className:"first-line-placeholder"},b.a.createElement("span",null,y.S.isMobile?t("doc.body_placeholder_default"):b.a.createElement(x.S,{blockManager:c,editable:i}))),b.a.createElement(e,r))}}},{key:"destroy",value:function(){this.blockManager.removeListener(k.Q,this.setup),this.unbindEvent()}}]),r}(O.A)}).call(this,r("dx_E9Eu"))},dx_THec:function(e,n,r){"use strict";r.d(n,"k",(function(){return l}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r("dx_HbDg");function l(){var e=Object(c.useState)(!1),n=i()(e,2),r=n[0],o=n[1],l=Object(c.useCallback)((function(e){o(e)}),[]);return Object(c.useEffect)((function(){return a.S.onVisibleChange(l),function(){a.S.offVisibleChange(l)}}),[l]),r}},dx_TJ4O:function(e,n,r){},dx_TJ6m:function(e,n,r){"use strict";var o=r("dx_m3ds"),i=r("dx_UtDZ"),c=r("dx_h74D"),a=r("dx_E2oU"),l=r("dx_I4Iz"),s=Object(c.connect)((function(e){return{isCurrentWikiNodeHasChild:!o.S.isMobile&&Object(i.getWikiCatalogFunctions)().selectCurrentWikiNodeHasChild(e),isFirstLineEmpty:Object(a.X)(e),isTemplateVisible:Object(i.selectIsTemplateVisible)(e)}}),(function(e){return{toggleTemplateVisible:function(){return e(i.toggleTemplateVisible.apply(void 0,arguments))}}}))(l.S);n.S=s},dx_TKhc:function(e,n,r){"use strict";r.d(n,"M",(function(){return O}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_cDcd"),b=r.n(g),y=(r("dx_yDdD"),r("dx_ZG9w")),m=r("dx_Vau3"),_=r("dx_Ayao");function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var O=function(e){d()(r,e);var n=k(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"getWrapper",value:function(e){var n=this;return function(r){var o=Object(g.useState)(new Set),c=i()(o,2),a=c[0],l=c[1],s=Object(g.useCallback)((function(e){var o=e.commentId,i=e.blockIds,c=n.blockManager.getBlockViewByBlockId(r.blockId);i.includes(r.blockId)&&!Object(y.f)(c)&&(a.add(o),l(new Set(a)))}),[a]),u=Object(g.useCallback)((function(e){var o=e.commentId,i=e.blockIds,c=n.blockManager.getBlockViewByBlockId(r.blockId);i.includes(r.blockId)&&a.has(o)&&!Object(y.f)(c)&&(a.delete(o),l(new Set(a)))}),[a]),d=Object(g.useCallback)((function(e){var o=e.tempCommentId,i=n.blockManager.getBlockViewByBlockId(r.blockId);a.has(o)&&!Object(y.f)(i)&&(a.delete(o),l(new Set(a)))}),[a]);Object(g.useEffect)((function(){return n.comment.on(_.M.ADD_TEMP_COMMENT,s),n.comment.on(_.M.COMMENT_TRANSACTION_APPLY,d),n.comment.on(_.M.CANCEL_ADD_COMMENT,u),function(){n.comment.off(_.M.ADD_TEMP_COMMENT,s),n.comment.off(_.M.COMMENT_TRANSACTION_APPLY,d),n.comment.off(_.M.CANCEL_ADD_COMMENT,u)}}),[a]);var f=r.record.snapshot,h=Object(g.useState)(!1),p=i()(h,2),v=p[0],m=p[1],k=Object(g.useCallback)((function(e){return m(e)}),[m]),O=(f.comments||[]).map((function(e){return"comment-id-".concat(e)})).concat(Array.from(a).map((function(e){return"local-comment comment-id-".concat(e)}))).join(" ");return b.a.createElement("div",{className:"block-comment ".concat(r.type,"-block-comment ").concat(O," ").concat(v?"comment-hl":"")},b.a.createElement(e,Object.assign({},r,{toggleCommentHighlight:k})))}}}]),r}(m.A)},dx_TN5U:function(e,n,r){},dx_TOCS:function(e,n,r){"use strict";(function(t){r.d(n,"s",(function(){return S}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_QxNg"),p=r("dx_NAyK"),v=r("dx_cDcd"),g=r.n(v),b=r("dx_H1q2"),y=r("dx_Fimk"),m=r("dx_eSV8"),_=r("dx_g0R0"),k=r("dx_Kkjd"),O=r("dx_S0qQ"),x=r("dx_bME5");r("dx_JjWO");function E(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var S=function(e){l()(r,e);var n=E(r);function r(){var e;o()(this,r);for(var i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).state={error:null},e.handleCopyError=function(){var n=e.state.error;if(n){var r=Object(_.G)(Object(_.n)(n,{code:h.e.RENDER_ERROR}));Object(_.v)(r)}},e.handleRetry=function(){Object(x.F)(O.K.REFRESH),location.reload()},e}return c()(r,[{key:"renderErrorBtn",value:function(){return g.a.createElement(p.S,{className:"error-icon-btn"})}},{key:"renderCopyErrBtn",value:function(){return Object(_.U)()&&g.a.createElement("span",{className:"error-copy-btn",onClick:this.handleCopyError},t("CreationDoc_DocX_BugReport_Copy_btn"))}},{key:"renderRetryBtn",value:function(){return g.a.createElement("span",{className:"error-retry-btn",onClick:this.handleRetry},t("common.retry"))}},{key:"renderContent",value:function(){var e=this.state.error;return g.a.createElement(g.a.Fragment,null,this.renderErrorBtn(),g.a.createElement("div",{className:"error-content"},g.a.createElement("div",{className:"error-text"},"Oops! Something went wrong! Error: ",e?e.message:""),g.a.createElement("div",{className:"error-btns"},this.renderCopyErrBtn(),this.renderRetryBtn())))}},{key:"componentDidCatch",value:function(e){e&&r.reportError(e,this.props.model)}},{key:"render",value:function(){return this.state.error?"inline"===this.props.displaymode?g.a.createElement("span",{className:"error-boundary-tip"},this.renderContent()):g.a.createElement("div",{className:"error-boundary-tip"},this.renderContent()):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}},{key:"keyOf",value:function(e){return"message: ".concat(e.message,"; stack: ").concat(e.stack)}},{key:"reset",value:function(){r.errorSet.clear()}},{key:"has",value:function(e){var n=r.keyOf(e);return r.errorSet.has(n)}},{key:"add",value:function(e){var n=r.keyOf(e);return r.errorSet.add(n)}},{key:"reportError",value:function(e,n){var o=Object(b.H)(),i=o.scm,c=o.scmDocx,a=Object(b.w)(),l=r.has(e),s=n.snapshot.type,u=n.recordId,d=n.children.map((function(e){var n;if("text"===(null===e||void 0===e?void 0:e.type)&&0===(null===e||void 0===e||null===(n=e.zoneState)||void 0===n?void 0:n.getModelText().length))return Object(m.L)(e.recordId)})).join(":"),f="parentId: ".concat(Object(m.L)(u),", recordIds: ").concat(d);r.add(e),!a&&!l&&Object(y.N)("docx_sdk_oops_dev",{code:h.e.RENDER_ERROR,type:h.Z.CLIENT_ERROR,msg:e.message||"Unknown render error",scmDocx:c,scm:i,blockType:s,fg:{allow_pre_edit:k.w},detail:f}),Object(m.n)(e)}}]),r}(g.a.Component);S.errorSet=new Set}).call(this,r("dx_E9Eu"))},dx_TOEA:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o),c=r("dx_h74D"),a=r("dx_vfzM"),l=r("dx_Ykhn");n.S=function(e){var n=Object(c.useSelector)(a.Q).authState;return Object(o.useEffect)((function(){![l.W.HAS_NOT_FETCH,l.W.FETCH_FAIL].includes(n)&&e.editable&&e.sync()}),[n,e]),i.a.createElement(i.a.Fragment,null)}},dx_TRUJ:function(e,n,r){"use strict";r.d(n,"Q",(function(){return u}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_NOtv"),s=r.n(l)()("editor:"),u=function(){function e(){throw i()(this,e),this.desc="\u8fd9\u4e2a\u7c7b\u4e3a\u4e86\u5199\u9759\u6001\u7c7b\u65f6\u6ca1\u6709ts\u9519\u8bef\u548c\u81ea\u52a8\u6ce8\u5165debug",new Error("".concat(this.constructor.name,"should not be instantiated"))}return a()(e,null,[{key:"debug",value:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];s("".concat(this.name,":"),n)}}]),e}()},dx_TSY5:function(e,n,r){"use strict";r.d(n,"d",(function(){return d}));var o=r("dx_scwL"),i=r.n(o);function c(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return a(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return a(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,l=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return l=e.done,e},e:function(e){s=!0,c=e},f:function(){try{l||null==r.return||r.return()}finally{if(s)throw c}}}}function a(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var l=/(?:[\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u3005\u3007\u3021-\u3029\u3038-\u303B\u3400-\u4DBF\u4E00-\u9FFC\uF900-\uFA6D\uFA70-\uFAD9]|\uD81B[\uDFF0\uDFF1]|[\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/g,s=/[A-Za-z\xAA\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u02E0-\u02E4\u1D00-\u1D25\u1D2C-\u1D5C\u1D62-\u1D65\u1D6B-\u1D77\u1D79-\u1DBE\u1E00-\u1EFF\u2071\u207F\u2090-\u209C\u212A\u212B\u2132\u214E\u2160-\u2188\u2C60-\u2C7F\uA722-\uA787\uA78B-\uA7BF\uA7C2-\uA7CA\uA7F5-\uA7FF\uAB30-\uAB5A\uAB5C-\uAB64\uAB66-\uAB69\uFB00-\uFB06\uFF21-\uFF3A\uFF41-\uFF5A]|(?:[\u0370-\u0373\u0375-\u0377\u037A-\u037D\u037F\u0384\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03E1\u03F0-\u03FF\u1D26-\u1D2A\u1D5D-\u1D61\u1D66-\u1D6A\u1DBF\u1F00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FC4\u1FC6-\u1FD3\u1FD6-\u1FDB\u1FDD-\u1FEF\u1FF2-\u1FF4\u1FF6-\u1FFE\u2126\uAB65]|\uD800[\uDD40-\uDD8E\uDDA0]|\uD834[\uDE00-\uDE45])|[0-9]/g,u=new RegExp("(".concat(l.source,")(?=(").concat(s.source,"))|(").concat(s.source,")(?=(").concat(l.source,"))"),"gu");function d(e){var n,r=[],o=c(i()(e,u));try{for(o.s();!(n=o.n()).done;){var a=n.value.index;"number"===typeof a&&r.push(a)}}catch(l){o.e(l)}finally{o.f()}return r}},dx_TSvr:function(e,n,r){"use strict";r.d(n,"x",(function(){return Q}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_iWIM"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_QxNg"),b=r("dx_Vau3"),y=r("dx_D8nn"),m=r("dx_k8kI"),_=r("dx_h6a8"),k=_.noop,O=_.noop,x=_.noop,E=r("dx_W7Th"),S=r("dx_lSNA"),C=r.n(S),I=r("dx_J4zp"),B=r.n(I),T=r("dx_o0o1"),w=r.n(T),R=r("dx_yXPU"),M=r.n(R),j=r("dx_RIqP"),D=r.n(j),A=r("dx_C7Cb"),P=r("dx_B28d"),L=r("dx_bvq6"),N=r("dx_TYsD"),F=r("dx_s9Aa"),U=r("dx_AIJo"),H=r("dx_dYKg");function V(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function W(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?V(Object(r),!0).forEach((function(n){C()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var z=[].concat(D()(P.hI),[P.B.PAGE]),G=L.O.KEY,K=function(){function e(n){var r=this;i()(this,e),this.sub=void 0,this.blockManager=void 0,this.readHighlightBlockVersions=new Map,this.lastSequenceId="",this.blockIds=new Set,this.recordIds=new Set,this.debounceWriteHighlight=void 0,this.debounceReadHighlight=void 0,this.writeHighlight=M()(w.a.mark((function e(){var n,o,i,c,a,l,s,u,d,f,h,p;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==r.recordIds.size){e.next=2;break}return e.abrupt("return");case 2:n=r.blockManager,o=n.editorAPI.getService(N.q),i=Array.from(r.recordIds),c=[],a=0,l=i;case 7:if(!(a<l.length)){e.next=21;break}if(s=l[a],r.recordIds.delete(s),(u=n.getBlockModelsByRecordId(s)).length){e.next=13;break}return e.abrupt("continue",18);case 13:if(d=r.isBlockNeedReadDocxHighlight(o,u[0],!1),f=d.needCheck,h=d.block,f&&c.push(h),!(c.length>100)){e.next=18;break}return r.debounceWriteHighlight(),e.abrupt("break",21);case 18:a++,e.next=7;break;case 21:if(0!==c.length){e.next=23;break}return e.abrupt("return");case 23:return r.lastSequenceId=Object(A.S)(),e.next=26,Object(F.g)({sequenceId:r.lastSequenceId,blocks:c});case 26:(p=e.sent).sequenceId===r.lastSequenceId&&(r.processDocHighlightResponse(p),r.blockManager.editable&&r.processAbbreviationResponse(p));case 28:case"end":return e.stop()}}),e)}))),this.readHighlight=M()(w.a.mark((function e(){var n,o,i,c,a;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.blockManager,o=n.editorAPI.getService(N.q),i=[],c=Array.from(r.blockIds),r.blockIds.clear(),c.forEach((function(e){var c=n.getBlockModelByBlockIdNotCheck(e);if(c){var a=r.isBlockNeedReadDocxHighlight(o,c),l=a.needCheck,s=a.block;l&&i.push(s)}})),!i.length){e.next=11;break}return e.next=9,Object(F.g)({sequenceId:"",blocks:i,useCache:!0});case 9:a=e.sent,r.processDocHighlightResponse(a,!0);case 11:case"end":return e.stop()}}),e)}))),this.blockManager=n,this.sub=n.editorAPI.lifecycle.editorDidMount$.subscribe((function(){var e=r.blockManager.rootBlockId;r.blockIds.add(e),r.debounceReadHighlight(),r.sub.unsubscribe()})),this.debounceWriteHighlight=Object(_.debounce)(this.writeHighlight,500,{leading:!1,trailing:!0}),this.debounceReadHighlight=Object(_.debounce)(this.readHighlight,1e3,{leading:!1,trailing:!0})}return a()(e,[{key:"handleRecordChange",value:function(e,n,r){if(e&&n&&r&&z.includes(n))if(r===g.H.local)this.recordIds.add(e),this.debounceWriteHighlight();else if(r===g.H.remote){var o=this.blockManager.getBlockIdsByRecordId(e);this.addChangedBlockIds(o)}}},{key:"addChangedBlockIds",value:function(e){var n=this;e.length&&(e.forEach((function(e){return n.blockIds.add(e)})),this.debounceReadHighlight())}},{key:"clearBlockIds",value:function(){this.blockIds.clear(),this.readHighlightBlockVersions.clear()}},{key:"processDocHighlightResponse",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=this.blockManager,i=e.blocks,c=e.data.phrases;c.forEach((function(e,c){var a=i[c],l=a.id,s=a.version,u=a.text;if(l&&s){var d=o.getBlockModelsByRecordId(l);if(d.length){var f=B()(d,1)[0],h=f.zoneState,p=f.contentState,v=h.getModelText(),g=Object(H.M)(h.getEntities([[U.F]]),U.F),b=[],y=[];if(v===u){e.forEach((function(e){var n=e.ids,r=e.span,o=r.start,i=r.end;if(e.name===v.substring(o,i)){var c=W(W({},h.offsetToPoint(o)),{},{zoneId:h.getZoneId()}),a=W(W({},h.offsetToPoint(i)),{},{zoneId:h.getZoneId()}),l=Object(H.M)(h.getEntities({start:c,end:a}),U.F).every(H.D),s=n.join(","),u={id:Object(A.S)(),abbr_ids:s},d=g.findIndex((function(e){var n=h.pointToOffset(e.start),r=h.pointToOffset(e.end),c=JSON.parse(e.attributes[U.F]).abbr_ids;return n===o&&r===i&&s===c}));if(-1===d){if(l)return;b.push({start:c,end:a,attributes:C()({},U.F,JSON.stringify(u))})}else l?y.push({start:c,end:a,attributes:C()({},U.F,"")}):g.splice(d,1)}}));for(var m=0;m<g.length;m++){var _=g[m],k=_.attributes,O=_.start,E=_.end;k&&k[U.F]&&y.push({start:O,end:E,attributes:C()({},U.F,"")})}var S=Boolean(b.length||y.length);if(S){var I=o.getBlockViewsByRecordId(l);if(!I.length)return;var T=I[0].editor;if(T&&T.getStatus("isComposing"))return}y.length&&Object(H.g)(p,y),b.length&&Object(H.w)()&&Object(H.g)(p,b),S&&x(),r&&n.readHighlightBlockVersions.set(l,Number(s))}}}}))}},{key:"isBlockNeedReadDocxHighlight",value:function(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o={needCheck:!1,block:{text:""}};if(!z.includes(n.type))return o;var i=n.recordId,c=e.getVersion(i,g.N.record),a=this.readHighlightBlockVersions.get(i);if(r&&(Object(_.isUndefined)(c)||c===a))return o;var l=n;if(!l.zoneState)return o;var s=l.zoneState.getModelText();return s.trim()?{needCheck:!0,block:{text:s,id:i,version:"".concat(c)}}:o}},{key:"processAbbreviationResponse",value:function(){var e=M()(w.a.mark((function e(n){var r,o,i;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.data,o=n.blocks,r.phrases.length===o.length){e.next=3;break}return e.abrupt("return");case 3:i=this.blockManager,r.phrases.forEach(function(){var e=M()(w.a.mark((function e(n,r){var c,a,l,s,u,d,f,h,p,v,g,b,y,m,_,k,O,x,E,S,I,T;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=new Set,a=o[r].id||"",l=i.getBlockIdsByRecordId(a),s=B()(l,1),u=s[0]){e.next=5;break}return e.abrupt("return");case 5:for(d=i.getBlockModelByBlockId(u),f=d.contentState,h=d.zoneState,p=h.getModelText(),v=Object(H.M)(h.getEntities([[U.b]]),U.b),g=[],b=[],n.filter((function(e){return!c.has(e.name)&&(c.add(e.name),!0)})).forEach((function(e){var n=e.name,r=e.ids,o=e.span,i=o.start,c=o.end;if(n===p.substring(i,c)){var a=r.join(",");if(!(a.length>500)){var l={id:Object(A.S)(),abbr_ids:a,is_visible:U.K.Visible,is_first:1},s=v.findIndex((function(e){var n=h.pointToOffset(e.start),r=h.pointToOffset(e.end),o=JSON.parse(e.attributes[U.b]).abbr_ids;return n===i&&r===c&&a===o})),u=W(W({},h.offsetToPoint(i)),{},{zoneId:h.getZoneId()}),d=W(W({},h.offsetToPoint(c)),{},{zoneId:h.getZoneId()}),y=Object(H.M)(f.getEntities({start:u,end:d}),U.b),m=y.every((function(e){var n=e.attributes;return"true"===n.inlineCode||Boolean(n.link)||Boolean(n["link-id"])||Boolean(n.equation)}));if(-1===s){if(y.every((function(e){return e.attributes[G]}))&&b.push({start:u,end:d,attributes:C()({},G,"")}),m)return;g.push({start:u,end:d,attributes:C()({},U.b,JSON.stringify(l))})}else m?b.push({start:u,end:d,attributes:C()({},U.b,"")}):v.splice(s,1)}}})),y=0;y<v.length;y++)m=v[y],_=m.attributes,k=m.start,O=m.end,_&&_[U.b]&&b.push({start:k,end:O,attributes:C()({},U.b,"")});if(!(!(x=i.getBlockViewByBlockIdNotCheck(u))||x.editor&&x.editor.getStatus("isComposing"))){e.next=16;break}return e.abrupt("return");case 16:if(!(b.length>0)){e.next=19;break}return e.next=19,Object(H.Hd)(i,[{recordId:a,contentState:f,entities:b}]);case 19:if(!(g.length>0&&Object(H.w)())){e.next=22;break}return e.next=22,Object(H.Hd)(i,[{recordId:a,contentState:f,entities:g}]);case 22:(b.length||g.length)&&(null===(E=window)||void 0===E||null===(S=E.lark)||void 0===S||null===(I=S.biz)||void 0===I||null===(T=I.navigation)||void 0===T||T.closeCustomContextMenu());case 23:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),e}();function q(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function X(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?q(Object(r),!0).forEach((function(n){C()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var Y=L.O.KEY,J=function(){function e(n){var r=this;i()(this,e),this.blockManager=void 0,this.lastSequenceId="",this.taskQueue=new Set,this.debouncedExecuteTask=void 0,this.executeTask=M()(w.a.mark((function e(){var n,o,i,c,a,l,s,u,d,f,h;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==r.taskQueue.size){e.next=2;break}return e.abrupt("return");case 2:n=Array.from(r.taskQueue.values()),o=[],i=0,c=0,a=n;case 6:if(!(c<a.length)){e.next=16;break}if(l=a[c],s=r.isBlockNeedCheckAbbreviation(l),u=s.needCheck,d=s.blockText,u&&(i+=1,o.push({id:l,text:d}),r.taskQueue.delete(l)),!(i>100)){e.next=13;break}return r.debouncedExecuteTask(),e.abrupt("break",16);case 13:c++,e.next=6;break;case 16:if(!o.length){e.next=23;break}return r.lastSequenceId=Object(A.S)(),e.next=20,Object(F.g)({blocks:o,sequenceId:r.lastSequenceId});case 20:f=e.sent,h=f.sequenceId,f.data.phrases.length&&r.lastSequenceId===h&&r.processAbbreviationResponse(f);case 23:case"end":return e.stop()}}),e)}))),this.blockManager=n,this.debouncedExecuteTask=Object(_.debounce)(this.executeTask,500,{leading:!1,trailing:!0})}return a()(e,[{key:"handleRecordChange",value:function(e,n){e&&(P.hI.includes(n)||n===P.B.PAGE)&&(this.taskQueue.add(e),this.debouncedExecuteTask())}},{key:"isBlockNeedCheckAbbreviation",value:function(e){var n=this.blockManager,r=n.getBlockIdsByRecordId(e),o=B()(r,1)[0];if(!o)return{needCheck:!1,blockText:""};var i=n.getBlockModelByBlockId(o);if(!i.zoneState)return{needCheck:!1,blockText:""};var c=i.zoneState.getModelText();return c.trim()?{needCheck:!0,blockText:c}:{needCheck:!1,blockText:""}}},{key:"processAbbreviationResponse",value:function(){var e=M()(w.a.mark((function e(n){var r,o,i;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.data,o=n.blocks,r.phrases.length===o.length){e.next=3;break}return e.abrupt("return");case 3:i=this.blockManager,r.phrases.forEach(function(){var e=M()(w.a.mark((function e(n,r){var c,a,l,s,u,d,f,h,p,v,g,b,y,m,_,k,O,x,E,S,I,T;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=new Set,a=o[r].id||"",l=i.getBlockIdsByRecordId(a),s=B()(l,1),u=s[0]){e.next=5;break}return e.abrupt("return");case 5:for(d=i.getBlockModelByBlockId(u),f=d.contentState,h=d.zoneState,p=h.getModelText(),v=Object(H.M)(h.getEntities([[U.b]]),U.b),g=[],b=[],n.filter((function(e){return!c.has(e.name)&&(c.add(e.name),!0)})).forEach((function(e){var n=e.name,r=e.ids,o=e.span,i=o.start,c=o.end;if(n===p.substring(i,c)){var a=r.join(",");if(!(a.length>500)){var l={id:Object(A.S)(),abbr_ids:a,is_visible:U.K.Visible,is_first:1},s=v.findIndex((function(e){var n=h.pointToOffset(e.start),r=h.pointToOffset(e.end),o=JSON.parse(e.attributes[U.b]).abbr_ids;return n===i&&r===c&&a===o})),u=X(X({},h.offsetToPoint(i)),{},{zoneId:h.getZoneId()}),d=X(X({},h.offsetToPoint(c)),{},{zoneId:h.getZoneId()}),f=Object(H.M)(h.getEntities({start:u,end:d}),U.b),y=f.every((function(e){var n=e.attributes;return"true"===n.inlineCode||Boolean(n.link)||Boolean(n["link-id"])||Boolean(n.equation)}));if(-1===s){if(f.every((function(e){return e.attributes[Y]}))&&b.push({start:u,end:d,attributes:C()({},Y,"")}),y)return;g.push({start:u,end:d,attributes:C()({},U.b,JSON.stringify(l))})}else y?b.push({start:u,end:d,attributes:C()({},U.b,"")}):v.splice(s,1)}}})),y=0;y<v.length;y++)m=v[y],_=m.attributes,k=m.start,O=m.end,_&&_[U.b]&&b.push({start:k,end:O,attributes:C()({},U.b,"")});if(!(!(x=i.getBlockViewByBlockIdNotCheck(u))||x.editor&&x.editor.getStatus("isComposing"))){e.next=16;break}return e.abrupt("return");case 16:if(!(b.length>0)){e.next=19;break}return e.next=19,Object(H.Hd)(i,[{recordId:a,contentState:f,entities:b}]);case 19:if(!(g.length>0&&Object(H.w)())){e.next=22;break}return e.next=22,Object(H.Hd)(i,[{recordId:a,contentState:f,entities:g}]);case 22:(b.length||g.length)&&(null===(E=window)||void 0===E||null===(S=E.lark)||void 0===S||null===(I=S.biz)||void 0===I||null===(T=I.navigation)||void 0===T||T.closeCustomContextMenu());case 23:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}());case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),e}();r("dx_flvg");function Z(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var Q=function(e){d()(r,e);var n=Z(r);function r(e){var o;return i()(this,r),(o=n.call(this,e)).isReadHighlightEnabled=!1,o.service=void 0,o.nextService=void 0,o.sub=void 0,o.handleChange=function(e){var n=o.blockManager.editable,r=e.recordOps,i=e.options.from;o.isReadHighlightEnabled?i!==g.H.local&&i!==g.H.remote||r.forEach((function(e){var n,r=e.id,c=e.record.snapshot.type;null===(n=o.nextService)||void 0===n||n.handleRecordChange(r,c,i)})):n&&i===g.H.local&&r.forEach((function(e){var n,r=e.id,i=e.record.snapshot.type;null===(n=o.service)||void 0===n||n.handleRecordChange(r,i)}))},o.handleContextMenuClose=function(){E.g.handleContextMenuClose()},o.handleBufferChanged=function(e){var n;null===(n=o.nextService)||void 0===n||n.addChangedBlockIds(e.enterBlocks)},o.handleTranslationClosed=function(){var e,n,r=o.blockManager.layoutManager,i=new Set;r.getBufferBlocks().forEach((function(e){return i.add(e)})),r.getViewportBlocks().forEach((function(e){return i.add(e)})),null===(e=o.nextService)||void 0===e||e.clearBlockIds(),null===(n=o.nextService)||void 0===n||n.addChangedBlockIds(Array.from(i))},o.isReadHighlightEnabled=Object(H.Z)(),o.sub=o.blockManager.editorAPI.modelService.change$.subscribe(o.handleChange),o.isReadHighlightEnabled?(o.blockManager.addListener(m.a,o.handleBufferChanged),o.nextService=new K(o.blockManager)):o.service=new J(o.blockManager),y.N.on(y.p.TRANSLATE.TRANSLATE_EVENT_CLOSE,o.handleTranslationClosed),k(o.handleContextMenuClose),o}return a()(r,[{key:"destroy",value:function(){s()(v()(r.prototype),"destroy",this).call(this),this.sub.unsubscribe(),this.isReadHighlightEnabled&&this.blockManager.removeListener(m.a,this.handleBufferChanged),y.N.off(y.p.TRANSLATE.TRANSLATE_EVENT_CLOSE,this.handleTranslationClosed),O(this.handleContextMenuClose)}}]),r}(b.A)},dx_TSyI:function(e,n,r){},dx_TTrq:function(e,n,r){"use strict";r.d(n,"u",(function(){return h})),r.d(n,"W",(function(){return v})),r.d(n,"B",(function(){return b}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_UtDZ"),s=r("dx_AA3h"),u=r("dx_oKt1"),d=r("dx_LbJg"),f="DOCX_TOKEN_MAPPING";function h(){return p.apply(this,arguments)}function p(){return(p=a()(i.a.mark((function e(){var n,r,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(s.genKey)(f),r=n,e.next=4,Object(s.getData)({key:n,token:r,keyGened:!0});case 4:return o=e.sent,e.abrupt("return",o.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(e){return g.apply(this,arguments)}function g(){return(g=a()(i.a.mark((function e(n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.S.getRealToken(n);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e){if(!(null===u.q||void 0===u.q?void 0:Object(u.q)(e)))return e;var n=Object(l.getToken)();return(null===u.q||void 0===u.q?void 0:Object(u.q)(n))?d.S.getRealTokenFromMemory(e)||e:n}window._getTokenMapping=h},dx_TYsD:function(e,n,r){"use strict";var o=r("dx_gFrY");r.d(n,"q",(function(){return o.q}))},dx_TcWW:function(e,n,r){},dx_Tdsn:function(e,n,r){"use strict";(function(t){var e,o,i,c,a=r("dx_lSNA"),l=r.n(a),s=r("dx_o0o1"),u=r.n(s),d=r("dx_yXPU"),f=r.n(d),h=r("dx_yG8O"),p=r.n(h),v=r("dx_lwsE"),g=r.n(v),b=r("dx_W8MJ"),y=r.n(b),m=r("dx_PJYZ"),_=r.n(m),k=r("dx_iWIM"),O=r.n(k),x=r("dx_W7W2"),E=r.n(x),S=r("dx_a1gu"),C=r.n(S),I=r("dx_Nsbk"),B=r.n(I),T=r("dx_Uyc2"),w=r.n(T),R=(r("dx_A1AB"),r("dx_UtDZ")),M=r("dx_PQBD"),j=r("dx_B28d"),D=r("dx_G5PB"),A=r("dx_bkVC"),P=r("dx_BE1d"),L=r("dx_Wkzy"),N=r("dx_bWl7");function F(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function U(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?F(Object(r),!0).forEach((function(n){l()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):F(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function H(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=B()(e);if(n){var i=B()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return C()(this,r)}}var V=(c=i=function(e){E()(r,e);var n=H(r);function r(e){var i;return g()(this,r),(i=n.call(this,e)).bridge=void 0,i.hasSetCommentBatchUpdateListener=!1,p()(i,"depLoader",o,_()(i)),i.serviceType="BITABLE_BLOCK",i.setCommentBatchUpdateListener=function(){var e=f()(u.a.mark((function e(n,r){var o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:if(i.hasSetCommentBatchUpdateListener){e.next=6;break}return e.next=5,null===(o=i.bridge)||void 0===o?void 0:o.setOnCommentBatchUpdate(r,(function(){return i.handleCommentUpdated(n)}),(function(e){return i.handleCommentDidAdd(n,e)}));case 5:i.hasSetCommentBatchUpdateListener=!0;case 6:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),i.loadBridgeImpl=function(){var e=Object(N.U)(i.snapshot.token).token;return e?(i.bridge=i.depLoader.getBridge(e),i.loadBridgeImpl=function(){return i.bridge},i.bridge):null},i}return y()(r,[{key:"handleInternalPaste",value:function(){var e=f()(u.a.mark((function e(n,r){var o,i,c,a,l=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(R.isOnline)()){e.next=3;break}return Object(M.K)(this.modelService,this.id,t("CreationDoc_Common_NetworkDisconnected_UnableToCreate")),e.abrupt("return");case 3:return i=this.depLoader.getBridge(""),e.prev=4,c=Object(A.h)(),a=c.from===j.G.innerCutPaste&&1===c.pasteTimes,e.next=9,null===i||void 0===i?void 0:i.pasteBitableBlock(this.recordId,n,r,a);case 9:if(e.t0=e.sent,e.t0){e.next=12;break}e.t0="";case 12:(o=e.t0)&&this.depLoader.setNewPasteBlockMap(o),e.next=20;break;case 16:return e.prev=16,e.t1=e.catch(4),Object(M.K)(this.modelService,this.id,t("common.operation_failed"),e.t1),e.abrupt("return");case 20:this.applyTransaction("updateBitableBlock",(function(e){e.replace(l.recordId,["token"],o),e.replace(l.recordId,["createdSource"],R.CreatedSource.PASTE)}),{undoable:!1}),this.depLoader.setBitableToken(o,this.recordId);case 22:case"end":return e.stop()}}),e,this,[[4,16]])})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onPasteRecordAfterAccepted",value:function(e){var n=e||{},r=n.initData,o=n.html,i="",c=o&&o.querySelector("[data-meta-block-props]");c&&(i=JSON.parse(c.getAttribute("data-meta-block-props")).initData);var a=r||i;a&&this.handleInternalPaste(a,0)}},{key:"setCommentData",value:function(){var e=f()(u.a.mark((function e(n,r){var o,i,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Object(N.U)(this.snapshot.token),c=i.id){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.setCommentBatchUpdateListener(r,c);case 5:return e.next=7,null===(o=this.bridge)||void 0===o?void 0:o.setCommentData(c,n);case 7:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"startNewComment",value:function(e,n){var r,o=Object(N.U)(this.snapshot.token).id;return o?(null===(r=this.bridge)||void 0===r?void 0:r.startNewComment(o,e,n)).recordDescribe:""}},{key:"saveCommentMark",value:function(e,n){var r,o=Object(N.U)(this.snapshot.token).id;return o&&this.bridge?null===(r=this.bridge)||void 0===r?void 0:r.saveComment(o,n,e):Promise.reject(new Error("no tableId or bridge"))}},{key:"removeCommentMark",value:function(e){var n=Object(N.U)(this.snapshot.token).id;return n&&this.bridge?this.bridge.removeComment(n,e):Promise.reject(new Error("no tableId or bridge"))}},{key:"removeTempComment",value:function(e){var n=Object(N.U)(this.snapshot.token).id;return n&&this.bridge?(this.bridge.removeTempComment(n,e),Promise.resolve()):Promise.reject(new Error("no tableId or bridge"))}},{key:"resolveComment",value:function(e){var n=Object(N.U)(this.snapshot.token).id;return n&&this.bridge?this.bridge.resolveComment(n,e):Promise.reject(new Error("no tableId or bridge"))}},{key:"reopenComment",value:function(e){var n=Object(N.U)(this.snapshot.token).id;return n&&this.bridge?this.bridge.reopenComment(n,e):Promise.reject(new Error("no tableId or bridge"))}},{key:"getComments",value:function(){var e,n=Object(N.U)(this.snapshot.token).id;return n?Object(N.i)((null===(e=this.bridge)||void 0===e?void 0:e.getComments(n))||[]):[]}},{key:"getActiveComments",value:function(){var e,n=Object(N.U)(this.snapshot.token).id;return n?Object(N.i)((null===(e=this.bridge)||void 0===e?void 0:e.getActiveComments(n))||[]):[]}},{key:"getResolvedComments",value:function(){var e,n=Object(N.U)(this.snapshot.token).id;return n?Object(N.i)((null===(e=this.bridge)||void 0===e?void 0:e.getResolvedComments(n))||[]):[]}},{key:"getCommentRelativeTop",value:function(e){var n,r,o=null!==(n=e.relativeTopToThirdParty)&&void 0!==n?n:0;if(!this.blockManager.hasBlockViewByBlockId(this.id))return o;var i=null!==(r=this.blockManager.view.getBlockViewByBlockId(this.id).props.zoom)&&void 0!==r?r:1;return 1!==i?o*i:o}},{key:"getText",value:function(){return"[".concat(t("common.bitable"),"]")}},{key:"reset",value:function(){this.hasSetCommentBatchUpdateListener=!1}},{key:"onInit",value:function(e){O()(B()(r.prototype),"onInit",this).call(this,e);var n=this.record.snapshot.token;n&&this.depLoader.setBitableToken(n,this.recordId)}},{key:"onDestroy",value:function(e){O()(B()(r.prototype),"onDestroy",this).call(this,e);var n=this.record.snapshot.token;n&&this.depLoader.delBitableToken(n)}},{key:"find",value:function(e){var n=this,r=Object(N.U)(this.snapshot.token).id;return this.bridge&&this.bridge.getSearchResult&&r?this.bridge.getSearchResult(r,e).map((function(e){var o;return new P.V(U(U({},e),{},{bitableId:r,blockId:n.id,bridge:n.bridge,cellId:e.key,blockManager:n.blockManager,scrollManage:null===(o=n.blockManager.getBlockViewByBlockIdNotCheck(n.id))||void 0===o?void 0:o.props.scrollManage}))})):[]}}]),r}(D.X),i.type=j.B.BITABLE,e=c,o=w()(e.prototype,"depLoader",[L.x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e);n.S=V}).call(this,r("dx_E9Eu"))},dx_TfZh:function(e,n,r){"use strict";var o=r("dx_hbEN"),i=r("dx_cDcd");n.S=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2?arguments[2]:void 0,c=Object(i.useRef)(e);Object(i.useLayoutEffect)((function(){c.current=e}),[e]);var a=Object(i.useMemo)((function(){return Object(o.default)((function(){return c.current.apply(c,arguments)}),n,r)}),[]);return Object(i.useLayoutEffect)((function(){return function(){return a.cancel()}}),[a]),a}},dx_Tpqa:function(e,n,r){"use strict";(function(t){r.d(n,"u",(function(){return u}));var e=r("dx_QILm"),o=r.n(e),i=r("dx_n2nw"),c=r("dx_PcQO"),a=r("dx_cDcd"),l=r.n(a),s=r("dx_zghO"),u=(r("dx_OzdR"),function(e){var n=e.block,r=e.selectionAPI,a=e.commentModule,u=e.getEquationRange,d=o()(e,["block","selectionAPI","commentModule","getEquationRange"]);return l.a.createElement(c.Popover,Object.assign({trigger:"hover",showArrow:!1,overlayClassName:"equation-add-comment-popover",content:l.a.createElement(c.Tooltip,{title:t("CreationDoc_DocX_MenuOption_Comment"),overlayClassName:"equation-comment-btn-tooltip",popupAlign:{targetOffset:[0,4]}},l.a.createElement(c.Button,{type:"text",className:"equation-add-comment-btn",icon:l.a.createElement(i.S,null),onClick:function(){if(n){var e=u();if(e&&r&&a){var o=e.toPosition(),i=o.start,c=o.len,l=[{id:n.id,selection:{start:i,end:i+c},type:s.j.TEXT}];a.triggerStartNewDocComment({callSource:"Toolbox",selectedBlocks:l})}}}})),popupMotion:"slide-down",mouseEnterDelay:200,mouseLeaveDelay:300},d))})}).call(this,r("dx_E9Eu"))},dx_TqzH:function(e,n,r){},dx_Tsyy:function(e,n,r){"use strict";r.d(n,"S",(function(){return i})),r.d(n,"s",(function(){return c})),r.d(n,"t",(function(){return a})),r.d(n,"R",(function(){return l})),r.d(n,"w",(function(){return s})),r.d(n,"v",(function(){return u})),r.d(n,"o",(function(){return d})),r.d(n,"L",(function(){return f}));var o=r("dx_Vvd7"),i=382,c=200,a=10,l=1/24,s=2,u=16,d=24-2*s,f=[o.W.INSERT_CHILD,o.W.REMOVE_CHILD]},dx_Tumq:function(e,n,r){"use strict";var o;r.d(n,"c",(function(){return o})),r.d(n,"j",(function(){return i})),r.d(n,"N",(function(){return c})),r.d(n,"p",(function(){return a})),function(e){e.TitlesChange="TitleChange",e.UrlsChange="UrlsChange"}(o||(o={}));var i={PREVIEW_POPOVER_CONTEXT:"docx_preview_popover_context",DOCX_EMBED_DOC:"docx_embed_doc"},c={ASK_ACHIEVE:"ask_achieve",LEAVE_DOM:"leave_dom",ENTER_DOM_ASKING:"enter_dom_asking"},a={WRAPPER_CLEAR:"wrapper_clear",WRAPPER_LEAVE:"wrapper_leave",WRAPPER_HIDE:"wrapper_hide",WRAPPER_SHOW:"wrapper_show"}},dx_U1UJ:function(e,n,r){},dx_U2Uz:function(e,n,r){"use strict";r.d(n,"y",(function(){return _}));var o=r("dx_VkAN"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_QILm"),s=r.n(l),u=r("dx_vF1F"),d=r("dx_bL3f"),f=r("dx_cDcd"),h=r.n(f),p=r("dx_yzqx"),v=r("dx_TfZh"),g=r("dx_IWVf"),b=r("dx_lUPZ"),y=r("dx_QbWy");function m(){var e=i()(["\n        .ud__popover-content {\n          padding: 0;\n          border: 0;\n        }\n      "]);return m=function(){return e},e}var _=function(e){var n=e.emojiId,r=e.onEmojiChange,o=e.disabled,i=e.onClick,c=s()(e,["emojiId","onEmojiChange","disabled","onClick"]),l=Object(f.useCallback)((function(e){null===r||void 0===r||r(e)}),[r]),_=Object(f.useRef)(!1),k=Object(f.useState)(!1),O=a()(k,2),x=O[0],E=O[1],S=Object(f.useState)(!1),C=a()(S,2),I=C[0],B=C[1],T=Object(f.useCallback)((function(){_.current=!!n,E(!0)}),[n]),w=Object(f.useCallback)((function(){E(!1)}),[]),R=Object(v.S)((function(e){B(e)}),y.V);Object(f.useEffect)((function(){n&&x&&_.current?R(!0):R(!1)}),[n,x,R]);var M=Object(f.useCallback)((function(e){null===i||void 0===i||i(e)}),[i]);return h.a.createElement(b.z,Object.assign({overlayClassName:Object(u.Z)(m())},p.S.isMobile?{visible:!1}:{visible:I},{content:h.a.createElement("div",{style:{height:300,overflowY:"auto"}},h.a.createElement(g.o,{onSelect:l})),showArrow:!1,onOverlayMouseEnter:T,onOverlayMouseLeave:w,mouseEnterDelay:0,mouseLeaveDelay:0}),h.a.createElement(b.W,Object.assign({disabled:o,onClick:M,icon:n?h.a.createElement(g.D,{code:n,fallbackType:1,size:24}):h.a.createElement(d.S,{style:{fontSize:23,color:o?"var(--N300)":"var(--N500)"}})},p.S.isMobile?null:{onMouseEnter:T,onMouseLeave:w},c)))}},dx_U4Wv:function(e,n,r){"use strict";(function(t){r.d(n,"D",(function(){return P})),r.d(n,"e",(function(){return K}));var e,o=r("dx_RIqP"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_UtDZ"),s=r("dx_PyL4"),u=r.n(s),d=r("dx_xlCA"),f=r("dx_ukKW"),h=r("dx_eSV8"),p=r("dx_Y2Dh"),v=r("dx_B28d"),g=r("dx_vOIB"),b=r("dx_PhLz"),y=r("dx_KXll"),m=r("dx_u3Zu"),_=r("dx_B8Bh"),k=r("dx_GLPm"),O=r("dx_I11I"),x=r("dx_s1qv"),E=r("dx_gDjg"),S=r("dx_wqNP"),C=r("dx_ZG9w"),I=r("dx_HX5J"),B=r("dx_QHTI"),T=r("dx_o2oA"),w=r("dx_ZEh2"),R=r("dx_hgdd"),M=r("dx_vwWk");function j(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function D(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?j(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function A(e){return Object(w.R)(JSON.stringify(e,null,0))}function P(e){return JSON.parse(Object(w.N)(e))}var L=(e={},a()(e,v.B.HEADING1,"h1"),a()(e,v.B.HEADING2,"h2"),a()(e,v.B.HEADING3,"h3"),a()(e,v.B.HEADING4,"h4"),a()(e,v.B.HEADING5,"h5"),a()(e,v.B.HEADING6,"h6"),a()(e,v.B.HEADING7,"div"),a()(e,v.B.HEADING8,"div"),a()(e,v.B.HEADING9,"div"),e);function N(e){if(!Object(y.z)(e))return"";var n=Object(B.k)(e,"inline");return"<span ".concat(V(x.INLINE_COMPONENT_TYPE.FILE)," ").concat(H(n),'><span class="').concat(T.I,'">').concat(e.file.name,"</span></span>")}function F(e){if(!Object(m.Z)(e))return"";var n=Object(B.p)(e);return"<span ".concat(H(n),'><span class="').concat(T.I,'">').concat(e.issueKey,"</span></span>")}function U(e,n){var r,o=n.getRecord(e);if(!o)return console.error("fail to find record for inlineblock ".concat(e)),"";if(![v.B.FILE,v.B.JIRA_ISSUE].includes(o.snapshot.type))return console.error("can not handle non-file inlineblock ".concat(o.snapshot.type)),"";var i=(r={},a()(r,v.B.FILE,N),a()(r,v.B.JIRA_ISSUE,F),r)[o.snapshot.type];return i?i(o.snapshot):""}function H(e){var n=u.a.escapeHTMLAttribute(JSON.stringify(e));return'data-meta-block-props="'.concat(n,'"')}function V(e){return'data-inline-type="'.concat(e,'"')}function W(e){return e?e.replace(/[\u200b-\u200f\uFEFF\u202a-\u202e]/g,""):""}function z(e,n,r){var o;try{o=JSON.parse(e)}catch(R){return console.error("parse inline component error, mark is:",e),""}var i=o,c=i.type,a=i.data;if(c===x.INLINE_COMPONENT_TYPE.USER){var l=a.uid,s=d.n.getUserShowName(l),u=Object(B.u)(a);n="<span ".concat(V(c)," ").concat(H(u),'><span class="').concat(T.I,'">').concat(s?"@".concat(s," "):"","</span></span>")}else if(c===x.INLINE_COMPONENT_TYPE.REMINDER){var f=a,h=f.is_whole_day,p=f.expire_time,v=Object(B.d)(a);n='<span class="j-block-container"><span '.concat(V(c)," ").concat(H(v),">").concat(Object(S.R)(p,h),"</span></span>")}else if(c===x.INLINE_COMPONENT_TYPE.DOC){var g=a,y=g.raw_url,m=g.token,_=g.file_type,k=g.title,O=Object(E.A)(m,_,k),C=Object(E.n)(r),I=Object(E.P)(C,m),w="<span ".concat(V(c),' class="').concat(Object(B.P)(a),'"><a href="').concat(y,'" data-href=').concat(y,">").concat(O,"</a></span>");n=I?O:w}else if(c===x.INLINE_COMPONENT_TYPE.FILE){n=N(Object(b.q)(a,!0))}return n}var G=function(e,n,r){var o=e.editorAPI.viewService.getBlockViewByBlockId(e.id);if(!o)return"";for(var i=r(e.id),c=o.model.zoneState.slice(i.start,i.end).getContent(),a=Object(C.Q)(c.ops,["link","localLink"]),l="",s=0;s<a.length;s++){var d=a[s],f=d.attributes||{};if("true"!==f.fixEnter||"\n"!==d.insert){var h=u.a.escapeHTML(W(d.insert));if(f[x.INLINE_COMPONENT_MARK]){if(!(h=z(f[x.INLINE_COMPONENT_MARK],h,n)))continue}else if(f[O.B]&&!(h=U(f[O.B],n)))continue;if(f.link||f.localLink){var p=f.link||f.localLink,v=decodeURIComponent(p);h='<a href="'.concat(v,'">').concat(h,"</a>")}f.inlineCode&&(h="<code>".concat(h,"</code>")),f.bold&&(h="<strong>".concat(h,"</strong>")),f.italic&&(h="<em>".concat(h,"</em>")),f.underline&&(h="<u>".concat(h,"</u>")),f.strikethrough&&(h="<s>".concat(h,"</s>"));var g=[];if(f.textHighlight&&g.push("color:".concat(f.textHighlight)),f.textHighlightBackground&&g.push("background-color:".concat(f.textHighlightBackground)),g.length>0&&(h='<span style="'.concat(g.join(";"),'">').concat(h,"</span>")),f.equation){var b=u.a.escapeHTMLAttribute(JSON.stringify(Object(B.N)(f.equation)));h='<span class="j-block-container"><span data-meta-block-props="'.concat(b,'"><span class="block-paste-placeholder">$$$$').concat(f.equation,"$$$$</span></span></span>")}l+=h}}return l};function K(e){var n=e.nodes,r=e.model,o=e.children,c=e.blockManager,s=e.headingModule,u=e.needInherit,d=e.getTextSelectRange,b=e.parentModel,y=r.type,m=r.recordId,O={},x={attrs:O,tagName:"div",recordId:r.record.id},E=r;if(function(e,n){if(e.isTextBlock){var r=n.style||"";n.style="white-space:pre;".concat(r)}}(r,O),!u)return x.text=G(E,c,d),x.tagName="div",n.push(x),n;!function(e,n){var r,o=(null===n||void 0===n||null===(r=n.style)||void 0===r?void 0:r.split(";"))||[],i=e.record.snapshot;i.align&&o.push("text-align:".concat(e.record.snapshot.align));1===i.text_indent&&i.type===v.B.TEXT&&o.push("text-indent:2em");i.background_color&&o.push("background:".concat(i.background_color));o.length&&(n.style=o.join(";"))}(r,O);try{if(v.o.includes(y)){var S=G(E,c,d);O.class="ace-line",x.text=S;var C=Object(g.q)(r);switch([].concat(i()(v.O),[v.B.TEXT,v.B.QUOTE]).includes(y)&&C>1&&(x.text=Object(I.Q)(2*(C-1),"&nbsp;")+x.text),y){case v.B.PAGE:x.tagName="div";break;case v.B.TEXT:case v.B.HEADING1:case v.B.HEADING2:case v.B.HEADING3:case v.B.HEADING4:case v.B.HEADING5:case v.B.HEADING6:case v.B.HEADING7:case v.B.HEADING8:case v.B.HEADING9:var T,w=/^heading/.test(y),j=r.record.snapshot,P=j.seq,N=j.text_indent,F=s&&s.getOrder(m),U=null;F&&(U="".concat(F[F.length-1]));var H=w?L[y]:"div",V=r.children.length>0&&1===C;P||V?(T={tagName:H,text:x.text,attrs:{}},x.children=[{tagName:P?"li":"div",children:[T].concat(i()(V?[{tagName:"ul",children:o}]:[]))}],P?(x.tagName="ol",x.attrs?x.attrs.start=U||"1":x.attrs={start:U||"1"},x.children[0].attrs={"data-list":"number"}):x.tagName="ul",delete x.text):(T=x,0===o.length&&""===S?x.text="<br />":(x.tagName=H,x.children=o)),T.attrs||(T.attrs={}),w?T.attrs.class="heading-".concat(y.substr(-1)):1===N&&y===v.B.TEXT&&(O.class+=" text-indent");break;case v.B.ORDERED:case v.B.BULLET:case v.B.TODO:var W,z="";if(y===v.B.TODO){var q=r.record.snapshot.done;z="".concat(q?"done":"check")}else z=y===v.B.ORDERED?"number":"bullet";O["data-list"]=z,x.tagName="li",x.text="<div>".concat(x.text,"</div>"),(null===(W=r.record.snapshot.children)||void 0===W?void 0:W.length)&&(x.children=[{tagName:y===v.B.ORDERED?"ol":"ul",children:o,attrs:{class:"list-".concat(z).concat(Object(g.q)(r)+1)}}]),b&&Object(_.K)(b.type)||(x={children:[x],tagName:y===v.B.ORDERED?"ol":"ul",attrs:{start:c.orderMap.get(r.record.id)||"1",class:"list-".concat(z,"1")}});break;case v.B.QUOTE:x.tagName="blockquote";break;case v.B.CODE:x.tagName="pre";var X={};X["data-wrap"]=String(!!r.record.snapshot.wrap),x.children=[{tagName:"code",text:"<div>".concat(G(E,c,d),"</div>"),attrs:D({class:"language-".concat(r.record.snapshot.language)},X)}],delete x.text}O.class?O.class+=" ace-line":O.class="ace-line"}else switch(O["data-type"]=y,x.children=[{tagName:"span",attrs:{class:"block-paste-placeholder"},text:t("CreationDoc_DocX_CrossFilePaste_Display_no_toast")}],y){case v.B.VIEW:var Y=r.children[0].id;return K({nodes:n,model:c.getBlockModelByBlockId(Y),children:o,blockManager:c,headingModule:s,needInherit:u,getTextSelectRange:d,parentModel:b});case v.B.DIVIDER:x.children=[{tagName:"hr"}];break;case v.B.GRID:x.children=[],Object(R.t)(o,n,c);break;case v.B.GRID_COLUMN:x.children=o;break;case v.B.CALLOUT:var J=r.record.snapshot,Z=J.emoji_id,Q=J.background_color,$=J.border_color;x.tagName="div",x.attrs={class:"zoneType-calloutBlock"},x.children=[{attrs:{class:"callout-container","data-emoji-id":Z},tagName:"div",children:[{tagName:"div",attrs:{class:"callout-block",style:"background-color:".concat(Q,";border-color:").concat($)},children:o}]}];break;case v.B.QUOTE_CONTAINER:x.tagName="blockquote",x.children=o;break;case v.B.IMAGE:var ee,te,ne,re,oe=r.record.snapshot,ie=oe.image.token,ce=Object(l.generatePublicUrl)({fileToken:ie},!0);O["data-ace-gallery-json"]=JSON.stringify({items:[Object(M.r)(c,r.record.id)]}),O.class="image-uploaded gallery",x.children=[{tagName:"img",attrs:{"data-no-request-src":ce,"data-single-block":"true","data-snapshot":A(oe),"data-suite":A({fileToken:ie,objType:l.FILE_TYPE.DOCX,objToken:r.record.id,originSrc:Object(f.T)(ie,r.record.id)}),"data-src":Object(f.T)(ie,r.record.id),"data-width":(null===(ee=r.record.snapshot)||void 0===ee||null===(te=ee.image)||void 0===te?void 0:te.width)||"","data-height":(null===(ne=r.record.snapshot)||void 0===ne||null===(re=ne.image)||void 0===re?void 0:re.height)||""}}];break;case v.B.SHEET:var ae,le=Object(k.U)(r.snapshot.token).id,se=(null===(ae=r.bridge)||void 0===ae?void 0:ae.handleCopy(le))||t("CreationDoc_DocX_Load_Block",void 0,"Sheets",t("CreationDoc_DocX_Sheets"));delete x.children,x.text=se;break;case v.B.MINDMAP:case v.B.BITABLE:var ue,de=(ue={},a()(ue,v.B.BITABLE,"BITABLE"),a()(ue,v.B.MINDMAP,"MINDNOTE"),ue)[y];x={tagName:"div",attrs:{class:"block-id-".concat(m," block-type-").concat(de,"_BLOCK")},children:[{tagName:"div",attrs:{class:"j-block-container"},children:[{tagName:"span",attrs:{"data-meta-block-props":Object(B.S)(r)}}]}]};break;case v.B.POLL:x={tagName:"div",attrs:{class:"block-id-".concat(m," block-type-POLL_BLOCK")},children:[{tagName:"div",attrs:{class:"j-block-container"},children:[{tagName:"span",attrs:{"data-meta-block-props":Object(B.S)(E)},children:[{tagName:"span",attrs:{class:"block-autonomous-region dom-pass-empty-check ignore-collect"},children:[{tagName:"span",attrs:{class:"block-paste-placeholder"},text:t("CreationDoc_DocX_CrossFilePaste_Display_no_toast")}]}]}]}]};break;case v.B.IFRAME:x.attrs={"data-meta-block-props":Object(B.S)(r),class:"j-block-container"};break;case v.B.BOOKMARK:x.attrs={"data-meta-block-props":Object(B.S)(r),class:"j-block-container"},x.children=[{tagName:"span",attrs:{class:"block-paste-placeholder"},text:r.snapshot.bookmark.url||t("CreationDoc_DocX_CrossFilePaste_Display_no_toast")}];break;case v.B.TASK:var fe,he=E,pe=Boolean(he.taskData.completed_milli_time);fe="".concat(pe?"done":"check"),O["data-list"]=fe,x.tagName="li",x.children=o,x.text="<div>".concat(he.toPlainText(),"</div>"),x={children:[x],tagName:"ul",attrs:{start:"1",class:"list-".concat(fe,"1")}};break;case v.B.ISV:var ve=Object(B.S)(r);x={tagName:"span",attrs:{class:"block-id-".concat(m," block-type-ISV_BLOCK block-placeholder")},children:[{tagName:"div",attrs:{class:"j-block-container"},children:[{tagName:"span",attrs:{"data-meta-block-props":ve},children:[{tagName:"span",attrs:{class:"block-autonomous-region dom-pass-empty-check ignore-collect"},children:[{tagName:"span",attrs:{class:"block-paste-placeholder"},text:t("CreationDoc_DocX_CrossFilePaste_Display_no_toast")}]}]}]}]};break;case v.B.CHAT_CARD:var ge=x.children;Object.assign(O,{class:"j-block-container"}),x.children=[{tagName:"span",attrs:{class:"clientside-chatcard","data-clientside-chatcard-props":Object(B.S)(r)},children:ge}];break;case v.B.FILE:var be=Object(p.N)(r.record,c);Object.assign(O,{"data-meta-block-props":Object(B.S)(r,be),class:"j-block-container"});break;case v.B.DIAGRAM:x={tagName:"div",attrs:{class:"block-id-".concat(m," block-type-DIAGRAM_BLOCK block-placeholder")},children:[{tagName:"div",attrs:{class:"j-block-container"},children:[{tagName:"span",attrs:{"data-meta-block-props":Object(B.S)(r)},children:[{tagName:"span",attrs:{class:"block-autonomous-region dom-pass-empty-check ignore-collect"},children:[{tagName:"span",attrs:{class:"block-paste-placeholder"},text:t("CreationDoc_DocX_CrossFilePaste_Display_no_toast")}]}]}]}]}}}catch(ye){return console.error(ye),Object(h.n)("\u751f\u6210 html \u590d\u5236\u5185\u5bb9\u51fa\u9519\uff01\u590d\u5236 block \u4e2d\u53ef\u80fd\u6709\u810f\u6570\u636e\uff01"),n}return n.push(x),n}}).call(this,r("dx_E9Eu"))},dx_U5UJ:function(e,n,r){"use strict";r.d(n,"a",(function(){return o})),r.d(n,"w",(function(){return i})),r.d(n,"o",(function(){return c})),r.d(n,"L",(function(){return a})),r.d(n,"l",(function(){return l})),r.d(n,"t",(function(){return s})),r.d(n,"d",(function(){return u})),r.d(n,"Q",(function(){return d})),r.d(n,"E",(function(){return f})),r.d(n,"Ei",(function(){return h}));var o="printing",i=4e4,c="<!DOCTYPE html>",a="SourceCodePro",l="KaTeX",s=".editor-container",u="TIAWBFTROSIDWYKTTIAW",d="beginPrint",f="docx_comment_load_cover",h=".print"},dx_U67U:function(e,n,r){"use strict";r.d(n,"z",(function(){return C}));var o,i,c=r("dx_J4zp"),a=r.n(c),l=r("dx_lSNA"),s=r.n(l),u=r("dx_WFDE"),d=r("dx_Icqc"),f=r("dx_UtDZ"),h=r("dx_Fimk"),p=r("dx_bvq6"),v=r("dx_FA1D"),g=r("dx_qx8A"),b=r.n(g);function y(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function m(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?y(Object(r),!0).forEach((function(n){s()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}!function(e){e.EnSpellingError="1001",e.CnSpellingError="2001",e.PunctuationError="1007"}(i||(i={}));var _=(o={},s()(o,u.ClickKey.Feedback,"feedback"),s()(o,u.ClickKey.Ignore,"dsiable"),s()(o,u.ClickKey.Replace,"apply"),s()(o,u.ClickKey.Delete,"apply"),s()(o,u.ClickKey.AddDict,"add_dict"),o),k=[];function O(e,n){var r,o=e.rule_description,i=e.rule_id,c=e.origin_text,l=o.split("@"),s=a()(l,4),u=s[1],d=s[2],h=s[3];return{scene_type:"docx",container_id:n,word_id:Object(f.encryptTea)("".concat((null===(r=window.User)||void 0===r?void 0:r.id)||"","_").concat(n,"_").concat(c,"_").concat(h)),correction_id:u,error_type:i,offset:Number.parseInt(h),model:d}}function x(e){for(var n=0,r=Object.keys(e);n<r.length;n++){var o=r[n];if("link"===o||"equation"===o||"inline-component"===o||"inlineCode"===o&&"true"===e[o])return!0}return!1}var E=!1;b.a.subscribe((function(){var e=function(){var e=Object(f.getMinaConfig)("lark_ai_grammarly_check_docx",!1),n=b.a.getState().appState,r=n.userSettings,o=n.translate.status.translated;return e&&!o&&1===Object(v.B)(r,"lang_correction_perm")}();if(e!==E){var n=document.body;e?n.setAttribute("data-smart-correction","true"):n.removeAttribute("data-smart-correction"),E=e,k.forEach((function(e){return e.onEnabledChanged(E)}))}}));var S=new Map;function C(e,n){var r=Object(f.getToken)(),o=S.get(r)||"";o||(o=Object(f.encryptTea)(Object(f.getToken)()),S.set(r,o));var c=new p.O({editor:e,isEnabled:function(){return E},sessionId:o,popupOptions:{locale:f.i18nHelper.getLocale(),group:"docx-editor-kit",showAddToDictionary:!0,popupPadding:10},urls:{check:"/space/data/ai/v2/aiBatchService",ignore:"/data/ai/userIgnore",addToDictionary:"/data/ai/updateAiUserVocab"},hooks:{show:function(e){Object(h.N)("asl_ai_correction_underscore_view",m(m({},O(e,o)),{},{action_type:"show"}))},showPopup:function(e){Object(h.N)("asl_ai_correction_view",O(e,o))},click:function(e,n){if(Object(h.N)("asl_ai_correction_click",m(m({},O(e,o)),{},{target:"none",click:_[n]})),n===u.ClickKey.Ignore){var r=e.rule_id;r===i.CnSpellingError||r===i.EnSpellingError||i.PunctuationError}else u.ClickKey.AddDict}},filterSmartCorrectionByAttr:x,onEnabledChangedAction:function(){},shouldCheckWhenInit:n.model.isCreatedByPaste});return c.setTheme(Object(d.getCurrentThemeType)()===d.ThemeType.DARK?"dark":"light"),k.push(c),c}},dx_U9rT:function(e,n,r){"use strict";r.d(n,"i",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("mindmap-blockdep-loader")},dx_UOHj:function(e,n,r){"use strict";r.d(n,"K",(function(){return x}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_GLPm"),m=r("dx_KTtu"),_=r("dx_Dw4b"),k=r("dx_m0BX");function O(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var x=function(e){h()(r,e);var n=O(r);function r(e){var o;s()(this,r),(o=n.call(this,e)).type=m.V.SheetBlock,o.key=void 0,o.cellId=void 0,o.row=void 0,o.col=void 0,o.sheetId=void 0,o.bridge=void 0,o.scrollManage=void 0;var i=e.row,c=e.col,a=e.key,l=e.cellId,u=e.sheetId,d=e.bridge,f=e.scrollManage;return o.bridge=d,o.row=i,o.col=c,o.key=a,o.cellId=l,o.sheetId=u,o.scrollManage=f,o}return d()(r,[{key:"replaceWith",value:function(e){if(this.isReplaceable&&this.bridge&&this.sheetId){var n={replaceText:e,context:{row:this.row,col:this.col,key:this.cellId,searchKey:this.key,blockId:this.sheetId,isReplaceable:this.isReplaceable},isReplaceAll:!1};this.bridge.replaceSearchItem(this.sheetId,n)}}},{key:"scrollIntoView",value:function(e,n,r,o){var c=this,l=this.row,s=this.col,u=this.blockId,d=this.bridge,f=this.sheetId,h=this.scrollManage,p=n.getRecordByBlockId(this.blockId).id;return e.scrollToRecord(p,a()(i.a.mark((function e(){var a,p,v,g,b,m,_,O,x,E,S,C,I;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((p=d.bridge.sheetManager.imp.getSheetFromId(f))&&h){e.next=3;break}return e.abrupt("return");case 3:v=r.getBlockRect(u).top+Object(k.F)(n),g=p.getCellRect(l,s),b=g.height,m=g.width,_=p.measureRowPos(l,s),O=v+_,x=v+_+b,Object(k.E)({startTop:O,endBottom:x,scrollContainer:o}),E=p._measurer.cell2DocPos(l,s),S=E.x,C={x:S+m,y:_},I=null===(a=c.bridge.getSheetViewContent(f))||void 0===a?void 0:a.colHeaderWidth,Object(y.ak)(h,C,I),p._scrollToCol(s);case 14:case"end":return e.stop()}}),e)}))))}},{key:"isReplaceable",get:function(){return!0}}]),r}(_.S)},dx_USRY:function(e,n,r){"use strict";r.d(n,"W",(function(){return i})),r.d(n,"t",(function(){return o}));var o,i="view";!function(e){e.Card="Card",e.Preview="Preview",e.Inline="inline"}(o||(o={}))},dx_USq6:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o),c=r("dx_O87h"),a=r("dx_JMEe");n.S=function(e){return e.isSSR?i.a.createElement(a.L,e):i.a.createElement(c.S,e)}},dx_UTG8:function(e,n,r){"use strict";var o=r("dx_tQ7S");r.o(o,"InputPipe")&&r.d(n,"InputPipe",(function(){return o.InputPipe}));var i=r("dx_jNP1");r.d(n,"InputPipe",(function(){return i.J}))},dx_Udhu:function(e,n,r){"use strict";var o;r.d(n,"F",(function(){return o})),function(e){e.Editor="editor",e.Sheet="sheet",e.Search="search",e.Comment="comment",e.Catalog="catalog",e.MenuEvent="menuEvent",e.Equation="equation",e.PollInputFocus="PollInputFocus"}(o||(o={}))},dx_Ufnh:function(e,n,r){"use strict";(function(t){var e=r("dx_PcQO"),o=r("dx_TSYQ"),i=r.n(o),c=r("dx_h6a8"),a=r("dx_cDcd"),l=r.n(a),s=r("dx_CqjN"),u=r("dx_O3Oi"),d=r("dx_NIiI");r("dx_QXYb");n.S=function(n){var r=n.type,o=n.size,a=n.order,f=n.className,h=n.theme,p=n.locked,v=n.showConfidentialTip,g=n.isMobile,b=n.style,y=n.onShowSimpleModal,m=void 0===y?c.noop:y,_=n.onConfidentialTipVisibleChange,k=void 0===_?c.noop:_,O=i()("serial-number",f,"serial-number_".concat(o),"serial-number_".concat(h)),x=Object(s.i)({onClick:function(){k(!0),m({title:t("CreationMobile_Docs_OKR_Locked_Title"),content:t("CreationMobile_Docs_OKR_Locked_Tooltips"),buttons:[{text:t("CreationMobile_Docs_OKR_Locked_GotIt"),onClick:function(){k(!1)}}]})}}),E=l.a.createElement(l.a.Fragment,null,l.a.createElement(d.s,{className:"serial-num-content",number:a+1,type:r,size:o}),p&&l.a.createElement(u.S,{className:i()("serial-number__lock","serial-confidentiality-icon")})),S=g?l.a.createElement("div",{className:O,style:b,onTouchStart:x,onTouchEnd:x,onTouchMove:x},E):l.a.createElement(e.Tooltip,{title:t("CreationDoc_Docs_OKR_Locked_Tooltips"),placement:"top",onVisibleChange:k},l.a.createElement("div",{className:O,style:b},E));return v&&p?S:l.a.createElement("div",{className:O,style:b},E)}}).call(this,r("dx_E9Eu"))},dx_UhQm:function(e,n,r){"use strict";var o=r("dx_O75l");r.d(n,"r",(function(){return o.r}))},dx_UoSD:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 2a2 2 0 012-2h14a2 2 0 012 2v14a2 2 0 01-2 2H2a2 2 0 01-2-2V2z",fill:"#4954E6"}),l=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.75 5.79v4.414a2.007 2.007 0 004.013 0V5.79H4.56v4.415a.803.803 0 11-1.605 0V5.79H1.75zm5.217 0h1.204v6.421H6.967v-6.42zm4.415 0h1.204v6.421h-1.204V9.028l-1.07 3.183h-1.07l-1.07-3.21V5.79l1.604 4.622 1.606-4.623zm2.408 0h1.204v5.217H17v1.204h-3.21V5.79z",fill:"#fff"});n.S=function(e){return i.a.createElement("svg",c({width:18,height:18,viewBox:"0 0 18 18",fill:"none"},e),a,l)}},dx_Urdh:function(e,n,r){"use strict";(function(t){r.d(n,"w",(function(){return c}));var e=r("dx_B28d"),o=r("dx_UTG8"),i=r("dx_HirW");function c(n){var r=n.data,c=r.recordIds,a=r.recordMap,l=r.payloadMap;Object(i.H)(c,a,(function(n){var r,i,c=a[n].snapshot.type;![e.B.SHEET,e.B.BITABLE,e.B.MINDMAP].includes(c)||(null===(r=l[n])||void 0===r?void 0:r.html)||(null===(i=l[n])||void 0===i?void 0:i.initData)||(a[n]={id:n,snapshot:{type:e.B.TEXT,text:o.InputPipe.deserializePlainText(t("block.failed_to_copy_loading_block"))}})}))}}).call(this,r("dx_E9Eu"))},dx_Usbk:function(e,n,r){},dx_UydN:function(e,n,r){"use strict";r.d(n,"a",(function(){return x})),r.d(n,"m",(function(){return E})),r.d(n,"Z",(function(){return C}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lSNA"),s=r.n(l),u=r("dx_e4eN"),d=r("dx_M30o"),f=r("dx_alfx"),h=r("dx_MoY1"),p=r("dx_B28d"),v=r("dx_NsKf"),g=r("dx_ZG9w"),b=r("dx_WAOj"),y=r("dx_zghO"),m=r("dx_ppc6"),_=r("dx_xWRc");function k(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function O(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?k(Object(r),!0).forEach((function(n){s()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function x(e,n,r){var o=r.getService(m.S),i=Object(b.Z)(n,r),c=o.getSelection();if(0===c.length)return null;for(var a=c[0],l=c[c.length-1],s=i.map((function(e){return e.model})),d=i.slice(a.type===y.j.TEXT?1:0),f=d.filter((function(e){return!d.find((function(n){return n.id===e.parentId}))})).map((function(e){return e.model})),k=[],O=function(e){var n=d[e].model;if(n.type===p.B.VIEW)return"continue";var r=c.find((function(e){return e.id===n.id}));if(r&&r.type===y.j.BLOCK)return"continue";n.children.forEach((function(e){d.find((function(n){return n.id===e.id}))||k.push(e)}))},x=d.length-1;x>=0;x--)O(x);var E=k.map((function(e){return e.recordId}));if(a.type===y.j.TEXT){var S=a.id,C=s[0],I=Object(_.M)(C,a.selection.start,r);Object(h.y)(e,f),Object(h.y)(e,k);var B,T=Object(_.D)(s[0]),w=T.parentRecordId,R=T.position;if(Object(h.t)(e,w,R,E),l.type===y.j.TEXT){var M=l.selection.end,j=s[s.length-1].zoneState.split([M,M]);B=new u.m({zoneId:C.zoneId}).retain(I).delete(C.zoneState.totalWidth()-I-1),j[1].getContent().forEach((function(e){var n;"\n"===e.insert&&"true"===(null===(n=e.attributes)||void 0===n?void 0:n.fixEnter)||(B=B.insert(e.insert,e.attributes))}));var D=j[1].toAttributeText();Object(g.Z)(D).forEach((function(n){return e.replace(n,["parent_id"],C.recordId)}))}else B=new u.m({zoneId:C.zoneId}).retain(I).delete(C.zoneState.totalWidth()-I-1);return C.apply(B,{extra:{op:e}}),{id:S,position:I}}if(a.type===y.j.BLOCK&&l.type===y.j.TEXT){var A=s[0],P=A.position,L=A.parent.recordId,N=l.id;Object(h.y)(e,f);var F=s[s.length-1];Object(h.t)(e,L,P,[F.recordId]),Object(h.y)(e,k),Object(h.t)(e,F.recordId,0,E);var U=l.selection.end,H=new u.m({zoneId:F.zoneId}).delete(U);return F.apply(H,{extra:{op:e}}),{id:N,position:0}}var V=s[0],W=V.position,z=V.parent.recordId;Object(h.y)(e,f);var G=Object(v.u)({}),K=Object(h.l)(e,z,W,[G])[0];return Object(h.y)(e,k),Object(h.t)(e,K,0,E),{recordId:K,position:0}}function E(e,n){var r=n.getService(m.S),o=n.viewService;return x(e,r.getSelection().filter((function(e){return o.hasBlockViewByBlockId(e.id)})).map((function(e){return o.getBlockViewByBlockId(e.id)})),n)}function S(e,n,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},c=o.id,a=o.position,l=void 0===a?0:a,s=o.recordId;if(c){var h=e.getBlockModelByBlockId(c),p=h.record.snapshot.text,v=Object(f.Z)(p.initialAttributedTexts,p.apool).get("0"),g=h.zoneState,b=new u.m({zoneId:String(c)}).delete(g.totalWidth()-1).concat(v).compose(new u.m({zoneId:String(c)}).retain(l).insert(r));return h.apply(b,O({extra:{op:n}},i)),n.replace(h.record.id,["text"],h.zoneState.toAttributeText()),h.recordId}if(s){var y=(new u.m).insert(r),m=Object(f.P)((new d.q).add("0",y));return n.replace(s,["text"],m),s}}function C(e,n){return I.apply(this,arguments)}function I(){return I=a()(i.a.mark((function e(n,r){var o,c,a,l,s,u,d,f,h,p,v,g=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.selectionAPI,c=n.editorAPI,a=g.length>2&&void 0!==g[2]?g[2]:{},l=a.beforeReplace,s=a.afterReplaced,u=g.length>3&&void 0!==g[3]?g[3]:{},d=c.modelService,h=0,e.next=7,d.applyTransaction("insertText",(function(e){var n=E(e,c);n&&(h=n.position,null===l||void 0===l||l(),r&&(f=S(d,e,r,n,u)))}));case 7:if(f){e.next=9;break}return e.abrupt("return");case 9:p=d.getBlockModelsByRecordId(f),v=h+((null===r||void 0===r?void 0:r.length)||0),o.setSelection([{type:y.j.TEXT,id:p[0].id,selection:{start:v,end:v}}]),null===s||void 0===s||s();case 13:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}},dx_UzKd:function(e,n,r){},dx_V2Xs:function(e,n,r){},dx_V5C0:function(e,n,r){"use strict";r.d(n,"u",(function(){return Oe}));var o,i,c,a,l,s,u,d,f,h,p,v,g,b,y,m,_,k,O,x,E,S,C,I=r("dx_yG8O"),B=r.n(I),T=r("dx_lwsE"),w=r.n(T),R=r("dx_W8MJ"),M=r.n(R),j=r("dx_PJYZ"),D=r.n(j),A=r("dx_W7W2"),P=r.n(A),L=r("dx_a1gu"),N=r.n(L),F=r("dx_Nsbk"),U=r.n(F),H=r("dx_Uyc2"),V=r.n(H),W=(r("dx_A1AB"),r("dx_Vvd7")),z=r("dx_YRGG"),G=r("dx_RIqP"),K=r.n(G),q=r("dx_J4zp"),X=r.n(q),Y=r("dx_xjz2"),J=r("dx_UtDZ"),Z=r("dx_B28d"),Q=r("dx_hSCS"),$=r("dx_k8kI"),ee=r("dx_MMMl"),te=r("dx_MGm1"),ne=Object(Y.s)(te.B)((i=function(){function e(){var n=this;w()(this,e),this.loadableBlockTypes=new Set([Z.B.MINDMAP,Z.B.BITABLE,Z.B.SHEET]),this.loadingBlockSet=new Set,B()(this,"modelService",c,this),B()(this,"eventEmitter",a,this),B()(this,"layoutManager",l,this),this.flushTimer=void 0,this.isFlushed=!1,this.initBlockLoadingStatus=function(){n.layoutManager.getViewportBlocks().forEach((function(e){var r=n.modelService.getBlockModelByBlockId(e);r&&n.loadableBlockTypes.has(r.type)&&n.loadingBlockSet.add(null===r||void 0===r?void 0:r.recordId)})),0===n.loadingBlockSet.size&&(null===J.resourceSchedulerHelpers||void 0===J.resourceSchedulerHelpers||J.resourceSchedulerHelpers.scheduler.disableSchedule(),n.flushAll())},this.handleBufferChanged=function(e){var r=e.leaveBlocks;0!==n.loadingBlockSet.size&&(r.forEach((function(e){var r=n.modelService.getBlockModelByBlockId(e).recordId;n.loadingBlockSet.delete(r)})),0===n.loadingBlockSet.size&&(Object(J.collectEvent)("resource_scheduler_dev",{action:"no_loadable_block_after_scroll_flush_at_once",timestamp:Date.now()}),n.eventEmitter.removeListener($.a,n.handleBufferChanged),n.flushAll()))}}return M()(e,[{key:"init",value:function(){this.eventEmitter.addListenerOnce($.w2,this.initBlockLoadingStatus),this.eventEmitter.addListener($.a,this.handleBufferChanged),this.isFlushed=!1}},{key:"destroy",value:function(){this.eventEmitter.removeListener($.w2,this.initBlockLoadingStatus),this.eventEmitter.removeListener($.a,this.handleBufferChanged),clearTimeout(this.flushTimer),this.flushTimer=null,this.loadingBlockSet.clear(),this.isFlushed=!1}},{key:"handleFirstSlice",value:function(e){var n=this,r=Object.entries(e.block_map).some((function(e){var r=X()(e,2),o=(r[0],r[1]);return n.loadableBlockTypes.has(o.data.type)}));r||(null===J.resourceSchedulerHelpers||void 0===J.resourceSchedulerHelpers||J.resourceSchedulerHelpers.scheduler.disableSchedule(),null===J.resourceSchedulerHelpers||void 0===J.resourceSchedulerHelpers||J.resourceSchedulerHelpers.scheduler.flushAll(),Object(J.collectEvent)("resource_scheduler_dev",{action:"no_loadable_block_flush_at_once",timestamp:Date.now()})),r&&(this.flushTimer=setTimeout((function(){n.flushAll(),Object(J.collectEvent)("resource_scheduler_exception_dev",{action:"flush_task_queue_timeout",isOnline:"".concat(Object(J.isOnline)()),is_visible:"visible"==="".concat(document.visibilityState),block_remain:K()(n.loadingBlockSet).map((function(e){var r=n.modelService.getBlockModelsByRecordId(e);return r[0]?r[0].type:"unknown"})).join("/")})}),2e4))}},{key:"onBlockReady",value:function(e){0!==this.loadingBlockSet.size&&(this.loadingBlockSet.delete(e),0===this.loadingBlockSet.size&&this.flushAll())}},{key:"flushAll",value:function(){var e=this;this.isFlushed&&Object(J.collectEvent)("resource_scheduler_exception_dev",{action:"flush_multiple_times",block_remain:K()(this.loadingBlockSet).map((function(n){var r=e.modelService.getBlockModelsByRecordId(n);return r[0]?r[0].type:"unknown"})).join("/")}),this.isFlushed=!0,null===J.resourceSchedulerHelpers||void 0===J.resourceSchedulerHelpers||J.resourceSchedulerHelpers.scheduler.flushAll(),clearTimeout(this.flushTimer),this.flushTimer=null,this.eventEmitter.removeListener($.a,this.handleBufferChanged)}}]),e}(),c=V()(i.prototype,"modelService",[W.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=V()(i.prototype,"eventEmitter",[Q.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=V()(i.prototype,"layoutManager",[ee.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=i))||o,re=r("dx_o0o1"),oe=r.n(re),ie=r("dx_yXPU"),ce=r.n(ie),ae=r("dx_K9Ia"),le=r("dx_Fimk"),se=r("dx_eSV8"),ue=r("dx_qUru"),de=r("dx_WHqS"),fe=(s=Object(Y.a)(),u=Object(Y.e)(),h=function(){function e(){w()(this,e),this.blocksFetching=new Set,this.blocksFetched=new Set,this.blocksError=new Set,this.fetchedComponentMap=new Map,this.$fetchFinish=new ae.Z,this.$fetchFail=new ae.Z,B()(this,"fetchers",f,this),this.fetchTimerMap=new Map,this.typeToRetryCountMap=new Map}return M()(e,[{key:"isBlockFetching",value:function(e){return this.blocksFetching.has(e)}},{key:"getFetcher",value:function(e){return this.fetchers.get().find((function(n){return n.type===e}))}},{key:"fetchBlock",value:function(){var e=ce()(oe.a.mark((function e(n,r){var o,i,c,a,l,s,u=this;return oe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.blocksFetching.has(n)){e.next=2;break}return e.abrupt("return");case 2:if(this.blocksFetching.add(n),o=this.getFetcher(n)){e.next=11;break}return this.blocksError.add(n),this.blocksFetching.delete(n),this.$fetchFail.next(n),console.error("can not find creator of loadable block, type: ".concat(n)),Object(le.N)("ccm_docx_loadable_block_component_dev",{extra:"can not find creator of loadable block, type: ".concat(n)}),e.abrupt("return");case 11:if(o.fetchResource){e.next=17;break}return this.blocksError.add(n),this.blocksFetching.delete(n),this.$fetchFail.next(n),console.error("loadable block ".concat(n," should implement fetchResource interface")),e.abrupt("return");case 17:return e.prev=17,i=!1,c=this.typeToRetryCountMap.has(n),a=c?ue.k:ue.G,l=window.setTimeout((function(){if(u.blocksFetching.delete(n),i=!0,u.typeToRetryCountMap.has(n))if(u.typeToRetryCountMap.get(n)<ue.O){var e=u.typeToRetryCountMap.get(n);u.typeToRetryCountMap.set(n,e+1),u.fetchBlock(n,r)}else Object(le.N)("ccm_docx_loadable_block_component_dev",{extra:"maximum retry fetch block, block type: ".concat(n)}),Object(se.n)(new Error("maximum retry fetch block, block type: ".concat(n))),u.blocksError.add(n),u.$fetchFail.next(n);else u.typeToRetryCountMap.set(n,1),u.fetchBlock(n,r)}),a),this.fetchTimerMap.set(n,l),Object(le.N)("ccm_docx_loadable_block_component_dev",{start_fetch_type:n}),e.next=26,0===r?o.fetchResource():J.resourceSchedulerHelpers.scheduler.addTask({action:function(){return o.fetchResource()},name:n});case 26:s=e.sent,clearTimeout(l),this.fetchTimerMap.delete(n),i||(this.typeToRetryCountMap.delete(n),this.blocksFetched.add(n),this.blocksFetching.delete(n),this.blocksError.delete(n),this.fetchedComponentMap.set(n,s),this.$fetchFinish.next(n)),e.next=40;break;case 32:e.prev=32,e.t0=e.catch(17),this.blocksError.add(n),this.blocksFetching.delete(n),this.$fetchFail.next(n),Object(le.N)("ccm_docx_loadable_block_component_dev",{extra:"fetching resource error, block type: ".concat(n)}),console.error("fetching resource error, block type: ".concat(n),e.t0),Object(se.n)(new Error("fetching resource error, block type: ".concat(n)));case 40:case"end":return e.stop()}}),e,this,[[17,32]])})));return function(n,r){return e.apply(this,arguments)}}()},{key:"isBlockFetched",value:function(e){return this.blocksFetched.has(e)}},{key:"setBlockFetched",value:function(e){this.blocksFetching.delete(e),this.blocksFetched.add(e)}},{key:"destroy",value:function(){this.fetchTimerMap.forEach((function(e){return clearTimeout(e)})),this.fetchers.get().forEach((function(e){var n;return null===(n=e.destroy)||void 0===n?void 0:n.call(e)})),this.$fetchFail.complete(),this.$fetchFinish.complete()}}]),e}(),d=h,f=V()(d.prototype,"fetchers",[s,u,de.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d),he=r("dx_jtB3"),pe=r("dx_yzqx"),ve=r("dx_dIhn"),ge=r("dx_FvGq"),be=r("dx_EqZO"),ye=r("dx_hd5n"),me=r("dx_NpE2"),_e=(p=Object(Y.s)(ye.b),v=Object(Y.d)(fe),p((b=function(){function e(){var n=this;w()(this,e),B()(this,"loadableController",y,this),B()(this,"modelService",m,this),B()(this,"layoutManager",_,this),B()(this,"eventEmitter",k,this),this.pendingRecordIds=new Set,this.renderRecordIds=new Set,this.recordRenderStatusMap=new Map,this.pureIdleWorker=void 0,this.noLoadableBlockInFirstScreen=!1,this.fetchBlockResourceIdleCallbackId=null,this.isIdleWorkerRunning=!1,this.isAllowedToEdit=!1,this.loadableBlockTypes=void 0,this.subs=void 0,this.reporter=new me.W,this.handleFirstScreen=function(){n.layoutManager.getViewportBlocks().forEach((function(e){var r=n.modelService.getBlockModelByBlockId(e);if(r&&n.loadableBlockTypes.includes(r.record.snapshot.type)){var o=r.recordId;n.renderRecordIds.add(o),n.recordRenderStatusMap.has(o)||n.recordRenderStatusMap.set(o,ue.Z.LOADING)}})),0===n.renderRecordIds.size&&(n.noLoadableBlockInFirstScreen=!0,n.startIdleWorker())},this.onBlockFetchFinish=function(e){Object(le.N)("ccm_docx_loadable_block_component_dev",{loaded_resource:e}),Array.from(n.renderRecordIds).forEach((function(r){n.modelService.getRecordByRecordId(r).snapshot.type===e&&(n.recordRenderStatusMap.get(r)!==ue.Z.LOADING&&n.recordRenderStatusMap.has(r)||(n.recordRenderStatusMap.set(r,ue.Z.RENDERING),n.reporter.report("ccm_docx_loadable_block_component_dev",{rendering_ids:[Object(J.encryptTea)(r)]},{mergeKey:"rendering_ids",delay:10*me.WF}),n.modelService.getBlockModelsByRecordId(r).forEach((function(e){var r=e.id;n.eventEmitter.emit(ue.n,r)}))))}))},this.onBlockFetchFail=function(e){n.getRenderBlocksByType(e).forEach((function(e){n.reporter.report("ccm_docx_loadable_block_component_dev",{error_ids:[Object(J.encryptTea)(e.recordId)]},{mergeKey:"error_ids",delay:10*me.WF}),n.eventEmitter.emit(ue.n,e.id)}))},this.handleBufferChanged=function(e){var r=e.enterBlocks,o=e.leaveBlocks;r.forEach((function(e){return n.handleEnterBuffer(e)})),o.forEach((function(e){return n.handleLeaveBuffer(e)}))},this.handleEnterBuffer=function(e){var r=n.modelService.getBlockModelByBlockId(e),o=r.type,i=r.recordId;n.loadableBlockTypes.includes(o)&&(n.renderRecordIds.add(i),n.pendingRecordIds.delete(i),n.loadableController.isBlockFetching(o)||n.loadableController.isBlockFetched(o)||n.loadableController.blocksError.has(o)?n.loadableController.isBlockFetched(o)&&(n.recordRenderStatusMap.get(i)!==ue.Z.LOADING&&n.recordRenderStatusMap.has(i)||(n.recordRenderStatusMap.set(i,ue.Z.RENDERING),n.reporter.report("ccm_docx_loadable_block_component_dev",{rendering_ids:[Object(J.encryptTea)(i)]},{mergeKey:"rendering_ids",delay:10*me.WF}),n.modelService.getBlockModelsByRecordId(i).forEach((function(e){var r=e.id;n.eventEmitter.emit(ue.n,r)})))):n.loadableController.fetchBlock(o))},this.handleBlockAttach=function(e){!n.loadableBlockTypes.includes(e.type)||n.pendingRecordIds.has(e.recordId)||n.renderRecordIds.has(e.recordId)||(n.loadableController.fetchBlock(e.type),n.renderRecordIds.add(e.recordId),n.recordRenderStatusMap.set(e.recordId,ue.Z.LOADING))},this.handleBlockUpdate=function(e){var r=e.recordId,o=e.type;n.loadableBlockTypes.includes(o)?n.renderRecordIds.has(r)||n.pendingRecordIds.has(r)||(n.loadableController.fetchBlock(o),n.renderRecordIds.add(r),n.recordRenderStatusMap.set(r,ue.Z.LOADING)):o!==Z.B.PENDING&&(n.pendingRecordIds.delete(r),n.renderRecordIds.delete(r),n.recordRenderStatusMap.delete(r))},this.handleBlockDetach=function(e){var r=e.type,o=e.recordId;n.loadableBlockTypes.includes(r)&&r!==Z.B.PENDING&&(n.pendingRecordIds.delete(o),n.renderRecordIds.delete(o),n.recordRenderStatusMap.delete(o))},this.handleLeaveBuffer=function(e){var r=n.modelService.getBlockModelByBlockId(e).recordId;n.renderRecordIds.has(r)&&n.recordRenderStatusMap.get(r)===ue.Z.LOADING&&(n.renderRecordIds.delete(r),n.pendingRecordIds.add(r))},this.idleConsumeRenderQueue=function(){var e=Array.from(n.renderRecordIds),r=e.find((function(e){return n.recordRenderStatusMap.get(e)===ue.Z.LOADING&&!n.loadableController.blocksFetching.has(n.modelService.getRecordByRecordId(e).snapshot.type)}));if(!r){var o=Array.from(n.pendingRecordIds).filter((function(e){return n.recordRenderStatusMap.get(e)!==ue.Z.RENDERED})),i=o.shift();if(!i)return n.stopIdleWorker(),n.prefetchResourceWhenIdle(),{done:!0};e.unshift(i),r=i,n.renderRecordIds=new Set(e),n.pendingRecordIds=new Set(o)}var c=n.modelService.getRecordByRecordId(r);return n.loadableController.fetchedComponentMap.has(c.snapshot.type)?(n.recordRenderStatusMap.set(r,ue.Z.RENDERING),n.modelService.getBlockModelsByRecordId(c.id).forEach((function(e){var r=e.id;n.eventEmitter.emit(ue.n,r)}))):n.loadableController.fetchBlock(c.snapshot.type),{done:!1}},this.onBlockDidRender=function(e){var r=n.modelService.getBlockModelByBlockId(e);if(r){n.recordRenderStatusMap.set(r.recordId,ue.Z.RENDERED),n.reporter.report("ccm_docx_loadable_block_component_dev",{rendered_ids:[Object(J.encryptTea)(r.recordId)]},{mergeKey:"rendered_ids",delay:10*me.WF});Array.from(n.renderRecordIds).every((function(e){if(!n.modelService.hasRecordByRecordId(e))return!1;var r=n.modelService.getRecordByRecordId(e),o=n.loadableController.blocksError.has(r.snapshot.type);return n.recordRenderStatusMap.get(r.id)===ue.Z.RENDERED||o}))&&n.pureIdleWorker.start()}},this.retryFetchBlock=function(e){var r=n.modelService.getBlockModelByBlockId(e),o=r.recordId,i=r.type;n.recordRenderStatusMap.delete(o),n.loadableController.blocksError.delete(i),n.loadableController.fetchBlock(i)},this.traverseRecord=function(e,r,o){var i=r[e];i&&(o(i),(i.data.children||[]).forEach((function(e){return n.traverseRecord(e,r,o)})))},this.handleFirstSlice=function(e){Object.keys(e.block_map).forEach((function(r){return n.traverseRecord(r,e.block_map,(function(e){n.loadableBlockTypes.includes(e.data.type)&&(n.renderRecordIds.add(e.id),n.recordRenderStatusMap.set(e.id,ue.Z.LOADING))}))})),0===n.renderRecordIds.size&&(n.noLoadableBlockInFirstScreen=!0)},this.beforeRootBlockCreate=function(){new Set(n.getRenderBlocks().map((function(e){return e.type}))).forEach((function(e){n.loadableController.fetchBlock(e,0)}))},this.handleNonFirstSlice=function(e){var r,o=e.clientvar,i=e.taskId;Object(J.getToken)()!==i&&n.layoutManager.getViewportBlocks().includes(null===(r=n.modelService.getBlockModelsByRecordId(i)[0])||void 0===r?void 0:r.id)?Object.keys(o.block_map).forEach((function(e){return n.traverseRecord(e,o.block_map,(function(e){n.loadableBlockTypes.includes(e.data.type)&&(n.renderRecordIds.add(e.id),n.loadableController.fetchBlock(e.data.type),n.recordRenderStatusMap.set(e.id,ue.Z.LOADING))}))})):(Object.keys(o.block_map).forEach((function(e){return n.traverseRecord(e,o.block_map,(function(e){if(n.loadableBlockTypes.includes(e.data.type)){if(pe.S.isMobile&&"file"===e.data.type)return;n.recordRenderStatusMap.set(e.id,ue.Z.LOADING),n.pendingRecordIds.add(e.id)}}))})),n.noLoadableBlockInFirstScreen&&n.startIdleWorker())},this.handleAllowEdit=function(){n.isAllowedToEdit=!0,n.startIdleWorker(),n.prefetchResourceWhenIdle()}}return M()(e,[{key:"init",value:function(e){this.loadableBlockTypes=e.loadableBlockTypes,Object(le.N)("ccm_docx_loadable_block_component_dev",{loadable_types:JSON.stringify(this.loadableBlockTypes)}),this.bindEvent(),this.pureIdleWorker=new he.Y(this.idleConsumeRenderQueue)}},{key:"bindEvent",value:function(){this.eventEmitter.addListenerOnce($.w2,this.handleFirstScreen),this.eventEmitter.addListener($.a,this.handleBufferChanged),this.eventEmitter.addListener(ge.d,this.handleBlockAttach),this.eventEmitter.addListener(ge.F,this.handleBlockUpdate),this.eventEmitter.addListener(ge.o,this.handleBlockDetach),this.eventEmitter.addListener(ge.Q,this.beforeRootBlockCreate),this.eventEmitter.on(be.R.CLIENTVAR_FETCH_SKIPPED_BLOCK_DONE,this.handleNonFirstSlice),this.eventEmitter.on(be.R.CLIENTVAR_APPLY_ALL_DONE,this.handleAllowEdit),this.subs=[this.loadableController.$fetchFinish.subscribe(this.onBlockFetchFinish),this.loadableController.$fetchFail.subscribe(this.onBlockFetchFail)]}},{key:"unBindEvent",value:function(){var e;this.eventEmitter.removeListener($.w2,this.handleFirstScreen),this.eventEmitter.removeListener($.a,this.handleBufferChanged),this.eventEmitter.removeListener(ge.d,this.handleBlockAttach),this.eventEmitter.removeListener(ge.F,this.handleBlockUpdate),this.eventEmitter.removeListener(ge.o,this.handleBlockDetach),this.eventEmitter.removeListener(ge.Q,this.beforeRootBlockCreate),this.eventEmitter.off(be.R.CLIENTVAR_FETCH_SKIPPED_BLOCK_DONE,this.handleNonFirstSlice),this.eventEmitter.off(be.R.CLIENTVAR_APPLY_ALL_DONE,this.handleAllowEdit),null===(e=this.subs)||void 0===e||e.forEach((function(e){return e.unsubscribe()}))}},{key:"getRenderBlocks",value:function(){var e=this;return Array.from(this.renderRecordIds).reduce((function(n,r){return n.concat(e.modelService.getBlockModelsByRecordId(r))}),[])}},{key:"getRenderBlocksByType",value:function(e){return this.getRenderBlocks().filter((function(n){return n.type===e}))}},{key:"isBlockError",value:function(e){var n=this.modelService.getBlockModelByBlockId(e);return null!=n&&this.loadableController.blocksError.has(n.type)}},{key:"canBlockRender",value:function(e){var n=this.modelService.getBlockModelByBlockId(e);return null!=n&&this.renderRecordIds.has(n.recordId)&&this.loadableController.fetchedComponentMap.has(n.type)}},{key:"getBlockComponent",value:function(e){return this.loadableController.fetchedComponentMap.get(e)}},{key:"startIdleWorker",value:function(){this.pureIdleWorker.start(),this.isIdleWorkerRunning=!0}},{key:"stopIdleWorker",value:function(){this.isIdleWorkerRunning=!1,this.pureIdleWorker.stop()}},{key:"getBlockTypesToPrefetch",value:function(){var e=this;return this.loadableBlockTypes.filter((function(n){var r;if(e.loadableController.isBlockFetching(n)||e.loadableController.isBlockFetched(n))return!1;var o=e.loadableController.getFetcher(n);return null===o||void 0===o||null===(r=o.canPrefetchResource)||void 0===r?void 0:r.call(o)}))}},{key:"prefetchResourceWhenIdle",value:function(){var e=this;!this.isAllowedToEdit||this.isIdleWorkerRunning||this.pendingRecordIds.size||Array.from(this.renderRecordIds).some((function(n){return e.recordRenderStatusMap.get(n)!==ue.Z.RENDERED}))||0===this.getBlockTypesToPrefetch().length||(this.cancelFetchBlockResourceIdleCallback(),this.fetchBlockResourceIdleCallbackId=Object(ve.f)((function(){e.fetchBlockResourceIdleCallbackId=null,e.getBlockTypesToPrefetch().forEach((function(n){return e.loadableController.fetchBlock(n)}))})))}},{key:"cancelFetchBlockResourceIdleCallback",value:function(){null!=this.fetchBlockResourceIdleCallbackId&&(Object(ve.L)(this.fetchBlockResourceIdleCallbackId),this.fetchBlockResourceIdleCallbackId=null)}},{key:"destroy",value:function(){this.unBindEvent(),this.reporter.destroy(),this.loadableController.destroy(),this.pureIdleWorker.stop(),this.cancelFetchBlockResourceIdleCallback()}}]),e}(),y=V()(b.prototype,"loadableController",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=V()(b.prototype,"modelService",[W.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_=V()(b.prototype,"layoutManager",[ee.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),k=V()(b.prototype,"eventEmitter",[Q.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),g=b))||g);function ke(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=U()(e);if(n){var i=U()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return N()(this,r)}}var Oe=Object(W.H)({providers:[fe,_e,ne]})((C=function(e){P()(r,e);var n=ke(r);function r(){var e;w()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),B()(e,"scheduler",E,D()(e)),B()(e,"resourceScheduler",S,D()(e)),e}return M()(r,[{key:"init",value:function(){this.scheduler.init(this.options),this.resourceScheduler.init()}},{key:"destroy",value:function(){this.scheduler.destroy(),this.resourceScheduler.destroy()}}]),r}(W.G),x=C,E=V()(x.prototype,"scheduler",[z.b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),S=V()(x.prototype,"resourceScheduler",[z.B],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),O=x))||O},dx_V5y6:function(e,n,r){},dx_V6VR:function(e,n,r){"use strict";(function(t){r.d(n,"J",(function(){return v}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_B28d");function p(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var v=function(e){l()(r,e);var n=p(r);function r(){return o()(this,r),n.apply(this,arguments)}return c()(r,[{key:"getText",value:function(){return"[".concat(t("common.divider"),"]")}}]),r}(r("dx_NMQJ").D);v.type=h.B.DIVIDER}).call(this,r("dx_E9Eu"))},dx_VByW:function(e,n,r){},dx_VC8Z:function(e,n,r){"use strict";r.d(n,"S",(function(){return O}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_cDcd"),b=r.n(g),y=r("dx_USRY");function m(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function _(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?m(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var O=function(e){d()(r,e);var n=k(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"getWrapper",value:function(e){return function(n){var r,o,i,c,a=null===(r=n.recursionProps)||void 0===r?void 0:r.isShortcut,l=null===(o=n.recursionProps)||void 0===o?void 0:o.isPDF;return"file"===(null===(i=n)||void 0===i?void 0:i.type)&&(null===(c=n)||void 0===c?void 0:c.viewType)&&a&&!l&&(n=_(_({},n),{},{viewType:y.t.Card})),b.a.createElement(e,n)}}}]),r}(r("dx_Vau3").A)},dx_VF3B:function(e,n,r){},dx_VHoe:function(e,n,r){"use strict";var o;r.d(n,"Q",(function(){return o})),function(e){e.NORMAL="normal",e.NO_PERMISSION="no_permission",e.REQUIRE_LOGIN="require_login",e.NO_FILE="no_file",e.ERROR="error",e.UNKOWN="unkown"}(o||(o={}))},dx_VKNB:function(e,n,r){"use strict";var o;function i(){if(!o){(o=document.createElement("div")).setAttribute("id","@editor-kit-mention-container--task-block"),o.style.position="absolute",o.style.top="0px",o.style.left="0px";var e=document.body;e.firstChild?e.insertBefore(o,e.firstChild):e.append(o)}return o}r.d(n,"p",(function(){return i}))},dx_VLtj:function(e,n,r){},dx_VOUh:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("block-manager")},dx_VQSE:function(e,n,r){"use strict";r.d(n,"V",(function(){return c}));var o=r("dx_xWWg");function i(e){if(!e)return"";var n,r,i=[];return n=e.rich_text,r=function(e,n){n.tag===o.t.TEXT?i.push(n.property.text.content):n.tag===o.t.AT?i.push(n.property.at.user_id):n.tag===o.t.A?i.push(n.property.anchor.href):i.push(" ")},n&&n.element_ids&&0!==n.element_ids.length&&n.element_ids.forEach((function(e){var o,i;!function e(o,i){i&&(r(o,i),i.child_ids&&i.child_ids.length&&i.child_ids.forEach((function(r){var o,i;return e(r,null===(o=n.elements)||void 0===o||null===(i=o.dictionary)||void 0===i?void 0:i[r])})))}(e,null===(o=n.elements)||void 0===o||null===(i=o.dictionary)||void 0===i?void 0:i[e])})),i.join("")}function c(e,n){return i(e)===i(n)}},dx_VWMO:function(e,n,r){"use strict";var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W7W2"),a=r.n(c),l=r("dx_a1gu"),s=r.n(l),u=r("dx_Nsbk"),d=r.n(u),f=r("dx_Vvd7"),h=r("dx_N9dL"),p=r("dx_B28d"),v=r("dx_dbks"),g=r("dx_NMQJ"),b=r("dx_USRY");function y(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var m=function(e){a()(r,e);var n=y(r);function r(e){return i()(this,r),n.call(this,e)}return r}(g.D);m.type=b.W;var _=r("dx_lSNA"),k=r.n(_),O=r("dx_W8MJ"),x=r.n(O),E=r("dx_iWIM"),S=r.n(E),C=r("dx_jtB3"),I=r("dx_UtDZ"),B=r("dx_cDcd"),T=r.n(B),w=r("dx_Fimk"),R=r("dx_MGoZ");r("dx_uqy0");function M(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function j(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?M(Object(r),!0).forEach((function(n){k()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function D(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var A,P,L=function(e){a()(r,e);var n=D(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).checkIsEmpty=function(){if(!e.props.recursionProps.isHistory){var n=e.record.snapshot.children;n&&n.length||Object(w.N)("docx_no_children_view_block_dev",{has_children:"false",file_id:Object(I.encryptTea)(Object(I.getToken)())})}},e.getViewSnapshot=function(){var n=e.record.snapshot.children;if(!n||!n.length)return null;var r=e.blockManager.getBlockIdsByRecordId(n[0])[0],o=e.blockManager.getBlockViewByBlockId(r);return o&&o.getViewSnapshot?o.getViewSnapshot():null},e}return x()(r,[{key:"blockViewDidMount",value:function(){S()(d()(r.prototype),"blockViewDidMount",this).call(this),this.checkIsEmpty()}},{key:"render",value:function(){var e=this,n=this.record.snapshot,r=n.view_type,o=n.children;if(!o||!o.length)return null;var i=this.props,c=i.blockId,a=i.recursionProps,l=a.blockManager;return T.a.createElement(C.R,{id:c,reconciler:l.layoutManager.getReconciler(),renderChild:function(n,o){return e.props.editorAPI.viewService.render(n,{recursionProps:a,viewType:r,hostElementRef:o})},childContainerTag:"div",watchProps:j(j({},a),{},{viewType:r})})}}]),r}(R.l);function N(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}L.type=b.W;var F=Object(f.H)({providers:[{provide:h.RecordSnapshotCreator,useValue:{type:p.B.VIEW,create:v.T}}]})((P=function(e){a()(r,e);var n=N(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).blocks=[[m,{viewCreator:L}]],e}return r}(f.y),A=P))||A,U=F;n.S=U},dx_VXD2:function(e,n,r){"use strict";function o(){return document.querySelector(".editor-container")}function i(){var e=o(),n=window.getComputedStyle(e),r=n.width,i=n.paddingLeft,c=n.paddingRight;return parseFloat(r)-parseFloat(i)-parseFloat(c)}r.d(n,"s",(function(){return o})),r.d(n,"N",(function(){return i}))},dx_VXLZ:function(e,n,r){"use strict";r.d(n,"Z",(function(){return o}));var o="mentionBlock"},dx_VY1y:function(e,n,r){"use strict";r.d(n,"v",(function(){return a})),r.d(n,"a",(function(){return l})),r.d(n,"M",(function(){return s})),r.d(n,"C",(function(){return u})),r.d(n,"e0",(function(){return d})),r.d(n,"Ar",(function(){return f})),r.d(n,"O",(function(){return h})),r.d(n,"J",(function(){return p})),r.d(n,"Y",(function(){return v})),r.d(n,"j",(function(){return g})),r.d(n,"vM",(function(){return b})),r.d(n,"A",(function(){return y})),r.d(n,"e",(function(){return m}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_B28d"),a=10,l=4,s=9,u=16,d=[].concat(i()(c.hI),[c.B.CODE]),f=[c.B.IMAGE,c.B.DIVIDER,c.B.USER,c.B.MENTION_DOC,c.B.CHAT_CARD,c.B.DIAGRAM,c.B.IFRAME,c.B.SHEET,c.B.BITABLE,c.B.FILE,c.B.UML,c.B.FLOWCHART,c.B.VIEW,c.B.REMINDER,c.B.ISV,c.B.MINDMAP,c.B.POLL,c.B.TASK,c.B.OKR],h=[c.B.GRID,c.B.TABLE,c.B.CALLOUT,c.B.QUOTE_CONTAINER],p=[c.B.BITABLE,c.B.TABLE,c.B.SHEET,c.B.IFRAME],v="horizontalWidthChange",g="halfFullScreenStateChanged",b="cursor-above-author",y=[c.B.FILE],m=c.O.filter((function(e){return!isNaN(Number(e[e.length-1]))})).sort((function(e,n){return Number(e[e.length-1])-Number(n[n.length-1])}))},dx_Vau3:function(e,n,r){"use strict";r.d(n,"A",(function(){return l}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=function(){function e(n){i()(this,e),this.options=n}return a()(e,[{key:"destroy",value:function(){}},{key:"editorAPI",get:function(){return this.blockManager.editorAPI}},{key:"blockManager",get:function(){return this.options.blockManager}},{key:"selectionAPI",get:function(){return this.options.selectionAPI}},{key:"boundary",get:function(){return this.options.boundary}},{key:"fold",get:function(){return this.options.fold}},{key:"comment",get:function(){return this.options.commentModule}},{key:"message",get:function(){return this.options.messageModule}},{key:"undoModule",get:function(){return this.options.undoModule}},{key:"scroller",get:function(){return this.options.scroller}},{key:"profile",get:function(){return this.options.profile}},{key:"rect",get:function(){return this.options.rect}},{key:"viewPort",get:function(){return this.options.viewport}},{key:"vcController",get:function(){return this.options.vcController}},{key:"eventEmitter",get:function(){return this.options.eventEmitter}}]),e}()},dx_Vd2b:function(e,n,r){"use strict";r.d(n,"E",(function(){return a})),r.d(n,"f",(function(){return l})),r.d(n,"r",(function(){return s}));var o=r("dx_e4eN"),i=r("dx_M30o"),c=r("dx_IdzY");function a(e,n){return l(e,n,(function(e){return e.startsWith(c.I)}))}function l(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){return!0},i=n.length()-1,c=n.getZoneId(),a={start:{zoneId:c,line:0,offset:0},end:{zoneId:c,line:i,offset:n.getLine(i).length()-1}},l=n.getEntities(a,(function(e){return!!r(e)})),s=new o.m,u=0,d=0,f=0;return e.get("0").forEach((function(e){d+=e.insert.length})),l.forEach((function(e){var o={};Object.keys(e.attributes).filter((function(e){return r(e)})).forEach((function(n){o[n]=e.attributes[n]}));var i=n.pointToOffset(e.start)||0,c=n.pointToOffset(e.end)||0;if(!(i>d)){var a=Math.max(Math.min(c,d)-i,0),l=Math.max(i-u,0);(f=f+l+a)>d||f===d&&1===a||(s.retain(l).retain(a,o),u=c)}})),e=e.compose(s)}function s(e,n){return e.reduce((function(e,r){var o=r.reduce((function(e,r){var o={};return r.attributes&&Object.keys(r.attributes).forEach((function(e){!0!==n(e,r.attributes)&&(o[e]=r.attributes[e])})),e.insert(r.insert,o),e}),r.create({zoneId:r.zoneId}));return e.add(r.zoneId,o),e}),new i.q)}},dx_VeJB:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);r("dx_y0o7");n.S=function(e){return i.a.createElement("div",{className:"progress-circle","data-progress":e.progress},i.a.createElement("div",{className:"circle"},i.a.createElement("div",{className:"mask full"},i.a.createElement("div",{className:"fill"})),i.a.createElement("div",{className:"mask half"},i.a.createElement("div",{className:"fill"}),i.a.createElement("div",{className:"fill fix"}))),i.a.createElement("div",{className:"inset"}))}},dx_ViSK:function(e,n,r){"use strict";r.d(n,"v",(function(){return D}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_PJYZ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_N8Nu"),b=r("dx_cDcd"),y=r.n(b),m=r("dx_TSYQ"),_=r.n(m),k=r("dx_UtDZ"),O=r("dx_AIJo"),x=r("dx_dYKg"),E=r("dx_FA1D"),S=r("dx_W7Th"),C=r("dx_N25N");var I=r("dx_LcNA"),B=r("dx_uZlF"),T=r("dx_Icqc"),w=r("dx_bPy9");function R(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var M=function(e){d()(r,e);var n=R(r);function r(e){var o;i()(this,r),(o=n.call(this,e.editor)).props=void 0,o.handleKeyDown=function(e){var n=e.key;S.g.isEnabled&&!Object(E.G)(n)&&S.g.closeAbbrCard(!0)},o.handleSelectionChange=function(e){var n=e.current;if(n){if(B.A.isPointEqual(n.start,n.end))return;S.g.handleSelectionChange()}},o.props=e;var c=e.editor;return c.on(I.L.KEYDOWN,o.handleKeyDown),c.on(I.L.SELECTION_CHANGE,o.handleSelectionChange),o}return a()(r,[{key:"destroy",value:function(){this.editor.off(I.L.KEYDOWN,this.handleKeyDown),this.editor.off(I.L.SELECTION_CHANGE,this.handleSelectionChange)}},{key:"handleMouseClick",value:function(e,n){var r,o=n.lineState.getZoneId(),i=this.props.blockManager.getBlockViewByBlockId(Object(w.j)(o));if(null===(r=i.model.getSelection())||void 0===r?void 0:r.isCollapsed()){var c=i.props.recursionProps.commentModule,a=Object.keys(n.attributes).filter((function(e){return e.startsWith("comment-id")})).map((function(e){return e.slice("comment-id-".length)}));c&&a.length>0&&a.some((function(e){return!c.getCommentIsFinished(e)}))?S.g.closeAbbrCard(!0):this.handleMouseEnter(e,n)}}},{key:"handleMouseEnter",value:function(e,n){var r=n.lineState.getZoneId(),o=this.props.blockManager.getBlockViewByBlockId(Object(w.j)(r)),i=o.editor,c=o.translated,a=o.record,l=o.editPermission;if(!i.getStatus("isComposing")&&S.g.isEnabled&&!c){var s,u=this.abbreviationDataKey,d=n.attributes,f=n.lineState;try{s=JSON.parse(d[u])}catch(C){return void console.error("[\u5b9e\u4f53\u8bcd] \u6570\u636e\u8f6c\u6362\u9519\u8bef")}var h=s,p=h.id,v=h.abbr_ids,g=f.getEntities([[u,d[u]]]).map((function(e){return e.text})).join("");if(!S.g.getIgnoreAbbrSet().has(g.toLowerCase())){var b=Object(x.q)(),y=Object(x.RK)(l,a.id);S.g.preloadAbbreviations({query:g,abbrId:v,cardSource:b,biz:"doc",bizScene:"hover",extra:y}),e.currentTarget.classList.add(O.E);var m=Object(E.w)(e.nativeEvent,[e.currentTarget]),_=Object(T.getCurrentThemeType)();S.g.showAbbrCard(p,{mask:!1,margin:4,cardSource:b,analyticsParams:{file_id:Object(k.encryptTea)(Object(k.getToken)()),file_type:"docx"},showIgnore:!0,placement:["bottom","top","right","left"],abbrId:v,query:g,targetRect:m,block:o,biz:"docx",bizScene:"hover",themeType:_,extra:y})}}}},{key:"handleMouseLeave",value:function(e){e.currentTarget.classList.remove(O.E),S.g.closeAbbrCard()}}]),r}(function(){function e(n){i()(this,e),this.editor=void 0,this.abbreviationDataKey=void 0,this.editor=n,Object(x.Z)()?this.abbreviationDataKey=O.F:this.abbreviationDataKey=O.b}return a()(e,[{key:"destroy",value:function(){}},{key:"handleMouseClick",value:function(e,n){}},{key:"handleMouseEnter",value:function(e,n){}},{key:"handleMouseLeave",value:function(e){}}]),e}());r("dx_MlBN");function j(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var D=function(e){d()(r,e);var n=j(r);function r(e){var o;return i()(this,r),(o=n.call(this)).isReadHighlightEnabled=!1,o.inlineWrapperCache=new Map,o.service=void 0,o.cacheContext=new Map,o.abbreviationDataKey=O.b,o.handleMouseClick=function(e,n){var r=s()(o),i=r.service,c=r.cacheContext.get(n);if(c){var a=c.attributes,l=c.lineState;i.handleMouseClick(e,{attributes:a,lineState:l})}},o.handleMouseEnter=function(e,n){var r=s()(o),i=r.service,c=r.cacheContext.get(n);if(c){var a=c.attributes,l=c.lineState;i.handleMouseEnter(e,{attributes:a,lineState:l})}},o.handleMouseLeave=function(e){o.service.handleMouseLeave(e)},o.isReadHighlightEnabled=Object(x.Z)(),o.isReadHighlightEnabled&&(o.abbreviationDataKey=O.F),o.service=new M(e),o}return a()(r,[{key:"destroy",value:function(){this.service.destroy()}},{key:"match",value:function(e){return this.abbreviationDataKey===e}},{key:"renderInlineWrapper",value:function(e){var n=this,r=this.abbreviationDataKey,o=e.attributes,i=e.lineState;if(function(e){if("true"===e.inlineCode||e["link-id"]||e["auto-url"]||e.link)return!1;if(e[O.F])return!0;var n=JSON.parse(e[O.b]||"{}"),r=n.is_visible,o=n.is_first;return r===O.K.Visible&&("undefined"===typeof o||1===o)}(o)){var c=JSON.parse(o[r]||"{}"),a=c.id,l=c.abbr_ids;if(this.cacheContext.set(a,e),this.cacheContext.set(a,e),Object(E.E)((function(){S.g.sendEvent({abbr_id:l,file_id:Object(k.encryptTea)(Object(k.getToken)())})})),this.inlineWrapperCache.has(a))return this.inlineWrapperCache.get(a);var s=i.getEntities([[r,o[r]]]).map((function(e){return e.text})).join(""),u="abbreviation-inline-wrapper abbreviation-".concat(Object(x.H)(s)," ").concat(O.z,"-").concat(a),d=y.a.createElement("span",{spellCheck:!1,className:u,onClick:function(e){return n.handleMouseClick(e,a)},onMouseEnter:function(e){return n.handleMouseEnter(e,a)},onMouseLeave:this.handleMouseLeave});return this.inlineWrapperCache.set(a,d),d}return null}},{key:"render",value:function(e){var n=_()("abbreviation-text",C.X,{"clientside-abbreviation-text":this.isReadHighlightEnabled});return y.a.createElement("span",{className:n},e.children)}}]),r}(g.o)},dx_Vioe:function(e,n,r){"use strict";var o;r.d(n,"t",(function(){return o})),function(e){e[e.ONLY_CACHE_RESULT=0]="ONLY_CACHE_RESULT",e[e.CACHE_EVERY_ACTION=1]="CACHE_EVERY_ACTION"}(o||(o={}))},dx_VjTN:function(e,n,r){"use strict";r.d(n,"S",(function(){return k}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_TSYQ"),b=r.n(g),y=r("dx_cDcd"),m=r.n(y);r("dx_UzKd");function _(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var k=function(e){d()(r,e);var n=_(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"getWrapper",value:function(e){return function(n){var r=n.type,o=n.viewType,c=n.record.snapshot.align,a=b()("docx-".concat(r,"-block-container"),i()({},"docx-view-type-".concat(o),!!o),i()({},"docx-block-align-".concat(c),!!c));return m.a.createElement("div",{className:a},m.a.createElement("div",{className:"docx-".concat(r,"-block-inner-container")},m.a.createElement(e,n)))}}}]),r}(r("dx_Vau3").A)},dx_Vkod:function(e,n,r){"use strict";r.d(n,"c",(function(){return k})),r.d(n,"d",(function(){return O})),r.d(n,"V",(function(){return x})),r.d(n,"p",(function(){return E})),r.d(n,"D",(function(){return S}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_J4zp"),s=r.n(l),u=r("dx_hB37"),d=r("dx_h6a8"),f=r("dx_d2dg"),h=r("dx_B28d"),p=r("dx_ZG9w"),v=r("dx_kZ3l"),g=r("dx_s04s"),b=r("dx_FNDK"),y=r("dx_P58d");function m(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function _(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?m(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function k(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=new Set(n);return n.filter((function(n){for(var i=e.getBlockModelByBlockId(n);i&&i.parent;){var c=i.parent;if(r&&c.type===h.B.PAGE)break;if(o.has(c.id))return!1;i=c}return!0}))}function O(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3?arguments[3]:void 0,i=n.map((function(e){return e.id})),c={newSelectedBlockIds:i,rangeMap:{},blockIdMap:{}},a=Object(d.partition)(i,(function(n){return Object(f.k)(e.getBlockViewByBlockId(n))})),l=s()(a,1),h=l[0];return h.forEach((function(a){var l=e.getBlockModelByBlockId(a),s=n[0].id===l.id,f=n[n.length-1].id===l.id,h=Object(d.cloneDeep)(l.record);if(r&&(s||f)){var b=e.getBlockViewByBlockId(a),y=n.find((function(e){return e.id===l.id}));if(null===y||void 0===y?void 0:y.selection){var m=y.selection,_=m.start,k=m.end,O=Object(v.JI)(b.model.zoneState,[_,k]),x=new u.A({start:O.start,end:O.end,editor:b.editor,state:b.model.zoneState});c.rangeMap[a]=x,h.snapshot.text=b.model.zoneState.slice(x.start,x.end).toAttributeText()}}var E=(h.snapshot.children||[]).reduce((function(n,r){for(var c=e.getBlockModelsByRecordId(r)[0];Object(g.N)(c.type)&&!i.includes(c.id);)c=c.next;if(i.includes(c.id)){n.push(r);var a=i.indexOf(c.id);!(a>=0)||o&&o(c.id)||i.splice(a,1)}return n}),[]);h.snapshot.children=E,h.snapshot.text=Object(p.M)(h.snapshot.text,e),c.blockIdMap[a]={id:h.id,snapshot:h.snapshot}})),c}function x(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return function(i){if(o[i])return o[i];var c=n.isSingleTextSelection(r),a=e.getBlockViewByBlockId(i),l=a.model.getSelection();if(c&&l)return new u.A(_(_({},l),{},{editor:l.editor,state:a.model.zoneState}));var s=e.getBlockModelByBlockId(i).zoneState;return new u.A(_(_({},Object(v.JI)(s,[0,s.totalWidth()])),{},{editor:a.editor,state:s}))}}function E(e,n,r){var o=[],c=n.isTextSelectionAcrossBlocks(r);return c&&(o=function(e,n){return n.reduce((function(n,r){var o=r.id;if(o===e.rootBlockId){var c=e.getBlockModelByBlockId(e.rootBlockId).children.map((function(e){return e.id}));return n.push(o),n.concat(c)}var a,l=e.getBlockPath(o);if(l.length>1&&(a=n).push.apply(a,i()(l)),r.type===y.j.BLOCK){var s=new Set;e.traverse(r.id,(function(e){return!s.has(e)&&(s.add(e),!0)})),n=n.concat(Array.from(s))}return n.push(o),n}),[])}(e,r)),function(e){return!c||o.includes(e)}}function S(e){if(Object(b.L)(e)){var n,r,o=Object(d.last)(e);if(o.type===y.j.TEXT&&0===(null===(n=o.selection)||void 0===n?void 0:n.start)&&0===(null===(r=o.selection)||void 0===r?void 0:r.end))return e.slice(0,e.length-1)}return e}},dx_Vkw6:function(e,n,r){"use strict";(function(t){r.d(n,"k",(function(){return e})),r.d(n,"W",(function(){return f})),r.d(n,"l",(function(){return h}));var e,o=r("dx_PEVg"),i=r("dx_fXUy"),c=r("dx_Ufyv"),a=r("dx_MhuI"),l=r("dx_HdsT"),s=r("dx_cDcd"),u=r.n(s),d=r("dx_CkQe");!function(e){e.title="title",e.card="card",e.preview="preview",e.link="link"}(e||(e={}));var f=[{name:"slash block",type:d.F.Title,text:t("CreationDoc_Docs_WebBookmark_DisplayAs_Title"),canSelected:!1},{icon:u.a.createElement(o.S,null),name:e.title,type:d.F.MenuItemNormal,extra:{behavior:d.l.InsertBlock},text:t("CreationDoc_Docs_WebBookmark_DisplayAs_Title_Button"),action:function(){}},{icon:u.a.createElement(i.S,null),name:e.card,type:d.F.MenuItemNormal,extra:{behavior:d.l.InsertBlock},text:t("CreationDoc_Docs_PasteLink_DisplayAs_Card_Button"),action:function(){}},{icon:u.a.createElement(c.S,null),name:e.preview,type:d.F.MenuItemNormal,extra:{behavior:d.l.CreateNoOps},text:t("CreationDoc_Docs_PasteLink_DisplayAs_Embedded_Button"),action:function(){}},{name:"divider",type:d.F.Divider,canSelected:!1},{icon:u.a.createElement(a.S,null),name:e.link,type:d.F.MenuItemNormal,extra:{behavior:d.l.CreateNoOps},text:t("docs.text_correction.ignore"),action:function(){}}],h=[{name:"slash block",type:d.F.Title,text:t("CreationDoc_Docs_WebBookmark_DisplayAs_Title"),canSelected:!1},{icon:u.a.createElement(l.S,null),name:e.link,type:d.F.MenuItemNormal,extra:{behavior:d.l.CreateNoOps},text:t("CreationDoc_Docs_WebBookmark_DisplayAs_Link_Button"),action:function(){}},{icon:u.a.createElement(i.S,null),name:e.card,type:d.F.MenuItemNormal,extra:{behavior:d.l.InsertBlock},text:t("CreationDoc_Docs_WebBookmark_DisplayAs_Bookmark_Button"),action:function(){}}]}).call(this,r("dx_E9Eu"))},dx_VmZB:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return d}));var e=r("dx_K5vg"),o=r("dx_TSYQ"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c),l=r("dx_PQBD"),s=r("dx_y5yU"),u=(r("dx_kHZM"),Object(s.r)(e.S));function d(e){var n=e.blockType,r=e.maxWidth,o=e.isSelected,c=void 0!==o&&o,s=Object(l.w)(n),d={};return r&&(d.maxWidth=r),a.a.createElement("div",{contentEditable:!1,className:i()("block-error-view",{active:c}),style:d},a.a.createElement("div",{className:"block-error-view-img"},a.a.createElement(u,null)),a.a.createElement("div",{className:"block-error-view-text"},t("CreationDoc_DocX_duplicate_block_failed_content",{},"",s)))}}).call(this,r("dx_E9Eu"))},dx_Vmrz:function(e,n,r){"use strict";(function(t){r.d(n,"k",(function(){return f}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_B28d"),l=r("dx_WXfY"),s=r("dx_kZ3l"),u=r("dx_FNDK"),d=r("dx_Q9QG"),f=function(){function e(n,r){o()(this,e),this.blockManager=n,this.headingModule=r}return c()(e,[{key:"stringify",value:function(e,n,r,o){return this.toMarkdown(e,n,r,o).join("\n")}},{key:"toMarkdown",value:function(e,n,r,o){var i=this,c=Object(u.m)(n);return e.reduce((function(e,f){return i.blockManager.traverse(f,(function(f){var h=!c;if(!o(f))return h;var p=i.blockManager.getBlockViewByBlockId(f),v=i.blockManager.getBlockModelByBlockId(f);if(a.o.includes(p.type)||a.Mp.includes(p.type)){var g=Object(s.S)(r(f)),b=Object(l.Z)(v,i.blockManager.recordManager,g);d.S[v.type]&&(c&&Object(u.p)(n,i.blockManager)||!c)&&(b=d.S[p.type].stringify(b,p,v,i.blockManager,i.headingModule)),e.push(b)}else if(0===v.children.length)switch(v.type){case a.B.BOOKMARK:e.push("".concat(v.snapshot.bookmark.url||t("CreationDoc_DocX_CrossFilePaste_Display_no_toast")));break;case a.B.IMAGE:e.push("[".concat(t("common.image"),"]"));break;case a.B.DIVIDER:e.push("---");break;default:e.push(t("CreationDoc_DocX_CrossFilePaste_Display_no_toast"))}return h})),e}),[])}}]),e}()}).call(this,r("dx_E9Eu"))},dx_VmtY:function(e,n,r){"use strict";r.d(n,"N",(function(){return _})),r.d(n,"S",(function(){return k}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_cDcd"),v=r("dx_Vau3"),g=r("dx_Z8yN"),b=r("dx_D8nn"),y=r("dx_BBJ7");function m(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var _="EDIT_MODE_CHANGE",k=function(e){s()(r,e);var n=m(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"getEffect",value:function(){var e=this;return function(n){var r=Object(y.Y)(n.editorAPI).editMode,o=Object(p.useCallback)((function(e){b.S.emit(b.p.COMMON.DRAG_STATUS_CHANGE,e)}),[]);Object(p.useEffect)((function(){r===y.N.Keyboard?e.options.boundary.classList.add("keyboard-mode"):e.options.boundary.classList.remove("keyboard-mode"),e.blockManager.dispatch(_,r)}),[r]),Object(p.useEffect)((function(){return e.blockManager.addListener(g.F,o),function(){e.blockManager.removeListener(g.F,o)}}),[o])}}}]),r}(v.A)},dx_Vqq2:function(e,n,r){"use strict";r.d(n,"O",(function(){return C}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_cDcd"),b=r.n(g),y=r("dx_faye"),m=r.n(y),_=r("dx_WmT0"),k=r("dx_HqbJ"),O=r("dx_S6dX");r("dx_k8Uk");function x(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function E(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?x(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function S(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var C=function(e){d()(r,e);var n=S(r);function r(e){var o;return a()(this,r),(o=n.call(this,e)).host=void 0,o.menuNode=void 0,o.menuRef=void 0,o.handleKeyDown=function(e){e.code.startsWith("Arrow")||"Enter"===e.code||(e.stopImmediatePropagation(),e.preventDefault(),o.handleClose())},o.setPosition=function(){var e=o.state,n=e.left,r=e.top;if(void 0===n||void 0===r){var i=Object(O.f)();if(i){var c=i.getBoundingClientRect(),a=c.x,l=c.y+c.height,s=a+c.width;if(o.menuNode){var u=o.menuNode.getBoundingClientRect(),d=u.height,f=u.width,h=o.props.boundary.getBoundingClientRect(),p=h.height,v=h.width,g=h.x+v,b=h.y+p;s=Math.min(g-f,s),l=Math.min(b-d,l)}o.setState({left:s,top:l})}}},o.handleClose=function(){m.a.unmountComponentAtNode(o.host)},o.handleClick=function(e){o.props.onClick(e),o.setState({visible:!1}),m.a.unmountComponentAtNode(o.host)},o.handleClickOutSide=function(){o.setState({visible:!1}),m.a.unmountComponentAtNode(o.host)},o.setDomRef=function(e){o.menuRef=e},o.clickOutsideHandler=function(e){o.menuRef&&!o.menuRef.contains(e.target)&&o.handleClickOutSide()},o.host=e.host,o.state={visible:e.visible,left:e.left,top:e.top},o}return s()(r,[{key:"componentDidMount",value:function(){this.props.boundary.addEventListener("scroll",this.handleClose),this.setPosition(),document.addEventListener("keydown",this.handleKeyDown,!0),_.S.addListener(this.clickOutsideHandler)}},{key:"componentWillUnmount",value:function(){this.host.parentElement&&this.host.parentElement.removeChild(this.host),this.props.boundary.removeEventListener("scroll",this.handleClose),document.removeEventListener("keydown",this.handleKeyDown,!0),_.S.removeListener(this.clickOutsideHandler)}},{key:"render",value:function(){var e=this,n=this.state,r=n.visible,o=n.left,i=n.top,c=this.props.menuItems;return r?b.a.createElement("div",{ref:this.setDomRef,style:E({position:"absolute",left:o,top:i,zIndex:99},this.props.style)},b.a.createElement(k.S,{className:"clipboard-menu-container",getRef:function(n){e.menuNode=n},items:c,onSelfClose:this.handleClose,style:this.props.style,onItemClick:this.handleClick})):null}}]),r}(b.a.Component)},dx_Vsac:function(e,n,r){"use strict";var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_PJYZ"),d=r.n(u),f=r("dx_iWIM"),h=r.n(f),p=r("dx_W7W2"),v=r.n(p),g=r("dx_a1gu"),b=r.n(g),y=r("dx_Nsbk"),m=r.n(y),_=r("dx_TSYQ"),k=r.n(_),O=r("dx_UtDZ"),x=r("dx_h6a8"),E=r("dx_cDcd"),S=r.n(E),C=r("dx_bdgK"),I=r("dx_ifle"),B=r("dx_gK2j"),T=r("dx_rQGm"),w=r("dx_yzqx"),R=r("dx_ADkB"),M=r("dx_xs2W"),j=r("dx_zEdG"),D=r("dx_CwnG"),A=r("dx_B28d"),P=r("dx_MGoZ"),L=r("dx_VY1y"),N=r("dx_D8nn"),F=r("dx_T1AN"),U=r("dx_MlPX"),H=r("dx_DlF2"),V=r("dx_k8kI"),W=r("dx_g1Ip");var z=r("dx_bUp7"),G=r("dx_u6uu"),K=r("dx_HsgL"),q=r("dx_BjZo");r("dx_DPnS");function X(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Y(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?X(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function J(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var Z=[G.C.jcode],Q=function(e){v()(r,e);var n=J(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).state={isAuthorOpen:!!e.props.isViewEditors,isIframeLoaded:!1,url:e.snapshot.iframe.component.url,selected:!1,resize:null,maskVisible:w.S.isMobile&&w.S.isBytedanceApp,isIframeFreeWidth:!w.S.isMobile&&!(w.S.safari&&e.iframeConfig.renderLinkInSafari)&&Object(K.G)(d()(e))&&!e.props.recursionProps.isPresentationMode,boundaryWidth:e.boundary.clientWidth||730,hostWidth:e.hostElement.clientWidth||e.blockManager.getBlockViewByBlockId(e.blockManager.rootBlockId).hostElement.clientWidth,commentPanelShown:!!e.props.showCommentInit},e.boundaryResizeObserver=new C.S(Object(x.debounce)((function(){e.setState((function(n){var r=n.boundaryWidth,o=e.boundary.clientWidth;return o&&o!==r?{boundaryWidth:o}:null}))}),50)),e.hostElementHeight=-1,e.debounceUpdateHostWidth=Object(x.debounce)((function(){e.setState((function(n){var r=n.hostWidth,o=e.hostElement.clientWidth;return o&&o!==r?{hostWidth:o}:null}))}),50),e.hostResizeObserver=new C.S((function(){var n=e.hostElement.clientHeight;e.hostElementHeight!==n&&(e.hostElementHeight=n,e.notifyRenderFinish(),e.props.recursionProps.isPresentationMode&&N.S.emit(N.p.PRESENTATION.FORCE_UPDATE_PAGINATION)),e.debounceUpdateHostWidth()})),e.offsetX=0,e.handleCommentChange=function(n){var r=!!n;r!==e.state.commentPanelShown&&e.setState({commentPanelShown:r})},e.iframeRef=S.a.createRef(),e.iframeContainerRef=S.a.createRef(),e.needMask=w.S.isMobile&&w.S.isBytedanceApp,e.onViewEditorsMenuChange=function(n){e.setState({isAuthorOpen:n})},e.handleIframeLoad=function(){e.setState({isIframeLoaded:!0,isIframeError:!1}),window.focus()},e.handleIframeError=function(){e.setState({isIframeError:!0})},e.addRenderLinkFlag=function(){var n=e.hostElement;n&&n.classList.add("is-iframe-render-link")},e.getIframeSandBox=function(){return["allow-scripts","allow-downloads","allow-same-origin","allow-popups","allow-presentation","allow-forms"].join(" ")},e.bindWindowEventForMask=function(n){e.needMask&&(n?(window.addEventListener("focus",e.checkMaskVisible),window.addEventListener("blur",e.checkMaskVisible),window.addEventListener("touchstart",e.checkMaskVisible)):(window.removeEventListener("focus",e.checkMaskVisible),window.removeEventListener("blur",e.checkMaskVisible),window.removeEventListener("touchstart",e.checkMaskVisible)))},e.checkMaskVisible=function(){w.S.isAndroid&&setTimeout((function(){document.fullscreenElement===e.iframeRef.current&&e.callAdditionalActiveNodeOp(!0)}),50),e.state.maskVisible||document.activeElement===e.iframeRef.current||e.setMaskVisible(!0)},e.onMaskClick=function(){e.setMaskVisible(!1),e.clearAndroidCaret()},e.setMaskVisible=function(n){e.setState({maskVisible:n}),e.callAdditionalActiveNodeOp(!n)},e.callAdditionalActiveNodeOp=function(n){e.blockManager.dispatch(n?V.v.ADD:V.v.REMOVE,e.props.blockId)},e.redirectToOriginUrl=function(){var n=e.snapshot.iframe.component,r=n.original_text,o=n.url,i="";try{i=decodeURIComponent(r)}catch(a){console.error("no need to catch, just log ",a)}var c=Object(M.P)(i)?i:o;Object(K.n)(c)},e.notifyRenderFinish=function(){e.blockManager.layoutManager.notifyRenderFinish(e.id)},e.refreshIframe=function(){var n=e.snapshot.iframe.component.url,r=new URL(n).search,o=n.replace(/#/,"".concat(r.includes("?")?"":"?","&").concat(Number(new Date),"#"));n===o&&e.iframeRef.current&&(e.iframeRef.current.src=String(e.iframeRef.current.src)),e.setState({url:o,isIframeLoaded:!1,resize:null,isIframeError:void 0}),Object(O.isOnline)()||e.setState({isIframeError:!0})},e.onIframeMouseenter=function(n){e.blockManager.dispatch(F.K,d()(e));var r=n.target,o=new Event("mousemove",{bubbles:!0});r.dispatchEvent(o)},e.onLinkClick=Object(x.debounce)((function(e,n){var r=window.open(e,n,"noopener=yes,noreferrer=yes");r&&(r.opener=null)}),300,{leading:!0,trailing:!1}),e.getIframeSize=function(){if(e.state.resize)return Y({},e.state.resize);var n=e.getModelIframeSize();(!e.isIframeResized&&n.width!==e.iframeConfig.defaultWidth||!e.isIframeResized&&Z.includes(e.iframeConfig.type))&&(n=e.getSizeByWidth(e.state.hostWidth));var r=n.width;return d()(e).iframeConfig.type===G.C.tiktok&&(r+=2),{height:n.height,width:r}},e.limitIframeWidth=function(n){return Math.max(88,Math.min(e.containerWidth,n))},e.limitIframeHeight=function(e){return Math.max(88,e)},e.calcSizeByDragDiff=function(n){var r=e.getIframeResizeSize(),o=r.width,i=r.height,c=e.iframeConfig.resizeType,a=e.snapshot.align&&e.snapshot.align!==A.D.CENTER?1:2;switch(c){case G.J.Flexible:return{width:e.limitIframeWidth(o+n.diffX*a),height:e.limitIframeHeight(i+n.diffY)};case G.J.Fixed:var l=e.limitIframeWidth(o+n.diffX*a),s=o/i,u=l/s;return u<88&&(l=(u=e.limitIframeHeight(u))*s),{width:l,height:u};case G.J.UpDown:return{width:o,height:e.limitIframeHeight(i+n.diffY)};default:return{width:o,height:i}}},e.handleResizeStart=function(){N.S.emit(T.V0),e.setState({resize:e.getIframeResizeSize()})},e.handleResizeUpdate=Object(x.throttle)((function(n){var r=e.calcSizeByDragDiff(n);e.setState({resize:r})}),16),e.handleResizeEnd=function(n){N.S.emit(T.s);var r=e.getModelIframeSize(),o=r.height,i=r.width,c=e.calcSizeByDragDiff(n);e.model.applyTransaction("handleIframeResizeEnd",(function(n){n.replace(e.record.id,["iframe","width"],c.width),n.replace(e.record.id,["iframe","height"],c.height),e.isIframeResized||n.replace(e.record.id,["iframe","is_modified"],!0)})),e.setState({resize:null});var a=Object(D.m)(e.id,e.blockManager);Object(j.P)("ccm_doc_content_page_click",Object(D.m)(e.parentId,e.blockManager),{click:"block_resize",object_block_data:[{object_block_id:Object(O.encryptTea)(a.record_id),object_block_type:a.block_type,object_sub_block_type:a.sub_block_type}],before_size:"".concat(Math.round(i),"x").concat(Math.round(o)),after_size:"".concat(Math.round(c.width),"x").concat(Math.round(c.height))})},e}return s()(r,[{key:"getExceededWidth",value:function(e){var n=0;return this.snapshot.align===A.D.CENTER?n=(e-this.state.hostWidth)/2:this.snapshot.align===A.D.LEFT?n=0:this.snapshot.align===A.D.RIGHT&&(n=e-this.state.hostWidth),n>=0?n+this.offsetX:0}},{key:"getOverflowableContainer",value:function(){return this.iframeContainerRef.current}},{key:"blockViewDidMount",value:function(){h()(m()(r.prototype),"blockViewDidMount",this).call(this),this.props.onBlockReady&&this.props.onBlockReady(),(this.isRenderIntoLink||w.S.isFeishuRoomsServer)&&(this.needMask=!1,this.handleIframeLoad(),this.notifyRenderFinish(),this.addRenderLinkFlag()),this.bindWindowEventForMask(!0),this.hostResizeObserver.disconnect(),this.hostResizeObserver.observe(this.hostElement);var e,n=this.state.isIframeFreeWidth&&this.boundary;(n&&(this.boundaryResizeObserver.disconnect(),this.boundaryResizeObserver.observe(n)),this.isNeedRegisterToFixed)&&(null===(e=this.props.recursionProps.rectForFixed)||void 0===e||e.pushBlock(this,this.iframeContainerRef),N.S.on(U.g.DOC_COMMENT_SHOW_CHANGE,this.handleCommentChange),O.EventEmitter.on("viewEditorsMenuChange",this.onViewEditorsMenuChange))}},{key:"getContentRect",value:function(){var e=this.getOverflowableContainer(),n=null===e||void 0===e?void 0:e.firstElementChild;return e&&n?n.getBoundingClientRect():h()(m()(r.prototype),"getContentRect",this).call(this)}},{key:"blockViewWillUnmount",value:function(){var e;(h()(m()(r.prototype),"blockViewWillUnmount",this).call(this),this.bindWindowEventForMask(!1),this.callAdditionalActiveNodeOp(!1),this.boundaryResizeObserver.disconnect(),this.debounceUpdateHostWidth.cancel(),this.hostResizeObserver.disconnect(),this.isNeedRegisterToFixed)&&(null===(e=this.props.recursionProps.rectForFixed)||void 0===e||e.deleteBlock(this),N.S.off(U.g.DOC_COMMENT_SHOW_CHANGE,this.handleCommentChange));O.EventEmitter.off("viewEditorsMenuChange",this.onViewEditorsMenuChange)}},{key:"setSelected",value:function(e){if(this.isRenderIntoLink){h()(m()(r.prototype),"setSelected",this).call(this,e);var n=this.hostElement.querySelector(".selected-mask");e?null===n||void 0===n||n.classList.add("link-iframe-selected"):null===n||void 0===n||n.classList.remove("link-iframe-selected")}e!==this.state.selected&&this.setState({selected:e})}},{key:"allowReferrerpolicy",value:function(){var e=this.iframeConfig.type,n=this.snapshot.iframe.component.original_text;if(["ad","tiktok"].includes(e)){var r=z.C[e];if(r){var o=r.patterns;return Boolean(o.find((function(e){return e.test(n)})))}}return!1}},{key:"clearAndroidCaret",value:function(){if(w.S.isAndroid){var e=window.getSelection();e&&e.collapse(e.anchorNode,0)}}},{key:"getModelIframeSize",value:function(){var e=this.snapshot.iframe;return{width:e.width,height:e.height}}},{key:"getSizeByWidth",value:function(e){var n=this.getModelIframeSize();return{width:e,height:e/n.width*n.height}}},{key:"getIframeResizeSize",value:function(){var e=this.getModelIframeSize(),n=e.width,r=e.height;if(!this.isIframeResized&&n!==this.iframeConfig.defaultWidth&&n!==this.state.hostWidth)return this.getSizeByWidth(this.state.hostWidth);var o=this.containerWidth;return n>o?this.getSizeByWidth(o):{width:n,height:r}}},{key:"renderResizableIframe",value:function(e,n){var r=this.props.loadingComponent,o=this.state,i=o.url,c=o.isIframeLoaded,a=this.iframeConfig,l=a.copyable,s=a.resizeType,u=void 0===s?G.J.Fixed:s,d=["encrypted-media;",l?"clipboard-write;":""],f=w.S.isFeishuRoomsServer,h=!this.props.recursionProps.isPresentationMode;return S.a.createElement(I.S,{type:w.S.isH5||w.S.isMobile&&w.S.isLark?G.J.None:G.n[u],sensitivity:1,onResizeStart:this.handleResizeStart,onResizeUpdate:this.handleResizeUpdate,onResizeEnd:this.handleResizeEnd,boundary:this.boundary,editable:c&&this.config.editable,blockId:this.id,selectionAPI:this.selectionAPI},S.a.createElement("div",{className:"iframe-content",style:{width:e,paddingBottom:"".concat(Math.ceil(100*n),"%")}},S.a.createElement("div",{className:"iframe-layer"},!r||c||f?null:r,f?S.a.createElement(q.S,null):S.a.createElement("iframe",{sandbox:this.getIframeSandBox(),frameBorder:"0",draggable:"false",allowFullScreen:h,allow:d.join(""),referrerPolicy:this.allowReferrerpolicy()?"no-referrer-when-downgrade":"",ref:this.iframeRef,onLoad:this.handleIframeLoad,onError:this.handleIframeError,style:{width:e,visibility:c?"visible":"hidden"},src:i,onMouseEnter:this.onIframeMouseenter}))))}},{key:"computeStyle",value:function(e){if(!this.hostElement||!this.boundary||!this.isNeedRegisterToFixed||!this.isIframeResized&&!this.state.resize)return{};var n=Math.min(e,this.containerWidth);if(n<=this.state.hostWidth)return N.S.emit(L.Y,{blockId:this.id,offset:this.getExceededWidth(n)}),{};var r=this.snapshot.align,o=this.boundary.getBoundingClientRect(),i=o.left,c=o.width,a=this.hostElement.getBoundingClientRect(),l=a.left,s=a.right,u=a.width,d=this.minDisplayMargin,f=n-u,h={};if(r===A.D.CENTER){var p=2*(c-this.commentBlockWidth+i-s-f/2-d);this.offsetX=p<0?-p/2:0,h=p<0?{marginLeft:p}:{}}else if(r===A.D.LEFT){var v=c-this.commentBlockWidth+i-s-f-d;this.offsetX=v<0?-v:0,h=v<0?{marginLeft:v}:{}}else if(r===A.D.RIGHT){var g=l-i-f-this.minDisplayMargin;this.offsetX=g<0?-g:0,h=g<0?{marginRight:g}:{}}return N.S.emit(L.Y,{blockId:this.id,offset:this.getExceededWidth(n)}),h}},{key:"renderIframe",value:function(){var e=this.getIframeSize(),n=e.height,r=e.width,o=n>r,i=n/r,c=r,a=this.snapshot.align||A.D.CENTER,l=this.iframeConfig,s=this.state,u=s.isIframeLoaded,d=s.selected,f=s.maskVisible,h=s.isIframeFreeWidth,p=s.resize,v=s.isIframeError,g=this.computeStyle(r),b=r<300&&n<220,y=!Object(O.isOnline)()||v?{id:this.model.id,type:this.model.type}:void 0;return S.a.createElement(B.S,{onClickRetry:this.refreshIframe,loadingError:y,onLoad:this.handleIframeLoad,style:{width:r,height:n},hasText:b},S.a.createElement("div",{className:k()("iframe-alignable-container",a)},S.a.createElement("div",{className:k()(W.q,{"iframe-container__border":u&&l&&l.border,"iframe--slim":o,"iframe--normal":!o,active:d,editable:u&&this.config.editable,"iframe--resizing":!!p}),"data-iframe-hover-flag":!0,style:Y({width:c,maxWidth:h?this.containerWidth:"100%",borderColor:this.borderColor},g),ref:this.iframeContainerRef,contentEditable:!1},this.renderResizableIframe(c,i),this.needMask&&f&&S.a.createElement("div",{className:"iframe-overlayer",onClick:this.onMaskClick}))))}},{key:"renderLink",value:function(){var e=this,n=this.snapshot.iframe.component.original_text,r=decodeURIComponent(n),o=this.state.selected;return S.a.createElement("div",{"data-iframe-hover-flag":!0,contentEditable:!1},S.a.createElement("a",{className:k()("link","block-inline-text",{selected:o}),"data-link-node":!0,target:"_blank",rel:"noopener noreferrer",onMouseEnter:this.onIframeMouseenter,onClick:function(){e.onLinkClick(r,"_blank")}},r))}},{key:"render",value:function(){return this.isRenderIntoLink?this.renderLink():this.renderIframe()}},{key:"commentBlockWidth",get:function(){return this.state.commentPanelShown?H.l:0}},{key:"isNeedRegisterToFixed",get:function(){return!this.isRenderIntoLink&&this.state.isIframeFreeWidth}},{key:"isLeftSideOverflowEditor",get:function(){if(!this.isIframeResized)return!1;var e=this.getModelIframeSize();return!(this.snapshot.align===A.D.LEFT&&this.offsetX<=0)&&e.width>this.state.hostWidth}},{key:"borderColor",get:function(){var e=this.props,n=e.selected,r=e.syncCursorSelected,o=e.syncCursorBorderColor;return!n&&r?o:void 0}},{key:"isIframeResized",get:function(){return!this.props.recursionProps.isPresentationMode&&this.snapshot.iframe.is_modified}},{key:"iframeConfig",get:function(){var e=this.snapshot.iframe.component.type;return z.C[e]||{}}},{key:"isRenderIntoLink",get:function(){var e=this.iframeConfig,n=e.renderLinkInSafari,r=e.renderLinkInMobile,o=e.renderLinkInAndroid,i=e.renderLinkInIOS,c=e.renderLink,a=e.type;return c||!Object(R.Y)(a)||w.S.safari&&n||w.S.isMobile&&(r||w.S.android&&o||w.S.ios&&i)}},{key:"containerWidth",get:function(){return(this.state.isIframeFreeWidth?this.state.boundaryWidth-2*this.minDisplayMargin-this.commentBlockWidth:this.state.hostWidth)||730}},{key:"minDisplayMargin",get:function(){return this.state.isAuthorOpen?106:88}}],[{key:"selectionTargetFilter",value:function(e){return!e.closest(".".concat(W.q))}}]),r}(P.l);Q.type=A.B.IFRAME;n.S=Q},dx_VtrK:function(e,n,r){"use strict";r.d(n,"c",(function(){return u}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_h6a8"),s=r("dx_pLTH"),u=function(){function e(){i()(this,e),this.timerId=void 0,this.list=[]}return a()(e,[{key:"subscribe",value:function(e,n){var r=this,o=Object(l.uniqueId)();return this.list.push({id:o,updater:n,createTime:e,lastRelativeTime:Object(s.e)(e)}),this.startTimer(),function(){return r.unsubscribe(o)}}},{key:"unsubscribe",value:function(e){this.list=Object(l.filter)(this.list,(function(n){return n.id!==e})),this.list.length||clearTimeout(this.timerId)}},{key:"startTimer",value:function(){clearTimeout(this.timerId);var e=this;e.timerId=window.setTimeout((function n(){e.list.forEach((function(e){var n=e.updater,r=e.lastRelativeTime,o=e.createTime,i=Object(s.e)(o);i!==r&&(e.lastRelativeTime=i,n(i))})),e.timerId=window.setTimeout(n,6e4)}),61e3)}},{key:"destroy",value:function(){clearTimeout(this.timerId),this.list=[]}}],[{key:"getInstance",value:function(){if(!this.instance){var n=new e;this.instance=n}return this.instance}},{key:"destroyInstance",value:function(){this.instance&&this.instance.destroy()}}]),e}();u.instance=void 0},dx_W0Ov:function(e,n,r){"use strict";var o,i,c,a=r("dx_lwsE"),l=r.n(a),s=r("dx_W7W2"),u=r.n(s),d=r("dx_a1gu"),f=r.n(d),h=r("dx_Nsbk"),p=r.n(h),v=r("dx_Vvd7"),g=r("dx_N9dL"),b=r("dx_T4T0"),y=r("dx_Z22N"),m=r("dx_B28d"),_=r("dx_PhLz"),k=r("dx_JlLZ"),O=r("dx_W8MJ"),x=r.n(O),E=r("dx_xjz2"),S=r("dx_YRGG"),C=Object(E.s)(S.h)(o=function(){function e(){l()(this,e),this.type=m.B.FILE}return x()(e,[{key:"fetchResource",value:function(){return r.e("dx_G4F").then(r.bind(null,"dx_D6Dp"))}}]),e}())||o,I=r("dx_a4Cv");function B(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=p()(e);if(n){var i=p()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return f()(this,r)}}var T=Object(v.H)({providers:[C,{provide:y.I,useClass:b.V,args:[m.B.FILE,{shouldRetain:!0,defaultHeight:220}]},{provide:g.RecordSnapshotCreator,useValue:{type:m.B.FILE,create:_.E}}]})((c=function(e){u()(r,e);var n=B(r);function r(){var e;l()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).blocks=[[k.S,{viewCreator:I.S,blockDeps:["renderProps.viewType"]}]],e}return r}(v.y),i=c))||i,w=T;n.S=w},dx_W23W:function(e,n,r){"use strict";r.d(n,"z",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("block-rect-service")},dx_W3mR:function(e,n,r){"use strict";var o;r.d(n,"X",(function(){return o})),function(e){e[e.success=0]="success",e[e.offlineError=1]="offlineError",e[e.insertBlockError=2]="insertBlockError",e[e.createTokenError=3]="createTokenError"}(o||(o={}))},dx_W6W8:function(e,n,r){"use strict";r.d(n,"G",(function(){return V}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W7W2"),a=r.n(c),l=r("dx_a1gu"),s=r.n(l),u=r("dx_Nsbk"),d=r.n(u),f=r("dx_Vvd7"),h=r("dx_N9dL"),p=r("dx_B28d"),v=r("dx_c0wU"),g=r("dx_pSSt"),b=r("dx_lSNA"),y=r.n(b),m=r("dx_W8MJ"),_=r.n(m),k=r("dx_iWIM"),O=r.n(k),x=r("dx_QxNg"),E=r("dx_TSYQ"),S=r.n(E),C=r("dx_cDcd"),I=r.n(C),B=r("dx_MoY1"),T=r("dx_hKul"),w=r("dx_CR0l"),R=r("dx_JFYx"),M=r("dx_SpiB"),j=r("dx_KvuI"),D=r("dx_MGoZ"),A=r("dx_NsKf"),P=r("dx_oCtg").S;r("dx_FGmI");function L(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var N,F,U=function(e){a()(r,e);var n=L(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).state={firstBlockType:p.B.TEXT},e.handleFirstChildOrLastChildRecordChange=function(n){var r=Object(j.s)({recordOps:n.recordOps,checkModel:e.model});Object.values(r).forEach((function(n){return n&&e.blockManager.layoutManager.didUpdateNode(n.id,!0)}))},e.getBlockType=function(n){var r=n?e.blockManager.getRecord(n):null;return(null===r||void 0===r?void 0:r.snapshot.type)||""},e.updateBlockType=function(){var n=e.model.snapshot.children[0],r=e.getBlockType(n);r&&r!==e.state.firstBlockType&&e.setState({firstBlockType:r})},e.handleTransaction=function(n){var r=n.options,o=n.op;if(!r.isInPaste&&!r.isInUndoRedo&&r.from===x.H.local&&0===e.model.record.snapshot.children.length){var i=Object(A.u)({});Object(B.l)(o,e.model.recordId,0,[i])}},e.handleAllRecordChange=function(){e.updateBlockType()},e.onEmojiSelect=function(n){e.model.applyTransaction("calloutBlockEmojiSelect",(function(r){r.replace(e.model.record.id,["emoji_id"],n)})),Object(T.M)(e.id,{actionType:w.e.CHANGE_ICON,actionValue:{value1:n}},{blockManager:e.blockManager}),Object(v.z)({emoji_id:n})},e.handleClick=function(){!e.model.record.snapshot.children.length&&e.config.editable&&Object(v.N)(e.model.record.id,e.blockManager)},e.onColorChange=function(n,r){var o=y()({},n,r),i="border_color"===n?r:e.model.snapshot.border_color,c="background_color"===n?r:e.model.snapshot.background_color,a=Object(v.Y)(c),l=Object(v.i)(i,!0),s=Object(v.i)(i,!1);a&&l?o.border_color=l:c&&!a&&s&&(o.border_color=s),e.setColorsAttrs(o)},e.setColorsAttrs=function(n){e.model.applyTransaction("calloutBlockSetColorsAttrs",(function(r){Object.keys(n).forEach((function(o){return r.replace(e.model.record.id,[o],n[o])}))})),Object(v.z)(n)},e}return _()(r,[{key:"blockViewDidMount",value:function(){O()(d()(r.prototype),"blockViewDidMount",this).call(this),this.blockManager.recordManager.on(x.q.CHANGE,this.handleAllRecordChange),this.blockManager.recordManager.on(x.q.CHANGE,this.handleFirstChildOrLastChildRecordChange),this.blockManager.recordManager.on(x.q.INTERCEPT_CHANGE,this.handleTransaction),this.updateBlockType()}},{key:"blockViewDidUpdate",value:function(e,n){O()(d()(r.prototype),"blockViewDidUpdate",this).call(this,e,n),this.updateBlockType()}},{key:"blockViewWillUnmount",value:function(){O()(d()(r.prototype),"blockViewWillUnmount",this).call(this),this.blockManager.recordManager.off(x.q.CHANGE,this.handleAllRecordChange),this.blockManager.recordManager.off(x.q.CHANGE,this.handleFirstChildOrLastChildRecordChange),this.blockManager.recordManager.off(x.q.INTERCEPT_CHANGE,this.handleTransaction)}},{key:"onResize",value:function(){var e=this;this.model.children.forEach((function(n){e.blockManager.getBlockViewByBlockId(n.id).onResize()}))}},{key:"render",value:function(){var e=this.props,n=e.syncCursorBgColor,r=e.syncCursorBorderColor,o=this.record.snapshot,i=o.border_color,c=o.background_color;return I.a.createElement("div",{className:"callout-block",style:{borderColor:r||Object(v.R)(R.Pi.Border,i),backgroundColor:n||Object(v.R)(R.Pi.BackgroundColor,c)}},I.a.createElement("div",{contentEditable:!1,className:S()("callout-emoji-container",M.Z[this.state.firstBlockType])},I.a.createElement(P,{emojiId:this.model.record.snapshot.emoji_id,onEmojiSelect:this.onEmojiSelect,editable:this.editable,selectionAPI:this.selectionAPI})),I.a.createElement("div",{className:"callout-block-children",onClick:this.handleClick},this.renderChildren({className:"callout-render-unit"})))}}]),r}(D.l);function H(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var V=Object(f.H)({providers:[{provide:h.RecordSnapshotCreator,useValue:{type:p.B.CALLOUT,create:v.m}}]})((F=function(e){a()(r,e);var n=H(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).blocks=[[g.X,{viewCreator:U}]],e}return r}(f.y),N=F))||N},dx_W6Wt:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{fill:"#AFAFAF",d:"M624.66 785.14A38.94 38.94 0 01639 731.97a38.94 38.94 0 0153.21 14.17l90.13 156.1A38.94 38.94 0 01768 955.4a38.94 38.94 0 01-53.21-14.17l-90.13-156.1z"}),l=i.a.createElement("path",{fill:"#D1D1D1",d:"M241.66 121.76A38.94 38.94 0 01256 68.6a38.94 38.94 0 0153.21 14.17l90.13 156.1A38.94 38.94 0 01385 292.03a38.94 38.94 0 01-53.21-14.17l-90.13-156.1z"}),s=i.a.createElement("path",{fill:"#9D9D9D",d:"M238.86 624.66A38.94 38.94 0 01292.03 639a38.94 38.94 0 01-14.17 53.21l-156.1 90.13A38.94 38.94 0 0168.6 768a38.94 38.94 0 0114.17-53.21l156.1-90.13z"}),u=i.a.createElement("path",{fill:"#C2C2C2",d:"M902.24 241.66A38.94 38.94 0 01955.4 256a38.94 38.94 0 01-14.16 53.21l-156.1 90.13A38.94 38.94 0 01731.97 385a38.94 38.94 0 0114.17-53.21l156.1-90.13z"}),d=i.a.createElement("path",{fill:"#A3A3A3",d:"M331.79 746.14A38.94 38.94 0 01385 731.97a38.94 38.94 0 0114.34 53.17l-90.13 156.1A38.94 38.94 0 01256 955.4a38.94 38.94 0 01-14.34-53.17l90.13-156.1z"}),f=i.a.createElement("path",{fill:"#C8C8C8",d:"M714.79 82.76A38.94 38.94 0 01768 68.6a38.94 38.94 0 0114.34 53.17l-90.13 156.1A38.94 38.94 0 01639 292.03a38.94 38.94 0 01-14.34-53.17l90.13-156.1z"}),h=i.a.createElement("path",{fill:"#949494",d:"M277.86 331.79c18.6 10.73 24.94 34.56 14.17 53.21s-34.57 25.07-53.17 14.34L82.76 309.2A38.94 38.94 0 0168.6 256a38.94 38.94 0 0153.17-14.34l156.1 90.13z"}),p=i.a.createElement("path",{fill:"#B6B6B6",d:"M941.24 714.79A38.94 38.94 0 01955.4 768a38.94 38.94 0 01-53.16 14.34l-156.1-90.13A38.94 38.94 0 01731.97 639a38.94 38.94 0 0153.17-14.34l156.1 90.13z"}),v=i.a.createElement("path",{fill:"#999",d:"M219.12 473c21.47 0 38.88 17.46 38.88 39s-17.4 39-38.88 39H38.88C17.4 551 0 533.54 0 512s17.4-39 38.88-39h180.24z"}),g=i.a.createElement("path",{fill:"#BBB",d:"M985.12 473c21.47 0 38.88 17.46 38.88 39s-17.4 39-38.88 39H804.88C783.4 551 766 533.54 766 512s17.4-39 38.88-39h180.24z"}),b=i.a.createElement("path",{fill:"#CDCDCD",d:"M551 219.12c0 21.47-17.46 38.88-39 38.88s-39-17.4-39-38.88V38.88C473 17.4 490.46 0 512 0s39 17.4 39 38.88v180.24z"}),y=i.a.createElement("path",{fill:"#A9A9A9",d:"M551 985.12c0 21.47-17.46 38.88-39 38.88s-39-17.4-39-38.88V804.88c0-21.47 17.46-38.88 39-38.88s39 17.4 39 38.88v180.24z"});n.S=function(e){return i.a.createElement("svg",c({viewBox:"0 0 1024 1024"},e),a,l,s,u,d,f,h,p,v,g,b,y)}},dx_W7Th:function(e,n,r){"use strict";r.d(n,"g",(function(){return T}));var o,i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_NOtv"),p=r.n(h),v=r("dx_UtDZ"),g=r("dx_h6a8"),b=r("dx_zUqt"),y=r("dx_UHze"),m=r("dx_xy70"),_=r("dx_qx8A"),k=r.n(_),O=r("dx_FA1D"),x=r("dx_s9Aa"),E=r("dx_AIJo"),S=r("dx_dYKg");!function(e){e.cardClose="cardClose",e.onMouseEnter="onMouseEnter",e.onMouseLeave="onMouseLeave",e.ignore="ignore",e.shown="shown"}(o||(o={}));var C=p()("abbreviation:global"),I=300,B=function(){function e(){var n=this;u()(this,e),this.isEnabled=!1,this.mobileState={activeAbbrId:"",isCardVisible:!1},this.abbrHelper=null,this.ignoreAbbrMap=new Map,this.eventParams=[],this.showAbbrCardTimerId=0,this.closeAbbrCardTimerId=0,this.abbrCardId=0,this.unSubscribe=void 0,this.taskPool=void 0,this.checkedBlockIds=null,this.lastMouseEnterTs=0,this.lastShowId="",this.rxOp=new v.RxjsDestroyableOperator,this.abbrContinueShownTimer=0,this.handleAbbrIgnore=function(e,r){var o=r.showOptions.query.toLowerCase();n.callAbbrHelperCloseCard(),n.getIgnoreAbbrSet().add(o),Object(x.r)(o),Object(S.Y)(Object(b.k)(),o)},this.handleAbbrCardMouseEnter=function(){n.lastMouseEnterTs=Date.now(),clearTimeout(n.closeAbbrCardTimerId)},this.handleAbbrCardMouseLeave=function(){null!==n.abbrHelper&&n.closeAbbrCard()},this.handleAbbrCardShown=function(e){Object(S.V)()&&"zh-CN"===v.i18nHelper.getLocale()&&(Object(S.wh)("ABBREVIATION_SHOWN_TIMES"),n.abbrContinueShownTimer&&(clearTimeout(n.abbrContinueShownTimer),n.abbrContinueShownTimer=0),n.abbrContinueShownTimer=window.setTimeout((function(){n.abbrCardId&&Object(S.wh)("ABBREVIATION_CONTINUE_SHOWN")}),3300))},this.handleStoreStateChange=function(){var e=Object(S.h)()&&!n.translatedStatus;n.isEnabled!==e&&(n.isEnabled=e,Object(O.J)(document.body,"data-abbreviation-enabled",n.isEnabled),n.isEnabled&&n.flushAllEventParams())},this.handleScroll=Object(g.throttle)((function(e){var r=e.target;r&&r.className&&(r.className.includes("larkw-abbreviation-content")||r.className.includes("aslcard-baikecard-scrollarea")||r.className.includes("abbrmultidesc-list")||r.className.includes("larkw-abbreviation-cards-dropdown"))||n.callAbbrHelperCloseCard()}),100),Object(y.E)()||(this.isEnabled=Object(S.h)()&&!this.translatedStatus,Object(O.J)(document.body,"data-abbreviation-enabled",this.isEnabled),this.isEnabled&&this.flushAllEventParams(),this.unSubscribe=k.a.subscribe(this.handleStoreStateChange),this.taskPool=new O.t(6),this.checkedBlockIds=new Set,window.addEventListener("scroll",this.handleScroll,{capture:!0}),m.O.pipe(this.rxOp.takeUntil()).subscribe(l()(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.fetchIgnoreAbbreviationList().then((function(){return Object(S.t)()})),C("before configUniversalDesignOnce"),e.next=4,Object(S.R)();case 4:C("after configUniversalDesignOnce"),Object(S.x)().then(function(){var e=l()(c.a.mark((function e(r){var i,a,l,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.abbrHelper=r,null===(i=n.abbrHelper)||void 0===i||i.AddEventListener(o.ignore,n.handleAbbrIgnore),null===(a=n.abbrHelper)||void 0===a||a.AddEventListener(o.onMouseEnter,n.handleAbbrCardMouseEnter),null===(l=n.abbrHelper)||void 0===l||l.AddEventListener(o.onMouseLeave,n.handleAbbrCardMouseLeave),null===(s=n.abbrHelper)||void 0===s||s.AddEventListener(o.shown,n.handleAbbrCardShown),e.abrupt("return");case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch((function(e){return e}));case 6:case"end":return e.stop()}}),e)})))))}return f()(e,[{key:"translatedStatus",get:function(){return k.a.getState().appState.translate.status.translated}}]),f()(e,[{key:"destroy",value:function(){this.abbrHelper&&(this.abbrHelper.RemoveEvnetListener(o.ignore,this.handleAbbrIgnore),this.abbrHelper.RemoveEvnetListener(o.onMouseEnter,this.handleAbbrCardMouseEnter),this.abbrHelper.RemoveEvnetListener(o.onMouseLeave,this.handleAbbrCardMouseLeave),this.abbrHelper.RemoveEvnetListener(o.shown,this.handleAbbrCardShown),this.abbrHelper=null),this.unSubscribe&&this.unSubscribe(),this.taskPool.clear(),this.eventParams=[],this.checkedBlockIds=null,window.removeEventListener("scroll",this.handleScroll,{capture:!0}),this.rxOp.destroy()}},{key:"sendEvent",value:function(e){this.isEnabled?Object(S.I)(e):(this.eventParams.length>199&&this.eventParams.shift(),this.eventParams.push(e))}},{key:"addBlockId",value:function(e){this.checkedBlockIds&&this.checkedBlockIds.add(e)}},{key:"isBlockChecked",value:function(e){return!!this.checkedBlockIds&&this.checkedBlockIds.has(e)}},{key:"addTask",value:function(e){this.taskPool.addTask(e)}},{key:"getAbbrHelper",value:function(){return this.abbrHelper}},{key:"fetchIgnoreAbbreviationList",value:function(){var e=l()(c.a.mark((function e(){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(y.E)()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Object(x.i)();case 4:n=e.sent,r=Object(b.k)(),C("fetchIgnoreAbbreviationList words=".concat(JSON.stringify(n))),this.updateLocalIgnoreList(r,n);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onReceiveUserIgnoreListPush",value:function(e,n){C("onReceiveUserIgnoreListPush token=".concat(e," words=").concat(JSON.stringify(n))),this.updateLocalIgnoreList(e,n)}},{key:"getIgnoreAbbrSet",value:function(){var e=Object(b.k)(),n=this.ignoreAbbrMap.get(e);return n||(n=new Set,this.ignoreAbbrMap.set(e,n),n)}},{key:"showAbbrCard",value:function(e,n){var r=this;this.lastShowId!==e&&(clearTimeout(this.showAbbrCardTimerId),this.showAbbrCardTimerId=window.setTimeout((function(){r.abbrHelper&&(r.abbrCardId=r.abbrHelper.ShowCard(n),r.lastShowId=e)}),I))}},{key:"closeAbbrCard",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!(Date.now()-this.lastMouseEnterTs<=2))if(n){if(0===this.abbrCardId)return;this.callAbbrHelperCloseCard()}else clearTimeout(this.showAbbrCardTimerId),this.closeAbbrCardTimerId=window.setTimeout((function(){e.callAbbrHelperCloseCard()}),I)}},{key:"handleSelectionChange",value:function(){clearTimeout(this.showAbbrCardTimerId),clearTimeout(this.closeAbbrCardTimerId),this.callAbbrHelperCloseCard()}},{key:"preloadAbbreviations",value:function(e){this.abbrHelper&&this.abbrHelper.PreShowBatch([e])}},{key:"callAbbrHelperCloseCard",value:function(){var e;null===(e=this.abbrHelper)||void 0===e||e.CloseCard(this.abbrCardId),this.abbrCardId=0,this.lastShowId=""}},{key:"updateLocalIgnoreList",value:function(e,n){var r=this.ignoreAbbrMap.get(e);r||(r=new Set),n.forEach((function(n){var o=n.toLowerCase();Object(S.Y)(e,o),r.add(o)})),this.ignoreAbbrMap.set(e,r)}},{key:"flushAllEventParams",value:function(){this.eventParams.forEach((function(e){return Object(S.I)(e)})),this.eventParams=[]}},{key:"handleContextMenuClose",value:function(){var e=this.mobileState,n=e.activeAbbrId,r=e.isCardVisible;(C("handleContextMenuClose activeAbbrId=".concat(n," isCardVisible=").concat(r)),r)||(document.querySelectorAll("span.".concat(E.E)).forEach((function(e){return e.classList.remove(E.E)})),this.mobileState.activeAbbrId="")}}]),e}(),T=new B},dx_W8W9:function(e,n,r){var o={"./":["dx_mJBo","dx_V5Zx"],"./de-DE":["dx_Cc4k","dx_T54T"],"./de-DE.js":["dx_Cc4k","dx_T54T"],"./en-US":["dx_bv0D","dx_lhLV"],"./en-US.js":["dx_bv0D","dx_lhLV"],"./es-ES":["dx_M2Mi","dx_WVyQ"],"./es-ES.js":["dx_M2Mi","dx_WVyQ"],"./fr-FR":["dx_LdDp","dx_j6j8"],"./fr-FR.js":["dx_LdDp","dx_j6j8"],"./hi-IN":["dx_w4w3","dx_w3wW"],"./hi-IN.js":["dx_w4w3","dx_w3wW"],"./id-ID":["dx_TsPt","dx_d4ds"],"./id-ID.js":["dx_TsPt","dx_d4ds"],"./index":["dx_mJBo","dx_V5Zx"],"./index.js":["dx_mJBo","dx_V5Zx"],"./it-IT":["dx_uwBo","dx_e4Dz"],"./it-IT.js":["dx_uwBo","dx_e4Dz"],"./ja-JP":["dx_auuw","dx_zpfZ"],"./ja-JP.js":["dx_auuw","dx_zpfZ"],"./ko-KR":["dx_n0nV","dx_o1lr"],"./ko-KR.js":["dx_n0nV","dx_o1lr"],"./pt-BR":["dx_cQUf","dx_pXi6"],"./pt-BR.js":["dx_cQUf","dx_pXi6"],"./ru-RU":["dx_Zgc0","dx_O29O"],"./ru-RU.js":["dx_Zgc0","dx_O29O"],"./th-TH":["dx_KDo6","dx_W0yb"],"./th-TH.js":["dx_KDo6","dx_W0yb"],"./vi-VN":["dx_r8r9","dx_X96X"],"./vi-VN.js":["dx_r8r9","dx_X96X"],"./zh-CN":["dx_oegC","dx_i6Xs"],"./zh-CN.js":["dx_oegC","dx_i6Xs"],"./zh-HK":["dx_tGuT","dx_k2kX"],"./zh-HK.js":["dx_tGuT","dx_k2kX"],"./zh-TW":["dx_T3TN","dx_Hacd"],"./zh-TW.js":["dx_T3TN","dx_Hacd"]};function i(e){if(!r.o(o,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=o[e],i=n[0];return r.e(n[1]).then((function(){return r(i)}))}i.keys=function(){return Object.keys(o)},i.id="dx_W8W9",e.exports=i},dx_W8WB:function(e,n,r){},dx_WAOj:function(e,n,r){"use strict";r.d(n,"m",(function(){return c})),r.d(n,"d",(function(){return a})),r.d(n,"Z",(function(){return l}));r("dx_J4zp"),r("dx_h6a8");var o=r("dx_B28d"),i=r("dx_dbks");function c(e,n){return Object(i.T)({view_type:e,children:n?[n]:[]})}function a(e,n){if(!e.parentId)return e;var r=n.getBlockViewByBlockId(e.parentId);return r.type===o.B.VIEW?r:e}function l(e,n){return e.map((function(e){var r=e.parentId?n.viewService.getBlockViewByBlockId(e.parentId):null;return(null===r||void 0===r?void 0:r.type)===o.B.VIEW?r:e}))}},dx_WCA2:function(e,n,r){var o={"./":["dx_O50x","dx_gfbo"],"./de-DE":["dx_paM9","dx_Hrqm"],"./de-DE.js":["dx_paM9","dx_Hrqm"],"./en-US":["dx_Y6Yo","dx_VkBX"],"./en-US.js":["dx_Y6Yo","dx_VkBX"],"./es-ES":["dx_TCpe","dx_NSIG"],"./es-ES.js":["dx_TCpe","dx_NSIG"],"./fr-FR":["dx_y6aA","dx_k6ks"],"./fr-FR.js":["dx_y6aA","dx_k6ks"],"./hi-IN":["dx_IqUk","dx_yqj6"],"./hi-IN.js":["dx_IqUk","dx_yqj6"],"./id-ID":["dx_IozH","dx_B6FL"],"./id-ID.js":["dx_IozH","dx_B6FL"],"./index":["dx_O50x","dx_gfbo"],"./index.js":["dx_O50x","dx_gfbo"],"./it-IT":["dx_Jxgj","dx_oc82"],"./it-IT.js":["dx_Jxgj","dx_oc82"],"./ja-JP":["dx_p3pC","dx_x6xE"],"./ja-JP.js":["dx_p3pC","dx_x6xE"],"./ko-KR":["dx_MZGU","dx_YcUF"],"./ko-KR.js":["dx_MZGU","dx_YcUF"],"./pt-BR":["dx_r93u","dx_i6mS"],"./pt-BR.js":["dx_r93u","dx_i6mS"],"./ru-RU":["dx_YnO2","dx_bGIG"],"./ru-RU.js":["dx_YnO2","dx_bGIG"],"./th-TH":["dx_lMFb","dx_V2BH"],"./th-TH.js":["dx_lMFb","dx_V2BH"],"./vi-VN":["dx_PUvu","dx_p7aY"],"./vi-VN.js":["dx_PUvu","dx_p7aY"],"./zh-CN":["dx_J9JZ","dx_hsI8"],"./zh-CN.js":["dx_J9JZ","dx_hsI8"],"./zh-HK":["dx_HOgF","dx_x5xP"],"./zh-HK.js":["dx_HOgF","dx_x5xP"],"./zh-TW":["dx_OeCJ","dx_gaGO"],"./zh-TW.js":["dx_OeCJ","dx_gaGO"]};function i(e){if(!r.o(o,e))return Promise.resolve().then((function(){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}));var n=o[e],i=n[0];return r.e(n[1]).then((function(){return r(i)}))}i.keys=function(){return Object.keys(o)},i.id="dx_WCA2",e.exports=i},dx_WEEE:function(e,n,r){"use strict";r.d(n,"c",(function(){return b}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_J4zp"),s=r.n(l),u=r("dx_cDcd"),d=r.n(u),f=r("dx_ldXi"),h=r("dx_DPFu"),p=r("dx_i6iB"),v=r("dx_O49O"),g={isRequested:!1,isOKRBlockEnable:!1};function b(){var e=!0,n=d.a.useState(!1),r=s()(n,2),o=r[0],c=r[1],l=d.a.useCallback(a()(i.a.mark((function e(){var n,r,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(f.s)()){e.next=2;break}return e.abrupt("return");case 2:e.next=5;break;case 5:if(!g.isRequested){e.next=8;break}return c(g.isOKRBlockEnable),e.abrupt("return");case 8:return e.next=10,Object(h.W)();case 10:n=e.sent,r=n.data,o=(null===r||void 0===r?void 0:r.auth_status)===p.R.Granted,g.isRequested=!0,g.isOKRBlockEnable=o,o&&v.S.preload(),c(o);case 17:case"end":return e.stop()}}),e)}))),[e]);return d.a.useEffect((function(){l()}),[e]),{isOKRBlockEnable:o}}},dx_WHqS:function(e,n,r){"use strict";r.d(n,"h",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("loadable-block-fetcher")},dx_WI8P:function(e,n,r){"use strict";var o,i=r("dx_wSgM"),c=r("dx_lSNA"),a=r.n(c),l=r("dx_X6Xj"),s=r("dx_I11I"),u=r("dx_FHaN"),d=r("dx_Py0N"),f=r("dx_xCN8"),h=r("dx_ABby"),p=(o={textHighlight:{mark:!0},textHightlightBackground:{mark:!0}},a()(o,h.z,{mark:!0}),a()(o,"trigger",{mark:!0,tailInherit:!0}),a()(o,"bold",{mark:!0}),a()(o,"fontcolor",{mark:!0}),a()(o,"fontweight",{mark:!0}),a()(o,"italic",{mark:!0}),a()(o,"fontfamily",{mark:!0}),a()(o,"fontsize",{mark:!0}),a()(o,"underline",{mark:!0}),a()(o,"strikethrough",{mark:!0}),a()(o,"comment-.*",{mark:!0}),a()(o,"clientside-comment-hl",{mark:!0}),a()(o,"backcolor",{mark:!0}),a()(o,"backgroundcolor",{mark:!0}),a()(o,"at-holder",{mark:!0}),a()(o,"at-uuid_.*",{mark:!0}),a()(o,"clientside-mention-placeholder",{mark:!0}),a()(o,"inlineCode",{mark:!0,tailInherit:!1}),a()(o,"url-.*",{mark:!0,tailInherit:!1,refresh:!0}),a()(o,"link",{mark:!0,tailInherit:!1,refresh:!0}),a()(o,"textcolor",{mark:!0}),a()(o,"equation",{tailInherit:!1,attributes:function(e){return![d.R.KEY,f.Z.KEY,l.m.KEY].includes(e)}}),a()(o,u.O,{tailInherit:!1}),a()(o,s.B,{tailInherit:!1}),a()(o,"author",{tailInherit:!1}),a()(o,"objectID",{tailInherit:!1}),a()(o,"abbreviation-data",{tailInherit:!1}),a()(o,"clientside-highlight",{mark:!0}),o);n.S=new i.M(p)},dx_WJxF:function(e,n,r){"use strict";r.d(n,"E",(function(){return S})),r.d(n,"c",(function(){return C})),r.d(n,"N",(function(){return I}));var o,i=r("dx_J4zp"),c=r.n(i),a=r("dx_RIqP"),l=r.n(a),s=r("dx_lSNA"),u=r.n(s),d=r("dx_Icqc"),f=r("dx_FBWK"),h=r("dx_wQFH"),p=r("dx_Zss7"),v=r.n(p),g=r("dx_O8UM"),b=r("dx_l8lP"),y=r("dx_Lqhf"),m=Object(f.getColor)("bg-body",d.ThemeType.LIGHT),_=Object(f.getColor)("text-title",d.ThemeType.LIGHT),k=(o={},u()(o,b.j.COLOR_ORANGE_LIGHT_BACKGROUND,v()({r:254,g:212,b:164}).toRgb()),u()(o,b.j.COLOR_YELLOW_LIGHT_BACKGROUND,v()({r:255,g:248,b:149}).toRgb()),u()(o,b.j.COLOR_GREEN_LIGHT_BACKGROUND,v()({r:197,g:240,b:192}).toRgb()),u()(o,b.j.COLOR_BLUE_LIGHT_BACKGROUND,v()({r:207,g:221,b:254}).toRgb()),u()(o,b.j.COLOR_BLUE_DARK_BACKGROUND,v()({r:158,g:187,b:254}).toRgb()),u()(o,b.j.COLOR_PURPLE_LIGHT_BACKGROUND,v()({r:220,g:201,b:252}).toRgb()),u()(o,b.j.COLOR_PURPLE_DARK_BACKGROUND,v()({r:196,g:164,b:250}).toRgb()),o),O=[].concat(l()(Object(g.P)(y.D.Background)),[[b.j.COLOR_DEFAULT_BACKGROUND,m]]).map((function(e){var n=c()(e,2),r=n[0],o=n[1],i=k[r]?k[r]:v()(o).toRgb();return{key:r,value:o,R:i.r,G:i.g,B:i.b}})),x=[].concat(l()(Object(g.P)(y.D.Text)),[[b.j.COLOR_DEFAULT_TEXT,_]]).map((function(e){var n=c()(e,2),r=n[0],o=n[1],i=v()(o).toRgb();return{key:r,value:o,R:i.r,G:i.g,B:i.b}}));function E(e){var n=e===y.D.Background?O:x;return function(r){if("transparent"!==r){var o=n.find((function(e){return v.a.equals(r,e.value)}));if(o)return Object(g.P)(e).get(o.key)}}}var S=E(y.D.Text),C=E(y.D.Background);function I(e,n){if("transparent"!==e){var r=v()(e);if(r){var o=r.toRgb(),i=o.r,c=o.g,a=o.b,l=o.a,s=r.toHsv(),u=s.s,d=s.v;if("text"===n){if(d<=.3)return;if(d>.3&&u<.08)return Object(g.P)(y.D.Text).get(b.j.COLOR_GRAY_TEXT);var f=Object(h.closest)({R:i,G:c,B:a,A:l},x);if(f.key===b.j.COLOR_DEFAULT_TEXT)return;return Object(g.P)(y.D.Text).get(f.key)}if(0!==l){if(d<=.3)return Object(g.P)(y.D.Background).get(b.j.COLOR_GRAY_DARK_BACKGROUND);if(u<.04){if(d>.96)return;if(d>=.76)return Object(g.P)(y.D.Background).get(b.j.COLOR_GRAY_LIGHT_BACKGROUND);if(d<.76)return Object(g.P)(y.D.Background).get(b.j.COLOR_GRAY_DARK_BACKGROUND)}var p=Object(h.closest)({R:i,G:c,B:a,A:l},O);if(p.key!==b.j.COLOR_DEFAULT_BACKGROUND)return Object(g.P)(y.D.Background).get(p.key)}}}}},dx_WKAt:function(e,n,r){},dx_WKxm:function(e,n,r){"use strict";(function(t){r.d(n,"J",(function(){return E})),r.d(n,"c",(function(){return C})),r.d(n,"V",(function(){return B}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_vDqi"),l=r.n(a),s=r("dx_h6a8"),u=r("dx_bUYd"),d=r("dx_ADkB"),f=r("dx_DnxT"),h=r("dx_UmoL"),p=r("dx_g0R0"),v=r("dx_B28d"),g=r("dx_bUp7"),b=r("dx_u6uu"),y=r("dx_HsgL");function m(e){return g.C[e]}function _(e){return k.apply(this,arguments)}function k(){return(k=c()(o.a.mark((function e(n){var r,i,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(s.get)(window,"globalConfig.common.channel",""),i="https://www.ixigua.com/api/public/iframe/convert?url=".concat(n),r||(i="".concat(f.r.getProxyVideoUrl,"?url=").concat(i)),e.prev=3,e.next=6,l.a.get(i,{withCredentials:!1,ignoreInterceptors:!0,baseURL:Object(h.q)()});case 6:return"error"===(c=e.sent).data.message&&Object(u.h)({content:t("airtable-link-not-exist",void 0,void 0,t("block.iframe_xigua")),errorContext:Object(p.G)(c,new Error("fetch xigua iframe url has failed!"))}),e.abrupt("return",c.data.data);case 11:throw e.prev=11,e.t0=e.catch(3),new Error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[3,11]])})))).apply(this,arguments)}function O(e){return x.apply(this,arguments)}function x(){return(x=c()(o.a.mark((function e(n){var r,i,c,a,s,d,f,h,v;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n,!n.includes("vt.tiktok.com")&&!n.includes("vm.tiktok.com")){e.next=15;break}return i=encodeURIComponent(n),c="https://www.tiktok.com/node/common/embed?url=".concat(i),e.prev=4,e.next=7,l.a.get(c,{withCredentials:!1,ignoreInterceptors:!0});case 7:null!==(a=e.sent).data.errMsg&&Object(u.h)({content:t("airtable-link-not-exist",void 0,void 0,"TikTok"),errorContext:Object(p.G)(a,new Error("Fetching TikTok iframe url has failed"))}),n=a.data.body.url,e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(4),new Error(e.t0);case 15:return d=/https:\/\/www\.tiktok\.com\/embed\/([^\s]+\/)?(\d+)/i,f=/https:\/\/t\.tiktok\.com\/i18n\/share\/video\/([0-9]+)/i,h=/https:\/\/m\.tiktok\.com\/v\/([0-9]+)/i,v=(s=/https:\/\/www\.tiktok\.com\/@[^\s]+\/video\/(\d+)/i).test(r)?s.exec(r)[1]:d.test(r)?d.exec(r)[2]:h.test(n)?h.exec(n)[1]:f.exec(n)[1],e.abrupt("return","https://www.tiktok.com/embed/v2/".concat(v));case 21:case"end":return e.stop()}}),e,null,[[4,12]])})))).apply(this,arguments)}function E(e,n){return S.apply(this,arguments)}function S(){return(S=c()(o.a.mark((function e(n,r){var i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=decodeURIComponent(r),n!==b.C.xigua){e.next=5;break}return e.next=4,_(r);case 4:i=e.sent;case 5:if(n!==b.C.tiktok){e.next=9;break}return e.next=8,O(r);case 8:i=e.sent;case 9:return e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return I.apply(this,arguments)}function I(){return(I=c()(o.a.mark((function e(n){var r,i,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(d.d)(n)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,E(r,n);case 5:return i=e.sent,c=B(n,{type:r,url:i}),e.abrupt("return",c);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};function r(r,o){var i=n.url;if(void 0===i){i=e;var c=o.templateFunc,a=o.patterns.find((function(n){return n.test(e)}));if(a)i=c(a.exec(e))}var l=Object(y.J)({type:r}),s=l.height,u=l.width;return{iframe:{component:{original_text:encodeURIComponent(e),url:i,type:r},resize_type:o.resizeType||b.J.Fixed,width:u,height:s,original_height:s,original_width:u,is_modified:!1},align:v.D.CENTER}}var o=n.type||Object(d.d)(e);if(o){var i=m(o),c=r(o,i);return c}}}).call(this,r("dx_E9Eu"))},dx_WKyf:function(e,n,r){"use strict";r.d(n,"j",(function(){return l})),r.d(n,"X",(function(){return s})),r.d(n,"D",(function(){return u}));var o=r("dx_UtDZ"),i=r("dx_x2xb"),c=r("dx_HA1r"),a=r("dx_oftt");function l(e){var n={};return e.result_list.forEach((function(e){if(e.type===o.TYPE_ENUM.USER){var r=n[a.n.USER]||[],i=e,l=i.token,s=i.content,u=i.url,d=i.is_external;r.push({id:l,title:s,type:a.D.USER,entity:{id:l,avatarUrl:u,name:s,isCrossTenant:d}}),n[a.n.USER]=r}else if(e.type===o.TYPE_ENUM.CHAT){var f=n[a.n.GROUP]||[],h=e,p=h.token,v=h.content,g=h.url,b=h.is_cross_tenant;f.push({id:p,title:v,type:a.D.CHAT,entity:{id:p,avatarUrl:g,name:v,isCrossTenant:b}}),n[a.n.GROUP]=f}else{var y=n[a.n.DOCS]||[],m=e,_=m.token,k=m.content,O=m.url,x=m.type,E=m.edit_time,S=m.is_cross_tenant;y.push({id:_,title:k,type:a.D.DOC,entity:{id:_,name:k,url:O,type:c.F[x]||c.B.UNKNOWN,updateTime:o.dateHelper.forcePastShowDate(E),isCrossTenant:S}}),n[a.n.DOCS]=y}})),n}function s(e){var n=e.identifier,r=e.defaultActiveTab,o=e.singleTab,c=e.inline;if(o)return[r];switch(n){case i.A.mentionAt:return c?[a.n.ALL,a.n.USER,a.n.DOCS]:[a.n.ALL,a.n.USER,a.n.DOCS,a.n.GROUP];case i.A.mentionBracket:case i.A.mentionBracketCN:case i.A.mentionRoundBracket:case i.A.mentionRoundBracketCN:return[a.n.DOCS]}}var u=function(e){return c.q.forEach((function(n){e.startsWith(n.input)&&(e=e.replace(n.input,""))})),e}},dx_WLRK:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M3.5 1.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z",fill:"#BBBFC4"});n.S=function(e){return i.a.createElement("svg",c({width:4,height:3,viewBox:"0 0 4 3",fill:"none"},e),a)}},dx_WRwK:function(e,n,r){"use strict";r.d(n,"n",(function(){return _}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_RIqP"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_h6a8"),v=r("dx_B28d"),g=r("dx_FNDK"),b=r("dx_Vkod");function y(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function m(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?y(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var _=function(){function e(n,r,o){var c=this;d()(this,e),this.blockManager=n,this.dataRecordMap={},this.partialRecordMap={},this.destructedBlockIds=new Set,this.blockChildrenSet=new Map,this.blockIds=void 0,this.sortBlockIds=function(e){var n={},r=function(e){if(n[e])return n[e];for(var r=[],o=c.blockManager.getBlockModelByBlockId(e);null===(i=o)||void 0===i?void 0:i.parent;){var i,a;r.push(null===(a=o)||void 0===a?void 0:a.position),o=c.blockManager.getBlockModelByBlockId(o.parent.id)}return r.reverse(),n[e]=r,r};return e.sort((function(e,n){return function(e,n){for(var o=r(e),i=r(n),c=0;c<o.length&&c<i.length;c++){if(o[c]<i[c])return-1;if(o[c]>i[c])return 1}return o.length===i.length?0:o.length-i.length}(e,n)}))},this.sendChildrenToParentForOneColumnGrid=function(e){var n,r=e.parent,o=c.dataRecordMap[r.record.id];if(o){var i=e.position,a=Array.from(c.blockChildrenSet.get(e.children[0].id)).map((function(e){return c.blockManager.getRecordByBlockId(e).id}));delete c.partialRecordMap[e.recordId],null===(n=o.snapshot.children)||void 0===n||n.splice.apply(n,[i,1].concat(s()(a)))}};for(var l=r.map((function(e){return e.id})),u=Object(g.L)(r),f={},h=0,p=Object.entries(o);h<p.length;h++){var y=a()(p[h],2),_=y[0],k=y[1];if(f[_]){var O=n.getRecordByBlockId(Number(_)).id;Object.assign(this.partialRecordMap,i()({},O,f[_]))}Object.assign(this.dataRecordMap,k)}if(u){var x=Object(b.d)(n,r,!0,(function(e){var r=n.getBlockModelByBlockId(e);return!!r.parent&&[v.B.GRID,v.B.GRID_COLUMN].includes(r.parent.type)})),E=x.newSelectedBlockIds,S=x.blockIdMap;Object.assign(f,S),Object.assign(this.dataRecordMap,Object.values(S).reduce((function(e,n){return e[n.id]=n,e}),{})),l=E}l.forEach((function(e){var r=n.getBlockModelByBlockId(e),o=null===r||void 0===r?void 0:r.parent,i=null===o||void 0===o?void 0:o.parent;o&&i&&o.type===v.B.GRID_COLUMN&&i.type===v.B.GRID&&(c.blockChildrenSet.has(i.id)||c.blockChildrenSet.set(i.id,new Set),c.blockChildrenSet.has(o.id)||c.blockChildrenSet.set(o.id,new Set),c.blockChildrenSet.get(i.id).add(o.id),c.blockChildrenSet.get(o.id).add(r.id))})),l=[].concat(s()(l),s()(Array.from(this.blockChildrenSet.keys()))).filter((function(e){var r=n.getBlockModelByBlockId(e);if(r.type===v.B.GRID){var o=c.blockChildrenSet.get(r.id);return o&&o.size>1}if(r.type===v.B.GRID_COLUMN)return!1;var i=r.parent;if(!i||i.type!==v.B.GRID_COLUMN)return!0;var a=i.parent,l=c.blockChildrenSet.get(a.id);return!l||l.size<=1})).map(Number),this.blockChildrenSet.forEach((function(e,r){n.getBlockModelByBlockId(r).type!==v.B.GRID||e.size>1||c.destructedBlockIds.add(r)}));var C={};this.blockChildrenSet.forEach((function(e,r){var o=n.getBlockModelByBlockId(r);if(o.type===v.B.GRID_COLUMN||o.type===v.B.GRID)if(c.destructedBlockIds.has(r))c.sendChildrenToParentForOneColumnGrid(o);else{var i=o.record;if(i.snapshot.children.length===e.size)return c.dataRecordMap[i.id]={id:i.id,snapshot:m({},i.snapshot)},void(C[i.id]&&(c.dataRecordMap[i.id].snapshot.width_ratio=C[i.id]));var a=Array.from(e).map((function(e){return n.getBlockModelByBlockId(e).recordId}));if(c.partialRecordMap[i.id]={id:i.id,snapshot:m(m({},i.snapshot),{},{children:a})},C[i.id]&&(c.partialRecordMap[i.id].snapshot.width_ratio=C[i.id]),o.type===v.B.GRID){var l=a.reduce((function(e,n){return e+c.getWidthRatio(n)}),0);l>0&&a.forEach((function(e){var n=c.getWidthRatio(e);C[e]=n/l}))}}}));var I=this.sortBlockIds(l);u&&(I=Object(b.c)(n,I)),this.blockIds=I}return h()(e,[{key:"getWidthRatio",value:function(e){var n=this.blockManager.getRecord(e);if(n.snapshot.type===v.B.GRID_COLUMN){var r=n.snapshot.width_ratio;return Object(p.isNumber)(r)?r:0}return 0}},{key:"shouldSkip",value:function(e){var n=this.blockManager.getBlockModelByBlockIdNotCheck(e);if(!n)return!0;var r=n.parent;return!(!r||r.type!==v.B.GRID&&r.type!==v.B.GRID_COLUMN)&&(this.blockChildrenSet.has(r.id)&&!this.blockChildrenSet.get(r.id).has(n.id))}},{key:"hasPartial",value:function(){return!!Object.keys(this.partialRecordMap).length||!!this.destructedBlockIds.size}},{key:"getBlockIds",value:function(){return this.blockIds}},{key:"getRecordIds",value:function(){var e=this;return this.blockIds.map((function(n){var r;return null===(r=e.blockManager.getRecordByBlockId(n))||void 0===r?void 0:r.id})).filter(Boolean)}},{key:"getRecordMap",value:function(){return Object.assign({},this.dataRecordMap,this.partialRecordMap)}}]),e}()},dx_WS3J:function(e,n,r){"use strict";r.d(n,"y",(function(){return o})),r.d(n,"g",(function(){return i}));var o="POLL_PUBLISH",i="POLL_VOTE"},dx_WX15:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return X}));r("dx_QU2i");var e=r("dx_d1El"),o=r.n(e),i=r("dx_lSNA"),c=r.n(i),a=r("dx_J4zp"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_W7W2"),p=r.n(h),v=r("dx_a1gu"),g=r.n(v),b=r("dx_Nsbk"),y=r.n(b),m=r("dx_QxNg"),_=r("dx_TSYQ"),k=r.n(_),O=r("dx_h6a8"),x=r("dx_cDcd"),E=r.n(x),S=r("dx_j5jv"),C=r("dx_iLNO"),I=r("dx_rQGm"),B=r("dx_yzqx"),T=r("dx_SreQ"),w=r("dx_zEdG"),R=r("dx_CwnG"),M=r("dx_L6Lu"),j=r("dx_FvGq"),D=r("dx_Vau3"),A=r("dx_acOG"),P=r("dx_j6ji"),L=r("dx_QzB0"),N=r("dx_D8nn"),F=r("dx_IcDz"),U=r("dx_Bs5u"),H=r("dx_FDiX"),V=r("dx_T1AN"),W=r("dx_cgKF"),z=r("dx_ozfA");r("dx_JyKP");function G(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=y()(e);if(n){var i=y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return g()(this,r)}}var K="add",q="remove",X=function(e){p()(r,e);var n=G(r);function r(e){var o;return u()(this,r),(o=n.call(this,e)).alwaysShowTooltip=!1,o.disableTooltip=!1,o.handleFolded=O.noop,o.alwaysShowTooltip=!!e.alwaysShowTooltip,o.disableTooltip=!!e.disableTooltip,o}return f()(r,[{key:"getAfterSlot",value:function(){var e=this;return function(n){var r,i=n.blockId,a=n.recursionProps,s=a.blockManager,u=a.isHistory,d=a.isPresentationMode,f=a.editPermission,h=a.editable,p=!!(null===(r=n.model.parent)||void 0===r?void 0:r.isRoot),v=Object(x.useRef)(null),g=Object(x.useState)(e.fold.isFolded(i)),b=l()(g,2),y=b[0],_=b[1],O=Object(x.useState)(!1),D=l()(O,2),G=D[0],X=D[1],Y=Object(x.useRef)(!1),J=Object(x.useRef)(),Z=Object(x.useState)(Object(z.sM)(i,e.blockManager)),Q=l()(Z,2),$=Q[0],ee=Q[1],te=Object(W.P)(),ne=Object(x.useState)(!1),re=l()(ne,2),oe=re[0],ie=re[1],ce=Object(x.useCallback)((function(e,n){n!==K||oe||ie(!0),n===q&&oe&&!y&&ie(!1)}),[y,oe]),ae=Object(x.useCallback)((function(n){if(!e.alwaysShowTooltip&&v.current)if(n){Y.current=n.id===i&&Object(z.sM)(n.id,e.blockManager);var r=n.id===i&&Object(z.sM)(n.id,e.blockManager)?K:q;ce(v.current,r)}else Y.current=!1,ce(v.current,q)}),[i,ce]),le=Object(x.useCallback)((function(n){if(v.current&&n.length>0&&n.some((function(e){return e.id===i}))){var r=Object(z.sM)(i,e.blockManager);Y.current=r,ce(v.current,r?K:q)}}),[i,ce]),se=Object(x.useCallback)((function(){v.current&&(Y.current=!0,ce(v.current,K))}),[ce]);Object(x.useEffect)((function(){if(u){var n=e.blockManager.getBlockViewByBlockId(i).props.record.snapshot[U.A.change];"folded"===Object(H.J)(null===n||void 0===n?void 0:n.from,null===n||void 0===n?void 0:n.to,U.w)&&se()}}),[s,i,u,se]),Object(x.useEffect)((function(){var n=function(e,n){return ae(n)};return e.blockManager.addListener(V.v,n),function(){e.blockManager.removeListener(V.v,n)}}),[y,ae,le]),Object(x.useEffect)((function(){var e=function(e){var n=e.blockId,r=e.folded;n===i&&r!==y&&_(r)};return N.S.on(N.p.COMMON.FOLD_CHANGED_READONLY,e),function(){N.S.off(N.p.COMMON.FOLD_CHANGED_READONLY,e)}}),[y,i]),Object(x.useEffect)((function(){var n=function(e){var n=e.id,r=e.folded;n===i&&r!==y&&_(r)};return e.blockManager.addListener(F.w,n,i),function(){e.blockManager.removeListener(F.w,n,i)}}),[y,i]);var ue=Object(x.useCallback)((function(n){var r;if((!B.S.isInVC||!(null===(r=e.vcController)||void 0===r?void 0:r.isFollow))&&(!Object(T.Pf)()||e.editorAPI.getService(L.H).editing)){var o=n.ops.find((function(e){return e.p.includes("folded")}));if(o&&(Object(m.bG)(o)||Object(m.y)(o))){var c=Boolean(o.action.oi);e.blockManager.dispatch(I.Fx,[i,c]),_(c)}}}),[i]);Object(x.useEffect)((function(){var n=function(n){if(n.id===i){var r=Object(z.sM)(i,e.blockManager);r!==$&&ee(r)}};return e.blockManager.addListener(j.f,n,i),function(){e.blockManager.removeListener(j.f,n,i)}}),[$,i]),Object(x.useEffect)((function(){var r=e.fold.isFolded(i);y!==r&&_(r);var o=n.model.record;return o.on(m.Ra.CHANGE,ue),function(){o.off(m.Ra.CHANGE,ue)}}),[i,ue]);var de=E.a.useCallback((function(n){var r=Object(R.T)([i],e.blockManager),o=Object(R.m)(i,e.blockManager);Object(w.P)("ccm_doc_content_page_click",o,{click:"click_fold",sub_click:n?"fold":"unfold",action_object:"block",object_block_data:r})}),[i]),fe=function(){var n=!y;if(!u){var r=e.fold.getFoldStateMap(),o=e.blockManager.getRecordByBlockId(i),c=e.blockManager.editorAPI.getService(A.N,{optional:!0});if(!o||c&&!c.canBlockEdit(o,o.snapshot.type,{type:"UPDATE_ATTRIBUTE",changedKey:"folded",newValue:n}))Object(P.A)({op_source:"fold_trigger",op_type:n?"fold":"unfold",edit_type:"UPDATE_ATTRIBUTE",interceptedRecord:o});else{var a=function(){e.blockManager.dispatch(I.Fx,[i,n]),_(n)};if(Object(T.Pf)()?h:f){var l=e.blockManager.getBlockViewByBlockId(i);if(de(n),l.record.snapshot.folded!==n?(e.blockManager.applyTransaction("toggleFold",(function(e){e.replace(l.record.id,["folded"],n)})),Object(T.Pf)()&&a()):a(),N.S.emit(I.e,{operation_method:I.mu.MOUSE,source:"other",action:"".concat(l.type,"_").concat(n?"collapse":"expand"),block_id:i,blockManager:e.blockManager}),B.S.isMobile)e.selectionAPI.blur();else{var s=[];e.selectionAPI.getSelection().forEach((function(e){s.push(e.id)})),n&&s.some((function(e){var n;return(null===(n=r.get(e))||void 0===n?void 0:n.closestFolderId)===i}))&&(e.selectionAPI.isTextSelectionAcrossBlocks()||e.selectionAPI.isSingleTextSelection())&&e.selectionAPI.removeAllSelection(),e.selectionAPI.isSingleTextSelection(e.selectionAPI.getSelection())&&e.selectionAPI.removeAllSelection()}}else a()}}},he=Object(x.useCallback)((function(e){e.detail>=3&&e.preventDefault(),fe()}),[fe]),pe=Object(x.useCallback)((function(){J.current&&clearTimeout(J.current),J.current=window.setTimeout((function(){X(!0)}),200)}),[X]),ve=Object(x.useCallback)((function(){J.current&&clearTimeout(J.current),X(!1)}),[X]),ge=k()(c()({"fold-wrapper":!0,"fold-folded":y,"fold-show":Y.current||y||e.alwaysShowTooltip,"can-fold":$},"fold-block-id-".concat(i),!0)),be=Object(x.useState)(!1),ye=l()(be,2),me=ye[0],_e=ye[1],ke=Object(x.useState)(!1),Oe=l()(ke,2),xe=Oe[0],Ee=Oe[1],Se=Object(x.useRef)(0),Ce=k()({"fold-handler":!0,"touch-start":me,"touch-end":xe}),Ie=t(y?"mindnote.editor.expand":"etherpad.collapse");return E.a.createElement("div",{className:ge,contentEditable:"false"},$?E.a.createElement("div",{style:{zoom:d&&p?Object(M.K)():void 0},className:"".concat(k()(ge,{"fold-show":oe,"fold-handler-wrapper":!0,"no-pointer-events":u})),ref:v},E.a.createElement(o.a,{title:Ie,placement:"top",visible:!e.disableTooltip&&G,getPopupContainer:function(){return document.body},overlayStyle:{pointerEvents:"none"}},E.a.createElement(C.u,{className:Ce,onClick:he,onMouseEnter:pe,onMouseLeave:ve,onTouchStart:function(){me||u||(window.clearTimeout(Se.current),_e(!0))},onTouchEnd:function(){xe||u||(Ee(!0),Se.current=window.setTimeout((function(){_e(!1),Ee(!1)}),300))},isPresentationMode:d},te?null:E.a.createElement("div",{className:"svg-wrapper"},E.a.createElement(S.S,null))))):void 0)}}}]),r}(D.A)}).call(this,r("dx_E9Eu"))},dx_WXfY:function(e,n,r){"use strict";r.d(n,"V",(function(){return b})),r.d(n,"G",(function(){return y})),r.d(n,"S",(function(){return m})),r.d(n,"X",(function(){return k})),r.d(n,"Z",(function(){return O}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_M30o"),a=r("dx_alfx"),l=r("dx_xlCA"),s=r("dx_B28d"),u=r("dx_u3Zu"),d=r("dx_I11I"),f=r("dx_FHaN"),h=r("dx_gDjg"),p=r("dx_wqNP"),v=r("dx_RUmv"),g=r("dx_HTwv");function b(e){var n=e.snapshot;switch(n.type){case s.B.FILE:return n.file.name;case s.B.JIRA_ISSUE:var r=Object(u.n)(n),o=r.issueKey,i=r.summary,c=r.status;return"".concat(o," ").concat(i,"  ").concat(c," ");default:return""}}function y(e,n,r,o){var i=e.attributes||{};if(i[f.O])return function(e,n,r){var o=Object(g.p)(e);if(!o)return"";var i=o.type,c=o.data;if(i===f.k.USER){var a=c.uid,s=l.n.getUserShowName(a);if(s)return n?"@".concat(s," "):s}else{if(i===f.k.REMINDER){var u=c,d=u.expire_time,v=u.is_whole_day;return Object(p.R)(d,v)}if(i===f.k.DOC){var b=c,y=b.token,m=b.file_type,_=b.title,k=b.raw_url;return r?k:Object(h.A)(y,m,_)}if(i===f.k.FILE)return c.name}return""}(e,r,o);if(i[d.B]){var c=i[d.B];return n.hasRecord(c)?b(n.getRecord(c)):""}if(i[v.h.KEY]){var a=i[v.h.KEY],s=a.lastIndexOf("\n")===a.length-1?a.slice(0,-1):a;return"$$".concat(s,"$$")}return""}function m(e,n,r){return y(e,n,r)||e.insert}function _(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,1/0],o=i()(r,2),a=o[0],l=o[1],s=0,u=e.ops.map((function(e){if(!Object(c.X)(e))return console.error("op is wrong"),"";var r=e.insert.length,o=s;if(s+=r,o<a&&s<=a||o>=l)return"";var i=y(e,n,!0);return i||e.insert.slice(a-o>=0?a-o:0,l-o)}));return u.join("")}function k(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,1/0],o=e.text,i=Object(a.Z)(o.initialAttributedTexts,o.apool).get("0");return _(i,n,r)}function O(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,1/0],o=e.zoneState.getContent(),i=e.zoneState.getModelText().length-1,c=Math.min(r[1],i);return r[1]=c,_(o,n,r)}},dx_WdfZ:function(e,n,r){"use strict";r.d(n,"x",(function(){return w}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_QxNg"),s=r("dx_UtDZ"),u=r("dx_h6a8"),d=r("dx_Z7ZC"),f=r("dx_zEdG"),h=r("dx_tP01"),p=r("dx_WzJv"),v=r("dx_dIhn"),g=r("dx_B28d"),b=r("dx_D5D1"),y=r("dx_QILm"),m=r.n(y);function _(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function k(e){if(e.snapshot.type===g.B.OKR)return e.snapshot.okr_info.id}function O(e){if(e.snapshot.type===g.B.OBJECTIVE)return e.snapshot.objective_info.id}function x(e){if(e.snapshot.type===g.B.KEY_RESULT)return e.snapshot.kr_info.id}function E(e){if(e.snapshot.type===g.B.OKR)return e.snapshot.okr_info.user_id}function S(e){return{object_okr_o_id:O(e),object_okr_kr_id:x(e),object_okr_instance_id:k(e),object_okr_owner_user_unique_id:E(e)}}var C=function(e,n){var r=function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?_(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({},n),o=[],i=[],c=[],l=[];r.object_block_data=n.object_block_data.map((function(e){var n=e.object_okr_data,r=m()(e,["object_okr_data"]),a=e.object_block_id;return r.object_block_id=a?Object(s.encryptTea)(a):"",(null===n||void 0===n?void 0:n.object_okr_o_id)&&i.push(n.object_okr_o_id),(null===n||void 0===n?void 0:n.object_okr_kr_id)&&c.push(n.object_okr_kr_id),(null===n||void 0===n?void 0:n.object_okr_instance_id)&&o.push(n.object_okr_instance_id),(null===n||void 0===n?void 0:n.object_okr_owner_user_unique_id)&&l.push(Object(s.encryptTea)(n.object_okr_owner_user_unique_id)),r})),r.object_okr_o_id=i.join("&"),r.object_okr_kr_id=c.join("&"),r.object_okr_instance_id=o.join("&"),r.object_okr_owner_user_unique_id=l.join("&"),Object(f.P)(e,{record_id:Object(s.getToken)(),block_type:g.B.PAGE},r)},I=r("dx_rldU");function B(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function T(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?B(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):B(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var w=Object(b.A)((function(e,n){var r=n.recordManager,o=Object(h.m)(n),c={li:[],ld:[],edit:[]};e.forEach((function(e){var n=e.id;e.ops.forEach((function(e){if(e.p.includes("children")&&Object(l.X)(e)){var r=e.action.li;c.li.push(r),c.edit.push(n)}else if(e.p.includes("children")&&Object(l.y)(e)){var o,a=e.action.oi;(o=c.li).push.apply(o,i()(a))}else if(e.p.includes("children")&&Object(l.ZH)(e)){var s=e.action.ld;c.ld.push(s),c.edit.push(n)}else if(e.p.includes("children")&&Object(l.P)(e)){var u,f=e.action.od;(u=c.ld).push.apply(u,i()(f))}else(Object(l.bG)(e)||Object(d.I)(e))&&c.edit.push(n)}))}));var a,b,y=function(){var e={};return Object.values(I.a).forEach((function(n){e[n]={add:[],delete:[],edit:[],recursiveEdit:[]}})),e}(),m=function(){var e={};return Object.values(I.a).forEach((function(n){e[n]={li:[],ld:[],edit:[]}})),e}();e.forEach((function(e){var n=e.id,i=e.ops,s=r.getRecord(n);i.forEach((function(e){if(e.p.includes("children")&&Object(l.X)(e)&&!c.ld.includes(e.action.li)){a=y[I.a.Text],b=m[I.a.Text];var i=e.action.li,u=r.hasRecord(i)?r.getRecord(i):null;if(!u)return;var f=Object(p.D)(u),h=Object(p.T)(u);a.add.push({object_block_id:u.id,object_block_type:u.snapshot.type,object_sub_block_type:f,block_content_size:h,object_okr_data:S(u)}),b.li.push(i),R(a,c,b,r,n,o)}e.p.includes("children")&&Object(l.y)(e)&&(a=y[I.a.Text],b=m[I.a.Text],(e.action.oi||[]).forEach((function(e){var n=r.getRecord(e),o=Object(p.D)(n);a.add.push({object_block_id:n.id,object_block_type:n.snapshot.type,object_sub_block_type:o,object_okr_data:S(n)}),b.li.push(e)})),R(a,c,b,r,n,o));if(e.p.includes("children")&&Object(l.ZH)(e)&&!c.li.includes(e.action.ld)){a=y[I.a.Text],b=m[I.a.Text];var v=e.action.ld,_=r.getRecord(v),k=Object(p.D)(_);a.delete.push({object_block_id:_.id,object_block_type:_.snapshot.type,object_sub_block_type:k,object_okr_data:S(_)}),b.ld.push(v),R(a,c,b,r,n,o)}e.p.includes("children")&&Object(l.P)(e)&&(a=y[I.a.Text],b=m[I.a.Text],(e.action.od||[]).forEach((function(e){var n=r.getRecord(e),o=Object(p.D)(n);a.delete.push({object_block_id:n.id,object_block_type:n.snapshot.type,object_sub_block_type:o,object_okr_data:S(n)}),b.ld.push(e)})),R(a,c,b,r,n,o));e.p.includes("comments")&&(Object(l.X)(e)||Object(l.ZH)(e))&&(a=y[I.a.PartComment],b=m[I.a.PartComment],R(a,c,b,r,n,o)),Object(l.bG)(e)||Object(d.I)(e)?(!function(e,n){if(e.snapshot.type!==g.B.PAGE)return!1;if(n.p.includes("children")||n.p.includes("comments"))return!1;return!0}(s,e)?(a=y[I.a.Text],b=m[I.a.Text]):(a=y[I.a.Title],b=m[I.a.Title]),R(a,c,b,r,n,o)):!e.p.includes("comments")&&(Object(l.X)(e)&&c.ld.includes(e.action.li)||Object(l.ZH)(e)&&c.li.includes(e.action.ld))&&(a=y[I.a.Text],b=m[I.a.Text],R(a,c,b,r,n,o))}))})),Object(v.f)((function(){!function(e){Object.keys(e).forEach((function(n){var r=e[n];Object.keys(r).forEach((function(e){var o=r[e];if(!(o.length<1)){var i="",c=!1;"recursiveEdit"===e&&(c=!0),function(e,n){var r=T({},n);r.object_block_data=n.object_block_data.map((function(e){var n=T({},e),r=e.object_block_id;return n.object_block_id=r?Object(s.encryptTea)(r):"",n})),Object(f.P)(e,{record_id:Object(s.getToken)(),block_type:g.B.PAGE},r)}("ccm_docs_edit_click",{click:i="add"===e?"block_add":"delete"===e?"block_delete":"content_edit",object_block_data:o.map((function(e){return Object(u.omit)(e,"object_okr_data")})),domain:n,is_recursion:String(c),network_status:Object(s.isOnline)()?"online":"offline"}),function(e){return e.some((function(e){return[g.B.OKR,g.B.OBJECTIVE,g.B.KEY_RESULT,g.B.PROGRESS].includes(e.object_block_type)}))}(o)&&C("ccm_docs_okr_block_edit_click",{click:i,object_block_data:o,domain:n,is_recursion:String(c)})}}))}))}(y)}))}));function R(e,n,r,o,i,c){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6];if(!(r.edit.includes(i)||n.li.includes(i)&&!n.ld.includes(i))&&o.hasRecord(i)){var l=o.getRecord(i),s=Object(p.D)(l),u=a?e.recursiveEdit:e.edit;u.push({object_block_id:l.id,object_block_type:l.snapshot.type,object_sub_block_type:s,object_okr_data:S(l)}),r.edit.push(l.id);var d=l.snapshot.parent_id||"";n.edit.includes(d)||d&&i!==c&&R(e,n,r,o,d,c,!0)}}},dx_Wftd:function(e,n,r){"use strict";var o=r("dx_UtDZ"),i=r("dx_cDcd"),c=r.n(i),a=r("dx_h74D"),l=r("dx_D2m8"),s=r("dx_s1qv"),u=r("dx_o9oe"),d=r("dx_lwsE"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_W7W2"),g=r.n(v),b=r("dx_a1gu"),y=r.n(b),m=r("dx_Nsbk"),_=r.n(m),k=r("dx_dvfR"),O=r("dx_rQGm"),x=r("dx_H0Hj"),E=r("dx_zEdG"),S=r("dx_rldU"),C=r("dx_ZG9w"),I=r("dx_A5O8"),B=r("dx_o0o1"),T=r.n(B),w=r("dx_yXPU"),R=r.n(w),M=r("dx_PcQO"),j=r("dx_TSYQ"),D=r.n(j),A=r("dx_qKbM"),P=r("dx_Y1YR"),L=r("dx_UHze"),N=r("dx_S3cA"),F=r("dx_Tumq"),U=r("dx_gDjg");function H(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=_()(e);if(n){var i=_()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return y()(this,r)}}var V,W=function(e){g()(r,e);var n=H(r);function r(e){var i;return f()(this,r),(i=n.call(this,e)).encryptTeaToken=Object(o.encryptTea)(i.props.token),i.ref=c.a.createRef(),i.checkApplyEmbed=R()(T.a.mark((function e(){var n,r,c,a,l;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i.setState({isCheckPermission:!0}),n=i.props,r=n.title,c=n.token,a=n.file_type,e.next=4,i.props.block.blockManager.embedObjManager.checkApplyEmbed(c,a,r);case 4:return l=e.sent,i.setState({isCheckPermission:!1}),Object(o.collectEvent)(F.j.DOCX_EMBED_DOC,{action:F.N.ASK_ACHIEVE,embedToken:i.encryptTeaToken,permissionCode:l}),e.abrupt("return",l);case 8:case"end":return e.stop()}}),e)}))),i.handleOnMouseEnter=function(){var e=R()(T.a.mark((function e(n){var r,c;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.clientX,c=n.clientY,i.setState({mouseEvent:{isEnter:!0,clientX:r,clientY:c}}),Object(o.collectEvent)(F.j.DOCX_EMBED_DOC,{action:F.N.ENTER_DOM_ASKING,embedToken:i.encryptTeaToken}),e.next=5,i.checkApplyEmbed();case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i.handleOnMouseLeave=function(e){var n=e.clientX,r=e.clientY;i.setState({mouseEvent:{isEnter:!1,clientX:n,clientY:r}}),Object(o.collectEvent)(F.j.DOCX_EMBED_DOC,{action:F.N.LEAVE_DOM,embedToken:i.encryptTeaToken})},i.handleClick=function(){var e=R()(T.a.mark((function e(n){var r,o,c;return T.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=n).preventDefault(),o.stopPropagation(),o.nativeEvent.stopImmediatePropagation(),o.nativeEvent.stopPropagation(),e.next=7,i.checkApplyEmbed();case 7:if(c=e.sent,!Object(U.e)(c)){e.next=10;break}return e.abrupt("return");case 10:null===(r=i.ref.current)||void 0===r||r.onClick(),i.props.openLink(o);case 12:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i.handleMouseDown=function(e){e.preventDefault(),e.stopPropagation()},i.state={mouseEvent:{isEnter:!1},isCheckPermission:!1},i}return p()(r,[{key:"renderEmbedInlineText",value:function(){var e=this.props,n=e.logo,r=e.permissionCode,o=e.title,i=e.block,a=Object(U.s)(r),l=o.replace(/\n/g,""),d=i.editorAPI.config.get("isSSR"),f=D()({ssr:d},{loading:r===s.EmbedObjPermissionCode.LOADING},{"embed-inline-link--disable":Object(U.G)(r)},{"embed-inline-link--hoverable":!a},{"embed-inline-link--no-permission":a},{"mention-doc-permission-fg":Object(u.F)()});return c.a.createElement(A.S,{text:l,logo:n,className:f,onClick:this.handleClick,onMouseEnter:this.handleOnMouseEnter,onMouseLeave:this.handleOnMouseLeave,onMouseDown:this.handleMouseDown,autoSpace:Object(N.A)()})}},{key:"renderTextContent",value:function(){var e=this.props,n=e.permissionCode,r=e.componentId,o=e.url,i=Object(U.e)(n),a=this.props.block.editorAPI.config.get("isSSR");return i||a?c.a.createElement("span",{className:"mention-doc","data-component-id":r},this.renderEmbedInlineText()):c.a.createElement("a",{className:"mention-doc",target:a?"_blank":"_self",href:this.state.isCheckPermission?"javascript:void(0)":o,"data-href":o,rel:"noopener noreferrer","data-component-id":r},this.renderEmbedInlineText())}},{key:"renderContent",value:function(){var e=this.props.permissionCode,n=this.state.mouseEvent.isEnter,r=Object(U.s)(e),o=n&&r&&!this.state.isCheckPermission||!1;return c.a.createElement("span",null,c.a.createElement(M.Tooltip,{title:Object(U.f)(e),placement:"top",mouseEnterDelay:.2,popupAlign:{targetOffset:[0,-6]},visible:o},this.renderTextContent()))}},{key:"render",value:function(){var e=this.props,n=e.token,r=e.file_type,i=e.title,a=e.url,l=e.boundary,s=e.raw_url,d=e.isTranslated,f=e.permissionCode;o.wikiLinkInstance.isWiki()&&o.wikiLinkInstance.addTask(s);var h=this.props.recursionProps,p=h.isHistory,v=h.isPreview,g=h.isShortcut,b=h.isPresentationMode,y=this.state.mouseEvent,m=y.isEnter,_=y.clientX,k=y.clientY,O=m&&!Object(U.e)(f),x=(p||b||!v&&!g&&!d)&&!Object(L.E)();return Object(u.F)()&&(!x||Object(U.s)(f)||this.state.isCheckPermission)?this.renderContent():c.a.createElement(P.J,{isPresentationMode:b,isHistory:p,title:i,scroller:l,type:P.e.PAGE,token:n,url:a,mentionType:r,ref:this.ref,mouseEvent:{isEnter:O,clientX:_,clientY:k},once:!0},this.renderContent())}}]),r}(c.a.Component),z=r("dx_lSNA"),G=r.n(z),K=r("dx_n0nT"),q=r("dx_vdq3"),X=r("dx_Dejj"),Y=r("dx_EOPj"),J=r("dx_xj4m"),Z=r("dx_D2D9"),Q=r("dx_gaoC"),ee=K.S,te=q.S,ne=X.S,re=Y.S,oe=J.S,ie=Z.S,ce=Q.S,ae=(V={},G()(V,o.TYPE_ENUM.DOCX,ee),G()(V,o.TYPE_ENUM.FILE,te),G()(V,o.TYPE_ENUM.SHEET,ne),G()(V,o.TYPE_ENUM.BITABLE,re),G()(V,o.TYPE_ENUM.MINDNOTE,oe),G()(V,o.TYPE_ENUM.BOX,ie),G()(V,o.TYPE_ENUM.SLIDE,ce),V);function le(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=_()(e);if(n){var i=_()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return y()(this,r)}}var se=function(e){g()(r,e);var n=le(r);function r(){var e;f()(this,r);for(var i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).reportEvent=function(){var n=e.props,r=n.token,i=n.block,c=n.blockType;Object(E.P)("ccm_doc_content_page_click",{block_type:c,record_id:i.record.id},{target:O.o.CCM_DOCS_PAGE_VIEW,click:"click_inline_component",inline_type:S.k.MENTION_DOC,object_inline_id:Object(o.encryptTea)(r)})},e.openLink=function(n){e.reportEvent();var r=I.S.opendocContentConfig;if(r&&"outer"===r.hyperlinkHandler)Object(o.sendOpendocEvent)(o.OPENDOC_EVENT.HYPERLINK_CLICK,{url:e.url});else{var i=e.props.recursionProps.isHistory,c=n;Object(x.w)(e.url,c,!i)}},e.selectMentionDocComponent=function(n){var r=e.props.block;if(Object(C.i)(r)){var o=$(n.target).closest(".embed-inline-link.mention-doc"),i=o.length&&o[0];if(i){var c=Object(k.F)(i,r.editor);c&&r.setSelection(c,!0)}}},e}return p()(r,[{key:"render",value:function(){return c.a.createElement(W,Object.assign({},this.props,{url:this.url,logo:this.logo,openLink:this.openLink,selectMentionDocComponent:this.selectMentionDocComponent}))}},{key:"url",get:function(){return this.props.raw_url}},{key:"logo",get:function(){var e=this.props.file_type,n=ae[e]||te;return c.a.createElement(n,{className:"old-doc-icon"})}}]),r}(c.a.Component),ue=r("dx_J4zp"),de=r.n(ue),fe=r("dx_k64k"),he=Object(a.connect)((function(e,n){var r=n.token,o=Object(U.n)(n.block.blockManager);return{permissionCode:Object(fe.S)(e,o,r)}}))((function(e){var n=e.block,r=e.permissionCode,o=e.recursionProps,a=n.id,l=o.blockViewportAdapter,s=o.blockManager,u=Object(i.useCallback)((function(){return s.rootBlockId===a||l.isBlockVisible(a)}),[l,a,s]),d=Object(i.useRef)(u()),f=Object(i.useState)(r),h=de()(f,2),p=h[0],v=h[1],g=Object(i.useCallback)((function(){d.current&&r!==p&&v(r)}),[r,p]);Object(i.useEffect)((function(){g()}),[g,r]);var b=Object(i.useCallback)((function(e){var n=e.isVisible;d.current=n,g()}),[g]);return Object(i.useEffect)((function(){return d.current=u(),g(),l.onBlockChange(a,b),function(){l.offBlockChange(a,b)}}),[a,l,b,g,u]),Object(i.useEffect)((function(){var r=e.token,o=e.file_type,i=e.title;n.blockManager.embedObjManager.hasEmbedObj(r)||n.blockManager.embedObjManager.addEmbedObj(r,i,o)}),[]),c.a.createElement(se,Object.assign({},e,{permissionCode:p}))}));r("dx_cQWW"),n.S=Object(a.connect)((function(e){return{isTranslated:o.selectors.translate.selectTranslateStatus(e).translated}}))((function(e){var n=Object(i.useContext)(l.X),r=n.blockViewportAdapter,o=n.isHistory,a=n.isShortcut,d=Object(u.a)()&&r&&(o||!a),f=Object(U.A)(e.token,e.file_type,e.title);return d?c.a.createElement(he,Object.assign({},e,{title:f,recursionProps:n})):c.a.createElement(se,Object.assign({},e,{title:f,recursionProps:n,permissionCode:s.EmbedObjPermissionCode.READABLE}))}))},dx_Wkzy:function(e,n,r){"use strict";r.d(n,"x",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("bitable-blockdep-loader")},dx_WmT0:function(e,n,r){"use strict";var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=function(){function e(){var n=this;i()(this,e),this.listeners=[],this.bound=!1,this.handleGlobalClick=function(e){n.listeners.forEach((function(n){return n(e)}))}}return a()(e,[{key:"addListener",value:function(e){this.listeners.push(e),this.bound||this.listenGlobalClickEvent()}},{key:"removeListener",value:function(e){var n=this.listeners.findIndex((function(n){return n===e}));n>=0&&this.listeners.splice(n,1),0===this.listeners.length&&this.bound&&this.unListenGlobalClickEvent()}},{key:"listenGlobalClickEvent",value:function(){document.addEventListener("mousedown",this.handleGlobalClick,!0),this.bound=!0}},{key:"unListenGlobalClickEvent",value:function(){document.removeEventListener("mousedown",this.handleGlobalClick,!0),this.bound=!1}}]),e}();n.S=new l},dx_WqcI:function(e,n,r){},dx_Wy0Q:function(e,n,r){},dx_WzJv:function(e,n,r){"use strict";r.d(n,"D",(function(){return i})),r.d(n,"T",(function(){return c}));var o=r("dx_B28d");function i(e){var n="",r=e.snapshot.type;if(r===o.B.DIAGRAM)n=e.snapshot.diagram.diagramType;else if(r===o.B.ISV)n=e.snapshot.block_type_id;else if(r===o.B.FILE){var i=e.snapshot.file.name.split(".");n=i.length>1?i.pop().toLowerCase():"none"}else r===o.B.IFRAME?n=e.snapshot.iframe.component.type:r===o.B.IMAGE&&(n=e.snapshot.image.mimeType);return n}function c(e){var n;return e.snapshot.type===o.B.FILE&&(n=e.snapshot.file.size),n}},dx_X0eS:function(e,n,r){},dx_X1XY:function(e,n,r){"use strict";r.d(n,"r",(function(){return c})),r.d(n,"l6",(function(){return a})),r.d(n,"h",(function(){return l})),r.d(n,"l",(function(){return o})),r.d(n,"k",(function(){return u})),r.d(n,"X",(function(){return s}));var o,i=r("dx_D8nn"),c=new i.i,a=new i.i,l={SHOW_LOADING:"SHOW_LOADING",HIDE_LOADING:"HIDE_LOADING",SHOW_ERROR:"SHOW_ERROR",SHOW_SNAPSHOT:"SHOW_SNAPSHOT",RELOAD:"RELOAD",SHOW_FOLD:"SHOW_FOLD",SEND_COVER_INFO:"SEND_COVER_INFO",HIDE_MOBILE_HISTORY:"HIDE_MOBILE_HISTORY",RESET_HISTORY_ITEM:"RESET_HISTORY_ITEM"};!function(e){e.FOCUS="FOCUS",e.UNFOCUS="UNFOCUS"}(o||(o={}));var s,u="HISTORY_DIFF_TEXT_HIGHLIGHT_TO_EXTENSION";!function(e){e.EXTERNAL_HISTORY_RESULT_READY="EXTERNAL_HISTORY_RESULT_READY",e.EXTERNAL_HISTORY_ALL_READY="EXTERNAL_HISTORY_ALL_READY,"}(s||(s={}))},dx_X279:function(e,n,r){"use strict";r.d(n,"N",(function(){return a}));var o=r("dx_h6a8"),i=r("dx_bdgK"),c=null,a=function(){return c||(c=function(){var e,n,r=[],c=Object(o.throttle)((function(e){var o=e[0];n=o.contentRect,r.forEach((function(e){return e(n)}))}),10,{leading:!0,trailing:!0}),a=new i.S(c),l=function(e){var n=r.indexOf(e);n>-1&&r.splice(n,1)};return{init:function(n){(e=n).current&&e.current&&a.observe(e.current)},onResize:function(e){return r.push(e),e(n),function(){l(e)}},offResize:l,dispose:function(){r.length=0,c.cancel(),e&&e.current&&a.unobserve(e.current)},get rect(){return n}}}()),c}},dx_X36X:function(e,n,r){"use strict";r.d(n,"q",(function(){return g}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_cDcd");function v(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var g=function(e){s()(r,e);var n=v(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"getAfterSlot",value:function(){var e=this;return function(n){return Object(p.useLayoutEffect)((function(){e.blockManager.layoutManager.notifyRenderFinish(n.blockId)}),[n.blockId]),null}}}]),r}(r("dx_Vau3").A)},dx_X3XX:function(e,n,r){"use strict";r.d(n,"y",(function(){return o})),r.d(n,"Q",(function(){return a})),r.d(n,"r",(function(){return l}));var o,i=r("dx_dVj6"),c=r.n(i);!function(e){e.HANDLE_DOCX_WORD_COUNT="HANDLE_DOCX_WORD_COUNT",e.SEND_DOCX_WORD_COUNT="SEND_DOCX_WORD_COUNT"}(o||(o={}));var a=c()().addRange(0,1114111).removeRange(19968,40869).removeRange(40870,40907).removeRange(13312,19893).removeRange(131072,173782).removeRange(173824,177972).removeRange(177984,178205).removeRange(12032,12245).removeRange(11904,12019).removeRange(63744,64217).removeRange(194560,195101).removeRange(59413,59503).removeRange(58368,58856).removeRange(58880,59087).removeRange(12736,12771).removeRange(12272,12283).removeRange(12549,12576).removeRange(12704,12730).removeRange(65,90).removeRange(97,122).removeRange(48,57).remove(39),l=c()().addRange(19968,40869).addRange(40870,40907).addRange(13312,19893).addRange(131072,173782).addRange(173824,177972).addRange(177984,178205).addRange(12032,12245).addRange(11904,12019).addRange(63744,64217).addRange(194560,195101).addRange(59413,59503).addRange(58368,58856).addRange(58880,59087).addRange(12736,12771).addRange(12272,12283).addRange(12549,12576).addRange(12704,12730)},dx_X58X:function(e,n,r){},dx_X5XQ:function(e,n,r){},dx_X68U:function(e,n,r){"use strict";r.d(n,"e",(function(){return C}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_V90V"),a=r("dx_TSYQ"),l=r.n(a),s=r("dx_cDcd"),u=r.n(s),d=r("dx_lPJP"),f=r("dx_J4zp"),h=r.n(f),p=r("dx_PcQO"),v=r("dx_zEdG"),g=r("dx_B28d"),b=r("dx_Sa3H"),y=r("dx_d5dp"),m=r("dx_mopU"),_=r("dx_f5gY");r("dx_G08E");function k(e){var n=e.dueTime,r=e.dueTimezone,o=e.isAllDay,i=e.reminders,c=e.onChange,a=e.completed,l=e.blockId,d=e.recordId,f=e.disabled,k=e.blockManager,O=e.renderPrefix,x=e.onVisibleChange,E=e.rrule,S=Object(s.useState)(!1),C=h()(S,2),I=C[0],B=C[1],T=Object(s.useState)({dueTime:n,dueTimezone:r,isAllDay:o,reminders:i}),w=h()(T,2),R=w[0],M=w[1],j=Object(s.useCallback)((function(e){B(e),x(e)}),[B,x]);Object(s.useEffect)((function(){M({dueTime:n,dueTimezone:r,isAllDay:o,reminders:i})}),[n,r,o,i]);var D,A=Object(s.useCallback)((function(){return document.querySelector("#docx-popup-container")||document.body}),[]),P=Object(s.useCallback)((function(e){if(j(e),e){R.dueTime||Object(y.k)({blockId:l,actionType:"click_task_doc_reminder_panel",blockManager:k});var n=R.dueTime?R:Object(m.M)();M(n),Object(v.T)("ccm_doc_reminder_panel_view",{record_id:d,block_type:g.B.TASK},{is_set_time:!n.isAllDay,is_set_reminder:Boolean(n.reminders.filter((function(e){return-1!==e.time})).length)})}else c(R)}),[d,l,k,R,c,j]),L=Object(s.useCallback)((function(e){M(Object(m.c)(e));var n=e.action;n&&Object(v.P)("ccm_doc_reminder_panel_click",{record_id:d,block_type:g.B.TASK},{click:"click_time_option",target:"none",sub_click:n})}),[d]),N=Object(s.useCallback)((function(){c({dueTime:0,dueTimezone:"",isAllDay:!1,reminders:[]}),j(!1),Object(y.k)({blockId:l,actionType:"click_task_delete_reminder",blockManager:k})}),[c,l,k,j]);return f&&!n?null:u.a.createElement(u.a.Fragment,null,O?O(R):null,u.a.createElement(p.Dropdown,{getPopupContainer:A,align:{overflow:{adjustX:!0,adjustY:!1}},overlayClassName:(D="popOverWrapper","task-block__due-time-picker__".concat(D)),disabled:f,destroyOnHide:!0,visible:I,onVisibleChange:P,showAction:["click"],hideAction:["click"],trigger:["click"],placement:"bottomLeft",overlay:function(){return u.a.createElement(b.S,{reminderData:Object(m.U)(R),users:[],type:"intact",onChange:L,showCheckbox:!0})}},u.a.createElement(_.k,{dueTime:R.dueTime,dueTimezone:R.dueTimezone,isAllDay:R.isAllDay,reminders:R.reminders,completed:a,disabled:f,onRemove:N,rrule:E,isPresentationMode:k.config.get("isPresentationMode")})))}var O=r("dx_Orag"),x=r("dx_Cg1F"),E=r("dx_Bs0J"),S=[];function C(e){var n=e.className,r=e.style,o=Object(s.useContext)(E.o);if(!o)return null;var a=o.taskData,f=o.selectionAPI,h=o.blockManager,p=o.boundary,v=o.editable,g=o.currentUserId,b=o.record,y=o.blockId,_=o.assigneePickerType,C=o.handleAssigneeChange,I=o.handleDueTimeChange,B=o.block,T=o.onAssigneeVisibleChange,w=o.onDueTimeVisibleChange,R=a.assignees_detail,M=void 0===R?[]:R,j=a.due_time,D=void 0===j?0:j,A=a.due_timezone,P=void 0===A?Object(m.C)():A,L=a.is_all_day,N=void 0!==L&&L,F=a.reminders,U=void 0===F?[]:F,H=a.rrule,V=Object(x.G)(a);return u.a.createElement("span",{className:l()({"task-block-task-form":!0,"task-block-task-form__empty":0===M.length&&!D}),contentEditable:!1},u.a.createElement(c.S,null,u.a.createElement("span",{className:l()(n,i()({},O.y,V)),style:r,onMouseDown:function(e){e.stopPropagation(),e.preventDefault()}},u.a.createElement(d.Z,{disabled:!v,blockManager:h,selectionAPI:f,boundary:p,record:b,blockId:y,type:_,assignees:M,onChange:C,currentUserId:g,block:B,onVisibleChange:T}),u.a.createElement(k,{disabled:!v,blockId:y,recordId:b.id,dueTime:D,dueTimezone:P,isAllDay:N,reminders:U||S,onChange:I,blockManager:h,completed:V,onVisibleChange:w,rrule:H,renderPrefix:function(e){var n=e.dueTime;return M.length||n?u.a.createElement("span",{className:"task-block-gap",style:{margin:"0 8px"}}):u.a.createElement("span",{style:{margin:"0 4px"}})}}))))}},dx_X8XU:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("g",{clipPath:"url(#gif_pre_loading_svg__clip0)",fill:"#fff"},i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M54.366 39.077a.59.59 0 01-.773.338l-.743-.295a.612.612 0 01-.343-.782 24.328 24.328 0 001.154-4.305.612.612 0 01.687-.506l.792.116a.59.59 0 01.5.68 26.337 26.337 0 01-1.274 4.754zm1.624-10.018a.59.59 0 01-.586.607l-.8.01a.612.612 0 01-.615-.592 23.842 23.842 0 00-.581-4.408.612.612 0 01.44-.731l.775-.198a.59.59 0 01.723.435c.366 1.588.584 3.22.644 4.877zm-2.344-9.87a.59.59 0 01-.307.785l-.735.316a.612.612 0 01-.795-.311 24.152 24.152 0 00-2.226-3.855.612.612 0 01.128-.844l.641-.479a.59.59 0 01.835.127 26.16 26.16 0 012.46 4.26zm-5.934-8.23a.59.59 0 01.015.843l-.56.573a.612.612 0 01-.853.015 23.838 23.838 0 00-3.526-2.707.612.612 0 01-.205-.83l.409-.687a.59.59 0 01.818-.203 25.846 25.846 0 013.901 2.996zm-8.635-5.325a.59.59 0 01.338.773l-.295.743a.612.612 0 01-.782.343 24.343 24.343 0 00-4.305-1.154.612.612 0 01-.506-.687l.116-.792a.59.59 0 01.68-.5 26.323 26.323 0 014.754 1.274zM29.059 4.01a.59.59 0 01.607.586l.01.8a.612.612 0 01-.592.615c-1.496.056-2.971.253-4.408.582a.612.612 0 01-.731-.44l-.198-.776a.59.59 0 01.435-.723 25.84 25.84 0 014.877-.644zm-9.085 2.651a.59.59 0 00-.786-.307 26.16 26.16 0 00-4.26 2.46.59.59 0 00-.127.834l.479.641c.198.266.573.32.844.128a24.157 24.157 0 013.855-2.226.612.612 0 00.31-.795l-.315-.735zm-9.015 5.628a.59.59 0 01.843-.016l.573.56c.237.23.24.61.015.853a23.836 23.836 0 00-2.707 3.526.612.612 0 01-.83.205l-.687-.409a.59.59 0 01-.203-.818 25.832 25.832 0 012.996-3.902zm-4.552 8.296a.59.59 0 00-.773.338 26.323 26.323 0 00-1.274 4.755.59.59 0 00.5.68l.792.115a.612.612 0 00.688-.506 24.329 24.329 0 011.153-4.305.612.612 0 00-.343-.782l-.743-.295zM4.01 30.94a.59.59 0 01.586-.607l.8-.01a.612.612 0 01.615.592c.056 1.496.253 2.971.582 4.408a.612.612 0 01-.44.731l-.776.198a.59.59 0 01-.723-.435 25.84 25.84 0 01-.644-4.877zm2.344 9.87a.59.59 0 01.307-.785l.735-.316a.612.612 0 01.795.311 24.159 24.159 0 002.226 3.855.612.612 0 01-.128.844l-.641.479a.59.59 0 01-.834-.127 26.16 26.16 0 01-2.46-4.26zm5.935 8.23a.59.59 0 01-.016-.843l.56-.573a.612.612 0 01.853-.015 23.843 23.843 0 003.526 2.707c.28.177.375.544.205.83l-.409.687a.59.59 0 01-.818.203 25.846 25.846 0 01-3.902-2.996zm8.634 5.325a.59.59 0 01-.338-.773l.295-.743a.612.612 0 01.782-.343 24.328 24.328 0 004.305 1.154c.327.056.554.36.506.687l-.116.792a.59.59 0 01-.68.5 26.33 26.33 0 01-4.754-1.274zm10.018 1.624a.59.59 0 01-.607-.586l-.01-.8a.612.612 0 01.592-.615 23.834 23.834 0 004.408-.582c.323-.073.65.12.731.44l.198.776a.59.59 0 01-.435.723c-1.588.366-3.22.584-4.877.644zm9.87-2.344a.59.59 0 01-.785-.307l-.316-.735a.612.612 0 01.311-.795 24.152 24.152 0 003.855-2.226.612.612 0 01.844.128l.479.641a.59.59 0 01-.127.834 26.153 26.153 0 01-4.26 2.46zm8.23-5.934a.59.59 0 01-.843.015l-.573-.56a.612.612 0 01-.015-.853 23.849 23.849 0 002.707-3.526.612.612 0 01.83-.205l.687.409a.59.59 0 01.203.818 25.846 25.846 0 01-2.996 3.901z"}),i.a.createElement("path",{d:"M27.11 34.339c-.463.603-1.105 1.06-1.925 1.371-.82.31-1.752.466-2.795.466-1.073 0-2.022-.243-2.848-.73-.826-.486-1.465-1.18-1.916-2.083-.445-.908-.677-1.965-.694-3.173v-1.002c0-1.933.463-3.442 1.388-4.526.926-1.09 2.218-1.635 3.876-1.635 1.424 0 2.555.352 3.393 1.055.838.703 1.342 1.717 1.512 3.041h-2.18c-.246-1.541-1.14-2.312-2.68-2.312-.997 0-1.756.36-2.277 1.082-.516.714-.782 1.766-.8 3.155v.984c0 1.383.29 2.458.87 3.226.586.761 1.398 1.142 2.435 1.142 1.136 0 1.945-.257 2.425-.773v-2.505h-2.636v-1.687h4.851v4.904zM31.9 36h-2.215V23.203h2.214V36zm10.107-5.423h-5.15V36h-2.224V23.203h8.13v1.793h-5.907v3.806h5.15v1.775z"})),l=i.a.createElement("defs",null,i.a.createElement("clipPath",{id:"gif_pre_loading_svg__clip0"},i.a.createElement("path",{fill:"#fff",d:"M0 0h60v60H0z"})));n.S=function(e){return i.a.createElement("svg",c({width:60,height:60,viewBox:"0 0 60 60",fill:"none"},e),a,l)}},dx_XBgx:function(e,n,r){"use strict";r.d(n,"v",(function(){return re}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_yG8O"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_Uyc2"),h=r.n(f),p=(r("dx_A1AB"),r("dx_Vvd7")),v=r("dx_xjz2"),g=r("dx_h6a8"),b=r("dx_GPzN"),y=r("dx_eSV8"),m=r("dx_B28d"),_=r("dx_uv4w"),k=r("dx_hSCS"),O=r("dx_PiBr"),x=r("dx_k8kI"),E=r("dx_MMMl"),S=r("dx_I1IF"),C=r("dx_MP54");function I(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.id,o=e.childrenIds||[],i=n.preTravel,c=n.postTravel,a=!1,l=0,s=o.length;l<s;l++){var u=o[l],d=e.getNode(u);if(i){var f=i(d,e,r,u,l);a="undefined"===typeof f?a:f}if(!a&&d&&I(d,n),c){var h=c(d,e,r,u,l);a="undefined"===typeof h?a:h}}}function B(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,r=n.get(e);return!!r&&!r.show}function T(e,n){for(var r=e.top,o=e.bottom,i=e.node,c=e.layoutTree,a=e.foldedStateMap,l=e.bufferTop,s=void 0===l?r:l,u=e.bufferBottom,d=void 0===u?o:u,f=e.isParentInBuffer,h=i.childrenIds||[],p=function(e,l){var u,p=h[e],v=i.getNode(p),g=c.get(p);if(!g)return"continue";var b=(null===v||void 0===v?void 0:v.type)||"",y=g.height,_=g.topToParent,k=void 0===_?0:_;if(B(p,a))return"continue";var O=k+y;if(s>O)return"continue";if(d<k)return"break";var x=r<=O&&o>=k;if(b===m.B.TABLE)return n(p,v,x),v&&I(v,{preTravel:function(e,r,o,i){n(i,e,!!x&&!f)}}),"continue";var E=f;x?n(p,v,!f):s<=O&&d>=k&&(n(p,v,!1),E=!0);var S=b===m.B.GRID;(null===v||void 0===v||null===(u=v.childrenIds)||void 0===u?void 0:u.length)&&T({node:v,layoutTree:c,foldedStateMap:a,bufferTop:S?0:s-k,top:r-k,bottom:o-k,bufferBottom:S?y:d-k,isParentInBuffer:E},n)},v=0,g=h.length;v<g;v+=1){var b=p(v);if("continue"!==b&&"break"===b)break}}function w(e,n,r){var o=function(e){var n=new Map;return I(e,{preTravel:function(r,o,i,c,a){if(r){var l=r.folded,s=0===a?o:null===o||void 0===o?void 0:o.childAt(a-1),u={isRoot:c===e.id,relativeId:null===s||void 0===s?void 0:s.id,parentId:i,folded:l},d=C.S.calculateFoldState(r,u,n,(function(n){var r;return null===(r=e.getNode(n))||void 0===r?void 0:r.depth}));d&&n.set(c,d)}}}),n}(e),i=function(e,n,r){var o=new Map;return I(e,{postTravel:function(e,i,c,a){var l,s=(null===e||void 0===e?void 0:e.type)||"",u=(null===e||void 0===e?void 0:e.childrenIds)||[];if(B(a,r))o.set(a,{height:0,marginTop:0,marginBottom:0,distanceToFirstChild:0});else{var d=n.getContext().getLayoutNodeBuilderByBlockType(s),f=(null===d||void 0===d?void 0:d.config)||{},h=f.defaultHeight,p=void 0===h?26:h,v=f.defaultMarginTop,g=void 0===v?0:v,b=f.defaultMarginBottom,y=void 0===b?0:b;if(s===m.B.TABLE)o.set(a,{height:p,marginTop:g,marginBottom:y,distanceToFirstChild:0});else if(s===m.B.GRID){var _=u.reduce((function(e,n){var r,i;return Math.max(e,null!==(r=null===(i=o.get(n))||void 0===i?void 0:i.height)&&void 0!==r?r:26)}),0);o.set(a,{height:_,marginTop:g,marginBottom:y,distanceToFirstChild:0})}else{for(var k,O=p+u.reduce((function(e,n){var r,i;return e+(null!==(r=null===(i=o.get(n))||void 0===i?void 0:i.height)&&void 0!==r?r:26)}),0),x=0;x<u.length;x++){var E,S=u[x],C=o.get(S);0!==C.height&&(O+=Math.max(C.marginTop,(null===(E=k)||void 0===E?void 0:E.marginBottom)||0),k=C)}O+=(null===(l=k)||void 0===l?void 0:l.marginBottom)||0,o.set(a,{height:O,marginTop:g,marginBottom:y,distanceToFirstChild:p})}}}}),function(e){I(e,{preTravel:function(e,n,r,i,c){var a=o.get(i),l=(null===e||void 0===e?void 0:e.type)||"";if(r&&a){var s=l===m.B.TABLE,u=n.type===m.B.GRID;if(0===c||u){var d,f=o.get(r);return a.topToParent=null!==(d=null===f||void 0===f?void 0:f.distanceToFirstChild)&&void 0!==d?d:0,s}var h=n.childIdAt(c-1),p=o.get(h),v=p.topToParent,g=p.height,b=v+g,y=p.marginBottom;if(B(i))return a.topToParent=b,s;var _=a.marginTop;return a.topToParent=v+g+Math.max(y,_),s}},postTravel:function(){return!1}})}(e),o}(e,r,o),c=n.top,a=n.height,l=n.bufferTopRange,s=n.bufferBottomRange,u=new Set,d=new Set;return T({node:e,layoutTree:i,foldedStateMap:o,top:c,bottom:c+a,bufferTop:Math.max(c-l,0),bufferBottom:c+a+s},(function(e,n,r){r?u.add(e):d.add(e)})),{viewporNodeIdSet:u,bufferNodeIdSet:d}}function R(e,n,r){var o=Object.keys(e.block_map).map((function(e){var r=n.getTaskIdsByRecordId(e);if(!r)throw new Error("can not find task id when transformBlockMapToClientvars");return{taskIds:Array.from(r),recordId:e}})).reduce((function(e,n){return n.taskIds.forEach((function(r){e[r]||(e[r]=[]),e[r].push(n.recordId)})),e}),{});return Object.keys(o).reduce((function(r,i){var c=o[i].reduce((function(n,r){return n[r]=e.block_map[r],n}),{}),a=Object.assign({},n.getClientvarByTaskId(i),{block_map:c});return r.push({taskId:i,clientvar:a}),r}),[]).sort((function(e){return e.taskId===r?-1:1}))}var M=r("dx_lmGg"),j=r("dx_LA8U"),D=r("dx_D77K"),A=r("dx_NZ34");function P(e,n){return Object.values(e.block_map).forEach(n)}var L=function(){function e(){s()(this,e),this.hasMoreStatus=new Map,this.waitForApplyMap=new Map,this.appliedIdSet=new Set}return d()(e,[{key:"addClientvar",value:function(e,n){var r=this,o=n.has_more,i=this.waitForApplyMap.get(e)||new Set;P(n,(function(e){r.appliedIdSet.has(e.id)||i.add(e.id)})),i.delete(e),this.hasMoreStatus.set(e,o),this.waitForApplyMap.set(e,i)}},{key:"applyClientvar",value:function(e,n){var r=this,o=this.waitForApplyMap.get(e);P(n,(function(e){o.delete(e.id),r.appliedIdSet.add(e.id)})),this.waitForApplyMap.set(e,o)}},{key:"isTaskAllApplied",value:function(e){var n;return!1===this.hasMoreStatus.get(e)&&0===(null===(n=this.waitForApplyMap.get(e))||void 0===n?void 0:n.size)}},{key:"isAllTasksApplied",value:function(){var e=this,n=!1,r=Array.from(this.hasMoreStatus.keys());r.some((function(n){return e.hasMoreStatus.get(n)}))&&(n=!0),n&&Object(A.b)({cost_time:0,extra:"clientvar.hasMore is true, ids: ".concat(r.map((function(e){return Object(D.w)(e)})).join(","))});var o=Array.from(this.waitForApplyMap.keys()).find((function(n){return e.waitForApplyMap.get(n).size}));return!n&&!o}},{key:"destroy",value:function(){this.hasMoreStatus.clear(),this.waitForApplyMap.clear(),this.appliedIdSet.clear()}}]),e}(),N=r("dx_Kkjd"),F=function(){function e(){var n;s()(this,e),this.pendingClientvarMap=new Map,this.pendingTypeKey=(n={},i()(n,N.J.NORMAL,[]),i()(n,N.J.FOLDABLE,[]),i()(n,N.J.TABLE,[]),n),this.mapRecordIdToTaskIds=new Map,this.addEventCbList=[]}return d()(e,[{key:"getClientvarByTaskId",value:function(e){return this.pendingClientvarMap.get(e)}},{key:"getTaskIdsByRecordId",value:function(e){return this.mapRecordIdToTaskIds.get(e)}},{key:"add",value:function(e,n,r){var o=this;if(r){Object.keys(r.block_map).forEach((function(n){var r=o.mapRecordIdToTaskIds.get(n)||new Set;r.add(e),o.mapRecordIdToTaskIds.set(n,r)}));var i=this.pendingClientvarMap.get(e);i?this.pendingClientvarMap.set(e,Object(j.g)([i,r])):(this.pendingTypeKey[n].push(e),this.pendingClientvarMap.set(e,r)),this.dealAddEventCb(e,n,r)}}},{key:"hasType",value:function(e){var n;return!!(null===(n=this.pendingTypeKey[e])||void 0===n?void 0:n.length)}},{key:"has",value:function(e){return this.pendingClientvarMap.has(e)}},{key:"destroy",value:function(){var e=this;this.pendingClientvarMap.clear(),this.mapRecordIdToTaskIds.clear(),Object.keys(this.pendingTypeKey).forEach((function(n){e.pendingTypeKey[n]=[]})),this.addEventCbList=[]}},{key:"onDataAdd",value:function(e){e&&this.addEventCbList.push(e)}},{key:"dealAddEventCb",value:function(e,n,r){var o=this.addEventCbList.length;if(!(o<=0))for(var i=0;i<o;++i){(0,this.addEventCbList[i])(e,n,r)}}}]),e}(),U=r("dx_UtDZ");function H(){var e={idle_force_apply:!0,force_apply_block_count:200,idle_limit_time:50,idle_max_remain_time:500};return e=Object.assign(e,Object(U.getMinaConfig)(N.V,e))}var V,W,z,G,K,q,X,Y=0,J=new URL(location.href).searchParams.get("interval"),Z=J?parseInt(J,10):0,Q=H(),$=function(){function e(n){s()(this,e),this._idleCallback=void 0,this._busy=!1,this._needStop=!1,this._timeout=Q.idle_limit_time,this._maxRemainTime=Q.idle_max_remain_time,this.channel=window.MessageChannel?new window.MessageChannel:void 0,this.cancelNumber=void 0,this.requestIdleCallback=window.requestIdleCallback?window.requestIdleCallback.bind(window):this.messageChannelIdleCallback,this.cancelIdleCallback=window.cancelIdleCallback?window.cancelIdleCallback.bind(window):void 0,n&&(this._idleCallback=n)}return d()(e,[{key:"timeoutIdleCallback",value:function(e,n){var r=this,o=Date.now();return setTimeout((function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,r._maxRemainTime-(Date.now()-o))}})}),1),0}},{key:"messageChannelIdleCallback",value:function(e,n){var r=this;return this.channel?(this.channel.port1.onmessage=function(){var n=Date.now();e({didTimeout:!1,timeRemaining:function(){return Math.max(0,r._maxRemainTime-(Date.now()-n))}})},this.channel.port2.postMessage(null),0):this.timeoutIdleCallback(e)}}]),d()(e,[{key:"setIdleCallback",value:function(e){e&&(this._idleCallback=e)}},{key:"start",value:function(){var e=this;return this._needStop=!1,!!this._busy||!!this._idleCallback&&(this._busy=!0,this.cancelNumber=this.requestIdleCallback((function(n){if(Date.now()-Y<Z)return e._busy=!1,e.start(),!0;if(Y=Date.now(),e._needStop)return e._busy=!1,!1;var r=n.timeRemaining(),o=n.didTimeout,i=e._idleCallback&&e._idleCallback(o,r);e._busy=!1,i&&e.start()}),{timeout:this._timeout}),!0)}},{key:"stop",value:function(){this._needStop=!0,this.cancelIdleCallback&&this.cancelIdleCallback(this.cancelNumber)}},{key:"destroy",value:function(){this.stop(),this._idleCallback=void 0}}]),e}(),ee=r("dx_ij4R"),te=H();function ne(e,n){for(var r=e.length,o=r>>1,i=o-1;i>=0||o<r;){if(o<r){if(n(e[o],o))break;o+=1}if(i>=0){if(n(e[i],i))break;i-=1}}}var re=Object(v.s)(ee.e)((X=function(){function e(n){var r=this;s()(this,e),this.eventEmitter=n,a()(this,"model",z,this),a()(this,"structureQuery",G,this),a()(this,"api",K,this),a()(this,"layoutManager",q,this),this.splitter=void 0,this.clientVarStorage=void 0,this.clientVarApplyStatus=void 0,this._token=void 0,this._startId=void 0,this._needApplyStartIdSoon=!1,this._needApplyAll=!1,this.onFirstSliceReady=void 0,this.beforeApplyCb=void 0,this.duplicatedApplyCb=void 0,this.afterApplyCb=void 0,this.onFirstSliceApplied=void 0,this.idleWorker=void 0,this.isInFileCopying=!1,this.fetchAllDone=!1,this.updateStartIdIfNeeded=Object(g.debounce)((function(){var e=null;(ne(r.layoutManager.getViewportBlocks(),(function(n){var o;return(null===(o=r.model.getBlockModelByBlockId(n))||void 0===o?void 0:o.type)===m.B.PENDING&&(e=n,!0)})),null===e)&&ne(r.layoutManager.getBufferBlocks(),(function(n){var o;return(null===(o=r.model.getBlockModelByBlockId(n))||void 0===o?void 0:o.type)===m.B.PENDING&&(e=n,!0)}));if(e){var n,o=null===(n=r.model.getRecordByBlockId(e))||void 0===n?void 0:n.id;o&&r._startId!==o&&r.setStartId(o,!0)}}),0),this.handleFetchAllDone=function(){r.fetchAllDone=!0},this.handleClientvarApplyAllDone=function(){r.idleWorker.stop(),r.clientVarStorage.destroy(),r.clientVarApplyStatus.destroy(),r.splitter.destroy()},this.clientVarStorage=new F,this.clientVarApplyStatus=new L,this.splitter=new S.ClientvarSplitter(this.clientVarStorage),this.idleWorker=new $((function(e,n){if(!te.idle_force_apply&&(e||n<1))return!0;var o=r.idleGetNextClientvar(n);if(!o)return r.fetchAllDone&&r.checkApplyStatus(),!1;var i=performance.now(),c=[],a=R(o,r.clientVarStorage,r.token);return a.length?(a.forEach((function(e){var n=e.taskId,o=e.clientvar;r.handleResponse(n,o),c.push({task_id:n,block_count:Object(A.K)(o),block_list:Object(A.W)(o)})})),Object(A.X)({task_count:a.length,task_data:c,cost_time:performance.now()-i,isPreEditableEnable:r.isPreEditableEnable()}),!0):(Object(A.X)({task_count:a.length,task_data:c,cost_time:performance.now()-i,isPreEditableEnable:r.isPreEditableEnable()}),!1)})),this.eventEmitter.on(M.R.CLIENTVAR_FETCH_ALL_DONE_NEW,this.handleFetchAllDone),this.eventEmitter.on(M.R.CLIENTVAR_APPLY_ALL_DONE,this.handleClientvarApplyAllDone)}return e=Object(k.h)(e,void 0,0)||e,d()(e,[{key:"add",value:function(e,n,r){var o=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.clientVarApplyStatus.addClientvar(e,r);var c=performance.now();if(i)return this.isInFileCopying=!r.concurrent,this.clientVarStorage.add(this._token,n,r),Object(A.f)({task_id:this.token,task_type:n,block_count:Object(A.K)(r),isFirstSlice:i,cost_time:performance.now()-c}),b.S.setExtraData({fg:{allow_pre_edit:this.isPreEditableEnable()}}),this.handleFirstSlice(r),void this.eventEmitter.on(x.w2,this.updateStartIdIfNeeded);if(this.clientVarStorage.add(e,n,r),Object(A.f)({task_id:e,task_type:n,block_count:Object(A.K)(r),isFirstSlice:i,cost_time:performance.now()-c}),this.isPreEditableEnable()){var a;if(this.clientVarApplyStatus.isTaskAllApplied(e))null===(a=this.duplicatedApplyCb)||void 0===a||a.call(this,e);if(this._needApplyAll||this._needApplyStartIdSoon&&this._startId&&!r.block_map[this._startId]){var l=this.splitter.split({size:1/0}),s=performance.now();if(l){var u=R(l,this.clientVarStorage,this.token),d=[];u.forEach((function(e){o.handleResponse(e.taskId,e.clientvar),d.push({task_id:e.taskId,block_count:Object(A.K)(l),block_list:Object(A.W)(r)})})),Object(A.X)({task_count:u.length,task_data:d,cost_time:performance.now()-s,isPreEditableEnable:!0})}return}this._needApplyStartIdSoon=!1}else{var f=performance.now();this.handleResponse(e,r),Object(A.X)({task_count:1,task_data:[{task_id:e,block_count:Object(A.K)(r),block_list:Object(A.W)(r)}],cost_time:performance.now()-f,isPreEditableEnable:!1})}this.idleApply()}},{key:"setFirstSliceReady",value:function(e){this.onFirstSliceReady=e}},{key:"setBeforeApply",value:function(e){this.beforeApplyCb=e}},{key:"setAfterApply",value:function(e){this.afterApplyCb=e}},{key:"setFirstSliceApplied",value:function(e){this.onFirstSliceApplied=e}},{key:"setDuplicated",value:function(e){this.duplicatedApplyCb=e}},{key:"handleResponse",value:function(e,n){return this.beforeApplyCb&&this.beforeApplyCb(e,n),n&&this.applyClientVar(e,n),this.afterApplyCb&&this.afterApplyCb({taskId:e,clientvar:n,taskClientvar:this.clientVarStorage.getClientvarByTaskId(e),isTaskFinish:this.clientVarApplyStatus.isTaskAllApplied(e)}),n}},{key:"setStartId",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._startId=e,this._needApplyStartIdSoon=!1,r&&!this._needApplyAll&&this.isPreEditableEnable()){var o=window.innerHeight,i=o/3,c=w(this.splitter.getTree(),{top:0,height:o,bufferTopRange:i,bufferBottomRange:i},this.layoutManager),a=c.viewporNodeIdSet,l=c.bufferNodeIdSet,s=a.size+l.size+1,u=this.splitter.split({size:s,traverseStartRecordId:e});if(u){var d=performance.now(),f=[];R(u,this.clientVarStorage,this.token).forEach((function(e){var r=e.taskId,o=e.clientvar;n.handleResponse(r,o),f.push({task_id:r,block_count:Object(A.K)(o),block_list:Object(A.W)(o)})})),Object(A.X)({task_count:f.length,task_data:f,cost_time:performance.now()-d,isPreEditableEnable:!0})}}}},{key:"startApplyAllMode",value:function(){var e=this;if(this.isPreEditableEnable()&&!this._needApplyAll&&(this._needApplyAll=!0,this.idleWorker.stop(),this._needApplyStartIdSoon=!1,this.clientVarStorage.hasType(N.J.NORMAL))){var n=this.splitter.split({size:1/0,traverseStartRecordId:this._token});if(n)R(n,this.clientVarStorage,this.token).forEach((function(n){return e.handleResponse(n.taskId,n.clientvar)}))}}},{key:"stopApplyAllMode",value:function(){this.isPreEditableEnable()&&this._needApplyAll&&(this._needApplyAll=!1,this._token&&this.idleApply())}},{key:"isPreEditableEnable",value:function(){var e=this.isInFileCopying;return N.w&&!e}},{key:"splitFirstSliceClientVars",value:function(e){if(!this.isPreEditableEnable())return e;var n=null;if(this._needApplyAll?n=this._token:this._startId&&!e.block_map[this._startId]&&(this._needApplyStartIdSoon=!0,n=this._startId),n)return this.splitter.split({size:1/0,traverseStartRecordId:n,isFirstSlice:!0});var r=window.innerHeight,o=r/3,i=w(this.splitter.getTree(),{top:0,height:r,bufferTopRange:o,bufferBottomRange:o},this.layoutManager),c=i.viewporNodeIdSet,a=i.bufferNodeIdSet,l=c.size+a.size+1;return this.splitter.split({size:l,traverseStartRecordId:this._startId,isFirstSlice:!0})}},{key:"handleFirstSlice",value:function(e){var n,r=e,o=this.splitFirstSliceClientVars(e),i=performance.now();if(o){var c=R(o,this.clientVarStorage,this.token);if(1!==c.length){var a=new Error("transformBlockMapToClientvars result length !== 1 at getFirstSliceClientVars");throw Object(y.n)(a),a}r=c[0].clientvar}this._needApplyStartIdSoon||this._needApplyAll||this.idleApply(),this.onFirstSliceReady?this.onFirstSliceReady(r,this):this.handleResponse(this._token,r),Object(A.X)({task_count:1,task_data:[{task_id:this.token,block_count:Object(A.K)(r),block_list:Object(A.W)(e)}],cost_time:performance.now()-i,isPreEditableEnable:this.isPreEditableEnable(),isFirstSlice:!0}),null===(n=this.onFirstSliceApplied)||void 0===n||n.call(this,r)}},{key:"idleApply",value:function(){this.isPreEditableEnable()&&this.idleWorker.start()}},{key:"idleGetNextClientvar",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:17,n=te.force_apply_block_count;return te.idle_force_apply||(n=Math.floor(e/.34+.5)),this.splitter.split({size:n,traverseStartRecordId:this._startId})}},{key:"initPendingRecordForBlockMap",value:function(e,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=[],c=new Set,a=function(e,a){var l;if(!r.model.hasRecordByRecordId(e)&&!c.has(e)){c.add(e);var s=(null===(l=n[e])||void 0===l?void 0:l.data)||Object.assign({type:m.B.PENDING,parent_id:a},o);i.push({id:e,snapshot:s})}};for(var l in n)this.structureQuery.pureTraverseSnapshot(l,void 0,(function(e){var r;return(null===(r=n[e])||void 0===r?void 0:r.data)||{}}),(function(e,n,r){return a(e,n),!0}));this.model.registerRecords(i)}},{key:"applyClientVar",value:function(e,n){var r=n.block_map,o=!1;try{this.model.hasRecordByRecordId(e)||this.model.registerRecords([{id:e,snapshot:{type:m.B.BLANK}}]);var i=this.model.getRecordByRecordId(e).snapshot.type;o=Object(j.z)(i)}catch(a){o=!1}this.initPendingRecordForBlockMap(e,r,{allowFail:o,baseRecordId:e});var c=this.api;c.getService(_.v).applyClientVar(n,(function(e){c.modelService.isInitialDataReady()?c.modelService.registerRecords(e):c.modelService.setInitialData(e)})),this.clientVarApplyStatus.applyClientvar(e,n)}},{key:"checkApplyStatus",value:function(){var e=this,n=this.clientVarApplyStatus.isAllTasksApplied(),r=Array.from(this.clientVarApplyStatus.waitForApplyMap.keys()).filter((function(n){return e.clientVarApplyStatus.waitForApplyMap.get(n).size})),o=r[0];if(!n&&o)if(Object(A.b)({cost_time:0,extra:"can not all done"}),this.splitter.getTree().visited){var c=Array.from(this.clientVarApplyStatus.waitForApplyMap.get(o).keys()),a=this.splitter.getTree().getNode(c[0]);if(!a)return void Object(A.b)({cost_time:0,extra:"can not find unFinishedNode in splitter tree"});try{R({block_map:i()({},a.id,a.data)},this.clientVarStorage,this._token).some((function(e){return e.taskId===o}))?Object(A.b)({cost_time:0,extra:"clientvar task mapping status error"}):Object(A.b)({cost_time:0,extra:"mapping blockId to taskId error"})}catch(u){Object(A.b)({cost_time:0,extra:"try to transform unFinish info but catch error, e: ".concat(u)})}}else{var l=r.find((function(n){return n!==e._token}));if(l){var s=this.clientVarStorage.has(l);Object(A.b)({cost_time:0,extra:"splitter tree did not visited, find unFinished skipBlock, is in storage: ".concat(s)})}else Object(A.b)({cost_time:0,extra:"splitter tree did not visited. SkipBlocks were done, may be algorithm bug"})}}},{key:"destroy",value:function(){this.handleClientvarApplyAllDone(),this.updateStartIdIfNeeded.cancel(),this.eventEmitter.off(M.R.CLIENTVAR_FETCH_ALL_DONE_NEW,this.handleFetchAllDone),this.eventEmitter.off(M.R.CLIENTVAR_APPLY_ALL_DONE,this.handleClientvarApplyAllDone),this.eventEmitter.off(x.w2,this.updateStartIdIfNeeded),this.idleWorker.destroy(),this.onFirstSliceReady=void 0,this.beforeApplyCb=void 0,this.afterApplyCb=void 0,this.onFirstSliceApplied=void 0,this.duplicatedApplyCb=void 0}},{key:"token",set:function(e){this._token=e,this.splitter.setRootRecordId(e)},get:function(){return this._token}}]),e}(),W=X,z=h()(W.prototype,"model",[p.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),G=h()(W.prototype,"structureQuery",[O.F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=h()(W.prototype,"api",[p.Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),q=h()(W.prototype,"layoutManager",[E.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=W))||V},dx_XCzS:function(e,n,r){"use strict";r.d(n,"q",(function(){return i})),r.d(n,"P",(function(){return c}));var o=r("dx_UtDZ");function i(){return Object(o.getMinaConfig)("ccm.docx.web.jira_entrance_advance_notice",!1)}function c(){return Object(o.getMinaConfig)("ccm.docx.web.jira_issue_block",!1)}},dx_XSmB:function(e,n,r){"use strict";r.d(n,"M",(function(){return f})),r.d(n,"z",(function(){return p}));var o=r("dx_h6a8"),i=r("dx_UHze"),c=r("dx_Rux1"),a=r("dx_QBqw"),l=r("dx_I11I"),s=r("dx_FHaN"),u=r("dx_ZG9w"),d=r("dx_UTG8");function f(e,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=e.recordMap,a=e.op,l=e.tempIdToRecordIdMap,s=e.beforeCreateNewRecord,u=e.afterCreateNewRecord,d=c[n],p=i.recursive,v=void 0===p||p,g=i.getIsOnlyRemovePosition,b=l.get(n);if(b)return b;if(null===g||void 0===g?void 0:g(n))return a.replace(n,["parent_id"],r),u(n,n),n;var y=a.create((function(c){var a,l,u=(null===(a=d.snapshot.children)||void 0===a||null===(l=a.slice)||void 0===l?void 0:l.call(a))||[],p=h(e,n,c,i);if(p.children&&(p.children=[]),(p=s(p)).parent_id=r,v&&!Object(o.isEmpty)(u)){var g=u.map((function(n){return f(e,n,c,i)}));p.children=g}return p}));return u(n,y),y}function h(e,n,r,o){var l,s=e.recordMap[n].snapshot;return l=Object(a.sH)(s)?function(e,n,r,o){for(var i=e.recordMap[n].snapshot,a=i.rows_id,l=i.columns_id,s=i.column_set,u=i.cell_set,d=Object(c.E)({column:l.length,row:a.length}),h=0;h<l.length;++h){var p=d.columns_id[h],v=l[h];d.column_set[p]=s[v];for(var g=0;g<a.length;++g){var b=d.rows_id[g],y=a[g],m=u["".concat(y).concat(v)];if(m){var _=m.block_id,k=m.merge_info;d.cell_set["".concat(b).concat(p)]={block_id:f(e,_,r,o),merge_info:k}}}}return d}(e,n,r,o):Object(u.M0)(s)?p(e,n,r,o):s,(null===o||void 0===o?void 0:o.shouldReplaceAuthor)&&(l.author=(null===o||void 0===o?void 0:o.userId)||Object(i.K)().userId),l}function p(e,n,r,o){var i=e.recordMap[n].snapshot;return Object(u.fq)(i.text,(function(n,i){return f(e,i,r,o)})),d.InputPipe.replaceMarkKV(i.text,s.O,(function(n,i){var c=JSON.parse(i),a=c.data;if(c.type!==s.k.FILE)return[n,i];if(!a.source_block_id)return[n,i];var u=a.source_block_id,d=f(e,u,r,o);return[l.B,d]})),i}},dx_XW5M:function(e,n,r){"use strict";var o,i;r.d(n,"t",(function(){return o})),r.d(n,"J",(function(){return i})),function(e){e.Add="add-panel",e.BlockMenu="block-panel",e.Slash="slash",e.TextualToolbar="textual-toolbar",e.TextualBlockToolbar="textual-block-toolbar",e.BlockToolbar="block-toolbar",e.TableCell="table-cell",e.PopoverMenu="table-popover"}(o||(o={})),function(e){e.Basic="basic",e.Common="common",e.Wiki="wiki",e.Drawing="drawing",e.SaveBlockTemplate="saveBlockTemplate",e.Data="data",e.Bitable="bitable",e.Cooperation="cooperation",e.Application="application",e.Embed="embed",e.Advanced="advanced",e.Video="video",e.Design="design",e.Code="code",e.Form="form",e.TeamCooperation="teamCooperation",e.ProjectManage="projectManage",e.Map="map",e.Vote="vote",e.Collection="collection",e.ThirdPartyContent="thirdPartyContent",e.BlockStyle="blockStyle",e.BlockOperation="blockOperation",e.BlockShare="blockShare",e.BlockAbility="blockAbility",e.AppendBlock="appendBlock",e.NoResult="noResult",e.TextTurninto="textTurninto",e.TextAlign="textAlign",e.Align="align",e.TextStyle="textStyle",e.Comment="comment",e.BlockToolbar="blockToolbar",e.TextContainer="textContainer",e.MergeCell="mergeCell",e.PopoverMenu="popoverMenu",e.ISVBlock="isvBlock",e.ISVBlockDebug="isvBlockDebug",e.ExtendCommand="extendCommand",e.Edit="edit"}(i||(i={}))},dx_XbJI:function(e,n,r){"use strict";r.d(n,"C",(function(){return d})),r.d(n,"h",(function(){return f})),r.d(n,"P",(function(){return h})),r.d(n,"CN",(function(){return p}));var o=r("dx_k9kc"),i=r("dx_MUMK"),c=r("dx_OJCf"),a=r("dx_hDVN"),l=r("dx_B28d"),s=r("dx_acOG"),u=r("dx_j6ji");var d=function(e,n){return n===l.B.ORDERED&&l.O.includes(e.props.record.snapshot.type)&&!!e.props.record.snapshot.seq||e.type===n};function f(e,n){return function(r){var o=e.every((function(e){return e.type===r}));return n?o||e.every((function(e){return n(e,r)})):o}}function h(e,n){return function(r){return e.every((function(e){if(!n.hasBlockModelByBlockId(e.id))return!1;for(var o=n.getBlockModelByBlockId(e.id);o.parent;){if(o.type===r)return!0;o=o.parent}return!1}))}}var p=function(e,n){var r=n.type,d=n.handler,p=n.isAppend,v=n.supportToggle,g=n.blockManager,b=n.addType,y=void 0===b?l.B.TEXT:b,m=n.assignedSelection,_=n.collect,k=void 0!==_&&_,O=n.source,x=n.selectionAPI,E=n.category,S=f(e),C=v&&S(r),I=h(e,g),B=r===l.B.QUOTE_CONTAINER&&I(r);if(k){var T=e.every((function(e){return l.O.includes(e.type)&&e.record.snapshot.seq}))&&r===l.B.ORDERED;O&&Object(o.Fi)({actionType:r,blocks:e,blockManager:g,source:O,selectionAPI:x,click:o.c.block_action,actionValue:{value1:C||T||B?"false":"true"},category:E})}if(p)Object(a.S)({blockManager:g,blocks:e,newBlockType:y});else{var w,R=g.editorAPI.getService(s.N,{optional:!0});if(!R||e.every((function(e){return w=e.record,R.canBlockEdit(e.record,e.type,{type:"UPDATE_ATTRIBUTE",changedKey:"type",newValue:r})})))if(C){if(r===l.B.CALLOUT)return void Object(c.G)(g,i.F.onTurnIntoCallout,{assignedSelection:m,triggerSource:r});Object(c.G)(g,i.F.onTurnIntoText,{assignedSelection:m,triggerSource:r})}else Object(c.G)(g,d,{assignedSelection:m,triggerSource:r});else Object(u.A)({op_source:O||"turninto",op_type:"turninto",edit_type:"UPDATE_ATTRIBUTE",interceptedRecord:w})}}},dx_Xdvu:function(e,n,r){"use strict";r.d(n,"a",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("compatible-editor-context")},dx_XfTi:function(e,n,r){"use strict";r.d(n,"L",(function(){return o})),r.d(n,"S",(function(){return i})),r.d(n,"H",(function(){return c})),r.d(n,"d",(function(){return a})),r.d(n,"G",(function(){return l})),r.d(n,"B",(function(){return s})),r.d(n,"q",(function(){return u})),r.d(n,"J",(function(){return d}));var o="KR_PROGRESS_RATE_CHANGE",i="KR_PROGRESS_RATE_TRANSACTION",c="KR_SCORE_CHANGE",a="KR_SCORE_TRANSACTION",l="0",s="OKR_BLOCK_SYNC_NOT_REMIND",u="FEAT_VISIBLE_CHANGE",d="LAST_VISIBLE_KR_CHANGE"},dx_XiKs:function(e,n,r){"use strict";r.d(n,"F",(function(){return o})),r.d(n,"Q",(function(){return i}));var o="onPasteRecordAfterApply",i="onPasteRecordAfterAccepted"},dx_Xihh:function(e,n,r){"use strict";(function(t){r.d(n,"R",(function(){return B}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_W7W2"),f=r.n(d),h=r("dx_a1gu"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=(r("dx_eup5"),r("dx_FBWK")),y=r("dx_UtDZ"),m=r("dx_cDcd"),_=r.n(m),k=r("dx_B28d"),O=r("dx_MGoZ"),x=r("dx_sNGG"),E=r("dx_jrCs"),S=r("dx_OcvB"),C=r("dx_VHoe");function I(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}var B=function(e){f()(r,e);var n=I(r);function r(){var e;l()(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=n.call.apply(n,[this].concat(a))).state={isSelected:!1},e.blockStatus=C.Q.UNKOWN,e.catalogListData=[],e.catalogListDataUuid="",e.onSelectWiki=function(){var n=c()(o.a.mark((function n(r){var i,c;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=r.spaceId,c=r.wikiToken,n.next=3,e.props.model.applyTransaction("wikiCatalogWikiSelected",(function(n){n.replace(e.model.record.id,["space_id"],i),n.replace(e.model.record.id,["wiki_token"],c)}));case 3:e.showSuccessToast(t("CreationDoc_Wiki_SubpageTOC_Set_Toast")),Object(y.collectEvent)("ccm_doc_wiki_block_space_click",{view_title:"wiki_catalog",click:"confirm",target:"none",target_wiki_token:Object(y.encryptTea)(r.wikiToken)});case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.onDataUpdate=function(n){e.catalogListData=n,e.catalogListDataUuid=Object(b.UUIDv4)(),e.blockManager.layoutManager.notifyNodeHeightChange(e.id),e.blockManager.dispatch(x.Y.THIRD_PARTY_CONTENT_CHANGE),e.props.recursionProps.isPresentationMode&&window.dispatchEvent(new Event("resize"))},e.openWikiPicker=function(){var n=Object(y.getWikiCatalogFunctions)(),r=e.props.model.snapshot,o=r.space_id,i=r.wiki_token;n.openWikiPicker(!1,e.onSelectWiki,o,i),Object(y.collectEvent)("ccm_doc_wiki_block_space_view",{view_title:"wiki_catalog"})},e.setBlockStatus=function(n){e.blockStatus=n},e}return u()(r,[{key:"blockViewDidMount",value:function(){var e,n;null===(e=(n=this.props).onBlockReady)||void 0===e||e.call(n);var r=this.props.model.snapshot,o=r.space_id,i=void 0===o?"":o,c=r.wiki_token,a=void 0===c?"":c;!this.model.isFromLocal||i.length&&a.length||this.openWikiPicker()}},{key:"setSelected",value:function(e){this.setState({isSelected:e})}},{key:"showSuccessToast",value:function(e){y.Toast.show({key:"wiki-catalog-success",type:"success",content:e})}},{key:"render",value:function(){if(this.shouldShowPreviewPlaceholder)return _.a.createElement(E.S,{type:k.B.WIKI_CATALOG,locale:Object(b.getLocale)()});var e=this.props.model.snapshot.wiki_token,n=void 0===e?"":e,r=this.state.isSelected;return _.a.createElement(S.g,{editable:this.editable,wikiToken:n,blockId:this.props.record.id,isSelected:r,onDataUpdate:this.onDataUpdate,onClickNoContentBtn:this.openWikiPicker,onStatusChange:this.setBlockStatus})}},{key:"editable",get:function(){return!1!==this.props.recursionProps.editable}},{key:"shouldShowPreviewPlaceholder",get:function(){return Object(b.isShortCut)()||this.props.recursionProps.isPreview||this.props.recursionProps.isSSR}}]),r}(O.l)}).call(this,r("dx_E9Eu"))},dx_Xkil:function(e,n,r){"use strict";(function(t){var e=r("dx_lSNA"),o=r.n(e),i=r("dx_J4zp"),c=r.n(i),a=r("dx_xe5J"),l=r("dx_c85c"),s=r("dx_PcQO"),u=r("dx_TSYQ"),d=r.n(u),f=r("dx_UtDZ"),h=r("dx_h6a8"),p=r("dx_cDcd"),v=r.n(p),g=r("dx_pLTH"),b=r("dx_VtrK"),y=r("dx_cXYu"),m=(r("dx_szkV"),"okrx-block-sync-progress"),_="no-sync-content-fail";n.S=function(e){var n=e.disabled,r=e.enableScore,i=e.isSyncing,u=e.syncTime,k=e.getNoPromptedState,O=e.getProgressEmptyState,x=e.onSyncProgress,E=void 0===x?h.noop:x,S=e.onSyncProgressCanceled,C=void 0===S?h.noop:S,I=e.onSyncPopVisibleChange,B=void 0===I?h.noop:I,T=e.onTiggerClick,w=void 0===T?h.noop:T,R=Object(p.useRef)(!1),M=Object(p.useState)(!1),j=c()(M,2),D=j[0],A=j[1],P=Object(p.useState)(Object(g.e)(u)),L=c()(P,2),N=L[0],F=L[1],U=N?t("CreationDoc_Docs_OKR_Sync_Time",{time:N}):t("CreationDoc_Docs_OKR_Sync_Progress"),H=function(){A(!1),B(!1),C()},V=function(){A(!1),B(!1),E(R.current)};return Object(p.useEffect)((function(){F(Object(g.e)(u));var e=b.c.getInstance().subscribe(u,F);return function(){e()}}),[u]),v.a.createElement(s.Tooltip,{title:t(n?"CreationDoc_Docs_OKR_Sync_NoProgress":r?"CreationDoc_Docs_OKR_Sync_ConfirmContent3":"CreationDoc_Docs_OKR_Sync_ConfirmContent4"),placement:"top",hideAction:["click","blur"],disabled:D},v.a.createElement(s.Popover,{trigger:"click",content:function(){var e=t(r?"CreationDoc_Docs_OKR_Sync_ConfirmContent1":"CreationDoc_Docs_OKR_Sync_ConfirmContent2");return v.a.createElement("div",{className:"".concat(m,"__confirm-content")},v.a.createElement("div",{className:"".concat(m,"__confirm-body")},v.a.createElement("div",{className:"".concat(m,"__confirm-icon")},v.a.createElement(a.S,null)),v.a.createElement("div",null,v.a.createElement("div",{className:"".concat(m,"__confirm-title")},t("CreationDoc_Docs_OKR_Sync_Confirm")),v.a.createElement("div",{className:"".concat(m,"__confirm-desc")},e))),v.a.createElement("div",{className:"".concat(m,"__confirm-footer")},v.a.createElement("div",{className:"".concat(m,"__confirm-extra")},v.a.createElement(s.Checkbox,{onChange:function(e){R.current=e.target.checked}},v.a.createElement("span",{className:"".concat(m,"__confirm-extra-text")},t("CreationDoc_Common_Desc_NotAgain")))),v.a.createElement("div",{className:"".concat(m,"__confirm-btns")},v.a.createElement(s.Button,{size:"small",type:"default",style:{marginRight:12},onClick:H},t("common.cancel")),v.a.createElement(s.Button,{size:"small",type:"primary",onClick:V},t("common.confirm")))))}(),overlayStyle:{maxWidth:380},overlayClassName:"".concat(m,"__confirm"),getPopupContainer:h.identity,visible:D,onVisibleChange:function(e){n||k()||O()||(A(e),B(e))}},v.a.createElement(y.C,{icon:v.a.createElement(l.S,{className:d()(o()({},"".concat(m,"__loading"),i))}),text:U,isActive:D,disabled:n,onClick:function(){var e=!0;n&&(e=!1),!n&&O()&&(f.Toast.destroy(_),f.Toast.error({key:_,type:"error",content:t("CreationDoc_Docs_OKR_Sync_NoContent")}),e=!1),k()||(e=!1),e&&E(),w()}})))}}).call(this,r("dx_E9Eu"))},dx_XlRC:function(e,n,r){"use strict";r.d(n,"q",(function(){return l})),r.d(n,"D",(function(){return s})),r.d(n,"i",(function(){return u})),r.d(n,"J",(function(){return d})),r.d(n,"C",(function(){return f})),r.d(n,"a",(function(){return h})),r.d(n,"o",(function(){return p})),r.d(n,"x",(function(){return v})),r.d(n,"c",(function(){return g})),r.d(n,"Y",(function(){return b})),r.d(n,"A",(function(){return y})),r.d(n,"e",(function(){return m})),r.d(n,"e6",(function(){return _}));var o=r("dx_B28d"),i=r("dx_vOIB"),c=r("dx_Bs5u"),a=r("dx_r61a");function l(e){return!e.record.snapshot.seq}function s(e){return e.type===o.B.ORDERED}function u(e){return s(e)&&!!e.record.snapshot.seq&&"auto"!==e.record.snapshot.seq}function d(e){return!!(null===e||void 0===e?void 0:e.record.snapshot[c.A.del])}function f(e){return/^\d+$/.test(e)}function h(e){return"auto"===e||Number.isInteger(Number(e))}function p(e){return e&&e.model.snapshot.seq}function v(e,n){if(!n)return null;var r=e.getBlockModelByBlockId(n),o=e.orderMap.get(r.record.id);return o?{blockId:n,recordId:r.record.id,order:o,level:Object(i.q)(r),isHeader:u(r)}:null}function g(e,n,r,o){var c,d=e.getBlockModelByBlockId(n),f=(null===(c=d.parent)||void 0===c?void 0:c.children)||[],h=d.position,p=[];for(h+=o?0:a.i[r];h>=0&&h<f.length;h+=a.i[r]){var v=f[h];if(s(v)){if(l(v))break;if(u(v))break;var g={blockId:v.id,recordId:v.record.id,order:e.orderMap.get(v.record.id),level:Object(i.q)(v),isHeader:u(v)};h>d.position?p.push(g):p.unshift(g)}}return p}function b(e,n,r,o){var c,d=e.getBlockModelByBlockId(n),f=(null===(c=d.parent)||void 0===c?void 0:c.children)||[],h=d.position,p=[];for(h+=o?0:a.i[r];h>=0&&h<f.length;h+=a.i[r]){var v=f[h];if(!s(v))break;if(!l(v))break;var g={blockId:v.id,recordId:v.record.id,order:e.orderMap.get(v.record.id),level:Object(i.q)(v),isHeader:u(v)};h>d.position?p.push(g):p.unshift(g)}return p}function y(e,n,r){var o;if(!n)return null;var c=e.getBlockModelByBlockId(n),l=(null===(o=c.parent)||void 0===o?void 0:o.children)||[],d=c.position;for(d+=a.i[r];d>=0&&d<l.length;d+=a.i[r])if(s(l[d])){var f=l[d];return{blockId:f.id,recordId:f.record.id,order:e.orderMap.get(f.record.id),level:Object(i.q)(f),isHeader:u(f)}}return null}function m(e,n,r,o){for(var c=e.getBlockModelByBlockId(n).children,l=r;l>=0&&l<c.length;l+=a.i[o])if(s(c[l])){var d=c[l];return{blockId:d.id,recordId:d.record.id,order:e.orderMap.get(d.record.id),level:Object(i.q)(d),isHeader:u(d)}}return null}function _(e,n,r,o){if(!o)return null;var i=y(e,n,r);return(null===i||void 0===i?void 0:i.order)===o+a.i[r]?i:null}},dx_Xppr:function(e,n,r){"use strict";var o=function(){return null};n.S=o},dx_Y1YR:function(e,n,r){"use strict";r.d(n,"e",(function(){return o})),r.d(n,"J",(function(){return $}));r("dx_Rbek");var o,i=r("dx_MM9K"),c=r.n(i),a=r("dx_o0o1"),l=r.n(a),s=r("dx_yXPU"),u=r.n(s),d=r("dx_lwsE"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_W7W2"),g=r.n(v),b=r("dx_a1gu"),y=r.n(b),m=r("dx_Nsbk"),_=r.n(m),k=r("dx_h6a8"),O=r("dx_cDcd"),x=r.n(O),E=r("dx_o9oe"),S=r("dx_D8nn"),C=r("dx_RRb7"),I=r("dx_BaZy"),B=r.n(I),T=B()({loader:function(){return Promise.all([r.e("dx_vNU"),r.e("dx_UTc"),r.e("dx_v7vu"),r.e("dx_j1jX"),r.e("dx_HUt")]).then(r.bind(null,"dx_izWU"))},loading:function(){return null},render:function(e,n){var r=e.MentionSharePopover;return x.a.createElement(r,n)}}),w=B()({loader:function(){return Promise.all([r.e("dx_vNU"),r.e("dx_UTc"),r.e("dx_v7vu"),r.e("dx_j1jX"),r.e("dx_HUt")]).then(r.bind(null,"dx_Z2ji"))},loading:C.b,render:function(e,n){var r=e.MentionSharePopoverCom;return x.a.createElement(r,n)}}),R=function(e){var n=e.token,r=e.mentionType,o=e.link,i=e.title,c=e.onClickShare,a=e.onClickApply,l=e.onClose;Object(O.useEffect)((function(){S.S.emit(S.p.COMMON.CLOSE_MENTION_SHARE_PANEL)}),[]);return x.a.createElement(x.a.Fragment,null,Object(E.d)()?x.a.createElement(w,{token:n,type:r,title:i,link:o,embedObjShareEnable:!0,closePopover:l}):x.a.createElement(T,{token:n,mentionType:r,link:o,title:i,onClickShare:c,onClickApply:a}))};r("dx_X0eS");function M(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=_()(e);if(n){var i=_()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return y()(this,r)}}!function(e){e.PAGE="page",e.USER="user"}(o||(o={}));var j=function(e){g()(r,e);var n=M(r);function r(){var e;f()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).ref=x.a.createRef(),e.state={view:null},e.handleMouseDown=function(e){e.stopPropagation(),e.preventDefault()},e}return p()(r,[{key:"componentDidMount",value:function(){this.loadView()}},{key:"componentDidUpdate",value:function(e){var n=this.props;Object(k.isEqual)(e,n)||this.loadView()}},{key:"loadView",value:function(){var e=u()(l.a.mark((function e(){var n,r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.ref.current,r=(null===n||void 0===n?void 0:n.offsetWidth)||320,320,e.next=5,this.getView(r,320);case 5:o=e.sent,this.setState({view:o});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getView",value:function(){var e=u()(l.a.mark((function e(n,r){var i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=this.props.width||n,c={width:i},e.t0=this.props.type,e.next=e.t0===o.PAGE?5:e.t0===o.USER?6:7;break;case 5:return e.abrupt("return",x.a.createElement("div",{className:"preview-board page",style:{minWidth:c.width},key:this.props.token},x.a.createElement(R,{token:this.props.token,mentionType:this.props.mentionType,title:this.props.title,link:this.props.link,onClickShare:this.props.onClose,onClickApply:this.props.onClose,onClose:this.props.onClose})));case 6:case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"render",value:function(){return x.a.createElement("div",{className:"preview-board-box",onMouseDown:this.handleMouseDown,ref:this.ref},this.state.view?this.state.view:x.a.createElement(c.a,{spinning:!0},x.a.createElement("div",{style:{height:320}})))}}]),r}(x.a.Component),D=r("dx_lSNA"),A=r.n(D),P=r("dx_L6Lu"),L=r("dx_TSYQ"),N=r.n(L),F=r("dx_UtDZ"),U=r("dx_faye"),H=r.n(U),V=r("dx_bdgK"),W=r("dx_Tumq"),z=r("dx_EnrF");function G(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=_()(e);if(n){var i=_()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return y()(this,r)}}var K="preview-board-wrapper",q=function(e){g()(r,e);var n=G(r);function r(e){var o;f()(this,r),(o=n.call(this,e)).resizeObserver=void 0,o.viewportRect=void 0,o.handleResize=function(e){var n=e[0];if(n){var r=n.contentRect.width,i=o.state.boxWidth;r&&r>0&&i!==r&&o.setState({boxWidth:r,visible:!0})}},o.setViewportRect();var i=e.currentRect||e.target.getBoundingClientRect(),c=o.calcShowAtTop(i);return o.state={targetRect:i,showAtTop:c,boxWidth:348,visible:!1},o}return p()(r,[{key:"componentDidMount",value:function(){this.observerWrapper()}},{key:"componentWillUnmount",value:function(){this.resizeObserver&&this.resizeObserver.disconnect()}},{key:"update",value:function(){this.setViewportRect();var e=this.props.target.getBoundingClientRect(),n=this.calcShowAtTop(e);this.setState({targetRect:e,showAtTop:n})}},{key:"observerWrapper",value:function(){var e=document.querySelector(".".concat(K));e&&(this.resizeObserver=new V.S(this.handleResize),this.resizeObserver.observe(e))}},{key:"setViewportRect",value:function(){var e=this.props.scroller,n=null===e||void 0===e?void 0:e.getBoundingClientRect(),r=window.innerHeight,o=n?Math.max(n.left,0):0,i=n?Math.min(n.right,window.innerWidth):window.innerWidth,c=i-o;this.viewportRect={width:c,height:r,left:o,top:0,right:i}}},{key:"calcShowAtTop",value:function(e){var n=this.viewportRect;return e.top-n.top-this.getScrollerRect().top>=464}},{key:"getScrollerRect",value:function(){var e;return(null===(e=this.props.scroller)||void 0===e?void 0:e.getBoundingClientRect())||{top:0,left:0}}},{key:"calcStyle",value:function(){var e,n=this.state,r=n.targetRect,o=n.showAtTop,i=n.boxWidth,c=this.viewportRect,a=(null===(e=this.props.scroller)||void 0===e?void 0:e.scrollTop)||0,l=this.getScrollerRect(),s=l.top,u=l.left,d={left:r.left-u,top:a+r.top-s,position:"absolute"},f=r.width/2-i/2;return r.right-f>c.right&&(f=c.right-i-r.left-3),r.left+f<c.left&&(f=c.left-r.left+3),{container:d,target:o?{bottom:12,left:f}:{top:r.height+12,left:f},showAtTop:o}}},{key:"render",value:function(){console;var e=this.calcStyle(),n=Object(z.P)(),r=N()(K,this.props.type,{"is-history":n,visible:this.state.visible});return x.a.createElement("div",{style:e.container,onClick:this.props.onClick},x.a.createElement("div",{className:r,style:e.target,onMouseLeave:this.props.onMouseLeave,onMouseOver:this.props.onMouseOver,onMouseEnter:this.props.onMouseEnter},x.a.createElement("div",{className:"preview-board-wrapper-content"},x.a.createElement(j,this.props))))}}]),r}(x.a.Component),X=function(){function e(){f()(this,e)}return p()(e,null,[{key:"register",value:function(e){this.set.add(e)}},{key:"unregister",value:function(e){this.set.delete(e)}},{key:"active",value:function(e){this.set.forEach((function(n){n!==e&&n.handleMouseLeave(!0)}))}}]),e}();X.set=new Set;var Y=function(){function e(){var n=this;f()(this,e),this.context=null,this.showTimer=null,this.hideTimer=null,this.handleFocus=function(){n.handleMouseLeave(!1)},this.handleClick=function(e){e.target.closest(".preview-board-wrapper")||n.handleMouseLeave()},X.register(this)}return p()(e,[{key:"clearTimers",value:function(){this.showTimer&&(window.clearTimeout(this.showTimer),this.showTimer=null),this.hideTimer&&(window.clearTimeout(this.hideTimer),this.hideTimer=null)}},{key:"clearContext",value:function(){this.context&&(H.a.unmountComponentAtNode(this.context.container),this.context.container.remove(),this.context=null,Object(F.collectEvent)(W.j.PREVIEW_POPOVER_CONTEXT,{action:W.p.WRAPPER_CLEAR}))}},{key:"handleMouseEnter",value:function(e){var n=this;this.clearTimers(),window.addEventListener("focus",this.handleFocus),document.addEventListener("click",this.handleClick),this.context&&this.context.props.target!==e.target&&this.clearContext(),this.context&&this.context.show||(this.showTimer=window.setTimeout((function(){n.showTimer=null,n.show(Object.assign(e,{onMouseOver:function(){return n.handleMouseEnter(e)},onMouseLeave:function(){return n.handleMouseLeave()},onClose:function(){return n.hideImmediately()}}))}),500))}},{key:"handleMouseLeave",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.clearTimers(),this.context&&(n?this.hide():this.hideTimer=window.setTimeout((function(){e.hideTimer=null,e.hide()}),500)),window.removeEventListener("focus",this.handleFocus),document.removeEventListener("click",this.handleClick),Object(F.collectEvent)(W.j.PREVIEW_POPOVER_CONTEXT,{action:W.p.WRAPPER_LEAVE,immediately:n,context:!!this.context})}},{key:"hideImmediately",value:function(){this.handleMouseLeave(!0)}},{key:"hide",value:function(){var e,n;this.context&&(this.context.container.style.display="none",this.context.show=!1),(null===(e=this.context)||void 0===e?void 0:e.props.once)&&this.clearContext(),Object(F.collectEvent)(W.j.PREVIEW_POPOVER_CONTEXT,{action:W.p.WRAPPER_HIDE,context:!!this.context,once:null===(n=this.context)||void 0===n?void 0:n.props.once})}},{key:"show",value:function(e){if(X.active(this),this.context)this.context.container.style.display="block",this.context.ref.current&&this.context.ref.current.update(),this.context.show=!0;else{var n=document.createElement("div");n.setAttribute("class","docx-preview-container");var r="docx-popup-container";e.isHistory?r="history-docx-popup-container":e.isPresentationMode&&(r="presentation-mode-docx-popup-container");var o=document.getElementById(r);null===o||void 0===o||o.appendChild(n);var i=x.a.createRef();H.a.render(x.a.createElement(q,Object.assign({},e,{ref:i})),n),this.context={container:n,ref:i,show:!0,props:e}}Object(F.collectEvent)(W.j.PREVIEW_POPOVER_CONTEXT,{action:W.p.WRAPPER_SHOW,embedToken:Object(F.encryptTea)(e.token),context:!!this.context})}},{key:"destroy",value:function(){this.clearTimers(),this.clearContext(),X.unregister(this)}}]),e}();function J(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Z(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?J(Object(r),!0).forEach((function(n){A()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Q(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=_()(e);if(n){var i=_()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return y()(this,r)}}var $=function(e){g()(r,e);var n=Q(r);function r(){var e;f()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).ref=x.a.createRef(),e.controller=new Y,e.handleMouseEnter=function(n){var r=n.clientX,o=n.clientY;e.showPreviewCard(r,o)},e.showPreviewCard=function(n,r){var o=e.ref.current;if(o){for(var i,c=Object(P.O)(o),a=0;a<c.length;a++){var l=c[a];l.top-5<=r&&l.bottom+5>=r&&l.left-5<=n&&l.right+5>=n&&(i=l)}e.controller.handleMouseEnter(Z({target:{getBoundingClientRect:function(){return Object(P.V)(o)}},currentRect:i,afterClick:e.onClick},e.props))}},e.handleMouseLeave=function(){e.controller.handleMouseLeave()},e.onClick=function(){e.controller.handleMouseLeave(!0)},e}return p()(r,[{key:"componentDidMount",value:function(){var e=this.props.mouseEvent;if(e&&Object(E.F)()){var n=e.isEnter,r=e.clientX,o=e.clientY;n&&r&&o&&this.showPreviewCard(r,o)}}},{key:"componentWillUnmount",value:function(){this.controller.destroy()}},{key:"render",value:function(){var e=this;return 1!==x.a.Children.count(this.props.children)?this.props.children:x.a.Children.map(this.props.children,(function(n){return x.a.cloneElement(n,{onMouseEnter:e.handleMouseEnter,onMouseLeave:e.handleMouseLeave,onClick:e.onClick,ref:e.ref})}))}}]),r}(x.a.Component)},dx_Y1Yv:function(e,n,r){},dx_Y27Y:function(e,n,r){"use strict";r.d(n,"L",(function(){return a})),r.d(n,"E",(function(){return l}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_B28d"),a={FILES:"Files",HTML:"text/html",TEXT:"text/plain",URI_LIST:"text/uri-list",DOCX_RECORD:"docx/record",DOCX_TEXT:"docx/text"},l=i()({},c.B.PAGE,["cover"])},dx_Y299:function(e,n,r){"use strict";r.d(n,"D",(function(){return a})),r.d(n,"E",(function(){return l}));var o=r("dx_UtDZ"),i=r("dx_AAGW"),c="/space";function a(e){var n={obj_token:Object(o.getToken)(),obj_type:Object(o.suiteTypeNum)(),url:e};return i.S.get("/api/urlextract/check/",{params:n,baseURL:c}).then((function(e){return Boolean(e.data&&e.data.can_extract)})).catch((function(e){return console.error("[bookmark-block] fetchCheckUrlExtract error: ".concat(e.message)),!1}))}function l(e,n){var r={obj_token:Object(o.getToken)(),obj_type:Object(o.suiteTypeNum)(),url:e,scene:n};return i.S.get("/api/urlextract/extract/",{params:r,baseURL:c,timeout:2e4}).then((function(e){return e.data})).catch((function(e){return console.error("[bookmark-block] fetchUrlExtractInfoByScene error: ".concat(e.message)),null}))}},dx_Y2Dh:function(e,n,r){"use strict";r.d(n,"N",(function(){return u}));var o,i=r("dx_lSNA"),c=r.n(i),a=r("dx_B28d"),l=r("dx_USRY"),s=(o={},c()(o,l.t.Card,"card"),c()(o,l.t.Preview,"preview"),c()(o,l.t.Inline,l.t.Inline),o);function u(e,n){var r=e.snapshot,o=r.type,i=r.parent_id;if(o!==a.B.FILE||!i)return"";var c=n.recordManager.getRecord(i);return c.snapshot.type===a.B.VIEW?s[c.snapshot.view_type]:s[l.t.Inline]}},dx_Y6Yc:function(e,n,r){"use strict";(function(t){r.d(n,"j",(function(){return w}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_gEUD"),c=r("dx_PcQO"),a=r("dx_UtDZ"),l=r("dx_cDcd"),s=r.n(l),u=r("dx_h74D"),d=r("dx_a7X6"),f=r("dx_RUmv"),h=r("dx_a4ad"),p=r("dx_D8nn"),v=r("dx_AaSx"),g=r("dx_PIlC"),b=r("dx_Tpqa"),y=r("dx_JyNn"),m=r("dx_LTna"),_=r("dx_K7RJ"),k=r("dx_l7lm"),O=r("dx_N03N"),x=r("dx_hS6z"),E=r("dx_YVX0"),S=r("dx_i7i0"),C=r("dx_RvQP"),I=r("dx_QXBh"),B=r("dx_GgMS"),T=(r("dx_sy4h"),function(e){var n=e.objectID,r=e.zoneId,T=e.mountNode,w=e.containerEditor,R=e.isEditMode,M=e.displayMode,j=e.equation,D=e.getEquationRange,A=e.onEquationChange,P=e.onIsEditModeChange,L=e.onIsSelectedChange,N=Object(l.useRef)(null),F=Object(l.useMemo)((function(){return w.pluginManager.getPlugin("Equation")}),[w]),U=Object(B.P)(r,{blockManager:F.blockManager}),H=Object(l.useState)(null),V=o()(H,2),W=V[0],z=V[1],G=Object(m.e)({equationViewInstance:N}).addSpanClass,K=Object(O.n)(n),q=Object(C.W)({block:U,selectionAPI:F.selectionAPI,equationViewInstance:N,equationEditorOverlayClassName:v.w,isEditMode:R,editorEditable:w.isEditable(),containerEditor:w,onIsEditModeChange:P,onIsSelectedChange:L,getEquationRange:D}).handleEquationEditorVisibleChange;Object(I.P)({blockId:(null===U||void 0===U?void 0:U.id)||null,selectionAPI:F.selectionAPI,onIsSelectedChange:L,getEquationRange:D});var X=Object(k.q)({commentable:F.commentable}),Y=X.commentVisible,J=X.checkCommentToolbarShow,Z=Object(_.C)({block:U,equationViewInstance:N,getEquationRange:D}).autoExpandTableCell,Q=Object(S.W)({block:U,containerEditor:w,getEquationRange:D,onIsEditModeChange:P}).onExit;Object(E.r)({equationViewInstance:N,containerEditor:w,block:U}),Object(x.R)({containerEditor:w,isEditMode:R,onIsEditModeChange:P});var $=Object(l.useCallback)((function(){G(),Z()}),[G,Z]),ee=Object(l.useCallback)((function(){q(!0),Object(g.G)()}),[q]),te=Object(l.useCallback)((function(){null===P||void 0===P||P(!1)}),[P]);Object(l.useEffect)((function(){if(R)return F.selectionAPI.removeAllSelection(),setTimeout((function(){null===W||void 0===W||W.selection.selectAll(),null===W||void 0===W||W.selection.focus()}),100),p.S.on(p.p.COMMON.BLOCK_MENU_PANEL_SHOW,te),function(){p.S.off(p.p.COMMON.BLOCK_MENU_PANEL_SHOW,te)}}),[F,R,te,W]);var ne=Object(l.useCallback)((function(){var e=D();e&&(null===U||void 0===U||U.model.setSelection(e,!0),null===U||void 0===U||U.focus())}),[D,w,U]);Object(l.useEffect)((function(){setTimeout((function(){var e=D();if(e&&U){var n=U.model.getAttributes(e.start,e.end).toMap().objectID;if(d.h.toolboxInsertEquationSet.has(n)){var r=function(){ne(),q(!0),d.h.toolboxInsertEquationSet.delete(n)};N.current?r():function e(){N.current?r():setTimeout(e,500)}()}}}))}),[U,D,q,N]);var re=!!Object(u.useSelector)(a.selectors.share.selectCanEditInvolvingEditMode),oe=Object(l.useMemo)((function(){return F.blockManager.editorAPI.config.get("isPreview")}),[F]);return s.a.createElement(b.u,{block:U,selectionAPI:F.selectionAPI,commentModule:F.commentModule,getEquationRange:D,getPopupContainer:function(){return T},visible:!oe&&Y},s.a.createElement(c.Popover,{visible:R,placement:"bottomLeft",showArrow:!1,overlayStyle:{width:400},overlayClassName:v.w,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(y.T,{equation:j,onEquationChange:function(e){A(e),U&&F.updateCurrentBlockEquationCounter(U.model)},onExit:Q,onInit:function(e){z(e)}}),s.a.createElement("div",{className:"equation-editor-tips-wrapper"},s.a.createElement("div",{className:"equation-esc-tips"},t("CreationDoc_Docs_LaTex_PressESC_Desc")),s.a.createElement("div",{className:"equation-editor-help",onClick:g.e},s.a.createElement(i.S,null),s.a.createElement("span",null,t("CreationDoc_Docs_Equation.help.button"))))),getPopupContainer:function(){return T}},s.a.createElement(f.K,{instanceRef:N,value:j,viewDisplay:M,onClick:ee,placeholder:Object(f.k)(re),errorPlaceholder:Object(f.w)(),counterIndex:K,onMouseEnter:J,onDidRender:$,getKatex:h.X})))}),w=function(e){return s.a.createElement(T,e)}}).call(this,r("dx_E9Eu"))},dx_Y8YI:function(e,n,r){},dx_YCIe:function(e,n,r){"use strict";r.d(n,"f",(function(){return l})),r.d(n,"p",(function(){return s})),r.d(n,"X",(function(){return u})),r.d(n,"w",(function(){return d})),r.d(n,"B",(function(){return f})),r.d(n,"IK",(function(){return h})),r.d(n,"I",(function(){return p}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_B28d"),a=r("dx_O1Ou"),l=100,s=100,u=100,d=.02,f=i()({},a.X.SCROLL,{offsetRatioMap:{}}),h=[c.u.BITABLE,c.u.SHEET,c.u.TABLE],p=[c.u.BITABLE]},dx_YIK2:function(e,n,r){"use strict";var o=r("dx_tSNM");r.d(n,"c",(function(){return o.c}))},dx_YR5F:function(e,n,r){"use strict";r.d(n,"m",(function(){return o})),r.d(n,"r",(function(){return i}));var o={DOC:0,DOC_COMMENT:1,SHEET:2,SHEET_COMMENT:3,BITABLE:4,MINDNOTE:10,MINDNOTE_COMMENT:11,SLIDE:12,SLIDE_COMMENT:13,DOCX:22},i="cooperater-user-popover"},dx_YRGG:function(e,n,r){"use strict";var o=r("dx_hd5n");r.d(n,"b",(function(){return o.b}));var i=r("dx_WHqS");r.d(n,"h",(function(){return i.h}));var c=r("dx_MGm1");r.d(n,"B",(function(){return c.B}))},dx_YVX0:function(e,n,r){"use strict";r.d(n,"r",(function(){return a}));var o=r("dx_LcNA"),i=r("dx_cDcd"),c=r("dx_k8kI"),a=function(e){var n=e.equationViewInstance,r=e.containerEditor,a=e.block,l=Object(i.useCallback)((function(e){var r,o;e.current.width===e.previous.width&&e.current.height===e.previous.height||(null===(r=n.current)||void 0===r||null===(o=r.resize)||void 0===o||o.call(r))}),[n]),s=Object(i.useCallback)((function(){var e,r;null===(e=n.current)||void 0===e||null===(r=e.resize)||void 0===r||r.call(e)}),[n]);Object(i.useEffect)((function(){return r.on(o.L.RECT_CHANGE,l),null===a||void 0===a||a.blockManager.addListener(c.r,s,a.id),function(){r.off(o.L.RECT_CHANGE,l),null===a||void 0===a||a.blockManager.removeListener(c.r,s,a.id)}}),[r,l,a])}},dx_Yawu:function(e,n,r){},dx_YjoZ:function(e,n,r){"use strict";r.d(n,"C",(function(){return i}));var o=r("dx_UtDZ");function i(){return Object(o.getMinaConfig)("ccm.docx.web.clipboard_paste_perf",!1)}},dx_Yrx2:function(e,n,r){"use strict";r.d(n,"U",(function(){return Kr}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_Vvd7"),a=r("dx_faye"),l=r.n(a),s=r("dx_TOCS"),u=r("dx_zUqt"),d=r("dx_Fimk"),f=r("dx_lwsE"),h=r.n(f),p=r("dx_W7W2"),v=r.n(p),g=r("dx_a1gu"),b=r.n(g),y=r("dx_Nsbk"),m=r.n(y),_=r("dx_jtB3"),k=r("dx_N9dL"),O=r("dx_fEKD"),x=r("dx_T4T0"),E=r("dx_Z22N"),S=r("dx_B28d"),C=r("dx_W8MJ"),I=r.n(C),B=r("dx_iWIM"),T=r.n(B),w=r("dx_NMQJ"),R=r("dx_uv4w");function M(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var j=function(e){v()(r,e);var n=M(r);function r(e){return h()(this,r),n.call(this,e)}return I()(r,[{key:"onInit",value:function(e){this.editorAPI.getService(R.v).fetchRecordBatch(this.recordId),T()(m()(r.prototype),"onInit",this).call(this,e)}}]),r}(w.D);j.type=S.B.BLANK;var D=r("dx_cDcd"),A=r.n(D);function P(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var L,N,F=function(e){v()(r,e);var n=P(r);function r(){return h()(this,r),n.apply(this,arguments)}return I()(r,[{key:"render",value:function(){var e="inline"===this.props.displaymode?"inline":"block";return A.a.createElement("div",{className:"blank-block",style:{display:e}})}}]),r}(r("dx_MGoZ").l);function U(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var H,V=Object(c.H)({providers:[{provide:E.I,useClass:x.V,args:[S.B.BLANK,{calculateModel:_.j.PENDING}]},{provide:k.RecordSnapshotCreator,useValue:{type:S.B.BLANK,create:O.b}}]})((N=function(e){v()(r,e);var n=U(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).blocks=[[j,{viewCreator:F}]],e}return r}(c.y),L=N))||L,W=r("dx_uSID"),z=r("dx_Nn5p");function G(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var K,q,X,Y,J,Z=Object(c.H)({providers:[{provide:z.n,useFactory:function(){return(new z.nU).contentState}},{provide:z.O,deps:[z.n],useFactory:function(e){return new z.o(e).editor}}]})(H=function(e){v()(r,e);var n=G(r);function r(){return h()(this,r),n.apply(this,arguments)}return r}(c.G))||H,Q=r("dx_yG8O"),$=r.n(Q),ee=r("dx_PJYZ"),te=r.n(ee),ne=r("dx_Uyc2"),re=r.n(ne),oe=(r("dx_A1AB"),r("dx_FP3m")),ie=r("dx_J4zp"),ce=r.n(ie),ae=r("dx_xjz2"),le=r("dx_KHvq"),se=r("dx_MMMl"),ue=r("dx_Jl0O"),de=Object(ae.S3)("block-rect-getter"),fe=Object(ae.s)(de)((q=function(){function e(){h()(this,e),$()(this,"layoutManager",X,this),$()(this,"view",Y,this),this.caretCache=new Map,this.rangeCache=new Map}return I()(e,[{key:"getBlockRect",value:function(e){var n=this.view.getBlockViewByBlockId(e);return n&&this._blockIsInDocument(n)?Object(ue.I)(n.hostElement.getBoundingClientRect()):this._getBlockRectFromLayoutTree(e)}},{key:"getCaretRect",value:function(e,n,r){var o=this.view.getBlockViewByBlockId(e),i=this._getCaretCacheKey(e,n,r);if(!o||!this._blockIsInDocument(o)){var c=this._getBlockRectFromLayoutTree(e);if(c){var a=this.caretCache.get(i);a&&(c.top+=a.top,c.left+=a.left,c.height=a.height,c.bottom=c.top+c.height),c.width=0,c.right=c.left}return c}if(!(o instanceof le.N))return console.warn("This block is not a text block!",o),null;var l=o.model.zoneState,s=l.getModelText(),u=l.getZoneId(),d=this.getNewLineAndOffset(s,n),f=ce()(d,2),h=f[0],p=f[1],v=o.editor.rectModule.getRawCaretRect({line:h,offset:p,zoneId:u}),g=o.hostElement.getBoundingClientRect();return v.width=0,v.right=v.left,this.caretCache.set(i,{top:v.top-g.top,left:v.left-g.left,height:v.height}),v}},{key:"getRangeRect",value:function(e,n,r){var o=this.view.getBlockViewByBlockId(e),i=this._getRangeCacheKey(e,n,r);if(!o||!this._blockIsInDocument(o)){var c=this._getBlockRectFromLayoutTree(e);if(c){var a=this.rangeCache.get(i);a&&(c.right=c.left+a.right,c.bottom=c.top+a.bottom,c.top+=a.top,c.left+=a.left,c.height=a.height,c.width=a.width)}return c}if(!(o instanceof le.N))return console.warn("This block is not a text block!",o),null;var l=o.model.zoneState,s=l.getModelText(),u=l.getZoneId(),d=this.getNewLineAndOffset(s,n),f=ce()(d,2),h=f[0],p=f[1],v=this.getNewLineAndOffset(s,r),g=ce()(v,2),b=g[0],y=g[1],m=o.editor.rectModule.getRangeRect({start:{line:h,zoneId:u,offset:p},end:{line:b,zoneId:u,offset:y}},u),_=null;if(o.type===S.B.PAGE){var k,O=null===o||void 0===o||null===(k=o.model)||void 0===k?void 0:k.zoneState.getContainer();O&&(_=O.getBoundingClientRect())}return _||(_=o.hostElement.getBoundingClientRect()),this.rangeCache.set(i,m),{top:m.top+_.top,left:m.left+_.left,right:m.right+_.left,bottom:m.bottom+_.top,height:m.height,width:m.width}}},{key:"_getCaretCacheKey",value:function(e,n,r){return"".concat(e,"-").concat(n,"-").concat(r)}},{key:"_getRangeCacheKey",value:function(e,n,r){return"".concat(e,"-").concat(n,"-").concat(r)}},{key:"_blockIsInDocument",value:function(e){return this.reconciler.getActiveNodes().has(e.id)}},{key:"getNewLineAndOffset",value:function(e,n){var r=e.split("\n");if(r.length<=2)return[0,n];if(e.length<=n){var o=r.length-2;return[o,r[o].length]}for(var i=0,c=0,a=0,l=r.length;a<l;a++){var s=r[a].length;if(i+s>=n){c=a;break}i+=s+1}return[c,0!==c?n-i:n]}},{key:"_getBlockRectFromLayoutTree",value:function(e){var n=this.layoutManager.getLayoutInfo(e,!0);if(!n)return console.warn('[BlockRectGetter] Failed to get layout info for "'.concat(e,'"')),null;if(!this.view.rootBlockView)return console.warn('[BlockRectGetter] Failed to get block instance for root block "'.concat(e,'"')),null;var r=this.view.rootBlockView.getContentRect(),o=r.top,i=r.left,c=n.width,a=n.height,l=o+n.top;return{left:i,right:i,top:l,bottom:l+a,width:c,height:a}}},{key:"reconciler",get:function(){return this.layoutManager.getReconciler()}}]),e}(),X=re()(q.prototype,"layoutManager",[se.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y=re()(q.prototype,"view",[c.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),K=q))||K,he=r("dx_lSNA"),pe=r.n(he),ve=r("dx_OUFY"),ge=r("dx_Xdvu"),be=r("dx_hSCS"),ye=r("dx_D8nn"),me=r("dx_ey54"),_e=r("dx_k8kI");!function(e){e.text="text",e.line="line",e.block="block"}(J||(J={}));var ke,Oe,xe=r("dx_W23W");function Ee(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Se(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Ee(Object(r),!0).forEach((function(n){pe()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ee(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var Ce,Ie,Be,Te,we=Object(ae.s)(xe.z)((Oe=function(){function e(n,r,o,i){var c=this;h()(this,e),this.model=n,this.localEventEmitter=r,this.blockRectGetter=o,this.context=i,this.cache=new Map,this.sub=void 0,this.clearCache=function(){c.cache.clear()},r.addListener(_e.a,this.clearCache),r.addListener(me.G,this.clearCache),r.addListener(_e.h,this.clearCache),ye.S.on(ve.o.ON_SCROLL,this.clearCache),this.sub=n.beforeChange$.subscribe(this.clearCache)}return e=Object(ge.a)(e,void 0,3)||e,e=Object(ae.a)()(e,void 0,3)||e,e=de(e,void 0,2)||e,e=Object(be.h)(e,void 0,1)||e,e=Object(c.VA)(e,void 0,0)||e,I()(e,[{key:"destroy",value:function(){this.sub.unsubscribe(),this.localEventEmitter.removeListener(_e.a,this.clearCache),this.localEventEmitter.removeListener(me.G,this.clearCache),this.localEventEmitter.removeListener(_e.h,this.clearCache),ye.S.off(ve.o.ON_SCROLL,this.clearCache)}},{key:"getBlockClientRect",value:function(e){return this.blockRectGetter.getBlockRect(e)}},{key:"getBlockRect",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootBlockId,r=this.fold.findFoldedByBlock(e);if(r)return this.getFoldedRect(r,n);var o=this.model.getBlockModelByBlockId(e),i=Object(ue.p)({blockId:e,blockType:o.type,cacheType:J.block,relativeBlock:n});if(this.cache.has(i))return this.cache.get(i);var c=this.blockRectGetter.getBlockRect(e)||Object(ue.b)(),a=this.getRelativeRect(n)||Object(ue.b)(),l=Object(ue.l)(c,a);return this.cache.set(i,l),l}},{key:"getOriginBlockRect",value:function(e){return this.blockRectGetter.getBlockRect(e)||Object(ue.b)()}},{key:"getCaretRect",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rootBlockId,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.fold.findFoldedByBlock(e);if(i)return this.getFoldedRect(i,r);var c=this.model.getBlockModelByBlockId(e),a=Object(ue.p)({blockId:e,blockType:c.type,cacheType:J.text,relativeBlock:r,offset:n,isStart:o});if(this.cache.has(a))return this.cache.get(a);var l=this.getActualCaretRect(e,n,r,o);return this.cache.set(a,l),l}},{key:"getRangeRect",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rootBlockId,o=this.fold.findFoldedByBlock(e);if(o){var i=this.getFoldedRect(o,r);return Se(Se({},i),{},{leftCaretRect:i})}var c=this.model.getBlockModelByBlockId(e),a=Object(ue.p)({blockId:e,blockType:c.type,cacheType:J.text,relativeBlock:r,rangeStart:n[0],rangeEnd:n[1]});if(this.cache.has(a))return this.cache.get(a);var l=this.blockRectGetter.getRangeRect(e,n[0],n[1]);if(!l){var s=Object(ue.b)();return Se(Se({},s),{},{leftCaretRect:s})}var u=this.getRelativeRect(r)||Object(ue.b)(),d=Se(Se({},Object(ue.l)(l,u)),{},{leftCaretRect:this.getCaretRect(e,n[0],r)});return this.cache.set(a,d),d}},{key:"getRangeClientRect",value:function(e,n){return this.blockRectGetter.getRangeRect(e,n[0],n[1])}},{key:"getActualCaretRect",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.rootBlockId,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this.blockRectGetter.getCaretRect(e,n,o);if(!i)return Object(ue.b)();var c=this.getRelativeRect(r)||Object(ue.b)();return Object(ue.l)(i,c)}},{key:"getRelativeRect",value:function(e){return this.blockRectGetter.getBlockRect(e)}},{key:"getFoldedRect",value:function(e,n){var r=this.getBlockRect(e,n);return Object(ue.d)(r.bottom)}},{key:"rootBlockId",get:function(){return this.model.rootBlockId}},{key:"fold",get:function(){return this.context.get().fold}}]),e}(),ke=Oe))||ke;function Re(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var Me,je,De,Ae,Pe,Le,Ne=Object(c.H)({providers:[we,fe]})((Te=function(e){v()(r,e);var n=Re(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),$()(e,"rect",Be,te()(e)),e}return I()(r,[{key:"destroy",value:function(){this.rect.destroy()}}]),r}(c.G),Ie=Te,Be=re()(Ie.prototype,"rect",[oe.z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ce=Ie))||Ce,Fe=r("dx_o0o1"),Ue=r.n(Fe),He=r("dx_yXPU"),Ve=r.n(He),We=r("dx_QxNg"),ze=r("dx_h6a8"),Ge=r("dx_xlCA"),Ke=r("dx_jBAU"),qe=r("dx_eSV8"),Xe=r("dx_lSlT"),Ye=r("dx_QBF8"),Je=r("dx_TYsD"),Ze=r("dx_x1WV"),Qe=r("dx_p1pN");function $e(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function et(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?$e(Object(r),!0).forEach((function(n){pe()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$e(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function tt(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return nt(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return nt(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function nt(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var rt,ot,it,ct,at,lt,st=(Me=Object(ae.s)(Qe.v),je=Object(ae.S)(),Me((Le=function(){function e(n,r){var o=this;h()(this,e),this.editorAPI=n,this.collab=r,this.failedFetchRecordsSet=new Set,this.fetchRecordPromise=new Map,this.fetchRecordBatchTimeout=void 0,this.sync=void 0,this.pendingRecordTask=[],$()(this,"clientVarCache",Pe,this),this.handleOnline=function(){o.failedFetchRecordsSet.forEach((function(e){o.fetchRecordBatch(e)})),o.failedFetchRecordsSet.clear()},window.addEventListener("online",this.handleOnline)}return e=Object(Je.q)(e,void 0,1)||e,e=Object(ae.S)()(e,void 0,1)||e,e=Object(c.Q)(e,void 0,0)||e,I()(e,[{key:"destroy",value:function(){this.pendingRecordTask=[],this.failedFetchRecordsSet.clear(),clearTimeout(this.fetchRecordBatchTimeout),window.removeEventListener("online",this.handleOnline)}},{key:"connectSync",value:function(e){this.sync=e,e.setConnectSync(this.connectCollabSync.bind(this))}},{key:"registerNotificationEntities",value:function(){}},{key:"registerWithCustomRecordRegister",value:function(e,n){Object(ze.isArray)(e)||("block_map"in e&&(e=this.clientVarsToResourceEntities(e)),e=Object(ze.isArray)(e)?e:[e]);var r=Object(ze.partition)(e,(function(e){return Object(We.G)(e)})),o=ce()(r,2),i=o[0],c=o[1],a=this.model,l=this.collab,s=[];c.forEach((function(e){var n=e.id,r=e.resourceType;if(a.hasRecordByRecordId(n)&&void 0!==(null===l||void 0===l?void 0:l.getVersion(n,r)))return;s.push({id:n,snapshot:e.data})})),i.forEach((function(e){if(!a.hasRecordByRecordId(e.id)&&Object(We.G)(e))throw new Error("can not register notification before record register")})),this.registerEntity(c),n(s)}},{key:"register",value:function(e){var n=this;this.registerWithCustomRecordRegister(e,(function(e){n.model.registerRecords(e)}))}},{key:"registerEntity",value:function(e){var n,r=e.filter((function(e){return"number"===typeof e.version}));this.collab&&r.length&&(this.collab.register(r),(null===(n=this.sync)||void 0===n?void 0:n.enabled)?this.sync.requestSync(r):this.connectCollabSync(r))}},{key:"applyClientVar",value:function(e,n){this.registerWithCustomRecordRegister(e,(function(e){n(e)})),this.setMentionDocData(e)}},{key:"setMentionDocData",value:function(e){Xe.S.applyClientVar(e),this.embedObjManager.onEmbedPermissionChangeByClientVars(e)}},{key:"fetchRecord",value:function(){var e=Ve()(Ue.a.mark((function e(n,r){var o,i,c,a;return Ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(ze.isArray)(n)?n:[n],o=!1,i=tt(n),e.prev=3,i.s();case 5:if((c=i.n()).done){e.next=19;break}return a=c.value,e.prev=7,e.next=10,this.fetchClientVar(a,r);case 10:e.next=17;break;case 12:e.prev=12,e.t0=e.catch(7),console.error("Record Fetch Error ".concat(e.t0)),this.fetchRecordPromise.delete(a),o=!0;case 17:e.next=5;break;case 19:e.next=24;break;case 21:e.prev=21,e.t1=e.catch(3),i.e(e.t1);case 24:return e.prev=24,i.f(),e.finish(24);case 27:return e.abrupt("return",!o);case 28:case"end":return e.stop()}}),e,this,[[3,21,24,27],[7,12]])})));return function(n,r){return e.apply(this,arguments)}}()},{key:"fetchClientVar",value:function(){var e=Ve()(Ue.a.mark((function e(n,r){var o,i,c;return Ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.fetchRecordPromise.has(n)?o=this.fetchRecordPromise.get(n):(o=this.fetchRecordClientVars([n],r),this.fetchRecordPromise.set(n,o)),e.next=3,o;case 3:return i=e.sent,(c=i.block_map)&&0===Object.keys(c).length&&Object(qe.n)("[fetch record] ".concat(n,", data: ").concat(JSON.stringify(i))),this.register(i),this.fetchRecordPromise.delete(n),e.abrupt("return",i);case 9:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"fetchRecordBatch",value:function(){var e=Ve()(Ue.a.mark((function e(n){var r,o=this;return Ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return clearTimeout(this.fetchRecordBatchTimeout),r=new Promise((function(e,r){o.pendingRecordTask.push({recordId:n,resolve:e,reject:r})})),this.fetchRecordBatchTimeout=window.setTimeout(Ve()(Ue.a.mark((function e(){var n,r,c;return Ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=i()(o.pendingRecordTask),o.pendingRecordTask=[];case 2:if(!(n.length>0)){e.next=16;break}return r=n.splice(0,50),c=i()(new Set(r.map((function(e){return e.recordId})))),e.prev=5,e.delegateYield(Ue.a.mark((function e(){var n,i;return Ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.fetchRecordClientVars(c||[],o.model.rootRecordId);case 2:n=e.sent,i=n.block_map,Object(a.unstable_batchedUpdates)((function(){var e;o.register(n),Ge.n.applyClientVar(n),o.setMentionDocData(n),null===(e=o.clientVarCache)||void 0===e||e.addBlockData(n)})),r.forEach((function(e){var r=e.resolve,o=e.recordId;r(et(et({},n),{},{block_map:pe()({},o,i[o])}))}));case 6:case"end":return e.stop()}}),e)}))(),"t0",7);case 7:e.next=14;break;case 9:e.prev=9,e.t1=e.catch(5),e.t1 instanceof Error&&"Network Error"===e.t1.message&&c.forEach((function(e){return o.failedFetchRecordsSet.add(e)})),Object(qe.n)(e.t1),r.forEach((function(n){(0,n.reject)(e.t1)}));case 14:e.next=2;break;case 16:case"end":return e.stop()}}),e,null,[[5,9]])}))),0),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"clientVarsToResourceEntities",value:function(e){var n=[],r=e.block_map;return Object.values(r).forEach((function(e){var r=e.data;n.push({id:e.id,version:e.version,resourceType:We.N.record,data:r})})),n}},{key:"connectCollabSync",value:function(e){var n;null===(n=this.collab)||void 0===n||n.connectSync(e)}},{key:"fetchRecordClientVars",value:function(){var e=Ve()(Ue.a.mark((function e(n,r){var o;return Ue.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ke.S.getRecordClientVars(n,r||this.model.rootRecordId);case 2:return o=e.sent,e.abrupt("return",o.data);case 4:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"model",get:function(){return this.editorAPI.getService(c.VA)}},{key:"embedObjManager",get:function(){return this.editorAPI.getService(Ze.a).embedObjManager}}]),e}(),Ae=Le,Pe=re()(Ae.prototype,"clientVarCache",[je,Ye.y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),De=Ae))||De);function ut(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var dt,ft,ht=(rt=Object(c.H)({providers:[st]}),ot=Object(ae.d)(R.v),rt((lt=function(e){v()(r,e);var n=ut(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),$()(e,"clientVar",at,te()(e)),e}return I()(r,[{key:"destroy",value:function(){this.clientVar.destroy()}}]),r}(c.G),ct=lt,at=re()(ct.prototype,"clientVar",[ot],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),it=ct))||it),pt=r("dx_VOUh"),vt=r("dx_vOIB"),gt=r("dx_h2hr"),bt=r("dx_ZG9w"),yt=r("dx_LSUT"),mt=r("dx_T3tg"),_t=r("dx_PiBr"),kt=r("dx_YjoZ"),Ot=r("dx_L6LG");function xt(e,n,r){r.dispatch(Ot.f,[e,n],e.id),r.dispatch(Ot.f,[e,n]),e.children.forEach((function(e){xt(e,n,r)}))}var Et,St,Ct,It,Bt=Object(ae.s)(pt.a)((ft=function(){function e(n,r,o,i,a,l,s,u,d){var f=this;h()(this,e),this.recordManager=n,this.eventEmitter=r,this.layoutManager=o,this.editorAPI=i,this.snapshotFactory=a,this.structureQuery=l,this.clientVar=s,this.lazyRecordStatus=u,this.collab=d,this.orderMap=new Map,this.isUnmount=!1,this.embedObjManager=void 0,this.subs=void 0,this.traverse=function(e,n){if(f.model.hasBlockModelByBlockId(e)){var r=f.model.getBlockModelByBlockId(e);if(n(e))r.children.forEach((function(e){return f.traverse(e.id,n)}))}};var p=i,v=p.modelService,g=p.viewService;this.embedObjManager=new gt.S({token:this.config.get("noteToken")||this.config.get("token"),isPreview:this.isPreview}),this.dispatch=this.dispatch.bind(this),this.addListener=this.addListener.bind(this),this.removeListener=this.removeListener.bind(this),this.subs=[v.initialDataReady$.subscribe((function(){f.dispatch(Ot.Q)})),v.blockModelCreate$.subscribe((function(e){var n=e.model,r=e.options;f.dispatch(Ot.d,[n,r])})),v.blockModelUpdate$.subscribe((function(e){var n=e.model,r=e.options;f.dispatch(Ot.F,[n,r],n.id),f.dispatch(Ot.F,[n,r])})),v.blockModelStructUpdate$.subscribe((function(e){var n,r,o=e.model,i=e.options,a=e.action;if(a.type!==c.W.CHANGE_CHILD_TYPE){f.dispatch(Ot.f,[o,i],o.id),f.dispatch(Ot.f,[o,i]);var l=a.child,s=a.type===c.W.INSERT_CHILD;s&&xt(l,i,f);for(var u=o.children,d=i.transactionName,h=u.length,p=s?l.position+1:null!==(n=null===(r=l.nextSibling)||void 0===r?void 0:r.position)&&void 0!==n?n:h;p<h;){var v=u[p++];f.dispatch(Ot.m,[v],v.id),(!Object(kt.C)()||"pasteIntoBlock"!==d)&&f.dispatch(Ot.m,[v])}}else xt(a.child,i,f)})),v.blockModelDestroy$.subscribe((function(e){var n=e.model,r=e.options;f.dispatch(Ot.o,[n,r])})),v.error$.subscribe((function(e){f.emit(We.Ra.ERROR,e)})),g.blockViewMount$.subscribe((function(e){var n=e.props;f.dispatch(Ot.T,[n],n.blockId),f.dispatch(Ot.T,[n])})),g.blockViewUnmount$.subscribe((function(e){var n=e.props;f.dispatch(Ot.n,[n],n.blockId),f.dispatch(Ot.n,[n])})),g.blockViewUpdate$.subscribe((function(e){var n=e.props;f.dispatch(Ot.D,[n],n.blockId),f.dispatch(Ot.D,[n])}))]}return e=Object(Je.q)(e,void 0,8)||e,e=Object(ae.S)()(e,void 0,8)||e,e=Object(mt.r)(e,void 0,7)||e,e=Object(ae.S)()(e,void 0,7)||e,e=Object(R.v)(e,void 0,6)||e,e=Object(_t.F)(e,void 0,5)||e,e=Object(k.RecordSnapshotFactoryService)(e,void 0,4)||e,e=Object(c.Q)(e,void 0,3)||e,e=Object(se.p)(e,void 0,2)||e,e=Object(be.h)(e,void 0,1)||e,e=Object(yt.A)(e,void 0,0)||e,I()(e,[{key:"destroy",value:function(){this.isUnmount=!0,this.subs.forEach((function(e){return e.unsubscribe()})),this.orderMap.clear()}},{key:"applyTransaction",value:function(e,n,r){var o,i=this;(this.model.applyTransaction(e,n,r),null===r||void 0===r?void 0:r.afterTransactionAccepted)&&(null===(o=this.collab)||void 0===o||o.onSubmitted(r.afterTransactionAccepted));return new Promise((function(e){i.addListenerOnce(_e.w2,e)}))}},{key:"fetchRecord",value:function(e,n){return this.clientVar.fetchRecord(e,n)}},{key:"fetchRecordBatch",value:function(e){return this.clientVar.fetchRecordBatch(e)}},{key:"getRecord",value:function(e){return this.model.getRecordByRecordId(e)}},{key:"getRootRecordId",value:function(){return this.model.rootRecordId}},{key:"getRootBlockId",value:function(){var e=this.getRootRecordId();return this.model.getBlockModelsByRecordId(e).find((function(e){return null==e.parent})).id}},{key:"getRecordByBlockId",value:function(e){return this.model.getRecordByBlockId(e)}},{key:"getBlockMaxLevelInContainer",value:function(e){var n=this.getBlockMaxDepth(e);return Object(vt.q)(e)+n}},{key:"getBlockMaxDepth",value:function(e){return this.model.getBlockModelMaxDepth(e)}},{key:"getBlockMaxNestingDepthInRoot",value:function(e){var n=this.getBlockMaxDepth(e);return e.depth+n}},{key:"getFirstBlockIdByPreOrder",value:function(){return this.structureQuery.getFirstBlockIdByPreOrder(this.getRootBlockId())}},{key:"getLastBlockIdByPreOrder",value:function(){return this.structureQuery.getLastBlockIdByPreOrder(this.getRootBlockId())}},{key:"getBlockModelByBlockId",value:function(e){var n=this.model.getBlockModelByBlockId(e);if(!n)throw new Error('Failed to get block model (id: "'.concat(e,'", recordId: "').concat(this.model.getCacheRecordIdByBlockId(e),'")'));return n}},{key:"getBlockModelByBlockIdNotCheck",value:function(e){return this.model.getBlockModelByBlockId(e)}},{key:"hasBlockModelByBlockId",value:function(e){return this.model.hasBlockModelByBlockId(e)}},{key:"getBlockViewByBlockId",value:function(e){var n=this.view.getBlockViewByBlockId(e);if(!n)throw new Error('Failed to get block view (id: "'.concat(e,'", recordId: "').concat(this.model.getCacheRecordIdByBlockId(e),'")'));return n}},{key:"getBlockViewByBlockIdNotCheck",value:function(e){return this.view.getBlockViewByBlockId(e)}},{key:"hasBlockViewByBlockId",value:function(e){return this.view.hasBlockViewByBlockId(e)}},{key:"getBlockIdsByRecordId",value:function(e){return this.model.getBlockModelsByRecordId(e).map((function(e){return e.id}))}},{key:"getBlockModelsByRecordId",value:function(e){return this.model.getBlockModelsByRecordId(e)}},{key:"getBlockViewsByRecordId",value:function(e){var n=this;return this.getBlockModelsByRecordId(e).map((function(e){return n.getBlockViewByBlockIdNotCheck(e.id)})).filter(Boolean)}},{key:"findClosestBlockViewByBlockId",value:function(e,n,r){r=r||function(e){return!0};for(var o,i,c=this.getBlockModelByBlockId(e);c&&(i=n?c.next:c.previous);){var a=this.getBlockViewByBlockId(i.id);if(a&&r(a)){o=a.id;break}c=i}if(o)return this.getBlockViewByBlockId(o)}},{key:"findClosestEditableBlockViewInBoundaryByBlockId",value:function(e,n){return this.findClosestBlockViewByBlockId(e,n,(function(e){return!(!Object(bt.U)(e)&&!e.isWithBoundary)}))}},{key:"getBlockPath",value:function(e){return this.model.getBlockModelPathByBlockId(e)}},{key:"getRegisteredBlockType",value:function(){return this.model.getRegisteredBlockTypes()}},{key:"getBlockModelCreatorByBlockType",value:function(e){return this.model.getBlockModelCreator(e)}},{key:"getBlockViewCreatorByBlockType",value:function(e){return this.view.getBlockViewCreatorByBlockType(e)}},{key:"mount",value:function(e,n,r){return l.a.render(e,n,r)}},{key:"unmountBlockAtNode",value:function(e){return l.a.unmountComponentAtNode(e)}},{key:"dispatch",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"anonymous";this.eventEmitter.dispatch(e,n,r)}},{key:"addListener",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"anonymous";this.eventEmitter.addListener(e,n,r)}},{key:"addListenerOnce",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"anonymous";this.eventEmitter.addListenerOnce(e,n,r)}},{key:"removeListener",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"anonymous";this.eventEmitter.removeListener(e,n,r)}},{key:"on",value:function(e,n){this.eventEmitter.on(e,n)}},{key:"off",value:function(e,n){this.eventEmitter.off(e,n)}},{key:"emit",value:function(e,n){this.eventEmitter.emit(e,n)}},{key:"createInitModel",value:function(e,n){return this.snapshotFactory.create(e,n||{})}},{key:"config",get:function(){return this.editorAPI.config}},{key:"model",get:function(){return this.editorAPI.modelService}},{key:"view",get:function(){return this.editorAPI.viewService}},{key:"isPreview",get:function(){return!!this.config.get("isPreview")}},{key:"isHistory",get:function(){return!!this.config.get("isHistory")}},{key:"editable",get:function(){return this.config.get("editable")}},{key:"allBlockModels",get:function(){return this.model.allBlockModels}},{key:"allBlockViews",get:function(){return this.view.allBlockViews}},{key:"rootBlockId",get:function(){return this.getRootBlockId()}},{key:"rootRecordId",get:function(){return this.getRootRecordId()}},{key:"modelService",get:function(){return this.model}}]),e}(),dt=ft))||dt;function Tt(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var wt,Rt,Mt=Object(c.H)({providers:[Bt]})((It=function(e){v()(r,e);var n=Tt(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),$()(e,"blockManager",Ct,te()(e)),e}return I()(r,[{key:"destroy",value:function(){this.blockManager.destroy()}}]),r}(c.G),St=It,Ct=re()(St.prototype,"blockManager",[pt.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Et=St))||Et,jt=r("dx_O4O8"),Dt=r.n(jt),At=r("dx_g499");function Pt(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var Lt,Nt,Ft,Ut,Ht=Symbol("once"),Vt="anonymous",Wt=Object(ae.s)(At.h)((Rt=function(e){v()(r,e);var n=Pt(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).listenerMap={},e}return I()(r,[{key:"dispatch",value:function(e,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vt;if(o!==Vt){if(this.listenerMap[e]){var c=this.listenerMap[e][o];if(!c)return;var a=Array.isArray(n)?n.slice():[n];c.forEach((function(e){try{e.apply(r,a)}catch(n){console.error(n)}}))}return this}Array.isArray(n)?this.emit.apply(this,[e].concat(i()(n))):this.emit(e,n)}},{key:"addListener",value:function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vt;if(o===Vt)return T()(m()(r.prototype),"addListener",this).call(this,e,n),this;this.listenerMap[e]||(this.listenerMap[e]={});var i=this.listenerMap[e][o];return i?!i.includes(n)&&i.push(n):this.listenerMap[e][o]=[n],this}},{key:"addListenerOnce",value:function(e,n){var o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vt;if(i===Vt)return T()(m()(r.prototype),"once",this).call(this,e,n);var c=function r(){o.removeListener(e,r,i),n&&n.apply(void 0,arguments)};return c[Ht]=n,this.addListener(e,c,i),this}},{key:"removeListener",value:function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Vt;return o===Vt?(T()(m()(r.prototype),"removeListener",this).call(this,e,n),this):(this.listenerMap[e]&&this.listenerMap[e][o]&&(this.listenerMap[e][o]=this.listenerMap[e][o].filter((function(e){return n!==e&&n!==e[Ht]}))),this)}},{key:"removeAllListeners",value:function(e){return T()(m()(r.prototype),"removeAllListeners",this).call(this,e),e?this.listenerMap[e]=void 0:T()(m()(r.prototype),"removeAllListeners",this).call(this),this}}]),r}(Dt.a),wt=Rt))||wt;function zt(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var Gt,Kt,qt,Xt=Object(c.H)({providers:[Wt]})((Ut=function(e){v()(r,e);var n=zt(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),$()(e,"eventEmitter",Ft,te()(e)),e}return I()(r,[{key:"destroy",value:function(){this.eventEmitter.removeAllListeners()}}]),r}(c.G),Nt=Ut,Ft=re()(Nt.prototype,"eventEmitter",[be.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Lt=Nt))||Lt,Yt=r("dx_YIK2"),Jt=r("dx_vlFf"),Zt=r("dx_MIzm"),Qt=Object(ae.s)(Zt.A)((Kt=function(){function e(n,r,o,i,c,a,l){var s;h()(this,e),this.model=n,this.traverser=r,this.eventEmitter=o,this.lazySync=i,this.collabModule=c,this.undoModule=a,this.backupModule=l,this.subFuncMap=new Map,this.eventMap=void 0,this.eventMap=(s={},pe()(s,We.q.BEFORE_CHANGE,n.beforeChange$),pe()(s,We.q.INTERCEPT_CHANGE,n.interceptChange$),pe()(s,We.q.CHANGE,n.change$),pe()(s,We.q.ERROR,n.error$),pe()(s,We.q.REGISTER,n.register$),pe()(s,We.q.UNREGISTER,n.unregister$),pe()(s,We.q.INTERCEPT_REMOTE_CHANGE,n.interceptRemoteChange$),pe()(s,We.q.BEFORE_OPERATION_APPLY,n.beforeOperationApply$),s)}return e=Object(Yt.c)(e,void 0,6)||e,e=Object(ae.S)()(e,void 0,6)||e,e=Object(Jt.H)(e,void 0,5)||e,e=Object(ae.S)()(e,void 0,5)||e,e=Object(Je.q)(e,void 0,4)||e,e=Object(ae.S)()(e,void 0,4)||e,e=Object(mt.K)(e,void 0,3)||e,e=Object(ae.S)()(e,void 0,3)||e,e=Object(be.h)(e,void 0,2)||e,e=Object(_t.F)(e,void 0,1)||e,e=Object(c.VA)(e,void 0,0)||e,I()(e,[{key:"getRecordMap",value:function(){return this.model.getRecordMap()}},{key:"getRecord",value:function(e){return this.model.getRecordByRecordId(e)}},{key:"hasRecord",value:function(e){return this.model.hasRecordByRecordId(e)}},{key:"registerRecordSnapshots",value:function(e){return this.model.registerRecords(e)}},{key:"applyTransaction",value:function(e,n,r){var o;(this.model.applyTransaction(e,n,r),null===r||void 0===r?void 0:r.afterTransactionAccepted)&&(null===(o=this.collabModule)||void 0===o||o.onSubmitted(r.afterTransactionAccepted))}},{key:"on",value:function(e,n){var r=this.eventMap[e],o=this.subFuncMap.get(e);o||this.subFuncMap.set(e,o=new Map);var i=o.get(n);i||o.set(n,i=[]),i.push(r.subscribe(n))}},{key:"off",value:function(e,n){var r=this.subFuncMap.get(e);if(r){var o=r.get(n);o&&(r.delete(n),o.forEach((function(e){return e.unsubscribe()})))}}},{key:"traverse",value:function(e,n,r){return this.traverser.traverseRecord(e,n,r)}},{key:"pureTraverse",value:function(e,n,r,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return this.traverser.pureTraverseRecord(e,n,r,o,i)}}]),e}(),Gt=Kt))||Gt;function $t(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var en,tn=Object(c.H)({providers:[Qt]})(qt=function(e){v()(r,e);var n=$t(r);function r(){return h()(this,r),n.apply(this,arguments)}return r}(c.G))||qt,nn=r("dx_L6Lu");function rn(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function on(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?rn(Object(r),!0).forEach((function(n){pe()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rn(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function cn(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var an,ln,sn,un,dn,fn,hn,pn=Object(ae.s)(de)(en=function(e){v()(r,e);var n=cn(r);function r(){return h()(this,r),n.apply(this,arguments)}return I()(r,[{key:"getBlockBoundingClientRect",value:function(e){var n=null;if([S.B.PAGE,S.B.CODE].includes(e.type)){var r=e.hostElement.querySelector(".editor-kit-container");r&&(n=Object(nn.V)(r))}return n||(n=Object(nn.V)(e.hostElement)),n}},{key:"getBlockRect",value:function(e){var n=this.view.getBlockViewByBlockId(e);return n&&this._blockIsInDocument(n)?Object(ue.I)(Object(nn.V)(n.hostElement)):this._getBlockRectFromLayoutTree(e)}},{key:"getCaretRect",value:function(e,n,r){var o=this.view.getBlockViewByBlockId(e),i=this._getCaretCacheKey(e,n,r);if(!o||!this._blockIsInDocument(o)){var c=this._getBlockRectFromLayoutTree(e);if(c){var a=this.caretCache.get(i);a&&(c.top+=a.top,c.left+=a.left,c.height=a.height,c.bottom=c.top+c.height),c.width=0,c.right=c.left}return c}if(!(o instanceof le.N))return console.warn("This block is not a text block!",o),null;var l=o.model.zoneState,s=l.getModelText(),u=l.getZoneId(),d=this.getNewLineAndOffset(s,n),f=ce()(d,2),h=f[0],p=f[1],v=o.editor.rectModule.getRawCaretRect({line:0,offset:0,zoneId:u}),g=o.editor.rectModule.getRawCaretRect({line:h,offset:p,zoneId:u}),b=on(on({},g),{},{top:g.top-v.top,bottom:g.bottom-v.top,left:g.left-v.left,right:g.right-v.left}),y=Object(nn.K)();Object(nn.C)(o.model.zoneState.getContainer())&&(b.top=b.top*y,b.bottom=b.bottom*y,b.left=b.left*y,b.right=b.right*y,b.height=b.height*y,b.width=b.width*y);var m=this.getBlockBoundingClientRect(o);return b.width=0,b.right=b.left,this.caretCache.set(i,{top:b.top,left:b.left,height:b.height}),on(on({},b),{},{left:b.left+m.left,right:b.right+m.left,top:b.top+m.top,bottom:b.bottom+m.top})}},{key:"getRangeRect",value:function(e,n,r){var o=this.view.getBlockViewByBlockId(e),i=this._getRangeCacheKey(e,n,r);if(!o||!this._blockIsInDocument(o)){var c=this._getBlockRectFromLayoutTree(e);if(c){var a=this.rangeCache.get(i);a&&(c.right=c.left+a.right,c.bottom=c.top+a.bottom,c.top+=a.top,c.left+=a.left,c.height=a.height,c.width=a.width)}return c}if(!(o instanceof le.N))return console.warn("This block is not a text block!",o),null;var l=o.model.zoneState,s=l.getModelText(),u=l.getZoneId(),d=this.getNewLineAndOffset(s,n),f=ce()(d,2),h=f[0],p=f[1],v=this.getNewLineAndOffset(s,r),g=ce()(v,2),b=g[0],y=g[1],m=o.editor.rectModule.getRangeRect({start:{line:h,zoneId:u,offset:p},end:{line:b,zoneId:u,offset:y}},u),_=this.getBlockBoundingClientRect(o);return this.rangeCache.set(i,m),{top:m.top+_.top,left:m.left+_.left,right:m.right+_.left,bottom:m.bottom+_.top,height:m.height,width:m.width}}}]),r}(fe))||en;function vn(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var gn=Object(c.H)({providers:[we,pn]})((hn=function(e){v()(r,e);var n=vn(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),$()(e,"rect",sn,te()(e)),$()(e,"config",un,te()(e)),$()(e,"editorContext",dn,te()(e)),$()(e,"layoutManager",fn,te()(e)),e.handleScroll=Object(ze.debounce)((function(){var n=e.editorContext.commentModule;n&&(e.rect.clearCache(),n.updateAllCommentPosition())}),200),e}return I()(r,[{key:"bindEvents",value:function(){this.layoutManager.enableVirtualRender||this.config.get("scroller").addEventListener("scroll",this.handleScroll)}},{key:"unbindEvents",value:function(){this.layoutManager.enableVirtualRender||this.config.get("scroller").removeEventListener("scroll",this.handleScroll)}},{key:"init",value:function(){this.bindEvents()}},{key:"destroy",value:function(){this.unbindEvents(),this.rect.destroy()}}]),r}(c.G),ln=hn,sn=re()(ln.prototype,"rect",[oe.z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),un=re()(ln.prototype,"config",[c.j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dn=re()(ln.prototype,"editorContext",[ge.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),fn=re()(ln.prototype,"layoutManager",[se.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),an=ln))||an,bn=r("dx_ppc6"),yn=(r("dx_Pk2m"),r("dx_rQGm")),mn=r("dx_yzqx");var _n,kn,On,xn,En,Sn,Cn,In,Bn,Tn,wn=r("dx_q0q6"),Rn=r("dx_pmiW"),Mn=r("dx_zghO"),jn=r("dx_P58d"),Dn=r("dx_qHDV"),An=r("dx_N5N8");function Pn(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}var Ln,Nn,Fn,Un,Hn,Vn=(_n=Object(ae.s)(An.w),kn=Object(ae.a)(),On=Object(ae.a)(),xn=Object(ae.a)(),_n((Tn=function(){function e(){var n=this;h()(this,e),this._sel=void 0,$()(this,"blockManager",Cn,this),$()(this,"rect",In,this),$()(this,"composing",Bn,this),this.rafUpdateBrowserSelection=void 0,this.setSelection=function(e,r){return n._sel.setSelection(e,r)},this.clearSelection=function(e){return n._sel.setSelection([],{source:e})},this.focus=function(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(r&&n._sel.boundaryAreaContainer){var o=n._sel.boundaryAreaContainer.scrollTop;e.focus(),n._sel.boundaryAreaContainer.scrollTo({top:o})}else e.focus()}}return I()(e,[{key:"init",value:function(e,n){var r=new Mn.i(function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Pn(Object(r),!0).forEach((function(n){pe()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pn(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({blockManager:this.blockManager.get(),rect:this.rect.get(),composing:this.composing.get(),mode:Rn.Z.TOUCH,startXThresholdWhenLazy:0,startYThresholdWhenLazy:35,startThresholdWhenNormal:10,scrollSpeedDivider:30,scrollThresholdOfBoundary:{x:80,y:80},manualScrollSpeed:750,selectionAreaClass:"selection-area",securitySizeOfBoundary:{top:5,left:5,right:5,bottom:5}},e),this.focus,n);r.setup(),this._sel=r,ye.S.on(yn.D,this.setSelection),this.rafUpdateBrowserSelection=function(e){var n=null,r=function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];o[0]&&o[0].persist&&o[0].persist(),null===n&&(n=window.requestAnimationFrame((function(){e.apply(null,o),n=null})))};return r.cancel=function(){n&&(window.cancelAnimationFrame(n),n=null)},r}(this.updateBrowserSelection.bind(this))}},{key:"on",value:function(e,n){this._sel.on(e,n)}},{key:"off",value:function(e,n){this._sel.off(e,n)}},{key:"register",value:function(e,n){return this._sel.register(e,n)}},{key:"unregister",value:function(e,n){return this._sel.unregister(e,n)}},{key:"getSelection",value:function(){return this._sel.getSelection()}},{key:"getIsCurrentTextSelection",value:function(e){return this._sel.getIsCurrentTextSelection(e)}},{key:"getSelectedBlockIfInSelection",value:function(e){return this._sel.getSelectedBlockIfInSelection(e)}},{key:"getSelectionWithoutCursor",value:function(){var e=this._sel.getSelection();return this.isCursor(e)?[]:e}},{key:"getContext",value:function(){return this._sel.getContext()}},{key:"getSelectionContext",value:function(){return this._sel.getSelectionContext()}},{key:"removeAllSelection",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._sel.removeAllSelection(e)}},{key:"restoreFocus",value:function(){this._sel.restoreFocus()}},{key:"emitSelectionChange",value:function(){this._sel.emit(Dn.j.browserSelectionChange,void 0,!0)}},{key:"isFocus",value:function(){return this.isFocusInHiddenInputDom()||this.isFocusInBoundary()||mn.S.isMobile}},{key:"isFocusInHiddenInputDom",value:function(){var e=window.getSelection();if(e){var n=e.focusNode,r=e.focusOffset,o=this._sel.hiddenInputDom;if(o.contains((null===n||void 0===n?void 0:n.childNodes[r])||null)||o.contains(e.focusNode))return!0}return!1}},{key:"isFocusInBoundary",value:function(){var e=window.getSelection();return!(!e||!this._sel.pasteBoundary.contains(e.focusNode))}},{key:"copyOrCutSelectedBlocks",value:function(e){this.restoreFocus(),"cut"===e&&this._sel.setHiddenInputDomReadOnly(!1),!0!==document.execCommand(e)&&console.warn("execCommand ".concat(e," fail")),this._sel.setHiddenInputDomReadOnly(!0)}},{key:"copySelectedBlocks",value:function(){!0!==document.execCommand("copy")&&console.warn("execCommand ".concat("type"," fail"))}},{key:"selectAll",value:function(){if(!this.isSelecting())return this._sel.selectAll()}},{key:"getExtendSelectionType",value:function(e){var n=this._sel.extendSelectionTypes.filter((function(n){return n.type===e}))[0];if(!n)throw new Error("".concat(e," not found"));return n}},{key:"getTextSelectionType",value:function(){return this.getExtendSelectionType(jn.j.TEXT)}},{key:"isSingleTextSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection();return this._sel.store.isSingleTextSelection(e)}},{key:"isCollapsedTextSelection",value:function(){var e,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection();return!!this.isSingleTextSelection(r)&&(null===(e=r[0].selection)||void 0===e?void 0:e.end)===(null===(n=r[0].selection)||void 0===n?void 0:n.start)}},{key:"isBlockSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection();return this._sel.store.isBlockSelection(e)}},{key:"isTextSelectionAcrossBlocks",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection();return this._sel.store.isTextSelectionAcrossBlocks(e)}},{key:"isHybridSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection();return this._sel.store.isHybridSelection(e)}},{key:"isCursor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection();return this._sel.store.isCursor(e)}},{key:"onSelectionChangeWhenSelecting",value:function(e){return this._sel.store.onSelectionChangeWhenSelecting(e)}},{key:"offSelectionChangeWhenSelecting",value:function(e){return this._sel.store.offSelectionChangeWhenSelecting(e)}},{key:"onSelectionChange",value:function(e){return this._sel.store.onSelectionChange(e)}},{key:"offSelectionChange",value:function(e){return this._sel.store.offSelectionChange(e)}},{key:"onSelectionChanging",value:function(e){return this._sel.store.onSelectionChanging(e)}},{key:"offSelectionChanging",value:function(e){return this._sel.store.offSelectionChanging(e)}},{key:"destroy",value:function(){this._sel.destroy(),this.rafUpdateBrowserSelection.cancel(),ye.S.off(yn.D,this.setSelection)}},{key:"blur",value:function(){this._sel.blur()}},{key:"isSelecting",value:function(){return this._sel.isSelecting}},{key:"isActive",value:function(){return this._sel.isActive()}},{key:"activate",value:function(){this._sel.activate()}},{key:"deactivate",value:function(){this._sel.deactivate()}},{key:"cancel",value:function(){this._sel.cancel()}},{key:"updateBrowserSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection();this._sel.updateBrowserSelection(e)}},{key:"options",get:function(){return this._sel.options}},{key:"forward",get:function(){return this._sel.store.forward},set:function(e){this._sel.store.forward=e}}]),e}(),Sn=Tn,Cn=re()(Sn.prototype,"blockManager",[kn,Ze.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),In=re()(Sn.prototype,"rect",[On,oe.z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Bn=re()(Sn.prototype,"composing",[xn,wn.A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),En=Sn))||En),Wn=Vn;function zn(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var Gn,Kn,qn=Object(c.H)({providers:[Wn,bn.p]})((Hn=function(e){v()(r,e);var n=zn(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),$()(e,"selection",Fn,te()(e)),$()(e,"clickRootService",Un,te()(e)),e}return I()(r,[{key:"init",value:function(){this.clickRootService.init()}},{key:"destroy",value:function(){this.selection.destroy(),this.clickRootService.destroy()}}]),r}(c.G),Nn=Hn,Fn=re()(Nn.prototype,"selection",[bn.S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Un=re()(Nn.prototype,"clickRootService",[bn.L],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ln=Nn))||Ln,Xn=qn,Yn=r("dx_LzB7"),Jn=r("dx_DP1I"),Zn=function(){function e(){h()(this,e),this.type="default"}return I()(e,[{key:"traverse",value:function(e){return e.children||[]}}]),e}(),Qn=r("dx_c5KA"),$n=r("dx_lwLI");function er(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return tr(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tr(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function tr(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var nr,rr,or,ir,cr=Object(ae.s)($n.F)((Kn=function(){function e(n,r,o){var i=this;h()(this,e),this.recordTraversers=n,this.blockQueryHooks=r,this.model=o,this.unwatchRecordTraversers=void 0,this.defaultRecordTraverser=new Zn,this.recordTraverserMap=void 0,this.unwatchRecordTraversers=n.onChange((function(){i.recordTraverserMap=void 0}))}return e=Object(c.VA)(e,void 0,2)||e,e=Object(Yn.g)(e,void 0,1)||e,e=Object(ae.e)()(e,void 0,1)||e,e=Object(ae.a)()(e,void 0,1)||e,e=Object(Qn.R)(e,void 0,0)||e,e=Object(ae.e)()(e,void 0,0)||e,e=Object(ae.a)()(e,void 0,0)||e,I()(e,[{key:"destroy",value:function(){this.unwatchRecordTraversers()}},{key:"getFirstBlockIdByPreOrder",value:function(e){var n=this.model.getBlockModelByBlockId(e);return n&&n.children.length?this.blockQueryHooks.get().filter((function(e){return e.type===Jn.K.ON_FIRST_BLOCK_IN_PRE_ORDER})).reduce((function(e,n){return n.apply(e)}),n.children[0].id):null}},{key:"getLastBlockIdByPreOrder",value:function(e){var n=this.model.getBlockModelByBlockId(e);if(!n||!n.children.length)return null;for(var r=c.V,o=n.children;!r&&o.length;){var i=o.length-1;o[i].children.length?o=o[i].children:r=o[i].id}return this.blockQueryHooks.get().filter((function(e){return e.type===Jn.K.ON_LAST_BLOCK_IN_PRE_ORDER})).reduce((function(e,n){return n.apply(e)}),r)}},{key:"traverseRecord",value:function(e,n,r){var o=this;return this.pureTraverseRecord(e,null,(function(e){return o.model.hasRecordByRecordId(e)?o.model.getRecordByRecordId(e):null}),(function(e){return n(e)}),r)}},{key:"pureTraverseRecord",value:function(e,n,r,o){var i=this,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=r(e);if(a&&o(a,n)){var l=this.getTraverserMap().get(a.snapshot.type)||this.defaultRecordTraverser,s=l.traverse(a.snapshot,c);s.forEach((function(e){return i.pureTraverseRecord(e,a,r,o,c)}))}}},{key:"pureTraverseSnapshot",value:function(e,n,r,o){var i=this,c=r(e);c&&o(e,n,c)&&(this.getTraverserMap().get(c.type)||this.defaultRecordTraverser).traverse(c).forEach((function(n){return i.pureTraverseSnapshot(n,e,r,o)}))}},{key:"getTraverserMap",value:function(){if(this.recordTraverserMap)return this.recordTraverserMap;var e,n=new Map,r=er(this.recordTraversers.get());try{for(r.s();!(e=r.n()).done;){var o=e.value;n.set(o.type,o)}}catch(i){r.e(i)}finally{r.f()}return this.recordTraverserMap=n,n}}]),e}(),Gn=Kn))||Gn;function ar(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var lr=Object(c.H)({providers:[cr]})((ir=function(e){v()(r,e);var n=ar(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),$()(e,"query",or,te()(e)),e}return I()(r,[{key:"destroy",value:function(){this.query.destroy()}}]),r}(c.G),rr=ir,or=re()(rr.prototype,"query",[_t.F],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),nr=rr))||nr,sr=r("dx_bLiB"),ur=r("dx_P5PS");function dr(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var fr,hr,pr=function(e){v()(r,e);var n=dr(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).getWrapperClassName=function(n){var r;return(null===(r=e.props.renderProps.recursionProps)||void 0===r?void 0:r.fold.isShow(n))?"":"block-hidden"},e}return I()(r,[{key:"shouldComponentUpdate",value:function(e){if(this.props.blockModel!==e.blockModel)return!0;var n=this.props.renderProps.recursionProps;return!Object(ze.isEqual)(n,e.renderProps.recursionProps)}},{key:"render",value:function(){var e=this,n=this.props,r=n.blockModel,o=n.editorAPI,i=n.renderProps,c=n.layoutManager,a=o.config.get("slottedBlockTypes");return A.a.createElement(_.R,{id:r.id,isRoot:r.isRoot,reconciler:c.getReconciler(),renderChild:function(n,r){var c=o.modelService.getBlockModelByBlockId(n);return(null===a||void 0===a?void 0:a.has(c.type))?Object(ur.W)(c.recordId):o.viewService.render(n,Object.assign({getWrapperClassName:e.getWrapperClassName},i,{hostElementRef:r}))},watchProps:i.recursionProps,className:i.className||""})}}]),r}(A.a.Component),vr=r("dx_q3qZ"),gr=r("dx_QILm"),br=r.n(gr),yr=r("dx_UtDZ"),mr=r("dx_JWrU"),_r=r("dx_GWFd"),kr=r("dx_N2Hh"),Or=r("dx_IcDz"),xr=r("dx_qBEj"),Er=r("dx_dr3d"),Sr=Object(ae.S3)("layout-node-changes-context"),Cr=r("dx_MIrL"),Ir=function(){function e(){h()(this,e),this.observerMap=new WeakMap}return I()(e,[{key:"lock",value:function(n){if(n.dataset.lockedHeightBlock="",Array.from(n.children).forEach((function(n){return e.lockChild(n)})),!this.observerMap.has(n)){var r=new MutationObserver(e.handleChildrenChange);r.observe(n,{childList:!0}),this.observerMap.set(n,r)}}},{key:"unlock",value:function(e){delete e.dataset.lockedHeightBlock,Array.from(e.children).forEach((function(e){e instanceof HTMLElement&&delete e.dataset.lockedHeightBlockChild})),this.observerMap.has(e)&&(this.observerMap.get(e).disconnect(),this.observerMap.delete(e))}}],[{key:"lockChild",value:function(e){var n;e instanceof HTMLElement&&null!=(null===(n=e.parentElement)||void 0===n?void 0:n.dataset.lockedHeightBlock)&&(e.dataset.lockedHeightBlockChild="")}}]),e}();function Br(e){var n=e.action,r=e.subType;return"easysync"===(null===r||void 0===r?void 0:r.t)&&!!r.o.zone_changesets||null!==n.od||null!==n.oi}function Tr(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return wr(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wr(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function wr(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function Rr(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Mr(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Rr(Object(r),!0).forEach((function(n){pe()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rr(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}Ir.handleChildrenChange=function(e){e.forEach((function(e){e.addedNodes.forEach((function(e){return Ir.lockChild(e)}))}))};var jr,Dr,Ar=Object(ae.s)(Cr.p)((hr=function(){function e(n,r,o,a,l){var s=this;h()(this,e),this.context=n,this.dynamicView=r,this.eventEmitter=o,this.model=a,this.selectionAPI=l,this.enableVirtualRender=void 0,this.batchingChangeNodes=0,this.reconciler=new _.F,this.changeNodes=[],this.reportedMessageSet=new Set,this.editorWidth=0,this.windowInnerHeight=0,this.nodeHeightLocker=new Ir,this.additionalActiveBlocks=new Set,this.subscriptions=[],this.scroller=void 0,this.throttleReportViewportLock=Object(ze.throttle)((function(e,n){var r;if(null===(r=s.reconciler)||void 0===r?void 0:r.tracker){var o,i,c,a,l,u,d=(null===(o=(i=s.reconciler.tracker).getScrollTrackerLog)||void 0===o||null===(c=o.call(i))||void 0===c?void 0:c.length)||0,f=(null===(a=(l=s.reconciler.tracker).getTrackerLog)||void 0===a||null===(u=a.call(l,!1))||void 0===u?void 0:u.length)||0;Object(xr.D)(Mr({message:"viewport lock happening!",source:"onViewportLocked",scrollTrackerLogSize:d,trackerLogSize:f},e)),n()}}),200,{leading:!1}),this.scrollToSelection=function(){var e;return(e=s.reconciler.viewport).scrollToSelection.apply(e,arguments)},this.enterForceLayoutForAll=function(){return s.reconciler.enterForceLayoutForAll()},this.quitForceLayoutForAll=function(){return s.reconciler.quitForceLayoutForAll()},this.getViewportBlocks=function(){return s.filterUnExistNode(s.reconciler.getViewportNodes())},this.isBlockInViewport=function(e){return s.reconciler.getViewportNodes().includes(e)},this.getBufferBlocks=function(){return s.filterUnExistNode(s.reconciler.getBufferNodes())},this.isBlockActive=function(e){return!!s.reconciler.getActiveNodes().has(e)},this.getLayoutInfo=function(e,n){var r=s.reconciler.getLayoutTree().getLayoutInfo(e);return r?Mr(Mr({},r),{},{top:r.top+(n?0:s.reconciler.getContentAboveRootHeight())}):null},this.getContentAboveRootHeight=function(){return s.reconciler.getContentAboveRootHeight()},this.notifyNodeHeightChange=function(e){return s.reconciler.handleNodeHeightChange(e)},this.notifyRenderFinish=function(e){return s.reconciler.handleAsyncNodeRenderFinish(e)},this.notifyHeaderHeightChange=function(){return s.reconciler.handleContentAboveRootHeightChange()},this.getViewportHelper=function(){return s.reconciler.viewport.getViewportHelper()},this.renderNodeById=function(){var e;return(e=s.reconciler).renderNodeById.apply(e,arguments)},this.renderNodeByIdSync=function(){var e;return(e=s.reconciler).renderNodeByIdSync.apply(e,arguments)},this.handleFoldStatusChangeViewDisplay=function(e){var n=new Map,r=s.context;e.forEach((function(e){var o=e.id,i=s.model.getBlockModelByBlockId(o);if(i){var c=r.getLayoutNodeConfig(i).calculateModel;n.set(o,c),r.iterateLayoutNodeChildren(i,(function(e,o){var i,c,a=s.model.getBlockModelByBlockId(e);!o&&a&&(o=r.getLayoutNodeConfig(a));var l=null!==(i=null===(c=o)||void 0===c?void 0:c.calculateModel)&&void 0!==i?i:_.j.VERTICAL;n.set(e,l)}))}}));var o=s.reconciler.getLayoutTree(),i=[];n.forEach((function(e,n){var r=o.getNode(n);r&&r.node.calculateModel===e||i.push({nodeId:n,modifications:[{action:_e.o.UPDATE}],config:{calculateModel:e}})})),i.length>0&&(s.addChangeNodesAndTryToSubmit(i),Promise.resolve().then((function(){s.eventEmitter.dispatch(Or.m)})))},this.bindStartEvent=function(e){var n=s.eventEmitter;"on"===e?(s.subscriptions=[s.model.beforeChange$.subscribe(s.handleBeforeChange),s.model.change$.subscribe(s.handleChange),s.model.blockModelCreate$.subscribe(s.handleModelCreate),s.model.blockModelUpdate$.subscribe(s.handleModelUpdate),s.model.blockModelStructUpdate$.subscribe(s.handleModelStructUpdate)],n.addListener(Or.s,s.handleFoldStatusChangeViewDisplay),n.addListener(me.G,s.handleResize)):(s.subscriptions.forEach((function(e){return e.unsubscribe()})),s.subscriptions.length=0,n.removeListener(Or.s,s.handleFoldStatusChangeViewDisplay),n.removeListener(me.G,s.handleResize))},this.handleBeforeChange=function(){++s.batchingChangeNodes},this.handleChange=function(e){var n,r=s.context.flush();r.length&&(s.assignConfigForChangeNodes(r),(n=s.changeNodes).push.apply(n,i()(r)));--s.batchingChangeNodes||s.submitChangeNodes(e.options.from===We.H.local)},this.handleWindowHeightChange=function(){s.windowInnerHeight!==window.innerHeight&&(s.windowInnerHeight=window.innerHeight,s.notifyHeaderHeightChange())},this.handleAddAdditionalActiveBlock=function(e){s.additionalActiveBlocks.has(e)||(s.additionalActiveBlocks.add(e),s.reconciler.debouncePaint())},this.handleRemoveAdditionalActiveBlock=function(e){s.additionalActiveBlocks.has(e)&&(s.additionalActiveBlocks.delete(e),s.reconciler.debouncePaint())},this.filterUnExistNode=function(e){return e.filter((function(e){return s.dynamicView.get().hasBlockViewByBlockId(e)}))},this.callViewChangedEvent=function(e,n){var r,o;null===(r=s.dynamicView.get().getBlockViewByBlockId(n))||void 0===r||null===(o=r[e])||void 0===o||o.call(r)},this.handleChangedEvent=function(e,n){var r=n.enterNodes,o=n.leaveNodes,i=n.viewportNodes;r=s.filterUnExistNode(r),o=s.filterUnExistNode(o),i=s.filterUnExistNode(i);var c=function(e){return"buffer"===e?{enterEvent:_e.r,leaveEvent:_e.b,changeEvent:_e.a}:{enterEvent:_e.Q,leaveEvent:_e.J,changeEvent:_e.rC}}(e),a=c.enterEvent,l=c.leaveEvent,u=c.changeEvent,d=[];r.forEach((function(e){s.callViewChangedEvent(a,e),s.eventEmitter.dispatch(a,d,e)})),o.forEach((function(e){s.callViewChangedEvent(l,e),s.eventEmitter.dispatch(l,d,e)})),s.eventEmitter.dispatch(u,{enterBlocks:r,leaveBlocks:o,viewportBlocks:i})},this.turnOnLockViewport=function(){return s.reconciler.turnOnLockViewport()},this.turnOffLockViewport=function(){return s.reconciler.turnOffLockViewport()},this.handlePaint=function(e){s.eventEmitter.dispatch(_e.w2),e.layoutRecalculatedNodes.forEach((function(e){s.eventEmitter.dispatch(_e.w,e,e)}))},this.handleScrollEnd=function(){s.eventEmitter.dispatch(_e.Jt,{viewportBlocks:s.getViewportBlocks(),bufferBlocks:s.getBufferBlocks()})},this.getForceActiveNodes=function(){return Array.from(s.additionalActiveBlocks)},this.getRemainActiveNodes=Object(ze.memoize)((function(){var e=[];return s.selectionAPI.getSelection().forEach((function(n){n.type===Mn.j.TEXT?e.push(n.id):s.model.traverseBlockModelByBlockId(n.id,(function(n){var r=s.model.getBlockModelByBlockId(n);return!!r&&(e.push(null===r||void 0===r?void 0:r.id),kr.e.includes(r.type))}))})),e}),(function(){return s.selectionAPI.getSelection().map((function(e){return e.id})).toString()})),this.handleModelCreate=function(e){var n=e.model;if((n.isRoot||!(n.position<0))&&(s.context.update(e.model,e),!s.batchingChangeNodes)){var r=s.context.flush();s.assignConfigForChangeNodes(r),s.addChangeNodesAndTryToSubmit(r,e.options.from===We.H.local)}},this.handleModelUpdate=function(e){if(!s.shouldSkipLayoutChanges(e)&&(function(e){var n=e.ops;return!n||n.some(Br)}(e)&&s.context.update(e.model,e),!s.batchingChangeNodes)){var n=s.context.flush();s.assignConfigForChangeNodes(n),s.addChangeNodesAndTryToSubmit(n,e.options.from===We.H.local)}},this.handleModelTypeChange=function(e,n,r){s.shouldSkipLayoutChanges(r)||(s.context.removeChildrenRecursively(n),s.context.update(e,r,!0),s.context.insertChildrenRecursively(e))},this.handleModelStructUpdate=function(e){if(!s.shouldSkipLayoutChanges(e)){var n=s.context,r=e.model,o=e.action;switch(o.type){case c.W.INSERT_CHILD:n.insertChild(r,o.child);break;case c.W.REMOVE_CHILD:n.removeChild(r,o.child);break;case c.W.CHANGE_CHILD_TYPE:s.handleModelTypeChange(o.child,o.oldChild,e)}}},this.handleResize=function(e){var n=e.editorWidth;s.editorWidth!==n&&(s.editorWidth=n,s.notifyHeaderHeightChange(),s.reconciler.handleRootWidthResize())},this.bindInitEvent("on")}return e=Object(bn.S)(e,void 0,4)||e,e=Object(c.VA)(e,void 0,3)||e,e=Object(be.h)(e,void 0,2)||e,e=Object(c.p)(e,void 0,1)||e,e=Object(ae.a)()(e,void 0,1)||e,e=Sr(e,void 0,0)||e,I()(e,[{key:"destroy",value:function(){this.bindInitEvent("off"),this.bindStartEvent("off"),this.throttleReportViewportLock.cancel(),this.reconciler.destroy(),this.context.destroy()}},{key:"start",value:function(e){var n,r=this,o=this.buildInitialLayoutConfig(),i=Object(Er.G)(),c=i.enableVirtualRender,a=i.enableIdleWorker,l=i.trackerStoreSize,s=br()(i,["enableVirtualRender","enableIdleWorker","trackerStoreSize"]),u=e.scroller,d=e.enableVirtualRender,f=void 0===d?c:d,h=e.enableIdleWorker,p=void 0===h?a:h,v=e.enableCheckViewportVisibility,g=e.overwriteDOMApi,b=e.getDeactiveNodeStyle,y=e.isSSR,m=e.errorFrom;this.enableVirtualRender=!!f,this.reportedMessageSet.clear(),this.bindStartEvent("on");var _=/disableSliceRender=true/.test(location.search||"");this.reconciler.init(Mr(Mr({rootId:this.model.rootBlockId},s),{},{overwriteDOMApi:g,getDeactiveNodeStyle:b,enableVirtualRender:f,enableIdleWorker:p,enableCheckViewportVisibility:v,enableSliceRender:!_&&Object(yr.getMinaConfig)("docx_bear_virtual_slice_render",!1),isSSR:y,scroller:u,layoutNodeConfigs:o,trackerStoreSize:null!==l&&void 0!==l?l:10,onBufferChanged:this.handleChangedEvent.bind(this,"buffer"),onViewportChanged:this.handleChangedEvent.bind(this,"viewport"),onPaint:this.handlePaint,onScrollEnd:this.handleScrollEnd,getForceActiveNodes:this.getForceActiveNodes,getRemainActiveNodes:this.getRemainActiveNodes,onLockNodeHeight:function(e){return r.nodeHeightLocker.lock(e)},onUnlockNodeHeight:function(e){return r.nodeHeightLocker.unlock(e)},onViewportLocked:function(){var e={from:m,lockedCount:0};return function(){r.eventEmitter.dispatch(_e.h),e.lockedCount+=1,r.throttleReportViewportLock(e,(function(){e.lockedCount=0}))}}(),onError:function(e,n,o){m&&Object(xr.t)(Mr({message:e.message,source:n,from:m,isFirst:r.reportedMessageSet.has(e.message)?0:1},o)),r.reportedMessageSet.add(e.message),console.error("reconciler onError",m,n,e,o)},onWarning:function(e,n,o){m&&Object(xr.t)(Mr({message:e.message,source:n,from:m,isFirst:r.reportedMessageSet.has(e.message)?0:1},o)),r.reportedMessageSet.add(e.message),console.warn("reconciler onWarning",m,n,e,o)}})),null===(n=this.reconciler.tracker)||void 0===n||n.injectUtils({getBlockType:function(e){try{var n,o=null===(n=r.model.getBlockModelByBlockId(e))||void 0===n?void 0:n.type;if(!o){if(Object(_r.c)(mr.S,e))return"split";if(Object(_r.c)(mr.b,e))return"table_row"}if(!o){var i,c=r.model.getCacheRecordIdByBlockId(e);if(c)return(null===(i=r.model.getRecordByRecordId(c))||void 0===i?void 0:i.snapshot.type)||""}return o||""}catch(a){}},getRecordId:function(e){try{var n;return(null===(n=r.model.getRecordByBlockId(e))||void 0===n?void 0:n.id)||""}catch(o){}}}),this.scroller=u}},{key:"waitForNextPaint",value:function(){var e=this;return new Promise((function(n){e.eventEmitter.addListenerOnce(_e.w2,n)}))}},{key:"getContext",value:function(){return this.context}},{key:"getReconciler",value:function(){return this.reconciler}},{key:"getScroller",value:function(){return this.scroller}},{key:"didUpdateNode",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o={action:_e.o.UPDATE},i=function e(i,c){var a=n.context.getLayoutNodeConfig(i);c.set(i.id,{nodeId:i.id,config:a,modifications:[o]}),n.context.iterateLayoutNodeChildren(i,(function(e,r){if(!r){var i=n.model.getBlockModelByBlockId(e);i&&(r=n.context.getLayoutNodeConfig(i))}c.set(e,{nodeId:e,config:r,modifications:[o]})})),r&&i.children.forEach((function(n){return e(n,c)}))},c=new Map,a=this.model.getBlockModelByBlockId(e);if(!a)throw new Error("[layout]: block model does NOT exist for id ".concat(e));i(a,c),this.addChangeNodesAndTryToSubmit(Array.from(c.values()))}},{key:"enterFoldIgnoreMode",value:function(){var e;return null===(e=this.context.fold)||void 0===e?void 0:e.enterIgnoreMode()}},{key:"exitFoldIgnoreMode",value:function(){var e;return null===(e=this.context.fold)||void 0===e?void 0:e.exitIgnoreMode()}},{key:"addChangeNodesAndTryToSubmit",value:function(e,n){var r;(r=this.changeNodes).push.apply(r,i()(e)),this.tryToSubmitChangeNodes(n)}},{key:"tryToSubmitChangeNodes",value:function(e){this.batchingChangeNodes||this.submitChangeNodes(e)}},{key:"submitChangeNodes",value:function(e){var n=this.changeNodes;n.length&&(this.changeNodes=[],this.reconciler.didChangeNodes(n,e))}},{key:"buildInitialLayoutConfig",value:function(){var e=new Map,n=this.context,r=this.model.rootBlockModel;if(!r)throw new Error("[layoutManager]: cannot find root block model for id: ".concat(this.model.rootBlockId));return function r(o){var i=n.getLayoutNodeConfig(o,!0);o.children.forEach(r);var c=[];n.iterateLayoutNodeChildren(o,(function(n,r){c.push(n),e.has(n)||e.set(n,r||{})})),e.set(o.id,Mr(Mr({},i),{},{childIds:c}))}(r),e}},{key:"bindInitEvent",value:function(e){var n=this.eventEmitter;"on"===e?(window.addEventListener("resize",this.handleWindowHeightChange),n.addListener(_e.v.ADD,this.handleAddAdditionalActiveBlock),n.addListener(_e.v.REMOVE,this.handleRemoveAdditionalActiveBlock)):(window.removeEventListener("resize",this.handleWindowHeightChange),n.removeListener(_e.v.ADD,this.handleAddAdditionalActiveBlock),n.removeListener(_e.v.REMOVE,this.handleRemoveAdditionalActiveBlock))}},{key:"shouldSkipLayoutChanges",value:function(e){var n=e.model,r=e.options;if(!n.isRoot&&n.position<0)return!0;var o=r||{},i=o.type;return!o.isInUndoRedo&&("flushInput"===i||"deleteBackward"===i)}},{key:"assignConfigForChangeNodes",value:function(e){var n,r=this.context,o=this.model,i=new Map,c=function(e){var n=i.get(e);if(n)return n;var c=o.getBlockModelByBlockId(e);return n=c?r.getLayoutNodeConfig(c):{},i.set(e,n),n},a=Tr(e);try{for(a.s();!(n=a.n()).done;){var l,s=n.value,u=Tr(s.modifications);try{for(u.s();!(l=u.n()).done;){var d=l.value;d.config||(d.action===_e.o.INSERT_CHILD&&d.childId?d.config=c(d.childId):d.action===_e.o.UPDATE_PARENT&&d.parentId&&(d.config=c(d.parentId)))}}catch(f){u.e(f)}finally{u.f()}s.config||(s.config=c(s.nodeId))}}catch(f){a.e(f)}finally{a.f()}}}]),e}(),fr=hr))||fr;function Pr(e){return e&&!e.show?_.j.IGNORE:_.j.VERTICAL}var Lr,Nr,Fr,Ur,Hr,Vr,Wr=Object(ae.s)(Sr)((Dr=function(){function e(n,r){var o=this;h()(this,e),this.nodeBuilders=n,this.editorContext=r,this.changeNodes=[],this.nodeBuilderMap=null,this.offBuilderListChange=void 0,this._fold=void 0,this.offBuilderListChange=n.onChange((function(){o.nodeBuilderMap=null}))}return e=Object(ge.a)(e,void 0,1)||e,e=Object(ae.a)()(e,void 0,1)||e,e=Object(E.I)(e,void 0,0)||e,e=Object(ae.e)()(e,void 0,0)||e,e=Object(ae.a)()(e,void 0,0)||e,I()(e,[{key:"destroy",value:function(){this.offBuilderListChange()}},{key:"flush",value:function(){var e=this.changeNodes;return this.changeNodes=[],e}},{key:"getChangeNode",value:function(e){var n=this.changeNodes,r=n[n.length-1];return r&&r.nodeId===e||(r={nodeId:e,modifications:[]},this.changeNodes.push(r)),r}},{key:"addModification",value:function(e,n){this.getChangeNode(e).modifications.push(n)}},{key:"insertChild",value:function(e,n,r){var o=this.getLayoutNodeBuilderByBlockType(e.type);if(null===o||void 0===o?void 0:o.insertChild){var i=this.getFoldState(e.id);o.insertChild(this,e,n,i)}else{var c=this.getChangeNode(e.id);this.insertChildRaw(c,n.position,n.id,r),this.insertChildrenRecursively(n)}}},{key:"insertChildrenRecursively",value:function(e){var n=this;e.children.forEach((function(r){n.insertChild(e,r)}))}},{key:"removeChild",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.position,o=this.getLayoutNodeBuilderByBlockType(e.type);if(null===o||void 0===o?void 0:o.removeChild){var i=this.getFoldState(e.id);o.removeChild(this,e,n,r,i)}else{var c=this.getChangeNode(e.id);this.removeChildRaw(c,r,n.id),this.removeChildrenRecursively(n)}}},{key:"removeChildrenRecursively",value:function(e){var n=this;e.children.forEach((function(r){n.removeChild(e,r,0)}))}},{key:"update",value:function(e,n,r){var o=this.getLayoutNodeBuilderByBlockType(e.type);(null===o||void 0===o?void 0:o.update)?o.update(this,e,n,r):this.updateRaw(this.getChangeNode(e.id),r)}},{key:"insertChildRaw",value:function(e,n,r,o){e.modifications.push({childId:r,index:n,action:_e.o.INSERT_CHILD,config:o})}},{key:"removeChildRaw",value:function(e,n,r){e.modifications.push({childId:r,index:n,action:_e.o.DELETE_CHILD})}},{key:"updateRaw",value:function(e,n){e.modifications.push({action:_e.o.UPDATE,subTreeDirty:n})}},{key:"getLayoutNodeConfig",value:function(e,n){var r=this.getLayoutNodeBuilderByBlockType(e.type),o=this.getFoldState(e.id);if(null===r||void 0===r?void 0:r.getLayoutNodeConfig){var i=r.getLayoutNodeConfig(e,o,n);return i.calculateModel||(i.calculateModel=Pr(o)),i}return{calculateModel:Pr(o)}}},{key:"iterateLayoutNodeChildren",value:function(e,n){var r=this.getLayoutNodeBuilderByBlockType(e.type);(null===r||void 0===r?void 0:r.iterateLayoutNodeChildren)?r.iterateLayoutNodeChildren(e,this.getFoldState(e.id),n):e.children.forEach((function(e){return n(e.id)}))}},{key:"getLayoutNodeBuilderByBlockType",value:function(e){return this.nodeBuilderMap||(this.nodeBuilderMap=new Map(this.nodeBuilders.get().map((function(e){return[e.type,e]})))),this.nodeBuilderMap.get(e)}},{key:"getFoldState",value:function(e){var n;return null===(n=this.fold)||void 0===n?void 0:n.getFoldStateById(e)}},{key:"fold",get:function(){var e;this._fold||(this._fold=null===(e=this.editorContext.get())||void 0===e?void 0:e.fold);return this._fold}}]),e}(),jr=Dr))||jr;function zr(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var Gr=(Lr=Object(ae.a)(),Vr=function(e){v()(r,e);var n=zr(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),$()(e,"layoutManager",Fr,te()(e)),$()(e,"config",Ur,te()(e)),$()(e,"context",Hr,te()(e)),e.configChangeSub=void 0,e}return I()(r,[{key:"init",value:function(){var e=this;T()(m()(r.prototype),"init",this).call(this),this.configChangeSub=this.config.change$.subscribe((function(){e.notifyAllBlockViewsToReRender()}))}},{key:"destroy",value:function(){var e;T()(m()(r.prototype),"destroy",this).call(this),null===(e=this.configChangeSub)||void 0===e||e.unsubscribe(),this.layoutManager.destroy()}},{key:"mount",value:function(e){var n=this.isMounted();T()(m()(r.prototype),"mount",this).call(this,e),n||this.layoutManager.start(Object.assign({scroller:this.config.get("scroller")},this.options.layoutConfig))}},{key:"renderChildren",value:function(e,n){var r=this.modelService.getBlockModelByBlockId(e);return r?A.a.createElement(pr,{blockModel:r,renderProps:n,layoutManager:this.layoutManager,editorAPI:this.editorAPI}):null}},{key:"_createRenderElement",value:function(e){var n=this.getBlockRegisterOptions(e.model.type);e.options=n;var r=this.options.BlockContextProvider;return r?r(A.a.createElement(vr.r,e)):A.a.createElement(vr.r,e)}},{key:"_mountRootBlockAtContainer",value:function(){var e=this.options.RootBlockContextProvider;e?l.a.render(e(this.render(this.rootBlockId,{})),this._container):T()(m()(r.prototype),"_mountRootBlockAtContainer",this).call(this)}},{key:"_getRootBlockProps",value:function(e){var n=T()(m()(r.prototype),"_getRootBlockProps",this).call(this,e),o=this.config.toPlainObject(),i=this.context.get().toPlainObject();return Object(ze.assign)(n,{recursionProps:Object(ze.assign)(i,o,n.recursionProps)})}}],[{key:"getProviders",value:function(){return[Ar,Wr].concat(i()(sr.OB.getProviders()))}}]),r}(sr.OB),Nr=Vr,Fr=re()(Nr.prototype,"layoutManager",[se.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ur=re()(Nr.prototype,"config",[c.j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Hr=re()(Nr.prototype,"context",[Lr,ge.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Nr);function Kr(e){var n=e.rootInjector,r=e.config,o=e.modules,l=e.rendererOptions,f=e.isPresentationMode,h=e.suspenseOptions,p=(void 0===h?{}:h).blankBlockModule||V;return new c.u({rootInjector:n,logger:{log:d.S},config:r,createRecordToken:function(){return Object(u.t)()},transactionWrapper:a.unstable_batchedUpdates,isSuspenseRecord:function(e){var n=e.snapshot.type;return n===S.B.BLANK||n===S.B.PENDING},fallbackBlockType:S.B.FALLBACK,suspenseBlockType:S.B.BLANK,modules:[Object(c.Y)(p),Object(c.Y)(W.FallbackBlockReactModule),Object(c.Y)(Mt),Object(c.Y)(Xt),Object(c.Y)(tn),f?Object(c.Y)(gn):Object(c.Y)(Ne),Object(c.Y)(ht),Object(c.Y)(k.RecordSnapshotFactoryModule),Object(c.Y)(lr),Object(c.Y)(Xn),Object(c.Y)(Z)].concat(i()(o)),renderer:[Gr,Object.assign({ErrorBoundary:s.s},l)]})}},dx_Yuai:function(e,n,r){"use strict";r.d(n,"Y",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("translation")},dx_YxRU:function(e,n,r){},dx_Yz4Z:function(e,n,r){"use strict";r.d(n,"S",(function(){return c}));var o=r("dx_cDcd");function i(){var e=Object(o.useRef)({unmount:!1});return Object(o.useLayoutEffect)((function(){return function(){Object.assign(e,{unmount:!0})}}),[]),e}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3/60,n=Object(o.useRef)(null),r=i();return Object(o.useEffect)((function(){var o=setTimeout((function(){!r.current.unmount&&n.current&&(n.current.focus({preventScroll:!0}),n.current.select())}),e);return function(){clearTimeout(o)}}),[]),n}},dx_YzVl:function(e,n,r){"use strict";r.d(n,"F",(function(){return i}));var o=r("dx_PcQO"),i=(r("dx_Y5RM"),r("dx_Z8Z0"),function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.dom,i=void 0===r?null:r,c=e.type;n&&o.toast.destroy();var a=function(){return i&&i.closest(".card")||document.body};return o.toast.config({getContainer:a}),o.toast[c](e)});i.destroy=o.toast.destroy,i.config=o.toast.config},dx_Z04Z:function(e,n,r){"use strict";r.d(n,"m",(function(){return f}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_e4eN"),s=r("dx_C7Cb"),u=r("dx_rCbK"),d=r("dx_x2xb"),f=function(){var e=a()(i.a.mark((function e(n){var r,o,c,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.block,o=n.blockManager,c=n.range,f=n.mentionOptions,e.next=3,o.applyTransaction("replaceSlashToAt",(function(e){var n=new l.m({zoneId:r.model.zoneId}).retain(c.start).delete(c.len).insert("@");r.model.apply(n,{extra:{op:e}})}));case 3:r.model.setSelection({start:c.start+1,len:0},!0),setTimeout(a()(i.a.mark((function e(){var n,a,l,h;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(s.S)(),a=r.model.zoneState,l={start:a.offsetToPoint(c.start),end:a.offsetToPoint(c.start+1)},e.next=5,r.model.toggleMark({trigger:n},l);case 5:(h=r.hostElement.querySelector(".trigger-holder-".concat(n)))&&o.dispatch(u.X,{identifier:d.A.mentionAt,target:h,uuid:n,options:f});case 7:case"end":return e.stop()}}),e)}))));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},dx_Z1S2:function(e,n,r){"use strict";(function(t){r.d(n,"n",(function(){return o})),r.d(n,"w",(function(){return a}));var e,o,i=r("dx_lSNA"),c=r.n(i);!function(e){e[e.local_file_is_not_exist=1001]="local_file_is_not_exist",e[e.no_network=1007]="no_network",e[e.no_permission=2004]="no_permission",e[e.file_is_deleted=3002]="file_is_deleted",e[e.overload=13001]="overload"}(o||(o={}));var a=(e={},c()(e,o.local_file_is_not_exist,t("CreationMobile_Upload_Error_File_Deleted_Tips")),c()(e,o.file_is_deleted,t("CreationMobile_Upload_Error_File_Deleted_Tips")),c()(e,o.overload,t("common.sp_storage_usage_limitation_body")),c()(e,o.no_permission,t("drive.upload_drag_tip_no_permission")),c()(e,o.no_network,t("common.upload_fail_network")),e)}).call(this,r("dx_E9Eu"))},dx_Z22N:function(e,n,r){"use strict";var o=r("dx_MhLi");r.d(n,"I",(function(){return o.I}))},dx_Z50P:function(e,n,r){"use strict";r.d(n,"W",(function(){return u}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;if(a()(this,e),this.concurrency=n,this._waiting=0,this._active=0,this._ended=0,this._started=!1,this._tasks=[],this._data=void 0,this._error=void 0,this._call=void 0,"number"!==typeof n||n<1)throw new Error("invalid concurrency")}return s()(e,null,[{key:"create",value:function(n){return new e(n)}}]),s()(e,[{key:"defer",value:function(e){if("function"!==typeof e)throw new Error("invalid task");if(this._call)throw new Error("can not defer after await");if(this._error)return this;for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return r.push(e),this._waiting++,this._tasks.push(r),this._poke(),this}},{key:"abort",value:function(){return this._error||this._abort(new Error("abort")),this}},{key:"await",value:function(e){if("function"!==typeof e)throw new Error("invalid callback");if(this._call)throw new Error("multiple await not allowed");return this._call=function(n,r){e.apply(null,[n].concat(i()(r)))},this._done(),this}},{key:"awaitAll",value:function(e){if("function"!==typeof e)throw new Error("invalid callback");if(this._call)throw new Error("multiple await not allowed");return this._call=e,this._done(),this}},{key:"_start",value:function(){for(this._started=!!this._waiting&&this._active<this.concurrency;this._started;){var e=this._ended+this._active,n=this._tasks[e],r=n.length-1,o=n[r];n[r]=this._end(e),this._waiting--,this._active++,n=o.apply(void 0,i()(n)),this._started=!!this._waiting&&this._active<this.concurrency,this._tasks[e]&&(this._tasks[e]=n||{})}}},{key:"_poke",value:function(){if(!this._started)try{this._start()}catch(e){if(this._tasks[this._ended+this._active-1])this._abort(e);else if(!this._data)throw e}}},{key:"_end",value:function(e){var n=this;return function(r,o){n._tasks[e]&&(n._active--,n._ended++,n._tasks[e]=null,n._error||(r?n._abort(r):(n._data=n._data||[],n._data[e]=o,n._waiting?n._poke():n._done())))}}},{key:"_abort",value:function(e){this._error=e,this._data=void 0,this._waiting=NaN;for(var n=this._tasks.length;n>=0;){var t=this._tasks[n];if(t&&(this._tasks[n]=null,t.abort))try{t.abort()}catch(r){}n--}this._active=NaN,this._done()}},{key:"_done",value:function(){if(!this._active&&this._call){var e=this._data;this._data=void 0,this._call(this._error||null,e||[])}}}]),e}()},dx_Z7ZC:function(e,n,r){"use strict";r.d(n,"i",(function(){return v})),r.d(n,"P",(function(){return g})),r.d(n,"c",(function(){return b})),r.d(n,"I",(function(){return y})),r.d(n,"w",(function(){return m})),r.d(n,"K",(function(){return _})),r.d(n,"b",(function(){return k})),r.d(n,"s",(function(){return O})),r.d(n,"a",(function(){return x}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_GSgQ"),s=r("dx_QxNg"),u=r("dx_alfx"),d=r("dx_vdIl"),f=r("dx_AMht");function h(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return p(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function p(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function v(e,n,r){var o=n.snapshot.text,i=(null===r||void 0===r?void 0:r.apool)||o.apool,c=(null===r||void 0===r?void 0:r.zone_changesets)||o.initialAttributedTexts.text,l=null===r||void 0===r?void 0:r.toChangeSetOptions,s=Object(u.z)({deltaSet:e,apool:i,texts:c,options:l});return{zone_changesets:a()({},d.x,s),apool:i}}function g(e){var n=e.subType.o,r=n.zone_changesets,o=n.apool;return Object(u.b)(r[d.x],o)}function b(e,n){for(var r={},o=0,c=new Set,a=Object.keys(e.deltas),l=Object.values(e.deltas),s=0;s<a.length;s++){var u,d=h(l[s].ops);try{for(d.s();!(u=d.n()).done;){var f=u.value;if(f.attributes)for(var p=0,v=Object.entries(f.attributes);p<v.length;p++){var g=i()(v[p],2),b=g[0],y=g[1];if(!(null===n||void 0===n?void 0:n.filterLocalAttributes)||!b.startsWith("clientside-")){var m="".concat(b,",").concat(y);c.has(m)||(c.add(m),r[o++]=[b,y])}}}}catch(_){d.e(_)}finally{d.f()}}return{numToAttrib:r,nextNum:o}}function y(e){return"subType"in e&&"easysync"===e.subType.t}function m(e,n,r){if(f.S.lineEditable){var o=function(e){return l.g.convertToEasysyncOp(e)}(new s.s1(n).replace(["text"],r).ops[0]);e.edit(n.id,["text"],o.subType.o)}else e.replace(n.id,["text"],r)}function _(e){return e?e.replace(/\$([\s\S]*)/g,(function(e){return"$".concat(e.length-1)})):"none"}function k(e){return Object.values(e).map((function(e){return e[0].slice(0,10)})).join(",")}function O(e){var n=[];return e.forEach((function(e){var r=e.ops.map((function(e){return Object.keys(e).map((function(n){var r,o;switch(n){case"insert":o=null===(r=e[n])||void 0===r?void 0:r.length;break;case"delete":case"retain":o=e[n];break;default:o="***"}return"".concat(n,":").concat(o)})).join(" ; ")})).join(" | ");n.push(r)})),n.join(" == ")}function x(e){return/\r/.test(e)}},dx_Z7aw:function(e,n,r){"use strict";r.d(n,"N",(function(){return v})),r.d(n,"B",(function(){return b})),r.d(n,"u",(function(){return m})),r.d(n,"Q",(function(){return k})),r.d(n,"NM",(function(){return x}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_o0o1"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_AAGW"),d=r("dx_D3DW"),f=r("dx_uLXv");function h(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function p(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?h(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function v(e){return g.apply(this,arguments)}function g(){return(g=s()(a.a.mark((function e(n){var r,o,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.todo_guids,o=n.doc_token,Object(d.i)("getDocxTodos: request",{todo_guids:r,doc_token:o}),e.prev=2,e.next=5,u.S.post("/task/api/details",{doc_token:o,todo_guids:r},{baseURL:"/",keep:!0});case 5:return i=e.sent,c=i.data,Object(f.K)(c.docx_todos,c.docx_todo_users),Object(d.i)("getDocxTodos: response",c),e.abrupt("return",{data:c});case 12:return e.prev=12,e.t0=e.catch(2),e.abrupt("return",{error:e.t0});case 15:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}function b(e){return y.apply(this,arguments)}function y(){return(y=s()(a.a.mark((function e(n){var r,o,c,l,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.new_docx_todo,o=n.doc_token,c=n.doc_block_id,Object(d.i)("createDocxTodo: request",{new_docx_todo:r,doc_token:o,doc_block_id:c}),e.prev=2,e.next=5,u.S.post("/task/api/createDocxTodo",{doc_block_id:c,doc_token:o,new_docx_todo:r},{baseURL:"/"});case 5:return l=e.sent,s=l.data,Object(f.K)(i()({},s.saved_docx_todo.guid,s.saved_docx_todo),s.docx_todo_users),Object(d.i)("createDocxTodo: response",s),e.abrupt("return",{data:s});case 12:return e.prev=12,e.t0=e.catch(2),e.abrupt("return",{error:e.t0});case 15:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}function m(e){return _.apply(this,arguments)}function _(){return(_=s()(a.a.mark((function e(n){var r,o,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.docx_todos,o=n.doc_token,Object(d.i)("updateDocxTodos: request",{docx_todos:r,doc_token:o}),e.prev=2,e.next=5,u.S.post("/task/api/updateDocxTodos",{docx_todos:r,doc_token:o},{baseURL:"/"});case 5:return i=e.sent,c=i.data,Object(f.K)(c.saved_docx_todos,c.docx_todo_users),Object(d.i)("updateDocxTodos: response",c),e.abrupt("return",{data:c});case 12:return e.prev=12,e.t0=e.catch(2),e.abrupt("return",{error:e.t0});case 15:case"end":return e.stop()}}),e,null,[[2,12]])})))).apply(this,arguments)}function k(e){return O.apply(this,arguments)}function O(){return(O=s()(a.a.mark((function e(n){var r,o,i,c,l,s,f,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.todo_guid,o=n.old_doc_token,i=n.new_doc_token,c=n.old_block_id,l=n.new_block_id,s=n.operation,Object(d.i)("authDocxTodoPermission: request",{todo_guid:r,old_doc_token:o,new_doc_token:i,old_block_id:c,new_block_id:l,operation:s}),e.prev=2,e.next=5,u.S.post("/task/api/authDocxTodoPermission",{todo_guid:r,old_doc_token:o,new_doc_token:i,old_block_id:c,new_block_id:l,operation:s},{baseURL:"/"});case 5:return f=e.sent,h=f.data,Object(d.i)("authDocxTodoPermission: response",h),e.abrupt("return",{data:h});case 11:return e.prev=11,e.t0=e.catch(2),e.abrupt("return",{error:e.t0});case 14:case"end":return e.stop()}}),e,null,[[2,11]])})))).apply(this,arguments)}function x(e){return E.apply(this,arguments)}function E(){return(E=s()(a.a.mark((function e(n){var r,o,c,l,s,d,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.recoverGuids,o=void 0===r?[]:r,c=n.deletedGuids,l=void 0===c?[]:c,s=n.docToken,e.prev=1,e.next=4,u.S.post("/task/api/updateDocxTodos",{docx_todos:Object.assign({},o.reduce((function(e,n){return p(p({},e),i()({},n,{guid:n,is_deleted:!1}))}),{}),l.reduce((function(e,n){return p(p({},e),i()({},n,{guid:n,is_deleted:!0}))}),{})),doc_token:s},{baseURL:"/"});case 4:return d=e.sent,f=d.data,e.abrupt("return",{data:f});case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return",{error:e.t0});case 12:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}},dx_Z7uL:function(e,n,r){},dx_Z8Z0:function(e,n,r){},dx_Z8yN:function(e,n,r){"use strict";(function(t){r.d(n,"N",(function(){return a})),r.d(n,"W",(function(){return l})),r.d(n,"jN",(function(){return s})),r.d(n,"F",(function(){return u})),r.d(n,"g",(function(){return d})),r.d(n,"O",(function(){return f})),r.d(n,"O7",(function(){return h})),r.d(n,"j",(function(){return p})),r.d(n,"J",(function(){return e})),r.d(n,"b",(function(){return v})),r.d(n,"V",(function(){return g})),r.d(n,"p",(function(){return b}));var e,o=r("dx_lSNA"),i=r.n(o),c=r("dx_B28d"),a="j-drag-cls",l="DROP_CHANGE",s="DROP_END",u="DRAG_STATUS_CHANGE",d="dragging",f=8,h=40,p=10;!function(e){e.REFUSE_BITABLE_IN_GRID="REFUSE_BITABLE_IN_GRID"}(e||(e={}));var v=i()({},e.REFUSE_BITABLE_IN_GRID,t("CreationDoc_DocX_insert_bitable_column_failed_toast")),g=[c.B.PROGRESS,c.B.CELL],b=[c.B.OKR,c.B.OBJECTIVE,c.B.KEY_RESULT,c.B.PROGRESS]}).call(this,r("dx_E9Eu"))},dx_ZEh2:function(e,n,r){"use strict";function o(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(function(e,n){return String.fromCharCode("0x".concat(n))})))}function i(e){return decodeURIComponent(atob(e).split("").map((function(e){return"%".concat("00".concat(e.charCodeAt(0).toString(16)).slice(-2))})).join(""))}r.d(n,"R",(function(){return o})),r.d(n,"N",(function(){return i}))},dx_ZG9w:function(e,n,r){"use strict";r.d(n,"U",(function(){return T})),r.d(n,"f",(function(){return w})),r.d(n,"i",(function(){return R})),r.d(n,"R6",(function(){return M})),r.d(n,"R",(function(){return j})),r.d(n,"fq",(function(){return P})),r.d(n,"M0",(function(){return L})),r.d(n,"S",(function(){return N})),r.d(n,"W",(function(){return F})),r.d(n,"Z",(function(){return U})),r.d(n,"j",(function(){return H})),r.d(n,"u",(function(){return V})),r.d(n,"Wk",(function(){return W})),r.d(n,"F",(function(){return z})),r.d(n,"T",(function(){return G})),r.d(n,"w",(function(){return q})),r.d(n,"I",(function(){return X})),r.d(n,"Q",(function(){return Y})),r.d(n,"y",(function(){return J})),r.d(n,"M",(function(){return Z}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_J4zp"),d=r.n(u),f=r("dx_e4eN"),h=r("dx_alfx"),p=r("dx_h6a8"),v=r("dx_MoY1"),g=r("dx_B28d"),b=r("dx_IdzY"),y=r("dx_zghO"),m=r("dx_IVxn"),_=r("dx_UTG8"),k=r("dx_I11I"),O=r("dx_FHaN"),x=r("dx_gDjg"),E=r("dx_n4v0");function S(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function C(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?S(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function I(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return B(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return B(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function B(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function T(e){return e&&Reflect.get(e,"isTextEditable")}function w(e){return Reflect.has(e,"editor")&&e.editor}function R(e){return e.isTextBlock}function M(e){return g.hI.includes(e.type)}function j(e,n,r){return D.apply(this,arguments)}function D(){return(D=s()(i.a.mark((function e(n,r,o){var c,a,l,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=o.getBlockModelByBlockId(r.id),(a=c.nextSibling)&&T(o.getBlockViewByBlockId(a.id))){e.next=7;break}return e.next=5,o.applyTransaction("insertTextBlock",(function(e){var n=Object(v.l)(e,c.parent.recordId,c.position+1,[Object(E.D)({},g.B.TEXT)]),r=d()(n,1);s=r[0]})).then((function(){var e=o.getBlockIdsByRecordId(s),n=d()(e,1);l=n[0]}));case 5:e.next=8;break;case 7:l=a.id;case 8:o.hasBlockViewByBlockId(l)&&n.setSelection([{id:l,type:y.j.TEXT,selection:{start:0,end:0}}]);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=[k.B];function P(e,n){var r,o=I(A);try{for(o.s();!(r=o.n()).done;){var i=r.value;_.InputPipe.replaceMark(e,i,n)}}catch(c){o.e(c)}finally{o.f()}}function L(e){return!(!e.text||!e.text.apool)}function N(e){return!(!e.text||!e.text.apool)}function F(e){return U(e.text)}function U(e){var n=[];return _.InputPipe.eachMarkByKey(e,k.B,(function(e){return n.push(e)})),n}function H(e,n){var r=[];return _.InputPipe.eachMarkByKey(e,O.O,(function(e){var o;try{o=JSON.parse(e)}catch(i){return void console.error("ignore illegal inline component: ",e,i)}n.includes(o.type)&&r.push(o)})),r}function V(e){return H(e,[O.k.FILE]).map((function(e){return e.data}))}function W(e,n,r,o){var i=Object(v.s)(e,n,o);return F(o).forEach((function(n){return e.replace(n,["parent_id"],i)})),e.insertChildren(n,r,[i]),i}function z(e){return e.totalWidth()-1}function G(e){var n=e.getModelText();return n.substring(0,n.length-1)}function K(e,n){var r=e.getLine(n.start.line),o=n.start;if(n.start.offset<r.length()){var i=e.pointToOffset(n.start);if(!i)return{};o=e.offsetToPoint(i+1)}return e.getAttributes(n.start,o).toMap()}function q(e,n){var r=e.zoneState,o=r.getLine(n.start.line);if(!o)return{};var i=o.getLineMarker(),c=n.start,a=n.start;i===n.start.offset&&o.length()>i+1?a=C(C({},n.start),{},{offset:n.start.offset+1}):n.start.offset>i&&(c=C(C({},n.start),{},{offset:n.start.offset-1}));var l=K(r,n);return e.getAttributes(c,a).filter((function(n){var r,o=d()(n,2),i=o[0],c=o[1];if(!1===(null===(r=e.schema.get(i))||void 0===r?void 0:r.tailInherit)&&l[i]!==c)return!1;return!0})).reduce((function(e,n){var r=d()(n,2),o=r[0],i=r[1];return e[o]=i,e}),{})}function X(e,n){var r=e.getZoneState(n.start.zoneId);if(!r)return{};var o=r.getLine(n.start.line);if(!o)return{};var i=o.getLineMarker(),c=n.start,a=n.start;i===n.start.offset&&o.length()>i+1?a=C(C({},n.start),{},{offset:n.start.offset+1}):n.start.offset>i&&(c=C(C({},n.start),{},{offset:n.start.offset-1}));var l=K(r,n);return e.getAttributes(c,a).filter((function(n){var r,o=d()(n,2),i=o[0],c=o[1];if(!1===(null===(r=e.schema.get(i))||void 0===r?void 0:r.tailInherit)&&l[i]!==c)return!1;return!0})).reduce((function(e,n){var r=d()(n,2),o=r[0],i=r[1];return e[o]=i,e}),{})}function Y(e,n){return e.reduce((function(e,r){return n.some((function(n){var o,i,c=r.insert&&(null===(o=r.attributes)||void 0===o?void 0:o[n]),a=e[e.length-1],l=(null===a||void 0===a?void 0:a.insert)&&(null===a||void 0===a||null===(i=a.attributes)||void 0===i?void 0:i[n]);return!(!l||!Object(p.isString)(a.insert)||l!==c)&&(a.insert=a.insert+r.insert,!0)}))||e.push(r),e}),[])}function J(e,n){var r;if(e){var o=e.model.zoneId,i=null===(r=e.model.getSelection())||void 0===r?void 0:r.toPosition();if(i&&i.len>0){var c=new f.m({zoneId:o}).retain(i.start).delete(i.len);e.model.apply(c,{extra:{op:n}})}}}function Z(e,n){var r=e.apool,o=e.initialAttributedTexts;if(!Object.values(r.numToAttrib).some((function(e){return e[0]===O.O})))return e;var i=Object(h.Z)(o,r);return i.get(b.x).ops.forEach((function(e){if(e.attributes){var r=e.attributes[O.O];if(r)try{var o=JSON.parse(r),i=o.data;if(o.type!==O.k.DOC)return;var c=i.file_type,a=i.title,l=i.token;n.embedObjManager.checkApplyEmbed(l,c,a);var s=Object(x.n)(n);if(Object(x.P)(s,l)){var u=Object.keys(e.attributes).reduce((function(n,r){return r!==O.O&&(n[r]=e.attributes&&e.attributes[r]),n}),{});e.attributes=u,e.insert=a}}catch(d){return}}})),Object(m.f)(i)}},dx_ZMwq:function(e,n,r){"use strict";var o;r.d(n,"E",(function(){return o})),function(e){e.Simple="simple",e.Intact="intact"}(o||(o={}))},dx_ZRMu:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{opacity:.01,fill:"#D8D8D8",d:"M10.666 8.667h76.667v76.667H10.666z"}),l=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.334 70.667H74V20H12.334v50.667z",fill:"#D6DAE1"}),s=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M65.667 32.987L60.22 68l-42.887-6.653 5.446-35.014 42.887 6.654z",fill:"#F4F5F9"}),u=i.a.createElement("path",{d:"M26.667 57.667l3-25.334M31 58.333L34 33",stroke:"#fff",strokeWidth:.8}),d=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M85.422 62.758c-1.627 11.955-12.6 20.322-24.509 18.688-11.908-1.634-20.242-12.65-18.614-24.604 1.627-11.956 12.6-20.322 24.508-18.689 11.908 1.635 20.242 12.65 18.615 24.605z",fill:"#FFC200"}),f=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.433 20.377h18.5v-8.326h-18.5v8.326z",fill:"#B5BEC8"}),h=i.a.createElement("path",{d:"M47.938 58.22s15.683 14.917 32.192 0M54.128 62.778l-2.889 5.386M64.034 65.264v6.63M73.526 63.192l4.127 4.558",stroke:"#18263C",strokeWidth:.8,strokeLinecap:"round",strokeLinejoin:"round"});n.S=function(e){return i.a.createElement("svg",c({width:88,height:88,viewBox:"0 0 88 88",fill:"none"},e),a,l,s,u,d,f,h)}},dx_ZTLK:function(e,n,r){"use strict";r.d(n,"S",(function(){return L}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_RIqP"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_W7W2"),v=r.n(p),g=r("dx_a1gu"),b=r.n(g),y=r("dx_Nsbk"),m=r.n(y),_=r("dx_yzqx"),k=r("dx_xs2W"),O=r("dx_zUqt"),x=r("dx_BrJR"),E=r("dx_wTwg"),S=r("dx_WXfY"),C=r("dx_ZG9w"),I=r("dx_kZ3l"),B=r("dx_zghO"),T=r("dx_G2Gn"),w=r("dx_tVvo"),R=r("dx_Vkod"),M=r("dx_Vmrz"),j=r("dx_n3n9"),D=r("dx_HirW"),A=r("dx_Y27Y");function P(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var L=function(e){v()(r,e);var n=P(r);function r(){var e;d()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).format=A.L.TEXT,e.markdownParser=new M.k(e.blockManager,e.headingModule),e.tryTransformText=function(n,r,o){var i=e.blockManager.getBlockViewByBlockId(n);if(!i.isRoot&&Object(C.f)(i)){o||(o={zoneId:i.model.zoneId,start:0,len:r.length});var c=!0;Object(x.l)(i)||Object(k.zp)(r)&&(c=e.tryTransformToISV(i,r,o)),c&&e.selectionAPI.setSelection([{id:i.id,type:B.j.TEXT,selection:{start:o.start+o.len,end:o.start+o.len}}])}},e.tryTransformToISV=function(n,r,o){if(Object(k.zp)(r)){var i=T.S.getBlockitModule();return i&&(null===i||void 0===i||i.pasteBlock(r,{uuid:Object(O.k)()},e.blockManager.getRootRecordId()).then((function(i){var c=[o.start,o.start+o.len+r.length];return n.model.replaceText(c,{text:"",mark:{}}),Object(E.C)({blockManager:e.blockManager,block:n,range:c,blockEntity:i})}))),!1}return!0},e}return h()(r,[{key:"shouldCopy",value:function(){return!0}},{key:"shouldPaste",value:function(e,n){return!0}},{key:"onCopyBlock",value:function(e){return e.id}},{key:"onCopy",value:function(e,n,r){var o=this,i=s()(r),c={},a=null;r=r.filter((function(e){return e.id!==o.rootBlockId||(a=e,!1)}));var l="";if(a){var u=this.blockManager.getBlockViewByBlockId(this.rootBlockId),d=this.blockManager.getBlockModelByBlockId(this.rootBlockId);l=Object(S.Z)(d,this.blockManager.recordManager,Object(I.S)(u.model.getSelection()))}if(this.selectionAPI.isTextSelectionAcrossBlocks(r)){var f=Object(R.d)(this.blockManager,r),h=f.rangeMap,p=f.newSelectedBlockIds;c=h,r=r.reduce((function(e,n){return p.includes(n.id)&&e.push({id:n.id,type:B.j.BLOCK}),e}),[])}var v=this.markdownParser.stringify(r.map((function(e){return e.id})),r,Object(R.V)(this.blockManager,this.selectionAPI,r,c),Object(R.p)(this.blockManager,this.selectionAPI,i));return l&&(v=l+(v?"\n".concat(v):"")),_.S.isAndroid&&""===v&&(v=" "),v}},{key:"onPaste",value:function(){var e=a()(i.a.mark((function e(n,r,o){var c,a,l,s,u=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=n[0],a=c.id,l=this.blockManager.getBlockViewByBlockId(a),Object(C.U)(l)){e.next=5;break}return e.abrupt("return");case 5:r=Object(D.K)(r),s=Object(D.j)(r,l),Object(w.s)(Object.assign({},this.options,{proxyClipboardData:o}),s,this.format,{onDataApply:function(e){var n=e.applyRecordIds,o=e.range,i=n.map((function(e){return u.blockManager.getBlockIdsByRecordId(e)[0]}));1===n.length&&u.tryTransformText(i[0],r,o)}},!1);case 8:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"rootBlockId",get:function(){return this.blockManager.rootBlockId}}]),r}(j.S)},dx_ZViv:function(e,n,r){"use strict";r.d(n,"r",(function(){return i}));var o=r("dx_B28d");function i(e,n,r){var i=n.find((function(e){var n;return(null===(n=r[e])||void 0===n?void 0:n.snapshot.type)===o.B.ORDERED}));if(i){var c=r[i];if(!(!!c.snapshot.seq&&"auto"!==c.snapshot.seq)){var a=String(e.orderMap.get(c.id))||"1";c.snapshot.seq=a}}}},dx_ZVwH:function(e,n,r){"use strict";r.d(n,"y",(function(){return y}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_LcNA"),s=r("dx_V90V"),u=r("dx_TSYQ"),d=r.n(u),f=r("dx_cDcd"),h=r.n(f),p=r("dx_CqjN"),v=r("dx_Orag"),g=r("dx_Cg1F"),b=r("dx_Bs0J");function y(){var e,n=Object(f.useContext)(b.o),r=Object(f.useState)(!1),o=a()(r,2),c=o[0],u=o[1],y=n,m=y.placeholder,_=y.block,k=y.taskData,O=Object(f.useCallback)((function(){return u(!0)}),[]),x=Object(f.useCallback)((function(){return u(!1)}),[]);Object(f.useEffect)((function(){return _.editorInstance.on(l.L.COMPOSITION_START,O),_.editorInstance.on(l.L.COMPOSITION_END,x),function(){_.editorInstance.off(l.L.COMPOSITION_START,O),_.editorInstance.off(l.L.COMPOSITION_END,x)}}),[_]);var E=function(){var e=_.editorInstance;if(e){var n=e.selection.getSelection(),r=e.selection.toDOMRange(n);e.selection._updateDOMSelection(r)}},S=Object(p.i)({onClick:function(){return E()}});return!c&&m&&_.editorInstance.isEmpty()?h.a.createElement(s.S,null,h.a.createElement("span",{className:d()({"task-block-editor-placeholder":!0}),onMouseDown:E,onTouchStart:S,onTouchEnd:S,onTouchMove:S},m,h.a.createElement("span",{className:d()((e={},i()(e,"task-block-line-through-wrapper",!0),i()(e,v.y,Object(g.G)(k)),e))}))):null}},dx_ZXpo:function(e,n,r){"use strict";(function(t){r.d(n,"t",(function(){return f}));var e=r("dx_cDcd"),o=r.n(e),i=r("dx_faye"),c=r.n(i),a=r("dx_xlCA"),l=r("dx_xPLQ"),s=r("dx_Cg1F"),u=r("dx_z4Mb"),d=r("dx_VKNB");function f(e){var n=e.blockManager,r=e.selectionAPI,i=e.target,f=e.boundary,h=e.assignees,p=e.onChange,v=e.blockId,g=e.onVisibleChange;g(!0);var b=Object(d.p)(),y=function(){g(!1),c.a.unmountComponentAtNode(b)};c.a.render(o.a.createElement(u.Z,{blockManager:n,selectionAPI:r,target:i,boundary:f,onClose:y,onSelect:function(e){var r;if(y(),e){var o=e.entity,i=o.id,c=o.name,u=void 0===c?"":c,d=null===(r=n.getBlockViewByBlockId(v))||void 0===r?void 0:r.hostElement;a.n.getCache(i)||a.n.setCache(i,{name:u}),p(Object(s.n)(h,!0,i)),setTimeout((function(){var e;null===d||void 0===d||null===(e=d.querySelector(".task-block--addUserTabKey"))||void 0===e||e.focus({preventScroll:!0})})),d&&Object(l.G)({id:e.id,name:u,hostElement:d})}},placeholder:t("CreationDoc_Todo_AddAssignee_Placeholder")}),b)}}).call(this,r("dx_E9Eu"))},dx_Za4A:function(e,n,r){"use strict";r.d(n,"K",(function(){return i}));var o=r("dx_N47N");function i(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(o.h)(e,n)}},dx_ZeFe:function(e,n,r){"use strict";var o,i;r.d(n,"v",(function(){return o})),r.d(n,"j",(function(){return i})),r.d(n,"o",(function(){return c})),function(e){e.single="single",e.multiple="multiple"}(o||(o={})),function(e){e.afterPoll="afterPoll",e.beforePoll="beforePoll"}(i||(i={}));var c="POLL_COLLAPSE_SIZE_CHANGE"},dx_Zt69:function(e,n,r){},dx_Zx3K:function(e,n,r){},dx_ZxNV:function(e,n,r){"use strict";r.d(n,"L",(function(){return c}));var o=r("dx_XIp8"),i=r("dx_B28d");function c(e,n){var r=Object(o.S)(n);if(!i.hI.includes(r.snapshot.type))return n;var c=e.getBlockModelsByRecordId(n.id)[0];return c?(r.snapshot.text=c.zoneState.toAttributeText(),r):n}},dx_a2aT:function(e,n,r){"use strict";r.d(n,"S",(function(){return u}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r("dx_S6dX"),l=r("dx_oDE6");function s(){return Object(a.e)().height>=l.E?l.q:l.D}function u(e){var n=Object(c.useState)(s()),r=i()(n,2),o=r[0],a=r[1];return Object(c.useEffect)((function(){if(e){var n=function(){a(s())};return document.addEventListener("resize",n),function(){document.removeEventListener("resize",n)}}}),[e]),o}},dx_a3US:function(e,n,r){"use strict";r.d(n,"r",(function(){return i}));var o=r("dx_cDcd");function i(e){var n=Object(o.useRef)(e);return n.current=e,Object(o.useCallback)((function(){return n.current.apply(n,arguments)}),[])}},dx_a3ox:function(e,n,r){"use strict";(function(t){var e=r("dx_J4zp"),o=r.n(e),i=r("dx_TSYQ"),c=r.n(i),a=r("dx_cDcd"),l=r.n(a),s=(r("dx_Fnd2"),null),u=function(e){s=e};n.S=function(e){var n=e.isDragging,r=e.updatePosition,i=e.style,d=Object(a.useRef)(null),f=Object(a.useState)(!1),h=o()(f,2),p=h[0],v=h[1];Object(a.useEffect)((function(){var e=function e(o){var i,c=o.type;if(n)switch(c){case"touchstart":o.preventDefault(),o.stopPropagation(),i=o.touches[0]||o.changedTouches[0],u({clientX:i.clientX,clientY:i.clientY}),window.addEventListener("touchmove",e,!0),window.addEventListener("touchend",e,!0);break;case"touchmove":if(!s)return;i=o.touches[0]||o.changedTouches[0],r({diffX:i.clientX-s.clientX,diffY:i.clientY-s.clientY}),v(!0),u({clientX:i.clientX,clientY:i.clientY});break;case"touchend":window.removeEventListener("touchmove",e,!0),window.removeEventListener("touchend",e,!0),o.stopPropagation(),u(null);break;case"mousedown":o.preventDefault(),o.stopPropagation(),u({clientX:o.clientX,clientY:o.clientY}),window.addEventListener("mousemove",e,!0),window.addEventListener("mouseup",e,!0);break;case"mousemove":if(!s)return;r({diffX:o.clientX-s.clientX,diffY:o.clientY-s.clientY}),v(!0),u({clientX:o.clientX,clientY:o.clientY});break;case"mouseup":window.removeEventListener("mousemove",e,!0),window.removeEventListener("mouseup",e,!0),o.stopPropagation(),u(null)}},o=d.current;return o&&(o.addEventListener("touchstart",e),o.addEventListener("mousedown",e)),function(){o&&(o.removeEventListener("touchstart",e),o.removeEventListener("mousedown",e))}}),[d,n,r]),Object(a.useEffect)((function(){n&&v(!1)}),[n]);var g=c()("doc-cover-image-wrapper",{"cover-draggable":n});return l.a.createElement("div",{ref:d,style:i,className:g},e.children,n&&!p&&l.a.createElement("div",{className:"cover-draggable-tips"},t("CreationDoc_Docs_DocCover_AdjustCoverPosition_Desc")))}}).call(this,r("dx_E9Eu"))},dx_a48a:function(e,n,r){"use strict";r.d(n,"v",(function(){return B})),r.d(n,"j",(function(){return T})),r.d(n,"T",(function(){return w})),r.d(n,"y",(function(){return M})),r.d(n,"b",(function(){return D}));var o,i=r("dx_o0o1"),c=r.n(i),a=r("dx_lSNA"),l=r.n(a),s=r("dx_yXPU"),u=r.n(s),d=r("dx_UtDZ"),f=r("dx_d2dg"),h=r("dx_QJ6a"),p=r("dx_kZ3l"),v=r("dx_fEKD"),g=r("dx_zghO"),b=r("dx_B28d"),y=r("dx_ZG9w"),m=r("dx_Y299"),_=r("dx_Mnld");function k(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;if(!e)return null;var r=new Image;r.src=e;var o=r.decode().then((function(){return e})).catch((function(n){return console.error(n," src: ".concat(e)),null})),i=0,c=new Promise((function(r){i=window.setTimeout((function(){console.error("image decoded timeout, src: ".concat(e)),r(null),i=0}),n)}));return Promise.race([o,c]).then((function(e){return i&&(window.clearTimeout(i),i=0),e}))}function O(e){var n=document.createElement("a");n.href=e;try{return{protocol:n.protocol,hostname:n.hostname}}catch(r){return console.error("[bookmark-block] parseUrl error"),null}}function x(e){return function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=O(e);if(!r)return"";var o=r.protocol,i=r.hostname;return n?[o,i].join("//"):i}(e,!1)}function E(e){return S.apply(this,arguments)}function S(){return(S=u()(c.a.mark((function e(n){var r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(n.cover_url);case 2:return r=e.sent,n.cover_url=r||"",e.next=6,k(n.icon_url);case 6:return o=e.sent,n.icon_url=o||"",e.abrupt("return",n);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e,n){return I.apply(this,arguments)}function I(){return(I=u()(c.a.mark((function e(n,r){var o,i,a,l,s,u,d,f,h;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=x(n),i={title:o,url:n},r){e.next=4;break}return e.abrupt("return",i);case 4:return e.next=6,E(r);case 6:return a=e.sent,l=a.title,s=a.icon_url,u=a.cover_url,d=a.cover_height,f=a.cover_width,h=a.summary,e.abrupt("return",{url:n,title:l||o,icon:s,cover_url:u,cover_height:d,cover_width:f,summary:h});case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b.B.BOOKMARK;return Object(v.b)(e,n)}function T(e){if(e&&Object(y.f)(e)&&Object(y.U)(e)){var n=e.model.zoneState.totalWidth()-1;e.selectionAPI.setSelection([{type:g.j.TEXT,id:e.id,selection:{start:n,end:n}}])}}function w(e){return R.apply(this,arguments)}function R(){return(R=u()(c.a.mark((function e(n){var r,i,a,s,u,f,v;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.url,i=n.linkRange,a=n.block,s=Object(p.j)(a,i),a.model.setAttributes(s,l()({},h.f,"true")),e.next=5,Object(m.E)(r,o.Title);case 5:return(u=e.sent)||d.Toast.error({content:_.q.unsupportToast}),e.next=9,C(r,u);case 9:f=e.sent,v=f.title,a.model.replaceEditorText(s,v,l()({link:encodeURIComponent(r)},h.f,"")),T(a);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){return j.apply(this,arguments)}function j(){return(j=u()(c.a.mark((function e(n){var r,i,a,l,s,u,h,p,v,g,y,k,O;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.blockManager,a=n.url,l=n.block,s=n.mark,u=n.isAppend,h=n.range,p=n.source,e.next=3,Object(f.x)({block:l,blockManager:i,mark:s,newBlockType:b.B.BOOKMARK,newBlockOptions:{bookmark:{url:a}},isAppend:u,range:h});case 3:if(v=e.sent){e.next=6;break}return e.abrupt("return");case 6:if(e.t0="paste"===p,e.t0){e.next=11;break}return e.next=10,Object(m.D)(a);case 10:e.t0=e.sent;case 11:if(g=e.t0,y=null,g){e.next=17;break}d.Toast.error({content:_.q.unsupportToast}),e.next=22;break;case 17:return e.next=19,Object(m.E)(a,o.Cover);case 19:y=e.sent,(!y||Object.values(y).every((function(e){return!e})))&&d.Toast.error({content:_.q.cannotPreviewToast});case 22:return e.next=24,C(a,y);case 24:if(k=e.sent,O=null===(r=i.getRecordByBlockId(v))||void 0===r?void 0:r.id){e.next=28;break}return e.abrupt("return");case 28:i.applyTransaction("insert bookmarkBlock",(function(e){e.replace(O,["bookmark"],k)}),{undoable:!1});case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,n){try{for(var r=n.getBlockModelByBlockIdNotCheck(e);r&&r.parent;){if([b.B.CALLOUT,b.B.OKR,b.B.TASK,b.B.QUOTE_CONTAINER,b.B.QUOTE].indexOf(r.type)>-1)return!0;r=r.parent}}catch(o){console.info("struct not found")}return!1}!function(e){e.Title="title",e.Bookmark="bookmark",e.Cover="cover"}(o||(o={}))},dx_a4Cv:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return he}));var e,o,i,c,a=r("dx_o0o1"),l=r.n(a),s=r("dx_yXPU"),u=r.n(s),d=r("dx_lSNA"),f=r.n(d),h=r("dx_yG8O"),p=r.n(h),v=r("dx_lwsE"),g=r.n(v),b=r("dx_W8MJ"),y=r.n(b),m=r("dx_PJYZ"),_=r.n(m),k=r("dx_iWIM"),O=r.n(k),x=r("dx_W7W2"),E=r.n(x),S=r("dx_a1gu"),C=r.n(S),I=r("dx_Nsbk"),B=r.n(I),T=r("dx_Uyc2"),w=r.n(T),R=(r("dx_A1AB"),r("dx_UtDZ")),M=r("dx_h6a8"),j=r("dx_cDcd"),D=r.n(j),A=r("dx_qKbM"),P=r("dx_PQBD"),L=r("dx_yzqx"),N=r("dx_hKul"),F=r("dx_CR0l"),U=r("dx_luPr"),H=r("dx_H6o9"),V=r("dx_Jo01"),W=r("dx_B28d"),z=r("dx_L6Lu"),G=r("dx_MGoZ"),K=r("dx_USRY"),q=r("dx_R7Rv"),X=r("dx_YRGG"),Y=r("dx_Z8yN"),J=r("dx_D8nn"),Z=r("dx_T1AN"),Q=r("dx_k8kI"),$=r("dx_c7yg"),ee=r("dx_vxMA"),te=r("dx_O5Om"),ne=r("dx_miEo"),re=r("dx_hgIo"),oe=r("dx_KXll"),ie=r("dx_P74U"),ce=r("dx_NOpe"),ae=r("dx_oggq"),le=r("dx_anc2"),se=r("dx_k5Bg");r("dx_DphS");function ue(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function de(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ue(Object(r),!0).forEach((function(n){f()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function fe(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=B()(e);if(n){var i=B()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return C()(this,r)}}var he=(c=i=function(e){E()(r,e);var n=fe(r);function r(e){var i;return g()(this,r),i=n.call(this,e),p()(i,"scheduler",o,_()(i)),i.isDragging=!1,i.viewer=void 0,i.globalStateChangeSub=void 0,i.shouldNativePreviewRender=void 0,i.encryptRecordId=void 0,i.shouldPreventClick=!1,i.player=void 0,i.fixAndroidVideoFullscreenDestroy=void 0,i.isRendered=!1,i.state=de(de({progress:$.m,fromSelf:!1,isCopying:!1,bufferStatus:ne.y.RENDER},te.w.getState(i.record.id)),{},{isRenderHiddenCardDom:!1}),i.renderFinishCb=function(){i.isRendered=!0,U.R.reportBlockLoadStage(U.F.TTV,{id:i.model.id,time:(new Date).getTime()})},i.onPreviewLoadingEnd=function(){U.R.reportBlockLoadStage(U.F.TTU,{id:i.model.id,time:(new Date).getTime()})},i.onPreviewError=function(){U.R.reportBlockLoadError({id:i.model.id,type:i.model.type})},i.getViewSnapshot=function(){if(i.props.viewType===K.t.Card)return i.hostElement.querySelector(".file-card");if(i.props.viewType===K.t.Preview&&i.hostElement.querySelector("iframe")){var e=i.hostElement.cloneNode(!0),n=e.querySelector('[data-sel="box-preview-container"]'),r=e.querySelector(".drive-cover-preview"),o=e.querySelector(".drive-cover-preview img");if(o&&r&&n){var c=i.hostElement.getBoundingClientRect();return e.style.width="".concat(c.width,"px"),e.style.height="".concat(c.height,"px"),n.remove(),r.style.display="block",o.src=o.dataset.src,e}}return i.hostElement},i.getAlignType=function(){var e=i.model.snapshot.align;if(e)return e;switch(i.getViewType()){case K.t.Preview:return W.D.CENTER;case K.t.Inline:case K.t.Card:default:return W.D.LEFT}},i.handleDragDrop=function(e,n){n&&n.origin.includes(i.parentId)&&(i.isDragging=!0)},i.handleClick=Object(M.debounce)((function(e){var n;(null===(n=e.target)||void 0===n?void 0:n.closest(".viewer-toolbar"))?e.stopPropagation():(!i.editable||i.props.isSelected||L.S.isMobile&&L.S.isLark)&&(Object(N.M)(i.id,{actionType:F.e.CLICK_FILE},{blockManager:i.blockManager}),i.blockManager.dispatch(V.q),i.previewFileFullScreen())}),500,{leading:!0,trailing:!1}),i.handleMouseEnter=function(e){var n=e.target,r=null===n||void 0===n?void 0:n.closest(".preview-wrap");(null===r||void 0===r?void 0:r.querySelector("iframe"))&&i.blockManager.dispatch(Z.K,_()(i));var o=new Event("mousemove",{bubbles:!0});n.dispatchEvent(o)},i.handleMouseDown=function(){L.S.isIPad&&(i.shouldPreventClick=!1,setTimeout((function(){i.shouldPreventClick=!0}),300))},i.handlePreviewClick=function(e){e.stopPropagation(),i.shouldPreventClick?i.shouldPreventClick=!1:(i.previewFileFullScreen(),Object(N.M)(i.id,{actionType:F.e.CLICK_FILE_PREVIEW_BUTTON},{blockManager:i.blockManager}),i.blockManager.dispatch(V.q))},i.previewFileFullScreen=u()(l.a.mark((function e(){var n,r,o,c,a=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=a.length>0&&void 0!==a[0]?a[0]:ne.o.MANUAL,(L.S.isInVC||L.S.isLark)&&L.S.isMobile&&(J.S.trigger(J.p.MOBILE.CONTEXT_MENU.HIDE_CUSTOM_MENU,[]),i.selectionAPI.removeAllSelection(),L.S.isIOS&&setTimeout((function(){var e;return null===(e=window.getSelection())||void 0===e?void 0:e.removeAllRanges()}))),!L.S.isMobile&&L.S.isInVC&&(i.selectionAPI.removeAllSelection(),null===(c=window.getSelection())||void 0===c||c.removeAllRanges()),null===(n=i.player)||void 0===n||n.pause(),e.next=6,re.G.previewFileFullScreen({record:i.record,onClose:function(){i.handlePreviewerClose()}},o);case 6:null===(r=i.state.vcFollowHelper)||void 0===r||r.sendDocxFilePreviewState(!0);case 7:case"end":return e.stop()}}),e)}))),i.closeFilePreviewer=function(e){re.G.closeFilePreviewer(i.record.snapshot.file.token,e)},i.checkPreviewStatus=function(){var e=i.record.snapshot.file.token;return re.G.checkPreviewStatus(e)},i.handlePreviewerClose=function(){var e;null===(e=i.state.vcFollowHelper)||void 0===e||e.sendDocxFilePreviewState(!1)},i.handleViewerRef=function(e){i.viewer=e},i.enterBuffer=function(){i.viewer&&i.viewer.resize&&i.viewer.resize(),i.getShouldRender()&&(console.info("~~ enterBuffer",i.encryptRecordId),i.updateBufferStatus(ne.y.PRELOAD),ee.S.push({recordId:i.record.id,func:i.updateToRenderStatus},!1))},i.leaveBuffer=function(){i.getShouldRender()&&(console.info("~~ leaveBuffer",i.encryptRecordId),ee.S.delete(i.record.id),i.updateBufferStatus(ne.y.MOVEOUT))},i.enterViewport=function(){i.getShouldRender()&&(console.info("~~ enterViewport",i.encryptRecordId),ee.S.push({recordId:i.record.id,func:i.updateToRenderStatus},!0))},i.leaveViewport=function(){i.getShouldRender()&&(console.info("~~ leaveViewport",i.encryptRecordId),ee.S.delete(i.record.id))},i.updateToRenderStatus=function(){i.updateBufferStatus(ne.y.RENDER)},i.handleFileCardMount=function(){var e=i.props.blockId;i.scheduler.onBlockDidRender(e)},i.setPlayerRef=function(e){var n,r;(i.player=e,L.S.isAndroid&&e)&&(i.blockManager.dispatch(Q.v.ADD,i.props.model.id),null===(n=(r=i).fixAndroidVideoFullscreenDestroy)||void 0===n||n.call(r),i.fixAndroidVideoFullscreenDestroy=Object(se.h)(e));if(i.props.recursionProps.isPresentationMode){var o,c=null===(o=i.player.root)||void 0===o?void 0:o.querySelector(".xgplayer-progress");if(c){var a=c.getBoundingClientRect.bind(c);c.getBoundingClientRect=function(){var e=a(),n=Object(z.K)();return new DOMRect(n*e.x,n*e.y,n*e.width,n*e.height)}}}},U.R.reportBlockLoadStage(U.F.INIT,{id:i.model.id,type:i.model.type,time:(new Date).getTime(),viewType:i.getViewType()}),i}return y()(r,[{key:"blockViewDidMount",value:function(){var e=this;O()(B()(r.prototype),"blockViewDidMount",this).call(this),this.registerVc(),this.globalStateChangeSub=te.w.onStateChangeOf(this.record.id).subscribe((function(n){e.setState(n)}));var n=this.record.snapshot.file.token;Object(oe.H)(n)&&this.blockManager.addListener(Y.jN,this.handleDragDrop),this.tryResumePausedTask()}},{key:"blockViewDidUpdate",value:function(e,n){O()(B()(r.prototype),"blockViewDidUpdate",this).call(this,e,n);var o=e.record.snapshot.file.token,i=this.props.record.snapshot.file.token;!o&&i&&this.blockManager.removeListener(Y.jN,this.handleDragDrop)}},{key:"toggleRenderHiddenCardDom",value:function(e){this.setState({isRenderHiddenCardDom:e})}},{key:"registerVc",value:function(){if(this.vcController){var e=new ie.z(this.vcController,this.props.model.recordId,this.id,this.previewFileFullScreen,this.closeFilePreviewer,this.checkPreviewStatus);this.setState({vcFollowHelper:e})}}},{key:"getViewType",value:function(){return this.props.displaymode===K.t.Inline?K.t.Inline:this.props.viewType||K.t.Card}},{key:"getViewTypeToolBarList",value:function(){var e,n=this.record.snapshot.file.token,r=(null===(e=this.blockManager.recordManager.collabModule)||void 0===e?void 0:e.getVersion(this.record.id))||$.j;return Object(oe.H)(n)||r<=$.j?null:["inline",K.t.Card,K.t.Preview]}},{key:"getInlineComponentData",value:function(){return Object(oe.Y)(this.record.snapshot,this.blockManager,!1,this.record.id)}},{key:"previewFile",value:function(){this.previewFileFullScreen(),this.blockManager.dispatch(V.q)}},{key:"blockViewWillUnmount",value:function(){var e,n;O()(B()(r.prototype),"blockViewWillUnmount",this).call(this),this.isRendered=!1,this.blockManager.removeListener(Y.jN,this.handleDragDrop),this.tryPauseUploadingTask(),this.vcController&&this.vcController.isFollow||this.closeFilePreviewer(ne.Y.Unmount),null===(e=this.state.vcFollowHelper)||void 0===e||e.destroy(),this.globalStateChangeSub.unsubscribe(),null===(n=this.fixAndroidVideoFullscreenDestroy)||void 0===n||n.call(this)}},{key:"tryPauseUploadingTask",value:function(){var e=this.record.snapshot.file.token;if(Object(oe.H)(e)&&!this.isDragging){var n=this.props.recursionProps.fileUploader;null===n||void 0===n||n.pause(this.record.id)}}},{key:"tryResumePausedTask",value:function(){var e=this.record.snapshot.file.token;if(Object(oe.H)(e)){var n=this.props.recursionProps.fileUploader;null===n||void 0===n||n.retry(this.record.id)}}},{key:"supportNativePreviewRender",value:function(){this.getViewType()===K.t.Preview&&Object(oe.J)()?(this.shouldNativePreviewRender=!0,this.encryptRecordId=Object(R.encryptTea)(this.record.id)):this.shouldNativePreviewRender=!1}},{key:"getShouldRender",value:function(){return void 0===this.shouldNativePreviewRender&&this.supportNativePreviewRender(),this.shouldNativePreviewRender}},{key:"updateBufferStatus",value:function(e){this.setState({bufferStatus:e})}},{key:"render",value:function(){switch(this.getViewType()){case K.t.Inline:return this.renderFileInline();case K.t.Preview:return this.renderPreviewCard();case K.t.Card:default:return this.renderFileCard()}}},{key:"renderPreviewCard",value:function(){var e=this,n=this.props,r=n.blockId,o=n.recursionProps,i=n.model,c=o.editable,a=o.copyable,l=o.exportable,s=o.eventEmitter,u=this.record.snapshot,d=u.file,f=u.height,h=d.token,p=d.name,v=d.mimeType,g=this.state,b=g.fromSelf,y=g.progress,m=g.isCopying,_=g.bufferStatus,k=g.vcFollowHelper,O=g.isRenderHiddenCardDom,x=this.props.isSelected;return D.a.createElement(q.h,{blockId:r,blockType:W.B.FILE,eventEmitter:s,scheduler:this.scheduler,renderLoadingPlaceholder:function(){return Object(H.A)(f)},renderContent:function(n,o){var s=n.default;return D.a.createElement(D.a.Fragment,null,D.a.createElement(s,{blockManager:e.blockManager,recordId:i.recordId,fileToken:h,name:p,mimeType:v,bufferStatus:_,fromSelf:b,isCopying:m,progress:y,mountPoint:e.record.id,isSelected:!!x,isPresentationMode:!!e.props.recursionProps.isPresentationMode,borderColor:e.borderColor,editable:c,copyable:a,exportable:l,onPreviewFileFullScreen:e.handlePreviewClick,onClick:e.handleClick,onMaskClick:e.handleClick,onMouseEnter:e.handleMouseEnter,vcFollowHelper:k,viewerRef:e.handleViewerRef,playerRef:e.setPlayerRef,renderFinishCb:function(){e.blockManager.layoutManager.notifyNodeHeightChange(r),e.renderFinishCb(),o()},onPreviewLoadingEnd:e.onPreviewLoadingEnd,onPreviewError:e.onPreviewError}),O&&e.renderFileCard())}})}},{key:"renderFileCard",value:function(){var e=this.props.syncCursorBorderColor,n=this.record.snapshot.file,r=n.name,o=n.size,i=n.token,c=n.mimeType,a=this.state,l=a.progress,s=a.fromSelf,u=a.isCopying,d=a.isRenderHiddenCardDom?{display:"none"}:{},f=de(de({name:r,size:o,token:i,mimeType:c,viewType:"card",progress:l,fromSelf:s,isCopying:u,borderColor:e,onPreviewClick:this.handlePreviewClick,onClick:this.handleClick,onMount:this.handleFileCardMount,renderFinishCb:this.renderFinishCb},d),{},{isPresentationMode:this.props.recursionProps.isPresentationMode});return D.a.createElement(ce.S,f)}},{key:"renderFileInline",value:function(){var e=this.record.snapshot.file,n=this.props.inlineComponentData||e,r=n.name,o=n.token,i=n.need_copy_resource,c=Object(P.Y)(this.record.snapshot),a=Object(oe.s)(r),l=Object(ae.r)(a),s=!o&&!c||i?D.a.createElement(le.S,null):D.a.createElement(l,{width:"48",height:"48"});return D.a.createElement("a",{href:"javascript:void(0);",contentEditable:!1},D.a.createElement(A.S,{className:$.H,text:r,failHint:c?t("CreationDoc_DocX_Copy_inline_failed_tag"):void 0,logo:s,onClick:this.handlePreviewClick,onMouseDown:this.handleMouseDown,textStyle:{fontWeight:"inherit"},renderFinishCb:this.renderFinishCb}))}},{key:"isBlockRendered",get:function(){return this.isRendered||this.shouldNativePreviewRender}},{key:"contentElement",get:function(){return this.hostElement.querySelector(".docx-file-block-inner-container")}},{key:"borderColor",get:function(){var e=this.props,n=e.isSelected,r=e.syncCursorSelected,o=e.syncCursorBorderColor;return!n&&r?o:void 0}}]),r}(G.l),i.type=$.O,i.defaultViewType=$.n,e=c,o=w()(e.prototype,"scheduler",[X.b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e)}).call(this,r("dx_E9Eu"))},dx_a4ad:function(e,n,r){"use strict";r.d(n,"q",(function(){return u})),r.d(n,"X",(function(){return d}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_eSV8"),s=null;function u(){return s}function d(){return f.apply(this,arguments)}function f(){return(f=a()(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=2;break}return e.abrupt("return",s);case 2:return e.prev=2,e.next=5,Promise.all([r.e("dx_xqi"),r.e("dx_XOJ")]).then(r.bind(null,"dx_m4qn"));case 5:return n=e.sent,s=n.default,e.abrupt("return",s);case 10:return e.prev=10,e.t0=e.catch(2),Object(l.n)("Failed to load katex: ".concat(String(e.t0))),e.abrupt("return",null);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})))).apply(this,arguments)}},dx_a6aj:function(e,n,r){"use strict";(function(t){r.d(n,"s",(function(){return e}));var e=t("common.unnamed_wiki")}).call(this,r("dx_E9Eu"))},dx_a7X6:function(e,n,r){"use strict";r.d(n,"L",(function(){return S})),r.d(n,"q",(function(){return Y})),r.d(n,"U",(function(){return ee.U})),r.d(n,"hS",(function(){return ue.h})),r.d(n,"hi",(function(){return se})),r.d(n,"vz",(function(){return fe})),r.d(n,"W",(function(){return he.W})),r.d(n,"Rf",(function(){return pe.R})),r.d(n,"Z",(function(){return ve.Z})),r.d(n,"t",(function(){return be})),r.d(n,"v",(function(){return Ie})),r.d(n,"P",(function(){return We})),r.d(n,"V",(function(){return Xe})),r.d(n,"R",(function(){return Ze})),r.d(n,"h",(function(){return Qe.h})),r.d(n,"K",(function(){return nt}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_N8Nu"),b=r("dx_Bs5u"),y=r("dx_X1XY"),m=r("dx_cBZs"),_=r("dx_IdzY"),k=(r("dx_SqMK"),r("dx_bPy9"));function O(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var x="".concat(_.I,"focus"),E="".concat(_.I,"focus-first");var S=function(e){d()(r,e);var n=O(r);function r(e){var o,i=e.editor;return a()(this,r),(o=n.call(this)).editor=void 0,o.isRendered=!1,o.editor=i,o}return s()(r,[{key:"match",value:function(e){return!!Object.values(b.A).includes(e)}},{key:"render",value:function(e){var n=e.children,r=e.attributes,o=e.lineState,i=e.op,c=e.insert,a=function(e){return e[b.A.add]?b.A.add:e[b.A.del]?b.A.del:e[b.A.change]?b.A.change:null}(r);if(!a)return n;var l=" history-diff-mark history-diff-text-highlight history-diff-text-highlight-".concat(a);e.class+=l;var s=r.author||"";if(s){var u=m.J.getUserInfoById(s),d=u.backgroundColor,f=u.textColor;e.style.color=f,e.style.backgroundColor=d,e.style.borderBottom="2px solid ".concat(f)}var h=r.change_id;return h&&(e.domAttributes["data-history-change-id"]=h,e.domAttributes["data-history-author-id"]=s),r[x]&&(e.class+=" focus"),r[E]&&(e.class+=" focus-first"),this.renderHistoryHighlightPopover({insert:c,op:i,lineState:o,lineIndex:e.index,editType:a,authorId:s,changeId:h}),n}},{key:"renderHistoryHighlightPopover",value:function(e){var n=this;if(!this.isRendered){var r=e.insert,o=e.op,c=e.lineState,a=e.lineIndex,l=e.editType,s=e.changeId,u=e.authorId,d=c.getOps().indexOf(o);-1===d&&(d=c.getOps().length-1);for(var f=0,h=0;h<d;h++){f+=c.getOps()[h].insert.length}var p=c.getZoneId(),v={zoneId:p,line:a,offset:f},g={zoneId:p,line:a,offset:f+r.length},b={start:v,end:g};this.editor.once("paint",(function(){n.isRendered=!0;var e={detail:{changeId:s,authorId:u,blockId:Object(k.j)(p),editType:l,setFocus:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var o,c=(o={},i()(o,x,"true"),i()(o,E,r?"true":""),o);n.editor.getContentState().setAttributes(b,c)}else{var a;n.editor.getContentState().setAttributes(b,(a={},i()(a,x,""),i()(a,E,""),a))}},start:v,end:g,editor:n.editor}};y.r.emit(y.k,e)}))}}}]),r}(g.o);S.KEY="textHighlight";var C=r("dx_LcNA"),I=r("dx_e4eN"),B=r("dx_UtDZ"),T=r("dx_cDcd"),w=r.n(T),R=r("dx_C7Cb"),M=w.a.createElement("svg",{className:"circular",viewBox:"25 25 50 50"},w.a.createElement("circle",{className:"path",cx:"50",cy:"50",r:"20",fill:"none",strokeWidth:"4",strokeMiterlimit:"10"})),j=r("dx_rQGm"),D=r("dx_yzqx"),A=r("dx_xs2W"),P=r("dx_zEdG"),L=r("dx_rldU"),N=r("dx_BrJR"),F=r("dx_an0K"),U=r("dx_B28d"),H=r("dx_JoJM"),V=r("dx_kZ3l"),W=r("dx_A5O8"),z=r("dx_qANE"),G=r("dx_QJ6a"),K=r("dx_H0Hj");var q=r("dx_iCf4");r("dx_Aha1");function X(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var Y=function(e){d()(r,e);var n=X(r);function r(e){var o,c=e.editor,l=e.blockManager,s=e.selectionAPI,u=e.scroller;return a()(this,r),(o=n.call(this)).name="Link",o.cacheLinkId=null,o.editor=void 0,o.blockManager=void 0,o.selectionAPI=void 0,o.scroller=void 0,o._linkEditController=null,o.linkAttr=null,o.inlineWrapperCache=null,o.handleKeyDown=function(e){var n=e.keyCode,r=e.key,i=e.altKey,c=e.ctrlKey,a=e.metaKey,l=e.nativeEvent;if(D.S.isMobile&&!i&&!c&&!a){var s=o._getBlockModelByCurSelection();if(![U.B.PAGE,U.B.CODE].includes(s.type)){var u=D.S.isAndroid&&229===n&&"Unidentified"===r,d=D.S.isIOS&&"Unidentified"===l.code;(u||d)&&o.editor.once(C.L.CONTENT_CHANGE,o.onContentChange)}}},o.onContentChange=function(e){var n,r=e.options,i=e.deltaSet,c=(null===(n=o.editor.selection)||void 0===n?void 0:n.getSelection().start).zoneId,a=o._getBlockViewByCurSelection(),l=i.get(c);if("flushInput"===r.type){var s=0,u=l.ops.reduce((function(e,n){var r=n.insert,o=n.retain,i=[];return o?s+=o:r&&("string"===typeof r?(i=Object(A.u)(a,r,[s,s+r.length]),s+=s+r.length):(console.error("[link] special insert"),console.log("[link] special insert:",r))),e.concat(i)}),[]);if(u.length){var d=H.S.create(a,o.selectionAPI);u.forEach((function(e){d.push({range:Object(V.j)(a,e.range).toPosition(),value:e.value,source:"paste",toMention:!0,toBookmark:!1,toIframe:!1,toJiraIssue:!1,toISVBlock:!1})}))}}},o.handleMouseEnter=function(e){var n=e.target;n instanceof Node&&n instanceof Element&&(o.linkAttr=Object(q.T)(n,o.editor),o.linkAttr&&o._getBlockView(o.linkAttr.blockId).editable&&o.showEditEntrance())},o.handleSelectionChange=function(){o.hideEditEntrance()},o.handleMouseLeave=function(){o.linkEditController.handleMouseLeave()},o.handleEditClick=function(){if(o.linkAttr){var e=o.linkAttr.blockId,n=o._getBlockModel(e);Object(P.P)("ccm_doc_link_edit_page_click",{block_type:n.type,record_id:n.recordId},{click:"click_edit_link"}),Object(q.g)(n);var r=Object(R.S)();o.editor.getContentState().setAttributes(o.linkAttr.continuousLink,i()({},G.h,r),{extra:{shouldCollab:!1}});var c={token:r,text:o.linkAttr.continuousLink.text,selection:{start:o.linkAttr.continuousLink.start,end:o.linkAttr.continuousLink.end},renderType:F.N.basic};o.linkEditController.hide(),o.blockManager.dispatch(F.q,[e,c]),o.linkAttr=null}},o.handleUnlink=function(){var e;if(o.linkAttr){var n=o.linkAttr,r=n.blockId,c=n.continuousLink,a=n.key,l=o._getBlockModel(r);Object(P.P)("ccm_doc_link_edit_page_click",{block_type:l.type,record_id:l.recordId},{click:"click_cancel_link"});var s=c.start,u=c.end,d=(e={},i()(e,a,""),i()(e,G.u,"true"),e),f={start:s,end:u};o.editor.getContentState().setAttributes(f,d),o.linkEditController.hide(),o.linkAttr=null}},o.showEditEntrance=function(){o.linkAttr&&o.linkEditController.handleMouseEnter({visible:!0,blockManager:o.blockManager,selectionAPI:o.selectionAPI,scroller:o.scroller,target:o.linkAttr.id,link:o.linkAttr.value,handleEditClick:o.handleEditClick,handleUnlink:o.handleUnlink})},o.hideEditEntrance=function(){o.linkEditController.hide()},o.clickLink=function(e){e.preventDefault();var n=e.target,r=Object(q.T)(n,o.editor);if(r){var i=r.value,c=r.blockId,a=o._getBlockView(c);Object(P.P)("ccm_doc_content_page_click",{block_type:a.props.type,record_id:a.props.recordId},{target:j.o.CCM_DOCS_PAGE_VIEW,click:"click_inline_component",inline_type:L.k.LINK});var l=W.S.opendocContentConfig;l&&"outer"===l.hyperlinkHandler?Object(B.sendOpendocEvent)(B.OPENDOC_EVENT.HYPERLINK_CLICK,{url:i}):function(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(K.w)(e,n,!o)}(i,e,a.editable,!!a.props.recursionProps.isHistory)}},o.editor=c,o.blockManager=l,o.selectionAPI=s,o.scroller=u,o.editor.on(C.L.SELECTION_CHANGE,o.handleSelectionChange),o.editor.on(C.L.KEYDOWN,o.handleKeyDown),o}return s()(r,[{key:"_getBlockModel",value:function(e){return this.blockManager.getBlockModelByBlockId(e)}},{key:"_getBlockView",value:function(e){return this.blockManager.getBlockViewByBlockId(e)}},{key:"_getBlockModelByCurSelection",value:function(){var e,n=(null===(e=this.editor.selection)||void 0===e?void 0:e.getSelection().start).zoneId,r=Object(k.j)(n);return this.blockManager.getBlockModelByBlockId(r)}},{key:"_getBlockViewByCurSelection",value:function(){var e,n=(null===(e=this.editor.selection)||void 0===e?void 0:e.getSelection().start).zoneId,r=Object(k.j)(n);return this.blockManager.getBlockViewByBlockId(r)}},{key:"match",value:function(e){return r.KEYS.includes(e)}},{key:"renderInlineWrapper",value:function(e){var n=e.index,r=e.attributes,o=e.lineState,i="";if(r[G.e]&&(i=G.e),r[G.b]&&(i=G.b),!i)return null;var c,a=n-1,l=null;a>=0&&(l=null===(c=o.getOps()[a].attributes)||void 0===c?void 0:c[i]);var s=r[i];if(!this.inlineWrapperCache||s!==l){var u=w.a.createElement("span",{className:"outer-u-container docx-outer-link-container"});this.inlineWrapperCache=u}return this.inlineWrapperCache}},{key:"render",value:function(e){var n=e.children,r=e.attributes,o=e.op,i=e.lineState,c=e.index,a=r[G.b],l=r[G.e];if(a||l){var s=l?G.e:G.b,u=l||a,d=i.getOps().indexOf(o),f=Object(q.s)(i,d,s,u),h=Object(q.P)(i,d,s,u),p=r[G.f];if(e.class+=" link-wrapper",a&&(e.domAttributes[G.E]=c,e.domAttributes[G.I]=r["".concat(G.b,"-start")],e.domAttributes[G.R]=r["".concat(G.b,"-length")],e.domAttributes[G.b]=u),f){var v=Object(k.j)(i.getZoneId());this.cacheLinkId="".concat(v,"-").concat(c,"-").concat(d),e.class+=" link-start"}h&&(e.class+=" link-end"),e.class+=" link-id-".concat(this.cacheLinkId);var g="link";if(r[G.h]){var b=r[G.h];g+=" ".concat(G.h," ").concat(G.n).concat(b)}return(r[G.h]||r[G.J])&&(g+=" mock-selection"),p&&(e.class+=" link-loading"),w.a.createElement("a",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.clickLink,className:g,href:decodeURIComponent(u),"data-href":u,rel:"noopener noreferrer",target:"_blank","data-link-node":String(!0),style:{cursor:"pointer"}},n,p?M:null)}if(r[G.h]){var y=r[G.h];e.class+=" ".concat(G.h," ").concat(G.n).concat(y)}return(r[G.h]||r[G.J])&&(e.class+=" mock-selection"),n}},{key:"_editorLineStateWillRender",value:function(e){var n=e.lineState,r=Object(k.j)(n.getZoneId()),o=this._getBlockModel(r);if(!Object(N.l)(o)){var i=new I.m({zoneId:n.getZoneId()});Object(q.f)(n,i),i.ops.length&&(e.lineState=n.compose(i))}}},{key:"destroy",value:function(){this.editor.off(C.L.SELECTION_CHANGE,this.handleSelectionChange),this.editor.off(C.L.KEYDOWN,this.handleKeyDown)}},{key:"linkEditController",get:function(){return this._linkEditController||(this._linkEditController=new z.S),this._linkEditController}}]),r}(g.o);Y.KEYS=[G.e,G.b,G.h];var J,Z,Q,$,ee=r("dx_ABby"),te=(r("dx_C5ob"),r("dx_Uyc2")),ne=r.n(te),re=r("dx_vtL4"),oe=r("dx_Q1BS"),ie=r("dx_cHnW"),ce=r("dx_I11I"),ae=r("dx_uOsn");function le(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var se=(J=Object(re.R)(999),$=Q=function(e){d()(r,e);var n=le(r);function r(e){var o;return a()(this,r),(o=n.call(this)).manager=void 0,o.manager=new ie.m(e.blockManager),o}return s()(r,[{key:"match",value:function(e){return e===r.KEY}},{key:"render",value:function(e){var n,o=e.attributes[r.KEY],i=null===(n=e.op.insert)||void 0===n?void 0:n.length;if(o)return e.key=o,w.a.createElement(oe.S,{className:"embed-inline-block","data-embed-inlineblock":!0,length:i},w.a.createElement(ae.S,{componentData:{data:{source_block_id:o}},manager:this.manager}))}}]),r}(g.o),Q.init=!1,Q.KEY=ce.B,Z=$,ne()(Z.prototype,"render",[J],Object.getOwnPropertyDescriptor(Z.prototype,"render"),Z.prototype),Z),ue=r("dx_mkyW");function de(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var fe=function(e){d()(r,e);var n=de(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"match",value:function(e){return e===r.KEY}},{key:"render",value:function(e){return e.class+=" trigger-holder-".concat(e.attributes[r.KEY]),e.children}}]),r}(g.o);fe.KEY="trigger";var he=r("dx_R7AN"),pe=r("dx_Py0N"),ve=r("dx_xCN8");function ge(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var be=function(e){d()(r,e);var n=ge(r);function r(e){var o;return a()(this,r),(o=n.call(this)).props=e,o.handleKeydown=function(e){if("Enter"===e.key&&(e.preventEvent(),e.stopEvent(),e.nativeEvent.preventDefault()),"Backspace"===e.key){var n=o.props.editor.selection.getSelection();n.isCollapsed()&&0===n.start.line&&0===n.start.offset?(e.nativeEvent.preventDefault(),e.preventEvent(),e.stopEvent()):(e.nativeEvent.stopPropagation(),e.nativeEvent.stopImmediatePropagation())}},e.editor.on("keydown",o.handleKeydown),o}return r}(g.o),ye=r("dx_QxNg"),me=r("dx_M30o"),_e=r("dx_Z7ZC"),ke=r("dx_AMht"),Oe=r("dx_Fimk"),xe=r("dx_eSV8"),Ee=r("dx_IVxn");function Se(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Ce(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Se(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Se(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var Ie=function(){function e(n){var r=this;a()(this,e),this.name=_.E,this.editor=void 0,this.blockManager=void 0,this.handleContentChange=function(e){var n,o,c=e.options,a=e.changes,l=Object.keys(a)[0];if(l){var s=Object(k.j)(l),u=r.blockManager.getBlockModelByBlockId(s);u&&r.getOriginText(u).length<=0&&Object(Oe.N)("doc_bug_track_dev",{action:"contentState_length_error",info:JSON.stringify({id:Object(xe.L)(u.record.id),snapshot:u.record.snapshot.text.initialAttributedTexts.text[0].length,content:r.getOriginText(u).length})});var d=c.type,f=void 0===d?"onApplyChange":d,h=c.isRemote,p=c.extra,v=void 0===p?{}:p,g=v.path,b=void 0===g?["text"]:g,y=v.op,m=v.shouldCollab,O=void 0===m||m,x=v.replaceAll,E=void 0!==x&&x,S=v.easysyncData;if(!h&&!1!==O){var C=null===(n=r.blockManager.getRecordByBlockId(s))||void 0===n?void 0:n.id;if(C){var I=null===(o=r.editor.getContentState().getZoneState(l))||void 0===o?void 0:o.getContent(!0);if(I){var B=new me.q(i()({},_.x,{zoneId:_.x,ops:I.ops,zoneType:I.zoneType})),T=Object(k.b)(c);if(!E&&S){var w=r.blockManager.getBlockModelByBlockId(s),R=w.record.snapshot.text.initialAttributedTexts.text[_.x];return Object(Oe.N)("doc_bug_track_dev",{action:"collab_content_change",info:JSON.stringify({id:Object(xe.L)(C),snapshot:R.length,content:r.getText(w).length})}),void(y?y.edit(C,b,S):r.blockManager.applyTransaction(f,(function(e){return e.edit(C,b,S)}),Ce(Ce(Ce({},c),T),{},{from:ye.H.local})))}if(y)y.replace(C,b,r.getClientVars(B));else{var M=r.getClientVars(B);r.blockManager.applyTransaction(f,(function(e){return e.replace(C,b,M)}),Ce(Ce(Ce({},c),T),{},{from:ye.H.local}))}}}}}};var o=n.blockManager,c=n.editor;this.editor=c,this.blockManager=o,this.editor.on(C.L.CONTENT_CHANGE,this.handleContentChange)}return s()(e,[{key:"editorWillApplyChange",value:function(e){var n=e.deltaSet,r=e.options;if(!ke.S.lineEditable)return n;for(var o=r.isRemote,c=r.extra,a=void 0===c?{replaceAll:!1}:c,l=0,s=Object.keys(n.deltas);l<s.length;l++){var u=s[l],d=this.blockManager.getBlockModelByBlockId(Object(k.j)(u));if(Object(k.U)(d.record.snapshot.text))return a.replaceAll=!0,r.extra=a,n}var f=a.shouldCollab;if(o||!(void 0===f||f))return n;var h=Object.keys(n.deltas)[0];if(h){var p=this.blockManager.getBlockModelByBlockId(Object(k.j)(h)),v=p.record,g=Object(_e.c)(n,{filterLocalAttributes:!0}),b=new me.q(i()({},_.x,new I.m({zoneId:_.x}).concat(n.get(h)))),y=this.getTexts(p),m=v.snapshot.text.initialAttributedTexts.text[_.x];Object(_e.a)(m)&&(y=i()({},_.x,m));var O=Object(_e.i)(b,v,{apool:g,zone_changesets:y,toChangeSetOptions:{filterLocalAttributes:!0}});return Object(Oe.N)("doc_bug_track_dev",{action:"collab_will_apply",info:JSON.stringify({id:Object(xe.L)(v.id),content:this.getText(p).length,delta:Object(_e.s)(n),snapshot:m.length,cs:Object(_e.K)(O.zone_changesets[_.x]),attr:Object(_e.b)(O.apool.numToAttrib)})}),a.easysyncData=O,r.extra=a,n}}},{key:"getClientVars",value:function(e){var n,r=e.get("0").ops,o=r.length-1;return"\n"===r[o].insert&&(null===(n=r[o].attributes)||void 0===n?void 0:n.fixEnter)&&(e=new me.q({0:new I.m({zoneId:"0",ops:r.slice(0,-1)})})),Object(Ee.f)(e)}},{key:"getOriginText",value:function(e){return e.zoneState.getModelText()}},{key:"getText",value:function(e){var n=this.getOriginText(e);return n.substr(0,n.length-1)}},{key:"getTexts",value:function(e){var n={};return n[_.x]=this.getText(e),n}},{key:"destroy",value:function(){this.editor.off(C.L.CONTENT_CHANGE,this.handleContentChange)}}]),e}(),Be=r("dx_PJYZ"),Te=r.n(Be),we=r("dx_uZlF"),Re=r("dx_SreQ"),Me=r("dx_zghO"),je=r("dx_xeoP"),De=r("dx_D8nn");function Ae(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Pe(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Ae(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ae(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Le(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var Ne=C.L.PAINT,Fe=C.L.SELECTION_CHANGE,Ue=C.L.SELECTION_CHANGE_AND_DOM_UPDATE,He=new je.o,Ve=!1,We=function(e){d()(r,e);var n=Le(r);function r(e){var o;return a()(this,r),(o=n.call(this)).props=e,o.lastTransactionName=void 0,o.sub=void 0,o.handleEditorViewSelectionChange=function(e){var n,r=e.selection;if(!Object(Re.P)()){var i=o.props.editor;i.getStatus("stopUpdateSelection")||i.isFocus(r.start.zoneId)&&(null===(n=o.lastTransactionName)||void 0===n?void 0:n.endsWith(":enter"))&&De.S.emit(De.p.COMMON.ADJUST_VIEWPORT)}},o.handleEditorPaint=function(){var e=o.props.selectionAPI;e.isFocus()&&e.isTextSelectionAcrossBlocks()&&!e.isSelecting()&&o.props.selectionAPI.updateBrowserSelection()},o.handleEditorSelectionChange=function(e){var n=Te()(o).props,r=e.current,i=n.selectionAPI,c=n.editor,a=i.getSelection();if(!i.isSelecting()||!i.isBlockSelection(a)){var l,s,u=r.toPosition(),d={id:Object(k.j)(u.zoneId),type:Me.j.TEXT,selection:{start:u.start,end:u.start+u.len}};if(Ve=!0,c.isFocus(u.zoneId))i.getTextSelectionType().onCurrentChange(d,!1);else i.getTextSelectionType().onCurrentChange(d,!0),null===(l=c.getContentState().getZoneState(u.zoneId))||void 0===l||null===(s=l.getContainer())||void 0===s||s.blur();Ve=!1}},o.handleEditorBlur=function(){var e=Te()(o).props,n=e.selectionAPI,r=e.editor;if(!n.isSelecting()){var i=r.selection.getSelection().toPosition(),c={id:Object(k.j)(i.zoneId),type:Me.j.TEXT,selection:{start:i.start,end:i.start+i.len}};Ve=!0,n.getTextSelectionType().onCurrentChange(c,!0),Ve=!1}},o.handleEditorFocus=function(){var e=Te()(o).props,n=e.selectionAPI,r=e.editor;if(!r.getStatus("stopUpdateSelection")&&!n.isSelecting()){var i=r.selection.getSelection().toPosition(),c={id:Object(k.j)(i.zoneId),type:Me.j.TEXT,selection:{start:i.start,end:i.start+i.len}};Ve=!0,n.getTextSelectionType().onCurrentChange(c,!1),Ve=!1}},o.handleBlockSelectionChange=function(e,n){if(!Ve&&1===n.length&&n[0].type===Me.j.TEXT){var r=o.props,i=r.editor,c=r.blockManager,a=r.selectionAPI,l=n[0].selection,s=l.start,u=l.end,d=n[0].id,f=Object(k.v)(d),h=i.getContentState().getZoneState(f);if(h){var p=h.offsetToPoint(s),v=h.offsetToPoint(u),g=new we.A({editor:i,start:Pe(Pe({},p),{},{zoneId:f}),end:Pe(Pe({},v),{},{zoneId:f}),state:h}),b=c.getBlockModelByBlockId(d),y=!e.length&&n.length,m=b.getSelection();if(!m||!we.A.isRangeEqual(g,m)||y)i.off(Fe,o.handleEditorSelectionChange),b.setSelection(g),c.layoutManager.isBlockActive(n[0].id)?i.selection.updateBrowserSelection():a.restoreFocus(),i.on(Fe,o.handleEditorSelectionChange)}}},e.editor.on(Ne,o.handleEditorPaint),e.editor.on(Fe,o.handleEditorSelectionChange),e.editor.on(Ue,o.handleEditorViewSelectionChange),Object(Re.P)()||(e.editor.on(C.L.FOCUS,o.handleEditorFocus),He.register(e.editor,{onSelect:o.handleEditorFocus,onBlur:o.handleEditorBlur}),e.selectionAPI.onSelectionChange(o.handleBlockSelectionChange)),o.sub=e.blockManager.model.change$.subscribe((function(e){o.lastTransactionName=e.options.transactionName})),o}return s()(r,[{key:"destroy",value:function(){this.sub.unsubscribe(),Object(Re.P)()||this.props.selectionAPI.offSelectionChange(this.handleBlockSelectionChange),this.props.editor.off(Ne,this.handleEditorPaint),this.props.editor.off(Fe,this.handleEditorSelectionChange),this.props.editor.off(Ue,this.handleEditorViewSelectionChange),this.props.editor.off(C.L.FOCUS,this.handleEditorFocus),He.unregister(this.props.editor)}}]),r}(g.o),ze=r("dx_TSYQ"),Ge=r.n(ze),Ke=r("dx_z0z2");function qe(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var Xe=function(e){d()(r,e);var n=qe(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).name="CodeHighlight",e}return s()(r,[{key:"match",value:function(e){return e===r.KEY}},{key:"render",value:function(e){return e.class=Ge()(e.class,e.attributes[Ke.g]),e.children}}]),r}(g.o);function Ye(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}Xe.KEY=Ke.g;var Je="non-empty",Ze=function(e){d()(r,e);var n=Ye(r);function r(e){var o,i=e.editor;return a()(this,r),(o=n.call(this)).editor=void 0,o.handleCompositionStart=function(){var e,n=o.editor.getContentState().getActiveZone();n.isEmpty()&&(null===(e=n._node)||void 0===e||e.classList.add(Je))},o.handleCompositionEnd=function(){var e,n=o.editor.getContentState().getActiveZone();n.isEmpty()&&(null===(e=n._node)||void 0===e||e.classList.remove(Je))},o.handleContentChange=function(e){Object.keys(e.changes).forEach((function(e){var n,r,i=o.editor.getContentState().getZoneState(e);i&&(i.isEmpty()?null===(n=i._node)||void 0===n||n.classList.remove(Je):null===(r=i._node)||void 0===r||r.classList.add(Je))}))},o.editor=i,o.bindEvents(),o}return s()(r,[{key:"bindEvents",value:function(){this.editor.on(C.L.COMPOSITION_START,this.handleCompositionStart),this.editor.on(C.L.COMPOSITION_END,this.handleCompositionEnd),this.editor.on(C.L.CONTENT_CHANGE,this.handleContentChange)}},{key:"unBindEvents",value:function(){this.editor.off(C.L.COMPOSITION_START,this.handleCompositionStart),this.editor.off(C.L.COMPOSITION_END,this.handleCompositionEnd),this.editor.off(C.L.CONTENT_CHANGE,this.handleContentChange)}},{key:"destroy",value:function(){this.unBindEvents()}}]),r}(g.o),Qe=(r("dx_KI1b"),r("dx_RUmv")),$e=r("dx_iw8O"),et=r("dx_s1qv");function tt(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var nt=function(e){d()(r,e);var n=tt(r);function r(e){var o;return a()(this,r),(o=n.call(this)).name="docx-triple-click",o.editor=void 0,o.selectionAPI=void 0,o.blockManager=void 0,o.tripleClick=function(e){if(e&&!(e.detail<3)&&e.target instanceof Element&&e.target.closest(".".concat(et.AT_USER_EMBED_CONTAINER))){var n=Object($e.S)(e.target);if(!n)return;var r=o.blockManager.getBlockViewByBlockIdNotCheck(n);r&&U.o.includes(r.type)&&o.selectionAPI.setSelection([{id:n,type:Me.j.TEXT,selection:{start:0,end:0}}])}},o.editor=e.editor,o.selectionAPI=e.selectionAPI,o.blockManager=e.blockManager,o.bindEvents(),o}return s()(r,[{key:"destroy",value:function(){this.unBindEvents()}},{key:"bindEvents",value:function(){this.editor.on("click",this.tripleClick,999)}},{key:"unBindEvents",value:function(){this.editor.off("click",this.tripleClick)}}]),r}(g.o)},dx_aFyr:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{opacity:.6,d:"M1.333 13.667c0-.184.15-.334.334-.334h12.666c.184 0 .334.15.334.334v.666c0 .184-.15.334-.334.334H1.667a.333.333 0 01-.334-.334v-.666z",fill:"currentColor"}),l=i.a.createElement("path",{d:"M2 7.667c0-.184.15-.334.333-.334h2c.184 0 .334.15.334.334v4c0 .184-.15.333-.334.333h-2A.333.333 0 012 11.667v-4zM6.667 2.333C6.667 2.15 6.816 2 7 2h2c.184 0 .333.15.333.333v9.334c0 .184-.149.333-.333.333H7a.333.333 0 01-.333-.333V2.333zM11.333 5.667c0-.184.15-.334.334-.334h2c.184 0 .333.15.333.334v6c0 .184-.15.333-.333.333h-2a.333.333 0 01-.334-.333v-6z",fill:"currentColor"});n.S=function(e){return i.a.createElement("svg",c({width:16,height:16,viewBox:"0 0 16 16",fill:"none"},e),a,l)}},dx_aINA:function(e,n,r){"use strict";(function(t){r.d(n,"u",(function(){return e}));var e,o=r("dx_J4zp"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_lSNA"),d=r.n(u),f=r("dx_UtDZ"),h=r("dx_AA3h"),p=r("dx_bUYd"),v=r("dx_yzqx"),g=r("dx_imty"),b=r("dx_wqNP"),y=r("dx_D8nn");!function(e){e.Reminder="reminder_id"}(e||(e={}));var m=d()({},e.Reminder,{deletedMsg:t("reminder.toast.deleted"),getJumpRecordId:function(e,n){var r=n.block_id,o=n.reminder_id,i=o&&Array.isArray(o)?o[0]:o,c=r&&Array.isArray(r)?r[0]:r;return c&&i?(f.urlHelper.cleanParamFromSearch&&f.urlHelper.cleanParamFromSearch(location.href,"block_id"),Object(b.z)(i,c,e)?r:""):""}}),_=Object.keys(m),k=new(function(){function e(){a()(this,e)}return s()(e,[{key:"getQueryJumpInfo",value:function(){var e=f.urlHelper.parseQuery(location.href);return[_.find((function(n){return!!e[n]})),e]}},{key:"maybeDoQueryJump",value:function(e){var n=this.getQueryJumpInfo(),r=i()(n,2),o=r[0],c=r[1];o&&this.queryJump(e,o,c)}},{key:"queryJump",value:function(e,n,r){var o=m[n],i=o.getJumpRecordId(e,r);i?y.S.emit(g.H.LocateBlockWithRecordId,i):this.showDeleteToast(n,o.deletedMsg),y.S.emit(g.H.QueryJump),f.urlHelper.cleanParamFromSearch&&f.urlHelper.cleanParamFromSearch(location.href,n)}},{key:"showDeleteToast",value:function(e,n){v.S.isMobile&&v.S.isBytedanceApp?h.toastHelper.showToast({type:1,message:n,key:e,duration:3}):Object(p.v)({closable:!0,content:n,key:e})}}]),e}());n.S=k}).call(this,r("dx_E9Eu"))},dx_aJ6H:function(e,n,r){"use strict";(function(t){var e,o,i,c,a=r("dx_lSNA"),l=r.n(a),s=r("dx_o0o1"),u=r.n(s),d=r("dx_yXPU"),f=r.n(d),h=r("dx_yG8O"),p=r.n(h),v=r("dx_lwsE"),g=r.n(v),b=r("dx_W8MJ"),y=r.n(b),m=r("dx_PJYZ"),_=r.n(m),k=r("dx_W7W2"),O=r.n(k),x=r("dx_a1gu"),E=r.n(x),S=r("dx_Nsbk"),C=r.n(S),I=r("dx_Uyc2"),B=r.n(I),T=(r("dx_A1AB"),r("dx_UtDZ")),w=r("dx_h6a8"),R=r("dx_PQBD"),M=r("dx_B28d"),j=r("dx_G5PB"),D=r("dx_bkVC"),A=r("dx_UOHj"),P=r("dx_OPAz"),L=r("dx_GLPm");function N(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function F(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?N(Object(r),!0).forEach((function(n){l()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function U(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=C()(e);if(n){var i=C()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return E()(this,r)}}var H=(c=i=function(e){O()(r,e);var n=U(r);function r(e){var i;return g()(this,r),(i=n.call(this,e)).serviceType="SHEET_BLOCK",i.bridge=void 0,p()(i,"depLoader",o,_()(i)),i.setOnCommentBatchUpdateOnce=Object(w.once)((function(){var e;return(e=i.bridge).setOnCommentBatchUpdate.apply(e,arguments)})),i.loadBridgeImpl=f()(u.a.mark((function e(){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(L.U)(i.snapshot.token),r=n.token){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,i.depLoader.getBridge(r,{isHistory:i.config.get("isHistory")||!1});case 5:return i.bridge=e.sent,e.abrupt("return",i.bridge);case 7:case"end":return e.stop()}}),e)}))),i.highlightHistory=f()(u.a.mark((function e(){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(L.U)(i.snapshot.token),r=n.id,e.abrupt("return",i.bridge.locateHistory(r));case 2:case"end":return e.stop()}}),e)}))),i.clearHightlightHistory=f()(u.a.mark((function e(){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(L.U)(i.snapshot.token),r=n.id,e.abrupt("return",i.bridge.clearHistoryLabel(r));case 2:case"end":return e.stop()}}),e)}))),i}return y()(r,[{key:"isBridgeLoaded",value:function(){return!!this.depLoader.getLoadedBridge()}},{key:"handleInternalPaste",value:function(){var e=f()(u.a.mark((function e(n,r,o){var i,c,a,l,s,d,f,h=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(T.isOnline)()){e.next=3;break}return Object(R.K)(this.modelService,this.id,t("CreationDoc_Common_NetworkDisconnected_UnableToCreate")),e.abrupt("return");case 3:return i="",e.next=6,this.depLoader.getBridge("");case 6:return c=e.sent,e.prev=7,a=Object(D.h)(),l=a.from===M.G.innerCutPaste&&1===a.pasteTimes,e.next=12,c.pasteSheetBlock(this.record.id,r,null===n||void 0===n?void 0:n.outerHTML,l,o);case 12:i=e.sent,e.next=20;break;case 15:return e.prev=15,e.t0=e.catch(7),console.error("paste sheet error",e.t0),Object(R.K)(this.modelService,this.id,t("common.operation_failed"),e.t0),e.abrupt("return");case 20:s=Object(L.U)(i),d=s.id,f=s.token,!this.depLoader.token&&f&&(this.depLoader.token=f),this.applyTransaction("updateSheetBlock",(function(e){var n="";try{n=h.modelService.getRecordByBlockId(h.id).id}catch(r){return void c.delSheetBlock(h.record.id,d)}e.replace(n,["token"],i)}),{undoable:!1});case 23:case"end":return e.stop()}}),e,this,[[7,15]])})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"onPasteRecordAfterAccepted",value:function(e){var n=e.html,r=e.styles,o=e.transitionId;n&&this.handleInternalPaste(n,r,o)}},{key:"setCommentData",value:function(){var e=f()(u.a.mark((function e(n,r){var o,i,c=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Object(L.U)(this.snapshot.token),i=o.id){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.setOnCommentBatchUpdateOnce(i,(function(){return c.handleCommentUpdated(r)}),(function(e){return c.handleCommentDidAdd(r,e)}));case 5:return e.next=7,this.bridge.setCommentData(i,n);case 7:this.handleCommentUpdated(r);case 8:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"startNewComment",value:function(e,n){var r=Object(L.U)(this.snapshot.token).id;return r?this.bridge.startNewComment(r,e,n).cellCordinate:""}},{key:"saveCommentMark",value:function(e,n){var r=Object(L.U)(this.snapshot.token).id;if(r)return this.bridge.saveComment(r,n,e)}},{key:"removeCommentMark",value:function(e){var n=Object(L.U)(this.snapshot.token).id;if(n)return this.bridge.removeComment(n,e)}},{key:"removeTempComment",value:function(e){return this.removeCommentMark(e)}},{key:"resolveComment",value:function(e){var n=Object(L.U)(this.snapshot.token).id;if(n)return this.bridge.resolveComment(n,e)}},{key:"reopenComment",value:function(e){var n=Object(L.U)(this.snapshot.token).id;if(n)return this.bridge.reopenComment(n,e)}},{key:"getComments",value:function(){var e=Object(L.U)(this.snapshot.token).id;return e?Object(L.a)(this.bridge.getComments(e)):[]}},{key:"getActiveComments",value:function(){var e=Object(L.U)(this.snapshot.token).id;return e?Object(L.a)(this.bridge.getActiveComments(e)):[]}},{key:"getResolvedComments",value:function(){var e=Object(L.U)(this.snapshot.token).id;return e?Object(L.a)(this.bridge.getResolvedComments(e)):[]}},{key:"locateComment",value:function(){var e=f()(u.a.mark((function e(n){var r,o,i,c,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(L.U)(this.snapshot.token),o=r.id){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,this.bridge.findComment(o,n);case 5:if(i=e.sent){e.next=8;break}return e.abrupt("return",null);case 8:return c=i.offsetHeight,a=i.offsetTop,e.abrupt("return",{top:a,height:c});case 10:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"getCommentRelativeTop",value:function(e){var n,r,o=null!==(n=e.relativeTopToThirdParty)&&void 0!==n?n:0;return this.blockManager.hasBlockViewByBlockId(this.id)&&1!==(null!==(r=this.blockManager.view.getBlockViewByBlockId(this.id).props.zoom)&&void 0!==r?r:1)?o+16:o}},{key:"getText",value:function(){return"[".concat(t("common.sheet"),"]")}},{key:"onAttach",value:function(){}},{key:"find",value:function(e){var n=this,r=Object(L.U)(this.snapshot.token).id;return this.bridge&&this.bridge.getSearchResult&&r?this.bridge.getSearchResult(r,e).map((function(o){var i;return new A.K(F(F({},o),{},{sheetId:r,key:e,blockId:n.id,bridge:n.bridge,cellId:o.key,blockManager:n.blockManager,scrollManage:null===(i=n.blockManager.getBlockViewByBlockIdNotCheck(n.id))||void 0===i?void 0:i.props.scrollManage}))})):[]}},{key:"replaceAll",value:function(e,n){var r=this;return n.forEach((function(n){var o=n.row,i=n.col,c=n.key,a=n.cellId,l=n.sheetId,s={replaceText:e,context:{row:o,col:i,key:a,searchKey:c,blockId:l,isReplaceable:!0},isReplaceAll:!0};r.bridge.replaceSearchItem(l,s)})),Promise.resolve()}}]),r}(j.X),i.type=M.B.SHEET,e=c,o=B()(e.prototype,"depLoader",[P.H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e);n.S=H}).call(this,r("dx_E9Eu"))},dx_aNmi:function(e,n,r){},dx_aP6o:function(e,n,r){},dx_aQ6g:function(e,n,r){"use strict";r.d(n,"i",(function(){return o})),r.d(n,"S",(function(){return i}));var o="page-block-header",i="doc_js_trigger_scroll_dev"},dx_aRuT:function(e,n,r){"use strict";r.d(n,"u",(function(){return u})),r.d(n,"n",(function(){return d})),r.d(n,"M",(function(){return f})),r.d(n,"l",(function(){return h})),r.d(n,"J",(function(){return p})),r.d(n,"C",(function(){return v}));var o,i,c,a,l=r("dx_lSNA"),s=r.n(l),u={COLOR_DEFAULT_BACKGROUND:"COLOR_DEFAULT_BACKGROUND",LIGHT_GRAY_BACKGROUND:"LIGHT_GRAY_BACKGROUND",LIGHT_RED_BACKGROUND:"LIGHT_RED_BACKGROUND",LIGHT_ORANGE_BACKGROUND:"LIGHT_ORANGE_BACKGROUND",LIGHT_YELLOW_BACKGROUND:"LIGHT_YELLOW_BACKGROUND",LIGHT_GREEN_BACKGROUND:"LIGHT_GREEN_BACKGROUND",LIGHT_BLUE_BACKGROUND:"LIGHT_BLUE_BACKGROUND",LIGHT_PURPLE_BACKGROUND:"LIGHT_PURPLE_BACKGROUND",DARK_NEUTRAL_BACKGROUND:"DARK_NEUTRAL_BACKGROUND",DARK_GRAY_BACKGROUND:"DARK_GRAY_BACKGROUND",DARK_RED_BACKGROUND:"DARK_RED_BACKGROUND",DARK_ORANGE_BACKGROUND:"DARK_ORANGE_BACKGROUND",DARK_YELLOW_BACKGROUND:"DARK_YELLOW_BACKGROUND",DARK_GREEN_BACKGROUND:"DARK_GREEN_BACKGROUND",DARK_BLUE_BACKGROUND:"DARK_BLUE_BACKGROUND",DARK_PURPLE_BACKGROUND:"DARK_PURPLE_BACKGROUND",COLOR_PINK_TEXT:"COLOR_PINK_TEXT",COLOR_ORANGE_TEXT:"COLOR_ORANGE_TEXT",COLOR_YELLOW_TEXT:"COLOR_YELLOW_TEXT",COLOR_GREEN_TEXT:"COLOR_GREEN_TEXT",COLOR_BLUE_TEXT:"COLOR_BLUE_TEXT",COLOR_PURPLE_TEXT:"COLOR_PURPLE_TEXT",COLOR_GRAY_TEXT:"COLOR_GRAY_TEXT",COLOR_DEFAULT_TEXT:"COLOR_DEFAULT_TEXT"},d=(o={},s()(o,u.COLOR_DEFAULT_TEXT,"text-title"),s()(o,u.COLOR_GRAY_TEXT,"N500"),s()(o,u.COLOR_PINK_TEXT,"R600"),s()(o,u.COLOR_ORANGE_TEXT,"O600"),s()(o,u.COLOR_YELLOW_TEXT,"Y600"),s()(o,u.COLOR_GREEN_TEXT,"G600"),s()(o,u.COLOR_BLUE_TEXT,"B600"),s()(o,u.COLOR_PURPLE_TEXT,"P600"),o),f=(i={},s()(i,u.COLOR_DEFAULT_BACKGROUND,"bg-float"),s()(i,u.LIGHT_GRAY_BACKGROUND,"N300"),s()(i,u.LIGHT_RED_BACKGROUND,"R100"),s()(i,u.LIGHT_ORANGE_BACKGROUND,"O100"),s()(i,u.LIGHT_YELLOW_BACKGROUND,"S100"),s()(i,u.LIGHT_GREEN_BACKGROUND,"G100"),s()(i,u.LIGHT_BLUE_BACKGROUND,"B100"),s()(i,u.LIGHT_PURPLE_BACKGROUND,"P100"),s()(i,u.DARK_NEUTRAL_BACKGROUND,"N200"),s()(i,u.DARK_GRAY_BACKGROUND,"N400"),s()(i,u.DARK_RED_BACKGROUND,"R200"),s()(i,u.DARK_ORANGE_BACKGROUND,"O200"),s()(i,u.DARK_YELLOW_BACKGROUND,"S200"),s()(i,u.DARK_GREEN_BACKGROUND,"G200"),s()(i,u.DARK_BLUE_BACKGROUND,"B200"),s()(i,u.DARK_PURPLE_BACKGROUND,"P200"),i),h=(c={},s()(c,u.LIGHT_GRAY_BACKGROUND,.6),s()(c,u.DARK_NEUTRAL_BACKGROUND,.7),s()(c,u.DARK_GRAY_BACKGROUND,.5),c),p=(a={},s()(a,u.COLOR_DEFAULT_BACKGROUND,""),s()(a,u.LIGHT_GRAY_BACKGROUND,"N100"),s()(a,u.LIGHT_RED_BACKGROUND,"ccmtoken-doc-highlightcolor-bg-red-soft"),s()(a,u.LIGHT_ORANGE_BACKGROUND,"ccmtoken-doc-highlightcolor-bg-orange-soft"),s()(a,u.LIGHT_YELLOW_BACKGROUND,"ccmtoken-doc-highlightcolor-bg-sunflower-soft"),s()(a,u.LIGHT_GREEN_BACKGROUND,"ccmtoken-doc-highlightcolor-bg-green-soft"),s()(a,u.LIGHT_BLUE_BACKGROUND,"ccmtoken-doc-highlightcolor-bg-blue-soft"),s()(a,u.LIGHT_PURPLE_BACKGROUND,"ccmtoken-doc-highlightcolor-bg-purple-soft"),s()(a,u.DARK_NEUTRAL_BACKGROUND,"ccmtoken-doc-highlightcolor-bg-neutral-light"),s()(a,u.DARK_GRAY_BACKGROUND,"N200"),s()(a,u.DARK_RED_BACKGROUND,"ccmtoken-doc-highlightcolor-bg-red-solid"),s()(a,u.DARK_ORANGE_BACKGROUND,"ccmtoken-doc-highlightcolor-bg-orange-solid"),s()(a,u.DARK_YELLOW_BACKGROUND,"ccmtoken-doc-highlightcolor-bg-sunflower-solid"),s()(a,u.DARK_GREEN_BACKGROUND,"ccmtoken-doc-highlightcolor-bg-green-solid"),s()(a,u.DARK_BLUE_BACKGROUND,"ccmtoken-doc-highlightcolor-bg-blue-solid"),s()(a,u.DARK_PURPLE_BACKGROUND,"ccmtoken-doc-highlightcolor-bg-purple-solid"),a),v=["rgb(245,246,247)","rgb(248, 249, 250)"]},dx_aaXo:function(e,n,r){},dx_acOG:function(e,n,r){"use strict";r.d(n,"N",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("pre-allow-edit-controller")},dx_aglp:function(e,n,r){e.exports=r.p+"module/media/snapshot_mindnote.c99b4bb0.png"},dx_ahlY:function(e,n,r){"use strict";r.d(n,"d",(function(){return i})),r.d(n,"y",(function(){return c}));var o=r("dx_h6a8");function i(e,n){return e&&e.classList&&Object(o.isFunction)(e.classList.contains)&&e.classList.contains(n)}function c(){var e=document.querySelector(".page-main");return(null===e||void 0===e?void 0:e.offsetTop)||0}},dx_amgp:function(e,n,r){"use strict";var o,i,c,a,l,s,u,d;r.d(n,"U",(function(){return o})),r.d(n,"x",(function(){return i})),r.d(n,"k",(function(){return c})),r.d(n,"V",(function(){return a})),r.d(n,"W",(function(){return l})),r.d(n,"l",(function(){return s})),r.d(n,"G",(function(){return u})),r.d(n,"m",(function(){return d})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.NORMAL=1]="NORMAL",e[e.INVALID=2]="INVALID",e[e.HIDE=3]="HIDE"}(o||(o={})),function(e){e[e.DOC_SDK_BATCH=2]="DOC_SDK_BATCH"}(i||(i={})),function(e){e[e.O=2]="O",e[e.KR=3]="KR",e[e.CLOSE=4]="CLOSE"}(c||(c={})),function(e){e[e.FULL=0]="FULL",e[e.STATUS=1]="STATUS"}(a||(a={})),function(e){e.SIMPLE="simple",e.ADVANCED="advanced"}(l||(l={})),function(e){e[e.USE_WORST=0]="USE_WORST",e[e.CUSTOM=1]="CUSTOM"}(s||(s={})),function(e){e[e.UNSET=-1]="UNSET",e[e.ON_TRACK=0]="ON_TRACK",e[e.AT_RISK=1]="AT_RISK",e[e.OFF_TRACK=2]="OFF_TRACK"}(u||(u={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.KR_DELETED=1]="KR_DELETED"}(d||(d={}))},dx_amsX:function(e,n,r){},dx_an0K:function(e,n,r){"use strict";r.d(n,"q",(function(){return c})),r.d(n,"N",(function(){return o})),r.d(n,"E",(function(){return a}));r("dx_RIqP");var o,i=r("dx_FFTT"),c=(r("dx_bPy9"),"OPEN_LINK_PANEL");function a(e,n){return e.getContent().ops.filter((function(e){var r=e.attributes;return!!r&&r[i.B]===n}))}!function(e){e.onlyLink="onlyLink",e.basic="basic"}(o||(o={}))},dx_anc2:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);r("dx_rC1h"),n.S=function(){return i.a.createElement("svg",{className:"circular",viewBox:"25 25 50 50"},i.a.createElement("circle",{className:"path",cx:"50",cy:"50",r:"20",fill:"none",strokeWidth:"4",strokeMiterlimit:"10"}))}},dx_av9k:function(e,n,r){"use strict";r.d(n,"q",(function(){return i})),r.d(n,"a",(function(){return c})),r.d(n,"V",(function(){return a})),r.d(n,"x",(function(){return l}));var o=r("dx_rQGm"),i=16,c=28,a=30,l=o.P},dx_ayEv:function(e,n,r){},dx_b1bI:function(e,n,r){"use strict";r.d(n,"c",(function(){return H}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_hbEN"),s=r("dx_RIqP"),u=r.n(s),d=r("dx_lSNA"),f=r.n(d),h=r("dx_o0o1"),p=r.n(h),v=r("dx_yXPU"),g=r.n(v),b=r("dx_UtDZ"),y=r("dx_h6a8"),m=r("dx_C7Cb"),_=r("dx_MsqB"),k=r("dx_yzqx"),O=r("dx_sBQB"),x=r("dx_LbJg"),E=r("dx_MmkF"),S=r("dx_oKt1"),C=Object(E.f)("TaskOfflineStorage"),I=k.S.isMobile&&k.S.isBytedanceApp,B=function(){function e(){i()(this,e),this.fakeDataKeySet=new Set,this.getRecordName=function(e,n){return"".concat("TASK_BLOCK_OFFLINE_STORAGE_","_").concat(e,"_").concat(n)}}return a()(e,[{key:"isRealPageToken",value:function(e){return e&&S.q&&!Object(S.q)(e)}},{key:"addFakeDataKey",value:function(e,n){this.fakeDataKeySet.add("".concat(e,"_").concat(n))}},{key:"hasFakeDataKey",value:function(e,n){return this.fakeDataKeySet.has("".concat(e,"_").concat(n))}},{key:"getRecordFromStorage",value:function(){var e=g()(p.a.mark((function e(n,r){var o,i,c,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.J)();case 2:return o=e.sent,e.next=5,o.getItem(this.getRecordName(n,r));case 5:if(!(i=e.sent)){e.next=8;break}return e.abrupt("return",i);case 8:if(!I||!this.isRealPageToken(n)){e.next=21;break}return e.next=11,x.S.getFakeToken(n);case 11:if(!(c=e.sent)){e.next=21;break}return C("try to get record by fake token. fakeToken: ".concat(Object(b.encryptTea)(c))),e.next=16,o.getItem(this.getRecordName(c,r));case 16:if(!(a=e.sent)){e.next=21;break}return C("got record string by fake token"),this.addFakeDataKey(n,r),e.abrupt("return",a.replace(new RegExp(c,"g"),n));case 21:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"removeRecordFromStorage",value:function(){var e=g()(p.a.mark((function e(n,r){var o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.J)();case 2:return o=e.sent,e.next=5,o.removeItem(this.getRecordName(n,r));case 5:if(!I||!this.hasFakeDataKey(n,r)){e.next=13;break}return e.next=8,x.S.getFakeToken(n);case 8:if(!(i=e.sent)){e.next=13;break}return C("remove record by fake token. fakeToken: ".concat(Object(b.encryptTea)(i))),e.next=13,o.removeItem(this.getRecordName(i,r));case 13:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"addRecord",value:function(){var e=g()(p.a.mark((function e(n,r,o){var i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C("add Record. pageToken: ".concat(Object(b.encryptTea)(n),", blockId: ").concat(Object(b.encryptTea)(r))),e.prev=1,e.next=4,Object(O.J)();case 4:return i=e.sent,e.next=7,i.setItem(this.getRecordName(n,r),JSON.stringify(o));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error("set storage fail",e.t0);case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"removeRecord",value:function(){var e=g()(p.a.mark((function e(n,r){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C("remove Record. pageToken: ".concat(Object(b.encryptTea)(n),", blockId: ").concat(Object(b.encryptTea)(r))),e.next=4,this.removeRecordFromStorage(n,r);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("remove storage fail",e.t0);case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(n,r){return e.apply(this,arguments)}}()},{key:"getRecord",value:function(){var e=g()(p.a.mark((function e(n,r){var o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,C("get Record. pageToken: ".concat(Object(b.encryptTea)(n),", blockId: ").concat(Object(b.encryptTea)(r))),e.next=4,this.getRecordFromStorage(n,r);case 4:if(!(o=e.sent)){e.next=8;break}return i=JSON.parse(o),e.abrupt("return",i);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("get storage fail",e.t0);case 13:return e.abrupt("return",void 0);case 14:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(n,r){return e.apply(this,arguments)}}()}]),e}(),T=new B,w=r("dx_L6L1"),R=r("dx_Cg1F"),M=r("dx_Z7aw"),j=r("dx_HWDJ"),D=r("dx_IBhU");function A(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function P(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?A(Object(r),!0).forEach((function(n){f()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var L=function(){function e(n){var r=this,o=n.blockManager,c=n.recordId,a=n.docToken,l=n.guid,s=n.modelManager;i()(this,e),this.guid=void 0,this.observers=void 0,this.data=void 0,this.remoteData=void 0,this.blockManager=void 0,this.isSyncing=void 0,this.docToken=void 0,this.modelManager=void 0,this.collaCallbacks=void 0,this.fetchReject=void 0,this.isLocalCreatingSync=void 0,this.fetchedStatus=_.FetchedStatus.none,this.fetch=g()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.guid){e.next=2;break}return e.abrupt("return");case 2:r.fetchedStatus=_.FetchedStatus.fetchting,r.notify(r.data,r.data),new Promise((function(e,n){r.fetchReject=n,Object(j.c)(r.docToken,"").fetch(r.guid).then(e).catch((function(){return e(null)}))})).then((function(e){return e?(r.guid===e.guid&&r.applyRemote(e),r.fetchedStatus=_.FetchedStatus.success):r.fetchedStatus=_.FetchedStatus.fail,r.notify(r.data,r.data),null})).finally((function(){r.fetchReject=void 0}));case 5:case"end":return e.stop()}}),e)}))),this.restore=g()(p.a.mark((function e(){var n,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.guid){e.next=2;break}return e.abrupt("return");case 2:return r.fetchReject&&r.fetchReject(),r.fetchedStatus=_.FetchedStatus.fetchting,r.notify(r.data,r.data),e.prev=5,n=Object(j.F)(r.docToken,r.currentUserId),e.next=9,n.fetch(r.guid);case 9:o=e.sent,r.guid===o.guid&&r.applyRemote(o),r.fetchedStatus=_.FetchedStatus.success,e.next=17;break;case 14:e.prev=14,e.t0=e.catch(5),r.fetchedStatus=_.FetchedStatus.fail;case 17:r.notify(r.data,r.data);case 18:case"end":return e.stop()}}),e,null,[[5,14]])}))),this.handlePush=function(e){e.guid===r.guid&&r.applyRemote(e)},this.handleOnline=function(){r.cacheId&&T.removeRecord(r.docToken,r.cacheId),r.collabConnector()},this.publish=function(){var e=g()(p.a.mark((function e(n){var o,i,c,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(b.isOnline)()){e.next=2;break}return e.abrupt("return",{error:"OFFLINE"});case 2:if(r.cacheId&&T.removeRecord(r.docToken,r.cacheId),!n.guid){e.next=7;break}return e.abrupt("return",Object(M.u)({docx_todos:f()({},n.guid,n),doc_token:r.docToken}));case 7:return r.isLocalCreatingSync=!0,o=Object(m.S)(),e.next=11,Object(j.K)({task:P(P({},n),{},{guid:o}),blockManager:r.blockManager,recordIds:u()(r.observers).map((function(e){return e.recordId})),onBeforeTransaction:function(){r.guid=o,r.apply({guid:o},{isNotColla:!0})}});case 11:return i=e.sent,c=i.error,a=i.data,r.isLocalCreatingSync=!1,c||Object(w.L)(o),e.abrupt("return",{error:c,data:a});case 17:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),this.collabConnector=Object(y.debounce)(g()(p.a.mark((function e(){var n,o,i,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.isSyncing){e.next=3;break}return r.collabConnector(),e.abrupt("return");case 3:if(!Object(R.I)(r.remoteData,r.data)){e.next=5;break}return e.abrupt("return");case 5:return r.isSyncing=!0,n=r.remoteData,r.remoteData=r.data,o=r.collaCallbacks,r.collaCallbacks=[],e.next=12,r.publish(r.data);case 12:i=e.sent,(c=i.error)?(r.remoteData=n,o.forEach((function(e){return e({error:c})}))):o.forEach((function(e){return e({data:r.data})})),r.isSyncing=!1;case 16:case"end":return e.stop()}}),e)}))),2e3,{leading:!1,trailing:!0}),this.guid=l,this.blockManager=o,this.observers=new Set,this.isSyncing=!1,this.docToken=a,this.modelManager=s,this.remoteData=Object(R.D)({block_id:c,docx_token:a}),this.data=Object(R.D)({block_id:c,docx_token:a}),this.collaCallbacks=[],Object(D.j)(this.handlePush),window.addEventListener("online",this.handleOnline),g()(p.a.mark((function e(){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=3;break}return e.next=3,r.fetch();case 3:if(r.cacheId){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,T.getRecord(r.docToken,r.cacheId);case 7:!(n=e.sent)||(n.guid||r.guid)&&n.guid!==r.guid||(T.removeRecord(r.docToken,r.cacheId),r.apply(n));case 9:case"end":return e.stop()}}),e)})))()}return a()(e,[{key:"currentUserId",get:function(){return b.userHelper.getCurrentUser().get("id")}},{key:"cacheId",get:function(){var e;return this.guid||(null===(e=this.data.source)||void 0===e?void 0:e.block_id)}},{key:"isLocalCreating",get:function(){return!this.data.guid&&!Object(R.E)(this.data)}}]),a()(e,[{key:"destory",value:function(){Object(D.K)(this.handlePush),window.removeEventListener("online",this.handleOnline),this.collabConnector.cancel()}},{key:"attach",value:function(e){this.observers.add(e)}},{key:"detach",value:function(e){this.observers.delete(e),this.shouldGarbage()&&(this.collabConnector(),this.modelManager.garbage())}},{key:"notify",value:function(e,n){this.observers.forEach((function(e){return e.handleTaskModelChange()}))}},{key:"shouldGarbage",value:function(){return 0===this.observers.size}},{key:"apply",value:function(e,n){var r=n||{},o=r.isNotColla,i=r.afterColla,c=r.immediatelyColla,a=this.data;this.data=Object.assign({},this.data,e),o&&(this.remoteData=Object.assign({},this.remoteData,e)),!Object(b.isOnline)()&&this.cacheId&&T.addRecord(this.docToken,this.cacheId,this.data),this.notify(this.data,a),o||(i&&this.collaCallbacks.push(i),this.collabConnector(),c&&this.collabConnector.flush())}},{key:"applyRemote",value:function(e){if(Object(R.I)(this.data,this.remoteData)&&!Object(R.I)(this.remoteData,e)&&!this.isSyncing){var n=this.data;this.remoteData=e,this.data=e,this.notify(this.data,n)}}},{key:"getData",value:function(){return this.data}}]),e}();function N(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return F(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function F(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var U=function(){function e(n,r){var o=this;i()(this,e),this.docToken=n,this.blockManager=r,this.modelPool=new Set,this.garbage=Object(l.default)((function(){var e,n=N(o.modelPool.values());try{for(n.s();!(e=n.n()).done;){var r=e.value;r.shouldGarbage()&&(r.destory(),o.modelPool.delete(r))}}catch(i){n.e(i)}finally{n.f()}}),1800,{trailing:!0,leading:!1})}return a()(e,[{key:"getModel",value:function(e){var n,r=e.guid,o=e.recordId,i=N(this.modelPool.values());try{for(i.s();!(n=i.n()).done;){var c,a=n.value;if(r&&r===a.guid)return a;if(!r&&(null===(c=a.getData().source)||void 0===c?void 0:c.block_id)===o)return a}}catch(s){i.e(s)}finally{i.f()}var l=new L({recordId:o,blockManager:this.blockManager,docToken:this.docToken,guid:r,modelManager:this});return this.modelPool.add(l),l}}]),e}();U.instance=void 0;var H=function(e,n){return U.instance&&U.instance.docToken===e&&U.instance.blockManager===n||(U.instance=new U(e,n)),U.instance}},dx_b28D:function(e,n,r){"use strict";r.d(n,"h",(function(){return u})),r.d(n,"e",(function(){return d}));var o,i,c=r("dx_NOtv"),a=r.n(c);function l(){var e=Date.now();return"".concat(e-(i=i||e)).padStart(5,"0")}function s(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];"string"===typeof e?a.a.log.apply(a.a,["%c%s%c ".concat(e),"color:green",l(),"color:unset"].concat(r)):a.a.log.apply(a.a,["%c%s%c","color:green",l(),"color:unset",e].concat(r))}function u(e){var n=a()(e);n.log=s;var r=function(e,r){for(var o=arguments.length,i=new Array(o>2?o-2:0),c=2;c<o;c++)i[c-2]=arguments[c];n.enabled&&n.apply(void 0,["%s ".concat(r),e].concat(i))};return Object.defineProperty(r,"enabled",{get:function(){return n.enabled}}),r}function d(e){var n=a()(e);return n.log=s,n}!function(e){e._=""}(o||(o={}))},dx_b3bd:function(e,n,r){},dx_b3bq:function(e,n,r){"use strict";r.d(n,"d",(function(){return b})),r.d(n,"dE",(function(){return y})),r.d(n,"t",(function(){return _})),r.d(n,"M",(function(){return k})),r.d(n,"g",(function(){return x})),r.d(n,"q",(function(){return E}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_RIqP"),s=r.n(l),u=r("dx_Vvd7"),d=r("dx_UtDZ"),f=r("dx_PQBD"),h=r("dx_B28d"),p=r("dx_ZG9w");function v(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return g(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function g(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function b(e,n,r){return!!Object(f.R)(e,r,h.r)||(!n||n.isShow(e))}function y(e,n,r){var o=[];return!function(e){try{return e[0]instanceof u.q}catch(n){return!1}}(n)&&!function(e){try{return Object(p.f)(e[0])}catch(n){return!1}}(n)&&!function(e){try{return void 0!==e[0].type}catch(n){return!1}}(n)?function(e){try{return void 0!==e[0].id&&!Object(p.f)(e[0])&&void 0===e[0].type}catch(n){return!1}}(n)&&(o=n.filter((function(n){return b(n.id,e,r)}))):o=n.filter((function(n){return b(n.id,e,r)})),o.length>1?{blockList:n,isMultiSel:!0}:{blockList:o,isMultiSel:!1}}var m=function e(n){var r=n.model,o=n.blockManager,i=n.fold,c=n.shouldIgnoreFold,a=n.forceFindBlockGroups;if((a.length?h.YW.filter((function(e){return!a.includes(e)})):h.YW).includes(r.type)||!c&&!b(r.id,i,o))return[];var l,u=[],d=v(r.children||[]);try{for(d.s();!(l=d.n()).done;){var f=l.value;if(o.hasBlockModelByBlockId(f.id)){var p=o.getBlockModelByBlockId(f.id);if(!c&&i&&!b(p.id,i,o))continue;u.push(p),u.push.apply(u,s()(e({model:p,blockManager:o,fold:i,shouldIgnoreFold:c,forceFindBlockGroups:a})))}}}catch(g){d.e(g)}finally{d.f()}return u};function _(e){var n,r=e.fold,o=e.blockList,i=e.shouldIgnoreFold,c=e.blockManager,a=e.recursive,l=void 0===a||a,s=e.forceFindBlockGroups,u=void 0===s?[]:s,d=[],f=v(o);try{for(f.s();!(n=f.n()).done;){var h=n.value.id,p=c.getBlockModelByBlockIdNotCheck(h);if(p&&(d.push(p),r&&l)){var g=m({model:p,blockManager:c,fold:r,shouldIgnoreFold:i,forceFindBlockGroups:u});d=d.concat(g)}}}catch(b){f.e(b)}finally{f.f()}return d}function k(e,n){return O.apply(this,arguments)}function O(){return(O=a()(i.a.mark((function e(n,r){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=n.filter((function(e){return!r.hasBlockViewByBlockId(e.id)})).map((function(e){return e.id}))).length){e.next=4;break}return e.next=4,r.layoutManager.renderNodeById(o);case 4:return e.abrupt("return",n.map((function(e){return r.getBlockViewByBlockId(e.id)})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){var n=e.blockManager;return k(_(e),n)}function E(){return Object(d.getMinaConfig)("ccm.docx.turninto_recursive_enabled",!1)}},dx_b9bF:function(e,n,r){"use strict";r.d(n,"a",(function(){return i})),r.d(n,"e",(function(){return c}));var o=r("dx_jtB3");function i(){return{defaultHeight:42,calculateModel:o.j.TABLE_ROW}}function c(e){var n=e||{},r=n.rows_id,o=n.columns_id,i=n.cell_set,c=[];if(r)for(var a=0,l=r.length;a<l;++a)for(var s=0,u=o.length;s<u;++s){c[a]||(c[a]=[]);var d="".concat(r[a]).concat(o[s]);i[d]&&(c[a][s]=i[d].block_id)}return c}},dx_bCzq:function(e,n,r){"use strict";(function(t){var e=r("dx_J4zp"),o=r.n(e),i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_PJYZ"),f=r.n(d),h=r("dx_iWIM"),p=r.n(h),v=r("dx_W8MJ"),g=r.n(v),b=r("dx_W7W2"),y=r.n(b),m=r("dx_a1gu"),_=r.n(m),k=r("dx_Nsbk"),O=r.n(k),x=r("dx_K5vg"),E=r("dx_TSYQ"),S=r.n(E),C=r("dx_UtDZ"),I=r("dx_h6a8"),B=r("dx_cDcd"),T=r.n(B),w=r("dx_Pz0G"),R=r("dx_ifle"),M=r("dx_O7Od"),j=r("dx_mz66"),D=r("dx_rQGm"),A=r("dx_yzqx"),P=r("dx_ukKW"),L=r("dx_y5yU"),N=r("dx_luPr"),F=r("dx_zEdG"),U=r("dx_CwnG"),H=r("dx_TwmW"),V=r("dx_B28d"),W=r("dx_MGoZ"),z=r("dx_yaFe"),G=r("dx_dOu9"),K=r("dx_zghO"),q=r("dx_Ogyw"),X=r("dx_Z8yN"),Y=r("dx_D8nn"),J=r("dx_d6al"),Z=r("dx_qx8A"),Q=r.n(Z),$=r("dx_sdxW"),ee=r("dx_X8XU"),te=r("dx_Mtob"),ne=r("dx_hr3X"),re=r("dx_h02A"),oe=r("dx_Lusj");r("dx_k7lD");function ie(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=O()(e);if(n){var i=O()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return _()(this,r)}}var ce,ae=Object(L.r)(x.S),le=C.blobHelper.getBlobUrl,se=C.blobHelper.isBlobUrl;!function(e){e.Initial="Initial",e.GifLoading="GifLoading",e.Finished="Finished"}(ce||(ce={}));var ue="docx-image",de=function(e){y()(r,e);var n=ie(r);function r(e){var o;if(u()(this,r),(o=n.call(this,e)).imagePerformance=null,o.beginLoadImage=!1,o.token=o.snapshot.image.token,o.gifCoverPending=!1,o.gifCoverLoading=!1,o.gifCoverLoadFailed=!1,o.isHydrateUrl=!1,o.hydrateUrl="",o.isMarkSrcFromCache=!1,o.isCollectDisplayEventNeedless=!1,o.collector=o.imageManager.collectorManager.get(o.id),o.contentRef=T.a.createRef(),o.state={resize:null,isSelected:!!o.selectionAPI.getSelection().find((function(e){var n=e.id;return o.id===n})),maskSrc:"",loadEnd:!1,progress:-1,isError:!1,hasText:!0,isOnline:!0,containerWidth:o.getContainerWidth(),src:"",isBlockReady:!1,isBigGif:o.isBigGif,bigGifLoadingStatus:ce.Initial,loadingSize:null,showExternalMask:!1,isContainerRendered:!1},o.handleClickImage=ne.I.bind(f()(o)),o.handleClickToSelect=function(){o.state.isSelected||o.selectionAPI.setSelection([{id:o.id,type:K.j.BLOCK}])},o.handleClickErrorPlaceholder=function(){var e=o.state,n=e.hasText,r=e.isOnline;n||o.handleClickToSelect(),r&&(o.collector.logRetry(),o.setState({isError:!1,src:Object(P.T)(o.snapshot.image.token,o.model.record.id)}))},o.handleImageError=function(){if(o.gifCoverLoading)return o.gifCoverLoading=!1,o.gifCoverLoadFailed=!0,o.showOriginalGif();var e=o.getImageRenderSize(),n=e.width>300&&e.height>300;o.setState({isError:!0,hasText:n},o.notifyRenderFinish),N.R.reportBlockLoadError({id:o.model.id,type:o.model.type}),o.imageManager.getGifCoverUrlCache(o.record.id)===o.state.src&&o.imageManager.deleteGifCoverUrlCache(o.record.id)},o.getViewSnapshot=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=o.props.hostElementRef.current;return e?n.querySelector(".image-block-container"):n},o.isElementInImageContainer=function(e){return!!e.closest(".image-block-container")},o.getImageContainer=function(){var e;return null===(e=o.hostElement)||void 0===e?void 0:e.querySelector(".image-block-container")},o.handleResizeStart=function(){Y.S.emit(D.V0),o.setState({resize:{scale:o.snapshot.image.scale}})},o.handleResizeUpdate=function(e){var n=o.calcScaleByDragDiff(e);o.setState({resize:{scale:n}})},o.handleResizeEnd=function(e){Y.S.emit(D.s);var n=o.calcScaleByDragDiff(e);o.model.applyTransaction("handleImageResizeEnd",(function(e){e.replace(o.record.id,["image","scale"],n)}));var r=o.getModelImageSize(),i=r.width,c=r.height,a=o.limitImageWidth(i);o.setState({resize:null});var l=Object(U.m)(o.id,o.blockManager);Object(F.P)("ccm_doc_content_page_click",Object(U.m)(o.parentId,o.blockManager),{click:"block_resize",object_block_data:[{object_block_id:Object(C.encryptTea)(l.record_id),object_block_type:l.block_type,object_sub_block_type:l.sub_block_type}],before_size:"".concat(Math.round(a),"x").concat(Math.round(c)),after_size:"".concat(Math.round(a+e.diffX),"x").concat(Math.round(c+e.diffY))})},o.hostElementHeight=0,o.notifyRenderFinish=function(){A.S.isMobile&&o.collector.logLoadImageEnd(),o.state.maskSrc||o.isCollectDisplayEventNeedless||o.collector.logDisplayImageEnd({load_fail:o.state.isError,token:o.snapshot.image.token,origin_src:Object(P.T)(o.snapshot.image.token,o.model.record.id)}),o.setState({isBlockReady:!0}),o.isFirstScreenImage()&&(N.R.reportBlockLoadStage(N.F.DATA_LOAD_START,{id:o.model.id,time:o.getImageLoadPerformance("fetchStart")}),N.R.reportBlockLoadStage(N.F.DATA_READY,{id:o.model.id,time:o.getImageLoadPerformance("responseEnd")}));var e=o.hostElementHeight!==o.hostElement.offsetHeight;o.props.recursionProps.isPresentationMode&&e&&(o.hostElementHeight=o.hostElement.offsetHeight),o.props.recursionProps.isPresentationMode&&Y.S.emit(Y.p.PRESENTATION.FORCE_UPDATE_PAGINATION),Promise.resolve().then((function(){N.R.reportBlockLoadStage(N.F.TTU,{id:o.model.id,time:(new Date).getTime(),isFromCache:o.isCollectDisplayEventNeedless})}))},o.getContainerStyle=function(){if(Object(H.S)())return o.getImageRenderSize();var e=o.getImageSize();return{width:e.width,paddingTop:"".concat((e.height/e.width*100).toFixed(6),"%")}},N.R.reportBlockLoadStage(N.F.INIT,{id:o.model.id,type:o.model.type,time:(new Date).getTime(),profile:o.getImageProfile()}),A.S.isMobile)return _()(o);if(e.recursionProps.isSSR){var i=o.snapshot.image,c=i.token,a=i.width,l=i.height,s=i.mimeType,d=i.scale;o.state.src=Object(P.c)({fileId:c,recordId:o.record.id,width:a,height:l,scale:d,imageType:s}),o.state.isBlockReady=!0,o.state.bigGifLoadingStatus=ce.Finished}else{var h=Object(J.Q)(o.record.id),p=o.imageManager.getImageInfo(o.record.id).url;if(o.state.progress=o.uploadFromLocal?0:-1,h&&h.src){var v=h.src;o.isHydrateUrl=!0,o.hydrateUrl=v,o.state.bigGifLoadingStatus=ce.Finished,A.S.isOpendoc?(o.state.isBlockReady=!1,o.initDataInOpendoc(v)):(o.state.isBlockReady=!0,o.state.src=v)}else p&&(o.state.isBlockReady=!0,o.state.src=p)}return o}return g()(r,[{key:"imageManager",get:function(){return this.editorAPI.getService(G.Y)}},{key:"imageDataCacheStorage",get:function(){return this.editorAPI.getService(z.V)}}]),g()(r,[{key:"getContainerWidth",value:function(){var e;return(null===(e=this.hostElement)||void 0===e?void 0:e.clientWidth)||te.m}},{key:"getSSRImageRecordIds",value:function(){if(r.ssrImageRecordIds)return r.ssrImageRecordIds;var e=document.querySelector("#ssrBox");return r.ssrImageRecordIds=Array.from((null===e||void 0===e?void 0:e.querySelectorAll(".docx-image-block"))||[]).map((function(e){var n;return null===(n=e.dataset)||void 0===n?void 0:n.recordId}))}},{key:"isFirstScreenImage",value:function(){return this.getSSRImageRecordIds().includes(this.record.id)}},{key:"getImageProfile",value:function(){var e=this.snapshot.image,n=e.token,r=e.mimeType,o=e.size,i=this.getImageRenderSize(),c=i.width,a=i.height;return{token:Object(C.encryptTea)(n),mimeType:r,size:o,width:c,height:a,isSSR:this.isFirstScreenImage(),firstScreenImageCount:this.getSSRImageRecordIds().length}}},{key:"setContainerWidth",value:function(){var e=this.getContainerWidth();e!==this.state.containerWidth&&this.setState({containerWidth:e})}},{key:"onResize",value:function(){this.setContainerWidth()}},{key:"initDataInOpendoc",value:function(e){var n=this;this.beginLoadImage=!0,(!!window.opendocSSRImage&&!!window.opendocSSRImage[e]?window.opendocSSRImage[e]:this.getBloBSrc(e)).then((function(e){return e&&n.setState({src:e,isBlockReady:!0})})).catch(this.handleImageError)}},{key:"getBloBSrc",value:function(){var e=l()(c.a.mark((function e(n){var r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(P.y&&!se(n)){e.next=3;break}return e.abrupt("return",n);case 3:return e.next=5,le(n);case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},{key:"isLoadSuccess",value:function(){var e=this.state,n=e.loadEnd,r=e.isError;return n&&!r}},{key:"isVisible",value:function(){return!this.props.recursionProps.isSSR&&(!this.isHydrateUrl||!this.hydrateUrl||(!!this.isLoadSuccess()||(!this.isHydrateUrl||this.state.src!==this.hydrateUrl)))}},{key:"onOrientationChange",value:function(){this.forceUpdate()}},{key:"initBigGifLoadingStatus",value:function(e){e&&e.isHD&&this.loadOriginalBigGif()}},{key:"blockViewDidMount",value:function(){var e=this;p()(O()(r.prototype),"blockViewDidMount",this).call(this);var n=this.snapshot.image,o=n.width,i=n.height,c=n.mimeType,a=this.imageManager.add(this.record.id,{url:this.state.src,isHD:Object(P.s)(c)||Object(P.w)(o,i)});if(this.uploadFromLocal){var l=this.imageDataCacheStorage.getValueOfKey(this.record.id);l&&(this.isMarkSrcFromCache=!0,this.setUploadBackground(l))}if(this.state.isBigGif&&this.initBigGifLoadingStatus(a),Object(H.S)()){var s=this.snapshot.image,u=s.token,d=s.width,f=s.height,h=s.mimeType,v=s.scale,g=Object(P.c)({fileId:u,recordId:this.record.id,width:d,height:f,scale:v,imageType:h});this.setState({src:g}),this.imageManager.update(this.record.id,{url:g,isHD:Object(P.s)(h)||Object(P.w)(d,f)}),this.state.isBigGif&&this.setState({bigGifLoadingStatus:ce.Finished})}Promise.resolve().then((function(){e.setContainerWidth(),e.setState({isContainerRendered:!0})}))}},{key:"blockViewWillUnmount",value:function(){p()(O()(r.prototype),"blockViewWillUnmount",this).call(this),this.imageManager.delete(this.getImageInfo(),this.model.record.id,this.id)}},{key:"blockViewDidUpdate",value:function(e,n){p()(O()(r.prototype),"blockViewDidUpdate",this).call(this,e,n),A.S.isMobile&&!this.state.isBlockReady&&this.snapshot.image.token&&Y.S.emit(Y.p.MOBILE.IMAGE.ADD_IMAGE),this.props.record.snapshot.image.token!==this.token&&this.state.maskSrc&&(this.setState({src:this.state.maskSrc,bigGifLoadingStatus:ce.Finished}),this.isMarkSrcFromCache||this.imageManager.update(this.record.id,{url:this.state.maskSrc,isHD:!Object(P.TM)(this.state.maskSrc)})),this.token=this.props.record.snapshot.image.token,this.setContainerWidth()}},{key:"setSelected",value:function(e){this.setState({isSelected:e})}},{key:"setUploadBackground",value:function(e){this.setState({maskSrc:e})}},{key:"updateOnlineStatus",value:function(e){this.state.isOnline!==e&&this.setState({isOnline:e})}},{key:"showPreview",value:function(){Y.S.emit(Y.p.COMMON.OPEN_IMAGE_VIEWER,this)}},{key:"setUploadProgress",value:function(e){this.setState({progress:e})}},{key:"changeAlign",value:function(e){var n=this;this.snapshot.align!==e&&this.model.applyTransaction("imageChangeAlign",(function(r){r.replace(n.record.id,["align"],e)}))}},{key:"getLoadingScale",value:function(e){var n=e.width,r=e.height,o=1,i=1;return n<te.F&&(o=n/te.F),r<te.F&&(i=r/te.F),Math.min(o,i)}},{key:"getImageSize",value:function(){var e=this,n=this.snapshot.image,r=n.width,o=n.height,i=n.scale,c=this.state.loadingSize;if(c&&c.height&&c.width&&(r=c.width,o=c.height),this.state.resize){var a=this.state.resize.scale;return{width:r*a,height:o*a}}var l=te.a/(r*i);return l>1?(this.model.applyTransaction("smallImageInitSize",(function(n){n.replace(e.record.id,["image","scale"],i*l)})),{width:r*i*l,height:o*i*l}):{width:r*i,height:o*i}}},{key:"getModelImageSize",value:function(){var e=this.snapshot.image,n=e.width,r=e.height,o=e.scale;return{width:n*o,height:r*o}}},{key:"getImageRenderSize",value:function(){var e=this.getImageSize(),n=e.width,r=e.height,o=this.state.containerWidth;return n>o?{width:o,height:o*(r/n)}:{width:n,height:r}}},{key:"limitImageWidth",value:function(e){return this.openDocxImageConfig&&this.openDocxImageConfig.maxWidth?Math.max(te.a,Math.min(this.state.containerWidth,e,this.openDocxImageConfig.maxWidth)):Math.max(te.a,Math.min(this.state.containerWidth,e))}},{key:"calcScaleByDragDiff",value:function(e){var n=this.limitImageWidth(this.getModelImageSize().width),r=this.snapshot.align&&this.snapshot.align!==V.D.CENTER?1:2;return this.limitImageWidth(n+e.diffX*r)/this.snapshot.image.width}},{key:"getImageInfo",value:function(){var e=this.snapshot.image,n=e.token,r=e.width,o=e.height,i=e.mimeType,c=e.scale,a=this.state,l=a.isBigGif,s=a.bigGifLoadingStatus,u=Object(P.s)(i)&&!l||Object(P.w)(r,o)||l&&s===ce.Finished;return{uuid:this.record.id,token:n,isHD:u,width:r,height:o,scale:c}}},{key:"fetchImage",value:function(e,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:I.noop;this.collector.logLoadImageStart(),N.R.reportBlockLoadStage(N.F.DATA_LOAD_START,{id:this.model.id,time:(new Date).getTime()}),this.imageManager.fetch(e,this.model.record.id,{},(function(i){r.collector.logCdnFetchStatus(i.fetchCdnLogStatus),r.collector.logLoadImageEnd(),N.R.reportBlockLoadStage(N.F.DATA_READY,{id:r.model.id,time:(new Date).getTime()}),r.isCollectDisplayEventNeedless=!!i.isFromCache,r.state.src!==i.src?(r.imageManager.update(r.record.id,{url:i.src,isHD:e.isHD}),r.setState({src:i.src},o)):o(),n&&n(i)}))}},{key:"setExternalImageState",value:function(e,n){this.setState({src:n.isSuccess?e:"",loadingSize:n.imageSize,showExternalMask:n.isSuccess})}},{key:"loadImage",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return new Promise(function(){var r=l()(c.a.mark((function r(o){var i,a,l,s,u,d,f,h,p,v;return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(i=e.snapshot.image,a=i.token,l=i.width,s=i.height,u=i.mimeType,d=i.scale,f=e.state,h=f.maskSrc,p=f.src,v=e.getImageInfo(),!(!a||h&&!n||p||e.beginLoadImage)){r.next=5;break}return r.abrupt("return",o());case 5:if(e.beginLoadImage=!0,e.collector.logDisplayImageStart(),e.collector.logDisplayBase({mime_type:e.snapshot.image.mimeType,origin_size:e.snapshot.image.size,page_token:Object(C.encryptTea)(e.blockManager.rootRecordId)}),!A.S.isMobile||A.S.isOpendoc){r.next=12;break}return e.setState({src:Object(P.c)({fileId:a,recordId:e.record.id,width:l,height:s,scale:d,imageType:u})}),e.collector.logLoadImageStart(),r.abrupt("return",o());case 12:e.fetchImage(v,(function(n){e.isBigGif&&e.imageManager.setGifCoverUrlCache(e.record.id,n.src)}),(function(){o()}));case 13:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}},{key:"loadOriginalBigGif",value:function(){var e=this,n=this.getImageInfo();Object.assign(n,{isHD:!0}),this.collector.logPlayBigGif(this.snapshot.image.token,this.model.record.id),this.setState({bigGifLoadingStatus:ce.GifLoading}),this.fetchImage(n,(function(n){e.imageManager.update(e.record.id,{url:n.src,isHD:!0}),e.setState({bigGifLoadingStatus:ce.Finished})}))}},{key:"showOriginalGif",value:function(){this.isCollectDisplayEventNeedless=!0;var e=this.state,n=e.isBigGif,r=e.bigGifLoadingStatus;if(!n||r===ce.Finished){var o=this.imageManager.getImageInfo(this.record.id).url;o&&(this.gifCoverPending=!1,this.setState({src:o}))}}},{key:"showCoverGif",value:function(){var e=this;this.isCollectDisplayEventNeedless=!0;var n=this.state,r=n.src,i=n.isBigGif,c=n.bigGifLoadingStatus;if((!A.S.isMobile||!A.S.isBytedanceApp)&&r&&(!i||c===ce.Finished)&&!this.gifCoverLoadFailed){var a=this.imageManager.getGifCoverUrlCache(this.record.id);if(a)return this.gifCoverLoading=!0,void this.setState({src:a});var l=this.snapshot.image,s=l.token,u=l.width,d=l.height,f=l.mimeType,h=l.scale,p=Object(P.c)({fileId:s,recordId:this.record.id,width:u,height:d,scale:h,imageType:f,forceCover:!0});this.gifCoverPending=!0,Promise.all([le(r),le(p)]).then((function(n){var r=o()(n,2),i=r[0],c=r[1];return i&&c?(e.imageManager.update(e.record.id,{url:i,isHD:!0}),e.imageManager.setGifCoverUrlCache(e.record.id,c),e.gifCoverPending?(e.gifCoverLoading=!0,void e.setState({src:c})):console.log(e.id,"generate gif cover canceled")):console.log(e.id,"generate gif cover failed",!!i,!!c)})).catch((function(n){return console.error(e.id,"generate gif cover failed",n)})).finally((function(){e.gifCoverPending=!1}))}}},{key:"renderErrorPlaceholderText",value:function(){return this.state.isOnline?T.a.createElement("p",null,t("CreationDoc_DocX_Block_Load_Fail"),T.a.createElement("button",{type:"button",onClick:this.handleClickErrorPlaceholder,className:"retry-btn"},t("CreationDoc_Docs_TwoWayLinks_LoadingError_Toast12"))):T.a.createElement("p",null,t("CreationDoc_DocX_Block_Load_Fail"),T.a.createElement("span",{className:"retry-btn"},t("CreationDoc_Docs_TwoWayLinks_LoadingError_Toast12")))}},{key:"renderErrorPlaceholder",value:function(){var e=this.state,n=e.isSelected,r=e.hasText,o=e.isOnline,i=e.isError;return T.a.createElement("div",{className:S()("image-block-error",{selected:n}),style:{cursor:!r&&o&&i?"pointer":"initial"},onClick:this.handleClickErrorPlaceholder,draggable:"false",contentEditable:!1},T.a.createElement("div",{className:"image-block-error-content docx-retry-content"},T.a.createElement("div",null,T.a.createElement(ae,{style:{maxHeight:"88px",maxWidth:"88px"}})),r&&this.renderErrorPlaceholderText()))}},{key:"renderLoadingPlaceholder",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return T.a.createElement("div",{className:"loading-placeholder-wrapper"},T.a.createElement(w.S,{displayMode:V.J.BLOCK,loadingIconScale:e}))}},{key:"renderExternalMask",value:function(){return T.a.createElement("div",{className:"external-placeholder-wrapper"},T.a.createElement(oe.G,null))}},{key:"hideExternalMask",value:function(){this.setState({showExternalMask:!1})}},{key:"getImageLoadPerformance",value:function(e){var n;if(!this.imagePerformance){var r=this.snapshot.image.token;this.imagePerformance=window.performance.getEntries().filter((function(e){return"img"===(null===e||void 0===e?void 0:e.initiatorType)&&e.name.includes(r)})).pop()}return Math.floor((null===(n=this.imagePerformance)||void 0===n?void 0:n[e])+window.performance.timeOrigin)}},{key:"renderImage",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getImageSize(),o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.props.recursionProps,c=this.state,a=c.isBigGif,l=c.bigGifLoadingStatus,s=function(){l===ce.Initial&&n.loadOriginalBigGif()},u=S()(ue,X.N,{success:this.isLoadSuccess()}),d={maxWidth:"100%",visibility:this.isVisible()?void 0:"hidden"},f=function(){return A.S.isMobile||l===ce.Finished?null:T.a.createElement("div",{className:"gif-loading-wrapper",onClick:s},T.a.createElement($.S,{className:"gif-loading-bg"}),l===ce.Initial&&T.a.createElement(ee.S,null),l===ce.GifLoading&&T.a.createElement(oe.G,null))};return T.a.createElement(R.S,{type:j.J.Proportional,sensitivity:1,onResizeStart:this.handleResizeStart,onResizeUpdate:this.handleResizeUpdate,onResizeEnd:this.handleResizeEnd,boundary:this.boundary,editable:this.config.editable,blockId:this.id,selectionAPI:this.selectionAPI},a&&T.a.createElement(f,null),T.a.createElement("div",{className:S()("img",{highlight:this.state.isSelected,loading:o,ssr:i.isSSR}),style:{borderColor:this.borderColor}},T.a.createElement("img",{ref:this.contentRef,draggable:"false",onClick:this.handleClickImage,src:e,style:d,className:u,width:r.width,height:r.height,onLoadStart:function(){return n.setState({loadEnd:!1})},onLoad:function(){n.gifCoverLoading=!1,n.setState({loadEnd:!0}),n.notifyRenderFinish()},onError:this.handleImageError})))}},{key:"render",value:function(){var e=this.props,n=e.displaymode,r=e.onBlockClick,o=this.state,i=o.maskSrc,c=o.isSelected,a=o.loadEnd,l=o.progress,s=o.isError,u=o.src,d=o.isBlockReady,f=o.showExternalMask,h=o.isContainerRendered;if(n===V.J.INLINE)return T.a.createElement("div",{className:"image-block inline"},t("editorbar.image"));var p=this.getImageSize(),v=this.getImageRenderSize(),g=this.getLoadingScale(v),b=!1,y=!1,m=!1,_=!1;return s?b=!0:u?y=!0:a||(_=!!i),d||i||(m=!0),T.a.createElement("div",{className:S()("image-block","align-".concat(this.snapshot.align||V.D.CENTER),{active:c}),contentEditable:!1,"image-token":this.snapshot.image.token||""},T.a.createElement("div",{className:S()("image-block-width-wrapper",q.B),style:{width:p.width},onClick:function(e){var n=e.target.className.split(" ");n.includes(M.T)||n.includes(M.E)||r(e)}},T.a.createElement("div",{className:"image-block-container",style:this.getContainerStyle()},b&&this.renderErrorPlaceholder(),y&&this.renderImage(u,p,m),f&&this.renderExternalMask(),h&&m&&!this.uploadFromLocal&&this.renderLoadingPlaceholder(g),_&&T.a.createElement(re.g,{src:i,width:p.width,height:p.height,progress:l,onClick:this.handleClickToSelect}))))}},{key:"contentElement",get:function(){return this.contentRef.current}},{key:"openDocxImageConfig",get:function(){return C.selectors.openDoc.getFeatureConfigSelector(C.FEATURE.IMAGE)(Q.a.getState())}},{key:"isBlockRendered",get:function(){return this.state.isBlockReady}},{key:"pageToken",get:function(){return this.config.get("token")}},{key:"imgSrc",get:function(){return this.state.src}},{key:"borderColor",get:function(){var e=this.props,n=e.syncCursorSelected,r=e.syncCursorBorderColor;return!this.state.isSelected&&n?r:void 0}},{key:"isBigGif",get:function(){return Object(P.Vb)(this.snapshot.image)}},{key:"isUploading",get:function(){return this.state.progress>=0&&this.state.progress<1}},{key:"uploadFromLocal",get:function(){return!this.props.recursionProps.isHistory&&!this.snapshot.image.token&&this.imageDataCacheStorage.hasKey(this.record.id)}}],[{key:"selectionTargetFilter",value:function(e){return!e.closest(".image-block-container")}}]),r}(W.l);de.type=V.B.IMAGE,de.ssrImageRecordIds=null,n.S=de}).call(this,r("dx_E9Eu"))},dx_bD2y:function(e,n,r){"use strict";r.d(n,"Y",(function(){return V.S}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W7W2"),a=r.n(c),l=r("dx_a1gu"),s=r.n(l),u=r("dx_Nsbk"),d=r.n(u),f=r("dx_Vvd7"),h=r("dx_N9dL"),p=r("dx_T4T0"),v=r("dx_Z22N"),g=r("dx_B28d"),b=r("dx_Fimk"),y=r("dx_fEKD");var m,_,k,O,x,E,S=r("dx_pzLC"),C=r("dx_o0o1"),I=r.n(C),B=r("dx_yXPU"),T=r.n(B),w=r("dx_yG8O"),R=r.n(w),M=r("dx_W8MJ"),j=r.n(M),D=r("dx_Uyc2"),A=r.n(D),P=(r("dx_A1AB"),r("dx_xjz2")),L=r("dx_UtDZ"),N=r("dx_imty"),F=r("dx_YRGG"),U=r("dx_D8nn"),H=Object(P.s)(F.h)((_=function(){function e(){var n=this;i()(this,e),this.type=g.B.DIAGRAM,this.listenOnline=!1,this.listenOffline=!1,this.listenEditableChange=!1,R()(this,"config",k,this),this.handleEditableChange=function(e){e.curr&&!L.diagramResourceLoader.loaded&&n.fetchResource()},this.handleOnline=T()(I.a.mark((function e(){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.fetchResource();case 1:case"end":return e.stop()}}),e)}))),this.handleOffline=T()(I.a.mark((function e(){return I.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.listenOnline||(window.addEventListener("online",n.handleOnline),n.listenOnline=!0);case 1:case"end":return e.stop()}}),e)}))),this.fetchResource=function(){if(Object(L.isOnline)()){if(n.config.get("editPermission"))return n.listenOffline||(window.addEventListener("offline",n.handleOffline),n.listenOffline=!0),L.diagramResourceLoader.loadAll().then((function(e){return L.diagramResourceLoader.loaded&&n.clearListener(),e}));n.listenEditableChange||(U.N.on(N.H.EditableChange,n.handleEditableChange),n.listenEditableChange=!0)}else n.listenOnline||(window.addEventListener("online",n.handleOnline),n.listenOnline=!0);return Promise.resolve()}}return j()(e,[{key:"clearListener",value:function(){this.listenEditableChange&&(U.N.off(N.H.EditableChange,this.handleEditableChange),this.listenEditableChange=!1),this.listenOnline&&(window.removeEventListener("online",this.handleOnline),this.listenOnline=!1),this.listenOffline&&(window.removeEventListener("offline",this.handleOffline),this.listenOffline=!1)}},{key:"canPrefetchResource",value:function(){return!0}},{key:"destroy",value:function(){this.clearListener()}}]),e}(),k=A()(_.prototype,"config",[f.j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),m=_))||m,V=r("dx_nTXv");function W(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var z=(O=Object(f.H)({providers:[H,{provide:v.I,useClass:p.V,args:[g.B.DIAGRAM,{isAsync:!0,defaultHeight:220}]},{provide:h.RecordSnapshotCreator,useValue:{type:g.B.DIAGRAM,create:function(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.B.DIAGRAM;return Object(b.N)("client_insert_diagram",{create_source:"unknown",block_subtype:null===(n=e.diagram)||void 0===n?void 0:n.diagramType}),Object(y.b)(e,r)}}}]}),O((E=function(e){a()(r,e);var n=W(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).blocks=[[S.S,{viewCreator:V.S}]],e}return r}(f.y),x=E))||x),G=z;n.S=G},dx_bEBp:function(e,n,r){"use strict";r.d(n,"I",(function(){return B})),r.d(n,"C",(function(){return T}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_o0o1"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_W7W2"),v=r.n(p),g=r("dx_a1gu"),b=r.n(g),y=r("dx_Nsbk"),m=r.n(y),_=r("dx_Dq30"),k=r("dx_G3VO"),O=r("dx_Fwx7"),x=r("dx_KTtu"),E=r("dx_Dw4b"),S=r("dx_m0BX");function C(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}function I(e){var n;return!!e.getRecord(e.rootRecordId).snapshot.cover&&(null===(n=document.querySelector(".".concat(_.P)))||void 0===n?void 0:n.clientHeight)||0}var B=function(e){v()(r,e);var n=C(r);function r(e){var o;return d()(this,r),(o=n.call(this,e)).range=void 0,o.type=x.V.TextBlock,o.range=e.range,o}return h()(r,[{key:"replaceWith",value:function(){var e=s()(a.a.mark((function e(n){var r,o,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isReplaceable){e.next=2;break}return e.abrupt("return");case 2:return r=this.currentBlockModel,this.range[1]-this.range[0]<=0&&console.error("[Replace] illegal range: ".concat(this.range)),o=r,i=Object(k.J)(o.contentState,[this.range[0],this.range[0]+1]),c=o.contentState.getAttributes(i.start,i.end).toMap(),e.next=9,o.replaceText(this.range,{text:n,mark:c});case 9:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"scrollIntoView",value:function(e,n,r,o){var c=this,l=this.blockId,u=n.getRecordByBlockId(l).id;return e.scrollToRecord(u,s()(a.a.mark((function e(){var s,u,d,f,h,p,v,g;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=i()(c.range,2),u=s[0],d=s[1],f=r.getCaretRect(l,u,l,!0),h=r.getCaretRect(l,d,l,!1),p=r.getBlockRect(l).top+I(n),v=p+f.top,g=p+h.bottom,Object(S.E)({startTop:v,endBottom:g,scrollContainer:o});case 7:case"end":return e.stop()}}),e)}))))}},{key:"isReplaceable",get:function(){return!0}}]),r}(E.S),T=function(e){v()(r,e);var n=C(r);function r(e){var o;return d()(this,r),(o=n.call(this,e)).contentOffset=void 0,o.type=x.V.TextEmbedBlock,o.contentOffset=e.offset,o}return h()(r,[{key:"scrollIntoView",value:function(e,n,r,o){var i=this,c=this.blockId,l=n.getRecordByBlockId(c).id;return e.scrollToRecord(l,s()(a.a.mark((function e(){var l,s,u,d,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:l=i.blockManager.getBlockViewByBlockId(c),s=Object(O.C)({editor:l.editorInstance,blockId:l.id,rect:r,range:i.range,offset:i.contentOffset}),u=r.getBlockRect(c).top+I(n),d=u+s.top,f=u+s.bottom,Object(S.E)({startTop:d,endBottom:f,scrollContainer:o});case 6:case"end":return e.stop()}}),e)}))))}},{key:"isReplaceable",get:function(){return!1}}]),r}(B)},dx_bME5:function(e,n,r){"use strict";(function(e){r.d(n,"D",(function(){return m})),r.d(n,"F",(function(){return _})),r.d(n,"n",(function(){return k})),r.d(n,"f",(function(){return O})),r.d(n,"Q",(function(){return S}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_UtDZ"),a=(r("dx_rQGm"),r("dx_H1q2")),l=(r("dx_zEdG"),r("dx_gwTP")),s=r("dx_eSV8"),u=r("dx_g0R0"),d=r("dx_B28d"),f=r("dx_D8nn"),h=r("dx_vW17"),p=r("dx_R1R5");function v(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function g(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?v(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var b=null;function y(){return{record_id:Object(c.getToken)(),block_type:d.B.PAGE,sub_block_type:""}}function m(e){b=new l.a(h.d,l.v.Click,y(),{oopsType:e,target:"none",click:h.B},!1)}function _(e,n){b&&(b.setExtraData({action_type:e}),n?b.setExtraData({actionValue:n}):b.deleteExtraData("actionValue"),b.send())}function k(e){var n=e.type,r=e.event,o=e.editable,i=void 0!==o&&o,c=r.code,a=void 0===c?"":c,l=r.msg,s=void 0===l?"":l,u=r.type,d=void 0===u?"":u,f=r.requestId,h=void 0===f?"":f,p=r.ttLogId,v=void 0===p?"":p,b=E(r),y="[".concat(n," error] errorMsg: ").concat(s,"; requestId: ").concat(h,"; ttLogId: ").concat(v," code: ").concat(a,"; type: ").concat(d,";");x(g({error:new Error(y),editable:i},b))}function O(e,n){x(g({error:e,editable:n},E(e)))}function x(e){var n=e.error;Object(u.Z)(n),Object(s.n)(n),Object(p.S)(e),f.S.emit(f.p.COMMON.SHOW_OOPS,e)}function E(e){var n=e.code,r=e.msg,o=e.type,i=e.url,c=e.queryParams,l=e.requestId,s=e.ttLogId,u=Object(a.H)();return{msg:r,type:o,code:n,scm:u.scm,scmDocx:u.scmDocx,url:i,queryParams:c,requestId:l,ttLogId:s,isDev:Object(a.w)()}}function S(){e.env.NODEJS||(window._oops_={mockFatal:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(p.S)(g({isDev:!0,error:new Error("mock oops dialog"),code:e,editable:n},r))},get isDebugMode(){return Object(a.w)()},enableDebugMode:function(){window.User&&(window.User.isDebugMode=!0)}})}}).call(this,r("dx_o8ox"))},dx_bPy9:function(e,n,r){"use strict";r.d(n,"G",(function(){return O})),r.d(n,"e",(function(){return x})),r.d(n,"o",(function(){return E})),r.d(n,"w",(function(){return S})),r.d(n,"f",(function(){return C})),r.d(n,"U",(function(){return I})),r.d(n,"T",(function(){return B})),r.d(n,"y",(function(){return T})),r.d(n,"B",(function(){return w})),r.d(n,"J",(function(){return R})),r.d(n,"G2",(function(){return M})),r.d(n,"b",(function(){return j})),r.d(n,"j",(function(){return D})),r.d(n,"v",(function(){return A}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_QxNg"),a=r("dx_YXvU"),l=r("dx_e4eN"),s=r("dx_M30o"),u=r("dx_alfx"),d=r("dx_BuQo"),f=r("dx_vdIl"),h=r("dx_UtDZ"),p=r("dx_h6a8"),v=r("dx_IdzY"),g=r("dx_WI8P"),b=r("dx_Vd2b");function y(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return m(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function m(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function _(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function k(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?_(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function O(e,n){var r={},o=e.getEntities(n);if(0===o.length)return r;var i={},c=o.shift();r=k({},c.attributes),Object.keys(r).forEach((function(e){r[e]&&(i[e]=1)}));var l=1;return o.forEach((function(e){var n=e.attributes,o=++l;e.text!==a.J?Object.keys(n).forEach((function(e){n[e]===r[e]&&(i[e]=i[e]+1),i[e]!==o&&r[e]&&delete r[e]})):Object.keys(i).forEach((function(e){return i[e]++}))})),r}function x(e,n){var r={},o=e.getEntities(n);if(0===o.length)return r;var i=o.shift();return r=k({},i.attributes),o.some((function(e){var n=Object.keys(r);if(!n.length)return!0;if(e.text===a.J)return!1;var o=e.attributes;return n.forEach((function(e){o[e]||delete r[e]})),!1})),r}function E(e,n,r){var o=Object(u.Z)(e.initialAttributedTexts,e.apool),i=new d.O({deltaSet:o,schema:g.S,modulesContainer:v.g});return i.setAttributes({start:k(k({},n.start),{},{zoneId:f.x}),end:k(k({},n.end),{},{zoneId:f.x})},r),i.getZoneState(f.x).toAttributeText()}function S(e){var n=C(e);return Object(u.Z)(n.initialAttributedTexts,n.apool).concat((new l.m).insertEnter({fixEnter:"true"}))}function C(e){if(!e.apool||!e.initialAttributedTexts)return e;var n=Object(p.cloneDeep)(e),r=n.apool,o=n.initialAttributedTexts,i=r.nextNum,c=r.numToAttrib,a=o.attribs,l={},s={},u={},d=0;if(Object.keys(c).forEach((function(e){var n=Number(e),r=c[e][0]+c[e][1];if("inline-component"===c[e][0]&&void 0!==s[r])return u[n]=s[r],void d++;u[n]=n-d,l[n-d]=c[e],s[r]=n-d})),!d)return e;var f=a[0].replace(/\*[0-9a-z\*]+\+/g,(function(e){var n={};return e.replace(/\*[0-9a-z]+/g,(function(e){var r=u[parseInt(e.slice(1),36)].toString(36);return n[r]?"":(n[r]=!0,"*".concat(r))}))}));return n.apool.numToAttrib=l,n.apool.nextNum=i-d,n.initialAttributedTexts.attribs[0]=f,Object(h.collectEvent)("ccm_diagram_block_log_dev",{action:"remove_inline_attributes",text:"delNum: ".concat(d,", old: ").concat(Object.keys(c).length,", new: ").concat(Object.keys(l).length)+"old attr: ".concat(e.initialAttributedTexts.attribs[0],", new attr: ").concat(f)}),n}function I(e){if(!e.apool)return!1;var n=e.apool.numToAttrib,r=!1,o={};return Object.keys(n).forEach((function(e){var i=n[e][0]+n[e][1];"inline-component"===n[e][0]&&o[i]&&(r=!0),o[i]=n[e]})),r}function B(e,n){var r=S(e);return Object(b.E)(r,n)}function T(e){var n=[];return e.forEach((function(e){var r;e.insert&&((null===(r=e.attributes)||void 0===r?void 0:r.inlineCode)?n.push(new Array(e.insert.length).fill("Z").join("")):n.push(e.insert))})),n}function w(e,n){return e.length()===n.length()&&e.ops.every((function(e,r){var o=n.ops[r];if(void 0===o)return!1;if(e.insert!==o.insert)return!1;var i=e.attributes||{},c=o.attributes||{},a=Object.keys(i),l=Object.keys(c);return a.length===l.length&&a.every((function(e){return i[e]===c[e]||(i[e]&&"string"!==typeof i[e]&&console.warn("attributes value is not string"),!1)}))}))}function R(e,n){var r,o=0,i=[0,0],c=!1,a=y(e.getContent().ops);try{for(a.s();!(r=a.n()).done;){var l=r.value;if(Object(s.X)(l)&&(i=[o,o+=l.insert.length],l===n)){c=!0;break}}}catch(u){a.e(u)}finally{a.f()}if(!c)throw new Error("node not found");return i}function M(e){return Object(s.X)(e)?e:{insert:e.text,attributes:e.mark}}function j(e){var n=e.nonundoable,r=e.isRemote,o=e.extra,i={};return void 0!==n&&(i.undoable=!n),r&&(i.from=c.H.remote),o&&(i.extra=o),(null===o||void 0===o?void 0:o.mergeMode)&&(i.mergeMode=o.mergeMode),i}function D(e){return Number(e)}function A(e){return String(e)}},dx_bQQe:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{opacity:.01,fill:"#D8D8D8",d:"M0 0h230v230H0z"}),l=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5 186h185V34H5v152z",fill:"#D6DAE1"}),s=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M165 72.961L148.662 178 20 158.04 36.338 53 165 72.961z",fill:"#F4F5F9"}),u=i.a.createElement("path",{d:"M48 147l9-76M61 149l9-76",stroke:"#fff",strokeWidth:2}),d=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M224.266 162.274c-4.882 35.866-37.802 60.966-73.526 56.064-35.724-4.901-60.728-37.95-55.845-73.813 4.882-35.866 37.802-60.966 73.526-56.065 35.725 4.903 60.727 37.95 55.845 73.814",fill:"#FFC200"}),f=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.298 35.132h55.503v-24.98H5.298v24.98z",fill:"#B5BEC8"}),h=i.a.createElement("path",{d:"M111.812 148.66s47.05 44.75 96.577 0M130.385 162.333l-8.667 16.16M160.101 169.792v19.889M188.578 163.577l12.382 13.673",stroke:"#18263C",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"});n.S=function(e){return i.a.createElement("svg",c({width:230,height:230,viewBox:"0 0 230 230",fill:"none"},e),a,l,s,u,d,f,h)}},dx_bUYd:function(e,n,r){"use strict";(function(t){r.d(n,"h",(function(){return b})),r.d(n,"v",(function(){return y})),r.d(n,"y",(function(){return m}));var e=r("dx_lSNA"),o=r.n(e),i=r("dx_VkAN"),c=r.n(i),a=r("dx_UtDZ"),l=r("dx_cDcd"),s=r.n(l),u=r("dx_Dtiu"),d=r.n(u),f=r("dx_g0R0");function h(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function p(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?h(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function v(){var e=c()(["\n  font-size: 14px;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  cursor: pointer;\n  color: var(--text-link-hover);\n"]);return v=function(){return e},e}var g=d.a.div(v());function b(e){var n=e.errorContext;Object(f.U)()&&n?function(e,n){var r=function(){Object(f.v)(n)};a.Toast.error(p(p({},e),{},{closable:!0,duration:1e4,action:s.a.createElement(g,{onClick:r},t("CreationDoc_DocX_BugReport_Copy_btn"))}))}(e,n):a.Toast.error(e)}function y(e){return a.Toast.error(e)}function m(e){"error"!==e.type?a.Toast.show(e):b(e)}}).call(this,r("dx_E9Eu"))},dx_bUp7:function(e,n,r){"use strict";r.d(n,"J",(function(){return p})),r.d(n,"f",(function(){return v})),r.d(n,"C",(function(){return g}));var o,i=r("dx_lSNA"),c=r.n(i),a=r("dx_J4zp"),l=r.n(a),s=r("dx_UtDZ"),u=r("dx_h6a8"),d=r("dx_u6uu"),f=r("dx_HsgL"),h=(o={},c()(o,d.C.youtube,{type:d.C.youtube,resizeType:d.J.Fixed,patterns:[/^http(s)?:\/\/www\.youtube\.com\/watch\?v=([a-zA-Z0-9\-_]+)$/,/^http(s)?:\/\/youtu\.be\/([a-zA-Z0-9\-_]+)$/,/^http(s)?:\/\/www\.youtube\.com\/watch\?[^\s#]*&?v=([a-zA-Z0-9\-_]+)&?[^\s]*$/,/^http(s)?:\/\/www\.youtube\.com\/embed\/([a-zA-Z0-9\-_]+)$/],templateFunc:function(e){return"https://www.youtube.com/embed/".concat(e[2])},border:!0}),c()(o,d.C.bilibili,{type:d.C.bilibili,resizeType:d.J.Fixed,patterns:[/^https:\/\/www\.bilibili\.com\/video\/av(\w+)/,/^https:\/\/player\.bilibili\.com\/player\.html\?aid=(\d+)$/],templateFunc:function(e){return"https://player.bilibili.com/player.html?aid=".concat(e[1])},border:!0}),c()(o,d.C.bilibiliBv,{type:d.C.bilibiliBv,resizeType:d.J.Fixed,patterns:[/^https:\/\/www\.bilibili\.com\/video\/bv(\w+)/i,/^https:\/\/player\.bilibili\.com\/player\.html\?bvid=(\d+)$/],templateFunc:function(e){return"https://player.bilibili.com/player.html?bvid=".concat(e[1])},border:!0}),c()(o,d.C.airtable,{type:d.C.airtable,resizeType:d.J.Flexible,patterns:[/^https:\/\/airtable\.com\/shr([a-zA-Z0-9]+)[^\s]*$/,/^https:\/\/airtable\.com\/embed\/shr([a-zA-Z0-9]+)\?backgroundColor=green&viewControls=on$/],templateFunc:function(e){return"https://airtable.com/embed/shr".concat(e[1],"?backgroundColor=purple&viewControls=on")},border:!0,defaultHeight:534}),c()(o,d.C.datastudio,{type:d.C.datastudio,resizeType:d.J.Flexible,patterns:[/^https:\/\/datastudio\.google\.com\/embed\/reporting.+/],templateFunc:function(e){return e.input}}),c()(o,d.C.ad,{type:d.C.ad,resizeType:d.J.Flexible,patterns:[/^https:\/\/ad\.bytedance\.net\/kompaso\/page\/dashboard\/share\/[^\s#]*&?id=(\d+)&?[^\s]*/,/^https:\/\/compass-sg\.bytedance\.net\/kompaso\/page\/dashboard\/share\/[^\s#]*&?id=(\d+)&?[^\s]*$/,/^https:\/\/compass-va\.bytedance\.net\/compass\/report\/dashboardv2\/share\/[^\s#]*&?id=(\d+)&?[^\s]*$/],templateFunc:function(e){return e.input}}),c()(o,d.C.youku,{type:d.C.youku,resizeType:d.J.Fixed,patterns:[/^http(s)?:\/\/v\.youku\.com\/v_show\/id_([a-zA-Z0-9=]+)\.html[^\s]*$/,/^http(s)?:\/\/player\.youku\.com\/embed\/([a-zA-Z0-9=]+)$/],templateFunc:function(e){return"https://player.youku.com/embed/".concat(e[2])}}),c()(o,d.C.baidumap,{type:d.C.baidumap,resizeType:d.J.Flexible,patterns:[/^http(s)?:\/\/(j\.)?map(s)?\.baidu\.com\/([-a-zA-Z0-9=/_&@,?%#.();:]+)$/,/^http(s)?:\/\/ditu\.baidu\.com\/([a-zA-Z0-9=/_&@,?%#.();:]+)$/],templateFunc:function(e){return e.input},lazyload:!0,renderLinkInMobile:!0}),c()(o,d.C.autonavi,{type:d.C.autonavi,resizeType:d.J.Flexible,patterns:[/^http(s)?:\/\/surl\.amap\.com\/([A-z0-9/]+)$/,/^http(s)?:\/\/((ditu)|(www))\.amap\.com\/([a-zA-Z0-9=/_&@,?%#.();:]+)$/,/^https?:\/\/gaode\.com\/place\/([A-z0-9/]+)$/],templateFunc:function(e){return e.input},lazyload:!0,renderLinkInSafari:!0,renderLinkInMobile:!0}),c()(o,d.C.gmaps,{type:d.C.gmaps,resizeType:d.J.Flexible,patterns:[/^https?:\/\/(www\.)?google\.[a-z.]+\/maps\/place\/(.+)$/,/^https:\/\/www\.google\.com\/maps\/embed\/v1\/place\?key=.+$/,/^https?:\/\/(www\.)?google\.[a-z.]+\/maps\/@(.+)$/,/^https:\/\/www\.google\.com\/maps\/embed\/v1\/view\?key=.+$/],templateFunc:function(e){if(/^https:\/\/www\.google\.com\/maps\/embed\/v1\/place.+$/.test(e.input)||/^https:\/\/www\.google\.com\/maps\/embed\/v1\/view\?key=.+$/.test(e.input))return e.input;var n=e.input,r=e[2];if(n.includes("place")){var o=r.split("/"),i=l()(o,2),c=i[0],a=i[1],s="";if(a){var d=a.substring(1).split(","),h=l()(d,3),p=h[0],v=h[1],g=h[2];isNaN(Number(p))||isNaN(Number(v))||(s="&center=".concat(p,",").concat(v,"&zoom=").concat(g))}var b=Object(f.M)();return"https://www.google.com/maps/embed/v1/place?key=".concat(b,"&q=").concat(c).concat(s,"&language=en")}var y=e[2],m=Object(u.takeWhile)(y,(function(e){return"?"!==e})).join("").split(","),_=l()(m,3),k=_[0],O=_[1],x=_[2],E=Object(f.M)();return"https://www.google.com/maps/embed/v1/view?key=".concat(E,"&center=").concat(k,",").concat(O,"&zoom=").concat(x,"&language=en")}}),c()(o,d.C.xigua,{type:d.C.xigua,resizeType:d.J.Fixed,patterns:[/^http(s)?:\/\/www\.ixigua\.com\/(.+)$/,/^http(s)?:\/\/www\.365yg\.com\/(.+)$/],templateFunc:function(e){return e.input},renderLinkInIOS:!0,border:!0}),c()(o,d.C.tiktok,{type:d.C.tiktok,resizeType:d.J.Fixed,patterns:[/^http(s)?:\/\/vm\.tiktok\.com\/(.+)$/,/^http(s)?:\/\/vt\.tiktok\.com\/(.+)$/,/^http(s)?:\/\/t\.tiktok\.com\/i18n\/share\/video\/(.+)$/,/^http(s)?:\/\/www\.tiktok\.com\/embed\/(.+)$/,/^http(s)?:\/\/www\.tiktok\.com\/@[^\s]+\/video\/\d+(\?[^\s]*)?$/],templateFunc:function(e){return e.input},defaultWidth:325,defaultHeight:780,renderLinkInIOS:!0,renderLinkInSafari:!0}),c()(o,d.C.says,{type:d.C.says,resizeType:d.J.Fixed,patterns:[/^https:\/\/getsays\.cn\/share\/([0-9a-z]{32}[^s]*)$/i],templateFunc:function(e){return"https://getsays.cn/embed/".concat(e[1])},copyable:!0}),c()(o,d.C.survey,{type:d.C.survey,resizeType:d.J.Fixed,patterns:[/^http(s)?:\/\/kariya-stage\.bytedance\.net\/m?[^\s#]*&?t=([0-9a-z-]+)[^\s]*$/i,/^http(s)?:\/\/kariya-stage\.bytedance\.net\/m\/cfm?[^\s#]*&?t=([0-9a-z-]+)[^\s]*$/i],templateFunc:function(e){return"https://kariya-stage.bytedance.net/m/cfm?t=".concat(e[2])},border:!0,defaultHeight:500}),c()(o,d.C.figma,{type:d.C.figma,resizeType:d.J.Flexible,patterns:[/^https:\/\/www\.figma\.com\/((file|proto)\/[0-9a-zA-Z]{22,128}(\/.*)?)$/,/^https:\/\/www\.figma\.com\/embed\?embed_host=share&url=https:\/\/www\.figma\.com\/([a-zA-Z0-9=/_&?%#-]+)$/],templateFunc:function(e){return"https://www.figma.com/embed?embed_host=share&url=https://www.figma.com/".concat(e[1])},border:!0,renderLinkInMobile:!0}),c()(o,d.C.trello,{type:d.C.trello,resizeType:d.J.Fixed,patterns:[/^https:\/\/trello\.com\/c\/(.+)?$/,/^https:\/\/trello\.com\/embed\/card\?id=(.+)$/],templateFunc:function(e){return"https://trello.com/embed/card?id=".concat(e[1])},renderLinkInMobile:!0}),c()(o,d.C.vimeo,{type:d.C.vimeo,resizeType:d.J.Fixed,patterns:[/^https:\/\/vimeo\.com\/(.+)\/?$/,/^https:\/\/player\.vimeo\.com\/video\/(\w+)$/],templateFunc:function(e){return"https://player.vimeo.com/video/".concat(e[1])}}),c()(o,d.C.instagram,{type:d.C.instagram,resizeType:d.J.Fixed,patterns:[/^https:\/\/www\.instagram\.com\/p\/(\w+)\/?$/,/^https:\/\/www\.instagram\.com\/p\/(\w+)\/embed\/captioned\/?$/],templateFunc:function(e){return"https://www.instagram.com/p/".concat(e[1],"/embed/captioned/")},renderLinkInMobile:!0}),c()(o,d.C.facebook,{type:d.C.facebook,resizeType:d.J.Fixed,patterns:[/^(https:\/\/www\.facebook\.com\/[^/]+\/(posts|videos)\/.+\/?)$/,/^https:\/\/www\.facebook\.com\/plugins\/post\.php\?href=(https:\/\/www\.facebook\.com\/[^/]+\/(posts|videos)\/.+\/?)$/],templateFunc:function(e){return"https://www.facebook.com/plugins/post.php?href=".concat(e[1])},renderLinkInMobile:!0}),c()(o,d.C.googleDrive,{type:d.C.googleDrive,resizeType:d.J.Flexible,patterns:[/^https?:\/\/docs\.google\.com\/([^/]+\/[^.]+.[^/]+\/)?(document|spreadsheets|presentation|forms)\/d\/([^/]+)/],templateFunc:function(e){var n=e[2],r=e.input;switch(n){case"document":/\/pub\/?$/.test(r)&&(r+="?embedded=true");break;case"spreadsheets":/\/pubhtml\/?$/.test(r)&&(r+="?widget=true&amp;headers=false");break;case"presentation":r=r.replace(/\/pub/,"/embed");break;case"forms":r="".concat(e[0],"/viewform?embedded=true")}return r},renderLinkInMobile:!0}),c()(o,d.C.oneDrive,{type:d.C.oneDrive,resizeType:d.J.Flexible,patterns:[/^https?:\/\/onedrive\.live\.com\/\w+\.aspx\?(.+)\/?$/,/^https:\/\/onedrive\.live\.com\/embed\?(.+)&em=2$/],templateFunc:function(e){return"https://onedrive.live.com/embed?".concat(e[1].replace(/&amp;/g,"&"),"&em=2")},renderLinkInMobile:!0}),c()(o,d.C.openStreetMap,{type:d.C.openStreetMap,resizeType:d.J.Flexible,patterns:[/^https:\/\/www\.openstreetmap\.org\/export\/embed\.html.+$/],templateFunc:function(e){return e.input},renderLinkInMobile:!0}),c()(o,d.C.marvelapp,{type:d.C.marvelapp,resizeType:d.J.Flexible,patterns:[/^https?:\/\/marvelapp\.com\/.+\/?$/],templateFunc:function(e){return e.input},renderLinkInMobile:!0}),c()(o,d.C.prezi,{type:d.C.prezi,resizeType:d.J.Flexible,patterns:[/^https:\/\/prezi\.com\/view\/([^/]+)\/?$/,/^https:\/\/prezi\.com\/view\/([^/]+)\/embed$/],templateFunc:function(e){return"https://prezi.com/view/".concat(e[1],"/embed")},renderLinkInMobile:!0}),c()(o,d.C.soundcloud,{type:d.C.soundcloud,resizeType:d.J.Fixed,patterns:[/^https:\/\/w\.soundcloud\.com\/player\/?\?url=.+$/],templateFunc:function(e){return e.input},renderLinkInMobile:!0}),c()(o,d.C.spotify,{type:d.C.spotify,resizeType:d.J.Fixed,patterns:[/^https:\/\/open\.spotify\.com\/track\/(.+)\/?$/,/^https:\/\/open\.spotify\.com\/embed\?uri=spotify:track:(.+)$/],templateFunc:function(e){return"https://open.spotify.com/embed?uri=spotify:track:".concat(e[1])},renderLinkInMobile:!0}),c()(o,d.C.pastebin,{type:d.C.pastebin,resizeType:d.J.Flexible,patterns:[/^https:\/\/pastebin\.com\/(.+)\/?$/,/^https:\/\/pastebin\.com\/embed_iframe\/(.+)$/],templateFunc:function(e){return"https://pastebin.com/embed_iframe/".concat(e[1])},renderLinkInMobile:!0}),c()(o,d.C.lucidchart,{type:d.C.lucidchart,resizeType:d.J.Flexible,patterns:[/^https?:\/\/www\.lucidchart\.com\/documents\/embeddedchart\/(.+)\/?$/],templateFunc:function(e){return e.input},renderLinkInMobile:!0}),c()(o,d.C.drawIO,{type:d.C.drawIO,resizeType:d.J.Flexible,patterns:[/^https:\/\/www\.draw\.io\/?\?.+$/],templateFunc:function(e){return e.input},renderLinkInMobile:!0}),c()(o,d.C.slideshare,{type:d.C.slideshare,resizeType:d.J.Flexible,patterns:[/^((https?:)?\/\/www\.slideshare\.net\/slideshow\/embed_code\/key\/\w+)$/],templateFunc:function(e){return e[1]},renderLinkInMobile:!0}),c()(o,d.C.haikudeck,{type:d.C.haikudeck,resizeType:d.J.Flexible,patterns:[/^https:\/\/(www\.)?haikudeck\.com\/p\/(.+)\/?$/,/^https:\/\/www\.haikudeck\.com\/e\/(.+)$/],templateFunc:function(e){return"https://www.haikudeck.com/e/".concat(e[2])},renderLinkInMobile:!0}),c()(o,d.C.upscribe,{type:d.C.upscribe,resizeType:d.J.Fixed,patterns:[/^https?:\/\/upscri\.be\/(.+)\/?$/,/^https:\/\/upscri\.be\/[^?]+\?as_embed$/],templateFunc:function(e){return"https://upscri.be/".concat(e[1],"?as_embed")},renderLinkInMobile:!0}),c()(o,d.C.wenjuan,{type:d.C.wenjuan,resizeType:d.J.UpDown,patterns:[/^https?:\/\/wj\.toutiao\.com\/q\/(.+)$/,/^https?:\/\/wj\.bytedance\.com\/q\/(.+)$/],templateFunc:function(e){return e.input},defaultHeight:320,border:!0}),c()(o,d.C.indify,{type:d.C.indify,resizeType:d.J.UpDown,patterns:[/^https?:\/\/indify\.co\/widgets\/live\/(.+)$/],templateFunc:function(e){return e.input},renderLinkInMobile:!0}),c()(o,d.C.modao,{type:d.C.modao,resizeType:d.J.Flexible,patterns:[/^https:\/\/modao\.cc\/app\/([0-9a-zA-Z]+)[^\s]*$/],templateFunc:function(e){return"https://modao.cc/app/".concat(e[1],"/embed/v2")},border:!0,renderLinkInMobile:!0}),c()(o,d.C.canva,{type:d.C.canva,resizeType:d.J.Flexible,patterns:[/^https:\/\/www.canva.cn\/design\/([0-9a-zA-Z]+)\/[^\s]*/],templateFunc:function(e){return"https://www.canva.cn/design/".concat(e[1],"/view?embed")},border:!0,renderLinkInIOS:!0}),c()(o,d.C.jcode,{type:d.C.jcode,resizeType:d.J.Flexible,patterns:[/^https:\/\/code.juejin.cn\/pen\/[0-9]+/],templateFunc:function(e){return e.input},border:!0,defaultWidth:730,defaultHeight:430}),c()(o,d.C.codepen,{type:d.C.codepen,resizeType:d.J.Flexible,patterns:[/^https:\/\/codepen.io\/([0-9a-zA-Z]+)\/(pen|embed)\/([0-9a-zA-Z]+[^\s]*)/],templateFunc:function(e){return"https://codepen.io/".concat(e[1],"/embed/").concat(e[3])},border:!0}),c()(o,d.C.jinshuju,{type:d.C.jinshuju,resizeType:d.J.Flexible,patterns:[/^(https:\/\/jinshuju\.net\/(f|forms)\/[0-9a-zA-Z]+)[^\s]*/],templateFunc:function(e){return"".concat(e[1],"?background=white&banner=show&embedded=true&inner_redirect=false")},border:!0}),c()(o,d.C.feishu_survey,{type:d.C.feishu_survey,resizeType:d.J.Flexible,patterns:[/^https:\/\/wenjuan\.feishu\.cn\/m\?[^\s]+/],templateFunc:function(e){return e.input},border:!0,defaultHeight:500,renderLinkInIOS:!0}),c()(o,d.C.lark_survey,{type:d.C.lark_survey,resizeType:d.J.Flexible,patterns:[/^https:\/\/survey\.larksuite\.com\/m\/\?[^\s]+/],templateFunc:function(e){return e.input},border:!0,defaultHeight:500,renderLinkInIOS:!0}),c()(o,d.C.tea_bulletin,{type:d.C.tea_bulletin,resizeType:d.J.Flexible,patterns:[/^https:\/\/data\.bytedance\.net\/tea\/app\/\d+\/dashboard\/\d+/],templateFunc:function(e){return"".concat(e.input,"?hideAppHeader&hideDashLeft")},border:!0,renderLinkInMobile:!0}),c()(o,d.C.tea_bulletin_suffix,{type:d.C.tea_bulletin_suffix,resizeType:d.J.Flexible,patterns:[/^https:\/\/data\.bytedance\.net\/tea\/app\/\d+\/dashboard\/\d+\?[^\s]+/],templateFunc:function(e){return"".concat(e.input,"&hideAppHeader&hideDashLeft")},border:!0,renderLinkInMobile:!0}),c()(o,d.C.tea_report,{type:d.C.tea_report,resizeType:d.J.Flexible,patterns:[/^https:\/\/data\.bytedance\.net\/tea\/app\/\d+\/share-link\/report\?dashboardId=\d+[^\s#]+reportId=\d+[^\s]*/],templateFunc:function(e){return e.input},border:!0,renderLinkInMobile:!0}),c()(o,d.C.aeolus,{type:d.C.aeolus,resizeType:d.J.Flexible,patterns:[/^https:\/\/data\.bytedance\.net\/aeolus\/(\?from=[a-zA-Z_]+)?#(\/external)?\/dashboard\/[0-9]+\?appId=.*/,/^https:\/\/data\.bytedance\.net\/aeolus\/#(\/external)?\/dashboard\/[0-9]+\/[0-9]+\?appId=.*/,/^https:\/\/data\.bytedance\.net\/aeolus\/\?from=[a-zA-Z_]+#(\/external)?\/dashboard\/[0-9]+\/[0-9]+\?appId=.*/,/^https:\/\/aeolus-va\.bytedance\.net\/(\?from=[a-zA-Z_]+)?#(\/external)?\/dashboard\/[0-9]+\?appId=.*/,/^https:\/\/aeolus-va\.bytedance\.net\/(\?from=[a-zA-Z_]+)?#(\/external)?\/dashboard\/[0-9]+\/[0-9]+\?appId=.*/,/^https:\/\/aeolus-sg\.bytedance\.net\/(\?from=[a-zA-Z_]+)?#(\/external)?\/dashboard\/[0-9]+\?appId=.*/,/^https:\/\/aeolus-sg\.bytedance\.net\/(\?from=[a-zA-Z_]+)?#(\/external)?\/dashboard\/[0-9]+\/[0-9]+\?appId=.*/],templateFunc:function(e){return e.input},border:!0,renderLinkInMobile:!0}),c()(o,d.C.tiktokCode,{type:d.C.tiktokCode,resizeType:d.J.Fixed,patterns:[/^<iframe.+src="(https:\/\/www\.tiktok\.com\/embed\/[^"]+)[^>]+><\/iframe>$/],templateFunc:function(e){return e[1]},code:!0}),c()(o,d.C.trelloCode,{type:d.C.trelloCode,resizeType:d.J.Fixed,patterns:[/^<blockquote\sclass="trello-card"><a\shref="https?:\/\/trello\.com\/c\/(.+)">.+<\/a><\/blockquote><script\ssrc=".+"><\/script>$/],templateFunc:function(e){return"https://trello.com/embed/card?id=".concat(e[1])},code:!0}),c()(o,d.C.vimeoCode,{type:d.C.vimeoCode,resizeType:d.J.Fixed,patterns:[/^<iframe\ssrc="(https:\/\/player\.vimeo\.com[^"]+)".+><\/iframe>\n?(<p>.+<\/p>)?$/],templateFunc:function(e){return e[1]},code:!0}),c()(o,d.C.instagramCode,{type:d.C.instagramCode,resizeType:d.J.Fixed,patterns:[/^<blockquote.+data-instgrm-permalink="https:\/\/www.instagram.com\/p\/([^/]+)\/[^>]+>[\s\S]+<\/blockquote>\s?<script.+src=".+www\.instagram\.com\/embed\.js"><\/script>$/],templateFunc:function(e){return"https://www.instagram.com/p/".concat(e[1],"/embed/captioned/")},code:!0}),c()(o,d.C.facebookCode,{type:d.C.facebookCode,resizeType:d.J.Fixed,patterns:[/^<iframe\ssrc="(https:\/\/www.facebook.com\/plugins\/post.php[^"]+)"[^>]+><\/iframe>$/],templateFunc:function(e){return e[1]},code:!0,defaultWidth:550,defaultHeight:310}),c()(o,d.C.googleDriveCode,{type:d.C.googleDriveCode,resizeType:d.J.Flexible,patterns:[/^<iframe.+src="(https:\/\/docs\.google\.com\/([^/]+\/[^.]+.[^/]+\/)?(?:document|spreadsheets|presentation|forms)[^"]+)"[^>]*><\/iframe>$/],templateFunc:function(e){return e[1]},code:!0}),c()(o,d.C.datastudioCode,{type:d.C.datastudioCode,resizeType:d.J.Flexible,patterns:[/^<iframe.+src="(https:\/\/datastudio\.google\.com\/embed\/reporting\/[^"]+)"[^>]+><\/iframe>$/],templateFunc:function(e){return e[1]},code:!0}),c()(o,d.C.openstreetmapCode,{type:d.C.openstreetmapCode,resizeType:d.J.Flexible,patterns:[/^<iframe.+src="(https:\/\/www\.openstreetmap\.org\/export\/embed\.html[^"]+)"[^>]+><\/iframe>(|<br\/><small><a[^>]+>.+<\/a><\/small>)?$/],templateFunc:function(e){return e[1]},code:!0}),c()(o,d.C.figmaCode,{type:d.C.figmaCode,resizeType:d.J.Flexible,patterns:[/^<iframe.+src="(https:\/\/www.figma.com\/embed[^"]+)"[^>]+><\/iframe>$/],templateFunc:function(e){return e[1]},border:!0,code:!0,renderLinkInMobile:!0}),c()(o,d.C.soundcloudCode,{type:d.C.soundcloudCode,resizeType:d.J.Fixed,patterns:[/^<iframe.+src="(https:\/\/w\.soundcloud\.com\/player\/\?[^"]+)"><\/iframe>/],templateFunc:function(e){return e[1]},code:!0}),c()(o,d.C.pastebinCode,{type:d.C.pastebinCode,resizeType:d.J.Flexible,patterns:[/^<iframe\ssrc="(https:\/\/pastebin\.com\/embed_iframe\/[^"]+)"[^>]+><\/iframe>$/],templateFunc:function(e){return e[1]},code:!0,defaultWidth:748,defaultHeight:55}),c()(o,d.C.lucidchartCode,{type:d.C.lucidchartCode,resizeType:d.J.Flexible,patterns:[/^(?:<div[^>]*>)?<iframe.+src="(https:\/\/www\.lucidchart\.com\/documents\/embeddedchart\/[^"]+)"[^>]+><\/iframe>(<\/div>)?$/],templateFunc:function(e){return e[1]},code:!0}),c()(o,d.C.drawIOCode,{type:d.C.drawIOCode,resizeType:d.J.Flexible,patterns:[/^<iframe.+src="(https:\/\/www\.draw\.io[^"]+)"><\/iframe>$/],templateFunc:function(e){return e[1]},code:!0,renderLinkInMobile:!0}),c()(o,d.C.slideshareCode,{type:d.C.slideshareCode,resizeType:d.J.Flexible,patterns:[/^<iframe\ssrc="((?:https?:)?\/\/www\.slideshare\.net\/slideshow\/embed_code\/key\/[^"]+)"[^>]+>[^<]*<\/iframe>(|[^<]*<div[^>]*>.+<\/div>)?$/],templateFunc:function(e){return e[1]},code:!0}),c()(o,d.C.speakerdeckCode,{type:d.C.speakerdeckCode,patterns:[/^<script.+data-id="([^"]+)"[^>]+><\/script>$/],resizeType:d.J.Flexible,templateFunc:function(e){return"https://speakerdeck.com/player/".concat(e[1])},code:!0}),c()(o,d.C.haikudeckCode,{type:d.C.haikudeckCode,resizeType:d.J.Flexible,patterns:[/^<iframe\ssrc="(https:\/\/www\.haikudeck\.com\/e[^"]+)"[^>]+><\/iframe>(|<br\/><span[^>]+>.+<\/span>;)?$/],templateFunc:function(e){return e[1]},code:!0}),o),p=730,v=410,g=h;try{var b=Object(s.getMinaConfig)("iframe_config",void 0),y="string"===typeof b?JSON.parse(b):b;y&&Object.entries(y).forEach((function(e){var n=l()(e,2),r=n[0],o=n[1],i=h[r],c=o,a=c.patterns,s=c.template;a&&(o.patterns=a.map((function(e){return new RegExp(e)}))),s&&(o.templateFunc=function(e){return function(n){var r=function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return n[r[2]]};return e.replace(/\$\{matched(\.(input))\}/g,r).replace(/\$\{matched(\[(\d)\])\}/g,r)}}(s)),o.type=r,g[r]=Object.assign({},i,o)}))}catch(m){console.error(m)}},dx_bWl7:function(e,n,r){"use strict";r.d(n,"U",(function(){return a})),r.d(n,"i",(function(){return l})),r.d(n,"Y",(function(){return s}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_B28d");function a(e){var n=null,r=null;if("string"===typeof e){var o=e.split(/_/,2),c=i()(o,2);n=c[0],r=c[1]}return{token:n,id:r}}function l(e){return e.map((function(e){var n=e.commentId,r=e.offsetTop;return{commentId:n,thirdPartyHeight:e.offsetHeight,relativeTopToThirdParty:r,quote:e.quote||""}}))}function s(e){return(null===e||void 0===e?void 0:e.type)===c.B.BITABLE}},dx_bXsd:function(e,n,r){},dx_bbfH:function(e,n,r){"use strict";r.d(n,"ug",(function(){return i})),r.d(n,"P",(function(){return c})),r.d(n,"K",(function(){return a})),r.d(n,"g4",(function(){return l})),r.d(n,"g",(function(){return s})),r.d(n,"A",(function(){return u})),r.d(n,"q",(function(){return d})),r.d(n,"N",(function(){return f})),r.d(n,"B",(function(){return h})),r.d(n,"d",(function(){return p})),r.d(n,"i",(function(){return v})),r.d(n,"t",(function(){return g})),r.d(n,"u1",(function(){return b})),r.d(n,"u",(function(){return y})),r.d(n,"T",(function(){return m})),r.d(n,"M",(function(){return _})),r.d(n,"MZ",(function(){return k})),r.d(n,"mH",(function(){return O})),r.d(n,"os",(function(){return x})),r.d(n,"m",(function(){return E})),r.d(n,"D",(function(){return S})),r.d(n,"h",(function(){return C})),r.d(n,"X",(function(){return I})),r.d(n,"o",(function(){return B})),r.d(n,"X6",(function(){return T})),r.d(n,"I",(function(){return w})),r.d(n,"v",(function(){return R})),r.d(n,"J",(function(){return M})),r.d(n,"j",(function(){return j})),r.d(n,"oD",(function(){return D}));var o=r("dx_K8h1"),i=(r("dx_O1Ou").a.DocxTable,100),c=50,a=8,l=1,s=2,u=3,d={SCROLLABLE_CONTENT:"table-scrollable-content",TABLE_SCROLLER_CLASS:o.u.CONTENT_SCROLLER,TABLE_HEADER:"table-header",TABLE_HEADER_FOCUSED:"table-header--focused",TABLE_HEADER_SELECTED:"table-header--selected",TABLE_HEADER_CELL_SELECTED:"table-header--cell-selected",TABLE_EQUAL_PANEL:"table-equal-panel",TABLE_WILL_DELETE_CELL:"table-will-delete-cell",TABLE_SELECTED_FROM_EQUAL:"table-selected-from-equal",TABLE_SELECTED:"table-selected",TABLE_RESIZING:"table-resizing",TABLE_SELECTING:"table-selecting",TABLE_DISABLE_SCROLL:"table-disable-scroll"},f=[d.TABLE_HEADER,d.TABLE_EQUAL_PANEL],h=[d.TABLE_HEADER],p={row_span:1,col_span:1},v="insert_table",g="remove_table",b="resize_column_width",y="merge_cell",m="cancel_merge_cell",_="add_table_column",k="add_table_row",O="remove_table_row",x="remove_table_column",E="column",S="row",C=-1,I=10,B=20+a,T=15,w=T,R=(T-1)/2,M=5,j=4,D=50},dx_bcuL:function(e,n,r){"use strict";r.d(n,"S",(function(){return _}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_W7W2"),f=r.n(d),h=r("dx_a1gu"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=r("dx_fiWp");function y(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}var m=function(e){f()(r,e);var n=y(r);function r(e){var o;return l()(this,r),(o=n.call(this)).timerId=void 0,o.lastTick=0,o.interval=6e4,o.tick=function(){o.lastTick=Date.now(),o.emit(r.TICK_EVENT)},o.interval=e||6e4,o.init(),o}return u()(r,[{key:"init",value:function(){this.start()}},{key:"start",value:function(){var e=this;clearTimeout(this.timerId);var n=Date.now(),r=this.interval;r=this.lastTick&&n-this.lastTick>=this.interval?0:this.interval-n%this.interval,this.timerId=window.setTimeout((function(){e.tick(),e.start()}),r)}},{key:"stop",value:function(){clearTimeout(this.timerId)}},{key:"destroy",value:function(){this.stop(),this.removeAllListeners(r.TICK_EVENT)}}]),r}(r.n(b).a);function _(){var e=Object(c.useRef)({ticking:!1}),n=Object(c.useState)(Number(new Date)),r=i()(n,2),o=r[0],a=r[1],l=Object(c.useCallback)((function(){a(Number(new Date))}),[]),s=Object(c.useCallback)((function(){e.current.ticking||(e.current.ticking=!0,m.instance.addListener(m.TICK_EVENT,l))}),[]),u=Object(c.useCallback)((function(){e.current.ticking&&(e.current.ticking=!1,m.instance.removeListener(m.TICK_EVENT,l))}),[]);return Object(c.useEffect)((function(){return s(),u}),[]),[o,s,u]}m.instance=void 0,m.TICK_EVENT="task.tickservice.tick",m.instance=new m},dx_bdma:function(e,n,r){"use strict";r.d(n,"S",(function(){return u})),r.d(n,"Q",(function(){return d}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_eSV8"),s=null;function u(){return s}function d(){return f.apply(this,arguments)}function f(){return(f=a()(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!s){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,Promise.all([r.e("dx_XmC"),r.e("dx_qwS")]).then(r.bind(null,"dx_uAOK"));case 5:n=e.sent,s=n.default,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),Object(l.n)("Failed to load highlightjs: ".concat(String(e.t0)));case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}},dx_bfji:function(e,n,r){"use strict";r.d(n,"S",(function(){return j}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_RIqP"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_h6a8"),h=r("dx_B28d"),p=r("dx_IdzY"),v=r("dx_vD7Z"),g=r("dx_SOoV"),b={plaintextInGridColumn:{matches:{nodeType:g.n.TEXT},enter:function(e){e.data.type===h.B.GRID_COLUMN&&(e.data.type=h.B.TEXT)}}},y=r("dx_wJkD"),m=r("dx_MWd8"),_=r("dx_O8UM"),k=r("dx_l8lP"),O=r("dx_Lqhf"),x=r("dx_InLz"),E={"micro-list":{matches:{nodeType:g.n.ELEMENT,nodeName:["P","H1","H2","H3","H4","H5","H6"]},enter:function(e){var n=e.node,r=e.context,o=n.getAttribute("style");if(null===o||void 0===o?void 0:o.includes("mso-list")){o&&/level(\d+)/.test(o),r.level=Number(RegExp.$1)||1;var i=n.querySelector('[style="mso-list:Ignore"]')||n.querySelector('[style="mso-list:Ignore;"]');if(i){var c=(i.textContent||"").trim();r.textType=/(\.|\)|\d|\u3001)$/.test(c)?h.B.ORDERED:h.B.BULLET,i.remove()}else r.textType=h.B.BULLET}}},"micro-list-nest":{matches:{nodeType:g.n.ELEMENT,nodeName:["DIV"],selector:"#block-root"},exit:function(e){var n=e.context,r=e.children,o=n.textType;o&&o!==h.B.ORDERED||(e.children=Object(x.j)(r,"level"))}},"micro-title":{matches:{nodeType:g.n.ELEMENT,nodeName:["P"],selector:".MsoTitle"},enter:function(e){e.context.textType=h.B.HEADING1,e.context.align="center"}},"micro-subtitle":{matches:{nodeType:g.n.ELEMENT,nodeName:["P"],selector:".MsoSubtitle"},enter:function(e){e.data.type=h.B.TEXT,e.context.mark||(e.context.mark={}),e.context.mark.textHighlight=Object(m.f)(Object(_.P)(O.D.Text).get(k.j.COLOR_GRAY_TEXT))}},"micro-sup":{matches:{nodeType:g.n.ELEMENT,nodeName:["SUP","SUB"]},enter:function(e){e.node.innerText="(".concat(e.node.innerText,")")}},"micro-color":{matches:{nodeType:g.n.ELEMENT,selector:".MsoNormal"},preprocess:function(e){var n=e.context;return n.supportStyle||(n.supportStyle=!0),!0}}},S={"shimo-color":{matches:{nodeType:g.n.ELEMENT,selector:"[data-shimo-docs],[data-docs-delta]"},preprocess:function(e){var n=e.context;return n.supportStyle||(n.supportStyle=!0),!0}}};function C(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function I(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?C(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var B=I(I(I(I(I({},v.S),E),S),y.S),b);function T(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function w(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?T(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function R(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return M(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function M(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var j=function(){function e(){s()(this,e),this.dom=void 0}return d()(e,[{key:"parse",value:function(e){var n,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:B,c=e.getElementById("block-root"),a=this.build(this.newPathNode(c,{},o),c,i);return{data:a,spaceId:null===(n=c.querySelector("[data-space-id]"))||void 0===n?void 0:n.getAttribute("data-space-id"),pageId:null===(r=c.querySelector("[data-page-id]"))||void 0===r?void 0:r.getAttribute("data-page-id")}}},{key:"build",value:function(e,n,r){for(var o,i,c=[],l=[],s=e.node,u=s.nodeType,d=s.nodeName,v=0,g=Object.values(r);v<g.length;v++){var b=g[v];if(!(b.matches.nodeType&&b.matches.nodeType!==u||b.matches.nodeName&&!(i=b.matches.nodeName,Array.isArray(i)?i:[i]).includes(d)||b.matches.selector&&s instanceof Element&&!s.matches(b.matches.selector))){var y=void 0;if(b.ignoreChild&&(e.context._ignoreChild=!0),(!b.preprocess||(y=b.preprocess(e,n)))&&(b.enter&&b.enter(e,n,y),l.unshift(b),e.context._ignoreChild))break}}if(!e.context._ignoreChild){var m,_=R(Array.from(e.node.childNodes).filter(x.U));try{for(_.s();!(m=_.n()).done;){var k=m.value,O=this.build(this.newPathNode(k,{},Object(f.cloneDeep)(e.context)),n,r);c.push.apply(c,a()(O))}}catch(S){_.e(S)}finally{_.f()}}(o=e.children).push.apply(o,c),l.forEach((function(r){r.exit&&r.exit(e,n),r.addEmptyTextIfNoChild&&0===e.children.length&&e.children.push({data:{type:h.B.TEXT,nodes:[{text:"",type:p.B.PLAINTEXT}]},children:[],node:e.node,context:{},payload:{addForEmpty:!0}})}));var E=e.children.map((function(n){return w(w({},n),{},{context:w(w({},e.context),n.context)})}));return!0===e.alive?[e]:E.length?E:Object.keys(e.data).length>0?[e]:E}},{key:"newPathNode",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return{node:e,data:n,context:r,children:o,payload:i}}}]),e}()},dx_bkVC:function(e,n,r){"use strict";r.d(n,"h",(function(){return l})),r.d(n,"Q",(function(){return s})),r.d(n,"O",(function(){return u})),r.d(n,"v",(function(){return d})),r.d(n,"A",(function(){return f})),r.d(n,"d",(function(){return h})),r.d(n,"S",(function(){return p})),r.d(n,"OZ",(function(){return v}));var o=r("dx_C7Cb"),i=r("dx_B28d"),c=Object(o.S)(),a={pasteTimes:0,from:null,pasteFlag:c},l=function(){return a},s=function(e){a.from=e},u=function(){a.pasteTimes=0},d=function(){a.pasteTimes++},f=function(){return c},h=function(){c=Object(o.S)()},p=function(){s(null),u()},v=function(){var e=[i.G.innerCutPaste,i.G.outerCutPaste];return null!==a.from&&e.includes(a.from)}},dx_bkna:function(e,n){},dx_bvq6:function(e,n,r){"use strict";r.d(n,"O",(function(){return g}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_GW6I");r("dx_BkEP");function v(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var g=function(e){s()(r,e);var n=v(r);function r(e){var o;return i()(this,r),o=n.call(this,e),e.shouldCheckWhenInit&&o.checkAll(),o}return a()(r,[{key:"checkAll",value:function(e){var n=this,r=this.editor.getContentState(),o=e?r.getZoneState(e):r.getActiveZone();if(o){var i=o.lines;this.isSmartCorrectionEnabled()&&i.forEach((function(e){return n.service.handleLineChange(e)}))}}}]),r}(p.K)},dx_by6m:function(e,n,r){"use strict";r.d(n,"w",(function(){return s})),r.d(n,"m",(function(){return u})),r.d(n,"L",(function(){return d}));var o=r("dx_UtDZ"),i=r("dx_h6a8"),c=r("dx_zEdG"),a=r("dx_rldU"),l=r("dx_CwnG"),s=function(e,n,r,s){var u={record_id:"",block_type:"",sub_block_type:""};if(e){var d=[],f=n.id,h=Object(l.p)(f,r);u.record_id||(u=Object(i.pick)(h,["record_id","block_type","sub_block_type"])),d.push({object_block_id:Object(o.encryptTea)(h.record_id),object_block_type:h.block_type,object_sub_block_type:h.sub_block_type,block_content_size:h.block_content_size});var p={target:a.F[e]||"none",click:"block_action",action_type:e,action_value:null===s||void 0===s?void 0:s.actionValue,object_block_data:d,tigger_type:(null===s||void 0===s?void 0:s.triggerType)||"hover_whole",obj_type:u.block_type};Object(c.P)("ccm_doc_web_block_bubble_toolbar_click",u,p)}},u=function(e,n){Object(c.T)("ccm_doc_web_block_bubble_toolbar_view",n,{trigger_type:e,obj_type:n.block_type})},d=function(e){return e&&e.aliasName&&e.aliasName.indexOf("threeStateSwitch")>-1?{value1:e.name}:null}},dx_c0wU:function(e,n,r){"use strict";r.d(n,"BH",(function(){return P})),r.d(n,"E",(function(){return L})),r.d(n,"i",(function(){return N})),r.d(n,"Y",(function(){return F})),r.d(n,"R",(function(){return U})),r.d(n,"O",(function(){return V})),r.d(n,"z",(function(){return z})),r.d(n,"N",(function(){return G})),r.d(n,"e",(function(){return q})),r.d(n,"M",(function(){return X})),r.d(n,"B",(function(){return J})),r.d(n,"F",(function(){return Z})),r.d(n,"K",(function(){return Q})),r.d(n,"H",(function(){return $})),r.d(n,"NL",(function(){return ee})),r.d(n,"m",(function(){return te}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_J4zp"),s=r.n(l),u=r("dx_RIqP"),d=r.n(u),f=r("dx_lSNA"),h=r.n(f),p=r("dx_NOtv"),v=r.n(p),g=r("dx_MoY1"),b=r("dx_MWd8"),y=r("dx_O8UM"),m=r("dx_JFYx"),_=r("dx_KgXx"),k=r("dx_vQlG"),O=r("dx_ZG9w"),x=r("dx_fEKD"),E=r("dx_zghO"),S=r("dx_ppc6"),C=r("dx_xWRc"),I=r("dx_B28d"),B=r("dx_SpiB"),T=r("dx_FXIk");function w(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return R(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function R(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function M(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function j(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?M(Object(r),!0).forEach((function(n){h()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var D=v()("getStruct");function A(){return j(j({},j({emoji_id:B.L[Math.floor(Math.random()*B.L.length)]},P())),W().attrs)}function P(){return{background_color:Object(y.v)(m.Pi.BackgroundColor).get(m.P.LightOrange),border_color:Object(y.v)(m.Pi.Border).light.get(m.b.Orange),text_color:""}}function L(e){var n=e.textColor,r=e.borderColor,o=d()(Object(y.v)(m.Pi.Border).light),i=d()(function(){var e,n=Object(y.v)(m.Pi.BackgroundColor),r=new Map,o=w(n);try{for(o.s();!(e=o.n()).done;){var i=s()(e.value,2),c=i[0],a=i[1];"string"===typeof m.a[c]&&r.set(c,a)}}catch(l){o.e(l)}finally{o.f()}return r}());if(r){var c=function(e,n){var r,o=w(e);try{for(o.s();!(r=o.n()).done;){var i=s()(r.value,2),c=(i[0],i[1]);Object(b.J)(n,c)}}catch(a){o.e(a)}finally{o.f()}return-1}(o,r);c>=0&&(o.splice(c,1),i.splice(c,1))}var a=function(e){var n=e.length;return Math.floor(Math.random()*n)}(o);return{background_color:i[a][1],border_color:o[a][1],text_color:n}}function N(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=Object(y.v)(m.Pi.Border),o=n?r.light:r.dark,i=Object(_.v)(o,e);if(i){var c=n?r.dark:r.light,a=c.get(i);return a}}function F(e){var n=Object(y.v)(m.Pi.BackgroundColor),r=Object(_.v)(n,e);return!!r&&!!m.d[r]}function U(e,n){switch(e){case m.Pi.TextColor:var r=Object(y.v)(e),o=Object(_.v)(r,n),i=o&&Object(y.h)(e).get(o);return Object(_.R)(i)||n;case m.Pi.BackgroundColor:var c=Object(y.v)(e),a=Object(_.v)(c,n);!a&&Object(b.J)(m.B,n)&&(a=m.P.DarkGray);var l=a&&Object(y.h)(e).get(a);return Object(_.R)(l)||n;case m.Pi.Border:var s,u=Object(y.v)(e),d=Object(_.v)(u.light,n);if(d)s=Object(y.h)(e).light.get(d);else{var f=Object(_.v)(u.dark,n);s=f&&Object(y.h)(e).dark.get(f)}return Object(_.R)(s)||n}return n}var H=null;function V(){return W().recentEmojis}function W(){if(!H){var e,n=Object(k.C)(k.o.CalloutSetting,{});H={attrs:(null===n||void 0===n?void 0:n.attrs)||{},recentEmojis:(null===n||void 0===n||null===(e=n.recentEmojis)||void 0===e?void 0:e.length)?n.recentEmojis:d()(B.p)}}return H}function z(e){var n=W();["background_color","border_color"].forEach((function(r){r in e&&(n.attrs[r]=e[r])})),e.emoji_id&&(n.attrs.emoji_id=e.emoji_id,n.recentEmojis=[e.emoji_id].concat(d()(n.recentEmojis)).filter((function(n,r){return n!==e.emoji_id||0===r})).slice(0,B.i)),Object(k.Cl)(k.o.CalloutSetting,JSON.stringify(n))}function G(e,n){return K.apply(this,arguments)}function K(){return(K=a()(i.a.mark((function e(n,r){var o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o="",e.next=3,r.applyTransaction("insertCalloutChildren",(function(e){var i=Object(g.l)(e,n,0,[r.createInitModel(I.B.TEXT)]),c=s()(i,1);o=c[0]}));case 3:return c=r.getBlockViewByBlockIdNotCheck(r.getBlockIdsByRecordId(o)[0]),Object(O.U)(c)&&c.focus(),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(e,n,r){if(!(e=e.filter((function(e){return B.Lj[e.type]}))).length)return[null,Promise.resolve()];var o=n.getBlockModelByBlockId(e[0].id);if(!o.parent)return[null,Promise.resolve()];var i=o.parent,c=o.position;if(Q(i.id,n))for(;i.parent;)c=i.position+1,i=i.parent;var a=Object(C.r)(e,r,!0),l=a.blockList,s=a.noInSelBlockList;if(!l.length)return[null,Promise.resolve()];var u=te(),d=l.map((function(e){return e.id}));return Object(T.e)({parentBlockId:i.id,blockManager:n,blockSnapshot:u,position:c,transactionName:r?"turnIntoCalloutWithMultipleSelection":"turnIntoCallout",childBlockIds:d,beforeInsert:function(e){Object(g.y)(e,d,n),Object(g.y)(e,s.map((function(e){return e.model}))),Object(g.t)(e,i.recordId,c,s.map((function(e){return e.model.recordId})))}})}function X(e,n,r){return Y.apply(this,arguments)}function Y(){return(Y=a()(i.a.mark((function e(n,r,o){var c,a,l,u,d,f,h,p,v,b,y,m,_;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=r.model,a=n.createInitModel(I.B.CALLOUT),l=!!c.children.length,u=!l,d=c.parent,f=c.position,h=Object(T.y)({parentBlockId:d.id,blockManager:n,blockSnapshot:a,position:f,getChildRecordIds:function(e,o){return u?[Object(g.s)(e,o,n.createInitModel(I.B.TEXT))]:[r.record.id]},transactionName:"slashInsertCallout",beforeInsert:function(e){Object(g.y)(e,[r.model])}},l),p=s()(h,2),v=p[0],b=p[1],y=n.getBlockModelByBlockId(v),m=y.children[0].id,n.editorAPI.getService(S.S).setSelection([{id:m,type:E.j.TEXT,selection:{start:0,end:0}}]),e.next=12,b;case 12:_=n.getBlockViewByBlockId(m),Object(O.U)(_)&&_.model.setSelection({start:0,len:0},!0);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(e,n,r,o){return Q(e,r)&&(n=n.filter((function(e){var n=ee(e,r,o);return!n&&o&&delete o[e],n}))),n}var Z=function e(n,r,o){var i=r.getBlockModelByBlockId(n.id).children;i.length&&Array.from(i).forEach((function(n){var i=r.getBlockViewByBlockId(n.id);o&&Object(O.f)(i)&&o(i),e(i,r,o)}))};function Q(e,n){try{for(var r=n.getBlockModelByBlockIdNotCheck(e);r&&r.parent;){if(r.type===I.B.CALLOUT)return!0;r=r.parent}}catch(o){D("struct not found")}return!1}function $(e,n){try{for(var r=n.getBlockModelByBlockId(e);r.parent;){if(r.type===I.B.CALLOUT)return r;r=r.parent}}catch(o){D("struct not found")}return null}function ee(e,n,r){if(r&&r[e]){var o=r[e];if(!B.Lj[o.type])return!1;var i=!0,c=o.children;return c&&c.forEach((function(e){if(i){var o=n.getBlockIdsByRecordId(e)[0];i=ee(o,n,r)}})),i}try{var a=n.getBlockModelByBlockId(e),l=a.record.snapshot.type;if(!B.Lj[l])return!1;var s=!0;return a.children.forEach((function(e){s&&(s=ee(e.id,n,r))})),s}catch(u){return D("struct not found"),!1}}function te(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:I.B.CALLOUT;return Object(x.b)(j(j({},A()),{},{type:n,align:I.D.LEFT},e),n)}},dx_c3cO:function(e,n,r){"use strict";(function(t){r.d(n,"X",(function(){return i})),r.d(n,"Z",(function(){return c})),r.d(n,"J",(function(){return a})),r.d(n,"M",(function(){return l})),r.d(n,"g",(function(){return s})),r.d(n,"T",(function(){return e})),r.d(n,"R",(function(){return u})),r.d(n,"q",(function(){return d})),r.d(n,"I",(function(){return f})),r.d(n,"p",(function(){return h})),r.d(n,"Y",(function(){return v}));var e,o=r("dx_UtDZ"),i={OPEN_POPOVER:"openReminderPopover",UPDATE_POPOVER:"updateReminderPopover",CLOSE_POPOVER:"closeReminderPopover",POPOVER_MOUSE_ENTER:"popoverMouseEnter",POPOVER_MOUSE_LEAVE:"popoverMouseLeave"},c={hour:0,minute:0,second:0,millisecond:0},a={hour:23,minute:59,second:59,millisecond:0},l=300,s=600;!function(e){e.ZH="zh-cn",e.EN="en-us",e.JA="ja-jp"}(e||(e={}));var u=[{value:0,text:t("reminder.popover.currentTime")},{value:-3e5,text:t("reminder.popover.beforeMin",{},"","5")},{value:-9e5,text:t("reminder.popover.beforeMin",{},"","15")},{value:-18e5,text:t("reminder.popover.beforeMin",{},"","30")},{value:-36e5,text:t("reminder.popover.beforeHour",{},"","1","")},{value:-72e5,text:t("reminder.popover.beforeHour",{},"","2","s")},{value:-864e5,text:t("reminder.popover.beforeDay",{},"","1","")},{value:-1728e5,text:t("reminder.popover.beforeDay",{},"","2","s")},{value:-6048e5,text:t("reminder.popover.beforeWeek",{},"","1")}],d=function(e,n,r){var o=e.split(":").map((function(e){return Number(e)})),i=n.split(":").map((function(e){return Number(e)}));return 1e3*(3600*(i[0]-o[0]+24*r)+60*(i[1]-o[1])+(i[2]-o[2]))},f="23:59:59",h="09:00:00",p=o.LANG_MAP.en?"9":"09",v=[{value:d(f,h,0),text:t("reminder.popover.currentDayTime",{},"",p)},{value:d(f,h,-1),text:t("reminder.popover.beforeDayTime",{},"",p)},{value:d(f,h,-2),text:t("reminder.popover.twoBeforeDayTime",{},"",p)},{value:d(f,h,-7),text:t("reminder.popover.beforeWeekTime",{},"",p)}]}).call(this,r("dx_E9Eu"))},dx_c5KA:function(e,n,r){"use strict";r.d(n,"R",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("record-traverser")},dx_c6Cp:function(e,n,r){"use strict";r.d(n,"J",(function(){return l})),r.d(n,"d",(function(){return s}));r("dx_lSNA");var o=r("dx_UtDZ"),i=r("dx_zEdG"),c=r("dx_WzJv"),a=r("dx_B28d");r("dx_CwnG");var l=function(){Object(i.T)("ccm_comment_view",{record_id:Object(o.getToken)(),block_type:a.B.PAGE},{})},s=function(e,n){return function(r,i){if(!i)return{};var l=Object(o.encryptTea)(Object(o.getToken)());if(n)return{object_block_data:[],block_id:l,block_type:a.B.PAGE};var s=e.getBlockModelsByCommentId(i),u=[];return s.forEach((function(e){var n=e.recordId,r=e.type,i=e.record,a=Object(c.D)(i);u.push({object_block_id:Object(o.encryptTea)(n),object_block_type:r,object_sub_block_type:a})})),{object_block_data:u,block_id:l,block_type:a.B.PAGE}}}},dx_c7yg:function(e,n,r){"use strict";r.d(n,"O",(function(){return c})),r.d(n,"m",(function(){return a})),r.d(n,"v",(function(){return l})),r.d(n,"H",(function(){return s})),r.d(n,"j",(function(){return u})),r.d(n,"n",(function(){return d}));var o,i=r("dx_USRY"),c="file",a=0,l="",s="file-block",u=0,d=i.t.Card;!function(e){e.NATIVE_PREVIEW_MOVE_IN="NATIVE_PREVIEW_MOVE_IN",e.NATIVE_PREVIEW_MOVE_OUT="NATIVE_PREVIEW_MOVE_OUT"}(o||(o={}))},dx_c9zL:function(e,n,r){"use strict";r.d(n,"S",(function(){return u})),r.d(n,"Q",(function(){return d})),r.d(n,"x",(function(){return f}));var o=r("dx_NOtv"),i=r.n(o),c=r("dx_Fimk"),a=r("dx_g0R0"),l=r("dx_aQ6g"),s=i()("pageBlock:utils");function u(){var e=document.querySelector(".".concat(l.i));if(e){var n=e.clientTop,r=e.clientHeight,o=e.clientLeft,i=e.clientWidth;return{top:n,height:r,bottom:n+r,left:o,width:i,right:o+i}}}function d(e){var n=Object(a.O)();Object(c.N)(l.S,{action:e,stack_info:n}),s("collect js trigger scroll event, action: ".concat(e,", stack_info: "),n)}function f(e,n){e instanceof Element&&(h(e,"scrollTop",n),h(e,"scrollLeft",n),function(e,n){var r=Object.getOwnPropertyDescriptor(Element.prototype,"scrollTo");if(!r)return void s("can not get scrollToDescriptor");Object.defineProperty(e,"scrollTo",{get:function(){return function(){for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return s("js trigger scroller call scrollTo(), scrollTo args: ",i),n("scrollTo"),r.value.apply(e,[].concat(i))}},configurable:!0})}(e,n))}function h(e,n,r){var o=Object.getOwnPropertyDescriptor(Element.prototype,n);o?Object.defineProperty(e,n,{get:function(){if(s("js get scroller ".concat(n)),o.get)return o.get.call(e)},set:function(i){return s("js set scroller ".concat(n)),o.set&&o.set.call(e,i),r(n),i},configurable:!0}):s("can not get propertyDescriptor")}},dx_cBZs:function(e,n,r){"use strict";(function(t){r.d(n,"J",(function(){return f}));var e=r("dx_lSNA"),o=r.n(e),i=r("dx_LSXc");function c(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function a(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?c(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var l=t("history.user.anonymity_user"),s=function(){var e,n;return(null===(e=window.User)||void 0===e||null===(n=e.language)||void 0===n?void 0:n.indexOf("zh"))>-1?"cn":"en"},u=function(e,n){var r=Object.keys(i.U).length,o=i.U[n%r];return o?o[e]:i.Z[e]},d=function(e){return{name:e?l:"",textColor:u("textColor",-1),id:"unknow_user_id",anonymity:!0,backgroundColor:u("backgroundColor",-1),labelColor:u("labelColor",-1),coverColor:u("coverColor",-1)}},f={usersConfig:{},maxColorId:-1,isShowName:!0,setShowName:function(e){this.isShowName=e},setUsersConfig:function(e){Object.keys(e).forEach((function(n){if(!!!f.usersConfig[n]){var r,o=e[n];r=o.anonymity?-1:++f.maxColorId;var i=a(a({},o),{},{textColor:u("textColor",r),backgroundColor:u("backgroundColor",r),labelColor:u("labelColor",r),coverColor:u("coverColor",r)});f.usersConfig[n]=i}}))},resetUsersConfig:function(){f.usersConfig={},f.maxColorId=-1},getUserInfoById:function(e){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s(),r=arguments.length>2?arguments[2]:void 0;return e?e.anonymity?d(r):{name:e["".concat(n,"_name")]||e.name||l,textColor:e.textColor,id:e.id,anonymity:e.anonymity,backgroundColor:e.backgroundColor,labelColor:e.labelColor,coverColor:e.coverColor}:d(r)}(f.usersConfig[e],void 0,this.isShowName)}}}).call(this,r("dx_E9Eu"))},dx_cHMm:function(e,n,r){},dx_cHnW:function(e,n,r){"use strict";r.d(n,"m",(function(){return b}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_h6a8"),d=r("dx_faye"),f=r.n(d),h=r("dx_B28d"),p=r("dx_Xdvu");function v(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return g(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function g(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var b=function(){function e(n){a()(this,e),this.blockManager=n,this.inUsed=new Set,this.editorAPI=void 0,this.editorAPI=n.editorAPI}return s()(e,[{key:"isInUsed",value:function(e){return this.inUsed.has(e)}},{key:"getRecursionProps",value:function(){var e=this.editorAPI;return Object(u.assign)({},e.getService(p.a).toPlainObject(),e.config.toPlainObject())}},{key:"renderInlineBlockByBlockId",value:function(e){return this.editorAPI.viewService.render(e,{displaymode:"inline",recursionProps:this.getRecursionProps()})}},{key:"mountInlineBlockByRecordId",value:function(e,n){var r=this.editorAPI,o=this.getInlineBlockModelByRecordId(e);if(o){n.dataset.inlineBlockId="".concat(o.id);var i=r.viewService.render(o.id,{displaymode:"inline",recursionProps:this.getRecursionProps()});f.a.render(i,n)}}},{key:"unmountInlineBlockAtNode",value:function(e){var n=Number(e.dataset.inlineBlockId);n&&(this.returnInlineBlockModelByBlockId(n),f.a.unmountComponentAtNode(e))}},{key:"getInlineBlockModelByRecordId",value:function(e){var n=this.inUsed,r=this.modelService.getBlockModelsByRecordId(e).filter((function(e){return e.parent&&h.o.includes(e.parent.type)})),o=i()(r,1)[0];if(!o)return console.error('[inline-block] failed to get inline block model for "'.concat(e,'"')),null;var c,a=v(o.parent.getInlineBlocks());try{for(a.s();!(c=a.n()).done;){var l=c.value;if(l.isDestroyed)n.delete(l);else if(l.recordId===e)return n.has(l)||n.add(l),l}}catch(s){a.e(s)}finally{a.f()}return console.error('[inline-block] failed to get inline block model for "'.concat(e,'"')),null}},{key:"returnInlineBlockModelByBlockId",value:function(e){var n=this.modelService.getBlockModelByBlockId(e);n?this.inUsed.delete(n):console.warn("[inline-block] cannot find inline block model")}},{key:"modelService",get:function(){return this.editorAPI.modelService}}]),e}()},dx_cJcU:function(e,n,r){"use strict";r.d(n,"Z",(function(){return O}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_e4eN"),a=r("dx_cyoC"),l=r("dx_xWWg"),s=r("dx_UtDZ"),u=r("dx_E7EG"),d=r("dx_C7Cb"),f=r("dx_xlCA"),h=r("dx_xs2W"),p=r("dx_s1qv"),v=r("dx_lSlT"),g=r("dx_QJ6a"),b=r("dx_FHaN"),y=r("dx_AbAm"),m=r("dx_mopU"),_=r("dx_ixLp"),k=function e(n,r,o,c,m,k){var O,x,E,S=o.dictionary[r],C=function(e,n,r,o,c){if(!r)return null;switch(r.tag){case l.t.TEXT:var m=r.property,k=Object(u.S)(m,["text"]);return e.insert(k&&k.content||"");case l.t.AT:var O=r.property;if(!O.at||!O.at.content)return e;var x=O.at,E=x.user_id,S=x.content,C=S&&S.replace("@","")||"";return f.n.getCache(E)||(f.n.setCache(E,{name:C}),null===s.suiteUserManager||void 0===s.suiteUserManager||s.suiteUserManager.addUser(E)),"docx"===c?e.insert(" ",i()({},"inline-component",JSON.stringify(Object(p.generateInlineComponent)(b.k.USER,{uid:E})))):e.insert(" ",Object(y.y)(E,C));case l.t.A:var I,B=r.property;if(!B.anchor)return null;var T=B.anchor,w=T.href,R=T.content,M=null===o||void 0===o||null===(I=o.element_entity_ref)||void 0===I?void 0:I[n];if(M){var j=M.doc_token,D=v.S.getUrl(j),A=Object(_.g)(M.doc_type);return D||(A===s.TYPE_ENUM.DOCX&&v.S.setTitle(j,M.title),v.S.setUrl(j,w)),"docx"===c?e.insert(" ",i()({},"inline-component",JSON.stringify(Object(p.generateInlineComponent)(b.k.DOC,{file_type:A,token:M.doc_token,raw_url:w,title:M.title})))):e.insert(" ",Object(y.k)({token:M.doc_token,title:M.title,url:w,type:A}))}return"docx"===c?Object(h.P)(w,!0,!0)?e.insert(R||w,i()({},g.e,Object(h.z)(w,!0))):e.insert(R||w):e.insert(R||w,i()({},a.Q.KEY,JSON.stringify({href:w,linkId:Object(d.S)()})));case l.t.P:return null;default:return e.insert(" ")}}(n,r,S,c,k);if(C)return C;if(!S)return n;(null===(O=S.child_ids)||void 0===O?void 0:O.length)&&(null===(E=S.child_ids)||void 0===E||E.forEach((function(r){return e(n,r,o,c,!1,k)})));return m&&(null===(x=S.child_ids)||void 0===x?void 0:x.length)||(n=function(e){return e.insertEnter()}(n)),n},O=function(e){var n,r=e.richContent,o=e.assignees,a=e.dueTimeValue,l=e.format,u=new c.m({zoneId:"0"});if(null===r||void 0===r||null===(n=r.rich_text)||void 0===n?void 0:n.element_ids){var d=r.rich_text,f=r.doc_entity,h=d.element_ids.length;d.element_ids.forEach((function(e,n){return k(u,e,d.elements,f,n===h-1,l)}))}if((null===o||void 0===o?void 0:o.length)&&o.forEach((function(e){return u.insert(" ",i()({},"inline-component",JSON.stringify(Object(p.generateInlineComponent)(b.k.USER,{uid:e.assignee_id}))))})),a&&a.dueTime){var v=Object(m.U)(a);u.insert(" ",i()({},"inline-component",JSON.stringify(Object(p.generateInlineComponent)(b.k.REMINDER,{expire_time:v.expireTime,is_whole_day:v.isWholeDay,should_notify:v.shouldNotify,notify_time:v.notifyTime,create_user_id:s.userHelper.getCurrentUser().get("id")}))))}return"docx"===l?u:u.insertEnter({fixEnter:"true"})}},dx_cQWW:function(e,n,r){},dx_cQo6:function(e,n,r){"use strict";r.d(n,"S",(function(){return h})),r.d(n,"Z",(function(){return p})),r.d(n,"Z6",(function(){return g}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_T7TM"),d=r("dx_B28d"),f=r("dx_Y27Y"),h=function(){function e(n){a()(this,e),this.clipboardData=n}return s()(e,[{key:"setData",value:function(n,r){this.clipboardData.setData(n,r),e.data[n]=r}},{key:"getData",value:function(n){return u.e?this.clipboardData.getData(n)||e.data[n]:this.clipboardData.getData(n)}},{key:"getTypes",value:function(){return this.clipboardData.types||Object.keys(e.data||{})}},{key:"resetDataBeforeSetData",value:function(){e.data={}}}]),e}();function p(e,n,r){n[e.id]=e,v(r,e)}function v(e,n){e[n.id]=Object.assign(e[n.id]||{},function(e){var n=e.snapshot;switch(n.type){case d.B.FILE:return{token:n.file.token};case d.B.IMAGE:return{oldRecord:e};default:return{}}}(n))}function g(e,n){var r={};return Object.entries(e).forEach((function(e){var o=i()(e,2),c=o[0],a=o[1],l=a.snapshot,s=a.id;switch(l.type){case d.B.IMAGE:case d.B.FILE:v(r,a);break;case d.B.SHEET:var u=n.getData(f.L.HTML),h=(new DOMParser).parseFromString(u,"text/html").body,p=h.querySelector(".old-record-id-".concat(s," byte-sheet-html-origin"))||h.querySelector(".old-record-id-".concat(s," table")),g=[];h.querySelectorAll(".old-record-id-".concat(c," style")).forEach((function(e){return g.push(e.outerHTML)})),r[c]={html:p,styles:g};break;case d.B.MINDMAP:case d.B.BITABLE:var b=n.getData(f.L.HTML),y=(new DOMParser).parseFromString(b,"text/html").body.querySelector(".block-id-".concat(c));y&&(r[c]={html:y})}})),r}h.data={}},dx_cToQ:function(e,n,r){},dx_cXYu:function(e,n,r){"use strict";r.d(n,"C",(function(){return u}));var o=r("dx_QILm"),i=r.n(o),c=r("dx_TSYQ"),a=r.n(c),l=r("dx_cDcd"),s=r.n(l),u=(r("dx_Drce"),function(e){var n=e.isHighlight,r=e.isActive,o=e.icon,c=e.text,l=e.className,u=e.disabled,d=i()(e,["isHighlight","isActive","icon","text","className","disabled"]);return s.a.createElement("div",Object.assign({},d,{className:a()("okr-block__header-trigger",l,{highlight:n,active:r,disabled:u})}),o,s.a.createElement("div",{className:"okr-block__header-trigger-text"},c))})},dx_cgKF:function(e,n,r){"use strict";r.d(n,"P",(function(){return l}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r("dx_D8nn");function l(){var e=Object(c.useState)(!1),n=i()(e,2),r=n[0],o=n[1];return Object(c.useEffect)((function(){return a.S.on(a.p.COMMON.HOVER_CATALOGUE,o),function(){a.S.off(a.p.COMMON.HOVER_CATALOGUE,o)}}),[]),r}},dx_ciOt:function(e,n,r){"use strict";(function(t){r.d(n,"y",(function(){return v})),r.d(n,"i",(function(){return g})),r.d(n,"b",(function(){return b}));var e=r("dx_J4zp"),o=r.n(e),i=(r("dx_QU2i"),r("dx_d1El")),c=r.n(i),a=(r("dx_VF3B"),r("dx_PcQO")),l=r("dx_cDcd"),s=r.n(l),u=r("dx_xm7J"),d=r("dx_CR0l");function f(e){var n=e.showExternalLabel,r=e.name,o=e.desc;return s.a.createElement("div",{className:"chat-card--info"},s.a.createElement("div",{className:"chat-card--title"},s.a.createElement("div",{className:"chat-card--name"},r),n&&s.a.createElement(a.Tag,{className:"chat-card--label",size:"extra-small"},t("common.external"))),o&&s.a.createElement("div",{className:"chat-card--desc"},o))}function h(e){var n=e.setShowConfirm,r=e.onConfirmJoin,o=e.onChatBtnClick;return s.a.createElement(s.a.Fragment,null,s.a.createElement("button",{type:"button",className:"chat-card--btn small",onClick:function(e){e.stopPropagation(),o&&o(d.w.CANCEL),n(!1)}},t("common.cancel")),s.a.createElement("button",{type:"button",className:"chat-card--btn active small",onClick:function(e){e.stopPropagation(),n(!1),o&&o(d.w.CONFIRM),r()}},t("common.confirm")))}function p(e){var n=e.disable,r=e.setShowConfirm,o=e.onChatBtnClick;return n?s.a.createElement(c.a,{title:t("block.chat.join_no_permission"),placement:"top",mouseEnterDelay:.2},s.a.createElement("button",{type:"button",className:"chat-card--btn disable"},t("etherpad.join_group_chat"))):s.a.createElement("button",{type:"button",className:"chat-card--btn",onClick:function(e){e.stopPropagation(),o&&o(d.w.JOIN),r(!0)}},t("etherpad.join_group_chat"))}function v(e){var n=e.icon,r=e.name,i=e.desc,c=e.disable,a=e.hasJoin,l=e.showExternalLabel,u=e.borderColor,d=e.onConfirmJoin,v=e.onConfirmOpen,g=e.onClick,b=e.isReadOnly,y=e.onChatBtnClick,m=s.a.useState(!1),_=o()(m,2),k=_[0],O=_[1];return s.a.createElement("div",{className:"chat-card",style:{borderColor:u},onClick:g},s.a.createElement("div",{className:"chat-card--icon"},s.a.createElement("img",{width:"44",height:"44",src:n})),s.a.createElement(f,{showExternalLabel:l,name:r,desc:i}),!b&&(a?s.a.createElement("button",{type:"button",className:"chat-card--btn",onClick:v},t("etherpad.initiate_conversation")):k?s.a.createElement(h,{setShowConfirm:O,onConfirmJoin:d,onChatBtnClick:y}):s.a.createElement(p,{disable:c,setShowConfirm:O,onChatBtnClick:y})))}function g(e){var n=e.borderColor,r=e.onClick;return s.a.createElement("div",{className:"chat-card",style:{borderColor:n},onClick:r},s.a.createElement("div",{className:"chat-card--icon-placeholder"}),s.a.createElement("div",{className:"chat-card--info"},s.a.createElement("div",{className:"chat-card--title-placeholder"}),s.a.createElement("div",{className:"chat-card--desc-placeholder"})))}function b(){return s.a.createElement("div",{className:"chat-card"},s.a.createElement("div",{className:"chat-card--icon"},s.a.createElement(u.S,null)),s.a.createElement("div",{className:"chat-card--info"},s.a.createElement("div",{className:"chat-card--title"},s.a.createElement("div",{className:"chat-card--name"},t("CreationDoc_Docs_GroupCard_Anonymous_Title")))))}}).call(this,r("dx_E9Eu"))},dx_cmmV:function(e,n,r){"use strict";var o;r.d(n,"j",(function(){return o})),function(e){e.left="left",e.right="right",e.top="top",e.bottom="bottom"}(o||(o={}))},dx_cqMB:function(e,n,r){"use strict";var o;r.d(n,"u",(function(){return o})),function(e){e[e.success=0]="success",e[e.offlineError=1]="offlineError",e[e.insertBlockError=2]="insertBlockError",e[e.createTokenError=3]="createTokenError"}(o||(o={}))},dx_cuqV:function(e,n,r){"use strict";(function(t){r.d(n,"B",(function(){return b})),r.d(n,"o",(function(){return y})),r.d(n,"O",(function(){return m})),r.d(n,"G",(function(){return k})),r.d(n,"Z",(function(){return x}));var e=r("dx_QILm"),o=r.n(e),i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_UtDZ"),u=r("dx_MoY1"),d=r("dx_UHze"),f=r("dx_r37e"),h=r("dx_d2dg"),p=r("dx_B28d"),v=r("dx_UTG8"),g=r("dx_JnYQ");function b(e,n){var r=e.space_id,o=void 0===r?"":r,i=e.wiki_token;return{type:n,space_id:o,wiki_token:void 0===i?"":i,comments:e.comments,author:Object(d.K)().userId}}function y(e,n){var r=e.space_id,o=void 0===r?"":r,i=e.show_num;return{type:n,space_id:o,show_num:void 0===i?g.pk[g.p]:i,comments:e.comments,author:Object(d.K)().userId}}function m(e,n,r,o){return _.apply(this,arguments)}function _(){return _=l()(c.a.mark((function e(n,r,o,i){var a,l,s,d,f,h=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=!(h.length>4&&void 0!==h[4])||h[4],s=o.getBlockModelByBlockId(i),d=null===(a=s.parent)||void 0===a?void 0:a.record.id){e.next=5;break}return e.abrupt("return");case 5:return f=l?s.position:s.position+1,e.next=8,o.applyTransaction("insertNewLine",(function(e){var i=v.InputPipe.deserializePlainText(n);Object(u.l)(e,d,f,[o.createInitModel(r,{text:i})]),o.layoutManager.getReconciler().debouncePaint()}));case 8:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}function k(e,n,r){return O.apply(this,arguments)}function O(){return(O=l()(c.a.mark((function e(n,r,i){var a,l,u,d,v,g,b;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(s.getWikiCatalogFunctions)(),l=a.currentSpaceId,u=a.currentWikiToken,e.next=3,Object(h.x)({block:n,blockManager:r,isAppend:!1,mark:{},newBlockType:p.B.WIKI_CATALOG,newBlockOptions:{space_id:l||"",wiki_token:u||""}});case 3:return d=e.sent,v=Object(f.q)({block:n,panelType:i,target:"none",blockManager:r,actionType:"add_".concat(p.B.WIKI_CATALOG)}),g=v.eventName,b=o()(v,["eventName"]),Object(s.collectEvent)(g,b),e.next=8,m(t("CreationDoc_Wiki_SubpageTOC_BlockTitle"),p.B.HEADING1,r,d||0);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s.i18nHelper.getLocale(),r="";if(e.i18NNames){var o=e.i18NNames;switch(n){case"zh-CN":r=o.zhCn;break;case"ja-JP":r=o.jaJp;break;default:r=o.enUs}}return r&&r.length||(r=e.userName),r}}).call(this,r("dx_E9Eu"))},dx_d2PS:function(e,n,r){"use strict";r.d(n,"e",(function(){return c}));var o,i,c,a,l=r("dx_lSNA"),s=r.n(l),u=r("dx_B28d");!function(e){e.UPLOAD_IMAGE="UPLOAD_IMAGE",e.UPLOAD_FILE="UPLOAD_FILE",e.PASTE_IMAGE="PASTE_IMAGE",e.PASTE_FILE="PASTE_FILE"}(c||(c={})),function(e){e.UPLOAD_IMAGE="OFFLINE_UPLOAD_IMAGE_DATA",e.UPLOAD_FILE="OFFLINE_UPLOAD_FILE_DATA",e.PASTE_IMAGE="OFFLINE_PASTE_IMAGE_DATA",e.PASTE_FILE="OFFLINE_PASTE_FILE_DATA"}(a||(a={}));o={},s()(o,c.UPLOAD_IMAGE,a.UPLOAD_IMAGE),s()(o,c.UPLOAD_FILE,a.UPLOAD_FILE),s()(o,c.PASTE_IMAGE,a.PASTE_IMAGE),s()(o,c.PASTE_FILE,a.PASTE_FILE),i={},s()(i,a.UPLOAD_IMAGE,u.B.IMAGE),s()(i,a.UPLOAD_FILE,u.B.FILE),s()(i,a.PASTE_IMAGE,u.B.IMAGE),s()(i,a.PASTE_FILE,u.B.FILE)},dx_d2dD:function(e,n,r){},dx_d2dg:function(e,n,r){"use strict";r.d(n,"k",(function(){return O})),r.d(n,"J",(function(){return x})),r.d(n,"x",(function(){return I})),r.d(n,"z",(function(){return w}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_o0o1"),a=r.n(c),l=r("dx_lSNA"),s=r.n(l),u=r("dx_yXPU"),d=r.n(u),f=r("dx_e4eN"),h=r("dx_Z7ZC"),p=r("dx_I11I"),v=r("dx_ZG9w"),g=r("dx_kZ3l"),b=r("dx_hDVN"),y=r("dx_oJay"),m=r("dx_FH1m");function _(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function k(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?_(Object(r),!0).forEach((function(n){s()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var O=function(e){return!!e.editor};function x(e){return E.apply(this,arguments)}function E(){return(E=d()(a.a.mark((function e(n){var r,o,c,l,s,u,d,f,h,p,v,g,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.block,o=n.blockManager,c=n.mark,l=n.isAppend,s=n.newBlockType,u=n.newBlockOptions,d=n.range,f=n.autoFocus,e.next=3,Object(y.w)({block:r,blockManager:o,mark:c,needAddNewBlock:l,needReplaceRangeText:!1,range:d});case 3:return h=e.sent,p=i()(h,2),v=p[0],g=p[1],e.next=9,Object(m.q)(o,v,g,o.createInitModel(s,u),void 0,f);case 9:return b=e.sent,e.abrupt("return",b);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return C.apply(this,arguments)}function C(){return(C=d()(a.a.mark((function e(n){var r,o,i,c,l,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.block,o=n.blockManager,i=n.newBlockType,c=n.newBlockOptions,l=n.autoFocus,e.next=3,Object(b.S)({blocks:[r],blockManager:o,newBlockType:i,options:c,autoFocus:l});case 3:return s=e.sent,e.abrupt("return",null===s||void 0===s?void 0:s.id);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){return B.apply(this,arguments)}function B(){return(B=d()(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O(n.block)){e.next=4;break}return e.abrupt("return",x(n));case 4:return e.abrupt("return",S(n));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T=function(){var e=d()(a.a.mark((function e(n){var r,o,i,c,l,u,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.block,o=n.blockManager,i=n.newBlockOptions,c=n.newBlockType,l=n.range,u=n.afterTransactionAccepted,d="",e.next=4,o.applyTransaction("insertInlineBlockInTextualBlock",(function(e){var n=o.createInitModel(c,i);d=e.create(n);var a=r.model,u=a.zoneState,b=a.zoneId,y=Object(g.JI)(u,[l[0],l[1]]),m=Object(v.w)(r.model,y),_=new f.m({zoneId:b}).retain(l[0]).delete(l[1]-l[0]).insert(" ",k(s()({},p.B,d),m));r.model.apply(_,{extra:{op:e}}),Object(h.w)(e,r.record,r.model.zoneState.toAttributeText())}),{afterTransactionAccepted:function(){u&&u(d)}});case 4:return e.abrupt("return",d);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),w=function(){var e=d()(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!O(n.block)){e.next=4;break}return e.next=3,T(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},dx_d5ce:function(e,n,r){},dx_d5dp:function(e,n,r){"use strict";r.d(n,"k",(function(){return c}));var o=r("dx_zEdG"),i=r("dx_CwnG"),c=function(e){var n=e.blockId,r=e.blockManager,c=e.actionType,a=e.actionValue,l=void 0===a?"":a,s=e.target,u=void 0===s?"":s;return Object(o.P)("ccm_doc_content_page_click",Object(i.m)(n,r),{click:"block_custom_action",target:u,action_type:c,action_value:l,object_block_data:Object(i.T)([n],r)})}},dx_d6al:function(e,n,r){"use strict";r.d(n,"v",(function(){return h})),r.d(n,"Q",(function(){return p}));var o=r("dx_UtDZ"),i=r("dx_h6a8"),c=r("dx_ukKW"),a=r("dx_l6la"),l=r("dx_B28d"),s=new Map,u={imgLoaded:!1,lightLoaded:!1};function d(e){return!!e&&(e.complete&&(!Object(i.isNumber)(e.naturalWidth)||e.naturalWidth>0))}function f(e,n){var r=n.querySelector("img"),o=null===r||void 0===r?void 0:r.src;Object(c.TM)(o)?s.set(e,{src:o,loaded:d(r)}):console.log("dehydrateSSRImage: src is not drive Image",o)}function h(){!function(){var e=document.querySelector("#ssrBox");e&&e.querySelectorAll(".docx-image-block").forEach((function(e){var n=e.getAttribute("data-record-id"),r=e.getAttribute("data-block-type");n&&r===l.B.IMAGE&&f(n,e)}))}(),function(){var e=document.querySelector("#ssrBox"),n=null===e||void 0===e?void 0:e.querySelector(".ssr-cover"),r=null===n||void 0===n?void 0:n.querySelector(".ssr-cover-image-container");if(n&&r){var c=r.querySelector(".ssr-cover-cover-image"),l=r.querySelector(".ssr-cover-hd-image"),s=window.finalSSRCoverInfo||null;s&&(u.imgLoaded=d(l),u.lightLoaded=d(c),u.coverInfo=Object(i.cloneDeep)(s),console.info("dehydrateSSRCover",u),s&&o.store.dispatch(Object(a.N)(s)))}}()}function p(e){return s.has(e)||function(e){var n=document.querySelector("#ssrBox");if(n){var r=n.querySelector(".docx-image-block[data-record-id=".concat(e,"]"));r&&r.getAttribute("data-block-type")===l.B.IMAGE&&f(e,r)}}(e),s.get(e)}},dx_d8VX:function(e,n,r){"use strict";(function(t){var e=r("dx_lSNA"),o=r.n(e),i=r("dx_PcQO"),c=r("dx_TSYQ"),a=r.n(c),l=r("dx_h6a8"),s=r("dx_cDcd"),u=r.n(s),d=r("dx_Yz4Z"),f=r("dx_MBBr"),h=(r("dx_INf6"),"okr-combo-progress");n.S=function(e){var n=e.progressStatus,r=e.value,c=e.error,s=e.onStatusChange,p=void 0===s?l.noop:s,v=e.onFocus,g=e.onChange,b=e.onBlur,y=e.onPressEnter,m=Object(d.S)(16);return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:a()("".concat(h,"__field"),"".concat(h,"__field-gap"))},u.a.createElement("div",{className:"".concat(h,"__field")},t("CreationDoc_Docs_OKR_Status")),u.a.createElement("div",{className:"".concat(h,"__field-controller")},u.a.createElement(f.S,{value:n,onChange:p}))),u.a.createElement("div",{className:a()("".concat(h,"__field"),o()({},"has-error",c))},u.a.createElement("div",{className:"".concat(h,"__field-title")},t("CreationDoc_Docs_OKR_Status_Progress")),u.a.createElement("div",{className:a()("".concat(h,"__field-controller"),o()({},"has-error",c))},u.a.createElement(i.Input,{ref:m,addonAfter:"%",value:r,maxLength:15,onFocus:v,onChange:g,onBlur:b,onPressEnter:y})),c&&u.a.createElement("div",{className:"".concat(h,"--error")},c)))}}).call(this,r("dx_E9Eu"))},dx_d8dQ:function(e,n,r){"use strict";var o=r("dx_BaZy"),i=r.n(o)()({loader:function(){return Promise.all([r.e("dx_k3k"),r.e("dx_p5p"),r.e("dx_G1G"),r.e("dx_N76")]).then(r.bind(null,"dx_e2eK"))},loading:function(){return null}});n.S=i},dx_dMkl:function(e,n,r){"use strict";(function(t){r.d(n,"u",(function(){return w}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_W7W2"),f=r.n(d),h=r("dx_a1gu"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=(r("dx_Zx3K"),r("dx_m3ds")),y=r("dx_FBWK"),m=r("dx_UtDZ"),_=r("dx_cDcd"),k=r.n(_),O=r("dx_B28d"),x=r("dx_MGoZ"),E=r("dx_sNGG"),S=r("dx_jrCs"),C=r("dx_OcvB"),I=r("dx_JnYQ"),B=r("dx_VHoe");function T(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}var w=function(e){f()(r,e);var n=T(r);function r(){var e;l()(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=n.call.apply(n,[this].concat(a))).state={displaySizePickerVisible:!1,isSelected:!1},e.blockStatus=B.Q.UNKOWN,e.recentListData=[],e.recentListDataUuid="",e.onDataUpdate=function(n){e.recentListData=n,e.recentListDataUuid=Object(y.UUIDv4)(),e.blockManager.layoutManager.notifyNodeHeightChange(e.id),e.blockManager.dispatch(E.Y.THIRD_PARTY_CONTENT_CHANGE),e.props.recursionProps.isPresentationMode&&window.dispatchEvent(new Event("resize"))},e.onSelectWiki=function(){var n=c()(o.a.mark((function n(r){var i,c;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=r.spaceId,c=e.isFirstInsert(),n.next=4,e.props.model.applyTransaction("wikiRecentWikiSelected",(function(n){n.replace(e.model.record.id,["space_id"],i)}));case 4:e.showSuccessToast(t(c?"CreationDoc_Wiki_UpdatesBlock_SetSuccessfully_Toast":"CreationDoc_Wiki_UpdatesBlock_SettingsUpdated_Toast")),Object(m.collectEvent)("ccm_doc_wiki_block_space_click",{view_title:"wiki_recent_update",click:"confirm",target:"none",target_space_id:Object(m.encryptTea)(i)});case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.setDisplaySize=function(){var n=c()(o.a.mark((function n(r){return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.props.model.applyTransaction("wikiRecentWikiSelected",(function(n){n.replace(e.model.record.id,["show_num"],r)}));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.openWikiPicker=function(){var n=Object(m.getWikiRecentFunctions)(),r=e.props.model.snapshot.space_id;n.openWikiPicker(!0,e.onSelectWiki,r,""),Object(m.collectEvent)("ccm_doc_wiki_block_space_view",{view_title:"wiki_recent_update"})},e.openDisplaySizePicker=function(){e.setDisplaySizePickerVisible(!0)},e.setDisplaySizePickerVisible=function(n){e.setState({displaySizePickerVisible:n})},e.setBlockStatus=function(n){e.blockStatus=n},e}return u()(r,[{key:"blockViewDidMount",value:function(){var e,n;null===(e=(n=this.props).onBlockReady)||void 0===e||e.call(n);var r=this.props.model.snapshot.space_id,o=void 0===r?"":r;this.model.isFromLocal&&!o.length&&this.openWikiPicker()}},{key:"setSelected",value:function(e){this.setState({isSelected:e})}},{key:"isFirstInsert",value:function(){var e=this.props.model.snapshot.space_id;return void 0===e||""===e}},{key:"showSuccessToast",value:function(e){m.Toast.show({key:"wiki-recent-success",type:"success",content:e})}},{key:"render",value:function(){if(this.shouldShowPreviewPlaceholder)return k.a.createElement(S.S,{type:O.B.WIKI_RECENT,locale:Object(y.getLocale)()});var e=this.props.model.snapshot,n=e.space_id,r=void 0===n?"":n,o=e.show_num,i=void 0===o?I.pk[I.p]:o,c=this.state,a=c.displaySizePickerVisible,l=c.isSelected;return k.a.createElement(C.I,{editable:this.editable,blockId:this.props.record.id,spaceId:r,displaySize:i,displaySizePickerVisible:a,isSelected:l,setDisplaySize:this.setDisplaySize,setDisplaySizePickerVisible:this.setDisplaySizePickerVisible,onDataUpdate:this.onDataUpdate,onClickNoContentBtn:this.openWikiPicker,onStatusChange:this.setBlockStatus})}},{key:"editable",get:function(){return b.S.isMobile?this.props.recursionProps.editPermission:!1!==this.props.recursionProps.editable}},{key:"shouldShowPreviewPlaceholder",get:function(){return Object(y.isShortCut)()||this.props.recursionProps.isPreview||this.props.recursionProps.isSSR}}]),r}(x.l)}).call(this,r("dx_E9Eu"))},dx_dOu9:function(e,n,r){"use strict";r.d(n,"Y",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("image-manager")},dx_dRZF:function(e,n,r){"use strict";r.d(n,"S",(function(){return _}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_cDcd"),v=r.n(p),g=r("dx_h74D"),b=r("dx_BmAg"),y=r("dx_jNWT");function m(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var _=function(e){s()(r,e);var n=m(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"getWrapper",value:function(e){return function(n){var r=Object(g.useSelector)(b.I,(function(){return!0})),o=Object(g.useSelector)(y.B,(function(){return!0}));return v.a.createElement(e,Object.assign({},n,{showCommentInit:r,isViewEditors:o}))}}}]),r}(r("dx_Vau3").A)},dx_dUBi:function(e,n,r){},dx_dVbY:function(e,n,r){"use strict";r.d(n,"H",(function(){return f})),r.d(n,"M",(function(){return h})),r.d(n,"o",(function(){return p})),r.d(n,"O",(function(){return v})),r.d(n,"Z",(function(){return g})),r.d(n,"E",(function(){return b}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_RIqP"),a=r.n(c),l=r("dx_zghO"),s=r("dx_ppc6");function u(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return d(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function d(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var f=function(e){return e.getTextEditorSelection()};function h(e,n,r){return function(e,n,r){var o=function(e){var n=e.editorAPI.getService(s.S).getSelectedBlockIfInSelection(e.id),r=e.zoneState,o=r.offsetToPoint(0),i=r.offsetToPoint(r.getModelText().length-1);return n&&n.type===l.j.TEXT&&(o=r.offsetToPoint(n.selection.start),i=r.offsetToPoint(n.selection.end)),{start:o,end:i}}(e),i=e.getAttributes(o.start,o.end).toMap();if(!r)return!!i[n];return i[n]===r}(e.model,n,r)}var p=function(e,n,r){var o=f(e),i=e.model.schema;return!e.model.zoneState.getEntities(o).some((function(e){var o,c=function(e,n){if(n)return Object.keys(n).filter((function(e){return n[e]})).find((function(n){var r,o;return(null===(r=e.get(n))||void 0===r?void 0:r.attributes)||(null===(o=e.get(n))||void 0===o?void 0:o.lineAttributes)}))}(i,e.attributes),a=c&&(null===(o=i.get(c))||void 0===o?void 0:o.attributes);return!(c&&a&&!(a instanceof RegExp?a.test(n):a(n,r||"",c)))&&(!Object.keys(e.attributes).find((function(e){return e===n}))||(r?e.attributes[n]!==r:!e.attributes[n]))}))},v=function(e,n,r){var o,c=a()(new Set(e.slice())),l=c.every((function(e){return p(e,n,r||""===r?r:void 0)})),s=u(c);try{for(s.s();!(o=s.n()).done;){var d=o.value,h=f(d);r||""===r?d.model.toggleMark(i()({},n,r),h,l):d.model.toggleMark(i()({},n,"true"),h,l)}}catch(v){s.e(v)}finally{s.f()}},g=function(e,n,r){var o,c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=a()(new Set(e.slice())),s=u(l);try{for(s.s();!(o=s.n()).done;){var d=o.value,h=f(d);(r||""===r)&&d.model.toggleMark(i()({},n,r),h,c)}}catch(p){s.e(p)}finally{s.f()}},b=function(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=e.filter((function(e){return!e.model.isEmpty})),c=u(i);try{for(c.s();!(r=c.n()).done;){var a=r.value,l=f(a);a.model.toggleMark(n,l,o)}}catch(s){c.e(s)}finally{c.f()}}},dx_dWqj:function(e,n,r){"use strict";(function(t){r.d(n,"Z",(function(){return _}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_PcQO"),p=r("dx_TSYQ"),v=r.n(p),g=r("dx_cDcd"),b=r.n(g),y=r("dx_mwQr");r("dx_n5nO");function m(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var _=function(e){l()(r,e);var n=m(r);function r(){var e;o()(this,r);for(var i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).checkVertical=function(){return e.props.status.isVertical?"vertical":"horizontal"},e}return c()(r,[{key:"render",value:function(){var e=this.props,n=e.onLeave,r=e.onClick,o=e.status,i=o.visible,c=o.lineLength,a=o.isVertical,l=o.offset,s=c+-2,u=t(a?"ace_table.add_column":"ace_table.add_row"),d=v()("table-hover-ignore table-add-line-symbol",{vertical:a,horizontal:!a,visible:i}),f=v()("add-line-icon",{visible:i}),p=a?{marginTop:"2px"}:void 0;return b.a.createElement("div",{className:d,style:{left:a?l:void 0,top:a?void 0:l}},b.a.createElement(h.Tooltip,{title:u,placement:"top",visible:i,overlayStyle:p},b.a.createElement("div",{className:"add-line-icon-hotzone",onClick:r,onMouseLeave:n},b.a.createElement("div",{className:f},b.a.createElement(y.S,null)))),b.a.createElement("div",{className:"add-line-line",style:{height:s}}))}}]),r}(b.a.Component)}).call(this,r("dx_E9Eu"))},dx_dWtO:function(e,n,r){"use strict";r.d(n,"W",(function(){return u})),r.d(n,"u",(function(){return d}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_AAGW"),s=r("dx_UmoL"),u=function(){var e=a()(i.a.mark((function e(n){var r,o,c,a,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.scene,o=n.token,c=void 0===o?"":o,(a=new URLSearchParams).append("token",c),a.append("obj_type","22"),r.forEach((function(e){return a.append("scene",e)})),e.next=7,l.S.get("/platform/common_setting/get",{params:a,baseURL:Object(s.q)()});case 7:if(0===(u=e.sent).code){e.next=10;break}throw new Error(u.msg);case 10:return e.abrupt("return",u.data);case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),d=function(e){var n=e.settings,r=e.token,o=void 0===r?"":r;return l.S.post("/platform/common_setting/update",{token:o,obj_type:22,settings:n},{baseURL:Object(s.q)()})}},dx_dYKg:function(e,n,r){"use strict";r.d(n,"x",(function(){return C})),r.d(n,"w",(function(){return B})),r.d(n,"Z",(function(){return T})),r.d(n,"J",(function(){return w})),r.d(n,"h",(function(){return R})),r.d(n,"t",(function(){return M})),r.d(n,"R",(function(){return D})),r.d(n,"q",(function(){return A})),r.d(n,"I",(function(){return P})),r.d(n,"Hd",(function(){return N})),r.d(n,"Y",(function(){return F})),r.d(n,"H",(function(){return U})),r.d(n,"M",(function(){return V})),r.d(n,"RK",(function(){return W})),r.d(n,"D",(function(){return G})),r.d(n,"g",(function(){return K})),r.d(n,"V",(function(){return q})),r.d(n,"wh",(function(){return X}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_e4eN"),s=r("dx_NOtv"),u=r.n(s),d=r("dx_UtDZ"),f=r("dx_h6a8"),h=r("dx_yzqx"),p=r("dx_zUqt"),v=r("dx_UHze"),g=r("dx_Fimk"),b=r("dx_T7TM"),y=r("dx_o8Rd"),m=r("dx_bvq6"),_=r("dx_qx8A"),k=r.n(_),O=r("dx_FA1D"),x=r("dx_s9Aa"),E=r("dx_AIJo"),S=u()("abbreviation:utils");function C(){return I.apply(this,arguments)}function I(){return(I=a()(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all([r.e("dx_vNU"),r.e("dx_UTc"),r.e("dx_v7vu"),r.e("dx_hbnQ"),r.e("dx_zkE")]).then(r.bind(null,"dx_NhnX")).then((function(e){return new(0,e.EnterprisepediaHelper)({mode:e.RuntimeMode.lite,locale:d.i18nHelper.getLocale()})})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(){var e=window.User.tenantId,n=function(e,n){"function"===typeof e.get&&(e=e.toJS());for(var r=Object.keys(e),o=0;o<r.length;o+=1){var i=r[o];if(i.includes(n)&&e[i])return e[i].tenant_id}return""}(k.a.getState().entities.objs,Object(p.k)());return!(!e||!n)&&e===n}function T(){return Object(d.getMinaConfig)("asl_docx_abbreviation_read_highlight",!1)}function w(){return!Object(v.E)()&&Object(d.getMinaConfig)("lark_ai_abbreviation_in_docs",!1)}function R(){var e=w(),n=k.a.getState().appState.userSettings,r=1===Object(O.B)(n,"abbreviation_installed"),o=1===Object(O.B)(n,"abbreviation_setting"),i=B();return S("isFGEnabled=".concat(e," isInstalled=").concat(r," isOpen=").concat(o," isSameTenant=").concat(i)),e&&r&&o&&i&&!h.S.isOpendoc}function M(){return j.apply(this,arguments)}function j(){return(j=a()(i.a.mark((function e(){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.L)();case 2:n=e.sent,k.a.dispatch({type:"FETCH_ABBREVIATION_SETTING",payload:n});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var D=Object(f.once)(a()(i.a.mark((function e(){var n,o,c,a,l,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([r.e("dx_vNU"),r.e("dx_UTc"),r.e("dx_v7vu"),r.e("dx_hbnQ"),r.e("dx_zkE")]).then(r.bind(null,"dx_tNU1"));case 2:return n=e.sent,o=n.default,c=n.Env,a=Object(f.get)(window,"globalConfig.common.domain",{}),l=Object(f.get)(window,"globalConfig.common.product","feishu"),s=Object(f.get)(window,"globalConfig.common.channel",""),S("before call config.init",a,l),e.next=11,o.init({appName:"bear-web-x",appVersion:"0.1.0",locale:d.i18nHelper.getLocale(),appRegion:"feishu"===l?"cn":"va",env:b.T?c.Dev:b.Z?c.Boe:c.Production,urls:{larkAPIDomain:a.lark_api,larkApplinkDomain:a.applink,larkFileDomain:a.lark_file},slardar:"saas"===s});case 11:S("after call config.init");case 12:case"end":return e.stop()}}),e)}))));function A(){return h.S.isInVC?"doc_magic_share":h.S.isLark?"doc_feed":"doc_web"}function P(e){var n=e.abbr_id,r=e.file_id;Object(g.N)("ccm_abbr_mention_showed",{abbr_id:n,card_scene:3,card_source:A(),file_id:r})}function L(e){if(e.length<=1)return e;var n=[],r=new Set;return e.forEach((function(e){var o=e.start,i=e.end,c=e.attributes,a=o.zoneId,l=o.line,s=o.offset,u=i.zoneId,d=i.line,f=i.offset,h="".concat(a,"_").concat(l,"_").concat(s,"_").concat(u,"_").concat(d,"_").concat(f,"_").concat(c[E.b]);r.has(h)||(r.add(h),n.push(e))})),n}function N(e,n){return e.applyTransaction("saveAbbreviationData",(function(e){n.forEach((function(n){var r=n.recordId,o=n.contentState,i=n.entities;e.replace(r,["text"],function(e,n,r){var o=n[0].start.zoneId,i=e.getZoneState(o),c=new l.m({zoneId:o}),a=0;return(n=L(n)).sort((function(e,n){return i.pointToOffset(e.start)-i.pointToOffset(n.start)})).forEach((function(e){var n=e.start,r=e.end,o=e.attributes,l=i.pointToOffset(n),s=i.pointToOffset(r);c.retain(l-a).retain(s-l,o),a=s})),e.apply(c,{extra:{ignoreFold:!0,op:r}}),e.getZoneState(o).toAttributeText()}(o,i,e))}))}),{undoable:!1})}function F(e,n){var r="[data-record-id=".concat(e,"] .abbreviation-inline-wrapper.abbreviation-").concat(U(n));["".concat(r," {\n      cursor: inherit;\n    }\n    "),"".concat(r," .abbreviation-text {\n      border-bottom-width: 0 !important;\n    }")].forEach((function(e){return y.S.insertRule(e)}))}function U(e){return e.toLowerCase().replace(/\s/g,"SPACE").replace(/#/g,"HASHTAG").replace(/\*/g,"ASTERISK").replace(/\//g,"SLASH").replace(/\\/g,"BACKSLASH").replace(/\./g,"DOT").replace(/\$/g,"DOLLAR")}function H(e,n,r){var o=e.end,i=o.line,c=o.offset,a=o.zoneId,l=e.attributes||{},s=n.start,u=s.line,d=s.offset,f=s.zoneId,h=n.attributes||{};return i===u&&c===d&&a===f&&l[r]===h[r]}function V(e,n){if(e.length<=1)return e;for(var r=[],o=Object(O.f)(e[0]),i=1;i<e.length;i++){var c=e[i];H(o,c,n)?(o.attributes=Object.assign(o.attributes,c.attributes),o.end=c.end,o.text+=c.text):(r.push(o),o=Object(O.f)(c))}return r.push(o),r}function W(e,n){var r=k.a.getState().entities.objs[Object(p.k)()];if(r&&r.obj_id)return{space:1,actionType:e?6:7,spaceId:r.obj_id,spaceSubId:Object(d.encryptTea)(n),showPin:e}}var z;new Map;function G(e){var n=e.attributes;return"true"===n.inlineCode||Boolean(n[m.O.KEY])||Boolean(n["link-id"])||Boolean(n.link)||Boolean(n.equation)}function K(e,n){var r=n[0].start.zoneId,o=e.getZoneState(r);if(o){var i=new l.m({zoneId:r}),c=0;(n=L(n)).sort((function(e,n){return o.pointToOffset(e.start)-o.pointToOffset(n.start)})).forEach((function(e){var n=e.start,r=e.end,a=e.attributes,l=o.pointToOffset(n),s=o.pointToOffset(r);i.retain(l-c).retain(s-l,a),c=s})),e.apply(i,{nonundoable:!0,extra:{shouldCollab:!1}})}}function q(){return!!document.querySelector(".aslcard-baike-ultra-card")}function X(e){d.feelgoodHelper&&"function"===typeof d.feelgoodHelper.tryShowDocxAbbrCardFeelgood&&d.feelgoodHelper.tryShowDocxAbbrCardFeelgood(e)}!function(e){e.ABBREVIATION_SHOWN_TIMES="ccm_doc_abbreviation_shown_times",e.ABBREVIATION_CONTINUE_SHOWN="ccm_doc_abbreviation_continue_shown"}(z||(z={}))},dx_dajS:function(e,n,r){"use strict";r.d(n,"l",(function(){return O}));var o,i,c=r("dx_lwsE"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_N9dL"),g=r("dx_B28d"),b=r("dx_o68o"),y=r("dx_cuqV"),m=r("dx_F5F0"),_=r("dx_dMkl");function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var O=Object(p.H)({providers:[{provide:v.RecordSnapshotCreator,useValue:{type:g.B.WIKI_RECENT,create:y.o}}]})((i=function(e){s()(r,e);var n=k(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).blocks=Object(b.i)()?[[m.C,{viewCreator:_.u}]]:[],e}return r}(p.y),o=i))||o},dx_dbks:function(e,n,r){"use strict";r.d(n,"T",(function(){return c}));var o=r("dx_fEKD"),i=r("dx_B28d");function c(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.B.VIEW;return Object(o.b)(e,n)}},dx_ddxk:function(e,n,r){"use strict";r.d(n,"R",(function(){return _}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_Kug6"),b=r("dx_UtDZ"),y=r("dx_E7EG");function m(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var _=function(e){d()(r,e);var n=m(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"matchLink",value:function(e){for(var n=Object(y.S)(window,"globalConfig.common.domainPool",[]),r=new RegExp("https?://(?:[^/]+\\.)?(?:".concat(n.map((function(e){return"(?:".concat(e,")").replace(/\./g,"\\.")})).join("|"),")\\/(\\w+)\\/(\\w+)\\??([\\w=&.-]*)#?(\\w*)"),"g"),o=[],c=r.exec(e);c;){var a=c,l=i()(a,5),s=l[0],u=l[1],d=l[2],f=l[3],h=l[4];if(Object(b.isSuiteUrl)(s)){var p=r.lastIndex;o.push({url:s,token:d,start:p-s.length,end:p,topLevelDomain:"",business:u,query:f,hash:h})}c=r.exec(e)}return o}}]),r}(g.R)},dx_dr3d:function(e,n,r){"use strict";r.d(n,"J",(function(){return u})),r.d(n,"G",(function(){return d}));var o=r("dx_UtDZ"),i=r("dx_h6a8"),c=r("dx_yzqx"),a=c.S.isMobile,l={docx_virtual_check_viewport_visibility_enable:!0,docx_virtual_idle_worker_enable:!0,docx_virtual_render_enable:!0,docx_virtual_scroll_dirty_range:8e3,docx_virtual_slice_mount_threshold:20,docx_virtual_viewport_threshold:90,docx_virtual_buffer_range:void 0,docx_virtual_tracker_store_size:10,docx_virtual_idle_normal_render_distance:5e3,docx_virtual_idle_normal_min_interval:300,docx_virtual_idle_fast_render_distance:15e3,docx_virtual_idle_fast_render_duration:5e3,docx_virtual_idle_fast_max_interval:100,docx_virtual_idle_fast_scroll_distance_factor:a?3:1.5};function s(e){var n=a?Object(i.get)(window,"User.appConfig.virtualRenderConfig",l):Object(o.getMinaConfig)("docx_virtual_render_config",l);return e?n[e]:n}function u(){return s("docx_virtual_check_viewport_visibility_enable")}function d(){var e=s(),n=e.docx_virtual_scroll_dirty_range,r=e.docx_virtual_viewport_threshold,o=e.docx_virtual_buffer_range,i=e.docx_virtual_render_enable,a=e.docx_virtual_idle_worker_enable,l=e.docx_virtual_slice_mount_threshold,u=e.docx_virtual_tracker_store_size,d=e.docx_virtual_enable_record_document_structs,f=e.docx_virtual_visibility_auto_fixed_mode,h=e.docx_virtual_did_change_node_record_store_size;return{enableVirtualRender:i,enableIdleWorker:a,extraDirtyRangeToBeUpdateWhenScrollUp:n,viewportLockConfig:{partInViewportThreshold:r},bufferRange:o,disableSetScrollTopWhenScrolling:c.S.isIOS||c.S.isIPad,sliceMountThreshold:l,trackerStoreSize:u,enableRecordDocumentStructs:d,autoFixedMode:f,didChangeNodesRecordStoreSize:h,idleRenderOptions:Boolean(e.docx_virtual_idle_normal_render_distance)?{normalRenderDistance:e.docx_virtual_idle_normal_render_distance,normalMinInterval:e.docx_virtual_idle_normal_min_interval,fastRenderDistance:e.docx_virtual_idle_fast_render_distance,fastRenderDuration:e.docx_virtual_idle_fast_render_duration,fastMaxInterval:e.docx_virtual_idle_fast_max_interval,fastScrollDistanceFactor:e.docx_virtual_idle_fast_scroll_distance_factor}:void 0}}},dx_e46e:function(e,n,r){"use strict";r.d(n,"S",(function(){return h}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_h6a8"),d=r("dx_D8nn"),f=r("dx_k8kI"),h=function(){function e(n){var r=this;a()(this,e),this.blockManager=void 0,this.eventEmitter=new d.i,this.animationRequestId=void 0,this.taskQueue=[],this.visibleBlockIds=[],this.visibleListenerBlockIds=[],this.handleLayoutPaint=Object(u.debounce)((function(){var e=r.blockManager.layoutManager,n=e.getViewportBlocks(),o=e.getBufferBlocks();r.visibleBlockIds=[].concat(i()(n),i()(o));var c=r.calculateVisibleBlocks(r.visibleBlockIds).currentTasks;r.stopTaskQueue(),r.taskQueue=c,r.runTaskQueue()}),300),this.blockManager=n.blockManager,this.blockManager.addListener(f.w2,this.handleLayoutPaint)}return s()(e,[{key:"isBlockVisible",value:function(e){return this.visibleBlockIds.indexOf(e)>-1}},{key:"onBlockChange",value:function(e,n){this.isBlockVisible(e)&&-1===this.visibleListenerBlockIds.indexOf(e)&&this.visibleListenerBlockIds.push(e),this.eventEmitter.on(this.getEventName(e),n)}},{key:"emitBlockChange",value:function(e,n){this.eventEmitter.emit(this.getEventName(e),{isVisible:n})}},{key:"offBlockChange",value:function(e,n){this.eventEmitter.off(this.getEventName(e),n),0===this.eventEmitter.getListeners(this.getEventName(e)).length&&this.visibleListenerBlockIds.splice(this.visibleListenerBlockIds.indexOf(e),1)}},{key:"destroy",value:function(){this.handleLayoutPaint.cancel(),this.blockManager.removeListener(f.w2,this.handleLayoutPaint)}},{key:"getEventName",value:function(e){return"".concat("BlockViewportChange","_").concat(e)}},{key:"stopTaskQueue",value:function(){window.cancelAnimationFrame(this.animationRequestId)}},{key:"runTaskQueue",value:function(){var e=this;0!==this.taskQueue.length&&(window.cancelAnimationFrame(this.animationRequestId),this.animationRequestId=window.requestAnimationFrame((function(){for(var n=0,r=[];n<10&&e.taskQueue.length>0;){var o=e.taskQueue.shift();if(o){var i=o.blockId,c=o.isVisible;e.emitBlockChange(i,c),r.push(i),c?e.visibleListenerBlockIds.push(i):e.visibleListenerBlockIds.splice(e.visibleListenerBlockIds.indexOf(i),1)}n++}e.runTaskQueue()})))}},{key:"calculateVisibleBlocks",value:function(e){var n=this,r=e.filter((function(e){return n.eventEmitter.getListeners(n.getEventName(e)).length>0})),o=[].concat(i()(r),i()(this.visibleListenerBlockIds)).reduce((function(e,o){var i=-1===n.visibleListenerBlockIds.indexOf(o),c=-1===r.indexOf(o);return i&&e.enter.push({blockId:o,isVisible:!0}),c&&e.leave.push({blockId:o,isVisible:!1}),e}),{enter:[],leave:[]});return{currentTasks:[].concat(i()(o.enter),i()(o.leave)),currentVisibleBlockIds:r}}}]),e}()},dx_e6eH:function(e,n,r){"use strict";r.d(n,"a",(function(){return Q})),r.d(n,"i",(function(){return O})),r.d(n,"Q",(function(){return $}));var o=r("dx_UtDZ"),i=r("dx_J4zp"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_W7W2"),f=r.n(d),h=r("dx_a1gu"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=r("dx_cDcd"),y=r.n(b),m=r("dx_Vau3"),_=r("dx_Pa9M");function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}var O=function(e){f()(r,e);var n=k(r);function r(){return l()(this,r),n.apply(this,arguments)}return u()(r,[{key:"getWrapper",value:function(e){var n=this;return function(r){var o=r.blockId,i=r.recordId,a=null,l=!0;n.headingModule&&(a=n.headingModule.getOrderText(i),l=!n.headingModule.dataReady);var s=Object(b.useState)(a),u=c()(s,2),d=u[0],f=u[1],h=Object(b.useState)(l),p=c()(h,2),v=p[0],g=p[1],m=Object(b.useCallback)((function(){n.headingModule&&(f(n.headingModule.getOrderText(i)),v&&n.headingModule.dataReady&&g(!1))}),[o,v]);return Object(b.useEffect)((function(){return n.blockManager.addListener(_.t.FORCE_UPDATE,m,o),function(){n.blockManager.removeListener(_.t.FORCE_UPDATE,m,o)}}),[m,o]),y.a.createElement(e,Object.assign({},r,{order:d,loading:v}))}}},{key:"headingModule",get:function(){return this.options.headingModule}}]),r}(m.A),x=r("dx_lSNA"),E=r.n(x),S=r("dx_o0o1"),C=r.n(S),I=r("dx_yXPU"),B=r.n(I),T=r("dx_RIqP"),w=r.n(T),R=r("dx_iWIM"),M=r.n(R),j=r("dx_QxNg"),D=r("dx_PQBD"),A=r("dx_B28d"),P=r("dx_WXfY"),L=r("dx_ZG9w"),N=r("dx_EqZO"),F=r("dx_D8nn"),U=r("dx_S5Se"),H=r("dx_fCRr"),V=r("dx_eyH3"),W=r("dx_XlRC"),z=r("dx_ey54");function G(e,n){var r=n.ops.filter(j.X).map((function(e){return e.action.li})).sort((function(n,r){var o=e.getBlockModelsByRecordId(n)[0],i=e.getBlockModelsByRecordId(r)[0];return o?i?o.position-i.position:-1:1})),o=r.filter((function(n){return e.recordManager.hasRecord(n)&&e.getRecord(n).snapshot.type.includes("heading")})),i=o.map((function(n){return e.getBlockIdsByRecordId(n)[0]})).filter(Boolean);return{recordIds:r,orderedRecordIds:o,orderedBlockIds:i}}function K(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function q(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?K(Object(r),!0).forEach((function(n){E()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function X(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Y(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Y(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function J(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}var Z=function(e){f()(r,e);var n=J(r);function r(e){var o;return l()(this,r),(o=n.call(this,e)).blockTypes=w()(A.O),o.containerType=w()(_.J),o.headingMap=new Map,o.containerList=[],o.calcOrder=function(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=w()(r),c=w()(i),a=w()(i),l=!1,s=X(e);try{for(s.s();!(n=s.n()).done;){var u=n.value,d=o.getOrderLevelMap(u);if(d){i=w()(c),l=!1;var f,h=X(u);try{for(h.s();!(f=h.n()).done;){var p=f.value,v=Object(D.V)(p.blockType);if(v){"auto"!==p.seqLevel&&(l=!0),p.isDeleted||(i=l?w()(a):w()(c));var g=d.get(v);if(g){if(i.length===g)i[g-1]++;else if(i.length<g)for(var b=i.length;b<g;b++)i.push(1);else{for(var y=i.length,m=g;m<y;m++)i.pop();i[g-1]++}"auto"!==p.seq&&(i[g-1]=parseInt(p.seq.toString(),10));var k=o.orderMap.get(p.recordId);if(!k||k.join(",")!==i.join(",")){o.updateOrder(p.recordId,w()(i));var O=o.blockManager.getBlockIdsByRecordId(p.recordId)[0];if(O){var x=o.blockManager.getBlockModelByBlockId(O);o.blockManager.dispatch(_.t.FORCE_UPDATE,x)}}p.isDeleted||(l?a=w()(i):c=w()(i))}}}}catch(E){h.e(E)}finally{h.f()}}}}catch(E){s.e(E)}finally{s.f()}},o.handleInsert=function(e){o.match(e)&&(o.renumber(e,!0),o.asyncUpdateView())},o.handleRemove=function(){var e=B()(C.a.mark((function e(n,r){var i,c,a,l,s=arguments;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=!(s.length>2&&void 0!==s[2])||s[2],c=r?Object(D.V)(r):Object(D.V)(n.type),a=o.orderMap.get(n.record.id),o.orderMap.delete(n.record.id),o.pendingSet.add(n.record.id),o.asyncUpdateView(),l=o.getSiblingBlockModels(n)[0],setTimeout((function(){if(a&&l&&i){var e="auto",r=a[a.length-1],s=o.hasParent(n),u=o.getSiblingBlockModels(n,_.R.UP),d=u[0]?o.orderMap.get(u[0].record.id):"auto";if(d&&"auto"!==d){var f=d[d.length-1];e=f===r-1?"auto":r}var h=s&&1===a.length?"1":"auto";"auto"!==e&&o.blockManager.applyTransaction("heading:remove:modifySeq",(function(n){n.replace(l.recordId,["seq"],e.toString()),n.replace(l.recordId,["seq_level"],h)}),{mergeMode:j.f.MERGE})}c&&o.renumber(n,!0,c)}));case 8:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),o.handleEditorMount=function(){o.env===V.l.HISTORY&&o.handleDataReady()},o.handleDataReady=function(){if(o.isDataReady=!0,0!==o.containerList.length){var e,n=X(o.containerList);try{for(n.s();!(e=n.n()).done;){var r=e.value,i=o.blockManager.getBlockIdsByRecordId(r)[0],c=o.blockManager.getBlockModelByBlockId(i);c&&o.initHeadingOrder(c)}}catch(a){n.e(a)}finally{n.f()}}else o.asyncUpdateView()},o.init(),o.blockManager.addListener(z.H,o.handleEditorMount),o.eventEmitter.on(N.R.CLIENTVAR_APPLY_ALL_DONE,o.handleDataReady),o}return u()(r,[{key:"destroy",value:function(){M()(g()(r.prototype),"destroy",this).call(this),this.blockManager.removeListener(z.H,this.handleEditorMount),this.eventEmitter.off(N.R.CLIENTVAR_APPLY_ALL_DONE,this.handleDataReady)}},{key:"hasOrderedHeading",value:function(){return Array.from(this.headingMap).some((function(e){var n=c()(e,2);n[0];return n[1].some((function(e){return e.size>0}))}))}},{key:"getOrderText",value:function(e){var n=this.getOrder(e);return n?1===n.length?"".concat(n[0],"."):n.join("."):null}},{key:"getHeadingText",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2?arguments[2]:void 0,i=this.blockManager.getBlockIdsByRecordId(e)[0],c=this.getOrderText(e),a=c?"".concat(c," "):"";if(r){var l=this.blockManager.getBlockModelByBlockIdNotCheck(i);if(l&&Object(L.i)(l)){var s=l.zoneState.getContent().ops.map((function(e){return q(q({},e),{},{text:e.insert.replace(/\n/g," \n")})})),u=s.map((function(e){return Object(P.S)(e,n.blockManager.recordManager,!0)}));return"".concat(a).concat(u.join(""))}}var d="";if(o)d=Object(P.X)(o.snapshot,this.blockManager.recordManager);else{var f=this.blockManager.getBlockModelByBlockId(i);d=Object(P.X)(f.record.snapshot,this.blockManager.recordManager)}return"".concat(a).concat(d.trim())}},{key:"getMarkdownAfterInsertInfo",value:function(e,n){var r=parseInt(n[n.length-2],10),o=n.length-1,i=this.getInsertPosition(e,r),c=i.position,a=i.seq,l=i.seqLevel,s=this.blockManager.getBlockModelByBlockId(e),u=Object(D.V)(s.type),d=this.hasParent(s),f="auto",h="auto";return"top"===c?1===o?(f=r,h=1!==u&&d?1:"auto"):(f=r,h="auto"):"bottom"===c?1===r?(f=r,h=1===o&&1!==u&&d?1:"auto"):(f="auto",h="auto"):"merge"===c?(f=a||"auto",h=l||"auto"):1===r?(f=r,h=1===o&&1!==u&&d?1:"auto"):(f="auto",h="auto"),{seq:f,seqLevel:h}}},{key:"getInsertPosition",value:function(e,n){var r=this.blockManager.getBlockModelByBlockId(e),o=this.getSiblingBlockModels(r,_.R.DOWN),i=this.getSiblingBlockModels(r,_.R.UP),c={position:"top"};if(0===i.length&&0===o.length)c.position="top";else if(i.length>0&&0===o.length)c.position="bottom";else if(0===i.length&&o.length>0)c.position="top";else{var a=o[0],l=a.record.get(["seq"]),s=a.record.get(["seq_level"])||"auto";"auto"!==l?l-1===n?(c.position="merge",c.seq=l-1,c.seqLevel=s):c.position="bottom":c.position="between"}return c}},{key:"hasParent",value:function(e){var n=this.findClosestHeading(e,_.R.DOWN),r=this.findClosestHeading(e,_.R.UP);return n.parent||r.parent}},{key:"hasSameHeading",value:function(e,n){var r=this.blockManager.getBlockModelByBlockId(e),o=Object(D.V)(r.type);if(!o)return!1;for(var i=this.getIterator(r,n),c=i.next();c;)if(c){var a=Object(D.V)(c.type)||Object(D.V)(c.record.snapshot.type);if(!a){c=i.next();continue}if(o===a)return c;if(o>a)return!1;c=i.next()}else c=i.next();return!1}},{key:"getSiblingBlockModels",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_.R.DOWN,r=Object(D.V)(e.type),o=this.getContainer(e);if(!r)return[];var i=this.getIterator(e,n),c=i.next();if(c&&Object(D.V)(c.type)===r&&this.getContainer(c)===o)return[c];for(;c;){if(c){var a=Object(D.V)(c.type);if(this.getContainer(c)!==o)return[];if(!a){c=i.next();continue}if(a>r){c=i.next();continue}return a===r?[c]:[]}c=i.next()}return[]}},{key:"match",value:function(e){var n=e.record.get(["seq"]);return(this.matchType(e.type)||this.matchType(e.record.snapshot.type))&&this.isValidSeq(n)}},{key:"matchType",value:function(e){return"string"===typeof e&&A.O.includes(e)}},{key:"forceUpdate",value:function(e){var n,r=this.blockManager.getBlockIdsByRecordId(e)[0];this.blockManager.dispatch(_.t.FORCE_UPDATE,{},r),this.layoutManager.notifyNodeHeightChange(r);var o=null===(n=this.selectionAPI)||void 0===n?void 0:n.getSelection();(null===o||void 0===o?void 0:o.some((function(e){return e.id===r})))&&F.s.emit(F.p.TOOLBAR.UPDATE_DOC_TOOL_BAR)}},{key:"getOrderLevelMap",value:function(e){for(var n=new Map,r=e[0].seqLevel,o=[],i="auto"===r?1:r,c=0;c<9;c++)o.push(new Set);var a,l=X(e);try{for(l.s();!(a=l.n()).done;){var s=a.value,u=Object(D.V)(s.blockType);o&&u&&o[u-1].add(s.recordId)}}catch(p){l.e(p)}finally{l.f()}for(var d=0,f=i;d<o.length;d++){var h=d+1;o[d].size>0&&(n.set(h,f),f++)}return n.size>0?n:null}},{key:"getContainer",value:function(e){for(var n=e.parent;n;){if(_.J.includes(n.type))return n;n=n.parent}return this.blockManager.getBlockModelByBlockId(this.blockManager.rootBlockId)}},{key:"getIterator",value:function(e,n){var r=this,o=this.getContainer(e),i=e,c=function(){if(n===_.R.DOWN){for(;i&&_.J.includes(i.type);){for(;i&&i.children.length>0;)i=i.children[i.children.length-1];i=i.next}i&&r.getContainer(i)!==o&&(i=null)}else if(n===_.R.UP)for(;i&&r.getContainer(i)!==o;)i=r.getContainer(i).previous},a=function(){for(;i&&(n===_.R.DOWN?i&&_.J.includes(i.type)?c():i=i.next:n===_.R.UP&&(i=i.previous,c()),i&&!r.match(i)););return i};return{latest:function(){return!i||r.match(i)?i:a()},next:a}}},{key:"findClosestHeading",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_.R.UP,r=arguments.length>2?arguments[2]:void 0,o={closest:null,parent:null},i=void 0===r?Object(D.V)(e.type):r;if(null==i)return o;var c=this.getIterator(e,n);o.closest=c.next();for(var a=o.closest;a;){var l=Object(D.V)(a.type);if(!l||1===l&&1===i)return o;if(l<i)return o.parent=a,o;a=c.next()}return o}},{key:"collectHeadings",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_.R.DOWN,r=arguments.length>2?arguments[2]:void 0,o=[],i=void 0===r?Object(D.V)(e.type):r;if(null==i)return[];for(var c=this.getIterator(e,n),a=c.latest();a;){var l=Object(D.V)(a.type);if(!l)return o;if(!(l>i&&this.getContainer(a)===this.getContainer(e)))return o;o.push({recordId:a.record.id,blockType:a.type,seq:a.record.get(["seq"]),seqLevel:a.record.get(["seq_level"])||"auto",isDeleted:Object(W.J)(a)}),a=c.next()}return o}},{key:"initHeadingOrder",value:function(e){var n=e.children[0];if(n){var r=this.collectHeadings(n,_.R.DOWN,0),o=this.calHeadingQueue(r);this.calcOrder(o)}}},{key:"batchUpdateContainer",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=new Map;n.forEach((function(n){var o=e.blockManager.getBlockModelsByRecordId(n)[0],i=e.getContainer(o);void 0===r.get(i.recordId)&&r.set(i.recordId,o)}));var o,i=X(r.values());try{for(i.s();!(o=i.n()).done;){var c=o.value;this.renumber(c,!0)}}catch(a){i.e(a)}finally{i.f()}}},{key:"renumber",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,o=this.getContainer(e);if(n)return this.initHeadingOrder(o);var i=this.findClosestHeading(e,_.R.UP,r),c=i.closest,a=i.parent,l=a?Object(D.V)(a.type):0,s=c?this.orderMap.get(c.record.id):[],u=this.collectHeadings(e,_.R.DOWN,l||0),d=this.calHeadingQueue(u);this.calcOrder(d,s)}},{key:"initContainer",value:function(e){this.containerList.includes(e)||this.containerList.push(e)}},{key:"calHeadingQueue",value:function(e){var n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=[],i=0,c=X(e);try{for(c.s();!(n=c.n()).done;){var a=n.value,l=a.seqLevel,s=a.blockType,u=a.seq,d=Object(D.V)(s)||0;if("auto"!==l||0===o.length||r&&"auto"!==u)o.push([a]),i=o.length-1;else for(var f=i;f>=0;f--){var h=o[f][0],p=Object(D.V)(h.blockType)||0;if(!h.isDeleted||a.isDeleted){if(d>=p||d<p&&"auto"===h.seqLevel){if(d===p&&"auto"!==h.seqLevel&&"auto"!==u){if(0===f){o.push([a]),i=o.length-1;break}continue}o[f].push(a),i=f;break}0===f&&(o.push([a]),i=o.length-1)}else if(0===f){o.push([a]),i=o.length-1;break}}}}catch(v){c.e(v)}finally{c.f()}return o}},{key:"batchModifySeqIfNecessary",value:function(){var e=B()(C.a.mark((function e(n){var r,o,i,c,a,l,s,u,d,f,h,p,v,g,b,y,m,k,O,x,E,S,I=this;return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=[],o=n.recordOpsType,i=n.recordOps,c=n.targetRecordOpTypes,a=n.targetRecordOps,l=Object(U.JQ)(i,c),s=l.insertRecordOps,e.t0=o,e.next=e.t0===H.l.MARKDOWN?6:e.t0===H.l.PASTE||e.t0===H.l.MOVE?19:e.t0===H.l.INSERT?39:43;break;case 6:if(u=this.blockManager.getBlockModelsByRecordId(i[0].id)[0],d=this.getSiblingBlockModels(u),f=this.getSiblingBlockModels(u,_.R.UP),!(d.length>0&&f.length>0)){e.next=15;break}if(h=d[0],"auto"===(p=h.record.get(["seq"]))||p-1===parseInt(u.record.get(["seq"]),10)){e.next=15;break}return this.handleInsert(u),e.abrupt("break",44);case 15:return e.next=17,this.blockManager.applyTransaction("heading:".concat(o,":modifySeq"),(function(e){d.forEach((function(n){e.replace(n.recordId,["seq"],"auto"),e.replace(n.recordId,["seq_level"],"auto")}))}),{mergeMode:j.f.MERGE});case 17:return this.handleInsert(u),e.abrupt("break",44);case 19:if(v=new Set,!(s.length>0||o===H.l.MOVE&&a.length>0)){e.next=38;break}if((o===H.l.MOVE?a:s).forEach((function(e){G(I.blockManager,e).recordIds.forEach((function(e){v.add(e)}))})),0!==(r=w()(v).filter((function(e){return I.match(I.blockManager.getBlockModelsByRecordId(e)[0])}))).length){e.next=28;break}if(o!==H.l.MOVE){e.next=28;break}return v.forEach((function(e){var n=I.blockManager.getBlockModelsByRecordId(e)[0];_.J.includes(n.type)&&I.initHeadingOrder(n)})),e.abrupt("break",44);case 28:o===H.l.PASTE&&a.forEach((function(e){e.ops.forEach((function(e){var n,o=null===e||void 0===e||null===(n=e.action)||void 0===n?void 0:n.oi;o&&o.children&&o.children.forEach((function(e){if(I.blockManager.recordManager.hasRecord(e)){var n=I.blockManager.getBlockModelsByRecordId(e)[0];I.match(n)&&r.push(e)}}))}))})),g=this.blockManager.getBlockModelsByRecordId(r[0])[0],b=this.blockManager.getBlockModelsByRecordId(r[r.length-1])[0],y=g.record.get(["seq"]),m=this.getSiblingBlockModels(b,_.R.DOWN),k=m[0]&&m[0].record.get(["seq"]),O=m[0]&&m[0].record.get(["seq_level"]),x=this.getSiblingBlockModels(g,_.R.UP),m.length>0&&x.length>0&&"auto"!==k?1===r.length?"auto"!==y&&parseInt(y,10)+1===parseInt(k,10)?setTimeout(B()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.blockManager.applyTransaction("heading:".concat(o,":modifySeq"),(function(e){e.replace(g.recordId,["seq_level"],O?O.toString():"auto"),e.replace(m[0].recordId,["seq"],"auto"),e.replace(m[0].recordId,["seq_level"],"auto")}),{mergeMode:j.f.MERGE});case 2:case"end":return e.stop()}}),e)})))):setTimeout(B()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.blockManager.applyTransaction("heading:".concat(o,":modifySeq"),(function(e){e.replace(g.recordId,["seq_level"],"auto"),e.replace(g.recordId,["seq"],"auto")}),{mergeMode:j.f.MERGE});case 2:case"end":return e.stop()}}),e)})))):(E=r.map((function(e){var n=I.blockManager.getBlockModelsByRecordId(e)[0];return{recordId:n.record.id,blockType:n.type,seq:n.record.get(["seq"]),seqLevel:n.record.get(["seq_level"])||"auto",isDeleted:Object(W.J)(n)}})),(S=this.calHeadingQueue(E,!0)).length>=1&&setTimeout(B()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.blockManager.applyTransaction("heading:".concat(o,":modifySeq"),(function(e){if(S[0].forEach((function(n){e.replace(n.recordId,["seq"],"auto"),e.replace(n.recordId,["seq_level"],"auto")})),S.length-1!==0){var n=S[S.length-1];e.replace(n[0].recordId,["seq"],"1"),e.replace(n[0].recordId,["seq_level"],"auto"),e.replace(m[0].recordId,["seq"],"auto"),e.replace(m[0].recordId,["seq_level"],"auto")}}),{mergeMode:j.f.MERGE});case 2:case"end":return e.stop()}}),e)}))))):r.length>0&&setTimeout(B()(C.a.mark((function e(){return C.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.blockManager.applyTransaction("heading:".concat(o,":modifySeq"),(function(e){for(var n=0;n<r.length;n++){var o=I.blockManager.getBlockModelsByRecordId(r[n])[0];0===n&&e.replace(r[n],["seq"],"auto"),o.record.get(["seq_level"])?0===n&&e.replace(r[n],["seq_level"],"auto"):e.insert(r[n],["seq_level"],"auto")}}),{mergeMode:j.f.MERGE});case 2:case"end":return e.stop()}}),e)})))),this.batchUpdateContainer(r);case 38:return e.abrupt("break",44);case 39:return s.forEach((function(e){var n;(n=r).push.apply(n,w()(G(I.blockManager,e).recordIds))})),r=r.filter((function(e){var n=I.blockManager.getBlockModelsByRecordId(e)[0];if(n&&n.children.length>0){if(_.J.includes(n.type))I.initHeadingOrder(n);else{var r=n.parent;r&&I.initHeadingOrder(r)}return!1}return n&&I.match(n)})),this.batchUpdateContainer(r),e.abrupt("break",44);case 43:return e.abrupt("break",44);case 44:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"dataReady",get:function(){return this.isDataReady}}]),r}(V.S),Q=Z,$=function(){return Object(o.getMinaConfig)("ccm.docx.heading_auto_num_enable",!1)}},dx_e8ez:function(e,n,r){"use strict";(function(t){r.d(n,"l",(function(){return w})),r.d(n,"x",(function(){return R})),r.d(n,"E",(function(){return M})),r.d(n,"G",(function(){return j})),r.d(n,"j",(function(){return D})),r.d(n,"qC",(function(){return A})),r.d(n,"d",(function(){return P})),r.d(n,"q",(function(){return N})),r.d(n,"Y",(function(){return F})),r.d(n,"I",(function(){return H})),r.d(n,"U",(function(){return W})),r.d(n,"w",(function(){return G}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_J4zp"),l=r.n(a),s=r("dx_QxNg"),u=r("dx_UtDZ"),d=r("dx_YzVl"),f=r("dx_MoY1"),h=r("dx_yzqx"),p=r("dx_jBAU"),v=r("dx_PFuV"),g=r("dx_Bv2G"),b=r("dx_ExiS"),y=r("dx_tP01"),m=r("dx_B28d"),_=r("dx_FHaN"),k=r("dx_ZG9w"),O=r("dx_UTG8"),x=r("dx_md5I"),E=(r("dx_NsKf"),r("dx_USRY")),S=r("dx_WAOj"),C=r("dx_c7yg"),I=r("dx_O5Om"),B=r("dx_PhLz"),T=r("dx_KXll");function w(e){if(Object(b.R)(e)){var n=v.s.get(e.code);return n&&Object(d.F)({type:"error",content:n}),!0}return!1}function R(e){var n=e.size,r=e.type,o=e.name;return Object(B.E)({file:{token:C.v,mimeType:r,size:n,name:o}})}function M(e,n,r,o){var i=n.file,c=i.name,a=i.size,s=Object(T.u)(c,a),u=Object(S.m)(s),d=Object(f.l)(e,r,o,[u]),h=l()(d,1)[0],p=Object(f.l)(e,h,0,[n]);return[h,l()(p,1)[0]]}function j(e,n,r){var o=[],i=[];return r.forEach((function(r){if(r.type===m.B.FILE){var c=r.file,a=c.name,l=c.size,s=Object(T.u)(a,l),u=Object(S.m)(s),d=Object(f.s)(e,n,u),h=Object(f.s)(e,d,r);e.replaceChildren(d,[h]),o.push(d),i.push(h)}else{var p=Object(f.s)(e,n,r);o.push(p),i.push(p)}})),{childrenRecordIds:o,placeholderRecordIds:i}}function D(e,n){I.w.setState(e,{progress:Math.floor(100*n)})}function A(e,n){var r=n.getRecord(e).snapshot.type;r!==m.B.VIEW?r===m.B.FILE&&I.w.setState(e,{fromSelf:!0}):A(n.getBlockModelsByRecordId(e)[0].recordId,n)}function P(e,n){e&&I.w.setStartCopying(e)}function L(e,n){e&&I.w.setEndCopying(e)}function N(e,n,r){n.forEach((function(n,o){n.type===m.B.FILE&&A(e[o],r)}))}function F(e,n,r){return U.apply(this,arguments)}function U(){return(U=c()(o.a.mark((function e(n,r,i){var c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=i.getRecord(r),null===a||void 0===a||null===(c=a.snapshot)||void 0===c?void 0:c.file){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,i.applyTransaction("updateFileBlockToken",(function(e){e.replace(a.id,["file","token"],n)}),{from:s.H.local,undoable:!1});case 6:I.w.deleteState(a.id);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e,n){return V.apply(this,arguments)}function V(){return(V=c()(o.a.mark((function e(n,r){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.applyTransaction("removeFileBlockByRecordId",(function(e){var o=r.getBlockModelsByRecordId(n)[0],i=null===o||void 0===o?void 0:o.parent;if(o&&i){var c=i.record.snapshot.type,a=r.getBlockViewsByRecordId(n),s=l()(a,1)[0];if((null===s||void 0===s?void 0:s.props.displaymode)===E.t.Inline&&Object(k.i)(i)){var u=r.getBlockViewByBlockIdNotCheck(i.id);if(!u)return void console.info("[FileBlock] removeFileBlockByRecordId: remove inline-file failed, parent TextBlock can not be found");var d=Object(x.N)(u.editor,{inlineblock:o.record.id}),h=i.zoneState.remove(d).toAttributeText();e.replace(i.record.id,["text"],h)}else c===m.B.VIEW?Object(f.y)(e,[i.id],r):Object(f.y)(e,[o.id],r)}}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(e,n,r,o){return z.apply(this,arguments)}function z(){return(z=c()(o.a.mark((function e(n,r,i,c){var a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n){e.next=3;break}throw new Error("no file token.");case 3:return e.next=5,q(n,r,i);case 5:a=e.sent,i.applyTransaction("updateFileBlockToken",(function(e){e.replace(r,["file","token"],a)}),{undoable:!1}),e.next=22;break;case 9:if(e.prev=9,e.t0=e.catch(0),console.info("[FileBlock] updateFileMountPoint error: ".concat(e.t0,", oldToken=").concat(n,", newRecordId=").concat(r)),H(r,i),!w(e.t0)){e.next=15;break}return e.abrupt("return");case 15:if(e.t0.code!==g.g.USER_NO_DRIVE&&e.t0.code!==g.g.USER_DRIVE||h.S.isMobile){e.next=18;break}return u.showUserLimitDialog&&Object(u.showUserLimitDialog)(g.O.FILE),e.abrupt("return");case 18:if(e.t0.code!==g.g.SPACE||h.S.isMobile){e.next=21;break}return u.showPicLimitDialog&&Object(u.showPicLimitDialog)("storage-space",{type:"upload-file"}),e.abrupt("return");case 21:Object(d.F)({type:"error",content:t("block.failed_to_paste_block")});case 22:return e.prev=22,c&&c(),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[0,9,22,25]])})))).apply(this,arguments)}function G(e,n,r){return K.apply(this,arguments)}function K(){return(K=c()(o.a.mark((function e(n,r,i){var c,a,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.data.source_block_id){e.next=2;break}return e.abrupt("return");case 2:return c=n.data,a=c.source_block_id,e.prev=4,e.next=7,q(c.token,a,i);case 7:l=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),w(e.t0);case 13:if(l){e.next=15;break}return e.abrupt("return");case 15:return e.next=17,i.applyTransaction("updateInlineFileComponentAfter",(function(e){e.replace(a,["file","token"],l);var o=i.getBlockModelsByRecordId(r)[0],c=O.InputPipe.serialize(o.record.snapshot.text);c.nodes.forEach((function(e){var r;if(null===(r=e.mark)||void 0===r?void 0:r[_.O]){var o,c=JSON.parse(e.mark[_.O]);if(c.id===n.id)c.data.need_copy_resource=!1,c.data.source_block_id=a,c.data.source_version=(null===(o=i.recordManager.collabModule)||void 0===o?void 0:o.getVersion(a))||C.j,c.data.token=l,e.mark[_.O]=JSON.stringify(c)}})),e.replace(r,[m.B.TEXT],O.InputPipe.deserialize(c))}),{undoable:!1});case 17:L(a),I.w.deleteState(a);case 19:case"end":return e.stop()}}),e,null,[[4,10]])})))).apply(this,arguments)}function q(e,n,r){return X.apply(this,arguments)}function X(){return(X=c()(o.a.mark((function e(n,r,i){var c,a,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}throw new Error("copy to fail, no old token.");case 2:return a=Object(y.m)(i),e.next=5,p.S.resourceCopyTo([n],r,g.O.FILE,a);case 5:if((l=e.sent).code===p.F.SUCCESSFUL){e.next=8;break}throw new Error("copy to request fail.");case 8:return e.abrupt("return",null===l||void 0===l||null===(c=l.data)||void 0===c?void 0:c.succ_files[n]);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}).call(this,r("dx_E9Eu"))},dx_eGDr:function(e,n,r){"use strict";r.d(n,"T",(function(){return d})),r.d(n,"s",(function(){return f})),r.d(n,"z",(function(){return h})),r.d(n,"I",(function(){return p})),r.d(n,"K",(function(){return v})),r.d(n,"Zz",(function(){return g})),r.d(n,"i7",(function(){return b})),r.d(n,"l4",(function(){return y})),r.d(n,"i",(function(){return O})),r.d(n,"D",(function(){return x})),r.d(n,"Z",(function(){return E})),r.d(n,"M",(function(){return m})),r.d(n,"Fr",(function(){return _})),r.d(n,"l",(function(){return k})),r.d(n,"r",(function(){return S})),r.d(n,"F",(function(){return C}));var o,i=r("dx_lSNA"),c=r.n(i),a=r("dx_yNB7"),l=r("dx_yzqx"),s=r("dx_B28d"),u=r("dx_IdzY"),d=18,f=l.S.isMobile?20:22,h=26,p=26,v=d+3,g="comment-id-",b=a.l+g,y="".concat(u.I,"comment-hl");!function(e){e.COMMENT_NUMBER_CLICK="COMMENT_NUMBER_CLICK"}(o||(o={}));var m,_,k,O=c()({},s.B.BITABLE,{top:52}),x=c()({},s.B.BITABLE,{top:13}),E="docx-comment-container-inner";c()({},s.B.BITABLE,{visible:!1});!function(e){e.feed="feed",e.panel="panel",e.interaction="interaction",e.numbers="numbers",e.url="url",e.newComment="new_comment",e.thirdParty="third_party",e.noticeCenter="notice_center",e.vc="vc",e.findReplace="findReplace"}(m||(m={})),function(e){e.afterResolve="AfterResolve",e.interaction="Interaction",e.feedClosePanel="FeedClosePanel",e.selectedBlockHasNoComment="SelectedBlockHasNoComment",e.thirdParty="ThirdParty",e.blockTurnInto="BlockTurnInto",e.hasNoSelectedBlock="HasNoSelectedBlock",e.selectionOutOfComment="SelectionOutOfComment",e.afterLocateToBlock="AfterLocateToBlock"}(_||(_={})),function(e){e.triggerStartNewComment="trigger_start_new_comment",e.startNewComment="start_new_comment",e.exception="exception",e.addLocalCommentMark="add_local_comment_mark",e.removeLocalCommentMark="remove_local_comment_mark",e.cancelAddComment="cancel_add_comment",e.afterAddComment="after_add_comment",e.doReplaceTempComment="do_replace_temp_comment",e.commentChange="comment_change",e.afterDeleteComment="after_delete_comment",e.activateComment="activate_comment",e.deactivateComment="deactivate_comment",e.activeCommentChange="activeCommentChange",e.flushActiveCommentChange="flushActiveCommentChange",e.resolveComment="resolve_comment",e.reopenComment="reopen_comment",e.commentDataReady="comment_data_ready",e.hoverCommentChange="hover_comment_change",e.commentThirdParty="comment_third_party",e.commentUpdateRelation="comment_update_relation",e.commentPositionUpdate="comment_position_update",e.urlJump="url_jump",e.showCommentPanel="show_comment_panel",e.feedJump="feed_jump",e.blockManagerReady="block_manager_ready",e.handleViewportLocked="handle_viewport_locked",e.lockViewport="lock_viewport"}(k||(k={}));var S=l.S.isMobile&&!l.S.isBytedanceApp||l.S.isOpendoc&&l.S.isMobile,C="spacekit.mobile.comment_add_optimize"},dx_eNHK:function(e,n,r){"use strict";(function(t){r.d(n,"R",(function(){return j}));var e=r("dx_VkAN"),o=r.n(e),i=r("dx_lSNA"),c=r.n(i),a=r("dx_o0o1"),l=r.n(a),s=r("dx_yXPU"),u=r.n(s),d=r("dx_J4zp"),f=r.n(d),h=r("dx_QILm"),p=r.n(h),v=r("dx_vF1F"),g=r("dx_aSlK"),b=r("dx_RG4b"),y=r("dx_PcQO"),m=r("dx_cDcd"),_=r.n(m),k=r("dx_bdgK"),O=r("dx_yzqx"),x=r("dx_TfZh"),E=r("dx_D8nn"),S=r("dx_ZeFe"),C=r("dx_Qz0W"),I=r("dx_lUPZ"),B=r("dx_QbWy");r("dx_vpSr");function T(){var e=o()(["\n                  content: '';\n                  opacity: ",";\n                  position: absolute;\n                  left: 0;\n                  right: 0;\n                  bottom: 0;\n                  height: ","px;\n                  transition: opacity 150ms ease;\n                  pointer-events: none;\n                "]);return T=function(){return e},e}function w(){var e=o()(["\n            flex: 1 1;\n            position: relative;\n            /* transition: height 150ms ease; */\n            overflow: hidden;\n\n            display: grid;\n            grid-template-columns: repeat(auto-fill, ","px);\n            gap: ","px;\n          "]);return w=function(){return e},e}function R(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function M(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?R(Object(r),!0).forEach((function(n){c()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var j=_.a.memo((function(e){var n=e.votes,r=void 0===n?[]:n,o=e.total,i=void 0===o?0:o,c=e.onFetchVotes,a=e.renderVote,s=e.style,d=p()(e,["votes","total","onFetchVotes","renderVote","style"]),h=Object(m.useRef)(null),R=Object(m.useRef)(1),j=Object(m.useState)(!0),D=f()(j,2),A=D[0],P=D[1],L=Object(m.useState)(!0),N=f()(L,2),F=N[0],U=N[1],H=Object(m.useState)(0),V=f()(H,2),W=V[0],z=V[1],G=Object(m.useState)(0),K=f()(G,2),q=K[0],X=K[1],Y=Object(m.useMemo)((function(){var e=Math.max(0,i-r.length);return new Array(e).fill(0)}),[i,r]),J=Object(m.useCallback)((function(){var e=Math.floor(W/B.A)||1,n=e>1?Math.ceil(i/e):0,o=0;if(F){var c=e>1?Math.ceil(r.length/e):0;o=Math.min(c,3)}else o=n;var a=n>3,l=Math.max(0,o*B.A-B.O);R.current=e,P(a),X(l)}),[r,i,F,W]),Z=Object(x.S)((function(){if(h.current){var e=h.current.scrollWidth+B.O;z(e),E.S.emit(S.o)}}),100),Q=Object(m.useRef)(new k.S(Z));Object(m.useLayoutEffect)((function(){J()}),[J]),Object(m.useEffect)((function(){var e=h.current,n=Q.current;return e&&n.observe(e),function(){e&&n.unobserve(e)}}),[]);var $=Object(m.useCallback)(u()(l.a.mark((function e(){var n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.length){e.next=2;break}return e.abrupt("return");case 2:if(n=Math.ceil(i/R.current),o=Math.ceil(r.length/R.current),!(n>o)){e.next=7;break}return e.next=7,null===c||void 0===c?void 0:c();case 7:case"end":return e.stop()}}),e)}))),[i,r,c]);Object(m.useEffect)((function(){var e=F;r.length||(e=!0),U(e),r.length&&!e&&$()}),[r]);var ee=Object(m.useCallback)((function(e){e.stopPropagation(),F?(U(!1),$()):U(!0)}),[F,$]);return _.a.createElement("div",Object.assign({style:M({display:"flex",position:"relative"},s)},d),_.a.createElement("div",{ref:h,className:Object(v.Z)(w(),B.h8,B.O),style:{height:q}},r.map((function(e){return _.a.createElement("div",{key:e.userId,style:{width:B.h8,height:B.h8}},a(e))})),Y.map((function(e,n){return _.a.createElement(C.J,{key:"fake-fill-vote-".concat(n)})})),r.length>0&&A&&_.a.createElement("div",{className:Object(v.u)("poll-option-vote-collapse-shadow",Object(v.Z)(T(),F?1:0,3*B.A-B.O))})),_.a.createElement("div",{style:{width:32,marginLeft:6,display:"flex",justifyContent:"center",alignItems:"start"}},r.length>0&&A&&_.a.createElement(y.Tooltip,Object.assign({title:t(F?"doc.toggle.expand":"doc.toggle.collapse")},O.S.isMobile?{visible:!1}:{}),_.a.createElement(I.W,{style:{width:20,height:20},onClick:ee,icon:F?_.a.createElement(g.S,{style:{fontSize:16}}):_.a.createElement(b.S,{style:{fontSize:16}})}))))}))}).call(this,r("dx_E9Eu"))},dx_eSAc:function(e,n,r){},dx_eYtq:function(e,n,r){},dx_eqfA:function(e,n,r){"use strict";r.d(n,"q",(function(){return ee}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_Uyc2"),b=r.n(g),y=r("dx_QxNg"),m=r("dx_LcNA"),_=r("dx_hB37"),k=r("dx_N8Nu"),O=r("dx_NOtv"),x=r.n(O),E=r("dx_ZG9w"),S=r("dx_UhQm"),C=r("dx_D8nn"),I=r("dx_awlV"),B=r("dx_D0JG"),T=r("dx_bPy9");var w,R=function(e,n,r){if(!r||"function"!==typeof r.value)throw new TypeError("Only methods can be decorated with @Bind. <".concat(n,"> is not a method!"));return{configurable:!0,get:function(){var e=r.value.bind(this);return e.plugin=this,Object.defineProperty(this,n,{value:e,configurable:!0,writable:!0}),e}}},M=["\u3002",".","\uff1f","?","\uff01","!"],j=[",",".","?",":",";","'","!"],D=new RegExp("[".concat(M.map((function(e){return"\\".concat(e)})).join(""),"]\\s+"),"g"),A=new RegExp("^[a-z][a-z'-]*[".concat(j.map((function(e){return"\\".concat(e)})).join(""),"]?$")),P=["link","inlineCode"],L=[I.G.UP,I.G.DOWN,I.G.LEFT,I.G.RIGHT,I.G.PAGE_UP,I.G.PAGE_DOWN,I.G.HOME,I.G.END],N=["deleteForward","deleteBackward","deleteToLineStart","deleteToLineEnd","deleteEntireWordBackward","deleteEntireWordForward","deleteRange"],F=[I.G.CONTROL,I.G.ALT,I.G.LEFT_WINDOW_KEY,I.G.RIGHT_WINDOW_KEY,I.G.SHIFT],U=r("dx_qx8A"),H=r.n(U),V=r("dx_Fimk");!function(e){e[e.DISABLE=0]="DISABLE",e[e.ENABLE=1]="ENABLE"}(w||(w={}));var W,z,G=x()("AutoCapitalization:global"),K=new(function(){function e(){var n=this;a()(this,e),this.enabled=!1,this.deleteWordInfo=null,this.handleStoreStateChange=function(){n.setEnabled(H.a.getState().appState.userSettings.get("enable_auto_capitalize")===w.ENABLE)},this.getEnabled=function(){return n.enabled},H.a.subscribe(this.handleStoreStateChange)}return s()(e,[{key:"setEnabled",value:function(e){this.enabled!==e&&(this.enabled=e,G("set enabled: ",e))}}]),e}());function q(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function X(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?q(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Y(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var J=x()("AutoCapitalization:normal"),Z=x()("AutoCapitalization:trace"),Q=(z=function(e){d()(r,e);var n=Y(r);function r(e){var o;a()(this,r),(o=n.call(this)).name="AutoCapitalization",o.editor=void 0,o.enabled=void 0,o._shouldCapitalizeIfNecessary=!0,o.tmpShouldCapitalizeIfNecessary=!0,o._prevSelection=null,o._prevActiveZone=null;var i=e.editor,c=e.enabled;return o.editor=i,o.enabled=c,o.log("init enabled: ".concat(o.enabled(),", shouldCapitalizeIfNecessary: ").concat(o.shouldCapitalizeIfNecessary)),o.bindEvents(!0),o}return s()(r,[{key:"shouldCapitalizeIfNecessary",get:function(){return this._shouldCapitalizeIfNecessary},set:function(e){this._shouldCapitalizeIfNecessary=e,Z.enabled&&console.trace("[AutoCapitalization] setter: ",e)}}]),s()(r,[{key:"destroy",value:function(){this.bindEvents(!1)}},{key:"bindEvents",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=e?"on":"off";this.editor[n](m.L.KEYDOWN,this.handleKeydown,2e3),this.editor[n](B.f.STOPPED_KEYDOWN,this.handleKeydown),this.editor[n](B.f.ENTER,this.handleEnter),this.editor[n](B.f.AFTER_ENTER,this.handleAfterEnter),this.editor[n](B.f.AFTER_SHIFT_ENTER,this.handleAfterShiftEnter),this.editor[n]("click",this.setShouldCapitalizeIfNecessaryFalse),this.editor[n](m.L.BLUR,this.setShouldCapitalizeIfNecessaryFalse),C.N[n](S.r.AFTER_UNDO_REDO,this.setShouldCapitalizeIfNecessaryFalse),this.editor[n](m.L.CONTENT_CHANGE,this.handleContentChange),this.editor[n](m.L.INPUT,this.handleInput),this.editor[n](m.L.COMPOSITION_END,this.setShouldCapitalizeIfNecessaryTrue)}},{key:"handleKeydown",value:function(e){if(e.keyCode===I.G.SPACEBAR){if(!this.shouldCapitalizeIfNecessary)return void this.log("return because shouldCapitalizeIfNecessary false");this.handleTriggerKeys(e)}else this.handleOtherKeys(e)}},{key:"handleEnter",value:function(){this.tmpShouldCapitalizeIfNecessary=this.shouldCapitalizeIfNecessary,this._prevSelection=this.editor.selection.getSelection(),this._prevActiveZone=this.editor.getContentState().getActiveZone()}},{key:"handleAfterEnter",value:function(e){this.tmpShouldCapitalizeIfNecessary?this.handleTriggerKeys(e,"enter"):this.log("return because tmpShouldCapitalizeIfNecessary false")}},{key:"handleAfterShiftEnter",value:function(e){this.shouldCapitalizeIfNecessary?this.handleTriggerKeys(e,"shiftEnter"):this.log("return because shouldCapitalizeIfNecessary false")}},{key:"handleTriggerKeys",value:function(e,n){if(this.enabled()){var r=this.editor.selection.getSelection(),o=this.editor.getContentState().getActiveZone();if("enter"===n&&(r=this._prevSelection,o=this._prevActiveZone),r&&o&&r.isCollapsed())if("shiftEnter"!==n||(r=this.fixRangeForShiftEnter(r))){var i=o.getLine(r.start.line);if(i){var c=i.getText(),a=c.substring(0,c.length-1);if(0!==a.length){var l=r.start.offset;if(0!==l&&(/[a-z]/.test(a[l-1])||j.includes(a[l-1]))){var s=function(e,n){for(var r=D,o=e.length,i=[],c=0,a=-1,l=-1,s=r.exec(e);s;){var u=e.substring(c,s.index);if("."===s[0][0]&&/\.[a-zA-Z]^/.test(u))s=r.exec(e);else{if(i.push({sentence:e.substring(c,s.index),end:s.index+s[0].length}),c=s.index+s[0].length,a++,-1===l&&c>=n){l=a,r.lastIndex=0;break}s=r.exec(e)}}if(-1===l){l=a+1;var d="";d=M.indexOf(e[o-1])>-1?e.substring(c,o-1):e.substring(c,o),i.push({sentence:d,end:o})}var f=0===l?0:i[l-1].end;return{sentence:i[l].sentence,offsetOfParagraph:f}}(a,l);this.shouldAutoCapitalize({sentenceInfo:s,selectionOffset:l,lineState:i})&&(e.preventEvent(),e.preventDefault(),this.performAutoCapitalization({sentenceInfo:s,curSelection:r,lineState:i,shouldAddSpace:e.keyCode===I.G.SPACEBAR}))}else this.log("return because pre letter illegal")}}}else this.log("return because selection false after fixed")}else this.log("return because enabled false")}},{key:"fixRangeForShiftEnter",value:function(e){var n=this.editor.getContentState().getActiveZone().getLine(e.start.line-1);if(!n)return null;var r={line:e.start.line-1,offset:n.getModelText().length-1,zoneId:e.start.zoneId};return new _.A({editor:this.editor,start:r,end:r})}},{key:"handleOtherKeys",value:function(e){this.enabled()&&(L.includes(e.keyCode)?this.shouldCapitalizeIfNecessary=!1:F.includes(e.keyCode)||(e.metaKey||e.ctrlKey?this.shouldCapitalizeIfNecessary=!1:e.keyCode!==I.G.PROCESSING_INPUT&&(this.shouldCapitalizeIfNecessary=!0)))}},{key:"shouldAutoCapitalize",value:function(e){var n,r=e.sentenceInfo,o=e.selectionOffset,i=e.lineState,c=r.offsetOfParagraph,a=o;if(i.getAttributes(c,a).some((function(e){return P.includes(e[0])})))return!1;var l=r.sentence.substr(0,a-c);return!!A.test(l)&&!(K.deleteWordInfo&&K.deleteWordInfo.selection[2]===(null===(n=i.parent)||void 0===n?void 0:n.getZoneId())&&K.deleteWordInfo.selection[0]===i.index&&K.deleteWordInfo.selection[1]===r.offsetOfParagraph&&K.deleteWordInfo.content.toLowerCase().startsWith(l)&&/^(\s|$)/.test(K.deleteWordInfo.content.substring(l.length)))}},{key:"performAutoCapitalization",value:function(e){this.log("performAutoCapitalization");var n=e.sentenceInfo,r=e.curSelection,o=e.lineState,i=e.shouldAddSpace,c=n.offsetOfParagraph,a=c+1,l=n.sentence.substr(0,1).toUpperCase(),s=o.getAttributes(c,a).toMap();this.editor.flushInput();var u=this.editor.getContentState();if(i){var d=Object(E.I)(this.editor.getContentState(),r);u.insertText(r.start," ",d,{extra:{mergeMode:y.f.SPLIT}})}u.replaceText({start:X(X({},r.start),{},{offset:c}),end:X(X({},r.start),{},{offset:a})},l,s,{extra:{mergeMode:y.f.SPLIT}}),Object(V.N)("ccm_doc_content_page_click",{click:"auto_capitalization",target:"none"}),C.N.emit(C.p.EDITOR_PLUGIN.PERFORM_AUTO_CAPITALIZATION)}},{key:"setShouldCapitalizeIfNecessaryTrue",value:function(){this.shouldCapitalizeIfNecessary=!0}},{key:"setShouldCapitalizeIfNecessaryFalse",value:function(){this.shouldCapitalizeIfNecessary=!1}},{key:"handleContentChange",value:function(e){var n=this;if(this.enabled()){var r=e.options,o=e.deltaSet,i=e.previous;r.type&&N.includes(r.type)&&(Object.entries(o.deltas).length>1?K.deleteWordInfo=null:o.forEach((function(e){if(!function(e){var n=e.ops;return 2===n.length&&("number"===typeof n[0].retain&&n[0].retain>0||"number"===typeof n[1].delete&&n[1].delete>0)||1===n.length&&"number"===typeof n[0].delete&&n[0].delete>0}(e))return console.error("[AutoCapitalization] ops illegal: ",e.ops),void(K.deleteWordInfo=null);var r=n.editor.getContentState().getActiveZone().getZoneId(),o=i.getZoneState(r);if(!o)return console.error("[AutoCapitalization] zone not exist: ",r),void(K.deleteWordInfo=null);var c=0,a=0;e.ops.forEach((function(e){"number"===typeof e.retain?c=e.retain:a=e.delete}));var l=o.offsetToPoint(c),s=o.getModelText().substr(c,a),u=o.offsetToPoint(c+a-1);l.line===u.line?K.deleteWordInfo&&!K.deleteWordInfo.shouldResetNext&&K.deleteWordInfo.selection[2]===e.zoneId?K.deleteWordInfo.selection[1]-1!==l.offset?K.deleteWordInfo.selection[1]!==l.offset?K.deleteWordInfo={blockId:Object(T.j)(e.zoneId),selection:[l.line,l.offset,e.zoneId],content:s}:K.deleteWordInfo={blockId:Object(T.j)(e.zoneId),selection:K.deleteWordInfo.selection,content:K.deleteWordInfo.content+s}:K.deleteWordInfo={blockId:Object(T.j)(e.zoneId),selection:[l.line,l.offset,e.zoneId],content:s+K.deleteWordInfo.content}:K.deleteWordInfo={blockId:Object(T.j)(e.zoneId),selection:[l.line,l.offset,e.zoneId],content:s}:K.deleteWordInfo=null})))}}},{key:"handleInput",value:function(){if(this.enabled()){var e=this.editor.selection.getSelection().start,n=e.line,r=e.offset,o=e.zoneId;K.deleteWordInfo&&n===K.deleteWordInfo.selection[0]&&r===K.deleteWordInfo.selection[1]&&o===K.deleteWordInfo.selection[2]&&(K.deleteWordInfo.shouldResetNext=!0)}}},{key:"log",value:function(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];J.apply(void 0,["blockId: ".concat(null===(e=this.editor.selection)||void 0===e?void 0:e.getSelection().start.zoneId)].concat(r))}}]),r}(k.o),W=z,b()(W.prototype,"handleKeydown",[R],Object.getOwnPropertyDescriptor(W.prototype,"handleKeydown"),W.prototype),b()(W.prototype,"handleEnter",[R],Object.getOwnPropertyDescriptor(W.prototype,"handleEnter"),W.prototype),b()(W.prototype,"handleAfterEnter",[R],Object.getOwnPropertyDescriptor(W.prototype,"handleAfterEnter"),W.prototype),b()(W.prototype,"handleAfterShiftEnter",[R],Object.getOwnPropertyDescriptor(W.prototype,"handleAfterShiftEnter"),W.prototype),b()(W.prototype,"setShouldCapitalizeIfNecessaryTrue",[R],Object.getOwnPropertyDescriptor(W.prototype,"setShouldCapitalizeIfNecessaryTrue"),W.prototype),b()(W.prototype,"setShouldCapitalizeIfNecessaryFalse",[R],Object.getOwnPropertyDescriptor(W.prototype,"setShouldCapitalizeIfNecessaryFalse"),W.prototype),b()(W.prototype,"handleContentChange",[R],Object.getOwnPropertyDescriptor(W.prototype,"handleContentChange"),W.prototype),b()(W.prototype,"handleInput",[R],Object.getOwnPropertyDescriptor(W.prototype,"handleInput"),W.prototype),W),$=r("dx_UtDZ");var ee=function(){return Object($.getMinaConfig)("ccm.docx.auto_capitalization_enabled",!1)?[[Q,{enabled:K.getEnabled}]]:[]}},dx_eup5:function(e,n,r){},dx_ey54:function(e,n,r){"use strict";r.d(n,"H",(function(){return o})),r.d(n,"G",(function(){return i})),r.d(n,"g",(function(){return c})),r.d(n,"o",(function(){return a}));var o="editor-mount",i="editor-resize",c=".layer-popup",a="layer-popup"},dx_eyH3:function(e,n,r){"use strict";r.d(n,"l",(function(){return o}));var o,i=r("dx_RIqP"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_QxNg"),f=r("dx_h6a8"),h=r("dx_faye"),p=r("dx_B28d"),v=r("dx_QBqw"),g=r("dx_FvGq"),b=r("dx_k8kI"),y=r("dx_BTVV"),m=r("dx_S5Se"),_=r("dx_fCRr"),k=r("dx_XlRC");!function(e){e.SSR="SSR",e.PDF="PDF",e.PREVIEW="PREVIEW",e.SHORTCUT="SHORTCUT",e.HISTORY="HISTORY",e.NORMAL="NORMAL"}(o||(o={}));var O=function(){function e(n){var r=this,i=n.blockManager,a=n.eventEmitter,s=n.selectionAPI,u=n.modelService,h=n.env;l()(this,e),this.subs=[],this.blockManager=void 0,this.eventEmitter=void 0,this.selectionAPI=void 0,this.modelService=void 0,this.orderMap=new Map,this.pendingSet=new Set,this.env=void 0,this.blockTreeInited=!1,this.isDataReady=!1,this.asyncUpdateView=Object(f.debounce)((function(){r.isDataReady&&0!==r.pendingSet.size&&r.udpateView()}),0),this.blockTypes=void 0,this.containerType=void 0,this.handleBlockModelCreate=function(e){var n=!e.isInit&&"replace-suspense"!==e.options.transactionName;r.env===o.SSR||r.env===o.SHORTCUT||n||r.handleInsert(e.model)},this.handleBufferChanged=function(){r.asyncUpdateView()},this.handleBlockTreeInited=function(){r.blockTreeInited=!0},this.handleBeforeRecordChange=function(e){if(r.blockTreeInited){var n=e.options.from,o=e.options.isInPaste,i=e.options.isInUndoRedo,c=e.options.transactionName,a="remote"!==n&&!o&&"performDropToSameLevel"!==c&&!i;e.recordOps.forEach((function(e){r.getRemoveBlockIds(e).forEach((function(e){var n=r.blockManager.getBlockModelByBlockId(e);r.handleRemove(n,void 0,a)}))}))}},this.handleAfterRecordChange=function(e){var n;if(r.blockTreeInited){var o=e.recordOps,i=e.options,a=o.filter((function(e){return r.isInsertRecordOp(e)})),l=o.filter((function(e){return r.isRemoveRecordOp(e)})),s=o.filter((function(e){return r.isInsertOpWithHeadingChild(e)}));if(i.isInPaste&&(a.length>0||l.length>0)&&"remote"!==i.from&&!i.isInUndoRedo){var u={recordOps:o,recordOpsType:_.l.PASTE,targetRecordOps:[].concat(c()(a),c()(l)),targetRecordOpTypes:[].concat(c()(new Array(a.length).fill(_.R.INSERT)),c()(new Array(l.length).fill(_.R.REMOVE)))};r.batchModifySeqIfNecessary(u)}else if(a.length&&l.length&&"remote"!==i.from&&!i.isInUndoRedo&&!(null===(n=i.transactionName)||void 0===n?void 0:n.includes("tab"))){var f=Object(m.u)(a),h=Object(m.s)(l);if(f.length===h.length){h.forEach((function(e){var n=e.action.ld,r=f.find((function(e){return e.action.li===n}));if(!r)return null}));var p={recordOps:o,recordOpsType:_.l.MOVE,targetRecordOps:[].concat(c()(a),c()(l)),targetRecordOpTypes:[].concat(c()(new Array(a.length).fill(_.R.INSERT)),c()(new Array(l.length).fill(_.R.REMOVE)))};r.batchModifySeqIfNecessary(p)}}else if(a.length>0){var v={recordOps:o,recordOpsType:_.l.INSERT,targetRecordOps:a,targetRecordOpTypes:[_.R.INSERT]};r.batchModifySeqIfNecessary(v)}else if(s.length>0){var g={recordOps:o,recordOpsType:_.l.INSERT,targetRecordOps:s,targetRecordOpTypes:[_.R.INSERT]};r.batchModifySeqIfNecessary(g)}else if(l.length>0){var b={recordOps:o,recordOpsType:_.l.REMOVE,targetRecordOps:l,targetRecordOpTypes:[_.R.REMOVE]};r.batchModifySeqIfNecessary(b)}else o.forEach((function(e){var n=r.blockManager.getBlockModelsByRecordId(e.id)[0];if(n){var o=n.record.get(["seq"]),c=e.ops.find((function(e){return r.isModifySeq(e)}));if(c)if(r.match(n))if("turninto"===i.transactionName){var a={recordOps:[e],recordOpsType:_.l.MARKDOWN,targetRecordOps:[],targetRecordOpTypes:[]};r.batchModifySeqIfNecessary(a)}else r.handleInsert(n);else r.handleRemove(n),(Object(d.bG)(c)||Object(d.P)(c))&&(o=c.action.od);var l=e.ops.find((function(e){return r.isTurnInto(e)}));if(l){var s=Object(y.U)(l,"od");r.matchType(s)&&r.isValidSeq(o)&&r.handleRemove(n,s),r.match(n)&&r.handleInsert(n)}}}))}},this.getTypeByOp=function(e,n,r){var o=e.action[n];return r.recordManager.hasRecord(o)?r.getRecord(o).snapshot.type:""},this.blockManager=i,this.eventEmitter=a,this.selectionAPI=s,this.modelService=u,this.env=h||o.NORMAL;var p=window.location.hash.slice(1).length>0;this.isDataReady=[o.SSR,o.SHORTCUT,o.PREVIEW,o.PDF].includes(this.env)||!p}return u()(e,[{key:"syncUpdateView",value:function(){0!==this.pendingSet.size&&(this.asyncUpdateView.cancel(),this.udpateView())}},{key:"layoutManager",get:function(){return this.blockManager.layoutManager}}]),u()(e,[{key:"init",value:function(){this.subs=this.modelService?[this.modelService.interceptChange$.subscribe(this.handleBeforeRecordChange),this.modelService.blockModelCreate$.subscribe(this.handleBlockModelCreate)]:[],this.blockManager.addListener(b.a,this.handleBufferChanged),this.blockManager.addListener(g.Q,this.handleBlockTreeInited),this.blockManager.recordManager.on(d.q.CHANGE,this.handleAfterRecordChange)}},{key:"destroy",value:function(){this.subs.forEach((function(e){return null===e||void 0===e?void 0:e.unsubscribe()})),this.asyncUpdateView.cancel(),this.blockManager.removeListener(b.a,this.handleBufferChanged),this.blockManager.removeListener(g.Q,this.handleBlockTreeInited),this.blockManager.recordManager.off(d.q.CHANGE,this.handleAfterRecordChange)}},{key:"getOrder",value:function(e){return this.orderMap.get(e)}},{key:"initOrderFromClientvars",value:function(e,n){var r=this,o=[];this.initContainer(n),this.traverse(e,n,(function(i){if(r.containerType.includes(i.data.type)&&i.id!==n)return r.initOrderFromClientvars(e,i.id),!1;if(r.matchType(i.data.type)&&r.isValidSeq(i.data.seq)){var c={recordId:i.id,blockType:i.data.type,seq:i.data.seq,seqLevel:i.data.seq_level||"auto",isDeleted:!1};o.push(c)}return!0}));var i=this.calHeadingQueue(o);this.calcOrder(i)}},{key:"isValidSeq",value:function(e){return Object(k.a)(e)}},{key:"updateOrder",value:function(e,n){this.orderMap.set(e,n),this.pendingSet.add(e),this.asyncUpdateView()}},{key:"udpateView",value:function(){var e=this;Object(h.unstable_batchedUpdates)((function(){c()(e.pendingSet).forEach((function(n){var r=e.blockManager.getBlockIdsByRecordId(n)[0];if(e.layoutManager.isBlockActive(r)){e.pendingSet.delete(n);try{e.forceUpdate(n)}catch(o){console.info("[OrderModule] updateView ".concat(n," error")),console.error(o)}}}))}))}},{key:"traverse",value:function(e,n,r){var o,i=this,c=e.block_map[n];if(c&&r(c)){var a=c.data.children;c.data.type===p.B.TABLE&&(a=Object(v.T)(c.data)),null===(o=a)||void 0===o||o.forEach((function(n){return i.traverse(e,n,r)}))}}},{key:"collectMathedBlockIds",value:function(e,n){var r=this;this.blockManager.recordManager.traverse(e,(function(e){return r.blockManager.getBlockIdsByRecordId(e.id).forEach((function(e){if(r.blockManager.hasBlockModelByBlockId(e)){var o=r.blockManager.getBlockModelByBlockId(e);r.match(o)&&n.add(e)}})),!0}))}},{key:"getRemoveBlockIds",value:function(e){var n=this;return e.ops.reduce((function(e,r){return Object(d.ZH)(r)&&"children"===r.p[0]&&"string"===typeof r.action.ld?(n.collectMathedBlockIds(r.action.ld,e),e):e}),new Set)}},{key:"isTurnInto",value:function(e){var n=this;if(!Object(d.bG)(e))return!1;var r=Object(y.U)(e,"od"),o=Object(y.U)(e,"oi");return r!==o&&[o,r].some((function(e){return n.blockTypes.includes(e)}))}},{key:"isModifySeq",value:function(e){return"seq"===e.p[0]||"seq_level"===e.p[0]}},{key:"isInsertRecordOp",value:function(e){var n=this;return e.ops.find((function(e){return n.isInsert(e,"heading")}))}},{key:"isRemoveRecordOp",value:function(e){var n=this;return e.ops.find((function(e){return n.isRemove(e,"heading")}))}},{key:"isInsertOpWithHeadingChild",value:function(e){var n=this;return e.ops.find((function(e){if(!Object(d.X)(e))return!1;if("children"!==e.p[0])return!1;var r,o,i=e.action.li,c=n.blockManager.recordManager.hasRecord(i)?n.blockManager.getRecord(i):null;return!!c&&(null===(r=c.snapshot)||void 0===r||null===(o=r.children)||void 0===o?void 0:o.some((function(e){var r=n.blockManager.getBlockModelsByRecordId(e)[0];return r&&n.match(r)})))}))}},{key:"isInsert",value:function(e,n){var r=this,o=Object(d.X)(e),i=Object(d.y)(e);if(!o&&!i)return!1;if(o)return"children"===e.p[0]&&this.getTypeByOp(e,"li",this.blockManager).includes(n);if(i){var c,a,l=null===e||void 0===e||null===(c=e.action)||void 0===c?void 0:c.oi;if(0===e.p.length&&l)return null===(a=l.children)||void 0===a?void 0:a.some((function(e){return r.blockManager.recordManager.hasRecord(e)&&r.blockManager.getRecord(e).snapshot.type.includes(n)}))}return!1}},{key:"isRemove",value:function(e,n){return!!Object(d.ZH)(e)&&("children"===e.p[0]&&this.getTypeByOp(e,"ld",this.blockManager).includes(n))}},{key:"inUndoRedo",get:function(){var e;return!!(null===(e=this.blockManager.recordManager.undoModule)||void 0===e?void 0:e.inUndoRedo)}}]),e}();n.S=O},dx_f1HX:function(e,n,r){"use strict";r.d(n,"i",(function(){return C})),r.d(n,"b",(function(){return I}));var o=r("dx_W7W2"),i=r.n(o),c=r("dx_a1gu"),a=r.n(c),l=r("dx_Nsbk"),s=r.n(l),u=r("dx_o0o1"),d=r.n(u),f=r("dx_RIqP"),h=r.n(f),p=r("dx_yXPU"),v=r.n(p),g=r("dx_lwsE"),b=r.n(g),y=r("dx_W8MJ"),m=r.n(y),_=r("dx_AA3h"),k=r("dx_h6a8"),O=r("dx_YzVl"),x=r("dx_yzqx"),E=r("dx_f4Wj");function S(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=s()(e);if(n){var i=s()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return a()(this,r)}}var C=function(e){i()(r,e);var n=S(r);function r(e,o){var i;return b()(this,r),(i=n.call(this,"CardInfo")).pageToken=e,i.userId=o,i}return m()(r,[{key:"doFetch",value:function(){var e=v()(d.a.mark((function e(n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(E.A)(n,this.pageToken);case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),r}(function(){function e(n){var r=this;b()(this,e),this.type=n,this.waitMap=new Map,this.fetchMap=new Map,this.readyMap=new Map,this.debounceFetch=Object(k.debounce)(v()(d.a.mark((function e(){var n,o;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=h()(r.waitMap.keys())).length){e.next=3;break}return e.abrupt("return");case 3:return n.forEach((function(e){return r.move(e,r.waitMap,r.fetchMap)})),o={},e.prev=5,e.next=8,r.doFetch(n);case 8:o=e.sent,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),console.error(r.type,"doFetch error",e.t0);case 14:n.forEach((function(e){var n=r.fetchMap.get(e),i=o[e];if(n){if(!i)return console.warn(r.type,"contentMap id not found",e),r.fetchMap.delete(e),void n.reject(new Error("contentMap id not found ".concat(e)));r.fetchMap.delete(e),r.readyMap.set(e,i),n.resolve(i)}else console.warn(r.type,"fetchMap id not found",e)}));case 15:case"end":return e.stop()}}),e,null,[[5,11]])}))),100)}return m()(e,[{key:"fetch",value:function(e){if(this.readyMap.has(e))return Promise.resolve(this.readyMap.get(e));if(this.fetchMap.has(e))return this.fetchMap.get(e).result;if(this.waitMap.has(e))return this.waitMap.get(e).result;var n={};return n.result=new Promise((function(e,r){return Object.assign(n,{resolve:e,reject:r})})),this.waitMap.set(e,n),this.debounceFetch(),n.result}},{key:"retry",value:function(e){return this.readyMap.delete(e),this.fetch(e)}},{key:"move",value:function(e,n,r){var o=n.get(e);n.delete(e),r.set(e,o)}}]),e}());function I(e){var n=e.type,r=e.content;if(x.S.isMobile&&x.S.isBytedanceApp)switch(n){case"error":_.toastHelper.showToast({type:_.toastHelper.EToastType.FAIL,message:r,duration:1});break;case"success":_.toastHelper.showToast({type:_.toastHelper.EToastType.SUCCESS,message:r,duration:1})}else Object(O.F)({type:n,content:r})}C.instance=void 0},dx_f4Wj:function(e,n,r){"use strict";r.d(n,"A",(function(){return u})),r.d(n,"G",(function(){return f})),r.d(n,"W",(function(){return h}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_UtDZ"),s=r("dx_TTrq");function u(e,n){return d.apply(this,arguments)}function d(){return(d=a()(i.a.mark((function e(n,r){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.W)(r);case 2:if(o=e.sent){e.next=5;break}return e.abrupt("return",Promise.reject(new Error("[chart-card]: fetchChatInfoByChatToken fail, cannot find realPageToken")));case 5:return e.abrupt("return",l.mentionApis.fetchChatInfoV3({share_tokens:"string"===typeof n?n:n.join(","),source:l.SOURCE_ENUM.DOC,obj_type:l.NUM_FILE_TYPE.DOCX,obj_token:o}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return l.mentionApis.joinChatByToken(e)}function h(e,n){return p.apply(this,arguments)}function p(){return(p=a()(i.a.mark((function e(n,r){var o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(s.W)(r);case 2:if(o=e.sent){e.next=5;break}return e.abrupt("return",Promise.reject(new Error("[chart-card]: createChatTokenByChatId fail, cannot find realPageToken")));case 5:return e.abrupt("return",l.mentionApis.createChatToken({chat_id:n,obj_token:o,obj_type:String(l.NUM_FILE_TYPE.DOCX)}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},dx_f4fP:function(e,n,r){"use strict";r.d(n,"C",(function(){return o}));var o=function(e){return e.type.includes("touch")?e.changedTouches[0]:e}},dx_f5fh:function(e,n,r){"use strict";var o,i,c,a,l,s,u,d,f,h,p,v=r("dx_yG8O"),g=r.n(v),b=r("dx_lwsE"),y=r.n(b),m=r("dx_W8MJ"),_=r.n(m),k=r("dx_PJYZ"),O=r.n(k),x=r("dx_W7W2"),E=r.n(x),S=r("dx_a1gu"),C=r.n(S),I=r("dx_Nsbk"),B=r.n(I),T=r("dx_Uyc2"),w=r.n(T),R=(r("dx_A1AB"),r("dx_Vvd7")),M=r("dx_N9dL"),j=r("dx_T4T0"),D=r("dx_Z22N"),A=r("dx_B28d"),P=r("dx_Mj0E"),L=r("dx_Tdsn"),N=r("dx_xjz2"),F=r("dx_YRGG"),U=r("dx_Wkzy"),H=Object(N.s)(F.h)((i=function(){function e(){y()(this,e),this.type=A.B.BITABLE,g()(this,"loader",c,this)}return _()(e,[{key:"fetchResource",value:function(){return this.loader.preloadBridge()}}]),e}(),c=w()(i.prototype,"loader",[U.x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=i))||o,V=r("dx_UtDZ"),W=r("dx_bWl7"),z=r("dx_Xdvu"),G=r("dx_NpE2"),K=Object(N.s)(U.x)((l=function(){function e(){var n=this;y()(this,e),this.bridge=void 0,this.newPasteBlockMap=new Set,this.newInsertBlockMap=new Set,this.tokenToRecordIdMap=new Map,this.reporter=new G.W,g()(this,"config",s,this),g()(this,"context",u,this),this.preloadBridge=function(){return Object(V.loadBitableBridge)()},this.init=function(e){if(!n.bridge){var r=n.isPreview?{store:V.LoadableBitableBridgeForDocx.createReduxStore(),pure:!0}:{};n.bridge=new V.LoadableBitableBridgeForDocx(n.getOrders,{getCreatedSource:n.getCreatedSource},r),n.bridge.loadBitableManager(e)}},this.getOrders=function(){var e,r=[];return null===(e=n.blockManager)||void 0===e||e.recordManager.traverse(n.blockManager.rootRecordId,(function(e){if(e.snapshot.type===A.B.BITABLE){var n=Object(W.U)(e.snapshot.token).id;r.push(n||e.id)}return!0})),r},this.getCreatedSource=function(e,r){var o="".concat(e,"_").concat(r),i=V.CreatedSource.INSIDE_PAGE;return n.newInsertBlockMap.has(o)&&(i=V.CreatedSource.USER_INSERT),n.newPasteBlockMap.has(o)&&(i=V.CreatedSource.PASTE),{createdSource:i}},this.getBridge=function(e){var r;(n.bridge||n.init(e),n.bridge&&n.bridge.token!==e)&&(null===(r=n.bridge)||void 0===r||r.loadBitableManager(e));return n.bridge},this.getLoadedBridge=function(){return n.bridge},this.destroy=function(){n.bridge&&n.bridge.destroy(),n.bridge=null},this.setNewPasteBlockMap=function(e){n.newPasteBlockMap.add(e)},this.setNewInsertBlockMap=function(e){n.newInsertBlockMap.add(e)},this.setBitableToken=function(e,r){n.tokenToRecordIdMap.has(e)||n.tokenToRecordIdMap.set(e,r)},this.delBitableToken=function(e){n.tokenToRecordIdMap.has(e)&&n.tokenToRecordIdMap.delete(e)}}return _()(e,[{key:"getRecordIdByToken",value:function(e){return this.tokenToRecordIdMap.get(e)||""}},{key:"blockManager",get:function(){return this.context.blockManager}},{key:"isPreview",get:function(){return this.config.get("isPreview")}}]),e}(),s=w()(l.prototype,"config",[R.j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=w()(l.prototype,"context",[z.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=l))||a,q=r("dx_yzb3");function X(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=B()(e);if(n){var i=B()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return C()(this,r)}}var Y=Object(R.H)({providers:[K,H,{provide:D.I,useClass:j.V,args:[A.B.BITABLE,{isAsync:!0,canLazyIdleRender:!1,defaultHeight:220}]},{provide:M.RecordSnapshotCreator,useValue:{type:A.B.BITABLE,create:P.Z}}]})((p=function(e){E()(r,e);var n=X(r);function r(){var e;y()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),g()(e,"depLoader",h,O()(e)),e.blocks=[[L.S,{viewCreator:q.S}]],e}return _()(r,[{key:"destroy",value:function(){this.depLoader.destroy()}}]),r}(R.y),f=p,h=w()(f.prototype,"depLoader",[U.x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=f))||d;n.S=Y},dx_f5gY:function(e,n,r){"use strict";(function(t){r.d(n,"k",(function(){return f}));var e=r("dx_QILm"),o=r.n(e),i=r("dx_P9Oj"),c=r("dx_TSYQ"),a=r.n(c),l=r("dx_cDcd"),s=r.n(l),u=r("dx_N4Vo"),d=r("dx_EzbQ"),f=(r("dx_o7oA"),s.a.forwardRef((function(e,n){var r,c=e.dueTime,l=e.dueTimezone,f=e.isAllDay,h=e.reminders,p=e.onRemove,v=e.completed,g=e.disabled,b=e.rrule,y=e.isPresentationMode,m=o()(e,["dueTime","dueTimezone","isAllDay","reminders","onRemove","completed","disabled","rrule","isPresentationMode"]);return s.a.createElement("span",Object.assign({},m,{className:(r="wrapper","task-block__DueTime__".concat(r)),ref:n}),c&&c>0?s.a.createElement(d.S,{time:c,timezone:l,isAllDay:f,reminders:h,onRemove:p,completed:v,disabled:g,rrule:b,isPresentationMode:y}):!g&&s.a.createElement(u.a,{type:"icon",icon:s.a.createElement(i.S,null),tooltipProps:{title:t("CreationDoc_Tasks_AddDueDate_ToolTip")},className:a()({"task-block-action-btn":!0,"task-block--TimeTabKey":!0}),size:"small"}))})))}).call(this,r("dx_E9Eu"))},dx_f650:function(e,n,r){"use strict";r.d(n,"I",(function(){return s})),r.d(n,"l",(function(){return u}));var o=r("dx_UtDZ"),i=r("dx_cDcd"),c=r.n(i),a=r("dx_h74D"),l=function(e){var n=e.store,r=e.parentSub,o=e.children,l=Object(i.useMemo)((function(){var e=new r.constructor(n,r);return e.onStateChange=e.notifyNestedSubs,{store:n,subscription:e}}),[n,r]),s=Object(i.useMemo)((function(){return n.getState()}),[n]);return Object(i.useEffect)((function(){var e=l.subscription,n=l.store;return s!==n.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[l,s]),c.a.createElement(a.ReactReduxContext.Provider,{value:l},o)};function s(e,n){if(e){var r=e.store,i=e.subscription;return c.a.createElement(l,{store:r,parentSub:i},n)}return c.a.createElement(a.Provider,{store:o.store},n)}var u=function(e){var n=e.store,r=e.context,o=e.children;return c.a.createElement(a.Provider,{store:n,context:r},c.a.createElement(a.ReactReduxContext.Consumer,null,(function(e){return o(e)})))}},dx_f6fH:function(e,n,r){"use strict";var o,i=r("dx_lwsE"),c=r.n(i),a=r("dx_W8MJ"),l=r.n(a),s=r("dx_W7W2"),u=r.n(s),d=r("dx_a1gu"),f=r.n(d),h=r("dx_Nsbk"),p=r.n(h),v=r("dx_cDcd"),g=r.n(v),b=r("dx_faye"),y=r.n(b),m=r("dx_qHDV"),_=r("dx_J4zp"),k=r.n(_),O=r("dx_TSYQ"),x=r.n(O),E=r("dx_h6a8"),S=r("dx_lSNA"),C=r.n(S),I=r("dx_Mzjv"),B=r("dx_S6dX"),T=(o={},C()(o,I.R.None,(function(){return{width:0,height:0}})),C()(o,I.R.LeftTextCenter,(function(e,n,r){return{width:e.x-n.x-r[I.R.LeftTextCenter][0],height:n.height-r[I.R.LeftTextCenter][1]}})),C()(o,I.R.LeftCenter,(function(e,n,r){return{width:e.x-n.x-r[I.R.LeftCenter][0],height:n.height-r[I.R.LeftCenter][1]}})),C()(o,I.R.RightTextCenter,(function(e,n,r){return{width:n.x+n.width-e.x-e.width-r[I.R.RightTextCenter][0],height:n.height-r[I.R.RightTextCenter][1]}})),C()(o,I.R.RightCenter,(function(e,n,r){return{width:n.x+n.width-e.x-e.width-r[I.R.RightCenter][0],height:n.height-r[I.R.RightCenter][1]}})),C()(o,I.R.TopLeft,(function(e,n,r){return{width:n.x+n.width-e.x-r[I.R.TopLeft][0],height:e.y-n.y-r[I.R.TopLeft][1]}})),C()(o,I.R.BottomLeft,(function(e,n,r){return{width:n.x+n.width-e.x-r[I.R.BottomLeft][0],height:n.y+n.height-e.y-e.height-r[I.R.BottomLeft][1]}})),C()(o,I.R.TopRight,(function(e,n,r){return{width:e.x+e.width-n.x-r[I.R.TopRight][0],height:e.y-n.y-r[I.R.TopRight][1]}})),C()(o,I.R.BottomRight,(function(e,n,r){return{width:e.x+e.width-n.x-r[I.R.BottomRight][0],height:n.y+n.height-e.y-e.height-r[I.R.BottomRight][1]}})),C()(o,I.R.TopCenter,(function(e,n,r){return{width:n.width-r[I.R.TopCenter][0],height:e.y-n.y-r[I.R.TopCenter][1]}})),C()(o,I.R.BottomCenter,(function(e,n,r){return{width:n.width-r[I.R.BottomCenter][0],height:n.y+n.height-e.y-e.height-r[I.R.BottomCenter][1]}})),o);function w(e,n,r,o){var i=Object(v.useState)({}),c=k()(i,2),a=c[0],l=c[1];return Object(v.useEffect)((function(){l((function(i){if(Object(B.w)(e)||Object(B.w)(n))return{};var c=o.reduce((function(o,i){return o[i]=function(e,n,r,o){return T[o](e,n,r)}(e,n,r,i),o}),{});return Object.keys(c).length!==Object.keys(i).length||Object.keys(i).some((function(e){return!Object(E.isEqual)(i[e],c[e])}))?c:i}))}),[e,n,r,o]),a}var R=r("dx_tX8z"),M=r("dx_i4Kt"),j=r("dx_yzqx");function D(e,n){var r=Object(v.useMemo)((function(){return window.visualViewport?function(e){var n=0,r=0,o=function(){var o=document.body.getBoundingClientRect();n===o.top&&r===o.left||(n=o.top,r=o.left,e(o))};return{run:function(){o(),window.visualViewport.addEventListener("resize",o),window.visualViewport.addEventListener("scroll",o)},cancel:function(){window.visualViewport.removeEventListener("resize",o),window.visualViewport.removeEventListener("scroll",o)}}}(e):function(e){var n=0,r=0,o=Object(E.debounce)((function(){var o=document.body.getBoundingClientRect();n===o.top&&r===o.left||(n=o.top,r=o.left,e(o))}),100);return{run:function(){o(),window.addEventListener("scroll",o)},cancel:function(){o.cancel(),window.removeEventListener("scroll",o)}}}(e)}),[e]);Object(v.useEffect)((function(){if(n&&(j.S.isIOS||j.S.isWebKit))return r.run(),r.cancel}),[n,r])}var A=r("dx_nQiu");function P(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function L(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?P(Object(r),!0).forEach((function(n){C()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var N=Object(v.forwardRef)((function(e,n){var r=e.visible,o=e.hidden,i=e.domRef,c=e.positionInfo,a=e.className,l=e.animationName,s=void 0===l?"":l,u=e.transition,d=void 0!==u&&u,f=e.style,h=e.children,p=Object(v.useRef)(null),b=Object(v.useState)({}),y=k()(b,2),m=y[0],_=y[1],O=Object(v.useState)(!1),S=k()(O,2),B=S[0],T=S[1],w=Object(v.useState)(!1),R=k()(w,2),M=R[0],j=R[1];Object(v.useEffect)((function(){_((function(e){var n=L(L({position:"fixed"},f),c);return Object(E.isEqual)(e,n)?e:(T(!0),n)}))}),[c,f]);var D=Object(v.useCallback)((function(){T(!1)}),[]);Object(v.useImperativeHandle)(n,(function(){return{elementRef:p}}),[]);var P=Object(v.useMemo)((function(){return o||0===Object.keys(c).length}),[o,c]),N=Object(v.useMemo)((function(){return x()(A.P,a,{"overlay-hidden":P,"overlay-transition":!P&&B&&M&&d},s?C()({},s,!P&&!M):void 0)}),[a,P,B,s,M,d]);return r?g.a.createElement("div",{className:N,style:m,onAnimationEnd:function(){j(s!==I.w.None)},onTransitionEnd:D,ref:i},h):null})),F=function(e){var n=e.targetRect,r=e.boundaryRect,o=e.mask,i=e.calcDirectionOnce,c=e.calcDirection,a=e.zIndex,l=e.children,s=e.visible,u=e.className,d=e.blockManager,f=e.setOverlayRef,h=e.hideWhenOverflow,p=void 0!==h&&h,b=e.sticky,y=void 0===b?[!0,!1]:b,m=e.calcPosition,_=void 0===m?B.r:m,O=e.animation,S=void 0===O?I.e.Slide:O,T=e.transition,j=e.onClose,A=e.ignoreContainerFocusNode,P=e.ignoreTriggerTargetClass,L=e.bubbleForbidden,F=void 0!==L&&L,U=Object(v.useState)(null),H=k()(U,2),V=H[0],W=H[1],z=Object(R.l)(V,d,s),G=Object(v.useCallback)((function(e){F&&(e.stopPropagation(),e.nativeEvent.stopImmediatePropagation())}),[F]),K=Object(v.useCallback)((function(e){W(e),null===f||void 0===f||f(e)}),[f]);!function(e){var n=e.contentEle,r=e.onClose,o=e.ignoreContainerFocusNode,i=e.ignoreTriggerTargetClass,c=Object(v.useCallback)((function(e){var c;if(!(e.target instanceof Element&&n&&n.contains(e.target))&&!(e.target instanceof Element&&e.target.closest(".xgplayer-video-container"))&&!(e.target instanceof Element&&e.target.closest(".resizable-container"))&&!(i&&e.target instanceof Element&&e.target.closest(".".concat(i)))){var a=null===(c=window.getSelection())||void 0===c?void 0:c.focusNode;!o&&a&&e.target instanceof Element&&e.target.contains(a)||r&&r(e)}}),[n,i,o,r]);Object(v.useEffect)((function(){return document.addEventListener("mousedown",c,!0),document.addEventListener("touchstart",c,!0),function(){document.removeEventListener("mousedown",c,!0),document.removeEventListener("touchstart",c,!0)}}),[c])}({contentEle:V,onClose:j,ignoreContainerFocusNode:A,ignoreTriggerTargetClass:P});var q=Object(v.useState)(I.R.None),X=k()(q,2),Y=X[0],J=X[1],Z=Object(v.useMemo)((function(){return Array.isArray(e.allowDirections)?e.allowDirections:[e.allowDirections]}),[e.allowDirections]),Q=function(e,n){return Object(v.useMemo)((function(){return n.reduce((function(n,r){var o=null!==e&&void 0!==e?e:0;return Object(E.isNumber)(o)?n[r]=[o,o]:Array.isArray(o)?n[r]=o:o[r]?n[r]=o[r]:n[r]=[0,0],n}),C()({},I.R.None,[0,0]))}),[e,n])}(e.offset,Z),$=w(n,r,Q,Z),ee=Object(M.G)(s),te=Object(v.useState)(new DOMRect(0,0,0,0)),ne=k()(te,2),re=ne[0],oe=ne[1],ie=Object(v.useCallback)((function(e){oe(e)}),[]);D(ie,s);var ce=Object(v.useState)({}),ae=k()(ce,2),le=ae[0],se=ae[1],ue=Object(v.useState)(!1),de=k()(ue,2),fe=de[0],he=de[1];Object(v.useEffect)((function(){if(Object(B.E)(z)&&Object(B.E)(n)&&Q[Y]||!s){var e=_({targetRect:n,contentRect:z,direction:Y,offsetInfo:Q[Y],viewportInfo:ee,bodyRect:re,boundaryRect:r}),o=Object(E.isArray)(y)?y:[y,y];if(o[1]&&"bottom"!==o[1]){var i=Object(B.h)({positionInfo:e,boundaryRect:r,contentRect:z,viewportInfo:ee,bodyRect:re});he(i.top>0)}else he(!1);se((function(n){var o=y?Object(B.s)({positionInfo:e,sticky:y,boundaryRect:r,contentRect:z,viewportInfo:ee,bodyRect:re}):e;return Object(E.isEqual)(n,o)?n:o}))}else se((function(e){return Object(E.isEmpty)(e)?e:{}}))}),[s,Y,n,Q,ee,z,_,y,r,re]);var pe=Object(v.useMemo)((function(){if(!p)return!1;if(!Object(B.E)(z)||Y===I.R.None||Object(B.w)(n))return!0;var e=Object(B.h)({positionInfo:le,contentRect:z,viewportInfo:ee,bodyRect:re,boundaryRect:n});return Y.startsWith("bottom")&&e.top>0||Y.startsWith("top")&&e.bottom>0||Y.startsWith("left")&&e.right>0||Y.startsWith("right")&&e.left>0}),[le,z,ee,re,n,Y]),ve=Object(v.useMemo)((function(){return pe||!Object(B.E)(z)||Y===I.R.None||Object(B.w)(n)}),[pe,z.height,Y,n]),ge=Object(v.useCallback)((function(){s&&Object(B.E)(z)&&J((function(e){return 0===Z.length||Z.some((function(e){return!$[e]}))?I.R.None:i&&e!==I.R.None?e:null!==(n=null===c||void 0===c?void 0:c({adaptiveSize:$,contentRect:z,allowDirections:Z,currentDirection:e}))&&void 0!==n?n:Z[0];var n}))}),[s,i,Z,c,$,z]),be=Object(v.useCallback)((function(){J(I.R.None)}),[]);Object(v.useEffect)((function(){ge()}),[ge]),Object(v.useLayoutEffect)((function(){s||be()}),[s,be]);var ye=Object(v.useMemo)((function(){return{zIndex:a}}),[a]),me=Object(v.useMemo)((function(){if(!1===S||S===I.e.None)return I.w.None;if(S)if(S===I.e.Slide){if(Y.indexOf("left")>-1)return I.w.SlideLeft;if(Y.indexOf("right")>-1)return I.w.SlideRight;if(Y.indexOf("top")>-1)return I.w.SlideTop;if(Y.indexOf("bottom")>-1)return I.w.SlideBottom}else if(S===I.e.Fade)return I.w.Fade}),[Y,S]),_e=Object(v.useMemo)((function(){return x()(u,{"stick-top":fe})}),[u,fe]);return g.a.createElement("div",{className:"overlay-wrapper",onMouseEnter:G,onMouseMove:G,onMouseOver:G},g.a.createElement(N,{domRef:K,visible:s,hidden:ve,style:ye,positionInfo:le,animationName:me,transition:T,className:_e},l),o&&s&&g.a.createElement("div",{className:"overlay-mask"}))};r("dx_amsX");function U(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=p()(e);if(n){var i=p()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return f()(this,r)}}var H=function(e){u()(r,e);var n=U(r);function r(e){var o,i,a,l;return c()(this,r),(l=n.call(this,e)).mountpoint=document.createElement("div"),l.unmountCallback=void 0,l.container=void 0,l.state={key:0},l.selectionFilter=function(e){return!l.mountpoint.contains(e)},l.mountpoint.classList.add("overlay-root"),l.container=null!==(o=null===(i=(a=l.props).getContainer)||void 0===i?void 0:i.call(a))&&void 0!==o?o:document.body,l.container.appendChild(l.mountpoint),l.props.selectionAPI.register(m.q.startTargetFilter,l.selectionFilter),l}return l()(r,[{key:"componentWillUnmount",value:function(){this.unmountCallback&&this.unmountCallback(),this.container.removeChild(this.mountpoint),this.props.selectionAPI.unregister(m.q.startTargetFilter,this.selectionFilter)}},{key:"render",value:function(){return y.a.createPortal(g.a.createElement(F,this.props),this.mountpoint)}}]),r}(g.a.PureComponent);n.S=function(e){return e.visible?g.a.createElement(H,e):null}},dx_fCRr:function(e,n,r){"use strict";var o,i;r.d(n,"l",(function(){return o})),r.d(n,"R",(function(){return i})),function(e){e.TURNINTO="turninto",e.MOVE="move",e.INSERT="insert",e.REMOVE="remove",e.PASTE="paste",e.MARKDOWN="markdown"}(o||(o={})),function(e){e.TURNINTO_INSERT="TURNINTO_INSERT",e.TURNINTO_REMOVE="TURNINTO_REMOVE",e.INSERT="INSERT",e.REMOVE="REMOVE"}(i||(i={}))},dx_fEKD:function(e,n,r){"use strict";r.d(n,"b",(function(){return s}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_UHze");function a(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function l(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?a(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function s(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return l({type:n,children:[],comments:[],author:Object(c.K)().userId},e)}},dx_fLRZ:function(e,n,r){"use strict";var o,i,c;r.d(n,"D",(function(){return o})),r.d(n,"z",(function(){return i})),function(e){e[e.CENTER=0]="CENTER",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT"}(o||(o={})),function(e){e.FULL_WIDTH="fullwidth",e.STANDARD_WIDTH="standardwidth"}(i||(i={})),function(e){e[e.HIDDEN=0]="HIDDEN",e[e.VISIBLE=1]="VISIBLE"}(c||(c={}))},dx_fLyj:function(e,n,r){"use strict";r.d(n,"W",(function(){return k}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_UtDZ"),d=r("dx_h6a8"),f=r("dx_zEdG"),h=r("dx_CwnG"),p=r("dx_eSV8"),v=r("dx_zghO"),g=r("dx_ppc6"),b=r("dx_AbAm"),y=r("dx_HWDJ"),m=r("dx_Z7aw"),_=r("dx_M35M"),k=(r("dx_QtxU"),new function e(){var n=this;s()(this,e),this.waits=[],this.debounceFetch=Object(d.debounce)(function(){var e=a()(i.a.mark((function e(r){var o,c,a,l,s,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.waits.length){e.next=2;break}return e.abrupt("return");case 2:return o=n.waits.concat(),n.waits=[],e.prev=4,e.next=7,Promise.all(o.map((function(e){return Object(m.Q)(e.data.authParams)})));case 7:return c=e.sent,a=r.getRecordByBlockId(r.rootBlockId).id,l=Object(y.c)(a,u.userHelper.getCurrentUser().get("id")),e.next=12,Promise.all(o.map((function(e){var n=e.data.authParams.todo_guid;return l.fetch(n).then((function(e){return l.setCache(n,e),e})).catch(d.noop)})));case 12:return s=e.sent,o.forEach((function(e,n){e.resolve(c[n])})),e.next=16,Object(p.E)(0);case 16:(f=o.filter((function(e,n){return!(e.data.isReference||"cut"===e.data.authParams.operation||c[n].error||!s[n])&&!s[n].is_deleted})).map((function(e){return{blockId:e.data.currentBlockId,recordId:e.data.authParams.new_block_id,guid:e.data.authParams.todo_guid}}))).length&&(r.editorAPI.getService(g.S).setSelection(f.map((function(e){return{type:v.j.BLOCK,id:e.blockId}}))),n.showPopUP(f,r)),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),console.error("doFetch error",e.t0);case 23:case"end":return e.stop()}}),e,null,[[4,20]])})));return function(n){return e.apply(this,arguments)}}(),200,{leading:!1,trailing:!0}),this.handlePasteRecordAfterApply=function(e,r){var o={data:e},i=new Promise((function(e){return Object.assign(o,{resolve:e})}));return n.waits.push(o),n.debounceFetch(r),i},this.showPopUP=function(e,n){e.length&&(Object(f.T)("ccm_doc_task_paste_panel_view",Object(h.F3)(),{}),document.body.classList.add("task-block-paste-menu-opened"),Object(_.c)(e,n,function(){var r=a()(i.a.mark((function r(o){return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:Object(f.P)("ccm_doc_task_paste_panel_click",Object(h.F3)(),{click:o,target:"none"}),"only_paste"===o&&Object(b.J)(e.map((function(e){return n.getBlockViewByBlockIdNotCheck(e.blockId)})),n);case 2:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),(function(){return document.body.classList.remove("task-block-paste-menu-opened")})))}})},dx_fNdX:function(e,n,r){"use strict";r.d(n,"o",(function(){return a}));var o=r("dx_kZ3l"),i=r("dx_zghO"),c=r("dx_ppc6"),a=function(e,n,r){var a;if(r.target===r.currentTarget){var l=e.getSelection();if(!n.isFocus(e.zoneId)||(null===l||void 0===l?void 0:l.isCollapsed())){var s=e.editorAPI.getService(c.S).getSelection();if(1!==s.length||s[0].type!==i.j.TEXT||s[0].id!==e.id){var u=null===(a=e.zoneState.getContainer())||void 0===a?void 0:a.getBoundingClientRect();u&&(r.pageX<u.left?Object(o.u)(e,!0):r.pageX>u.left+u.width&&Object(o.Z)(e))}else n.focus(e.zoneId)}}}},dx_fTg3:function(e,n,r){"use strict";r.d(n,"C",(function(){return g})),r.d(n,"J",(function(){return y})),r.d(n,"c",(function(){return _})),r.d(n,"m",(function(){return k}));var o,i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_uxuX"),u=r("dx_UtDZ"),d=r("dx_qx8A"),f=r.n(d);function h(e){s.eventEmitter.emit("".concat(s.FOLLOW_EVENT,":").concat(s.MAGIC_SHARE_INFO),e)}function p(e){var n=f.a.getState().entities.objs;"function"===typeof n.get&&(n=n.toJS());for(var r=Object.keys(n),o=0;o<r.length;o+=1){var i=r[o];if(i.includes(e)&&n[i])return n[i].name}return""}var v=0;function g(e){return b.apply(this,arguments)}function b(){return(b=l()(c.a.mark((function e(n){var r,o,i,a,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.map((function(e){var n=e.text,r=e.level;return{id:e.recordId,text:n,level:r}})),o=Object(u.getToken)(),i=p(o),a=0;case 4:if(i||!(++a<5)){e.next=10;break}return e.next=7,new Promise((function(e){return setTimeout(e,1e3*a)}));case 7:i=p(o),e.next=4;break;case 10:l=v||Math.round(Date.now()-performance.now()),h({eventType:1,objToken:o,timestamp:l,info:{catalogues:r,title:i}});case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e){var n=e.map((function(e){var n=e.text,r=e.level;return{id:e.recordId,text:n,level:r}}));0!==n.length&&h({eventType:2,objToken:Object(u.getToken)(),timestamp:Date.now(),info:{catalogues:n}})}null===(o=window.vcSdk)||void 0===o||o.on("BEFORE_RENDER",(function(){v=Date.now()}));var m=new Map;function _(){m.clear()}function k(e,n,r){var o=n.addedComments,i=n.updatedComments;r.isInit?o.forEach((function(e){var n=e.commentId,r=e.replyList;m.has(n)||m.set(n,new Set);var o=m.get(n);r.forEach((function(e){var n=e.replyId;return o.add(n)}))})):i.forEach((function(e){var n=e.commentId,r=e.replyList;m.has(n)||m.set(n,new Set);var o=m.get(n);r.forEach((function(e){var r,i=e.replyId,c=e.userId;o.has(i)||(r={user_id:c,comment_id:n,reply_id:i},h({eventType:3,objToken:Object(u.getToken)(),timestamp:Date.now(),info:r}),o.add(i))}))}))}},dx_fb2c:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return S}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_w86w"),p=r("dx_UtDZ"),v=r("dx_YzVl"),g=r("dx_MoY1"),b=r("dx_yzqx"),y=r("dx_jBAU"),m=r("dx_e8ez"),_=r("dx_NsKf"),k=r("dx_ZG9w"),O=r("dx_QRvo"),x=r("dx_lBTJ"),E=r("dx_nFCg"),S=function(){function e(n){var r=this;u()(this,e),this.blockManager=void 0,this.uploader=void 0,this.taskInfoMap=new Map,this.canLeavePage=function(){return 0===r.taskInfoMap.size},this.blockManager=n,this.uploader=new p.Uploader({mountPoint:O.s,preventBeforeUnload:{enable:!0,unsavedTip:t("upload_manager.in_progress_upload_tip")},handlers:{onTaskAdded:this.onTaskAdded.bind(this),onFailure:this.onUploadFailure.bind(this),onSuccess:this.onUploadSuccess.bind(this),onProgress:this.onUpdateUploadProgress.bind(this)}}),p.resourceGuard.addCanLeavePageHandler(this.canLeavePage)}return f()(e,[{key:"filterFiles",value:function(e){return e instanceof FileList&&(e=Array.from(e)),e.filter((function(e){return!!Object(E.b)(e)||(Object(v.F)({type:"error",content:Object(E.G)(e)},!1),!1)}))}},{key:"selectFileAndUpload",value:function(){var e=l()(c.a.mark((function e(n,r,o){var i,a,l,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(h.L)({allowMultiple:!0});case 2:i=e.sent,a=i.files,l=i.event,(s=this.filterFiles(a)).length>0&&this.uploadMulti({files:s,insertDestination:n,event:l,source:o,replaceOriginBlock:r});case 7:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"uploadMulti",value:function(){var e=l()(c.a.mark((function e(n){var r,i,a,s,u,d,f,h,p,v,b,y,O,E,S,C=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.files,i=n.insertDestination,a=n.event,s=n.source,u=n.replaceOriginBlock,d=this.blockManager,f=i.targetParentBlockId,h=i.position,p=d.getRecordByBlockId(f).id,v=[],y=d.applyTransaction("insertMultiFileBlocks",(function(e){var n=u.needReplace,i=u.blockId;if(n&&i){var c=d.getRecordByBlockId(i).id;d.getBlockModelByBlockId(i).children.length>0?(f=i,p=c,h=0):(Object(g.y)(e,[i],d),h--)}r.forEach((function(n){var r=Object(m.x)(n),o=Object(m.E)(e,r,p,h);v.push(o),h++}));var a=Object(_.u)(),l=Object(g.l)(e,p,h,[a]),s=o()(l,1);b=s[0]}),{afterTransactionAccepted:function(){var e=l()(c.a.mark((function e(){var n,i,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(x.v)();case 2:n=e.sent,i=n.JobType,l=n.ImportEventSource,r.forEach((function(e,n){var r=o()(v[n],2)[1];C.setTaskInfo(e,{recordId:r,source:s,startTime:performance.now()});var c=C.blockManager.rootRecordId;C.uploader.upload(e,a,{parentToken:r,jobType:i.Upload,eventSource:l.Space,bizExtra:{drive_route_token:c}})}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),!(O=b&&this.blockManager.getBlockModelsByRecordId(b)[0])||d.hasBlockViewByBlockId(O.id)){e.next=12;break}return e.next=10,d.layoutManager.scrollToSelection(O.id);case 10:e.next=14;break;case 12:return e.next=14,y;case 14:v.forEach((function(e){var n=o()(e,2),r=(n[0],n[1]);Object(m.qC)(r,d)})),b&&(E=d.getBlockModelByBlockId(f).children[h],S=d.getBlockViewByBlockIdNotCheck(E.id),Object(k.U)(S)&&S.model.setSelection({start:0,len:0},!0));case 16:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"uploadOnly",value:function(){var e=l()(c.a.mark((function e(n){var r,o,i,a,l,s,u,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.file,o=n.recordId,i=n.event,a=n.source,e.next=3,Object(x.v)();case 3:l=e.sent,s=l.JobType,u=l.ImportEventSource,this.setTaskInfo(r,{recordId:o,source:a,startTime:performance.now()}),d=this.blockManager.rootRecordId,this.uploader.upload(r,i,{parentToken:o,jobType:s.Upload,eventSource:u.Space,bizExtra:{drive_route_token:d}});case 9:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"onTaskAdded",value:function(e){var n=(e=e).file;this.setTaskInfo(n,{task:e})}},{key:"onUploadSuccess",value:function(e){var n,r=e=e,o=r.file,i=r.fileToken,c=null===(n=this.taskInfoMap.get(o))||void 0===n?void 0:n.recordId;i&&c&&Object(m.Y)(i,c,this.blockManager),this.taskInfoMap.delete(o)}},{key:"onUploadFailure",value:function(e,n){var r,o=(e=e).file,i=null===(r=this.taskInfoMap.get(o))||void 0===r?void 0:r.recordId;i&&(n!==y.g.USER_DRIVE&&n!==y.g.USER_NO_DRIVE||b.S.isMobile?n!==y.g.SPACE||b.S.isMobile?Object(v.F)({type:"error",content:"\u300c".concat(Object(E.C)(o.name),"\u300d ").concat(t("mention.uploader_failure"))},!1):p.showPicLimitDialog&&Object(p.showPicLimitDialog)(p.PicLimitType.STORAGE_SPACE,{type:p.StorageSpaceType.UPLOAD_FILE}):p.showUserLimitDialog&&Object(p.showUserLimitDialog)(y.O.FILE),Object(m.I)(i,this.blockManager)),this.taskInfoMap.delete(o)}},{key:"onUpdateUploadProgress",value:function(e){var n,r=e=e,o=r.file,i=r.progress,c=null===(n=this.taskInfoMap.get(o))||void 0===n?void 0:n.recordId;c&&Object(m.j)(c,i)}},{key:"getTaskInfoById",value:function(e){return Array.from(this.taskInfoMap.values()).find((function(n){return n.recordId===e}))}},{key:"pause",value:function(e){var n=this.getTaskInfoById(e);n&&n.task&&this.uploader.pause(n.task)}},{key:"retry",value:function(e){var n=this.getTaskInfoById(e);n&&n.task&&this.uploader.retry(n.task)}},{key:"cancel",value:function(e){var n=this.getTaskInfoById(e);n&&n.task&&(this.uploader.cancel(n.task),this.taskInfoMap.delete(n.task.file))}},{key:"setTaskInfo",value:function(e,n){var r=this.taskInfoMap.get(e);this.taskInfoMap.set(e,Object.assign({},r,n))}},{key:"getTaskInfo",value:function(e){return this.taskInfoMap.get(e)}},{key:"destroy",value:function(){this.taskInfoMap.clear(),this.uploader.destroy(),p.resourceGuard.removeCanLeavePageHandler(this.canLeavePage)}}]),e}()}).call(this,r("dx_E9Eu"))},dx_ffjs:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return W}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_lSNA"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_W7W2"),p=r.n(h),v=r("dx_a1gu"),g=r.n(v),b=r("dx_Nsbk"),y=r.n(b),m=r("dx_UtDZ"),_=r("dx_h6a8"),k=r("dx_yzqx"),O=r("dx_WRwK"),x=r("dx_eSV8"),E=r("dx_d2dg"),S=r("dx_B28d"),C=r("dx_vOIB"),I=r("dx_ZG9w"),B=r("dx_zghO"),T=r("dx_cQo6"),w=r("dx_n3n9"),R=r("dx_bkVC"),M=r("dx_HirW"),j=r("dx_tVvo"),D=r("dx_ZViv"),A=r("dx_tsDa"),P=r("dx_ZxNV"),L=r("dx_UydN"),N=r("dx_JgOH"),F=r("dx_Y27Y");function U(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function H(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?U(Object(r),!0).forEach((function(n){l()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function V(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=y()(e);if(n){var i=y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return g()(this,r)}}var W=function(e){p()(r,e);var n=V(r);function r(){var e;u()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).format=F.L.DOCX_RECORD,e.getCopyPayload=function(n,r){var o=r.type,i=r.id;switch(o){case S.B.ISV:var c=e.blockManager.getBlockViewByBlockId(i);n[c.record.id]={schema:c.onCopy()};break;case S.B.TEXT:var a=e.blockManager.getBlockModelByBlockId(i);n[a.recordId]={level:Object(C.q)(a)};break;case S.B.TASK:n[r.record.id]=r.onCopy()}},e}return f()(r,[{key:"shouldPaste",value:function(e){return!0}},{key:"shouldCopy",value:function(e){var n=this;return!!this.selectionAPI.isTextSelectionAcrossBlocks(e)||0!==e.filter((function(e){if(e.type===B.j.BLOCK)return!0;var r=n.blockManager.getBlockViewByBlockId(e.id),o=e.selection&&e.selection.start===e.selection.end;return!(!Object(I.U)(r)||!o)})).length}},{key:"onCopyBlock",value:function(e){if(e.id===this.blockManager.rootBlockId){var n=this.blockManager.getRecord(this.blockManager.rootRecordId).snapshot;return l()({},this.blockManager.rootRecordId,{id:this.blockManager.rootRecordId,snapshot:H(H({},n),{},{children:[]})})}return Object(M.mD)(this.blockManager,e.id)}},{key:"onDelete",value:function(){var e=c()(o.a.mark((function e(n){var r,i,c,a,l=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.map((function(e){return e.id})),!Object(A.U9)(this.blockManager,r,this.selectionAPI)){e.next=3;break}return e.abrupt("return");case 3:if(i=this.selectionAPI.isBlockSelection(n),c=null,!r.length){e.next=8;break}return e.next=8,this.blockManager.applyTransaction("flowbaseRecordOnDelete",(function(e){l.selectionAPI.isTextSelectionAcrossBlocks(n)?c=Object(L.m)(e,l.blockManager.editorAPI):(i&&(c=Object(M.a)(r,l.blockManager)),r.forEach((function(n){var r=l.blockManager.getBlockModelByBlockId(n);e.removeChildren(r.parent.recordId,[r.recordId])})))}));case 8:if(!(k.S.isMobile&&k.S.isLark&&i)){e.next=11;break}return this.selectionAPI.removeAllSelection(),e.abrupt("return");case 11:c&&(a=Object(M.J)(c,this.blockManager))&&this.selectionAPI.setSelection([a]);case 12:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"onPaste",value:function(e,n,r,o){var i=o||JSON.parse(n);Object(M.A)(i.extra),i.payloadMap=H(H({},Object(T.Z6)(i.recordMap,r)),i.payloadMap||{}),Object(j.s)(Object.assign({},this.options,{proxyClipboardData:r}),i,this.format)}},{key:"onCopy",value:function(e,n,r){var o=this,i=new O.n(this.blockManager,r,e),c=this.blockManager.rootRecordId,a={blockIds:i.getBlockIds(),recordIds:i.getRecordIds(),recordMap:i.getRecordMap(),payloadMap:{},hasNoTokenBlock:!1,lastNoTokenBlockType:"",parentId:null,rootId:c,extra:null};return Object(M.H)(a.recordIds,a.recordMap,(function(e){o.handleBlockNode(e,a)})),Object(D.r)(this.blockManager,a.recordIds,a.recordMap),this.updateAncestorsContext(a),a.extra=Object(M.m)(a.recordMap),Object(A.Z)(a.recordIds,a.recordMap,this.blockManager),a.hasNoTokenBlock?m.Toast.info({content:a.lastNoTokenBlockType===S.B.TASK?t("LarkCCM_Tasks_TaskBeingCreatedTryAgainLater_Toast"):t("CreationDoc_Docs_Copy_FailedLoadingContent"),key:"COPY_NO_TOKEN_BLOCK_TIPS",duration:5e3}):m.Toast.remove("COPY_NO_TOKEN_BLOCK_TIPS"),{isCut:n,rootId:c,parentId:a.parentId,blockIds:a.blockIds,recordIds:a.recordIds,recordMap:a.recordMap,payloadMap:a.payloadMap,extra:a.extra,pasteFlag:Object(R.A)()}}},{key:"filterAttrs",value:function(e,n){var r=n[e],o=F.E[null===r||void 0===r?void 0:r.snapshot.type];null===o||void 0===o||o.forEach((function(e){delete r.snapshot[e]}))}},{key:"handleBlockNode",value:function(e,n){try{var r=n.recordMap,o=n.payloadMap,i=this.blockManager.getBlockModelsByRecordId(e)[0],c=this.blockManager.getBlockViewByBlockId(i.id);Object(E.k)(c)&&c.model.translateStatus&&(r[i.recordId]=Object(P.L)(this.blockManager,r[i.recordId])),this.filterAttrs(e,r),this.getCopyPayload(o,i),Object(N.n)(i,this.blockManager)||(n.hasNoTokenBlock=!0,n.lastNoTokenBlockType=i.type,this.removeUnCopyableBlockContext(i,n))}catch(a){Object(x.n)("copy block with error! block id: ".concat(e,"; ").concat(a))}}},{key:"removeUnCopyableBlockContext",value:function(e,n){delete n.recordMap[e.recordId];var r=n.blockIds.indexOf(e.id);r>0&&n.blockIds.splice(r,1);var o=n.recordIds.indexOf(e.recordId);o>0&&n.recordIds.splice(o,1)}},{key:"updateAncestorsContext",value:function(e){var n=this.blockManager.getBlockModelByBlockId(e.blockIds[0]);if(n&&n.parent){var r=n.parent.record,o=Object(_.cloneDeep)({id:r.id,snapshot:r.snapshot}),i=o.id;e.parentId=o.id,Object.assign(e.recordMap,l()({},i,o))}}}]),r}(w.S)}).call(this,r("dx_E9Eu"))},dx_fgPx:function(e,n,r){},dx_fiWO:function(e,n,r){"use strict";r.d(n,"l",(function(){return h})),r.d(n,"N",(function(){return p}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_NOtv"),a=r.n(c),l=r("dx_cDcd"),s=r("dx_a3US"),u=r("dx_D8nn"),d=a()("table:useWillDeleteCell"),f=new u.i;function h(e){f.emit(u.p.TABLE.TABLE_WILL_DELETE_CELL,e)}function p(e){var n=Object(l.useState)(!1),r=i()(n,2),o=r[0],c=r[1],a=Object(s.r)((function(n){var r=n.willDelete,o=n.caller;e===n.tableId&&(d("table=%s %s.setTableWillDeleteCell %s",e,o,r),c(r))}));return Object(l.useEffect)((function(){return f.on(u.p.TABLE.TABLE_WILL_DELETE_CELL,a),function(){f.off(u.p.TABLE.TABLE_WILL_DELETE_CELL,a)}}),[a]),o}},dx_flvg:function(e,n,r){},dx_fs49:function(e,n,r){"use strict";r.d(n,"q",(function(){return a})),r.d(n,"u",(function(){return l})),r.d(n,"v",(function(){return s})),r.d(n,"d",(function(){return u})),r.d(n,"e",(function(){return d}));var o=r("dx_p3b8"),i=r("dx_B28d"),c=r("dx_NMuw");function a(e){return e.length>0&&e[0].sourceLevel===c.z}function l(e){var n=e.length,r=1===n&&a(e);return 0===n||r}function s(e,n){var r=e.isBoundaryIntersection,i=n.isHovered,c=u(e,n),a=c.baseForceAbstract,l=c.baseIsAbstract,s=a||r,d=l||s,f=!s,h=o.n.FULL_NORMAL;return d&&(h=i?o.n.FULL_FLOATING:o.n.ABSTRACT),{baseForceAbstract:a,baseIsAbstract:l,showMode:h,canShowPin:f,isShowFull:h!==o.n.ABSTRACT,floating:h===o.n.FULL_FLOATING}}function u(e,n){var r=e.isForceShowAbstract,o=n.isPinned,i=n.isReady,c=n.catalogueItems,a=i&&l(c),s=r||a;return{baseForceAbstract:s,baseIsAbstract:s||!o}}function d(e){return 0===e?i.B.PAGE:Object(i.nQ)(e)}},dx_furZ:function(e,n,r){"use strict";function o(e){return e.docx.history.isShow}r.d(n,"m",(function(){return o}))},dx_g14w:function(e,n,r){"use strict";r.d(n,"H",(function(){return u})),r.d(n,"I",(function(){return d})),r.d(n,"x",(function(){return f})),r.d(n,"S",(function(){return h})),r.d(n,"e",(function(){return p})),r.d(n,"M",(function(){return v})),r.d(n,"o",(function(){return g})),r.d(n,"q",(function(){return b}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_UtDZ"),a=r("dx_yzqx"),l=r("dx_ukKW"),s=r("dx_CZKf");function u(e){if(!e)return"";var n=e.type,r=e.token,o=e.mime_type;return n===s.i.Other?"":h(r,o)}function d(e){if(!e)return"";var n=e.type,r=e.token,o=e.url,i=e.mime_type;return n===s.i.Other?o:f(r,i)}function f(e,n){if(!e)return"";var r=new URL(Object(c.prependAPI)("".concat("/api/box/stream/download/all","/").concat(e,"/"),"drive_api"));a.S.isMobile&&r.searchParams.append("type","image"),a.S.isMobile&&r.searchParams.append("useOrigin","1"),n&&a.S.isMobile&&r.searchParams.append("contentType",n.split("/")[1]||"");var o=r.toString();return o=Object(l.LW)(o)}function h(e,n){if(!e)return"";var r={width:360,height:360,policy:"near"};n&&a.S.isMobile&&(r.contentType=n.split("/")[1]||"");var o=Object(c.prependAPI)("".concat("/api/box/stream/download/v2/cover","/").concat(e,"?").concat(Object(l.m)(r)),"drive_api");return o=Object(l.LW)(o)}var p=function(e){return!!e&&!!e.type},v=function(e){var n;return p(e)?(n={type:e.type,offset_ratio_x:e.offset_ratio_x,offset_ratio_y:e.offset_ratio_y},i()(n,g(e.type),b(e)),i()(n,"src",d(e)),i()(n,"lightSrc",u(e)),i()(n,"mime_type",e.mime_type),i()(n,"status",e.status),n):null};function g(e){return e===s.i.Preset||e===s.i.Customize?"token":"url"}function b(e){var n=e.type,r=e.token,o=e.url;return n===s.i.Preset||n===s.i.Customize?r:o}},dx_g1Ip:function(e,n,r){"use strict";(function(t){r.d(n,"o",(function(){return d})),r.d(n,"a",(function(){return f})),r.d(n,"Y",(function(){return h})),r.d(n,"J",(function(){return p})),r.d(n,"t",(function(){return v})),r.d(n,"q",(function(){return g}));var e,o,i,c,a,l=r("dx_lSNA"),s=r.n(l),u=r("dx_u6uu"),d=(e={},s()(e,u.C.bilibili,"https://www.bilibili.com/video/BV1Hi4y1w7V7"),s()(e,u.C.youku,"https://v.youku.com/v_show/id_XMTY1MjYwODYzNg==.html?spm=a2h0j.11185381.listitem_page1.5!15~A&&s=9a35f8960f3c11e5a080"),s()(e,u.C.youtube,"https://youtu.be/Ajo5v1zxrHE"),s()(e,u.C.airtable,"https://airtable.com/shrs4PhummCCIHXXT"),s()(e,u.C.baidumap,"https://j.map.baidu.com/6jqkO"),s()(e,u.C.autonavi,"https://www.amap.com/place/B000A83C1S"),s()(e,u.C.gmaps,"https://www.google.com/maps/place/Central+Park/@40.7828647,-73.9675438,17z"),s()(e,u.C.xigua,"https://www.ixigua.com/6763174234282787341"),s()(e,u.C.tiktok,"https://t.tiktok.com/i18n/share/video/6584979523391982853"),s()(e,u.C.figma,"https://www.figma.com/file/LKQ4FJ4bTnCSjedbRpk931/Sample-File"),s()(e,u.C.modao,"https://modao.cc/app/45ed43a9277e1cdb844b10e8e8890cf177e6ea25?simulator_type=device&sticky"),s()(e,u.C.canva,"https://www.canva.cn/design/DAERsJN19ZM/view"),s()(e,u.C.jcode,"https://code.juejin.cn/pen/7111233570496053255"),s()(e,u.C.codepen,"https://codepen.io/jackrugile/pen/acAgx"),s()(e,u.C.jinshuju,"https://jinshuju.net/f/tRreUu"),s()(e,u.C.feishu_survey,"https://wenjuan.feishu.cn/m?t=sVOKVVz7rwpi-ay5n"),s()(e,u.C.lark_survey,"https://survey.larksuite.com/m/cfm?t=sVF8j1fIlrpi-ff3n"),e),f=(o={},s()(o,u.C.bilibili,t("CreationDocs_Embeds_PasteLinkBilibili_Options")),s()(o,u.C.youku,t("CreationDocs_Embeds_PasteLinkYouku_Options")),s()(o,u.C.youtube,t("CreationDocs_Embeds_PasteLinkYoutube_Options")),s()(o,u.C.airtable,t("CreationDocs_Embeds_PasteLinkAirtable_Options")),s()(o,u.C.baidumap,t("CreationDocs_Embeds_PasteLinkBaiduMap_Options")),s()(o,u.C.autonavi,t("CreationDocs_Embeds_PasteLinkGaodeMap_Options")),s()(o,u.C.gmaps,t("CreationDocs_Embeds_PasteLinkGoogleMap_Options")),s()(o,u.C.xigua,t("CreationDocs_Embeds_PasteLinkXigua_Options")),s()(o,u.C.tiktok,t("CreationDocs_Embeds_PasteLinkTiktok_Options")),s()(o,u.C.figma,t("CreationDocs_Embeds_PasteLinkFigma_Options")),s()(o,u.C.modao,t("CreationDocs_Embeds_PasteLinkModao_Options")),s()(o,u.C.canva,t("CreationDocs_Embeds_PasteLinkCanva_Options")),s()(o,u.C.jcode,t("LarkCCM_Docx_BlockName_PasteLink")),s()(o,u.C.codepen,t("CreationDocs_Embeds_PasteLinkCodePen_Options")),s()(o,u.C.jinshuju,t("CreationDocs_Embeds_PasteLinkJinshuju_Options")),s()(o,u.C.feishu_survey,t("CreationDocs_Embeds_PasteLinkFeishuSurvey_Options")),s()(o,u.C.lark_survey,t("CreationDocs_Embeds_PasteLinkLarkSurvey_Options")),o),h=(i={},s()(i,u.C.bilibili,t("CreationDocs_Embeds_bilibiliLink_Placeholder")),s()(i,u.C.youku,t("CreationDocs_Embeds_YoukuLink_Placeholder")),s()(i,u.C.youtube,t("CreationDocs_Embeds_YoutubeLink_Placeholder")),s()(i,u.C.airtable,t("CreationDocs_Embeds_AirtableLink_Placeholder")),s()(i,u.C.baidumap,t("CreationDocs_Embeds_BaiduMapLink_Placeholder")),s()(i,u.C.autonavi,t("CreationDocs_Embeds_GaodeMapLink_Placeholder")),s()(i,u.C.gmaps,t("CreationDocs_Embeds_GoogleMapsLink_Placeholder")),s()(i,u.C.xigua,t("CreationDocs_Embeds_XiguaLink_Placeholder")),s()(i,u.C.tiktok,t("CreationDocs_Embeds_TikTokLink_Placeholder")),s()(i,u.C.figma,t("CreationDocs_Embeds_FigamaLink_Placeholder")),s()(i,u.C.modao,t("CreationDocs_Embeds_ModaoLink_Placeholder")),s()(i,u.C.canva,t("CreationDocs_Embeds_CanvaLink_Placeholder")),s()(i,u.C.jcode,t("LarkCCM_Docx_BlockName_PlaceHolderLink")),s()(i,u.C.codepen,t("CreationDocs_Embeds_CodePenLink_Placeholder")),s()(i,u.C.jinshuju,t("CreationDocs_Embeds_JinshujuLink_Placeholder")),s()(i,u.C.feishu_survey,t("CreationDocs_Embeds_FeishuSurveyLink_Placeholder")),s()(i,u.C.lark_survey,t("CreationDocs_Embeds_LarkSurveyLink_Placeholder")),i),p=(c={},s()(c,u.C.xigua,t("LarkCCM_DocX_HelpCenter_Xigua_Feishu")),s()(c,u.C.bilibili,t("LarkCCM_DocX_HelpCenter_Xigua_Feishu")),s()(c,u.C.youku,t("LarkCCM_DocX_HelpCenter_Xigua_Feishu")),s()(c,u.C.tiktok,t("LarkCCM_DocX_HelpCenter_Xigua_Feishu")),s()(c,u.C.youtube,t("LarkCCM_DocX_HelpCenter_Xigua_Feishu")),s()(c,u.C.airtable,t("LarkCCM_DocX_HelpCenter_Airtable_Feishu")),s()(c,u.C.baidumap,t("LarkCCM_DocX_HelpCenter_BaiduMap_Feishu")),s()(c,u.C.autonavi,t("LarkCCM_DocX_HelpCenter_BaiduMap_Feishu")),s()(c,u.C.figma,t("LarkCCM_DocX_HelpCenter_Figma_Feishu")),s()(c,u.C.modao,t("LarkCCM_DocX_HelpCenter_MockingBot _Feishu")),s()(c,u.C.canva,t("LarkCCM_DocX_HelpCenter_Canva_Feishu")),s()(c,u.C.codepen,t("LarkCCM_DocX_HelpCenter_Codepen_Feishu")),s()(c,u.C.jinshuju,t("LarkCCM_DocX_HelpCenter_Jinshuju_Feishu")),s()(c,u.C.feishu_survey,t("LarkCCM_DocX_HelpCenter_Survey_Feishu")),s()(c,u.C.gmaps,t("LarkCCM_DocX_HelpCenter_GoogleMap_Feishu")),s()(c,u.C.jcode,t("LarkCCM_Docx_BlockName_PlaceHolderLink_Feishu")),c),v=(a={},s()(a,u.C.xigua,t("LarkCCM_DocX_HelpCenter_Xigua_Lark")),s()(a,u.C.bilibili,t("LarkCCM_DocX_HelpCenter_Xigua_Lark")),s()(a,u.C.youku,t("LarkCCM_DocX_HelpCenter_Xigua_Lark")),s()(a,u.C.codepen,t("LarkCCM_DocX_HelpCenter_Codepen_Lark")),s()(a,u.C.airtable,t("LarkCCM_DocX_HelpCenter_Airtable_Lark")),s()(a,u.C.figma,t("LarkCCM_DocX_HelpCenter_Figma_Lark")),s()(a,u.C.gmaps,t("LarkCCM_DocX_HelpCenter_GoogleMap_Lark")),s()(a,u.C.jinshuju,t("LarkCCM_DocX_HelpCenter_Jinshuju_Feishu")),a),g="iframe-container"}).call(this,r("dx_E9Eu"))},dx_g499:function(e,n,r){"use strict";r.d(n,"h",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("event-emitter")},dx_g9Aj:function(e,n,r){"use strict";r.d(n,"Q",(function(){return l}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=function(){function e(n){var r=this;i()(this,e),this.scroller=n,this.isScrolling=!1,this.disableHandleScrolling=!1,this.timer=void 0,this.isSkip=void 0,this.handleScroll=function(){r.disableHandleScrolling||(r.isSkip?r.isSkip=!1:(r.isScrolling=!0,r.timer&&cancelAnimationFrame(r.timer),r.timer=window.requestAnimationFrame((function(){r.timer=window.requestAnimationFrame((function(){r.timer=null,r.isScrolling=!1}))}))))},this.clearSkip=function(){r.isSkip=!1},this.scroller.addEventListener("scroll",this.handleScroll)}return a()(e,[{key:"getIsScrolling",value:function(){return!this.isSkip&&this.isScrolling}},{key:"disableScrollingDetector",value:function(){this.disableHandleScrolling=!0}},{key:"enableScrollingDetector",value:function(){this.disableHandleScrolling=!0}},{key:"getScrollTop",value:function(){return this.scroller instanceof Window?this.scroller.scrollY:this.scroller.scrollTop}},{key:"destroy",value:function(){this.scroller.removeEventListener("scroll",this.handleScroll)}},{key:"skipThisDetect",value:function(){this.isSkip=!0}}]),e}()},dx_gA4Q:function(e,n,r){"use strict";r.d(n,"h",(function(){return B}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_iWIM"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_e4eN"),m=r("dx_M30o"),_=r("dx_alfx"),k=r("dx_bKfB"),O=r("dx_IVxn"),x=r("dx_kZ3l");function E(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return S(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function S(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function C(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var I="0",B=function(e){h()(r,e);var n=C(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"applyDeltaWithClone",value:function(e){var n=this.clone();return n.apply(e,n.applyCallback)}},{key:"split",value:function(e){var n=this.clone(),r=Object(x.A)(e),o=r.zoneId,i=r.start,c=r.len,a=new y.m({zoneId:o}).retain(i).delete(n.totalWidth()-i-1),l=new y.m({zoneId:o}).delete(i+c);return[n.apply(a,n.applyCallback),n.apply(l,n.applyCallback)]}},{key:"remove",value:function(e){var n=this.clone(),r=Object(x.A)(e),o=r.zoneId,i=r.start,c=r.len,a=n.getModelText().length-1,l=c;a<c&&(l=a,console.log("remove length error"));var s=new y.m({zoneId:o}).retain(i).delete(l);return n.apply(s,n.applyCallback)}},{key:"merge",value:function(e){var n=this.clone(),r=Object(_.Z)(e.initialAttributedTexts,e.apool).get(I),o=new y.m({zoneId:n.getZoneId()}).retain(n.totalWidth()-1).concat(r);return n.apply(o,n.applyCallback)}},{key:"replace",value:function(e,n,r){var o=this.clone(),i=Object(x.A)(e),c=i.zoneId,a=i.start,l=i.len,s=new y.m({zoneId:c}).retain(a).delete(l).insert(n,r);return o.apply(s,o.applyCallback)}},{key:"multiReplace",value:function(e){e.forEach((function(e){e.toBeReplaced=Array.isArray(e.toBeReplaced)?e.toBeReplaced:[e.toBeReplaced]})),e=e.sort((function(e,n){return e.range[0]-n.range[0]}));var n,r=-1,o=0,i=this.clone(),c=E(e);try{var a=function(){var e=n.value,c=e.range,a=e.toBeReplaced;if(c[0]<r)throw new Error("range overlap");var l=[c[0]+o,c[1]+o],s=Object(x.A)(l),u=s.zoneId,d=s.start,f=s.len,h=new y.m({zoneId:u}).retain(d).delete(f);a.forEach((function(e){h.insert(e.text,e.mark)})),i=i.apply(h,i.applyCallback);var p=a.reduce((function(e,n){return n.text.length+e}),0),v=c[1]-c[0];o+=p-v,r=c[1]};for(c.s();!(n=c.n()).done;)a()}catch(l){c.e(l)}finally{c.f()}return i}},{key:"toAttributeText",value:function(){var e,n,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=this.getContent(),c=o.ops,a=c.length,l=a-1;"\n"===(null===(e=c[l])||void 0===e?void 0:e.insert)&&(null===(n=c[l].attributes)||void 0===n?void 0:n.fixEnter)&&(a-=1);var s=new y.m({zoneId:I,ops:c.slice(0,a)}),u=new m.q(i()({},I,s));return Object(O.f)(u,{filterLocalAttributes:!r,filterInitialAttributedText:!0})}},{key:"cloneEmptyState",value:function(){var e=new r(this.getZoneId(),d()(b()(r.prototype),"cloneEmptyState",this).call(this).getContent());return e._node=this._node,e.placeholder=this.placeholder,e}},{key:"applyCallback",value:function(){}}]),r}(k.h)},dx_gDjg:function(e,n,r){"use strict";(function(t){r.d(n,"O",(function(){return _})),r.d(n,"m",(function(){return k})),r.d(n,"lQ",(function(){return x})),r.d(n,"A",(function(){return S})),r.d(n,"J",(function(){return C})),r.d(n,"s",(function(){return I})),r.d(n,"e",(function(){return B})),r.d(n,"G",(function(){return T})),r.d(n,"P",(function(){return w})),r.d(n,"n",(function(){return R})),r.d(n,"f",(function(){return M})),r.d(n,"l",(function(){return j}));var e=r("dx_lSNA"),o=r.n(e),i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_Siqi"),u=r("dx_N1zS"),d=r("dx_UtDZ"),f=r("dx_h6a8"),h=r("dx_k64k"),p=r("dx_AAGW"),v=r("dx_UTG8"),g=r("dx_FHaN"),b=r("dx_lSlT");function y(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function m(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?y(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function _(e){return Object(s.M)(e,!1)}function k(e){return O.apply(this,arguments)}function O(){return(O=l()(c.a.mark((function e(n){var r,o,i,a,l,s,h,v;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.token,o=n.mentionTypeNum,i=n.suiteTypeNum,a=n.url,r&&!Object(f.isUndefined)(o)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,Object(u.R)([{typeNum:i,token:r}],{post:function(e,n){return p.S.post(e,JSON.stringify(n),{headers:{"Content-Type":"application/json"},baseURL:"/space"})}});case 5:if(l=e.sent,s=l[r]){e.next=9;break}return e.abrupt("return");case 9:return s.tenant_id||console.error("[Mention Doc] getMeta api response without tenant_id"),h=s.title||Object(d.getUnnamedTitle)(i)||t("common.unnamed_document"),v={file_type:o,token:r,tenant_id:s.tenant_id,raw_url:a,title:h},b.S.setDocInfo(r,{title:h,url:a,mentionType:o}),e.abrupt("return",v);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,n,r){return E.apply(this,arguments)}function E(){return(E=l()(c.a.mark((function e(n,r,o){var i,a,l,s,u,d,f,h,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.data,a=i.raw_url,l=i.token,s=i.title,u=i.file_type,d=n.id,f=_(a)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,k(m({},f));case 6:if(h=e.sent){e.next=10;break}return b.S.setDocInfo(l,{title:s,url:a,mentionType:u}),e.abrupt("return");case 10:return p=o.getRecord(r).snapshot.text,v.InputPipe.replaceMark(p,g.O,(function(e,n){var r=JSON.parse(n);return r.id!==d?n:(r.data=h,JSON.stringify(r))})),e.next=14,o.applyTransaction("replaceInlineDocMeta",(function(e){e.replace(r,["text"],p)}),{undoable:!1});case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,n,r){return n===d.TYPE_ENUM.DOCX?b.S.getTitle(e)||r||t("common.unnamed_document"):r||""}function C(e){var n=e.title,r=e.token;return e.type===d.TYPE_ENUM.DOCX?n||b.S.getTitle(r)||"":n}var I=function(e){return e===g.J.UNREADABLE_NOT_ALLOW_APPLY||e===g.J.NETWORK_ERROR},B=function(e){return I(e)||e===g.J.LOADING},T=function(e){return e===g.J.UNREADABLE_ALLOW_APPLY},w=function(e,n){return I(Object(h.S)(d.store.getState(),e,n))},R=function(e){return e.config.get("noteToken")||e.config.get("token")};function M(e,n){var r=t(n?"LarkCCM_Docs_Perm_DisableViewDescription_InText_Tooltip_1_Mobile":"LarkCCM_Docs_Perm_DisableViewDescription_InText_Tooltip_1_Common");return e===g.J.NETWORK_ERROR?t("LarkCCM_Docs_Perm_DisableViewDescription_InText_TimeOut_1_Common"):r}function j(e){return d.MENTION_TO_SUITE[e]||e}}).call(this,r("dx_E9Eu"))},dx_gFrY:function(e,n,r){"use strict";r.d(n,"q",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("collab")},dx_gK2j:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return h}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_K5vg"),c=r("dx_TSYQ"),a=r.n(c),l=r("dx_cDcd"),s=r.n(l),u=(r("dx_Csn1"),r("dx_y5yU")),d=r("dx_luPr"),f=Object(u.r)(i.S);function h(e){var n=e.onLoad,r=e.loadingError,i=e.onClickRetry,c=Object(l.useRef)(null),u=function(){i()},h=Object(l.useState)(null),p=o()(h,2),v=p[0],g=p[1];Object(l.useEffect)((function(){if(r){var e=setTimeout((function(){n&&n()}),2e4);return null!==v&&v===r.id||(g(r.id),d.R.reportBlockLoadError(r)),function(){return clearTimeout(e)}}}),[n,r]);return s.a.createElement(s.a.Fragment,null," ",r?function(){var n=e.hasText;return s.a.createElement("div",{className:a()(e.classNames,"docx-block-loading-retry docx-block-loading"),style:e.style,ref:c},s.a.createElement("div",{className:"docx-block-mode",contentEditable:!1},s.a.createElement("div",{className:"docx-retry-content"},s.a.createElement("div",{className:"docx-retry-placeholder-img",style:n?{fontSize:10}:void 0,onClick:n?u:void 0},s.a.createElement(f,{style:{maxHeight:"88px",maxWidth:"88px"}})),!n&&s.a.createElement("div",{className:"retry-tips"},s.a.createElement("span",{className:"retry-text"},t("CreationDoc_DocX_Block_Load_Fail"),s.a.createElement("button",{type:"button",onClick:u,className:"retry-btn"},t("CreationDoc_Docs_TwoWayLinks_LoadingError_Toast12")))))))}():e.children)}}).call(this,r("dx_E9Eu"))},dx_gLp6:function(e,n,r){"use strict";var o,i,c,a;r.d(n,"Q",(function(){return o})),r.d(n,"s",(function(){return i})),r.d(n,"O",(function(){return c})),r.d(n,"G",(function(){return a})),r.d(n,"J",(function(){return l})),function(e){e.OPEN_VIEWER="open_diagram_image_viewer",e.EXIT_GRAPH_EDITOR="exit_graph_editor",e.DELETE_DIAGRAM_BLOCK="delete_diagram_block",e.LOADED="LOADED"}(o||(o={})),function(e){e.REMOVE="remove",e.REPLACE="replace",e.ADD="add"}(i||(i={})),function(e){e.FLOWCHART="flowchart",e.UML="uml"}(c||(c={})),function(e){e.CLICK_BTN="click_btn",e.AUTO="auto"}(a||(a={}));var l={data:{mxGraphModel:{dx:"765",dy:"705",grid:"1",gridSize:"10",guides:"1",tooltips:"1",connect:"1",arrows:"1",fold:"1",page:"1",pageScale:"1",pageWidth:"827",pageHeight:"1169"},mxCellMap:{Xfazc13W:{id:"Xfazc13W"},Pect1uf9:{id:"Pect1uf9",parent:"Xfazc13W"}},mxCellList:["Xfazc13W","Pect1uf9"]},lastEditTime:0,snapshot:""}},dx_gLqT:function(e,n,r){"use strict";var o;r.d(n,"q",(function(){return o})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAIL_OFFLINE=1]="FAIL_OFFLINE",e[e.FAIL_COPY_TOKEN=2]="FAIL_COPY_TOKEN",e[e.FAIL_CLINET_PARAMSTYPE_ERROR=3]="FAIL_CLINET_PARAMSTYPE_ERROR",e[e.FAIL_UPLOAD_IMAGE=4]="FAIL_UPLOAD_IMAGE",e[e.FAIL_CONFLICT=5]="FAIL_CONFLICT",e[e.FAIL_UNKNOWN=6]="FAIL_UNKNOWN",e[e.FAIL_AUTHORITY_CHANGE=7]="FAIL_AUTHORITY_CHANGE"}(o||(o={}))},dx_gMOR:function(e,n,r){"use strict";r.d(n,"p",(function(){return v})),r.d(n,"x",(function(){return g})),r.d(n,"z",(function(){return b}));var o=r("dx_rQGm"),i=r("dx_xWbU"),c=r("dx_B28d"),a={AUTHOR_AREA_WIDTH:o.y,CATALOGUE_MIN_WIDTH:o.a,CATALOGUE_RESPONSE_END_WIDTH:o.i,CATALOGUE_RESPONSE_MAX_WIDTH:o.b,CATALOGUE_RESPONSE_MIN_WIDTH:o.j,CATALOGUE_RESPONSE_WIKI_WIDTH:o.bX,CATALOGUE_SM_RESPONSE_MAX_WIDTH:o.aP,CATALOGUE_ITEM_PADDING_BOTTOM:o.P,CATALOGUE_UL_PADDING_BOTTOM:o.l,CATALOGUE_PIN_HEIGHT:o.m,COMMENT_SIDEBAR_WIDTH:o.O,EDITOR_LEFT_WIDTH:o.id,EDITOR_RIGHT_WIDTH:o.I,EDITOR_NORMAL_WIDTH_WITH_PADDING:o.h,EDITOR_PADDING:o.r,EDITOR_RESPONSE_START_WIDTH:o.lR,EDITOR_NORMAL_WIDTH:o.L,PAGE_MAIN_PADDING:o.FT,WEB_HEADER_HEIGHT:o.mM,HYDRATE_SCROLL_LAYOUT:o.V,WIDTH_MODE_STANDARD:i.M.StandardWidth,WIDTH_MODE_FULL:i.M.FullWidth,CHILDREN_PADDING:o.X,NESTABLE_BLOCK_GROUP:c.q,debug:l(window.localStorage)};function l(e){var n;return Boolean(null===(n=e.getItem("debug"))||void 0===n?void 0:n.includes("layout"))}var s=r("dx_J4zp"),u=r.n(s);function d(e,n){var r,o,i=n.containerWidth,c=n.widthMode,a=n.isInWiki,l=n.isViewEditors,s=n.baseIsAbstract,d=n.commentPanelShown,f=n.customBoxWidth,h=n.customPadding,p=function(){if(h){var n=u()(h,4),r=n[1],o=n[3],i=Math.round((o-r)/2);return{editorPaddingLeft:o-i,editorPaddingRight:r+i}}return{editorPaddingLeft:e.EDITOR_PADDING,editorPaddingRight:e.EDITOR_PADDING}}(),v=p.editorPaddingRight,g=p.editorPaddingLeft,b=v+e.COMMENT_SIDEBAR_WIDTH,y=g+e.PAGE_MAIN_PADDING,m=a?e.CATALOGUE_RESPONSE_WIKI_WIDTH:e.CATALOGUE_RESPONSE_END_WIDTH,_=i<m,k=!(s||_),O=function(){if(f){var n=h||[0,0,0,0],r=u()(n,4),o=r[1],i=r[3];return f-i-o+2*(e.EDITOR_RIGHT_WIDTH+e.COMMENT_SIDEBAR_WIDTH)}return e.EDITOR_RESPONSE_START_WIDTH}(),x=function(){if(f){var n=h||[0,0,0,0],r=u()(n,4),o=r[1],i=r[3];return f-i-o}return e.EDITOR_NORMAL_WIDTH}();if(i>=O)o=x,r=Math.max(i-o,0)/2-e.EDITOR_LEFT_WIDTH;else{var E=Math.min(x,i-2*y),S=(i-E)/2,C=[e.EDITOR_RESPONSE_START_WIDTH,e.CATALOGUE_RESPONSE_MAX_WIDTH],I=C[0],B=C[1],T=[m,e.CATALOGUE_RESPONSE_MIN_WIDTH],w=B+(i-I)*(T[1]-B)/(T[0]-I),R=w+e.EDITOR_LEFT_WIDTH;k&&d?(r=w,o=i-R-b):k||d?!k&&d?(r=S-e.EDITOR_LEFT_WIDTH,o=i-S-b):(r=w,o=Math.min(e.EDITOR_NORMAL_WIDTH,i-R-y)):(r=S-e.EDITOR_LEFT_WIDTH,o=E)}c===e.WIDTH_MODE_FULL&&(r=k?Math.min(r,e.CATALOGUE_SM_RESPONSE_MAX_WIDTH):e.CATALOGUE_MIN_WIDTH);var M=r+e.EDITOR_LEFT_WIDTH;if(l){var j=k?e.CATALOGUE_RESPONSE_MIN_WIDTH:e.CATALOGUE_MIN_WIDTH;r-e.AUTHOR_AREA_WIDTH<j?(M+=j-(r-e.AUTHOR_AREA_WIDTH),r=j):r-=e.AUTHOR_AREA_WIDTH}var D=M-g-e.PAGE_MAIN_PADDING;if(e.debug){var A=Math.floor(i-M-o),P="".concat(Math.floor(M),"(").concat(Math.floor(r)," + 62)"),L="".concat(Math.floor(o),"+").concat(Math.floor(A)),N=c===e.WIDTH_MODE_FULL?98:Math.max(98,A+o-730),F="".concat(Math.floor(A+o-N),"+").concat(Math.floor(N)),U="marginLeft=".concat(Math.floor(D)),H="ssrCalcWidthLayout(".concat(c,",catalog/comment=").concat(k,"/").concat(d,")");console.log("".concat(H,": ").concat(i," = ").concat(P," + (").concat(L,") or (").concat(F,"), ").concat(U))}return{catalogAreaWidth:r,contentMarginLeft:M,contentCssMarginLeft:D,forceAbstract:_}}function f(e,n,r){var o=e.CATALOGUE_PIN_HEIGHT,i=e.CATALOGUE_ITEM_PADDING_BOTTOM+e.CATALOGUE_UL_PADDING_BOTTOM,c=r-o-i,a=(n-c)/2-o;if(a=Math.max(0,a),e.debug){var l="".concat(Math.floor(a)," = Math.max(0, (").concat(n," - ").concat(Math.floor(c),") / 2 - ").concat(o,")"),s="".concat(Math.floor(c)," = ").concat(Math.floor(r)," - ").concat(Math.floor(o+i));console.log("layout:ssrCalcCatalogTop: ".concat(l,", ").concat(s))}return a}var h,p=function(e,n){var r,o=n.terminal,i=n.isEmptyCatalog,c=performance.now(),a=document.querySelector(".page-main"),l=document.querySelector(".page-main-item"),s=document.querySelector(".page-main-item > .docx-page-block"),u=document.querySelector(".bear-web-x-container"),h=document.querySelector(".catalogue-container"),p=document.querySelector(".catalogue");if(a&&l&&u&&s){var v=u.clientWidth,g=a.classList.contains("full-width")?e.WIDTH_MODE_FULL:e.WIDTH_MODE_STANDARD,b=Boolean(u&&u.classList.contains("docx-in-wiki")),y=i,m=p?p.getBoundingClientRect().height:0,_=d(e,{containerWidth:v,widthMode:g,isInWiki:b,isViewEditors:!1,baseIsAbstract:y,commentPanelShown:!1}),k=f(e,window.innerHeight-e.WEB_HEADER_HEIGHT,m);h&&p&&(p.style.maxWidth="".concat(_.catalogAreaWidth,"px"),h.style.top="".concat(k,"px")),"pc"===o&&(l.style.marginLeft="".concat(_.contentCssMarginLeft,"px")),h&&(h.style.visibility=""),a.style.visibility="";var O=performance.now();window.ssrPageLayoutCostTime=O-c;var x={};if(window[e.HYDRATE_SCROLL_LAYOUT]=x,null===(r=window.clientFeatures)||void 0===r?void 0:r.docx_block_ssr){var E=document.querySelectorAll('[data-block-type="table"]');if(E.length>0){for(var S=u.getBoundingClientRect(),C=s.getBoundingClientRect(),I=u.offsetWidth-u.clientWidth,B=S.right-I,T=C.left-S.left-106,w=B-C.right-40,R=T+C.width+w,M=Math.round(Math.max(C.left-S.left-106,0)),j=document.body.getBoundingClientRect(),D=E.length,A=0;A<D;A++){for(var P,L=E[A],N=0,F=null===(P=L.parentElement)||void 0===P?void 0:P.closest(".block");F&&"page"!==F.getAttribute("data-block-type");){var U;N+=1,F=null===(U=F.parentElement)||void 0===U?void 0:U.closest(".block")}var H=N*e.CHILDREN_PADDING,V=Boolean(F&&"page"===F.getAttribute("data-block-type")),W=L.getAttribute("data-record-id"),z=L.querySelector(".scrollable-wrapper"),G=L.querySelector(".scrollable-container"),K=L.querySelector(".scrollable-item"),q=L.querySelector(".content-scroller"),X=L.querySelector("table"),Y=L.querySelector(".right-shadow"),J=!V,Z=re(L),Q=Z[0],$=Z[1];if(z&&G&&K&&q&&X&&Y&&W){var ee=L.clientWidth;if(L.style.overflow="visible",Q){var te=$.getBoundingClientRect().width;z.style.width="".concat(te,"px"),G.style.width="".concat(te,"px"),q.style.maxWidth="".concat(te,"px"),x[W]={width:te,margin:0},Y.style.opacity=q.getBoundingClientRect().right<L.getBoundingClientRect().right?"0":"1"}else J?(z.style.width="".concat(ee,"px"),G.style.width="".concat(ee,"px"),q.style.maxWidth="".concat(ee,"px"),x[W]={width:ee,margin:0},Y.style.opacity=q.getBoundingClientRect().right<L.getBoundingClientRect().right?"0":"1"):(z.style.width="".concat(R,"px"),z.style.left="-".concat(M+H,"px"),G.style.width="".concat(R,"px"),K.style.left="".concat(M+H,"px"),q.style.maxWidth="".concat(R,"px"),Y.style.opacity=q.getBoundingClientRect().right<j.right?"0":"1",x[W]={width:R,margin:M+H})}}var ne=performance.now();window.ssrTableLayoutCostTime=ne-O}}e.debug&&console.log("ssr update layout(".concat(o,",").concat(g,",").concat(i,"), top/innerWidth/widthLayout/catalogHeight"),k,v,_,m)}function re(e){for(var n=e;n.parentElement&&n!==u;){if("grid_column"===n.getAttribute("data-block-type"))return[!0,n];n=n.parentElement}return[!1,n]}};function v(e){return d(a,e)}function g(e,n){return f(a,e,n)}function b(e){return function(e,n){var r=n.containerHeight,o=n.coverIntersectionHeight,i=r-o;return e.debug&&console.log("layout:ssrCalcHeightLayout.catalogHeight: %d = %d - %d",i,r,o),{catalogAreaHeight:i}}(a,e)}a.debug&&console.log("eval",(h={terminal:"pc",isEmptyCatalog:!1},"\n  ".concat(d.toString(),";\n  ").concat(f.toString(),";\n  const ").concat(l.name," = ").concat(l.toString(),";\n  const ").concat(p.name," = ").concat(p.toString(),";\n  const config = ").concat(JSON.stringify(a),";\n  const props = ").concat(JSON.stringify(h),";\n  if ((window.catalogRecordInfo || {}).isEmptyCatalog !== undefined) {\n    props.isEmptyCatalog = (window.catalogRecordInfo || {}).isEmptyCatalog;\n  }\n  config.debug = ").concat(l.name,"(window.localStorage);\n  ").concat(p.name,"(config, props);\n  ")))},dx_ga2g:function(e,n,r){"use strict";r.d(n,"F",(function(){return i}));var o=r("dx_UtDZ");function i(e){var n={type:e.pcToastType,content:e.message,closable:e.closable,key:e.key,onClose:e.onClose,duration:e.duration};o.Toast.show(n)}},dx_giHy:function(e,n,r){"use strict";r.d(n,"q",(function(){return i}));var o=r("dx_h6a8");function i(e){return!!Object(o.isObject)(e)&&["issueKey","jiraIssueId","issueRecordMap"].every((function(n){return!!e[n]}))}},dx_gn6w:function(e,n,r){"use strict";r.d(n,"N",(function(){return i}));var o=r("dx_Uh2b");function i(e){return{type:o.R.ToggleEditing,payload:e}}},dx_gwTP:function(e,n,r){"use strict";r.d(n,"v",(function(){return o})),r.d(n,"a",(function(){return u}));var o,i=r("dx_lwsE"),c=r.n(i),a=r("dx_W8MJ"),l=r.n(a),s=r("dx_zEdG");!function(e){e.Click="click",e.View="view"}(o||(o={}));var u=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.Click,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0,l=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];c()(this,e),this.extraParams=void 0,this.eventName=void 0,this.blockView=void 0,this.sendEventType=void 0,this.sended=void 0,this.isOnce=void 0,this.blockView=i||null,this.extraParams=a||{},this.eventName=n,this.sendEventType=r,this.sended=!1,this.isOnce=l}return l()(e,[{key:"deleteExtraData",value:function(e){var n=this;Array.isArray(e)?e.forEach((function(e){delete n.extraParams[e]})):delete this.extraParams[e]}},{key:"setExtraData",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object.assign(this.extraParams,e),n&&this.send()}},{key:"setBlockView",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.blockView=e,n&&this.send()}},{key:"send",value:function(){if(!this.sended||!this.isOnce){var e=this.sendEventType===o.Click?s.P:s.T;this.blockView?(e(this.eventName,this.blockView,this.extraParams),this.sended=!0):console.warn("collectEvent must have blockView")}}}]),e}()},dx_h02A:function(e,n,r){"use strict";r.d(n,"g",(function(){return d}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c),l=(r("dx_m0me"),function(e){var n=e.progress,r=e.showShadowBg,o=a.a.useMemo((function(){return r?"img-uploading-view img-uploading-view--shadow-bg":"img-uploading-view"}),[r]);return a.a.createElement("div",{className:o},a.a.createElement("div",{className:"img-uploading-view--container"},a.a.createElement("div",{className:"img-uploading-view--cover"},a.a.createElement("div",{className:"img-uploading-view--content",style:{width:"".concat(100*n,"%")}}))))});r("dx_tJg8");function s(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function u(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?s(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function d(e){var n=e.width,r=e.height,o=e.src,i=e.onClick,c=e.progress,s=e.style;return a.a.createElement("div",{className:"image-mask",style:u({width:n,paddingTop:"calc(".concat(r," / ").concat(n," * 100%)")},s),onClick:i},o&&a.a.createElement("img",{className:"image-mask--image",src:o,width:n,height:r,style:{width:n}}),a.a.createElement("div",{className:"image-mask--cover"}),void 0!==c?a.a.createElement(l,{progress:c,showShadowBg:!0}):null)}},dx_h0h1:function(e,n,r){"use strict";r.d(n,"L",(function(){return ee})),r.d(n,"e",(function(){return te})),r.d(n,"G",(function(){return re})),r.d(n,"z",(function(){return ie})),r.d(n,"R",(function(){return ce}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_o0o1"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_e4eN"),d=r("dx_UtDZ"),f=r("dx_h6a8"),h=r("dx_wy2R"),p=r.n(h),v=r("dx_xlCA"),g=r("dx_z8zm"),b=r("dx_L6Lu"),y=r("dx_IdzY"),m=r("dx_I11I"),_=r("dx_RUmv"),k=r("dx_bPy9"),O=r("dx_kZ3l"),x=r("dx_D8nn"),E=r("dx_C3pj"),S=r("dx_ZMwq"),C=r("dx_FHaN"),I=r("dx_HTwv"),B=r("dx_lwsE"),T=r.n(B),w=r("dx_W8MJ"),R=r.n(w),M=r("dx_W7W2"),j=r.n(M),D=r("dx_a1gu"),A=r.n(D),P=r("dx_Nsbk"),L=r.n(P),N=function e(n){var r=this;T()(this,e),this.yesterday=void 0,this.today=void 0,this.tomorrow=void 0,this.getToday=function(){return r.today},this.getYesterday=function(){return r.yesterday},this.getTomorrow=function(){return r.tomorrow},this.yesterday=n.yesterday,this.today=n.today,this.tomorrow=n.tomorrow};function F(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=L()(e);if(n){var i=L()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return A()(this,r)}}var U=new(function(e){j()(r,e);var n=F(r);function r(){var e;return T()(this,r),(e=n.call(this,{yesterday:"\u6628\u5929",today:"\u4eca\u5929",tomorrow:"\u660e\u5929"})).weekMap={1:"\u4e00",2:"\u4e8c",3:"\u4e09",4:"\u56db",5:"\u4e94",6:"\u516d",7:"\u65e5"},e.getMonthDay=function(e,n){return"".concat(e,"\u6708").concat(n,"\u65e5")},e.getYearMonthDay=function(e,n,r){return"".concat(e,"\u5e74").concat(n,"\u6708").concat(r,"\u65e5")},e.getCurrentWeek=function(n){return"\u672c\u5468".concat(e.weekMap[n])},e.getNextWeek=function(n){return"\u4e0b\u5468".concat(e.weekMap[n])},e}return r}(N));function H(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=L()(e);if(n){var i=L()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return A()(this,r)}}var V=new(function(e){j()(r,e);var n=H(r);function r(){var e;return T()(this,r),(e=n.call(this,{yesterday:"Yesterday",today:"Today",tomorrow:"Tomorrow"})).weekMap={1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday",7:"Sunday"},e.monthMap={1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"},e.getMonthDay=function(n,r){return"".concat(e.monthMap[n]," ").concat(r)},e.getYearMonthDay=function(n,r,o){return"".concat(e.monthMap[r]," ").concat(o,", ").concat(n)},e.getCurrentWeek=function(n){return e.weekMap[n]},e.getNextWeek=function(n){return"Next ".concat(e.weekMap[n])},e}return r}(N));function W(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=L()(e);if(n){var i=L()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return A()(this,r)}}var z,G=new(function(e){j()(r,e);var n=W(r);function r(){var e;return T()(this,r),(e=n.call(this,{yesterday:"\u6628\u65e5",today:"\u4eca\u65e5",tomorrow:"\u660e\u65e5"})).weekMap={1:"\u6708",2:"\u706b",3:"\u6c34",4:"\u6728",5:"\u91d1",6:"\u571f",7:"\u65e5"},e.getMonthDay=function(e,n){return"".concat(e,"\u6708").concat(n,"\u65e5")},e.getYearMonthDay=function(e,n,r){return"".concat(e,"\u5e74").concat(n,"\u6708").concat(r,"\u65e5")},e.getCurrentWeek=function(n){return"".concat(e.weekMap[n],"\u66dc\u65e5")},e.getNextWeek=function(n){return"\u6b21\u306e".concat(e.weekMap[n],"\u66dc\u65e5")},e}return r}(N));!function(e){e["zh-CN"]="cn",e["zh-cn"]="cn",e.cn="cn",e.en="en",e["en-US"]="en",e["en-us"]="en",e.ja="ja",e["ja-JP"]="ja",e["ja-jp"]="ja"}(z||(z={}));var K=function(){function e(){T()(this,e),this.locale=void 0,this.locale={cn:U,en:V,ja:G},e.language=z[this.getLocale()]}return R()(e,[{key:"getLocale",value:function(){var e=d.i18nHelper.getLocale();if(e){if(-1!==e.indexOf("zh"))return"cn";if(-1!==e.indexOf("ja"))return"ja"}return"en"}},{key:"getFormatedDate",value:function(e){for(var n=z[this.getLocale()],r=this.locale[n][e],o=arguments.length,i=new Array(o>1?o-1:0),c=1;c<o;c++)i[c-1]=arguments[c];return r&&r.apply(void 0,i)}},{key:"getFormateTime",value:function(e,n){if("en"===z[this.getLocale()]){var r=Number(e),o=r>11?"PM":"AM";return" ".concat(r%12||12,":").concat(n," ").concat(o)}return" ".concat(e,":").concat(n)}}],[{key:"setLanguage",value:function(n){return n in z&&(e.language=n),e.language}}]),e}();K.language=z.en;var q,X=K;!function(e){e.today="getToday",e.yesterday="getYesterday",e.tomorrow="getTomorrow",e.monthDay="getMonthDay",e.yearMonthDay="getYearMonthDay",e.currentWeek="getCurrentWeek",e.nextWeek="getNextWeek"}(q||(q={}));var Y=new(function(){function e(){T()(this,e),this.i18nDate=void 0,this.i18nDate=new X}return R()(e,[{key:"getTimeString",value:function(e,n){var r="",o=new Date(e),i=new Date,c=this.parseDate(o),a=this.parseDate(i);if(r=this.getNormalDateStr(c,a),n){var l=this.parseTimeIfNeeded(c.hour),s=this.parseTimeIfNeeded(c.minute);r+=this.i18nDate.getFormateTime(l,s)}return r}},{key:"parseDate",value:function(e){var n=e.getDay();return n=0===n?7:n,{year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),day:n,time:e.getTime()}}},{key:"parseTimeIfNeeded",value:function(e){var n=String(e);return 1===n.length?"0".concat(e):n}},{key:"getNormalDateStr",value:function(e,n){var r=e.year,o=e.month,i=e.date,c=this.getRealWeek(e,n),a=c.dateWeeks,l=c.nowWeeks;return e.year!==n.year?this.i18nDate.getFormatedDate(q.yearMonthDay,r,o,i):a-l>=2||a-l<=-1?n.date-e.date===1&&a-l===-1&&o===n.month?this.i18nDate.getFormatedDate(q.yesterday):this.i18nDate.getFormatedDate(q.monthDay,o,i):e.date===n.date?this.i18nDate.getFormatedDate(q.today):n.date-e.date===1?this.i18nDate.getFormatedDate(q.yesterday):e.date-n.date===1?this.i18nDate.getFormatedDate(q.tomorrow):a-l>=1?this.i18nDate.getFormatedDate(q.nextWeek,e.day):this.i18nDate.getFormatedDate(q.currentWeek,e.day)}},{key:"getRealWeek",value:function(e,n){var r=new Date(new Date(e.time).setHours(0,0,0,0)).getTime(),o=new Date(new Date(n.time).setHours(0,0,0,0)).getTime(),i=864e5;return{dateWeeks:Math.ceil((r/i+4)/7),nowWeeks:Math.ceil((o/i+4)/7)}}}],[{key:"setLanguage",value:function(e){X.setLanguage(e)}}]),e}()),J=r("dx_kqrv");function Z(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Q(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Z(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var ee=function(){var e=s()(a.a.mark((function e(n,r){var o,i=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i.length>2&&void 0!==i[2]?i[2]:Object(d.isOnline)())){e.next=3;break}return e.abrupt("return",Promise.all(r.map(function(){var e=s()(a.a.mark((function e(r){var o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.n.fetch(n,r);case 2:return o=e.sent,e.abrupt("return",o);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())));case 3:return e.next=5,Promise.all(r.map(function(){var e=s()(a.a.mark((function e(n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.n.getUserDetailFromAllMap(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()));case 5:return o=e.sent,e.abrupt("return",Promise.resolve(Object(f.compact)(o)));case 7:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}();var te=function(e,n,r,o,i){var c=Object(g.u)(d.store.getState()),a=function(e,n,r,o){var i=document.createElement("div");if(e===S.E.Simple){var c=r?J.F+J.O:0;i.style.width="".concat(String(J.I-c),"px")}else i.style.width="".concat(String(J.h),"px");var a=document.createElement("p");a.style.cssText="\n    line-height: 20px;\n    font-size: 12px;\n    width: auto;\n    word-wrap: break-word;\n    padding-top: 0;\n    padding-bottom: 0;\n  ",a.textContent=Object(E.K)(n),i.appendChild(a);var l=$(".bear-web-x-container .docx-reminder").get(0);l.parentElement.appendChild(i);var s=parseInt(getComputedStyle(i).height,10)+(o?J.s:0);return l.parentElement.removeChild(i),e===S.E.Intact?J.P+s:J.l+s}(r,n,o,i),l=Object(d.getPosition)(e,{$boxContainer:c?$(".presentation-mode .presentation-mode-scroller .docx-reminder"):$(".docx-reminder"),boxWidth:J.e,boxMaxHeight:a,boxMinHeight:a,horizontalAlign:"center",zoom:Object(b.C)(e)?Object(b.K)():1});return l.width=J.e,l.height=a,l.left<0&&(l.left=0),l};var ne=function(){var e=p()().minute()<30?0:30,n=p()().add(1,"days").set({minute:e,second:0,millisecond:0}).valueOf();return{is_whole_day:!1,should_notify:!0,notify_time:n,expire_time:n,create_user_id:d.userHelper.getCurrentUser().get("id")}};function re(e,n){return oe.apply(this,arguments)}function oe(){return oe=s()(a.a.mark((function e(n,r){var o,c,l,s,d,h,p=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=p.length>2&&void 0!==p[2]?p[2]:{},c=n.model.zoneId,l=o.reminderProps||Object(I.o)(C.k.REMINDER,ne()),e.next=5,n.blockManager.applyTransaction("addReminder",(function(e){var o=Object(O.j)(n,[r.start,r.start+r.len]),a=n.model.getAttributes(o.start,o.end).toMap(),s=Object(f.omit)(a,[m.B,_.h.KEY,"objectID"]),d=new u.m({zoneId:c}).retain(r.start).delete(r.len).insert(" ",Q(Q({},s),{},i()({},C.O,JSON.stringify(l))));n.model.apply(d,{extra:{op:e}}),e.replace(n.record.id,["text"],n.model.zoneState.toAttributeText())}));case 5:s=o.focus,d=o.openPopover,s&&n.model.setSelection(Q(Q({},r),{},{start:r.start+1,len:0}),!0),d&&(h=l.id,x.S.emit(J.i,h));case 8:case"end":return e.stop()}}),e)}))),oe.apply(this,arguments)}function ie(e,n,r){var o;try{o=r.getRecord(n)}catch(a){return!1}if(!o)return!1;var i=Object(k.w)(o.snapshot.text),c=!1;return i.get(y.x).ops.forEach((function(n){var r;if(null===(r=n.attributes)||void 0===r?void 0:r[C.O]){var o=Object(I.p)(n);(null===o||void 0===o?void 0:o.type)===C.k.REMINDER&&o.id===e&&(c=!0)}})),c}var ce=function(e,n){return r=e,o=!n,Object(f.isNumber)(r)?Y.getTimeString(r,o):r;var r,o}},dx_h1hl:function(e,n,r){},dx_h2hr:function(e,n,r){"use strict";(function(e){var o=r("dx_J4zp"),i=r.n(o),c=r("dx_o0o1"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_UtDZ"),v=r("dx_AA3h"),g=r("dx_h6a8"),b=r("dx_qYkn"),y=r("dx_k64k"),m=r("dx_Fimk"),_=r("dx_TwmW"),k=r("dx_FHaN"),O=r("dx_HTwv"),x=r("dx_o9oe"),E=r("dx_gDjg"),S=function(){function n(e){var r=this,o=e.token,i=e.isPreview;d()(this,n),this.currentPageToken=void 0,this.embedObjPermissionManager=void 0,this.embedObjectCache=[],this.embedObjectSet=new Set,this.notSupportPermission=void 0,this.checkApplyEmbedRecordList=new Map,this.hasInitPermission=!1,this.isPreview=!1,this.onPermissionChange=function(e){p.store.dispatch(Object(b.z)({pageToken:r.currentPageToken,embedObjectPermissions:e}))},this.checkApplyEmbed=function(){var e=s()(a.a.mark((function e(n,o,i){var c,l,s,u,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=Object(y.S)(p.store.getState(),r.currentPageToken,n),e.prev=1,Object(x.F)()){e.next=4;break}return e.abrupt("return",c);case 4:if(r.embedObjPermissionManager){e.next=8;break}return r.initPermissionIfNeed(),console.error("[EmbedObjManager] this.embedObjPermissionManager is undefined"),e.abrupt("return",k.J.NETWORK_ERROR);case 8:if(l=(new Date).getTime(),s=r.checkApplyEmbedRecordList.get(n)||0,!(l-s<k.L)){e.next=13;break}return e.abrupt("return",c);case 13:return r.checkApplyEmbedRecordList.set(n,l),u=Object(E.l)(o),e.next=17,r.embedObjPermissionManager.checkApplyEmbed({token:n,type:u,title:i});case 17:return d=Object(y.S)(p.store.getState(),r.currentPageToken,n),e.abrupt("return",d);case 21:return e.prev=21,e.t0=e.catch(1),e.abrupt("return",c);case 24:case"end":return e.stop()}}),e,null,[[1,21]])})));return function(n,r,o){return e.apply(this,arguments)}}(),this.currentPageToken=o,this.isPreview=i,this.notSupportPermission=Object(_.S)()||!Object(x.a)()}return h()(n,[{key:"initPermission",value:function(){var e=s()(a.a.mark((function e(){var n,o,i,c,l,s,u,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.embedObjectSet.clear(),n=p.i18nHelper.getLocale(),e.next=4,r("dx_PtL9")("./".concat(n,".js"));case 4:return o=e.sent,e.next=7,Promise.all([r.e("dx_vNU"),r.e("dx_UTc"),r.e("dx_v7vu"),r.e("dx_j1jX"),r.e("dx_HUt")]).then(r.bind(null,"dx_D379"));case 7:i=e.sent,c=i.initPermissionServices,l=i.EmbedObjPermissionManager,!1;try{p.wikiLinkInstance?p.wikiLinkInstance.isWiki():v.isWiki&&Object(v.isWiki)()}catch(a){}if(s={token:this.currentPageToken,type:p.NUM_SUITE_TYPE.DOCX},!this.isPreview){e.next=19;break}return e.next=16,null===p.generatePermServicesConfig||void 0===p.generatePermServicesConfig?void 0:Object(p.generatePermServicesConfig)(s);case 16:e.t0=e.sent,e.next=22;break;case 19:return e.next=21,null===p.generatePermServicesConfig||void 0===p.generatePermServicesConfig?void 0:Object(p.generatePermServicesConfig)();case 21:e.t0=e.sent;case 22:u=e.t0,d=u||{entity:s,env:{locale:n},bizConfig:{globalConfig:Object(g.get)(window,"globalConfig"),FGConfig:Object(g.get)(window,"User.clientFeatures",{})},sendTeaEvent:m.N,request:p.request,i18n:o.default},c(d),this.embedObjPermissionManager=new l({token:this.currentPageToken,type:p.NUM_SUITE_TYPE.DOCX,onPermissionChange:this.onPermissionChange}),this.embedObjectCache.length>0&&(this.addEmbedObjs(this.embedObjectCache),this.embedObjectCache=[]);case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initPermissionIfNeed",value:function(){this.hasInitPermission||e.env.NODEJS||(this.initPermission(),this.hasInitPermission=!0)}},{key:"addEmbedObjs",value:function(e){var n=this;e.length<=0||(this.initPermissionIfNeed(),this.embedObjPermissionManager?(this.embedObjPermissionManager.addEmbedObjs(e),e.forEach((function(e){return n.embedObjectSet.add(e.token)}))):this.embedObjectCache=this.embedObjectCache.concat(e))}},{key:"addEmbedObj",value:function(e,n,r){if(!this.notSupportPermission){var o=Object(E.A)(e,r,n);o&&this.addEmbedObjs([{token:e,title:o,type:Object(E.l)(r)}])}}},{key:"onEmbedPermissionChangeByClientVars",value:function(e){if(!this.notSupportPermission){var n=e.block_map,r=Object.values(n).reduce((function(e,n){var r=Object(g.get)(n,"data.text.apool.numToAttrib");return r&&Object.values(r).forEach((function(n){var r=i()(n,2),o=r[0],c=r[1];if(o===k.O&&-1!==c.indexOf(k.k.DOC)){var a=Object(O.y)(c);if(null===a||void 0===a?void 0:a.data){var l=a.data,s=l.token,u=l.file_type,d=l.title,f=Object(E.A)(s,u,d);e.set(s,{type:Object(E.l)(u),token:s,title:f})}}})),e}),new Map),o=Array.from(r.values());this.addEmbedObjs(o)}}},{key:"hasEmbedObj",value:function(e){return this.embedObjectSet.has(e)||!!this.embedObjectCache.find((function(n){return n.token===e}))}}]),n}();n.S=S}).call(this,r("dx_o8ox"))},dx_h3h2:function(e,n,r){"use strict";var o=r("dx_BaZy"),i=r.n(o)()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_qHLA"))},loading:function(){return null}});n.S=i},dx_h5SS:function(e,n,r){},dx_h5hq:function(e,n,r){"use strict";r.d(n,"y",(function(){return y}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_e4eN"),v=r("dx_BuQo"),g=r("dx_gA4Q");function b(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var y=function(e){s()(r,e);var n=b(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"addZone",value:function(e,n){if(this.content.get(e))return console.error("[ContentState][addZone] zoneId:".concat(e," existed")),this.content.get(e);var r=n||new p.m({zoneId:e}).insertEnter();r.zoneId!==e&&(r=new p.m({zoneId:e,ops:r.ops}));var o=new g.h(e,r);return this.content.set(e,o),o}},{key:"removeZone",value:function(e){this.getZoneState(e)&&this.content.delete(e)}}]),r}(v.O)},dx_h8uR:function(e,n,r){"use strict";r.d(n,"b",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("jira-auth-service")},dx_h90h:function(e,n,r){"use strict";r.d(n,"n",(function(){return M}));var o,i,c,a,l,s=r("dx_yG8O"),u=r.n(s),d=r("dx_lwsE"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_PJYZ"),g=r.n(v),b=r("dx_W7W2"),y=r.n(b),m=r("dx_a1gu"),_=r.n(m),k=r("dx_Nsbk"),O=r.n(k),x=r("dx_Uyc2"),E=r.n(x),S=(r("dx_A1AB"),r("dx_Vvd7")),C=r("dx_QbKi"),I=r("dx_xjz2"),B=r("dx_Sm0n"),T=r("dx_GnmH"),w=Object(I.s)(T.y)(o=function(){function e(n){var r=this;f()(this,e),this.creators=n,this.recordTypeToCreator=new Map,this.unwatchCreators=void 0,this.unwatchCreators=n.onChange((function(){r.recordTypeToCreator.clear()}))}return e=Object(B.q)(e,void 0,0)||e,e=Object(I.e)()(e,void 0,0)||e,e=Object(I.a)()(e,void 0,0)||e,p()(e,[{key:"destroy",value:function(){this.unwatchCreators()}},{key:"create",value:function(e,n){return this.getCreatorByRecordType(e).create(n,e)}},{key:"getCreatorByRecordType",value:function(e){var n=this.recordTypeToCreator.get(e);if(n)return n;this.ensureCreatorTypeMap();var r=this.recordTypeToCreator.get(e);if(!r)throw new Error('please provide record snapshot factory for "'.concat(e,'"'));return r}},{key:"ensureCreatorTypeMap",value:function(){var e=this;this.recordTypeToCreator.size||this.creators.get().forEach((function(n){e.recordTypeToCreator.set(n.type,n)}))}}]),e}())||o;function R(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=O()(e);if(n){var i=O()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return _()(this,r)}}var M=Object(S.H)({providers:[w]})((l=function(e){y()(r,e);var n=R(r);function r(){var e;f()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),u()(e,"factory",a,g()(e)),e}return p()(r,[{key:"destroy",value:function(){this.factory.destroy()}}]),r}(S.G),c=l,a=E()(c.prototype,"factory",[C.RecordSnapshotFactoryService],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=c))||i},dx_hB4y:function(e,n,r){"use strict";r.d(n,"v",(function(){return o}));var o=function(e){return e.toLowerCase().split(/\s+/).map((function(e){return e.slice(0,1).toUpperCase()+e.slice(1)})).join(" ")}},dx_hCEt:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M5 3.998a2 2 0 114.001.001A2 2 0 015 3.998zM7 .665a3.334 3.334 0 10.001 6.667A3.334 3.334 0 007 .665zM2.75 12.02c.297-1.15 1.34-2 2.583-2H8.69c.184 0 .333-.15.333-.333V9.02a.333.333 0 00-.333-.333H5.333a4 4 0 00-4 4v1.642c0 .368.3.666.667.666H8.689c.184 0 .333-.149.333-.333v-.667a.333.333 0 00-.333-.333H2.667v-.975c0-.23.03-.454.083-.667zM12.999 9h-.667a.333.333 0 00-.333.333V11h-1.667a.333.333 0 00-.333.333V12c0 .184.149.333.333.333h1.667V14c0 .184.149.333.333.333h.667c.184 0 .333-.15.333-.333v-1.667h1.667c.184 0 .333-.15.333-.333v-.667a.333.333 0 00-.333-.333h-1.667V9.333A.333.333 0 0012.999 9z",fill:"#646a73",fillRule:"evenodd"});n.S=function(e){return i.a.createElement("svg",c({width:16,height:16,viewBox:"0 0 16 16"},e),a)}},dx_hD2y:function(e,n,r){"use strict";r.d(n,"S",(function(){return l}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_D8nn"),a=r("dx_MlPX"),l=function e(n){var r=this;i()(this,e),this.host=n,this.eventEmitter=new c.i,this.cacheHostEle=void 0,this.cacheHostRect=new DOMRect(0,0,0,0),this.isNeedUpdateCache=!0,this.getHost=function(){return r.cacheHostEle||(r.cacheHostEle=r.host&&r.host()),r.cacheHostEle},this.getHostRect=function(){var e,n=r.getHost&&(null===(e=r.getHost())||void 0===e?void 0:e.getBoundingClientRect());return n&&(r.cacheHostRect=n,r.isNeedUpdateCache=!1),n||new DOMRect(0,0,0,0)},this.getHostRectCache=function(){return r.isNeedUpdateCache?r.getHostRect():r.cacheHostRect},this.emitLayoutChange=function(e){for(var n,o=arguments.length,i=new Array(o>1?o-1:0),c=1;c<o;c++)i[c-1]=arguments[c];(n=r.eventEmitter).emit.apply(n,[a.g.LAYOUT_ITEM_CHANGE,e].concat(i)),r.isNeedUpdateCache=!0},this.onLayoutChange=function(e){return r.eventEmitter.on(a.g.LAYOUT_ITEM_CHANGE,e),function(){r.eventEmitter.removeListener(a.g.LAYOUT_ITEM_CHANGE,e)}}}},dx_hDVN:function(e,n,r){"use strict";var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_MoY1"),s=r("dx_ZG9w"),u=r("dx_WAOj");n.S=function(){var e=a()(i.a.mark((function e(n){var r,o,c,a,d,f,h,p,v,g,b,y,m,_,k,O,x,E,S;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.blockManager,o=n.blocks,c=n.newBlockType,a=n.options,d=n.afterInsertBlock,f=n.afterTransactionAccepted,h=n.autoFocus,p=void 0===h||h,o&&!(o.length<=0)){e.next=3;break}return e.abrupt("return");case 3:if(v=o[o.length-1],g=Object(u.d)(v,r),b=g.id,y=r.getBlockModelByBlockId(b),m=y.parent){e.next=10;break}return e.abrupt("return");case 10:if(_=y.position+1,k=r.applyTransaction("add:block:newline",(function(e){Object(l.l)(e,m.record.id,_,[r.createInitModel(c,a)])}),{afterTransactionAccepted:f}),O=m.children[_],x=O.id,E=O.recordId,null===d||void 0===d||d(E),r.hasBlockViewByBlockId(x)){e.next=19;break}return e.next=17,r.layoutManager.scrollToSelection(x);case 17:e.next=21;break;case 19:return e.next=21,k;case 21:return S=r.getBlockViewByBlockId(x),p&&Object(s.U)(S)&&S.model.setSelection({start:{line:0,offset:0},end:{line:0,offset:0}},!0),e.abrupt("return",S);case 24:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},dx_hE7T:function(e,n,r){"use strict";r.d(n,"N",(function(){return l}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c);function l(e){return function(n){var r=n.commentModule,o=Object(c.useState)(!1),l=i()(o,2),s=l[0],u=l[1];return Object(c.useEffect)((function(){r.ready((function(){u(!0)}))}),[]),s?a.a.createElement(e,n):null}}},dx_hESJ:function(e,n,r){"use strict";r.d(n,"S",(function(){return s}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r("dx_SGLR"),l=r("dx_Nv7e");function s(e,n,r){var o=Object(c.useState)(""),s=i()(o,2),u=s[0],d=s[1],f=Object(c.useRef)(null),h=Object(c.useState)(!1),p=i()(h,2),v=p[0],g=p[1],b=Object(c.useCallback)((function(e){e.forEach((function(e){var n=e.intersectionRatio,o=e.boundingClientRect.height,i=Math.floor(o*n);Object(a.Z)(i,r),e.isIntersecting?g(!0):g(!1)}))}),[]);return Object(c.useEffect)((function(){n&&(n.token||n.url)?Object(l.s)(n.mime_type)?Object(l.B)(n.src).then((function(e){return d(e)})).catch((function(e){console.log("useOnDemandPlayGif error",e),d("")})):d(""):d("")}),[n]),Object(c.useEffect)((function(){return e&&(f.current=new IntersectionObserver(b,{rootMargin:"0px",threshold:[0,.2,.4,.6,.8,1]}),f.current.observe(e)),function(){var e;null===(e=f.current)||void 0===e||e.disconnect()}}),[e,b]),e?v?"":u:""}},dx_hEqA:function(e,n,r){"use strict";r.d(n,"M",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("lazy-record")},dx_hFUV:function(e,n,r){"use strict";(function(t){r.d(n,"L",(function(){return a}));var e,o=r("dx_lSNA"),i=r.n(o),c=r("dx_B28d"),a=(e={},i()(e,c.B.HEADING1,t("common.title")),i()(e,c.B.HEADING2,t("common.title")),i()(e,c.B.HEADING3,t("common.title")),i()(e,c.B.HEADING4,t("common.title")),i()(e,c.B.HEADING5,t("common.title")),i()(e,c.B.HEADING6,t("common.title")),i()(e,c.B.HEADING7,t("common.title")),i()(e,c.B.HEADING8,t("common.title")),i()(e,c.B.HEADING9,t("common.title")),i()(e,c.B.HEADINGN,t("common.title")),i()(e,c.B.QUOTE,t("common.reference")),i()(e,c.B.QUOTE_CONTAINER,t("common.reference")),i()(e,c.B.IMAGE,t("editorbar.image")),i()(e,c.B.BULLET,t("common.unordered_list")),i()(e,c.B.ORDERED,t("common.ordered_list")),i()(e,c.B.DIVIDER,t("common.divider")),i()(e,c.B.CODE,t("help.siderbar.code_block")),i()(e,c.B.GRID,t("CreationDoc_DocX_Menu_Insert_column_option")),i()(e,c.B.GRID_COLUMN,t("CreationDoc_DocX_Menu_Insert_column_option")),i()(e,c.B.CALLOUT,t("CreationDoc_Docs_CalloutBlock_Tab")),i()(e,c.B.TODO,t("common.task_list")),i()(e,c.B.CHAT_CARD,t("etherpad.chatcard")),i()(e,c.B.DIAGRAM,t("CreationDoc_Docs_FlowDiagram_Title")),i()(e,c.B.TABLE,t("common.table")),i()(e,c.B.CELL,t("mobile.sheet.fab_cell")),i()(e,c.B.IFRAME,t("CreationDoc_DocX_Embed_Title")),i()(e,c.B.SHEET,t("common.sheet")),i()(e,c.B.BITABLE,t("common.bitable")),i()(e,c.B.FILE,t("common.file")),i()(e,c.B.UML,t("CreationDoc_Docs_UMLDiagram_Title")),i()(e,c.B.FLOWCHART,t("CreationDoc_Docs_FlowDiagram_Title")),i()(e,c.B.VIEW,t("common.file")),i()(e,c.B.FALLBACK,"fallback"),i()(e,c.B.ISV,"isv"),i()(e,c.B.MINDMAP,t("filetype_mindnote")),i()(e,c.B.POLL,t("block.poll")),i()(e,c.B.TASK,t("CreationDoc_Tasks_Tasks_MenuOption")),i()(e,c.B.BOOKMARK,t("CreationDoc_Docs_WebBookmark_Button")),i()(e,c.B.OKR,"OKR"),i()(e,c.B.WIKI_CATALOG,t("CreationDoc_Wiki_SubpageTOC_BlockTitle")),i()(e,c.B.WIKI_RECENT,t("CreationDoc_Wiki_UpdatesBlock_InsertBlock")),e)}).call(this,r("dx_E9Eu"))},dx_hIpu:function(e,n,r){"use strict";(function(t){r.d(n,"m",(function(){return U}));r("dx_QU2i");var e=r("dx_d1El"),o=r.n(e),i=r("dx_J4zp"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_W7W2"),f=r.n(d),h=r("dx_a1gu"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=r("dx_TSYQ"),y=r.n(b),m=r("dx_UtDZ"),_=r("dx_h6a8"),k=r("dx_cDcd"),O=r.n(k),x=r("dx_h74D"),E=r("dx_nddJ"),S=r("dx_by6m"),C=r("dx_rldU"),I=r("dx_CwnG"),B=r("dx_SUdB"),T=r("dx_ZG9w"),w=r("dx_Vau3"),R=r("dx_A5O8"),M=r("dx_zghO"),j=r("dx_Z8yN"),D=r("dx_D8nn"),A=r("dx_ey54"),P=r("dx_wLbm"),L=r("dx_BrJR");function N(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}var F="comment-hl-hover",U=function(e){f()(r,e);var n=N(r);function r(){return l()(this,r),n.apply(this,arguments)}return u()(r,[{key:"getWrapper",value:function(e){var n=this;return function(r){var i=Object(k.useState)(!1),a=c()(i,2),l=a[0],s=a[1],u=Object(k.useState)(!1),d=c()(u,2),f=d[0],h=d[1],p=Object(k.useState)(0),v=c()(p,2),g=v[0],b=v[1],w=Object(k.useState)(!1),N=c()(w,2),U=N[0],H=N[1],V=Object(k.useState)(null),W=c()(V,2),z=W[0],G=W[1],K=Object(k.useRef)(null),q=Object(x.useSelector)(m.selectors.share.ifhaveCommentPermission)&&R.S.checkShouldRegisComment(),X=Object(k.useRef)(null),Y=Object(k.useCallback)((function(){var e;if(H(!0),z){var r=n.blockManager.getBlockViewByBlockIdNotCheck(z);if(null===r||void 0===r?void 0:r.isTextBlock){var o=null===r||void 0===r||null===(e=r.hostElement.querySelector(".text-editor"))||void 0===e?void 0:e.querySelectorAll("span:not(.inline-component-user), a");o&&o.forEach((function(e){e.classList.add(F)}))}}}),[z]),J=Object(k.useCallback)((function(e){var r,o=n.blockManager.getBlockViewByBlockIdNotCheck(e),i=null===o||void 0===o||null===(r=o.hostElement.querySelector(".text-editor"))||void 0===r?void 0:r.querySelectorAll("span, a");i&&i.forEach((function(e){e.classList.remove(F)}))}),[]),Z=Object(k.useCallback)((function(){H(!1),J(z)}),[z,J]);Object(k.useEffect)((function(){X.current?(J(X.current),X.current=z):X.current=z}),[z,J]);var Q=Object(k.useCallback)((function(){if(z){var e=n.blockManager.getBlockViewByBlockIdNotCheck(z);if(e){if(Object(T.f)(e)){var r=e.model.zoneState.getModelText().length;n.comment.triggerStartNewDocComment({selectedBlocks:[{id:z,type:M.j.TEXT,selection:{start:0,end:r}}],callSource:"SuspensionComment"})}else n.comment.triggerStartNewDocComment({selectedBlocks:[{id:z,type:M.j.BLOCK}],callSource:"SuspensionComment"});s(!1),n.selectionAPI.removeAllSelection(),Object(S.w)(E.G.comment,e,n.blockManager,{triggerType:C.H.HOVER_RIGHT})}}}),[z]),$=Object(k.useMemo)((function(){return Object(_.throttle)((function(e){if(K.current){var o=e.clientX,i=e.clientY,c=Object(L.e)([r.model.id],n.blockManager,n.options.rect,i);if(void 0!==c){var a=n.blockManager.getBlockViewByBlockIdNotCheck(c);if(a)if(Object(L.jU)(a,n.blockManager,n.comment).shouldShowBtn){var l=(a.blockContentElement||a.hostElement).getBoundingClientRect(),u=l.left,d=l.width,f=l.top,h=l.height,p=u+d-100,v=u+d+100;if(r.recursionProps.translated&&(p=u),o>p&&o<v&&i<=f+h&&i>=f){var g,y=K.current.getBoundingClientRect().top;G(c),s(!!(null===(g=n.comment)||void 0===g?void 0:g.isReady)),b(f-y)}else s(!1)}else s(!1)}else s(!1)}}),100)}),[r.blockId,r.recursionProps.translated]),ee=Object(k.useCallback)((function(e){h(e)}),[]);Object(k.useEffect)((function(){var e=r.hostElementRef.current;if(e)return e.addEventListener("mousemove",$),function(){$.cancel(),e.removeEventListener("mousemove",$)}}),[r.hostElementRef,$]);var te=Object(k.useCallback)((function(e){var r=Object(I.m)(e,n.blockManager);Object(S.m)(C.H.HOVER_RIGHT,r)}),[]);Object(k.useEffect)((function(){l&&U&&z&&te(z)}),[l,U,z]),Object(k.useEffect)((function(){return n.blockManager.addListener(j.F,ee),D.S.on(D.p.COMMON.SELECTING_TAP_MOVE,ee),D.S.on(D.p.COMMON.SELECTING_TAP_STOP,ee),function(){n.blockManager.removeListener(j.F,ee),D.S.off(D.p.COMMON.SELECTING_TAP_MOVE,ee),D.S.off(D.p.COMMON.SELECTING_TAP_STOP,ee)}}),[ee]);var ne=" (".concat(B.b," + ").concat(B.l," + ")+"M)";return O.a.createElement("div",null,O.a.createElement("div",{className:y()(A.o,"suspension-comment-area"),ref:K,style:{display:f?"none":"block"}},O.a.createElement(o.a,{visible:U&&l,destroyTooltipOnHide:!0,title:t("CreationDoc_DocX_MenuOption_Comment")+ne,placement:"bottom"},O.a.createElement("button",{style:{display:q&&l?"flex":"none",top:g},type:"button",className:"comment-btn",onClick:Q,onMouseEnter:Y,onMouseLeave:Z},O.a.createElement(P.B,null)))),O.a.createElement(e,r))}}}]),r}(w.A)}).call(this,r("dx_E9Eu"))},dx_hJpx:function(e,n,r){"use strict";(function(t){var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_lSNA"),l=r.n(a),s=r("dx_RIqP"),u=r.n(s),d=r("dx_J4zp"),f=r.n(d),h=r("dx_e4eN"),p=r("dx_UtDZ"),v=r("dx_cDcd"),g=r.n(v),b=r("dx_h74D"),y=r("dx_xlCA"),m=r("dx_YzVl"),_=r("dx_PQBD"),k=r("dx_MoY1"),O=r("dx_A2Ao"),x=r("dx_E2oU"),E=r("dx_zEdG"),S=r("dx_Sj0J"),C=r("dx_f4Wj"),I=r("dx_Np2v"),B=r("dx_B28d"),T=r("dx_Elol"),w=r("dx_cGa6"),R=r("dx_AbAm"),M=r("dx_s1qv"),j=r("dx_lSlT"),D=r("dx_SDvP"),A=r("dx_ZG9w"),P=r("dx_kZ3l"),L=r("dx_vQix"),N=r("dx_awlV"),F=r("dx_k8kI"),U=r("dx_HA1r"),H=r("dx_WKyf");r("dx_W8WB");function V(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function W(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?V(Object(r),!0).forEach((function(n){l()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}p.resourceSchedulerHelpers.scheduler.addTask({name:"MentionPanel_preload",action:function(){return new Promise((function(e){p.MentionPanel.preload(),e(!0)}))}}),n.S=function(e){var n,r=e.onClose,i=e.blockManager,a=e.mark,s=e.blocks,d=e.identifier,V=e.options,z=e.maxHeight,G=e.selectionAPI,K=f()(s,1)[0],q=Object(S.A)(K,a),X=0===q[0]&&q[1]===Object(A.F)(K.model.zoneState),Y=(n=K.model.zoneState.getModelText()).slice.apply(n,u()(q)),J=Object(H.D)(Y),Z=Object(b.useSelector)(x.s),Q=Object(v.useState)(void 0),$=f()(Q,2),ee=$[0],te=$[1],ne=Object(v.useRef)(!1),re=g.a.useMemo((function(){return!!K&&!!U.w.find((function(e){return Object(_.R)(K.id,i,e)}))}),[K]),oe=Object(w.Q)()&&Object(L.N)(K.id,i)&&!Object(T.f)(K.id,i),ie=Object(v.useCallback)((function(e){var n=e.keyCode;n!==N.G.RIGHT&&n!==N.G.LEFT&&n!==N.G.ESC||(e.stopPropagation(),r())}),[r]);Object(v.useEffect)((function(){return document.addEventListener("keydown",ie,!0),function(){document.removeEventListener("keydown",ie,!0)}}),[ie]),Object(v.useEffect)((function(){J||p.mentionApis.fetchMentionList({config_source:0,obj_type:p.NUM_SUITE_TYPE.DOCX,source:p.SOURCE_ENUM.DOCX,token:Z,type:re?U.L.INLINE:U.L.ALL,user_type:0},(function(e){var n=Object(H.j)(e.data);te(n)}))}),[J,Z]);var ce=Object(v.useCallback)((function(e,n,r){var o=K.model,i=o.zoneState,c=o.zoneId;n=U.b.includes(i.getModelText().slice(n[1],n[1]+2))?[n[0],n[1]+2]:n;var a=Object(P.JI)(i,[n[0],n[1]]),l=Object(A.w)(K.model,a),s=new h.m({zoneId:c}).retain(n[0]).delete(n[1]-n[0]).insert(" ",W({inlineblock:r},l));K.model.apply(s,{extra:{op:e}}),e.replace(K.record.id,["text"],K.model.zoneState.toAttributeText())}),[K]),ae=Object(v.useCallback)((function(e,n,r){var o=K.model,i=o.zoneState,c=o.zoneId;n=U.b.includes(i.getModelText().slice(n[1],n[1]+2))?[n[0],n[1]+2]:n;var a=Object(P.JI)(i,[n[0],n[1]]),s=Object(A.w)(K.model,a),u=new h.m({zoneId:c}).retain(n[0]).delete(n[1]-n[0]).insert(" ",W(l()({},M.INLINE_COMPONENT_MARK,JSON.stringify(r)),s));K.model.apply(u,{extra:{op:e}}),e.replace(K.record.id,["text"],K.model.zoneState.toAttributeText())}),[K]),le=Object(v.useCallback)((function(e,n){var r=U.b.includes(K.model.zoneState.getModelText().slice(n[1],n[1]+2)),o=K.model.zoneState.remove(r?[n[0],n[1]+2]:n).toAttributeText();e.replace(K.record.id,["text"],o)}),[K]),se=g.a.useCallback((function(e,n,r){Object(E.P)("ccm_mention_panel_click",{record_id:K.props.recordId,block_type:K.props.type},{click:"mention_confirm",mention_type:e.type,mention_obj_id:e.id?Object(p.encryptTea)(e.id):null,is_send_notice_flag:String(n),domain:"text",is_operator_and_create_task_flag:r?String(n):""})}),[K]),ue=Object(v.useCallback)((function(){Object(E.T)("ccm_mention_panel_view",{record_id:K.props.recordId,block_type:K.props.type},{})}),[]);Object(v.useEffect)((function(){ue()}),[]);var de=Object(v.useCallback)(function(){var e=c()(o.a.mark((function e(n,c){var a,l,s,u,d,f,h,v,g,b,_,x,E,S,T,w,A,P,L,N,F,H,W,z,Y,J;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&!ne.current){e.next=2;break}return e.abrupt("return");case 2:console.log("mention-data",n),ne.current=!0,se(n,c,oe),a=n.type,l=n.entity,e.prev=6,e.t0=a,e.next=e.t0===U.D.USER?10:e.t0===U.D.CHAT?20:e.t0===U.D.WIKI||e.t0===U.D.DOC?45:58;break;case 10:return s="",e.next=13,i.applyTransaction("mention user",(function(e){y.n.setCache(l.id,{name:l.name,avatar_url:""});var n=Object(M.generateInlineComponent)(M.INLINE_COMPONENT_TYPE.USER,{uid:l.id});s=n.id,ae(e,q,n)}),{afterTransactionAccepted:function(){y.n.fetch(K.record.id,l.id)}});case 13:if(!oe){e.next=18;break}if(!c){e.next=17;break}return Object(R.t)(K,i,{assigneeIds:[l.id]}),e.abrupt("break",59);case 17:c=!1;case 18:return O.S.addMentionNotify(l,K,s,c,V.source===B.B.TODO),e.abrupt("break",59);case 20:return u=l.id,e.prev=21,f=i.getRecordByBlockId(i.rootBlockId).id,e.next=25,Object(C.W)(u,f);case 25:if(!(h=e.sent.data).RespCode){e.next=29;break}return Object(m.F)({type:"error",content:I.X[h.RespCode]}),e.abrupt("break",59);case 29:d=h.Token,e.next=38;break;case 32:return e.prev=32,e.t1=e.catch(21),g=e.t1,b=I.X[null===g||void 0===g||null===(v=g.data)||void 0===v?void 0:v.RespCode]||t("common.network_error"),Object(m.F)({type:"error",content:b}),e.abrupt("break",59);case 38:return _=K,x=0,K.parentId&&(_=i.getBlockViewByBlockId(K.parentId),E=_.snapshot.children.findIndex((function(e){return e===K.record.id})),x=E>=0?E+1:0),e.next=43,i.applyTransaction("mention chat",(function(e){Object(k.l)(e,_.record.id,x,[i.createInitModel(B.B.CHAT_CARD,{chat_id:u,chat_token:d})]),X&&_!==K&&i.hasBlockViewByBlockId(K.id)?(Object(k.y)(e,[K.model]),K.model.children.length>0&&Object(k.t)(e,_.record.id,K.model.position+1,K.model.children.map((function(e){return e.recordId})))):le(e,q)}));case 43:return G.restoreFocus(),e.abrupt("break",59);case 45:if(T=(S=l).id,w=S.name,A=S.type,P=S.url,L=S.token,F=(N="wiki"===a&&!!L)?L:T,H=N?U.F[p.NUM_SUITE_TYPE.WIKI]:A,W=Number(Object.keys(U.F).find((function(e){return U.F[e]===H}))),!P||!W){e.next=57;break}return z=w,j.S.setDocInfo(F,{title:z,url:P,mentionType:W}),Y=Object(M.generateInlineComponent)(M.INLINE_COMPONENT_TYPE.DOC,{file_type:W,token:F,raw_url:P,title:z}),e.next=56,i.applyTransaction("mention doc",(function(e){ae(e,q,Y)}));case 56:setTimeout((function(){i.dispatch(D.j,[K,{token:F,title:w,mentionType:W,componentId:Y.id}])}),0);case 57:case 58:return e.abrupt("break",59);case 59:K.model.isDestroyed||(J=q[0]+1,K.model.setSelection({start:J,len:0},!0)),e.next=65;break;case 62:e.prev=62,e.t2=e.catch(6),console.error(e.t2);case 65:r(),ne.current=!1;case 67:case"end":return e.stop()}}),e,null,[[6,62],[21,32]])})));return function(n,r){return e.apply(this,arguments)}}(),[K,i,q,ce,r,V.source,oe]),fe=V.defaultActiveTab,he=V.singleTab,pe=Object(v.useCallback)((function(e){e.preventDefault()}),[]),ve=Object(v.useMemo)((function(){return{maxHeight:z}}),[z]);return g.a.createElement("div",{className:"docx-mention-box",style:ve,onMouseDown:pe},g.a.createElement(p.MentionPanel,{query:J,onSelect:de,tabs:Object(H.X)({identifier:d,defaultActiveTab:fe,singleTab:he,inline:re}),filter:{isCrossTenant:!0,userFilter:{isResigned:!1},docFilter:{onlyTitle:!0}},recommendList:ee,defaultActiveTab:fe,focusOnOuter:function(){i.addListenerOnce(F.w2,(function(){K.model.isDestroyed||K.focus()}))},checkboxPlaceholder:oe?t("CreationDoc_Tasks_AddAsAssigneeAndCreateTask_CheckOption"):void 0,buttonTextMap:l()({},U.n.USER,oe?t("CreationDoc_Tasks_ConfirmCreateTask_Button"):void 0),keydownUseCapture:!0,showSkeleton:!ee,alternateTab:!0}))}}).call(this,r("dx_E9Eu"))},dx_hKIY:function(e,n,r){"use strict";r.d(n,"H",(function(){return R}));var o,i,c,a,l,s=r("dx_yG8O"),u=r.n(s),d=r("dx_lwsE"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_PJYZ"),g=r.n(v),b=r("dx_W7W2"),y=r.n(b),m=r("dx_a1gu"),_=r.n(m),k=r("dx_Nsbk"),O=r.n(k),x=r("dx_Uyc2"),E=r.n(x),S=(r("dx_A1AB"),r("dx_Vvd7")),C=r("dx_acOG"),I=r("dx_shqt"),B=r("dx_ij4R"),T=r("dx_XBgx");function w(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=O()(e);if(n){var i=O()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return _()(this,r)}}var R=Object(S.H)({providers:[I.a,T.v]})((l=function(e){y()(r,e);var n=w(r);function r(){var e;f()(this,r);for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];return e=n.call.apply(n,[this].concat(i)),u()(e,"editController",c,g()(e)),u()(e,"lazyConsumer",a,g()(e)),e}return p()(r,[{key:"init",value:function(){this.editController.init()}},{key:"destroy",value:function(){this.editController.destroy(),this.lazyConsumer.destroy()}}]),r}(S.G),i=l,c=E()(i.prototype,"editController",[C.N],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=E()(i.prototype,"lazyConsumer",[B.e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=i))||o},dx_hKul:function(e,n,r){"use strict";r.d(n,"M",(function(){return l}));var o=r("dx_UtDZ"),i=r("dx_h6a8"),c=r("dx_zEdG"),a=r("dx_CwnG"),l=function(e,n,r){var l=[],s=Object(a.p)(e,r.blockManager),u=Object(i.pick)(s,["record_id","block_type","sub_block_type"]);l.push({object_block_id:Object(o.encryptTea)(s.record_id),object_block_type:s.block_type,object_sub_block_type:s.sub_block_type,block_content_size:s.block_content_size});var d={target:n.target,click:r.click||"block_custom_action",action_type:n.actionType,action_value:n.actionValue,object_block_data:l};n.objectBlockExtraValue&&(d.object_block_extra_value=n.objectBlockExtraValue),Object(c.P)(r.eventName||"ccm_doc_content_page_click",u,d)}},dx_hMKL:function(e,n,r){"use strict";r.d(n,"F",(function(){return c}));var o=r("dx_fEKD"),i=r("dx_B28d");function c(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.B.IFRAME;return Object(o.b)(e,n)}},dx_hS6z:function(e,n,r){"use strict";r.d(n,"R",(function(){return c}));var o=r("dx_LcNA"),i=r("dx_cDcd"),c=function(e){var n=e.containerEditor,r=e.isEditMode,c=e.onIsEditModeChange,a=Object(i.useCallback)((function(){r||null===c||void 0===c||c(!1)}),[r,c]);Object(i.useEffect)((function(){return n.on(o.L.BLUR,a),function(){n.off(o.L.BLUR,a)}}),[n,a])}},dx_hSCS:function(e,n,r){"use strict";var o=r("dx_g499");r.d(n,"h",(function(){return o.h}))},dx_haL5:function(e,n,r){"use strict";r.d(n,"A",(function(){return Ir})),r.d(n,"v",(function(){return Ue.v})),r.d(n,"J",(function(){return Ue.J}));var o=r("dx_yG8O"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_PJYZ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_Uyc2"),m=r.n(y),_=(r("dx_A1AB"),r("dx_Vvd7")),k=r("dx_xjz2"),O=r("dx_B28d"),x=r("dx_N9dL"),E=r("dx_Rux1"),S=r("dx_Lkek"),C=r("dx_JUA0");function I(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var B=function(e){h()(r,e);var n=I(r);function r(e){return a()(this,r),n.call(this,e)}return s()(r,[{key:"cellId",get:function(){var e=this.parent.snapshot.columns_id.length,n=Math.floor(this.position/e),r=this.position%e,o=this.parent.snapshot.columns_id[r],i=this.parent.snapshot.rows_id[n];return"".concat(i).concat(o)}}]),r}(r("dx_NMQJ").D);B.type=O.B.CELL;var T,w=r("dx_J4zp"),R=r.n(w),M=r("dx_lSNA"),j=r.n(M),D=r("dx_jtB3"),A=r("dx_QxNg"),P=r("dx_h6a8"),L=r("dx_Z22N"),N=r("dx_RIqP"),F=r.n(N),U=r("dx_JWrU"),H=r("dx_GWFd"),V=new(function(){function e(){a()(this,e),this.globalRowToBlockId=1,this.rowToBlockIdMap=new Map}return s()(e,[{key:"getBlockIdByRowId",value:function(e,n){var r=this.rowToBlockIdMap.get(e);r||(r=new Map,this.rowToBlockIdMap.set(e,r));var o=r.get(n);return o||(o=Object(H.F)(U.b,this.globalRowToBlockId++),r.set(n,o)),o}},{key:"getRowIdByBlockId",value:function(e,n){var r=this.rowToBlockIdMap.get(e);return F()(r.entries()).find((function(e){var r=R()(e,2);r[0];return r[1]===n}))[0]}},{key:"deleteTable",value:function(e){this.rowToBlockIdMap.delete(e)}}]),e}()),W=r("dx_b9bF"),z=r("dx_QBqw");function G(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function K(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?G(Object(r),!0).forEach((function(n){j()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var q,X,Y,J,Z=Object(k.s)(L.I)(T=function(){function e(){a()(this,e),this.type=O.B.TABLE,this.config={defaultHeight:200,defaultMarginTop:32,defaultMarginBottom:24},this.tableInfoMap=new Map}return s()(e,[{key:"getLayoutNodeConfig",value:function(e,n,r){r&&this.initTableInfo(e);var o=n&&!n.show?{calculateModel:D.j.IGNORE}:{};return K(K({},this.config),{},{calculateModel:D.j.VERTICAL,isAsync:!0},o)}},{key:"iterateLayoutNodeChildren",value:function(e,n,r){var o=this.tableInfoMap.get(e.id),i=n&&!n.show?{calculateModel:D.j.IGNORE}:{};null===o||void 0===o||o.rows.forEach((function(e){var n=o.rowMap.get(e);r(n.rowBlockId,K(K(K({},Object(W.a)()),i),{},{childIds:n.cells}))}))}},{key:"initTableInfo",value:function(e){var n=e.snapshot,r=n.rows_id,o=n.columns_id,i=n.cell_set,c=[],a=new Map,l=new Map;this.tableInfoMap.set(e.id,{rows:c,rowMap:a,cellIdMap:l});var s=new Map;e.children.forEach((function(e){s.set(e.recordId,e)}));for(var u=0,d=r.length;u<d;++u){var f=r[u],h=[],p={rowId:f,rowBlockId:V.getBlockIdByRowId(e.id,f),cells:h};c.push(f),a.set(f,p);for(var v=0,g=o.length;v<g;++v){var b,y=o[v],m=Object(z.y)(f,y),_=null===(b=i[m])||void 0===b?void 0:b.block_id;if(_){var k=s.get(_);h.push(k.id),l.set(_,m)}}}}},{key:"update",value:function(e,n,r,o){if(e.updateRaw(e.getChangeNode(n.id),o),!o&&r&&r.ops){var i=r.ops,c=new Set;if(i.forEach((function(e){var n=e.p;Object(A.bG)(e)&&n.length>=2&&"column_set"===n[0]&&c.add(n[1])})),c.size){var a=this.ensureTableInfo(n),l=r.options;n.children.forEach((function(n){var r=a.cellIdMap.get(n.recordId),o=Object(z.i)(r),i=R()(o,2)[1];c.has(i)&&e.update(n,{model:n,options:l},!0)}))}}}},{key:"insertChild",value:function(e,n,r){var o=n.snapshot,i=this.ensureTableInfo(n),c=Object(P.findKey)(o.cell_set,(function(e){return e.block_id===r.recordId})),a=Object(z.i)(c),l=R()(a,2),s=l[0],u=l[1];i.cellIdMap.set(r.recordId,c);var d=i.rowMap.get(s);if(!d){d={rowId:s,rowBlockId:V.getBlockIdByRowId(n.id,s),cells:[]},i.rowMap.set(s,d);var f=o.rows_id.indexOf(s);i.rows.splice(f,0,s);var h=e.getChangeNode(n.id);e.insertChildRaw(h,f,d.rowBlockId,Object(W.a)())}var p=o.columns_id.indexOf(u);d.cells.splice(p,0,r.id);var v=this.getRowChangeNode(e,d.rowBlockId);e.insertChildRaw(v,p,r.id),r.children.forEach((function(n){e.insertChild(r,n)}))}},{key:"removeChild",value:function(e,n,r){var o=this.ensureTableInfo(n),i=o.cellIdMap.get(r.recordId),c=Object(z.i)(i),a=R()(c,1)[0];o.cellIdMap.delete(r.recordId);var l=o.rowMap.get(a),s=l.cells.indexOf(r.id);l.cells.splice(s,1);var u=this.getRowChangeNode(e,l.rowBlockId);if(e.removeChildRaw(u,s,r.id),e.removeChildrenRecursively(r),!l.cells.length){var d=o.rows.indexOf(a);o.rows.splice(d,1),o.rowMap.delete(a);var f=e.getChangeNode(n.id);e.removeChildRaw(f,d,l.rowBlockId)}o.rows.length||this.clearTableInfo(n)}},{key:"ensureTableInfo",value:function(e){var n=this.tableInfoMap.get(e.id);return n||this.tableInfoMap.set(e.id,n={rows:[],rowMap:new Map,cellIdMap:new Map}),n}},{key:"clearTableInfo",value:function(e){V.deleteTable(e.id),this.tableInfoMap.delete(e.id)}},{key:"getRowChangeNode",value:function(e,n){var r=e.getChangeNode(n);return r.config||(r.config=Object(W.a)()),r}}]),e}())||T,Q=r("dx_IyNS"),$=r("dx_MhLi"),ee=Object(k.s)($.I)(q=function(){function e(){a()(this,e),this.type=O.B.CELL}return s()(e,[{key:"getLayoutNodeConfig",value:function(e,n){var r={calculateModel:(null===n||void 0===n?void 0:n.show)?D.j.VERTICAL:D.j.IGNORE},o=e.parent;if(o){var i=o.record.snapshot;if(i.cell_set){var c=Object.values(i.cell_set).find((function(n){return n.block_id===e.record.id})),a=!0;Object(Q.y)(o.id,o.snapshot).cellsLayout.forEach((function(n){n.forEach((function(n){n.cellRecordId===e.recordId&&(a=n.cellId===n.sourceCellId)}))})),c&&(r.rowSpan=c.merge_info.row_span,r.colSpan=c.merge_info.col_span,r.cellVisible=a)}}return r}}]),e}())||q,te=r("dx_PiBr"),ne=Object(k.s)(te.R)(X=function e(){a()(this,e),this.type=O.B.TABLE,this.traverse=function(e){return Object(z.T)(e)}})||X,re=r("dx_MoY1"),oe=r("dx_NsKf"),ie=(Y=function(){function e(){a()(this,e),i()(this,"model",J,this),this.sub=void 0}return s()(e,[{key:"init",value:function(){this.sub=this.model.interceptChange$.subscribe((function(e){var n=e.options,r=e.recordOps,o=e.op;n.from===A.H.local&&"undo"!==n.transactionName&&r.forEach((function(e){var n=e.record;if(n.snapshot.type===O.B.CELL){var r=n.snapshot.children;null!=r&&r.length>0||Object(re.l)(o,n.id,0,[Object(oe.u)()])}}))}))}},{key:"destroy",value:function(){var e;null===(e=this.sub)||void 0===e||e.unsubscribe()}}]),e}(),J=m()(Y.prototype,"model",[_.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Y),ce=r("dx_o0o1"),ae=r.n(ce),le=r("dx_yXPU"),se=r.n(le),ue=r("dx_iWIM"),de=r.n(ue),fe=r("dx_cDcd"),he=r.n(fe),pe=r("dx_NLUy"),ve=r("dx_b28D"),ge=r("dx_MGoZ"),be=r("dx_ZG9w"),ye=r("dx_kZ3l"),me=r("dx_iw8O"),_e=r("dx_bbfH"),ke=r("dx_BEcL"),Oe=r("dx_TSYQ"),xe=r.n(Oe),Ee=r("dx_yzqx"),Se=r("dx_a3US"),Ce=r("dx_JsDk"),Ie=r("dx_NOtv"),Be=r.n(Ie),Te=r("dx_O7Od"),we=r("dx_CqjN");function Re(e){return Object(we.d)(e)instanceof MouseEvent}function Me(e){return 0===e.button}function je(e){e.preventDefault()}function De(e){Object(fe.useEffect)((function(){if(e)return e.addEventListener("touchstart",je),function(){e.removeEventListener("touchstart",je)}}),[e])}var Ae,Pe=Be()("table:ResizerItem"),Le=function(e){var n=e.tableHeight,r=e.width,o=e.index,i=e.columnWidthManager,c=e.isHoverCellBorder,a=i.resizingIndex,l=i.columnWidths,s=i.handleResizeStart,u=i.handleResize,d=Object(fe.useState)(!1),f=R()(d,2),h=f[0],p=f[1],v=Object(fe.useRef)(null),g=v.current,b=a===o,y=o===l.length-1,m=b||h||c||y,_=b||null===a&&h;0===o&&Pe("index=%s, highlight=%s, visible=%s(%s||%s||%s||%s)",o,_,m,b,h,c,y);var k=function(e){return n="mouseenter"===e.type,r=e.type,Pe("[%s] setIsHovered to %s, index=%d",r,n,o),void p(n);var n,r};return De(g),he.a.createElement("div",{className:"column-resizer-item",style:{minWidth:r}},he.a.createElement("div",{className:xe()("resizer-line-hotzone",j()({visible:m,highlight:_},Te.T,!0)),style:{height:n},onPointerDown:function(e){Pe("handlePointerDown(%s), index=%s",e.type,o),Object(we.U)(e),s(e,o)},onPointerMove:u,onMouseEnter:k,onMouseLeave:k,ref:v},he.a.createElement("div",{className:"resizer-line"})))},Ne=(r("dx_m7mq"),he.a.memo((function(e){var n=e.isHoverCellBorder,r=e.columnWidthManager,o=e.tableHeight,i=e.tableInfo,c=r.columnWidths,a=i.colIds,l=Object(fe.useMemo)((function(){return c.map((function(e,i){var c=a[i];return he.a.createElement(Le,{key:c,isHoverCellBorder:n,tableHeight:o,width:e,index:i,columnWidthManager:r})}))}),[c,n,o,r,a]);return he.a.createElement("div",{className:"column-resizer",contentEditable:!1},l)}))),Fe=r("dx_oNjD"),Ue=r("dx_oQO4"),He=r("dx_tq79");!function(e){e.TABLE="Table"}(Ae||(Ae={}));function Ve(){return Ve=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Ve.apply(this,arguments)}var We=he.a.createElement("path",{fill:"#C2C6CC",fillRule:"evenodd",d:"M4 14a2 2 0 110-4 2 2 0 010 4zm8 0a2 2 0 110-4 2 2 0 010 4zm8 0a2 2 0 110-4 2 2 0 010 4z"}),ze=function(e){return he.a.createElement("svg",Ve({width:24,height:24,viewBox:"0 0 24 24"},e),We)},Ge=(r("dx_tuYG"),function(e){return he.a.createElement(ze,{className:xe()("docx-table-drag",{"docx-table-drag--selected":e.isSelected})})});function Ke(){return Ke=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Ke.apply(this,arguments)}var qe=he.a.createElement("rect",{width:1,height:10,rx:.2,fill:"#8F959E"}),Xe=he.a.createElement("rect",{x:3,width:1,height:10,rx:.2,fill:"#8F959E"}),Ye=function(e){return he.a.createElement("svg",Ke({width:4,height:10,viewBox:"0 0 4 10",fill:"none"},e),qe,Xe)},Je=he.a.memo((function(e){var n=e.headerSelectionManager,r=e.columnWidthManager,o=e.headerIndex,i=e.headerType,c=e.lineWidth,a=e.ids,l=n.handleHeaderMouseDown,s=n.handleHeaderMouseEnter,u=n.handleHeaderTouch,d={headerIndex:o,headerType:i,lineId:a[o]},f=Object(He.N)(d,e),h=f.headerSelected,p=f.headerCls,v=f.resizeBtnCls,g=i===Ue.v.COLUMN,b=function(e){return u(e,d)},y=j()({},g?"width":"height",c+1);return he.a.createElement("div",{className:p,onTouchStart:b,onTouchEnd:b,onMouseDown:function(e){return l(e,d)},onMouseEnter:function(e){return s(e,d)},style:y,contentEditable:!1},he.a.createElement("div",{className:"table-header-placeholder"},Ce.R.enableResizerButton&&he.a.createElement(he.a.Fragment,null,he.a.createElement(Ge,{isSelected:h}),g&&r&&he.a.createElement(Ze,{className:v,columnWidthManager:r,headerIndex:o}))))}));function Ze(e){var n=e.columnWidthManager,r=e.className,o=e.headerIndex,i=n.handleResize,c=n.handleResizeStart,a=Object(fe.useRef)(null),l=a.current;return De(l),he.a.createElement("span",{className:r,onPointerDown:function(e){l&&(Object(we.U)(e),c(e,o))},onPointerMove:i,ref:a},he.a.createElement(Ye,null))}r("dx_H9H1");var Qe=Ue.v.COLUMN,$e=function(e){var n=e.ids,r=e.columnWidthManager,o=e.scrollerScrollLeft,i=e.tableVisibleWidth,c=r.columnWidths,a=Ce.R.isHeaderInScroller?void 0:i,l=c.map((function(r,o){return he.a.createElement(Je,Object.assign({},e,{key:n[o],lineWidth:r||Fe.P,headerType:Qe,headerIndex:o}))}));return he.a.createElement("div",{className:Object(He.s)(Qe),style:{width:a}},he.a.createElement("div",{className:"table-header-bar__inner",style:{transform:"translateX(".concat(-o,"px)")}},l))},et=Ue.v.ROW,tt=function(e){var n=e.rowInfos,r=e.ids,o=n.map((function(n,o){var i=n.height,c=n.index;return he.a.createElement(Je,Object.assign({},e,{key:r[o],lineWidth:i,headerType:et,headerIndex:c}))}));return he.a.createElement("div",{className:Object(He.s)(et)},o)};function nt(e){var n=e.recursionProps,r=e.tableInfo,o=e.rowInfos,i=e.scrollerScrollLeft,c=e.tableVisibleWidth,a=e.columnWidthManager,l=e.headerSelectionManager,s=r.colIds,u=r.rowIds;return he.a.createElement(he.a.Fragment,null,he.a.createElement($e,{ids:s,tableVisibleWidth:c,headerSelectionManager:l,scrollerScrollLeft:i,columnWidthManager:a,recursionProps:n}),he.a.createElement(tt,{ids:u,tableVisibleWidth:c,headerSelectionManager:l,rowInfos:o}))}var rt=r("dx_Muja"),ot=r("dx_SreQ"),it=r("dx_Wwog"),ct=r("dx_yU7P"),at=r("dx_D8nn"),lt=Be()("table:useTaskCellSelection");function st(e){var n=e.tableId,r=e.blockManager,o=e.selectionAPI,i=Object(fe.useState)(void 0),c=R()(i,2),a=c[0],l=c[1],s=Object(ct.r)((function(e){var o,i=function(e,n){var r,o=e.getBlockModelByBlockIdNotCheck(n);if(!o)return;var i=function(e,n){var r=e;for(;r;){if(r.type===n)return r;r=r.parent}return r}(o,O.B.CELL);if(!i)return;var c=e.getBlockViewByBlockIdNotCheck(i.id);if(!c)return;var a=null===(r=i.parent)||void 0===r?void 0:r.id;return{cellId:c.cellId,tableId:a}}(r,e);if(i){var c=i.cellId,s=i.tableId;o=n===s?c:void 0}lt("handleTaskSelectionChange, blockId=%s, focusCellId=%s",e,o),o!==a&&(lt("handleTaskSelectionChange: set focusTaskCellId to %s",o),l(o))})),u=Object(ct.r)((function(e,n){n.length&&a&&(lt("handleSelectionChange: clear focusTaskCellId"),l(void 0))}));return Object(fe.useEffect)((function(){return lt("mount event"),at.N.on(at.p.TASK.SELECTION_CHANGE,s),o.onSelectionChange(u),function(){at.N.off(at.p.TASK.SELECTION_CHANGE,s),o.offSelectionChange(u)}}),[s,u,o]),{focusTaskCellId:a}}var ut=Object(ve.h)("table:use-cell-selection"),dt={selectionType:null,focusedCell:null,selectedCells:null,selectionInTable:!1,selectedCellIds:[],source:null},ft=Object(it.S)(z.B);var ht=function(){function e(n,r){var o=this;a()(this,e),this.tableInfo=n,this.blockManager=r,this.getParentCellId=function(e){for(var n=o.tableInfo.tableId,r=o.blockManager.getBlockModelByBlockIdNotCheck(e.id);r;){if(!(r=r.parent))return;if(r.type===O.B.CELL){var i,c=r.cellId;return(null===(i=r.parent)||void 0===i?void 0:i.id)===n?c:null}}return null}}return s()(e,[{key:"getCellSelection",value:function(e,n,r){var o=this.getCellSelectionIds(e,n),i=o.selectionType,c=o.focusCellId,a=o.selectedCellIds,l=this.tableInfo,s=l.cellsLayout,u=l.tableSnapshot,d=a.length?Object(z.C)({cellIds:a,layoutInfo:s,snapshot:u}):null,f=c?ft(c,u):[-1,-1],h=R()(f,2),p=h[0],v=h[1];return{selectionType:i,selectedCells:d&&d.endCol>=0?d:null,focusedCell:v>=0?{col:v,row:p}:null,selectionInTable:Boolean(d),selectedCellIds:a,source:r}}},{key:"getCellSelectionIds",value:function(e,n){return e.length?this.getCellSelectionIdsFromSelBlocks(e):{selectionType:n?Ue.u.cellInner:null,focusCellId:n,selectedCellIds:n?[n]:[]}}},{key:"getCellSelectionIdsFromSelBlocks",value:function(e){var n,r,o=null,i=this.getSelectedParentCellIds(e);return i.length?(o=Ue.u.cellInner,r=[n=i[0]]):(o=Ue.u.cell,1===(r=this.getSelectedCellIds(e)).length&&(n=r[0])),{selectionType:o,focusCellId:n,selectedCellIds:r}}},{key:"getSelectedCellIds",value:function(e){var n=this,r=this.tableInfo.tableId;return e.map((function(e){return n.blockManager.getBlockViewByBlockIdNotCheck(e.id)})).filter((function(e){return e&&e.type===O.B.CELL&&e.parentId===r})).map((function(e){return e.cellId}))}},{key:"getSelectedParentCellIds",value:function(e){var n=e.map(this.getParentCellId).filter(P.identity);return F()(new Set(n))}}]),e}();function pt(e){return[e.lineIds[e.headerIndex]]}function vt(e){var n=e.selLineIds,r=e.lineIds[e.headerIndex],o=n.findIndex((function(e){return e===r})),i=F()(n);return o>=0?i.splice(o,1):i.push(r),i}function gt(e){var n=e.selLineIds,r=e.lineIds,o=e.headerIndex;if(!n.length)return[r[o]];var i=n.map((function(e){return r.findIndex((function(n){return n===e}))})).sort((function(e,n){return e-n})),c=-1,a=o;if(i.every((function(e,n,r){return 0===n||r[n]-r[n-1]===1}))){o<i[0]?(c=o,a=i[i.length-1]):(c=i[0],a=o)}else{var l=n[n.length-1],s=l?r.findIndex((function(e){return e===l})):0,u=o<s;c=u?o:s,a=u?s:o}return c<0||a<0?n:r.slice(c,a+1)}var bt=r("dx_zghO"),yt=function(){};function mt(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function _t(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?mt(Object(r),!0).forEach((function(n){j()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mt(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var kt=Object(Ie.debug)("table:useHeaderSelection");function Ot(e){kt(".callHook: props=%O",e);var n=e.recursionProps,r=e.tableInfo,o=e.updateFocusHeaderType,i=e.hookEnabled,c=e.ctx,a=n.selectionAPI,l=n.blockManager,s=r.colIds,u=r.rowIds,d=r.tableId,f=Object(fe.useState)(!1),h=R()(f,2),p=h[0],v=h[1],g=Object(fe.useState)(null),b=R()(g,2),y=b[0],m=b[1],_=Object(fe.useState)(!1),k=R()(_,2),O=k[0],x=k[1],E=function(e){var n=e.tableInfo,r=e.selectionAPI,o=e.blockManager,i=e.hookEnabled,c=e.ctx,a=n.tableId,l=n.colIds,s=n.rowIds,u=c.logId,d=Object(fe.useState)(dt),f=R()(d,2),h=f[0],p=f[1],v=st({blockManager:o,tableId:a,selectionAPI:r}).focusTaskCellId,g=Object(Se.r)((function(e,i){var c,a,l,s=new ht(n,o),d=(null===(c=r.getContext())||void 0===c?void 0:c.source)||null,f=s.getCellSelection(i,v,d),h=f.selectedCells;p((function(e){return Object(P.isEqual)(e,f)?e:f})),ut(u,"handleSelectionChange(%s,%s=>%s): %s cells selected, selectionType=%s, focus=(%s,%s), col=[%s,%s], row=[%s,%s], focusTask=%s, %O",d,e.length,i.length,f.selectedCellIds.length,f.selectionType,null===(a=f.focusedCell)||void 0===a?void 0:a.col,null===(l=f.focusedCell)||void 0===l?void 0:l.row,null===h||void 0===h?void 0:h.startCol,null===h||void 0===h?void 0:h.endCol,null===h||void 0===h?void 0:h.startRow,null===h||void 0===h?void 0:h.endRow,Boolean(v),f)}));return Object(fe.useEffect)((function(){if(i)return r.onSelectionChange(g),r.onSelectionChanging(g),function(){r.offSelectionChange(g),r.offSelectionChanging(g)}}),[g,r,i]),Object(fe.useEffect)((function(){i&&g([],r.getSelection())}),[v,l,s,r,g,i]),h}({tableInfo:r,selectionAPI:a,blockManager:l,hookEnabled:i,ctx:c}),S={showMobileMenu:yt,hideMobileMenu:yt},C=S.showMobileMenu,I=S.hideMobileMenu,B="table=".concat(d," "),T=function(e){kt("%s%s.clearHeaderSelection",B,e),m(null),o(null)},w=Object(Se.r)((function(e,n){var i,c=function(e,n){var r=e.selectedLineIds,o=e.focusHeader,i=e.headerType,c=r.length;if(0===c)return null;var a=xt(n,i);if(o){var l=o.lineId;if(r.indexOf(l)>=0)return o}var s=r[c-1],u=a.indexOf(s);return{headerType:i,headerIndex:u,lineId:s}}(e,r);kt("%s%s.updateHeaderSelection: %s %ss, start=%s, focus=%s, click=%s",B,n,e.selectedLineIds.length,e.headerType,e.startHeader.headerIndex,null===c||void 0===c?void 0:c.headerIndex,null===(i=e.focusHeader)||void 0===i?void 0:i.headerIndex);var a=e.focusHeader===c?e:_t(_t({},e),{},{focusHeader:c});m(a),o(c?a.headerType:null)})),M=Object(Se.r)((function(e,n){kt("%s%s.updateHeaderSelecting: %s",B,n,e),v(e),at.N.trigger(at.p.TABLE.TABLE_HEADER_SELETING_CHANGE,[e])})),j=Object(Se.r)((function(e){M(!1,e.type)})),D=Object(Se.r)((function(e,n){var o="".concat(n,".selectCells"),i=e.headerType,c={selectedLineIds:e.selectedLineIds,tableInfo:r,blockManager:l,headerType:i},s=Object(z.Jd)(c);kt("%s%s: select %s cells for %s %ss",B,o,s.length,e.selectedLineIds.length,e.headerType),Object(rt.S)(s,a.getSelection())?(kt("%s%s: no selection change, emit headerclick manually",B,o),at.N.emit(at.p.TABLE.TABLE_HEADER_CLICK),Ee.Z.isMobile&&C({source:bt.q.TableHeader,useLastParams:!0})):(a.setSelection(s,{source:bt.q.TableHeader}),Ee.Z.isMobile&&at.N.emit(at.p.TOOLBAR.HIDE_DOC_TOOL_BAR))})),A=function(e,n,o,i){Object(ot.P)()&&(Ee.S.isIOS||Ee.S.isIPad)&&a.restoreFocus();var c=n.headerType,l=n.headerIndex,s=function(e){return{isPressCtrl:e.ctrlKey||e.metaKey,isPressShift:e.shiftKey}}(e);kt("%s%s.selectHeader(%s): %s.%s, ctrl/shift=%s/%s, selecting=%s",B,i,e.type,c,l,s.isPressCtrl,s.isPressShift,o);var u=xt(r,c),d=function(e,n){var r=n.isPressCtrl;return(n.isPressShift?gt:r?vt:pt)(e)}({selLineIds:y&&y.headerType===c?y.selectedLineIds:[],lineIds:u,headerIndex:l},s),f="".concat(i,".selectHeader");w({headerType:c,startHeader:n,focusHeader:n,selectedLineIds:d},f),M(o,f)},L=Object(Se.r)((function(e,n){kt(".handleHeaderClick"),e.preventDefault(),A(e,n,!1,"handleHeaderClick")})),N=Object(fe.useRef)(Object(we.S)({onClick:L})),F=Object(Se.r)((function(e,n){kt(".handleHeaderTouch: e=%O, header=%O",e,n),"touchstart"===e.type?x(!0):"touchend"===e.type&&x(!1),N.current(e,n)}));Object(fe.useEffect)((function(){if(p)return kt("%sstart header selecting, add mouseup listener",B),document.addEventListener("mouseup",j,{capture:!0,once:!0}),function(){kt("%send header selecting, remove mouseup listener",B),document.removeEventListener("mouseup",j,!0)}}),[p,j,a,B]);var U=Object(Se.r)((function(){if(null!==y){var e=y.selectedLineIds,n=y.headerType,r=y.focusHeader,o=n===Ue.v.COLUMN?s:u,i=e.filter((function(e){return o.includes(e)})),c=function(e,n){if(!e)return e;var r=e,o=n.indexOf(e.lineId);o<0?r=null:e.headerIndex!==o&&(r=_t(_t({},e),{},{headerIndex:o}));return r}(r,o);if(c!==r||i.length!==e.length){var a=_t(_t({},y),{},{selectedLineIds:i,focusHeader:c});w(a,"refreshHeaderSelection")}}}));Object(fe.useEffect)((function(){U()}),[s,u,U]);var H=Object(Se.r)((function(){var e=E.source,n=E.selectionType,r=E.selectionInTable,o=E.selectedCellIds;if(kt("%sonCellSelectionChange(%s): %s cells selected, selectionType=%s, %O",B,e,o.length,n,E),e!==bt.q.TableHeader)T("cellSelection.changed.".concat(e)),I();else if(r)C({source:e});else{y&&y.selectedLineIds.length&&T("cellSelection.empty.other_table_header_selected")}}));return Object(fe.useEffect)((function(){H()}),[E,H]),Object(fe.useEffect)((function(){y&&D(y,"headerSelection.changed")}),[y,D]),{headerSelection:y,cellSelection:E,headerSelecting:p,isHeaderDragging:O&&i,handleHeaderTouch:F,handleHeaderMouseDown:function(e,n){kt(".handleHeaderMouseDown, e=%O",e),Me(e)&&A(e,n,!0,"handleHeaderMouseDown")},handleHeaderMouseEnter:function(e,n){var r=n.headerType,o=n.headerIndex;if(null!==y&&p&&y.headerType===r){var i=y.startHeader,c=Object(z.N)([i.headerIndex,o]),a=R()(c,2),l=a[0],d=a[1],f=(r===Ue.v.COLUMN?s:u).slice(l,d+1);w({startHeader:i,headerType:r,selectedLineIds:f,focusHeader:n},"handleHeaderMouseEnter(".concat(e.type,")"))}}}}function xt(e,n){return n===Ue.v.COLUMN?e.colIds:e.rowIds}var Et=r("dx_B4B2"),St=Be()("table:useHoverCellBorder");function Ct(e,n,r){var o=Object(fe.useState)(!1),i=R()(o,2),c=i[0],a=i[1],l=Object(Et.S)((function(r){var o=function(r){var o=r.target.closest(".table-cell-block");if(!o)return!1;var i=Object(me.n)(o);if(!i)return!1;var c=n.getBlockViewByBlockIdNotCheck(i);if(!c||c.parentId!==e)return!1;var a=c.getHostRect(),l=Math.abs(r.clientX-(a.x+a.width)),s=Math.abs(r.clientX-a.x);return l<_e.J||s<_e.J}(r);o!==c&&(St("table=%s hovering: %s",e,o),a(o))}),60);return Object(fe.useEffect)((function(){if(r)return St("add mousemove listener to document"),document.addEventListener("mousemove",l),function(){St("remove mousemove listener from document"),document.removeEventListener("mousemove",l)}}),[l,r]),{isHoverCellBorder:c}}var It=r("dx_bdgK"),Bt=function(e){var n=e.callback,r=e.element,o=r&&r.current,i=Object(fe.useRef)();Object(fe.useEffect)((function(){return i&&i.current&&o&&i.current.unobserve(o),i.current=new It.S(n),o&&i.current&&i.current.observe(o),function(){i&&i.current&&o&&i.current.unobserve(o)}}),[o])},Tt=r("dx_MG1i"),wt=r("dx_Ogyw"),Rt=r("dx_faye"),Mt=r.n(Rt),jt=r("dx_N2Lq"),Dt=r("dx_dWqj");function At(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Pt(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?At(Object(r),!0).forEach((function(n){j()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):At(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var Lt,Nt=Be()("table:useAddLineSymbol"),Ft=new at.i;function Ut(e){var n=F()(e);return e.forEach((function(e,r){r>0&&(n[r]=n[r-1]+e)})),n}!function(e){e.TABLE_HIDE_ADD_LINE_SYMBOL="tableHideAddLineSymbol"}(Lt||(Lt={}));var Ht=r("dx_TfZh");function Vt(e){var n=e.className,r=e.style,o=e.delayMs,i=e.onMouseEnter,c=e.children,a=void 0===c?null:c,l=Object(Ht.S)((function(e){return i(e)}),o,{maxWait:o}),s=Object(Se.r)((function(){l.cancel()}));return Object(fe.useEffect)((function(){return function(){l.cancel()}})),he.a.createElement("div",{className:n,style:r,onMouseEnter:l,onMouseOut:s},a)}function Wt(e){var n=e.rowInfos,r=e.tableVisibleWidth,o=e.isAddLineSymbolVisible,i=e.updateAddLineSymbolStatus,c=n.map((function(e){return e.height})),a=Object(fe.useMemo)((function(){return[_e.X6].concat(F()(function(e){var n=function(e){var n=[],r=0;return e.forEach((function(e){r++,0!==e&&(n.push(r),r=0)})),n}(e);return function(e){var n=e.map((function(e){return e.map((function(){return e[e.length-1]/e.length}))}));return Object(P.flatten)(n)}(function(e,n){var r=0;return n.map((function(n){var o=r,i=r+n;return r=i,e.slice(o,i)}))}(e,n))}(c)))}),[c]),l=Object(fe.useMemo)((function(){return Ut(a)}),[a]),s=Object(ct.r)((function(e){var c=l[e]-_e.X6;i({isVertical:!1,offset:0===e?c+1:c,lineLength:r,visible:o,position:0===e?0:n[e-1].index+1},"handleMouseEnterRowPoint")})),u=Object(fe.useMemo)((function(){return a.map((function(e,n){var r=e-_e.X6;return he.a.createElement(Vt,{key:n.toString(),className:"table-insert-hotzone docx-row",style:{marginTop:r},delayMs:_e.oD,onMouseEnter:function(){return s(n)}},he.a.createElement("div",{className:"table-insert-point docx-row"}))}))}),[a,s]);return Object(fe.useMemo)((function(){return he.a.createElement("div",{className:"table-insert-bar docx-row"},u)}),[u])}r("dx_Yawu");function zt(e){var n=e.recursionProps,r=e.rowInfos,o=e.tableHeight,i=e.tableVisibleWidth,c=e.tableInfo,a=e.scrollerScrollLeft,l=e.columnWidthManager,s=e.setIsHighlightedHoverEqual,u=e.setIsPopoverToolbarHide,d=l.isResizing,f=l.columnWidths,h=!d,p=function(e){var n=e.recursionProps,r=e.tableInfo,o=e.setIsHighlightedHoverEqual,i=e.setIsPopoverToolbarHide,c=n.blockManager,a=n.selectionAPI,l=Object(fe.useState)({isVertical:!0,offset:0,lineLength:0,visible:!1,position:-1}),s=R()(l,2),u=s[0],d=s[1],f=u.isVertical,h=u.visible,p=u.position,v=Object(ct.r)((function(e,n){Nt("%s.setStatus: visible=%s, index=%s",n,e.visible,e.position),d(e)})),g=Object(ct.r)((function(e){Nt("hide symbol, caller=%s",e),u.visible&&d(Pt(Pt({},u),{},{visible:!1}))})),b=Object(ct.r)((function(e){g("handleHideAddLineSymbol.".concat(e.type))})),y=Object(ct.r)(se()(ae.a.mark((function e(){var n,o,i,l;return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=f?Ue.v.COLUMN:Ue.v.ROW,e.next=3,Object(ke.L)({blockManager:c,position:p,tableInfo:r,lineType:n});case 3:void 0!==(o=e.sent)&&void 0!==(l=null===(i=c.getBlockIdsByRecordId(o))||void 0===i?void 0:i[0])&&a.setSelection([{type:bt.j.TEXT,id:l,selection:{start:0,end:0}}]);case 5:case"end":return e.stop()}}),e)}))));return Object(fe.useEffect)((function(){Object(jt.E)(!f&&h)}),[h,f]),Object(fe.useEffect)((function(){return Ft.on(Lt.TABLE_HIDE_ADD_LINE_SYMBOL,g),function(){Ft.off(Lt.TABLE_HIDE_ADD_LINE_SYMBOL,g)}}),[]),{addLineSymbol:Object(fe.useMemo)((function(){return null===i||void 0===i||i(h),h&&o(!1),he.a.createElement(Dt.Z,{status:u,onLeave:b,onClick:y})}),[u,h,o,i,b,y]),updateAddLineSymbolStatus:v}}({recursionProps:n,tableInfo:c,setIsHighlightedHoverEqual:s,setIsPopoverToolbarHide:u}),v=p.addLineSymbol,g=p.updateAddLineSymbolStatus,b=function(e){var n=e.columnWidths,r=e.scrollerScrollLeft,o=e.tableVisibleWidth,i=e.tableHeight,c=e.isAddLineSymbolVisible,a=e.updateAddLineSymbolStatus,l=Object(fe.useMemo)((function(){return[_e.I].concat(F()(n))}),[n]),s=Object(fe.useMemo)((function(){return Ut(l)}),[l]),u=Object(ct.r)((function(e){var n=s[e]-_e.I-r;a({isVertical:!0,offset:0===e?n+1:n,lineLength:i,visible:c,position:e},"handleMouseEnterColPoint")})),d=Object(fe.useMemo)((function(){return l.map((function(e,n){var r=e-_e.I;return he.a.createElement(Vt,{key:n.toString(),className:"table-insert-hotzone docx-col",style:{marginLeft:r},delayMs:_e.oD,onMouseEnter:function(){return u(n)}},he.a.createElement("div",{className:"table-insert-point docx-col"}))}))}),[l,u]);return Object(fe.useMemo)((function(){return he.a.createElement("div",{className:"table-insert-bar docx-col",style:{width:o+2*_e.v}},he.a.createElement("div",{className:"table-insert-bar-inner",style:{transform:"translateX(".concat(-r,"px)")}},d))}),[d,o,r])}({columnWidths:f,scrollerScrollLeft:a,tableVisibleWidth:i,tableHeight:o,isAddLineSymbolVisible:h,updateAddLineSymbolStatus:g});return{columnInsertBar:b,rowInsertBar:Wt({rowInfos:r,tableVisibleWidth:i,isAddLineSymbolVisible:h,updateAddLineSymbolStatus:g}),addLineSymbol:v}}var Gt=r("dx_g8Ef"),Kt=r("dx_B2xN"),qt=r("dx_rQGm"),Xt=r("dx_k7kY"),Yt=r("dx_Am54"),Jt=r("dx_VkAN"),Zt=r.n(Jt),Qt=r("dx_FBWK"),$t=r("dx_Dtiu"),en=r.n($t),tn=r("dx_MWd8");function nn(){var e=Zt()(["\n  width: 40px;\n  height: 26px;\n  cursor: grab;\n  background-color: ",";\n  &:hover {\n    background: ",";\n  }\n  & > svg.color-t-500 path {\n    fill: var(--T500-FG);\n  }\n"]);return nn=function(){return e},e}function rn(){var e=Zt()(["\n  position: absolute;\n  height: 30px;\n  width: 44px;\n  left: -48px;\n  top: -34px;\n  border-radius: 4px;\n  z-index: 9;\n"]);return rn=function(){return e},e}var on=Object(tn.f)(Object(Qt.getThemeColorByToken)("N900-FG"),.08),cn=en.a.div(rn()),an=en.a.div(nn(),(function(e){return e.getisMouseOnPanel?on:"transparent"}),on),ln=r("dx_UtDZ"),sn=r("dx_h74D"),un=r("dx_rR5J"),dn=r("dx_Dsxx"),fn=r("dx_XW5M"),hn=r("dx_d8dQ"),pn=r("dx_WEEE"),vn=r("dx_IvU4"),gn=r("dx_f6fH"),bn=r("dx_T3T0"),yn=r("dx_rGeQ"),mn=r("dx_tX8z"),_n=r("dx_Mzjv"),kn=r("dx_JZDi");function On(e){var n=e.blockManager.getBlockModelByBlockId(e.tableId).children.map((function(n){return e.blockManager.getBlockViewByBlockIdNotCheck(n.id)})).filter(Boolean),r=e.blockManager.getBlockViewByBlockIdNotCheck(e.tableId),o=null===r||void 0===r?void 0:r.hostElement.querySelector(".".concat(Xt.g)),i=Object(z.G)(n,e.blockManager),c=Object(sn.useSelector)(ln.selectors.share.ifhaveCommentPermission),a=Object(fe.useState)(!0),l=R()(a,2),s=l[0],u=l[1],d=Object(fe.useCallback)((function(){var n;u(!1),null===(n=e.onClose)||void 0===n||n.call(e)}),[e.onClose]),f=Object(fe.useCallback)((function(){at.X.hasEnteredPanel=!0}),[]);Object(fe.useEffect)((function(){var e=function(e){0!==e.deltaY&&d()};return document.documentElement.addEventListener("wheel",e),function(){document.documentElement.removeEventListener("wheel",e)}}),[d]);var h=Object(kn.O)(),p=Object(kn.U)(),v=Object(pn.c)().isOKRBlockEnable,g=Boolean(s&&r&&!Object(kn.Q)(p)),b=Object(yn.S)(e.boundary,e.blockManager,g),y=Object(mn.l)(o,e.blockManager,g,e.boundary);Object(fe.useEffect)((function(){vn.S.setPanelStatus(fn.t.BlockMenu,g)}),[g]);var m=Object(bn.S)({visible:g,boundaryRect:b}),_=R()(m,3),k=_[0],O=_[1],x=_[2],E=Object(fe.useMemo)((function(){return(null===h||void 0===h?void 0:h.isInWiki)?un.Q:un.i}),[null===h||void 0===h?void 0:h.isInWiki]),S=Object.assign({},Xt.z,j()({},_n.R.BottomLeft,[0,0]));return he.a.createElement(gn.S,{visible:g,blockManager:e.blockManager,selectionAPI:e.selectionAPI,boundaryRect:b,targetRect:y,offset:S,className:"block-menu-overlay",allowDirections:Xt.f,calcDirection:k,calcPosition:O,zIndex:E,onClose:d,ignoreTriggerTargetClass:Xt.g},he.a.createElement(hn.S,{fold:e.fold,comment:e.comment,panelType:fn.t.BlockMenu,contextBlocks:[r],contextExtraProps:{cellBlocks:n,tableBlock:r,isOKRBlockEnable:v},options:{editable:!0,commentable:c,isTableBlockMenu:!0},showDivider:!0,menuProps:{className:"".concat(_e.q.TABLE_EQUAL_PANEL," toolbox")},keyboard:!1,blocks:i,source:dn.G.web_menu_panel,onClose:d,onMenuMouseEnter:f,maxHeight:x,blockManager:e.blockManager,selectionAPI:e.selectionAPI,boundary:e.boundary,vertical:!1,type:_e.q.TABLE_EQUAL_PANEL,extraProps:n,onClick:d}))}var xn={fontSize:14,width:22,height:22,lineHeight:"22px",color:"var(--T500)",display:"flex",alignItems:"center",justifyContent:"center"};function En(e){var n=e.tableInfo,r=e.recursionProps,o=e.setIsHighlightedHoverEqual,i=e.isHighlightedHoverEqual,c=n.tableId,a=r.blockManager,l=r.selectionAPI,s=r.eventEmitter,u=r.boundary,d=a.getBlockViewByBlockId(c),f=Object(Yt.S)(d,{blockManager:a,isDelayEnter:!0,delayTime:200,selectionAPI:l,eventEmitter:s}),h=R()(f,4),p=h[0],v=h[1],g=h[2],b=h[3],y=Object(fe.useCallback)((function(){v(!1)}),[v]);Object(fe.useEffect)((function(){var e=function(e){e.blockId&&e.blockId!==c&&v(!1),e.source===qt.S.DRAG&&v(!1)};return s.on(qt.t,e),function(){s.off(qt.t,e)}}),[c,v,s]),Object(fe.useEffect)((function(){o(p)}),[p,o]);var m=Object(fe.useMemo)((function(){return he.a.createElement(cn,{className:Xt.g},he.a.createElement(an,{className:"hover-drag-icon-wrapper",getisMouseOnPanel:i,onMouseEnter:g,onMouseLeave:b},he.a.createElement(Gt.S,{style:xn}),he.a.createElement(Kt.S,{className:"drag-handle"})))}),[i,g,b]),_=r.fold,k=r.commentModule,O=r.host,x=Object(fe.useMemo)((function(){return p?he.a.createElement(On,{tableId:c,blockManager:a,selectionAPI:l,fold:_,comment:k,boundary:u,onClose:y,appHost:O}):null}),[p,c,_,k,O,a,l,u,y]);return he.a.createElement(he.a.Fragment,null,m,x)}var Sn=he.a.memo((function(e){var n=e.ctx,r=!Ce.R.isHeaderInScroller&&he.a.createElement(nt,e),o=zt(e),i=o.columnInsertBar,c=o.rowInsertBar,a=o.addLineSymbol,l=he.a.createElement(En,e),s=n.hostElementRef.current.querySelector(".scrollable-slot");if(!s)return null;var u=he.a.createElement("div",{className:"table-operation-bar equal-and-symbol",onMouseLeave:function(){return e="operation-bar.mouseleave",void Ft.emit(Lt.TABLE_HIDE_ADD_LINE_SYMBOL,e);var e},contentEditable:!1},a,l),d=Mt.a.createPortal(u,s),f=he.a.createElement("div",{className:"table-operation-bar header-and-insert",contentEditable:!1},r,i,c),h=Ce.R.isHeaderAndInsertBarInSlot?Mt.a.createPortal(f,s):f;return he.a.createElement(he.a.Fragment,null,h,d)})),Cn=r("dx_f650"),In=function e(n){var r=this;a()(this,e),this.infoMap={},this.setInfo=function(e){for(var n={},o=0;o<e.length;o++){var i=e[o];r.infoMap[i.cellRecordId]?(n[i.cellRecordId]=r.infoMap[i.cellRecordId],Object(P.isEqual)(i,n[i.cellRecordId].getInfo())||n[i.cellRecordId].setInfo(i)):n[i.cellRecordId]=new Bn(e[o])}r.infoMap=n},this.getCellInfo=function(e){return r.infoMap[e]};for(var o=0;o<n.length;o++)this.infoMap[n[o].cellRecordId]=new Bn(n[o])},Bn=function e(n){var r=this;a()(this,e),this.info=n,this.event=void 0,this.onUpdate=function(e){r.event=e},this.offUpdate=function(){r.event=null},this.setInfo=function(e){r.info=e,r.event&&r.event(e)},this.getInfo=function(){return r.info}},Tn=function(e){var n,r,o=e.blockId,i=e.cellInfo,c=e.tableId,a=e.viewService,l=e.editable,s=e.recursionProps,u=e.onMouseDown,d=e.onClick,f=e.hostElementRef,h=e.tag,p=Object(fe.useState)(i.getInfo()),v=R()(p,2),g=v[0],b=v[1];return he.a.useLayoutEffect((function(){var e,n,r=f.current;return r.classList.add("table-cell-block"),r.setAttribute("rowspan",(null!==(e=g.rowSpan)&&void 0!==e?e:1).toString()),r.setAttribute("colspan",(null!==(n=g.colSpan)&&void 0!==n?n:1).toString()),Ee.S.isMobile||(l?r.setAttribute("contenteditable","true"):r.removeAttribute("contenteditable")),r.style.display=g.cellId===g.sourceCellId?"table-cell":"none",r.addEventListener("mousedown",u),r.addEventListener("click",d),function(){r.removeEventListener("mousedown",u),r.removeEventListener("click",d)}}),[l,g,f,u,d]),he.a.useEffect((function(){return i.onUpdate((function(e){b(e)})),function(){i.offUpdate()}}),[]),a.render(o,{className:"table-cell-block",recursionProps:s,tableId:c,cellInfo:g,hostElementRef:f,tag:h,attribute:s.isSSR?{rowspan:null!==(n=g.rowSpan)&&void 0!==n?n:1,colspan:null!==(r=g.colSpan)&&void 0!==r?r:1,style:{}}:void 0,style:s.isSSR?{display:g.cellId===g.sourceCellId?"table-cell":"none"}:void 0})};function wn(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Rn(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?wn(Object(r),!0).forEach((function(n){j()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wn(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var Mn=function(e){var n=e.tableId,r=e.recursionProps,o=e.viewService,i=e.rowLayoutInfo,c=e.wrapper,a=e.editable,l=e.rowBlockId,s=e.onCellMouseDown,u=e.onCellClick,d=Object(fe.useRef)();d.current&&d.current.setInfo(i);var f=d.current||new In(i);d.current=f;var h=r.blockManager;return he.a.createElement(D.R,{id:l,reconciler:h.layoutManager.getReconciler(),wrapper:c,renderChild:function(i,c){var l,f=h.getRecordByBlockId(i).id,p=d.current.getCellInfo(f),v=(l=f,function(e){u(l,e)});return Object(Cn.I)(r.reactReduxContext,he.a.createElement(Tn,{blockId:i,cellInfo:p,tableId:n,editable:a,viewService:o,recursionProps:r,onMouseDown:s,onClick:v,hostElementRef:c,tag:e.recursionProps.isSSR?"td":void 0}))},childContainerTag:e.recursionProps.isSSR?void 0:"td",watchProps:Rn({},r)})};function jn(){var e=Zt()(["\n  top: 0px;\n  position: absolute;\n  bottom: 0;\n  width: ",";\n  left: 0;\n  border-left: 1px solid var(--line-border-card);\n  background: linear-gradient(to right, rgba(var(--N1000-BG-raw), 0.07988) 0%, rgba(var(--bg-body-raw), 0.0001) 96.62%);\n"]);return jn=function(){return e},e}var Dn=en.a.div(jn(),(function(e){return e.scrollLeft>8?"".concat(8,"px"):"".concat(e.scrollLeft,"px")})),An=r("dx_XIp8"),Pn=r("dx_DKof"),Ln=r("dx_mXzj"),Nn=r("dx_SZT7"),Fn=r("dx_Fimk"),Un=(r("dx_CR0l"),r("dx_zEdG")),Hn=r("dx_CwnG"),Vn=(r("dx_R2Rp"),"resize_table_column");Object(P.debounce)((function(e,n,r,o){Object(Fn.N)("toggle_attribute",{action:e,eventType:r,object_id:"table_".concat(n),rev:o&&o.getRev()})}),200);var Wn=function(e,n){var r=Object(Hn.T)([e],n),o=Object(Hn.m)(e,n);Object(Un.P)("ccm_doc_content_page_click",o,{click:"block_custom_action",action_type:Vn,object_block_data:r})};function zn(e){return Object(we.q)(e).clientX}var Gn=r("dx_x0No"),Kn=r("dx_kLTg");function qn(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Xn(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xn(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Xn(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var Yn=function(e){var n=e.tableSnapshot,r=e.model,o=Object(fe.useState)(function(e,n){for(var r={},o=0,i=Object.values(e.cell_set);o<i.length;o++){var c=i[o];try{for(var a=c.block_id,l=n.getRecordByRecordId(a).get(["children"]);Array.isArray(l)&&l.length;){var s,u=[],d=qn(l);try{for(d.s();!(s=d.n()).done;){var f=s.value,h=n.getRecordByRecordId(f),p=h.get(["type"]),v=Kn.K.get(p);r[a]=r[a]||{},v&&(r[a][f]=v),u.push.apply(u,F()(h.get(["children"])||[]))}}catch(g){d.e(g)}finally{d.f()}l=u}}catch(b){break}}return r}(n,r)),i=R()(o,2),c=i[0],a=i[1],l=Object(fe.useRef)({}),s=function(e){var n=e.cellId,r=e.recordId,o=e.minWidth,i=Object.assign({},l.current);i[n]=i[n]||{},i[n][r]=o,l.current=i,a(i)},u=function(e){var n=e.cellId,r=e.recordId,o=Object.assign({},l.current);o[n]&&o[n][r]&&(delete o[n][r],l.current=o,a(o))};return Object(fe.useEffect)((function(){return at.S.on(Kn.l,s),at.S.on(Kn.W,u),function(){at.S.off(Kn.l,s),at.S.off(Kn.W,u)}}),[]),c},Jn=r("dx_sNGG"),Zn=Be()("table:useColumnWidth"),Qn=Nn.H.rightMargin;function $n(e){var n=e.recursionProps,r=e.tableInfo,o=e.tableVisibleWidth,i=e.scrollManage,c=n.blockManager,a=n.eventEmitter,l=n.selectionAPI,s=r.tableSnapshot,u=r.tableId,d=r.colIds,f=r.rowIds,h=s.cell_set,p=Yn({tableSnapshot:s,model:e.recursionProps.blockManager.model}),v=Object(fe.useState)(null),g=R()(v,2),b=g[0],y=g[1],m=Object(fe.useState)((function(){return e.recursionProps.isSSR?tr(s,p):Object(z.E6)(s)})),_=R()(m,2),k=_[0],O=_[1],x=Object(fe.useRef)(0),E=null!==b,S=Object(Se.r)((function(e,n){Zn("%s.updateColumnWidths, col0=%s",n,e[0]),O(e)}));function C(e){null!==e?l.deactivate():(Zn("resize ends, reset edgeDelta(%s => 0), activate selection",x.current),l.activate(),x.current=0),Object(Gn.n)(null!==e),y(e)}var I=function(e,n){var r=n.columnIndex,o=n.startWidth,i=n.startClientX,c=zn(e),a=Math.round(c-i),l=Object(z.xo)({colIdx:r,tableData:s,cellBlockMinWidthMap:p}),u=Math.max(o+a+x.current,l,_e.P),d=window.innerWidth-c;return{delta:a,endWidth:u,edgeOffset:d,atEdge:d<=Qn}},B=Object(Se.r)(function(){var e=se()(ae.a.mark((function e(n){var r,o,i,a,l,s,f;return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==b){e.next=3;break}return Zn("handleResizeEnd(%s), skip due to not resizing",n.type),e.abrupt("return");case 3:if(r=I(n,b),o=r.delta,i=r.endWidth,a=b.columnIndex,l=b.startWidth,Zn("handleResizeEnd(%s): index=%s, delta=%d, %d => %d",n.type,a,o,l,i),C(null),0!==o){e.next=9;break}return e.abrupt("return");case 9:Wn(u,c),s=c.getRecordByBlockId(u).snapshot,(f=Object(An.S)(s.column_set))[d[a]].column_width=i,Object(ke.J)({blockManager:c,blockId:u,column_set:f}),er(u,a,s,c);case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),T=Object(Se.r)((function(e,n){if(!Re(e)||Me(e)){e.preventDefault(),e.stopPropagation();var r=Re(e),o=k[n];Zn("handleResizeStart(%s): index=%s, startWidth=%s, isResizing=%s, target=%o",e.type,n,o,E,e.target),at.N.emit(at.p.MOBILE.CONTEXT_MENU.HIDE_CUSTOM_MENU),C({columnIndex:n,startWidth:o,useMouse:r,startClientX:zn(e)}),document.addEventListener("pointerup",B,{once:!0})}else Zn("handleResizeStart(%s): not primary button down, skip",e.type)})),w=Object(Et.S)((function(e){if(null!==b){var n=b.columnIndex,r=b.startWidth,l=n===d.length-1,s=k[n],u=I(e,b),p=u.delta,v=u.endWidth,g=u.edgeOffset,y=u.atEdge,m=l&&s===v&&y?2:0;x.current+=m;var _=p+x.current,O=v+m;if(s!==O){Zn("doResize(%s): index=%d, delta=%s+%s, %d => %d, edge=%s(%s)",e.type,n,p,x.current,r,O,y,g);var E=F()(k);E[n]=O,S(E,"handleResize"),function(e){if(0!==e){var n=d[e];f.forEach((function(e){var r="".concat(e).concat(n),o=h[r].block_id,i=c.getBlockIdsByRecordId(o)[0];c.layoutManager.didUpdateNode(i,!0)}))}}(n),a.emit(Jn.Y.HIGHLIGHT_UPDATE),i&&l&&_>0&&function(e,n,r){r.executeScroll(e);var o=r.getScrollStatus(),i=o.scrollLeft,c=o.scrollWidth;i+n>=c&&r.executeSubScroll(e)}(_,o,i)}else Zn("doResize(%s): index=%s, delta=%s+%s endWidth=%s, edge=%s(%s), skip due to width nochange",e.type,n,p,x.current,O,y,g)}}),50),M=Object(Se.r)((function(e){w(Object(we.j)(e))}));Object(fe.useLayoutEffect)((function(){var e=Object(z.E6)(s);S(e,"colIds.changed")}),[d,s,S]),Object(fe.useEffect)((function(){var e=tr(s,p);S(e,"cellBlockMinWidthMap.changed")}),[s,p,S]);var j=Object(fe.useMemo)((function(){return Object(Pn.S)(k)}),[k]),D=b&&b.columnIndex;return Object(fe.useMemo)((function(){return{resizingIndex:D,isResizing:E,columnWidths:k,tableContentWidth:j,handleResizeStart:T,handleResize:M}}),[D,E,k,j,T,M])}function er(e,n,r,o){var i={};Object(Ln.S)(r.cell_set,(function(e,n){i[e.block_id]=n})),o.getBlockModelByBlockId(e).children.forEach((function(e){var c=Object(z.B)(i[e.recordId],r),a=R()(c,2)[1];n===a&&o.getBlockModelByBlockId(e.id).children.forEach((function(e){var n=o.getBlockViewByBlockId(e.id);null===n||void 0===n||n.onResize()}))}))}function tr(e,n){var r=Object(z.E6)(e);return e.columns_id.forEach((function(o,i){var c=Object(z.xo)({colIdx:i,tableData:e,cellBlockMinWidthMap:n}),a=r[i],l=Math.max(a,c);r[i]=l})),r}var nr=r("dx_OUFY"),rr=r("dx_S0Si"),or=r("dx_VY1y"),ir=Object(ve.h)("table:useTableScroll");function cr(e){var n=e.ctx,r=e.scrollManage,o=e.tableId,i=e.scrollItemMaxLeft,c=e.tableContentWidth,a=e.scrollContainerWidth,l=e.isKeepBoundary,s=e.tableScrollerRef,u=e.tableRef,d=e.recursionProps,f=e.setTableVisibleWidth,h=n.logId,p=d.isHistory,v=d.blockManager,g=Object(fe.useState)(null),b=R()(g,2)[1],y=Object(fe.useRef)(null),m=function(e,n){if(e)return{tableLeftPadding:0,tableRightPadding:0};var r=n?Ce.R.minRightPadding:Ce.R.rightPadding;return{tableLeftPadding:Ce.R.leftPadding,tableRightPadding:r}}(p,l),_=m.tableLeftPadding,k=m.tableRightPadding,O=_+k,x=Object(fe.useState)(c+_e.g4+O),E=R()(x,2),S=E[0],C=E[1],I=S-O,B=a?a+_:void 0,T=Object(Se.r)((function(e,n,o){r&&a&&B?(ir(h,"%s.emitSubScroll(%s): scrollerScrollLeft=%s, scrollerWidth(scroll=%s,max=%s), paddingLeft=%s",n,o,e,S,B,_),r.emitSubScroll({scrollLeft:e,scrollWidth:S},o)):ir(h,"handleScrolled: uinitialized, skip")})),w=Object(Se.r)((function(e,n,r){if(a){var o=y.current!==e;o&&(y.current=e,Ce.R.isHeaderInScroller||b(e)),(r===rr.L.COMMENT_SCROLL||o)&&T(e,n,r)}else ir(h,"updateScrollerScrollLeft: uinitialized, skip")})),M=Object(fe.useCallback)((function(e){if(a&&void 0!==i){var n=a-(i-e),r=Math.min(n,I);at.N.emit(or.Y,{blockId:o,offset:e}),f(r)}}),[a,i,I,f,o]),j=Object(Se.r)((function(e,n){if(s.current&&u.current){var r,o=s.current,i=o.scrollLeft;r=Object(P.isNumber)(e)?Math.max(0,i+e):e.scrollLeft,o.scrollLeft=r;var c=o.scrollLeft;ir(h,"handleSubScroll: set scroller scrollLeft: %s => %s(real=%s), delta=%s",i,r,c,Object(P.isNumber)(e)?e:"not-given"),w(c,"handleSubScroll",n)}})),D=Object(Se.r)((function(e){a&&M(e.scrollLeft)})),A=Object(Se.r)((function(){if(s.current){var e=s.current.scrollLeft;w(e,"handleScrollerScroll"),r||at.N.emit(nr.o.ON_SCROLL,void 0,o)}})),L=Object(Se.r)((function(e){if(e.target===s.current)return A()}));return Object(fe.useEffect)((function(){var e=s.current;e&&setTimeout((function(){var n=e.scrollWidth;n&&(ir(h,"tableContentWidth=%s, set scrollerScrollWidth=%s",c,n),C(n))}),10)}),[c,s,h]),Object(fe.useEffect)((function(){var e=s.current;r&&a&&e&&(ir(h,"emitSubViewChange: scrollerScrollWidth=%s",S),r.emitSubViewChange({width:S}))}),[S,a,r,h,w,s]),Object(fe.useEffect)((function(){if(r){var e=r.registerSubScroll(j),n=r.onScroll(D);return function(){e(),n()}}}),[r,v,D,j,A,o]),Object(fe.useEffect)((function(){if(r){var e=r.getScrollStatus().scrollLeft;M(e)}}),[r,M]),{handleScrollerScroll:L,scrollerScrollLeft:y.current||0,scrollerMaxWidth:B,tableLeftPadding:_,tableRightPadding:k}}var ar=r("dx_fiWO"),lr=Object(ve.h)("table:useHoveringTable"),sr=function(e,n){var r=Object(fe.useState)(!1),o=R()(r,2),i=o[0],c=o[1],a=e.blockManager,l=e.tableId,s=e.logId,u=e.hostElementRef,d=Ee.Z.isNonIPadMobile?n:u.current;return Object(fe.useEffect)((function(){if(d){var e=Object(P.debounce)((function(){return c(!1)}),50),n=function(n){lr(s,"handleMouseHover(%s)",n.type);var r=d.querySelector(".".concat(nr.z)),o=d.querySelector(".".concat(nr.M));if(e.cancel(),r&&o){var i=n.clientX,a=function(e,n,r){var o=Object(mn.e)(r),i=Object(mn.e)(e),c=Object(mn.e)(n),a=c.top,l=c.left,s=c.right,u=c.height,d=Math.min(s,o.right),f=Math.max(i.right,d)-l+qt.PX;return new DOMRect(l-qt.PX,a,f,u)}(d,r,o);if(i<a.left)return void c(!1);if(i>a.right)return void c(!1)}c(!0)};return d.addEventListener("mousemove",n),d.addEventListener("mouseover",n),d.addEventListener("mouseout",e),function(){d.removeEventListener("mousemove",n),d.removeEventListener("mouseover",n),d.removeEventListener("mouseout",e)}}}),[a,l,s,d]),i};function ur(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function dr(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ur(Object(r),!0).forEach((function(n){j()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ur(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var fr=Object(ve.h)("table:view"),hr=he.a.memo(Object(fe.forwardRef)((function(e,n){var r,o=e.ctx,i=e.tableData,c=e.viewService,a=e.recursionProps,l=e.tableId,s=e.selectionAPI,u=e.editable,d=e.scrollManage,f=e.scrollContainerWidth,h=e.isKeepBoundary,p=e.scrollItemMaxLeft,v=e.setPopoverStatus,g=e.setIsPopoverToolbarHide,b=e.onCellClick,y=e.onCellMouseDown,m=e.isShowLoading,_=e.selected,k=a.blockManager,O=a.isMobileEditMode,x=o.logId,E=Object(fe.useMemo)((function(){return Object(Q.y)(l,i)}),[l,i]),S=E.rowIds,C=E.cellsLayout,I=Object(fe.useState)(0),B=R()(I,2),T=B[0],w=B[1],M=Object(fe.useState)(!1),A=R()(M,2),P=A[0],L=A[1],N=Object(fe.useState)(null),F=R()(N,2),U=F[0],H=F[1],W=Object(fe.useRef)(null),z=Object(fe.useRef)(null),G=Object(ar.N)(l),K=sr(o,W.current),q=function(e){var n=e.tableId,r=e.selectionAPI,o=e.blockManager,i=Object(fe.useState)(!1),c=R()(i,2),a=c[0],l=c[1],s=st({blockManager:o,tableId:n,selectionAPI:r}).focusTaskCellId;return Object(fe.useEffect)((function(){var e=function(){try{var e,i=r.getSelection().map((function(e){return e.id}));if(!i.length&&a&&(null===(e=document.activeElement)||void 0===e?void 0:e.closest(".overlay-container")))return;var c=i.some((function(e){return o.getBlockPath(e).includes(n)}));l(c)}catch(s){console.error("table detect selection error: ",s)}};return r.onSelectionChange(e),function(){r.offSelectionChange(e)}}),[n,r,o,a]),a||Boolean(s)}({tableId:l,selectionAPI:s,blockManager:k}),X=q||K||P||Boolean(U),Y=u||Boolean(O),J=Ce.R.disableOperationBarOnSelected&&_||!Ce.R.enableOperation,Z=X&&Y&&!m&&!J;fr(x,"operationBarVisible=%s(isEditMode=%s||%s,disabled=%s), tableActive=%s(%s||%s||%s||%s)",Z,u,O,J,X,q,K,P,U);var $=Object(Se.r)((function(e){fr(x,"updateFocusHeaderType: %s",e),H(e),null===v||void 0===v||v(e)})),ee=$n({recursionProps:a,scrollManage:d,tableInfo:E,tableVisibleWidth:T}),te=ee.isResizing,ne=ee.tableContentWidth,re=ee.columnWidths,oe=Object(Tt.j)(s),ie=function(e){var n=e.tableRef,r=e.tableData,o=e.tableContentWidth,i=e.scrollContainerWidth,c=r.rows_id,a=Object(fe.useState)([]),l=R()(a,2),s=l[0],u=l[1],d=Object(fe.useState)(0),f=R()(d,2),h=f[0],p=f[1],v=Math.min(i||Number.MAX_VALUE,o),g=function(){var e=n.current;if(e){var r=Array.from(e.rows).map((function(e){var n=e.dataset.index;return{height:e.getBoundingClientRect().height,index:n?parseInt(n):-1}})),o=e.clientHeight;u(r),p(o)}};return Object(fe.useEffect)((function(){var e=setTimeout((function(){g()}),0);return function(){clearTimeout(e)}}),[c]),{tableWidth:v,tableHeight:h,rowInfos:s,updateTableHeight:g}}({tableRef:W,tableData:i,tableContentWidth:ne,scrollContainerWidth:f}),ce=ie.tableHeight,ae=ie.tableWidth,le=ie.rowInfos,se=ie.updateTableHeight;Bt({callback:function(){se()},element:z});var ue=cr({ctx:o,scrollManage:d,tableId:l,scrollItemMaxLeft:p,tableContentWidth:ne,scrollContainerWidth:f,isKeepBoundary:h,tableScrollerRef:z,tableRef:W,setTableVisibleWidth:w,recursionProps:a}),de=ue.scrollerScrollLeft,pe=ue.scrollerMaxWidth,ve=ue.tableLeftPadding,ge=ue.tableRightPadding,be=ue.handleScrollerScroll;Object(fe.useImperativeHandle)(n,(function(){return{getScrollLeft:function(){return de}}}),[de]);var ye=Ot({ctx:o,recursionProps:a,tableInfo:E,updateFocusHeaderType:$,hookEnabled:Z}),me=ye.isHeaderDragging,ke=te||me,Oe=Object(fe.useMemo)((function(){return he.a.createElement(D.R,{id:l,reconciler:k.layoutManager.getReconciler(),tag:"tbody",childContainerTag:"tr",renderChild:function(e,n,r){var o=V.getRowIdByBlockId(l,e),i=S.indexOf(o),s=r.attributes,d=void 0===s?{}:s;return r.attributes=dr(dr({},d),{},{"data-index":i}),he.a.createElement(Mn,{key:e,rowBlockId:e,editable:u,rowLayoutInfo:C[i],viewService:c,recursionProps:a,tableId:l,wrapper:n,onCellClick:b,onCellMouseDown:y})},watchProps:dr(dr({},a),{},{layoutInfo:C})})}),[S,C,c,a,l,k.layoutManager,u,b,y]),Ie=!_&&e.syncCursorSelected?e.syncCursorBorderColor:void 0,Be=Object(fe.useMemo)((function(){var e=re.map((function(e,n){return he.a.createElement("col",{width:e,key:n})}));return he.a.createElement("colgroup",null,e)}),[re]),Te=Object(fe.useMemo)((function(){return Ce.R.showShadow?Boolean(de)&&he.a.createElement(Dn,{className:"left-shadow",style:{height:ce},scrollLeft:de}):null}),[de,ce]),we=Ct(l,k,Z).isHoverCellBorder,Re=u&&Ce.R.enableResizerLine,Me=Object(fe.useMemo)((function(){return Re&&he.a.createElement(Ne,{columnWidthManager:ee,isHoverCellBorder:we,tableHeight:ce,tableInfo:E})}),[ee,we,ce,E,Re]),je=xe()("table ".concat(wt.B),{selected:_}),De=xe()((r={},j()(r,_e.q.TABLE_SELECTED_FROM_EQUAL,P),j()(r,_e.q.TABLE_SELECTED,_),j()(r,_e.q.TABLE_WILL_DELETE_CELL,G),j()(r,_e.q.TABLE_RESIZING,te),j()(r,_e.q.TABLE_SELECTING,oe),j()(r,_e.q.TABLE_DISABLE_SCROLL,ke),r));Object(fe.useEffect)((function(){null===d||void 0===d||d.emitSetWrapperClass(De)}),[De,d]);var Ae=Object(fe.useState)(!1),Pe=R()(Ae,2),Le=Pe[0],Fe=Pe[1];Object(fe.useEffect)((function(){var n=function(){var n=s.getSelection();Fe(s.isTextSelectionAcrossBlocks(n)&&n.some((function(n){return n.id===e.tableId})))};return n(),s.onSelectionChange(n),function(){s.offSelectionChange(n)}}),[s]);var Ue=Object(fe.useMemo)((function(){var e={renderOperationBar:null,renderHeaderBar:null};if(!Z)return e;if(!a.blockManager.hasBlockViewByBlockId(l))return e;if(Le)return e;var n={ctx:o,rowInfos:le,tableInfo:E,recursionProps:a,scrollerScrollLeft:de,tableHeight:ce,tableWidth:ae,tableVisibleWidth:T,isHighlightedHoverEqual:P,setIsHighlightedHoverEqual:L,setIsPopoverToolbarHide:g,columnWidthManager:ee,headerSelectionManager:ye,updateTableHeight:se},r=Ce.R.isHeaderInScroller&&he.a.createElement(nt,dr(dr({},n),{},{scrollerScrollLeft:0}));return{renderOperationBar:he.a.createElement(Sn,n),renderHeaderBar:r}}),[Z,P,a,ae,l,E,le,de,ce,T,L,g,ee,ye,o,se]),He=Ue.renderOperationBar,Ve=Ue.renderHeaderBar;fr(x,"render, resizing=%s, selecting=%s, headerDragging=%s, scrollerScrollLeft=%s, tableWidth=%s=min(content=%s, scrollContainer=%s), width(visible=%s, col0=%s), padding=%s/%s",te,oe,me,de,ae,ne,f,T,re[0],ve,ge);var We=he.a.useMemo((function(){return Ee.S.isMobile?{}:{contentEditable:!1,tabIndex:-1}}),[]);return he.a.useMemo((function(){return he.a.createElement("div",Object.assign({className:"table-block j-table-block"},We),he.a.createElement("div",{className:_e.q.TABLE_SCROLLER_CLASS,ref:z,style:{maxWidth:pe,paddingLeft:ve||void 0,transform:ve?"translateX(-".concat(ve,"px)"):void 0,overflow:Ce.R.scrollableOptions.enableNativeSubScroll?void 0:"hidden"},onScroll:be},he.a.createElement("div",{className:_e.q.SCROLLABLE_CONTENT},he.a.createElement("div",{className:"table-content-padding",style:{paddingRight:ge}},he.a.createElement("table",{className:je,ref:W,style:{backgroundColor:e.syncCursorSelected&&e.syncCursorBgColor||void 0,borderColor:Ie}},Be,Oe)),Ve,Me),Te),He)}),[ve,ge,pe,be,je,e.syncCursorSelected,e.syncCursorBgColor,Ie,Be,Oe,He,Te,Me,Ve])})));r("dx_EOHb");function pr(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var vr=Object(ve.h)("table:TableBlockReactView"),gr=function(e){h()(r,e);var n=pr(r);function r(e){var o;a()(this,r),(o=n.call(this,e)).state={selected:!1,cellMouseDownBeginY:_e.h},o.tableViewRef=Object(fe.createRef)(),o.ctx=void 0,o.getViewSnapshot=function(){return o.hostElement.querySelector("table")},o.handleTransaction=function(e){var n=e.options,r=e.op,i=e.recordOps;if(n.from===A.H.remote){var c=o.model,a=c.recordId,l=c.snapshot;if(i.find((function(e){return e.id===a}))){var s=l.rows_id,u=l.columns_id,d=l.cell_set;s.forEach((function(e){u.forEach((function(n){var o=Object(z.y)(e,n);if(!d[o]){var i=Object(ke.c)(r,a,o);Object(ke.n)(r,i)}}))}))}}},o.handleCellMouseDown=function(e){o.setState({cellMouseDownBeginY:e.clientY})},o.handleCellClick=function(){var e=se()(ae.a.mark((function e(n,r){var i,c,a,l,s,u,d,f,h,p,v,g,b,y,m,_,k,O;return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.editable){e.next=2;break}return e.abrupt("return");case 2:if(!(r.clientY-o.state.cellMouseDownBeginY>_e.X)){e.next=4;break}return e.abrupt("return");case 4:if(c=function(e){var n=o.blockManager.getBlockViewByBlockId(e),r=n.getHostRect();return[n,r]},a=function(e){Object(be.R6)(e)?(vr(o.logId,"handleCellClick: focus at first textual block"),Object(ye.u)(e.model)):(vr(o.logId,"handleCellClick: clear selection"),o.selectionAPI.clearSelection("handleCellClick"))},l=Object(me.S)(r.target),s=null===(i=o.editorAPI.modelService.getBlockModelsByRecordId(n)[0])||void 0===i?void 0:i.id,setTimeout((function(){var e=o.props.recursionProps,n=e.selectionAPI,r=e.rect,i=Object(pe.p)(n,r);i&&l&&Object(z.q)(o.blockManager,l,i)})),l===s){e.next=11;break}return e.abrupt("return");case 11:if(u=o.editorAPI.modelService.getBlockModelByBlockId(s),d=null===u||void 0===u?void 0:u.children,u&&(null===d||void 0===d?void 0:d.length)){e.next=15;break}return e.abrupt("return");case 15:if(f=d[0].id,h=d[d.length-1].id,p=c(f),v=R()(p,2),g=v[0],b=v[1],y=c(h),m=R()(y,2),_=m[0],k=m[1],O=r.clientY<=b.top,!(r.clientY>=k.bottom)){e.next=23;break}return e.abrupt("return",o.handleCellClickBottom(_,k,n,s,d));case 23:if(!O){e.next=25;break}return e.abrupt("return",a(g));case 25:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}();var i=e.hostElementRef,c=e.model.id,l=e.recursionProps.blockManager;return o.ctx={tableId:c,blockManager:l,logId:"table=".concat(c),hostElementRef:i},o}return s()(r,[{key:"setSelected",value:function(e){this.setState({selected:e})}},{key:"onResize",value:function(){this.props.scrollManage&&this.props.scrollManage.emitGridChange()}},{key:"blockViewDidMount",value:function(){de()(b()(r.prototype),"blockViewDidMount",this).call(this),this.blockManager.recordManager.on(A.q.INTERCEPT_CHANGE,this.handleTransaction)}},{key:"blockViewWillUnmount",value:function(){de()(b()(r.prototype),"blockViewWillUnmount",this).call(this),this.blockManager.recordManager.off(A.q.INTERCEPT_CHANGE,this.handleTransaction)}},{key:"clearScreenshot",value:function(){var e,n=null===(e=this.scrollManage)||void 0===e?void 0:e.getScrollContainer();n&&(n.style.height="");var r=this.getViewSnapshot();r&&(r.style.transform="translate3d(0,-1px,0)",r.style.setProperty("--table-block-border-width",null))}},{key:"takeScreenshot",value:function(){var e=this,n=this.getHostRect().width,r=this.getViewSnapshot();if(r){var o=r.getBoundingClientRect(),i=o.width,c=o.height;if(i>0&&n<i){var a,l,s,u;null===(a=this.scrollManage)||void 0===a||a.setAfterRender({key:"scrollHorizontal",value:P.noop}),null===(l=this.scrollManage)||void 0===l||l.executeScroll({scrollLeft:0}),null===(s=this.scrollManage)||void 0===s||s.executeSubScroll({scrollLeft:0});var d=n/i,f=function(e){return(1-d)/2*e/d},h=f(i),p=f(c)-2;r.style.transform="scale(".concat(d,") translate3d(").concat(-h,"px, ").concat(-p,"px, 0)"),d<.5&&r.style.setProperty("--table-block-border-width","".concat(.5/d,"px"));var v=null===(u=this.scrollManage)||void 0===u?void 0:u.getScrollContainer();if(v){var g=v.getBoundingClientRect().height-c;v.style.height="".concat(c*d+g+2,"px")}}}return{done:function(){e.clearScreenshot()}}}},{key:"handleCellClickBottom",value:function(){var e=se()(ae.a.mark((function e(n,r,o,i,c){var a,l,s,u;return ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(be.R6)(n)){e.next=9;break}if(!n.model.isEmpty||!n.isTextEditable){e.next=4;break}return vr(this.logId,"focus at the last empty line"),e.abrupt("return",Object(ye.Z)(n.model));case 4:if(a=this.blockManager.getBlockViewByBlockId(i).getHostRect(),!((l=a.bottom-r.bottom)<_e.o)){e.next=9;break}return vr(this.logId,"not enough blank height(%s < %s), do not append, just focus at tail",l,_e.o),e.abrupt("return",Object(ye.Z)(n.model));case 9:return e.next=11,Object(ke.a)({blockManager:this.blockManager,tableBlockId:this.id,cellRecordId:o,offset:c.length});case 11:s=e.sent,vr(this.logId,"append empty line and focus, blockId=%s",s),(u=this.blockManager.getBlockViewByBlockId(s)).isTextEditable&&Object(ye.Z)(u.model);case 15:case"end":return e.stop()}}),e,this)})));return function(n,r,o,i,c){return e.apply(this,arguments)}}()},{key:"render",value:function(){vr(this.logId,"render");var e=this.props,n=e.recursionProps,r=e.record,o=e.blockId,i=Object(P.pick)(this.props,["isShowLoading","syncCursorSelected","syncCursorBorderColor","syncCursorBgColor","popoverStatus","setPopoverStatus","setIsPopoverToolbarHide","cellToolbarVisible","scrollManage","scrollContainerWidth","scrollItemMaxLeft","isKeepBoundary"]);return he.a.createElement(hr,Object.assign({ctx:this.ctx,tableData:r.snapshot,viewService:this.editorAPI.viewService,recursionProps:n,tableId:o,recordId:this.record.id,selectionAPI:this.selectionAPI,selected:this.state.selected,boundary:this.boundary,editable:this.editable,ref:this.tableViewRef,onCellClick:this.handleCellClick,onCellMouseDown:this.handleCellMouseDown,eventEmitter:this.eventEmitter},i))}},{key:"contentElement",get:function(){return this.hostElement.querySelector(".table-block")}},{key:"scrollManage",get:function(){return this.props.scrollManage}},{key:"tableViewScrollLeft",get:function(){return this.tableViewRef.current?this.tableViewRef.current.getScrollLeft():0}}]),r}(ge.l),br=r("dx_KvuI");r("dx_HRGQ");function yr(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var mr,_r,kr,Or,xr,Er,Sr=function(e){h()(r,e);var n=yr(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).focusElementRef=Object(fe.createRef)(),e.handleFirstChildOrLastChildRecordChange=function(n){var r=Object(br.s)({recordOps:n.recordOps,checkModel:e.model});Object.values(r).forEach((function(n){return n&&e.blockManager.layoutManager.didUpdateNode(n.id,!0)}))},e}return s()(r,[{key:"blockViewDidMount",value:function(){de()(b()(r.prototype),"blockViewDidMount",this).call(this),this.blockManager.recordManager.on(A.q.CHANGE,this.handleFirstChildOrLastChildRecordChange)}},{key:"blockViewWillUnmount",value:function(){de()(b()(r.prototype),"blockViewWillUnmount",this).call(this),this.blockManager.recordManager.off(A.q.CHANGE,this.handleFirstChildOrLastChildRecordChange)}},{key:"render",value:function(){var e=this.record.snapshot.children||[];return he.a.createElement("div",{className:"content-wrapper",ref:this.focusElementRef},this.renderChildren({childrenIds:F()(e)}))}},{key:"cellId",get:function(){return this.props.cellInfo.cellId}},{key:"cellRecordId",get:function(){return this.props.cellInfo.cellRecordId}},{key:"focusElement",get:function(){var e;return Ee.S.isPcWeb?null===(e=this.focusElementRef.current)||void 0===e?void 0:e.parentElement:null}}]),r}(ge.l);function Cr(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Ir=(mr=Object(_.H)({providers:[ie,Z,{provide:x.RecordSnapshotCreator,useValue:{type:O.B.TABLE,create:E.E}},ee,{provide:x.RecordSnapshotCreator,useValue:{type:O.B.CELL,create:S.n}},ne]}),_r=Object(k.d)(ie),mr((Er=function(e){h()(r,e);var n=Cr(r);function r(){var e;a()(this,r);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return e=n.call.apply(n,[this].concat(c)),i()(e,"compensation",xr,d()(e)),e.blocks=[[C.X,{viewCreator:gr}],[B,{viewCreator:Sr,blockDeps:["renderProps.cellInfo.rowSpan","renderProps.cellInfo.colSpan","renderProps.cellInfo.sourceCellId","renderProps.cellInfo.cellId"]}]],e}return s()(r,[{key:"init",value:function(){this.compensation.init()}},{key:"destroy",value:function(){this.compensation.destroy()}}]),r}(_.y),Or=Er,xr=m()(Or.prototype,"compensation",[_r],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kr=Or))||kr)},dx_hd5n:function(e,n,r){"use strict";r.d(n,"b",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("loadable-block-scheduler")},dx_hgIo:function(e,n,r){"use strict";r.d(n,"G",(function(){return b}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_UtDZ"),h=r("dx_pU8o"),p=r("dx_miEo"),v=r("dx_KXll"),g=function(){function e(){var n=this;s()(this,e),this.previewHelper=void 0,this.currentToken=void 0,this.openSource=void 0,this.latestCloseHandler=void 0,this.bindFileExitEvent=function(e){n.latestCloseHandler=function(){e(),n.currentToken=void 0,n.openSource=void 0}},this.previewFileFullScreenByNative=function(e){return null},this.previewFileFullScreen=function(){var e=a()(i.a.mark((function e(r){var o,c,a,l,s,u=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=r.record,c=r.onClose,a=u.length>1&&void 0!==u[1]?u[1]:p.o.MANUAL,l=o.snapshot.file.token){e.next=7;break}throw new Error("no token");case 7:if(n.currentToken!==l){e.next=11;break}return e.abrupt("return");case 11:if(n.bindFileExitEvent(c),s=n.getProps({record:o}),n.previewHelper){e.next=19;break}return e.next=16,n.initPreviewHelper(s);case 16:n.previewHelper=e.sent,e.next=20;break;case 19:n.previewHelper.updateProps(s);case 20:n.currentToken=l,n.openSource=a,n.previewHelper.handlePreview(!0);case 23:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),this.closeFilePreviewer=function(e,r){var o,i=n.currentToken===e,c=n.openSource===p.o.MANUAL;n.previewHelper&&(c||i||r===p.Y.VC_NO_REGISTER)&&(n.previewHelper.manualCloseModal(),null===(o=n.latestCloseHandler)||void 0===o||o.call(n));n.openSource=void 0},this.checkPreviewStatus=function(e){return e===n.currentToken&&n.previewHelper.isPreviewing},this.destroy=function(){}}return d()(e,[{key:"getProps",value:function(e){var n=this,r=e.record,o=r.snapshot.file,i=o.token,c=o.name;return{name:c,size:o.size,driveKey:i,token:i,type:Object(v.s)(c),suiteType:f.NUM_SUITE_TYPE.DOCX.toString(),useDriveStorage:!0,handleClickDownload:function(){Object(h.y)(r)},onCancel:function(){var e;null===(e=n.latestCloseHandler)||void 0===e||e.call(n),console.log("[file block] on cancel.")}}}},{key:"initPreviewHelper",value:function(){var e=a()(i.a.mark((function e(n){var r,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.loadPreviewHelper)();case 2:return r=e.sent,o=r.PreviewHelper,e.abrupt("return",new o(n));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()}]),e}(),b=new g},dx_hgdd:function(e,n,r){"use strict";r.d(n,"t",(function(){return i}));var o=r("dx_vwWk");function i(e,n,r){var i=[];var c=new Set;e.forEach((function(n){var r;null===(r=n.children)||void 0===r||r.forEach((function(n,r){if(!c.has(n.recordId)){var o=function(n){var r=!1;return e.every((function(e){var o,i=e.children[n],c=null===i||void 0===i||null===(o=i.children)||void 0===o?void 0:o[0];return c&&"img"===c.tagName&&(r=!0),!i||"img"===(null===c||void 0===c?void 0:c.tagName)}))&&r}(r);o?i.push(e.map((function(e){var n,o,i=null===(n=e.children[r])||void 0===n||null===(o=n.children)||void 0===o?void 0:o[0];return i&&(i.recordId=e.children[r].recordId,c.add(i.recordId)),i})).filter((function(e){return void 0!==e}))):i.push(n)}}))})),i.forEach((function(e){if(e)if(Array.isArray(e)){var i=e.reduce((function(e,n){var o=r.getBlockModelsByRecordId(n.recordId)[0].record.snapshot.image;return e+o.width*o.scale}),0),c={tagName:"div",attrs:{class:"image-uploaded gallery","data-ace-gallery-json":JSON.stringify({items:e.map((function(e){var n=e.recordId,c=r.getBlockModelsByRecordId(n)[0],a=c.parent.record.snapshot.width_ratio,l=c.record.snapshot.image.width,s=a*i/l;return Object(o.r)(r,n,s)}))})},children:e};n.push(c)}else n.push(e)}))}},dx_hlsL:function(e,n,r){"use strict";(function(t){var e=r("dx_lSNA"),o=r.n(e),i=r("dx_J4zp"),c=r.n(i),a=r("dx_K5vg"),l=r("dx_TSYQ"),s=r.n(l),u=r("dx_UtDZ"),d=r("dx_h6a8"),f=r("dx_cDcd"),h=r.n(f),p=r("dx_h74D"),v=r("dx_bdgK"),g=r("dx_rQGm"),b=r("dx_yzqx"),y=r("dx_ukKW"),m=r("dx_y5yU"),_=r("dx_E2oU"),k=r("dx_k2kp"),O=r("dx_zEdG"),x=r("dx_CwnG"),E=r("dx_T7TM"),S=r("dx_Je9X"),C=r("dx_niVl"),I=r("dx_EuEb"),B=r("dx_qKh5"),T=r("dx_D8nn"),w=r("dx_MlPX"),R=r("dx_X279"),M=r("dx_JZDi"),j=r("dx_qx8A"),D=r.n(j),A=r("dx_Dq30"),P=r("dx_JOYA"),L=r("dx_a3ox"),N=r("dx_SGLR"),F=r("dx_BBFf"),U=r("dx_hESJ"),H=r("dx_Nv7e");r("dx_dUBi");function V(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function W(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?V(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var z=3,G=Object(m.r)(a.S),K=function(){var e=window.innerHeight||document.documentElement.clientHeight;b.S.mobile||(e-=g.mM);var n=.32*e;return!b.S.isMobile&&n<2*g.mM&&(n=2*g.mM),!b.S.isMobile&&n>400&&(n=400),n},q=function(e,n,r){var o=(null===n||void 0===n?void 0:n.clientWidth)||document.documentElement.clientWidth||window.innerWidth;if(r&&!b.S.isMobile&&!b.S.isLarkFeed){var i=Object(R.N)().rect;(null===i||void 0===i?void 0:i.width)&&(o=i.width)}return e&&(o-=309),o},X=u.blobHelper.getBlobUrl;n.S=function(e){var n=e.isHistory,r=void 0!==n&&n,o=e.coverInfo,i=e.scrollContainer,a=r?o:Object(p.useSelector)(_.a),l=!!r||Object(p.useSelector)(u.selectIsOnline),g=!r&&Object(p.useSelector)(_.n),m=Object(p.useSelector)(_.M),j=r?F.I.HISTORY:F.I.NORMAL,V=Object(f.useRef)(null),Y=Object(f.useRef)(null),J=Object(f.useRef)(null),Z=Object(f.useState)(!1),Q=c()(Z,2),$=Q[0],ee=Q[1],te=Object(U.S)(V.current,a,j),ne=Object(f.useState)(!1),re=c()(ne,2),oe=re[0],ie=re[1],ce=Object(f.useState)(!1),ae=c()(ce,2),le=ae[0],se=ae[1],ue=Object(f.useState)(!1),de=c()(ue,2),fe=de[0],he=de[1],pe=Object(f.useState)(!1),ve=c()(pe,2),ge=ve[0],be=ve[1],ye=Object(f.useState)(!1),me=c()(ye,2),_e=me[0],ke=me[1],Oe=Object(f.useRef)(""),xe=Object(f.useState)({}),Ee=c()(xe,2),Se=Ee[0],Ce=Ee[1],Ie=Object(f.useState)({diffX:0,diffY:0}),Be=c()(Ie,2),Te=Be[0],we=Be[1],Re=Object(f.useState)(""),Me=c()(Re,2),je=Me[0],De=Me[1],Ae=Object(f.useState)(""),Pe=c()(Ae,2),Le=Pe[0],Ne=Pe[1],Fe=Object(p.useSelector)(u.selectors.share.selectCanEditInvolvingEditMode),Ue=!r&&(Fe&&Object(B.r)()?Object(k.R)(D.a.getState())===B.n.EDITING:Fe),He=Object(p.useSelector)(u.selectors.translate.selectTranslateStatus).translated,Ve=Ue&&!He,We=Object(f.useState)(!1),ze=c()(We,2),Ge=ze[0],Ke=ze[1],qe=Object(M.O)(),Xe=Object(f.useRef)({width:q(Ge,i,null===qe||void 0===qe?void 0:qe.isInWiki),height:K()}),Ye=Object(f.useState)(!1),Je=c()(Ye,2),Ze=Je[0],Qe=Je[1],$e=Object(f.useCallback)((function(){if(m){var e={width:q(Ge,i,null===qe||void 0===qe?void 0:qe.isInWiki),height:K()},n=e.width!==Xe.current.width||e.height!==Xe.current.height;b.S.isMobile&&(n=e.width!==Xe.current.width),n&&(Xe.current=e,Object(N.n)(e.height,j),Y.current?Ce(Object(H.d)(a,Y.current,Xe.current)):Qe(!Ze))}}),[Ze,a,Ge,i,j,null===qe||void 0===qe?void 0:qe.isInWiki,m]),et=function(e){we({diffX:e.diffX+(Te.diffX||0),diffY:e.diffY+(Te.diffY||0)})},tt=function(e){var n,r,o={pic_show_size:"".concat(Math.round(Xe.current.width),"x").concat(Math.round(Xe.current.height)),load_status:e?"success":"load_fail"};e&&(o.pic_original_size="".concat(null===(n=Y.current)||void 0===n?void 0:n.naturalWidth,"x").concat(null===(r=Y.current)||void 0===r?void 0:r.naturalHeight));C.S.loadCover(o)};function nt(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return ee(!1),void be(!0);if(Object(H.a)(e,je)){var o=Object(H.d)(a,Y.current,Xe.current);Object(d.isEqual)(Se,o)||Object(d.isEmpty)(o)||Ce(o)}else z=3,ie(!1),!r&&se(!1),De(e),Ne(n||""),!r&&ee(!0),be(!1),!r&&ke(!1),he(!1)}Object(f.useEffect)((function(){var e=Se.width,n=Se.height,r=Se.marginLeft,o=Se.marginTop,i=Te||{},c=i.diffX,a=void 0===c?0:c,l=i.diffY,s=void 0===l?0:l;if(0!==a||0!==s){var u=Object(H.f)(r+a,e,Xe.current.width),d=Object(H.f)(o+s,n,Xe.current.height);we({diffX:0,diffY:0}),u===r&&d===o||Ce({width:e,height:n,marginLeft:u,marginTop:d})}}),[Te]),Object(f.useEffect)((function(){if(a){var e=a&&a.src||"",n=a&&a.lightSrc||"";if(y.y)return void function(e,n){var r=Object(H.c)(e),o=r||X(e);if("string"===typeof o||!o)return;if(te)o.then((function(e){e&&De(e)})).catch(rt);else{var i=Object(H.c)(n),a=i||X(n),l=[o];"string"!==typeof a&&a&&(l.push(a),a.then((function(e){e&&(Ne(e),ee(!1))})).catch(ct)),o.catch(rt),Promise.all(l).then((function(n){if(Oe.current!==e){var r=c()(n,2),o=r[0],i=r[1];o&&i&&(Oe.current=e,nt(o,i,!0))}})).catch((function(e){return console.log(e)}))}}(e,n);if(te)return void De(te);nt(e,n)}else De(""),Oe.current="",ee(!1),be(!1),he(!1),Object(N.Z)(0,j)}),[a,te]),Object(f.useEffect)((function(){var e={trailing:!0};b.S.isMobile||(e.maxWait=200,e.leading=!0);var n=Object(d.debounce)($e,60,e);if(i){var r=new v.S(n),o=i;return r.observe(i),function(){r.unobserve(o)}}return b.S.isMobile?b.S.isMobile||b.S.isIPad||E.Y0?(window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}):void E.Y0:Object(R.N)().onResize($e)}),[$e,i]),Object(f.useEffect)((function(){var e=function(e){Ke(e)};return b.S.isLarkFeed&&!b.S.isLarkPureWebPage&&T.S.on(w.g.DOC_COMMENT_SHOW_CHANGE,e),function(){b.S.isLarkFeed&&!b.S.isLarkPureWebPage&&T.S.off(w.g.DOC_COMMENT_SHOW_CHANGE,e)}}),[]),Object(f.useEffect)((function(){$e()}),[$e,Ge]),Object(f.useEffect)((function(){Y.current&&Y.current.addEventListener("dragstart",(function(e){e.preventDefault()}))}),[]);var rt=function(){if(je)if(z){z--;var e=new URL(je);e.searchParams.append("t","".concat(Number(new Date))),De(e.toString()),!$&&!le&&ee(!0),ge&&be(!1)}else ee(!1),be(!0),tt(!1)},ot=function(){z=3,rt()},it=function(){ee(!1),Ce(Object(H.d)(a,Y.current,Xe.current)),ke(!0),be(!1),tt(!0)},ct=function(){ee(!1),se(!0),Ce(Object(H.d)(a,J.current,Xe.current))},at=function(){ie(!0),se(!0)};var lt=function(e){if(Object(O.P)("ccm_doc_content_page_click",Object(x.F3)(),{click:"click_".concat(e?"confirm":"cancel","_move_cover")}),!e)return Ce(Object(H.d)(a,Y.current,Xe.current)),he(!1);if(a){var n=Se.marginLeft,r=Se.marginTop,o=Se.width,i=Se.height,c=Object(H.T)(n,o,Xe.current.width),l=Object(H.T)(r,i,Xe.current.height),s=a.offset_ratio_x,u=a.offset_ratio_y;c!==s||l!==u?(T.S.trigger(S.F.UPDATE_COVER_POSITION,[W(W({},a),{},{offset_ratio_x:c,offset_ratio_y:l})]),he(!1)):he(!1),b.S.isMobile&&window.lark.biz.title.adjustCoverPosition({setting:!1})}},st=function(){he(!0),b.S.isMobile&&window.lark.biz.title.adjustCoverPosition({setting:!0})};if(!a&&!g)return null;var ut=s()(A.P,{"doc-cover-wrapper-loading":$}),dt={width:Math.min(Se.width||Xe.current.width,Xe.current.width),height:Math.floor(Xe.current.height)};return h.a.createElement("div",{ref:V,className:ut,style:dt},function(){var e=Math.floor(Xe.current.height)>160;return $&&!l?function(e){tt(!1);var n=h.a.createElement("div",{className:"doc-cover-offline-desc",style:{fontSize:14}},h.a.createElement("span",{className:"retry-text"},t("CreationDoc_DocX_Block_Load_Fail"),h.a.createElement("button",{type:"button",onClick:ot,className:"retry-btn"},t("CreationDoc_Docs_TwoWayLinks_LoadingError_Toast12"))));return h.a.createElement("div",{className:"doc-cover-offline"},h.a.createElement("div",{className:"doc-cover-offline-content docx-retry-content"},h.a.createElement("div",{onClick:e?void 0:ot},h.a.createElement(G,{style:{maxHeight:"96px",maxWidth:"96px"}})),e&&n))}(e):h.a.createElement(h.a.Fragment,null,ge?function(e){tt(!1);var n=null===a||void 0===a?void 0:a.status,r=h.a.createElement("span",null,t("CreationDoc_DocX_Block_Load_Fail"),h.a.createElement("button",{type:"button",onClick:ot},t("CreationDoc_Docs_TwoWayLinks_LoadingError_Toast12")));return h.a.createElement("div",{className:"doc-cover-error"},h.a.createElement("div",{onClick:e?void 0:ot},h.a.createElement(G,null)),h.a.createElement("div",{className:"doc-cover-error-desc",style:{fontSize:16}},e&&(10!==n||(null===a||void 0===a?void 0:a.token)?r:t("CreationDoc_DocX_Cover_failed_placeholder"))))}(e):a?h.a.createElement(L.S,{isDragging:fe,style:Se,updatePosition:et},h.a.createElement("img",{ref:Y,src:je,onLoad:it,onError:rt,className:"doc-cover-image",style:{display:_e?void 0:"none"}}),Le&&!oe&&!_e&&h.a.createElement("img",{ref:J,src:Le,onLoad:ct,onError:at,style:{visibility:le?"visible":"hidden"}})):null,($||g)&&h.a.createElement(u.SuiteLoading,{size:b.S.isMobile?24:36,color:"var(--text-disabled)"}),Ve&&Object(I.t)()&&h.a.createElement(P.S,{isDragging:fe,isOnline:l,hasError:ge,onDragEnd:lt,onDragStart:st,coverInfo:a}))}())}}).call(this,r("dx_E9Eu"))},dx_homR:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return S})),r.d(n,"m",(function(){return C}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_lwsE"),c=r.n(i),a=r("dx_W8MJ"),l=r.n(a),s=r("dx_W7W2"),u=r.n(s),d=r("dx_a1gu"),f=r.n(d),h=r("dx_Nsbk"),p=r.n(h),v=r("dx_K5vg"),g=r("dx_cDcd"),b=r.n(g),y=r("dx_PQBD"),m=r("dx_y5yU"),_=r("dx_Vau3"),k=r("dx_D8nn");r("dx_rG4Y");function O(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=p()(e);if(n){var i=p()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return f()(this,r)}}var x=Object(m.r)(v.S);function E(e){var n=Object(y.w)(e.blockType),r=t("CreationDoc_export_placeholder_FailedToLoad",{},"",n);return b.a.createElement("div",{className:"shortcut-block-error-container"},b.a.createElement("div",{className:"shortcut-docx-block-err"},b.a.createElement("div",{className:"shortcut-err-icon-wrap"},b.a.createElement(x,{style:{maxHeight:"100%",maxWidth:"125px"}}),b.a.createElement("div",{className:"break-line"})),b.a.createElement("div",{className:"retry-tips"},b.a.createElement("span",null,r))))}var S="SHORTCUT_BLOCK_ERROR",C=function(e){u()(r,e);var n=O(r);function r(){return c()(this,r),n.apply(this,arguments)}return l()(r,[{key:"getWrapper",value:function(e){return function(n){var r=Object(g.useState)(!1),i=o()(r,2),c=i[0],a=i[1],l=function(e){e===n.model.recordId&&a(!0)};return Object(g.useEffect)((function(){return k.N.on(S,l),function(){k.N.off(S,l)}})),c?b.a.createElement(E,{blockType:n.record.snapshot.type}):b.a.createElement(e,n)}}}]),r}(_.A)}).call(this,r("dx_E9Eu"))},dx_hr3X:function(e,n,r){"use strict";r.d(n,"I",(function(){return i}));var o=r("dx_D8nn");function i(e){o.S.emit(o.p.COMMON.TRIGGER_CLICK_CLOSE_BLOCK_MENU_PANEL),this.config.editable?this.props.isSelected&&this.showPreview():this.showPreview()}},dx_hrzn:function(e,n,r){"use strict";r.d(n,"Jk",(function(){return i})),r.d(n,"J",(function(){return c})),r.d(n,"U",(function(){return o}));var o,i="SHOW_OKR_SEARCH",c="HIDE_OKR_SEARCH";!function(e){e[e.Default=0]="Default",e[e.Normal=1]="Normal",e[e.Invalid=2]="Invalid",e[e.Hidden=3]="Hidden"}(o||(o={}))},dx_hvnm:function(e,n,r){"use strict";r.d(n,"X",(function(){return i}));var o=r("dx_B28d"),i=function(e){var n,r=e.getBlockModelByBlockId(e.rootBlockId).children;if(r.length>1)return!1;var i=r[0];if(!i)return!0;if(i.type===o.B.BLANK)return!0;var c=e.getBlockViewByBlockIdNotCheck(i.id),a=i.type===o.B.TEXT,l=null===c||void 0===c||null===(n=c.editor)||void 0===n?void 0:n.getStatus("isComposing"),s=i.isTextBlock&&i.isEmpty&&1!==i.snapshot.text_indent&&!i.children.length;return a&&!l&&s}},dx_hvuK:function(e,n,r){},dx_i44h:function(e,n,r){"use strict";r.d(n,"h",(function(){return i}));var o=r("dx_UtDZ");function i(){return Object(o.getMinaConfig)("ccm.docx.equation_insert_enabled",!1)}},dx_i4Kt:function(e,n,r){"use strict";r.d(n,"G",(function(){return s}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_h6a8"),a=r("dx_cDcd"),l=r("dx_S6dX");function s(e){var n=Object(a.useState)(Object(l.e)()),r=i()(n,2),o=r[0],s=r[1];return Object(a.useEffect)((function(){if(e){var n=function(){s((function(e){var n=Object(l.e)();return Object(c.isEqual)(n,e)?e:n}))};return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}}),[e]),o}},dx_i5i9S:function(e,n,r){"use strict";r.d(n,"W",(function(){return v}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f);function p(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var v=function(e){s()(r,e);var n=p(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).bridge=void 0,e}return a()(r,[{key:"commentModule",get:function(){return this.editorContext.commentModule}},{key:"token",get:function(){return this.snapshot.token}}]),r}(r("dx_MGoZ").l)},dx_i6iB:function(e,n,r){"use strict";var o,i;r.d(n,"R",(function(){return o})),r.d(n,"s",(function(){return i})),function(e){e[e.Granted=1]="Granted",e[e.Forbidden=0]="Forbidden"}(o||(o={})),function(e){e.OKR_APP_SUPER_ADMIN="okr_app_super_admin",e.SAAS_TENANT_ADMIN="saas_tenant_admin"}(i||(i={}))},dx_i7i0:function(e,n,r){"use strict";r.d(n,"W",(function(){return i}));var o=r("dx_cDcd"),i=function(e){var n=e.block,r=e.containerEditor,i=e.getEquationRange,c=e.onIsEditModeChange;return{onExit:Object(o.useCallback)((function(e){var r,o=null===(r=i())||void 0===r?void 0:r.clone();if(o){if(void 0!==e){var a=e?o.end:o.start;null===n||void 0===n||n.model.setSelection({start:a,end:a},!0)}null===n||void 0===n||n.focus(),null===c||void 0===c||c(!1)}}),[n,r,c,i])}}},dx_iCf4:function(e,n,r){"use strict";r.d(n,"g",(function(){return m})),r.d(n,"T",(function(){return _})),r.d(n,"s",(function(){return k})),r.d(n,"P",(function(){return O})),r.d(n,"f",(function(){return E}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_lSNA"),s=r.n(l),u=r("dx_dvfR"),d=r("dx_xs2W"),f=r("dx_bPy9"),h=r("dx_QJ6a");function p(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return v(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function v(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function g(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function b(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?g(Object(r),!0).forEach((function(n){s()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var y=/\.|\:/,m=function(e){e.zoneState.getEntities([[h.h,void 0]]).forEach((function(n){e.setAttributes(n,s()({},h.h,""),{extra:{shouldCollab:!1}})}))},_=function(e,n){var r=e.closest(".outer-u-container");if(!r)return null;var o=Object(u.F)(r,n);if(!o)return null;var i=e.closest("[data-zone-id]");if(!i)return null;var c=i.getAttribute("data-zone-id"),a=n.getContentState().getZoneState(c),l=null===a||void 0===a?void 0:a.getLine(o.start.line);if(!l)return null;var s=o.start.offset,d=o.end.offset,p=l.getEntities({start:s,end:d}),v=p[0],g=p.reduce((function(e,n){return"".concat(e).concat(n.text)}),""),y=e.closest(".link-wrapper");if(!y)return null;var m=null===y||void 0===y?void 0:y.getAttribute(h.b),_=v.attributes[h.e],k=_||m||"",O=_?h.e:h.b,x=b(b({},v),{},{start:p[0].start,end:p[p.length-1].end,text:g}),E=e.closest(".link-wrapper");if(!E)return null;var S="";return E.classList.forEach((function(e){e.indexOf("link-id")>-1&&(S=".".concat(e))})),{key:O,value:decodeURIComponent(k),continuousLink:x,id:S,blockId:Object(f.j)(c)}},k=function(e,n,r,o){var i,c=n-1;return c<0||(null===(i=e.getOps()[c].attributes)||void 0===i?void 0:i[r])!==o},O=function(e,n,r,o){var i,c=n+1;return c+1>e.getOps().length||(null===(i=e.getOps()[c].attributes)||void 0===i?void 0:i[r])!==o};var x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!!e.link},E=function(e,n){var r=d.M;r.lastIndex=0;var o,c=null,l=[],u=!1,f=new Map([["(",")"],["[","]"],["{","}"],["<",">"]]),v=null,g=e.hasLineMarker()?1:0,b=e.getModelText(),m=b.slice(g,b.endsWith("\n")?-1:b.length);if(y.test(m)){for(var _=function(){c||(c=[],l=[]);var n=o.index+g,r=o[0];(function(e,n){var r,o=E((r=i()(n.keys())).concat.apply(r,i()(n.values())));return new RegExp("[".concat(o,"]")).test(e)})(r,f)&&(r=function(e,n){for(var r=[],o=e.length,c=e,a=0;a<o;a++){var l=e[a],s=new RegExp("[".concat(E(i()(n.values())),"]")).test(l);if(n.has(l))r.push([n.get(l),a]);else if(s){var u=r.pop();if(!u)return c=e.slice(0,a);if(l!==u[0])return c=r[0]?c=e.slice(0,r[0][1]):e.slice(0,u[1])}}r.length&&(c=e.slice(0,r[0][1]));return c}(o[0],f)),v||(v=function(){var n,r=0,o=[],i=p(e);try{for(i.s();!(n=i.n()).done;){var c=n.value;if(c.insert&&"string"===typeof c.insert&&"\n"!==c.insert){var l=c.insert.length;r+=l,e.getAttributes(r-l,r).find((function(e){var n=a()(e,2),r=n[0];return n[1],r.includes("mention-token")}))?o.push([r-l,r]):o.push(null)}else o.push(null)}}catch(s){i.e(s)}finally{i.f()}return o.filter(Boolean)}());var s=v.filter((function(e){return null!==e&&(n<e[0]&&n+r.length>=e[0])}));if(s.length){var u=s[0][0];r=r.slice(0,u-n)}if(v.some((function(e){return null!==e&&(n>=e[0]&&n+r.length<=e[1])})))return"continue";c.push([n,r]),l.push(n,n+r.length)};o=r.exec(m);)_();if(c){var k=function(){var e=0;return function(r){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};o.list&&/code/.test(o.list)&&(u=!0);var i=r.length,c=Object.keys(o),a=c.find((function(e){return"link"===e})),l=c.find((function(e){return"unlink"===e})),f=S(e,r,a,l);if(!f||u||l||x(o))n.retain(i);else{var p,v=h.b;n.retain(i,(p={},s()(p,v,Object(d.z)(f)),s()(p,"".concat(v,"-start"),String(e)),s()(p,"".concat(v,"-length"),String(i)),p))}e+=i}}(),O=function(e,n){var r=0,o=0;if(n)for(;r<n.length&&0===n[r];)r++;return function i(c,a){if(!n||r>=n.length)e(c,a),o+=c.length;else{var l=n[r]-o,s=c.length;if(l>=s)e(c,a),o+=c.length,l===s&&r++;else{var u=c;if(l>0){var d=u.substring(0,l);e(d,a),o+=l}r++,i(u.substring(l),a)}}}}(k,l);e.getOps().forEach((function(e){return O(e.insert,e.attributes||{})}))}}function E(e){return e.map((function(e){return"\\".concat(e)})).join("")}function S(e,n,o,i){if(!c)return!1;for(var a=0;a<c.length;a++){var l=c[a];if(e>=l[0]&&e<l[0]+l[1].length){if(!o){if(i){r.lastIndex=0;var s=r.exec(l[1].substring(n.length));return s?c.splice(a,1,[l[0]+n.length,s[0]]):c.splice(a,1),l[1]}return l[1]}c.splice(a,1),a--}}return!1}}},dx_iLNO:function(e,n,r){"use strict";r.d(n,"J",(function(){return h})),r.d(n,"u",(function(){return p}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_QILm"),a=r.n(c),l=r("dx_cDcd"),s=r.n(l),u=r("dx_L6Lu");function d(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function f(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?d(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var h=function(e){return s.a.forwardRef((function(n,r){var o=Object(l.useRef)(null),i=n.isPresentationMode,c=a()(n,["isPresentationMode"]);return Object(l.useEffect)((function(){if(r)return"function"===typeof r?(r(o.current),function(){r(null)}):(r.current=o.current,function(){r.current=null})}),[r]),Object(l.useEffect)((function(){if(i){var e=o.current;if(e){var n=e.getBoundingClientRect.bind(e);return e.getBoundingClientRect=function(){var e=n(),r=Object(u.K)();return new DOMRect(r*e.x,r*e.y,r*e.width,r*e.height)},function(){e.getBoundingClientRect=n}}}}),[i]),"string"===typeof e?s.a.createElement(e,f(f({},c),{},{ref:o})):s.a.createElement(e,Object.assign({},c,{ref:o}))}))},p=h("div")},dx_iSIC:function(e,n,r){"use strict";r.d(n,"Z",(function(){return W})),r.d(n,"V",(function(){return z})),r.d(n,"Y",(function(){return q}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_lSNA"),s=r.n(l),u=r("dx_RIqP"),d=r.n(u),f=r("dx_yXPU"),h=r.n(f),p=r("dx_e4eN"),v=r("dx_alfx"),g=r("dx_FBWK"),b=r("dx_h6a8"),y=r("dx_MoY1"),m=r("dx_b3bq"),_=r("dx_kP4l"),k=r("dx_Z7ZC"),O=r("dx_c0wU"),x=r("dx_z0z2"),E=r("dx_B28d"),S=r("dx_vOIB"),C=r("dx_A7Ap"),I=r("dx_AbAm"),B=r("dx_I11I"),T=r("dx_FHaN"),w=r("dx_WXfY"),R=r("dx_a7X6"),M=r("dx_R7AN"),j=r("dx_ZG9w"),D=r("dx_acOG"),A=r("dx_j6ji"),P=r("dx_e6eH"),L=r("dx_xWRc");function N(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function F(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return U(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function U(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function H(e,n){var r=e.getBlockModelByBlockId(n).type;return!E.j.includes(r)&&E.o.includes(r)}function V(){return V=h()(i.a.mark((function e(n,r,o){var c,l,s,u,f,h,p,v,B,T,w,M,N,F,U,V,z,G,Y,J,Z,Q,$,ee,te,ne,re,oe,ie,ce,ae,le=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=le.length>3&&void 0!==le[3]?le[3]:{},l=le.length>4?le[4]:void 0,s=le.length>5?le[5]:void 0,u=le.length>6&&void 0!==le[6]?le[6]:null,f=le.length>7&&void 0!==le[7]&&le[7],h=0===Object.keys(c).length,(p=Array.isArray(n)?n:[n]).length){e.next=9;break}return e.abrupt("return",[]);case 9:if(v=r.editorAPI.getService(D.N,{optional:!0}),T=function(e){return null===v||void 0===v?void 0:v.canBlockEdit(e.record,e.type,{type:"UPDATE_ATTRIBUTE",changedKey:"type",newValue:o})},!v||p.every((function(e){var n=r.getBlockModelByBlockId(e.id),o=T(n);return o||(B=n.record),o}))){e.next=14;break}return Object(A.A)({op_source:"turninto",op_type:"turninto",edit_type:"UPDATE_ATTRIBUTE",interceptedRecord:B}),e.abrupt("return",[]);case 14:if(o!==E.B.CALLOUT){e.next=19;break}return w=Object(O.e)(p,r,f),M=a()(w,2),N=M[0],F=M[1],e.next=18,F;case 18:return e.abrupt("return",N?[N]:[]);case 19:if(o!==E.B.QUOTE_CONTAINER){e.next=31;break}if(U=function(e){!Array.isArray(n)&&c.text&&Object(k.w)(e,n.record,c.text)},V=!!p.every((function(e){return Object(C.T)(r,e.id)})),!V){e.next=28;break}return e.next=25,Object(C.z)({blockManager:r,block:n,isMultipleSelection:f});case 25:case 30:return e.abrupt("return",e.sent);case 28:return e.next=30,Object(C.Q)({blockManager:r,block:n,beforeMove:U,isMultipleSelection:f});case 31:if(o!==E.B.TASK){e.next=36;break}return e.next=34,Object(I.t)((Array.isArray(n)?n:[n])[0],r,c);case 34:return z=e.sent,e.abrupt("return",z?[z]:[]);case 36:return o===E.B.CODE&&p.forEach((function(e){if(Object(j.f)(e)){var n=q(e.model.zoneState,r.recordManager);e.model.apply(n)}})),G=Object(m.q)()&&Object(E.q)().includes(o),Y=X(p,r,s,G),J=a()(Y,2),Z=J[0],Q=J[1],e.next=41,Q;case 41:return $=($=Z).filter(Object(b.partial)(H,r)),ee=Object(E.q)().includes(o),te=E.O.includes(o),ne=[],re=W($,r),oe=p.some((function(e){return E.O.includes(e.type)&&e.record.snapshot.seq})),ie=p.some((function(e){return E.O.includes(e.type)&&!e.record.snapshot.seq||[E.B.BULLET,E.B.TODO,E.B.TEXT].includes(e.type)})),ce=oe&&ie,ae=function(e,n){var i=0,l=[],s=new Set;if(e.forEach((function(e,d){var p=r.getBlockModelByBlockId(e),v=p.parent,b=p.record,m=p.recordId,O=p.type,S=b.snapshot;if(v&&ne.push([v,p.position+i]),S.text_indent){if(!g.browser.isMobile){var C,I=l.length-1,B=l[I];if(I>=0&&(null===(C=p.previousSibling)||void 0===C?void 0:C.id)===B[B.length-1])B.push(e);else if(ee||0===d){var T=r.getBlockViewByBlockId(e),w=Object(_.u)(T),M=T.model.previousSibling,j=M&&s.has(M.id);w&&!j?l.push([e]):s.add(e)}}n.replace(m,["text_indent"],0)}if(p.type===E.B.ORDERED&&u===o&&o===E.B.ORDERED&&oe&&!ie&&(b.snapshot.seq&&n.remove(m,["seq"]),n.replace(m,["type"],E.B.TEXT)),!h||p.type!==o){if(E.o.includes(O)&&E.o.includes(o)){if(O===E.B.ORDERED&&o!==E.B.ORDERED&&(b.snapshot.seq&&n.remove(m,["seq"]),b.snapshot.seq_level&&n.remove(m,["seq_level"])),E.O.includes(O)&&Object(P.Q)())if(o===E.B.ORDERED)ce?!S.seq&&n.insert(m,["seq"],"auto"):(S.seq?n.remove(m,["seq"]):n.insert(m,["seq"],"auto"),S.seq_level?n.remove(m,["seq_level"]):n.insert(m,["seq_level"],"auto"));else if(E.O.includes(o))n.replace(m,["type"],o);else{var D=S.seq,A=S.seq_level;D&&n.remove(m,["seq"]),A&&n.remove(m,["seq_level"]),u&&E.O.includes(u)&&D?n.replace(m,["type"],E.B.ORDERED):n.replace(m,["type"],o)}else if([E.B.ORDERED].includes(O)&&E.O.includes(o)&&Object(P.Q)())S.seq?n.replace(m,["seq"],"auto"):n.insert(m,["seq"],"auto"),S.seq_level?n.replace(m,["seq_level"],"auto"):n.insert(m,["seq_level"],"auto"),n.replace(m,["type"],o);else if(E.O.includes(o))S.seq&&n.remove(m,["seq"]),n.replace(m,["type"],o);else if(o===E.B.CODE){var L=K(S,[R.h.KEY]).textClientVars;L&&Object(k.w)(n,b,L);var N=localStorage.getItem(x.i);N&&n.replace(m,["language"],N),n.replace(m,["type"],o)}else n.replace(m,["type"],o);var F=ee&&E.O.includes(O||""),U=te&&Object(E.q)().includes(O||""),H=S.folded;(F&&o!==E.B.ORDERED||U)&&H&&n.replace(b.id,["folded"],!1),!ee&&S.children.length&&n.replaceChildren(b.id,[]),o===E.B.TODO&&n.replace(b.id,["done"],!1),o===E.B.ORDERED&&O!==E.B.ORDERED&&(c.seq||"auto"===S.seq||E.O.includes(O)&&Object(P.Q)()||n.replace(b.id,["seq"],"auto"))}else n.replace(b.id,[],r.createInitModel(o,{children:ee?S.children:[],text:c.text||S.text,parent_id:S.parent_id,comments:S.comments}));if(Object.entries(c).forEach((function(e){var r=a()(e,2),o=r[0],i=r[1];"text"===o?Object(k.w)(n,b,i):n.replace(b.id,[o],i)})),v&&p.children.length&&!ee&&!f){var V=p.children.map((function(e){return e.record.id})),W=p.position+i+1,z=Object(y.t)(n,v.record.id,W,V);i+=V.length,z.forEach((function(e,n){ne.push([v,W+n])}))}}})),f&&!ee){for(var p=Object(L.r)(e.map((function(e){return r.getBlockViewByBlockId(e)})),!0,!0).noInSelBlockList,v=e.map((function(e){return Object(S.q)(r.getBlockModelByBlockId(e))})),b=v.findIndex((function(e){return e===Math.min.apply(Math,d()(v))})),m=r.getBlockModelByBlockId(e[b]),O=[],C=b;C<e.length;C++){var I,B,T=r.getBlockModelByBlockId(e[C]);(null===(I=T.parent)||void 0===I?void 0:I.id)&&e.includes(null===(B=T.parent)||void 0===B?void 0:B.id)&&O.push(e[C])}O.push.apply(O,d()(p.map((function(e){return e.id}))));var w=m.parent;w&&O.length&&Object(y.t)(n,w.record.id,m.position+1,O.map((function(e){return r.getRecordByBlockId(e).id})))}l.forEach((function(e){var o=r.getBlockModelByBlockId(e[0]).previousSibling;if(o){var i=o.children.length,c=e.map((function(e){return r.getBlockModelByBlockId(e)})),a=c.map((function(e){return e.record.id}));Object(y.y)(n,c),Object(y.t)(n,o.record.id,i,a),"singleLineFromMarkdown"===u&&ne[0]&&(ne[0]=[o,i])}}))},e.next=53,Promise.race([r.applyTransaction("turninto",(function(e){re.forEach((function(n){ae(n,e)}))}),l),Promise.resolve()]);case 53:return e.abrupt("return",ne.map((function(e){var n=a()(e,2),r=n[0],o=n[1];return r.children[o].id})));case 54:case"end":return e.stop()}}),e)}))),V.apply(this,arguments)}function W(e,n){var r={};return e.forEach((function(e){var o,i=null===(o=function(e,n,r){var o=n.getBlockModelByBlockId(e),i=Array.isArray(r)?r:[r];for(;o.parent;){if(i.includes(o.type))return o;o=o.parent}if(i.includes(o.type))return o;return null}(e,n,E.h))||void 0===o?void 0:o.id;i&&(r[i]=r[i]?r[i].concat(e):[e])})),Object.values(r)}function z(e,n){return G.apply(this,arguments)}function G(){return(G=h()(i.a.mark((function e(n,r){var o,c,l,s,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Array.isArray(n)?n:[n],c=X(o,r),l=a()(c,2),s=l[0],u=l[1],e.next=4,u;case 4:return e.abrupt("return",s.filter(Object(b.partial)(H,r)));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(e,n){if(!n.length)return{textClientVars:null,changedMarks:[]};var r=null,o=new Set;if(e.text){var i=e.text,c=Object(v.Z)(i.initialAttributedTexts,i.apool);c.forEach((function(e){e.forEach((function(e){var r,i=F(n);try{for(i.s();!(r=i.n()).done;){var c,a=r.value;(null===(c=e.attributes)||void 0===c?void 0:c[a])&&(e.insert&&(e.insert=e.attributes[a]),delete e.attributes[a],o.add(a))}}catch(l){i.e(l)}finally{i.f()}}))})),o.size>0&&(r=Object(v.P)(c))}return{textClientVars:r,changedMarks:d()(o)}}function q(e,n){var r=new p.m({zoneId:e.getZoneId()}),o=0;return e.getEntities([[B.B],[T.O],[M.X],[R.h.KEY]]).forEach((function(i){var c=Object(b.pick)(i.attributes,x.Y),a=i.start,l=i.end,u=e.pointToOffset(a),d=e.pointToOffset(l);if("number"===typeof u&&"number"===typeof d){var f;if(i.attributes[B.B]){var h=i.attributes[B.B];if(!h||!n.hasRecord(h))return;var p=n.getRecord(h);p&&(f=Object(w.V)(p))}else if(i.attributes[T.O]||i.attributes[R.h.KEY])f=Object(w.G)({insert:i.text,attributes:i.attributes},n,!1,!0);else if(i.attributes[M.X]){var v=function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?N(Object(r),!0).forEach((function(n){s()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({},i.attributes);return v[M.X]="",r.retain(u-o).retain(d-u,v),void(o=d)}"undefined"!==typeof f&&(r.retain(u-o).delete(d-u).insert(f,c),o=d)}})),r}function X(e,n,r){for(var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=Promise.resolve(),c=[],a=e.length-1;a>=0;a--){var l=e[a];if(l.type===E.B.CALLOUT||l.type===E.B.QUOTE_CONTAINER)if(l.type===E.B.CALLOUT)!function(){var e=l.model,a=e.parent,s=a.record.id,u=e.position,d=e.children.length;i=n.applyTransaction("turnCalloutIntoText",(function(n){Object(y.y)(n,[e]),d>0&&Object(y.t)(n,s,u,e.children.map((function(e){return e.recordId})))}));var f=Object(b.range)(u,u+d).map((function(e){return a.children[e].id})).map((function(e){return n.getBlockModelByBlockId(e)})),h=Object(m.t)({fold:r,blockList:f,blockManager:n,shouldIgnoreFold:!0,recursive:o}).map((function(e){return e.id}));c=c.concat(h)}();else{var s=l.model.children,u=Object(m.t)({fold:r,blockList:s,blockManager:n,shouldIgnoreFold:!0,recursive:o}).map((function(e){return e.id}));c=c.concat(u)}else c.unshift(l.id)}return[c,i]}n.S=function(e,n,r){return V.apply(this,arguments)}},dx_iUyp:function(e,n,r){"use strict";(function(t){r.d(n,"N",(function(){return _})),r.d(n,"B",(function(){return O})),r.d(n,"P",(function(){return x}));var e=r("dx_lSNA"),o=r.n(e),i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_UtDZ"),u=r("dx_zUqt"),d=r("dx_d2dg"),f=r("dx_a48a"),h=r("dx_B28d"),p=r("dx_WKxm"),v=r("dx_wTwg"),g=r("dx_D26z"),b=r("dx_G2Gn"),y=r("dx_Vkw6"),m=function(){var e=l()(c.a.mark((function e(n){var r,o,i,a,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.text,o=n.block,i=n.linkRange,e.prev=1,e.next=4,null===(a=b.S.getBlockitModule())||void 0===a?void 0:a.pasteBlock(r,{uuid:Object(u.k)()},o.blockManager.getRootRecordId());case 4:if(l=e.sent,e.t0=l,!e.t0){e.next=9;break}return e.next=9,Object(v.C)({blockManager:o.blockManager,block:o,range:i,blockEntity:l});case 9:e.next=23;break;case 11:e.prev=11,e.t1=e.catch(1),e.t2=e.t1.code,e.next=-1===e.t2?16:-2===e.t2?18:-3===e.t2?20:22;break;case 16:case 18:return s.Toast.error({content:t("Calendar_Docs_UnrecognizedLink")}),e.abrupt("break",23);case 20:return s.Toast.error({content:e.t1.msg}),e.abrupt("break",23);case 22:return e.abrupt("break",23);case 23:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(n){return e.apply(this,arguments)}}(),_=function(e){switch(e.menuItemName){case y.k.card:m(e);case y.k.link:}},k=function(){var e=l()(c.a.mark((function e(n){var r,o,i,a,l,s,u,f,v,g,b,y,m;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.block,o=n.text,i=n.linkRange,a=r.blockManager,l=r.id,s=r.model.zoneState,u=a.getRecordByBlockId(l)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,a.applyTransaction("transformLinkToIframeBlock",(function(e){var n=s.remove(i).toAttributeText();e.replace(u.id,["text"],n)}));case 7:return e.next=9,Object(p.c)(o);case 9:return f=e.sent,v=u.snapshot,g=v.type,b=v.text_indent,y=v.align,m=!0,g!==h.B.TEXT||b||"left"!==y&&y||r.model.isEmpty&&(m=!1),e.next=15,Object(d.J)({block:r,blockManager:a,newBlockType:h.B.IFRAME,newBlockOptions:f,mark:{},isAppend:m});case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),O=function(e){var n=e.menuItemName,r=e.block,i=e.text,c=e.linkId,a=e.linkRange,l=r.blockManager;switch(n){case y.k.title:Object(f.T)({block:r,linkRange:a,url:i});break;case y.k.card:Object(f.y)({blockManager:l,block:r,mark:o()({},g.U,c),url:i,source:"paste"});break;case y.k.preview:k(e);break;case y.k.link:Object(f.j)(r)}};function x(){return Object(s.getMinaConfig)("ccm.docx.web.parse_link_to_isv_block",!1)}}).call(this,r("dx_E9Eu"))},dx_iVNl:function(e,n,r){"use strict";r.d(n,"C",(function(){return g})),r.d(n,"D",(function(){return h.D}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_wmJb"),s=r("dx_rQGm"),u=r("dx_b28D"),d=r("dx_Bait"),f=r("dx_D8nn"),h=r("dx_z8d9"),p=r("dx_tylp"),v=Object(u.e)("catalogue:move"),g=function(){function e(n,r){i()(this,e),this.moving=new h.W,this.catalogTransition=void 0,this.catalogueMainRef=void 0,this.callback=void 0,this.catalogueMainRef=n,this.callback=r}return a()(e,[{key:"catalogueMain",get:function(){return this.catalogueMainRef.current}}]),a()(e,[{key:"moveCatalog",value:function(e,n,r){var o=this;if(!this.moving.isMoving){var i=this.catalogueMain,c="".concat(r,".moveCatalog");if(this.start(e,c),i){var a={width:-Object(l.d)(i),opacity:"0"},u={width:0,opacity:"1"};if(e===h.D.LEFT){var d=[u,a];a=d[0],u=d[1]}v("%s: translateX %d => %d, animation=%s",c,a.width,u.width,n),this.catalogTransition={animationEnabled:n,beforeStart:function(){i.style.transition="",i.style.transform="translateX(".concat(a.width,"px"),i.style.opacity=a.opacity},onStart:function(){i.style.transition="transform ".concat(s.W,", opacity ").concat(s.W),i.style.transform="translateX(".concat(u.width,"px"),i.style.opacity=u.opacity},onEnd:function(){i.style.transition="",i.style.transform="",i.style.opacity="",o.moving.stop("".concat(c,".transitionend"))}},Object(p.b)(i,this.catalogTransition)}else this.moving.stop(c)}}},{key:"handleMoveEnd",value:function(e,n){this.callback.onMoveEnd(e,n),f.S.emit(d.v.CATALOGUE_MOVE_END)}},{key:"start",value:function(e,n){var r=this;this.moving.start(e,n).then((function(e){return r.handleMoveEnd(e.direction,e.caller)})).catch((function(e){return console.error("".concat(n,": fail to start move"),e)})),f.S.emit(d.v.CATALOGUE_MOVE_START)}},{key:"isMoving",get:function(){return this.moving.isMoving}},{key:"isMovingLeft",get:function(){return this.moving.isMovingLeft}},{key:"direction",get:function(){return this.moving.direction}}]),e}()},dx_iZpP:function(e,n,r){},dx_iboZ:function(e,n,r){},dx_ifle:function(e,n,r){"use strict";var o=r("dx_QILm"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_FBWK"),b=r("dx_cDcd"),y=r.n(b),m=r("dx_O7Od"),_=r("dx_mz66");function k(e){return e.type.startsWith("mouse")}r("dx_owqk");function O(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var x=[_.i.Left,_.i.LeftTop,_.i.LeftBottom],E=[_.i.Top,_.i.LeftTop,_.i.RightTop],S=[_.i.Left,_.i.Right],C=[_.i.Top,_.i.Bottom],I=function(e){d()(r,e);var n=O(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).draggingInfo=null,e.sensitivity=e.props.sensitivity&&e.props.sensitivity>=0?e.props.sensitivity:1,e.handleMouseMove=function(n){if(e.draggingInfo){var r,o,i,c;if(n.preventDefault(),k(n))i=n.clientX,c=n.clientY;else{if(!n.targetTouches[0])return;i=n.targetTouches[0].clientX,c=n.targetTouches[0].clientY}null===(r=(o=e.props).onResizeUpdate)||void 0===r||r.call(o,e.calcDragDiff(e.draggingInfo,{clientX:i,clientY:c}))}},e.handleMouseUp=function(n){if(e.draggingInfo){var r,o,i,c;if(k(n))i=n.clientX,c=n.clientY;else{if(!n.changedTouches[0])return;i=n.changedTouches[0].clientX,c=n.changedTouches[0].clientY}e.endDarg(),null===(r=(o=e.props).onResizeEnd)||void 0===r||r.call(o,e.calcDragDiff(e.draggingInfo,{clientX:i,clientY:c})),e.draggingInfo=null}},e.handleMouseLeave=e.handleMouseUp,e}return s()(r,[{key:"handleMouseDown",value:function(e,n){var r,o,i,c;k(e.nativeEvent)?(i=e.nativeEvent.clientX,c=e.nativeEvent.clientY):(i=e.nativeEvent.targetTouches[0].clientX,c=e.nativeEvent.targetTouches[0].clientY),this.draggingInfo={startX:i,startY:c,directionX:C.includes(n)?0:x.includes(n)?-1:1,directionY:S.includes(n)?0:E.includes(n)?-1:1},this.startDrag(),null===(r=(o=this.props).onResizeStart)||void 0===r||r.call(o,this.draggingInfo)}},{key:"startDrag",value:function(){document.body.classList.add(m.O),this.props.boundary.addEventListener("mousemove",this.handleMouseMove),this.props.boundary.addEventListener("touchmove",this.handleMouseMove),this.isBlockSelected||this.props.selectionAPI.restoreFocus(),document.addEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchend",this.handleMouseUp),g.browser.isIPad&&document.body.addEventListener("mouseleave",this.handleMouseLeave)}},{key:"endDarg",value:function(){document.body.classList.remove(m.O),this.props.boundary.removeEventListener("mousemove",this.handleMouseMove),this.props.boundary.removeEventListener("touchmove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),document.addEventListener("touchend",this.handleMouseUp),g.browser.isIPad&&document.body.removeEventListener("mouseleave",this.handleMouseLeave)}},{key:"calcDragDiff",value:function(e,n){var r=n.clientX,o=n.clientY;return{diffX:parseInt(((r-e.startX)*this.sensitivity).toFixed(0))*e.directionX,diffY:parseInt(((o-e.startY)*this.sensitivity).toFixed(0))*e.directionY}}},{key:"render",value:function(){var e=this,n=this.props,r=n.cursorType,o=n.direction;return y.a.createElement("div",{className:"".concat(m.T," ").concat(o.replace("-"," ")),style:{cursor:"".concat(r,"-resize")},onMouseDown:function(n){return e.handleMouseDown(n,o)},onTouchStart:function(n){n.preventDefault(),e.handleMouseDown(n,o)}})}},{key:"isBlockSelected",get:function(){var e=this.props,n=e.selectionAPI,r=e.blockId,o=n.getSelection();return 1===o.length&&o[0].id===r}}]),r}(y.a.Component),B=function(e){d()(r,e);var n=O(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"renderDraggableBtn",value:function(e,n){var r=y.a.createElement(I,Object.assign({cursorType:"ew",direction:_.i.Left},n)),o=y.a.createElement(I,Object.assign({cursorType:"ew",direction:_.i.Right},n)),i=y.a.createElement(I,Object.assign({cursorType:"ns",direction:_.i.Top},n)),c=y.a.createElement(I,Object.assign({cursorType:"ns",direction:_.i.Bottom},n)),a=y.a.createElement(I,Object.assign({cursorType:"nwse",direction:_.i.LeftTop},n)),l=y.a.createElement(I,Object.assign({cursorType:"nesw",direction:_.i.LeftBottom},n)),s=y.a.createElement(I,Object.assign({cursorType:"nesw",direction:_.i.RightTop},n)),u=y.a.createElement(I,Object.assign({cursorType:"nwse",direction:_.i.RightBottom},n)),d=[r,o,i,c,a,l,s,u],f=[a,l,s,u],h=[r,o],p=[i,c];switch(e){case _.J.Free:return d;case _.J.Proportional:return f;case _.J.Horizontal:return h;case _.J.Vertical:return p}}},{key:"render",value:function(){var e=this.props,n=e.children,r=e.type,o=e.editable,c=i()(e,["children","type","editable"]);return y.a.createElement("div",{className:m.E,contentEditable:!1},(void 0===o||o)&&this.renderDraggableBtn(r,c),n)}}]),r}(y.a.Component);n.S=B},dx_iheU:function(e,n,r){"use strict";r.d(n,"s",(function(){return oe}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_yG8O"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_PJYZ"),v=r.n(p),g=r("dx_W7W2"),b=r.n(g),y=r("dx_a1gu"),m=r.n(y),_=r("dx_Nsbk"),k=r.n(_),O=r("dx_Uyc2"),x=r.n(O),E=(r("dx_A1AB"),r("dx_Vvd7")),S=r("dx_QxNg"),C=r("dx_xjz2"),I=r("dx_UtDZ"),B=r("dx_r3ra"),T=r("dx_yzqx"),w=r("dx_zUqt"),R=r("dx_ABiD"),M=r("dx_GPzN"),j=r("dx_Ez6L"),D=r("dx_eSV8"),A=r("dx_w8Jj");var P,L,N,F,U,H,V,W,z,G=r("dx_QBF8"),K=r("dx_TYsD"),q=r("dx_Xdvu"),X=r("dx_hSCS"),Y=r("dx_EqZO"),J=r("dx_T3tg"),Z=r("dx_lXxx"),Q=r("dx_Za4A"),$=r("dx_XKQN"),ee=r("dx_YRGG"),te=r("dx_ppc6");function ne(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=k()(e);if(n){var i=k()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return m()(this,r)}}var re=new Set([S.e.NO_PERMISSION,S.e.NOT_FOUND,S.e.DELETED]),oe=(P=Object(E.H)(),L=Object(C.S)(),P((z=function(e){b()(r,e);var n=ne(r);function r(){var e;d()(this,r);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return e=n.call.apply(n,[this].concat(c)),s()(e,"api",U,v()(e)),s()(e,"eventEmitter",H,v()(e)),s()(e,"selection",V,v()(e)),s()(e,"clientVarCache",W,v()(e)),e.subs=[],e._fetchLibNeedDestroy=!1,e._fetchSingleToken=void 0,e.onEditorInit=a()(i.a.mark((function n(){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.options.onError&&e.eventEmitter.on(S.Ra.ERROR,e.options.onError),console.timeEnd("doc_init"),n.next=4,e.initClientVar();case 4:case"end":return n.stop()}}),n)}))),e}return h()(r,[{key:"init",value:function(){var e=this,n=this.api;this.subs.push(n.lifecycle.editorDidInit$.subscribe(this.onEditorInit)),this.selection.deactivate(),this.subs.push(n.modelService.initialDataReady$.subscribe((function(){e.selection.activate()})))}},{key:"destroy",value:function(){if(this._fetchLibNeedDestroy){var e=Z.u.getInstance();T.S.isMobile&&e.stop(this._fetchSingleToken),e&&e.clientvarFetchManager&&e.clientvarFetchManager.destroy()}this.options.onError&&this.eventEmitter.off(S.Ra.ERROR,this.options.onError),this.subs.forEach((function(e){return e.unsubscribe()}))}},{key:"onClientVarFetchStart",value:function(){M.S.updateStage(R.ET.FETCH_DOCX_CLIENTVARS_START),M.S.updateLoadMainStageDurationList(I.FILE_TYPE.DOCX,I.LOAD_MAIN_STAGE_DURATION_LIST_KEY.FETCH_FILE_CLIENTVARS_START)}},{key:"onClientVarSlicedFetchInit",value:function(){console.time("editable"),console.time("alldone"),Object(Q.K)(Y.j.INIT_SLICE_CLIENTVARS,{taskId:Object(I.encryptTea)(this.api.config.get("token"))})}},{key:"onClientVarFetchError",value:function(e){j.S.applyClientVar(j.M.FETCH_FAIL),re.has(null===e||void 0===e?void 0:e.code)||M.S.renderFail(R.g.FETCH_CLIENTVAR_ERROR)}},{key:"onClientVarFetchSuccess",value:function(e){M.S.updateStage(R.ET.FETCH_DOCX_CLIENTVARS_SUCCESS),M.S.updateLoadMainStageDurationList(I.FILE_TYPE.DOCX,I.LOAD_MAIN_STAGE_DURATION_LIST_KEY.FETCH_FILE_CLIENTVARS_SUCCESS),j.S.applyClientVar(j.M.FETCH_SUCCESS,e)}},{key:"awaitFirstSliceClientVarsDone",value:function(){var e=a()(i.a.mark((function e(){var n,r,o;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(n=this.api.config.get("awaitFirstSliceClientVars"))){e.next=9;break}if(r=this.api.config.get("token"),o=n(r),e.t0=o,!e.t0){e.next=9;break}return e.next=9,o;case 9:e.next=14;break;case 11:e.prev=11,e.t1=e.catch(0),console.error("awaitFirstSliceClientVars error",e.t1);case 14:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"initClientVar",value:function(){var e=a()(i.a.mark((function e(){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.onClientVarFetchStart(),e.next=3,this.awaitFirstSliceClientVarsDone();case 3:return e.prev=3,e.next=6,this.initSliceClientvars();case 6:e.next=15;break;case 8:throw e.prev=8,e.t0=e.catch(3),console.error("fetch client var error",e.t0),Object(D.n)(new Error("init clientvar error ".concat((null===e.t0||void 0===e.t0?void 0:e.t0.message)||""))),null===(n=(r=this.options).onFetchError)||void 0===n||n.call(r,e.t0),this.onClientVarFetchError(e.t0),e.t0;case 15:case"end":return e.stop()}}),e,this,[[3,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"initSliceClientvars",value:function(){var e=a()(i.a.mark((function e(){var n,r,o,c,a,l,s,u,d,f,h,p=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.api,r=this.options,o=n.config.get("token"),c=n.getService(q.a),this._fetchLibNeedDestroy=!0,!T.S.isMobile){e.next=13;break}return Object(I.getMinaConfig)("spacekit.mobile.docx_offline_create_enable",!1)&&(null===(a=this.clientVarCache)||void 0===a||a.init()),this._fetchSingleToken="".concat("".concat(Math.random()).slice(2,-1)).concat((new Date).getTime()),l=this.options.getClientVarsRequestExtraParams,e.next=10,Z.u.getInstance().start(o,"editor",new $.o(c.eventEmitter,null===l||void 0===l?void 0:l(),this.clientVarCache),{awaitToken:this._fetchSingleToken});case 10:if(!e.sent){e.next=13;break}return e.abrupt("return");case 13:return this.onClientVarSlicedFetchInit(),s=window.location.hash.slice(1),s=Object(w.A)(s),u=s.startsWith("dox"),d=n.getService(J.M),f=n.getService(J.e),e.next=21,Object(A.i)();case 21:return h=Object(B.t)(),f.setFirstSliceReady((function(e,i){var c,a;Object(Q.K)(Y.j.ON_FIRST_SLICE_READY,{taskId:Object(I.encryptTea)(o)}),n.getService(q.a).eventEmitter.once(Y.R.CLIENTVAR_FETCH_ALLOW_EDIT,(function(){n.config.update({editable:r.getCanEdit()})})),p.initCollab(e),null===(c=p.api.getService(ee.b))||void 0===c||c.handleFirstSlice(e),null===(a=p.api.getService(ee.B))||void 0===a||a.handleFirstSlice(e),d.genSkipBlockSet(),i.handleResponse(o,e),p.onClientVarFetchSuccess(e),h.resolve()})),d.getFirstSlice({token:o,hash:u&&s?s:void 0,onFirstSliceError:function(e){h.reject(e)}}),e.next=26,h.promise;case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initCollab",value:function(e){var n;null===(n=this.api.getService(K.q,{optional:!0}))||void 0===n||n.init({version:e.structure_version})}}]),r}(E.G),F=z,U=x()(F.prototype,"api",[E.Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),H=x()(F.prototype,"eventEmitter",[X.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),V=x()(F.prototype,"selection",[te.S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),W=x()(F.prototype,"clientVarCache",[L,G.y],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),N=F))||N)},dx_ij4R:function(e,n,r){"use strict";r.d(n,"e",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("lazy-consumer")},dx_imty:function(e,n,r){"use strict";var o;r.d(n,"H",(function(){return o})),function(e){e.LogOut="LogOut",e.ShowTemplate="ShowTemplate",e.RefreshEditor="RefreshEditor",e.LocateBlockWithRecordId="LocateBlockWithRecordId",e.FreezeDefaultScroll="FreezeDefaultScroll",e.GlobalCommentDidMount="GlobalCommentDidMount",e.CopyAll="CopyAll",e.PageEditable="PageEditable",e.EditableChange="EditableChange",e.QueryJump="QueryJump",e.OfflineApplyEnd="OfflineApplyEnd"}(o||(o={}))},dx_is2H:function(e,n,r){},dx_iw8O:function(e,n,r){"use strict";r.d(n,"n",(function(){return a})),r.d(n,"S",(function(){return s})),r.d(n,"Q",(function(){return d})),r.d(n,"f",(function(){return f})),r.d(n,"t",(function(){return h})),r.d(n,"C",(function(){return v}));var o=r("dx_Vvd7"),i=r("dx_rQGm"),c=r("dx_B28d");r("dx_q0q0"),r("dx_QBqw");function a(e){if(e.nodeType===Node.ELEMENT_NODE)return Number(e.getAttribute(i.aO))||void 0}function l(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;e=e.nodeType===Node.TEXT_NODE?e.parentElement:e;for(var o=0;e&&e!==n&&(a(e)&&!p(e)&&o++,o!==r);)e=e.parentElement;return o===r?e:void 0}function s(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(e){var o=l(e,n,r);return o?a(o):void 0}}function u(e,n){var r=document.elementFromPoint(e,n);return r&&s(r)||o.V}function d(e,n){for(var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=15,c=3,a=0,l=e,s=n,d=o.V;a<c&&!d;){r?s+=i:l+=i;var f=r?[e,s]:[l,n];d=u(f[0],f[1]),a++}return d||void 0}function f(e,n){var r=s(e);if(!r)return!0;var o=n.getBlockViewByBlockId(r);return!(![c.B.POLL,c.B.CHAT_CARD,c.B.SHEET,c.B.TABLE,c.B.BITABLE,c.B.IMAGE,c.B.FILE].includes(o.type)||!o.contentElement)&&!o.contentElement.contains(e)}function h(e,n){var r=s(e),o=s(n);return r&&o&&r===o}function p(e){return!(!e||!e.closest(".embed-inline-block"))}function v(e){var n=document.querySelectorAll(".".concat(i.b3.LAZY_SELECTION_NODE));return Array.from(n).some((function(n){return n===e||n.contains(e)}))}},dx_iwHP:function(e,n,r){"use strict";r.r(n);var o=r("dx_cDcd"),i=r.n(o),c=r("dx_l6li"),a=r("dx_o3oO"),l=r("dx_Vvd7"),s=r("dx_zjmc"),u=r("dx_R53K"),d=r("dx_W6W8"),f=r("dx_zKF3"),h=r("dx_oECv"),p=r("dx_o54o"),v=r("dx_B28d"),g=r("dx_bD2y"),b=r("dx_FBn3"),y=r("dx_W0Ov"),m=r("dx_vlKv"),_=r("dx_ApwS"),k=r("dx_DSuC"),O=r("dx_D3ws"),x=r("dx_pVRx"),E=r("dx_MQsy"),S=r("dx_LSbp"),C=r("dx_SbhA"),I=r("dx_x1xr"),B=r("dx_yl1C"),T=r("dx_sDWs"),w=r("dx_lwsE"),R=r.n(w),M=r("dx_W7W2"),j=r.n(M),D=r("dx_a1gu"),A=r.n(D),P=r("dx_Nsbk"),L=r.n(P),N=r("dx_jtB3"),F=r("dx_N9dL"),U=r("dx_fEKD"),H=r("dx_T4T0"),V=r("dx_Z22N");function W(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=L()(e);if(n){var i=L()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return A()(this,r)}}var z=function(e){j()(r,e);var n=W(r);function r(){return R()(this,r),n.apply(this,arguments)}return r}(r("dx_NMQJ").D);z.type=v.B.PENDING;var G=r("dx_W8MJ"),K=r.n(G),q=(r("dx_WqcI"),r("dx_MGoZ")),X=r("dx_G2jP");function Y(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=L()(e);if(n){var i=L()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return A()(this,r)}}var J,Z,Q=function(e){j()(r,e);var n=Y(r);function r(){return R()(this,r),n.apply(this,arguments)}return K()(r,[{key:"render",value:function(){return i.a.createElement(X.d,null)}}]),r}(q.l);function $(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=L()(e);if(n){var i=L()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return A()(this,r)}}var ee=Object(l.H)({providers:[{provide:V.I,useClass:H.V,args:[v.B.PENDING,{calculateModel:N.j.PENDING}]},{provide:F.RecordSnapshotCreator,useValue:{type:v.B.PENDING,create:U.b}}]})((Z=function(e){j()(r,e);var n=$(r);function r(){var e;R()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).blocks=[[z,{viewCreator:Q}]],e}return r}(l.y),J=Z))||J,te=r("dx_NMyZ"),ne=r("dx_l8lr"),re=r("dx_wGyE"),oe=r("dx_haL5"),ie=r("dx_oxJ8"),ce=r("dx_FVZU"),ae=r("dx_pk3x"),le=r("dx_ooSz"),se=r("dx_VWMO"),ue=r("dx_E3Ia"),de=r("dx_dajS"),fe=r("dx_tokD"),he=r("dx_V5C0"),pe=r("dx_B1B9"),ve=r("dx_RIqP"),ge=r.n(ve),be=r("dx_lSNA"),ye=r.n(be),me=r("dx_vLvZ"),_e=r("dx_Otwn"),ke=r("dx_VjTN"),Oe=r("dx_H6o9"),xe=r("dx_X36X"),Ee=r("dx_VC8Z"),Se=r("dx_WX15"),Ce=r("dx_e6eH"),Ie=r("dx_r4mc");function Be(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Te(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Be(Object(r),!0).forEach((function(n){ye()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Be(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var we=function(e){var n=[Se.S,e],r=[_e.S,e],o=[r],i=[n,r],c=[].concat(i,[[Ce.i,e]]),a=[Ie.S,e],l=[].concat(i,[a]),s=[].concat(i),u=Object(me.P)(v.B.IMAGE,e),d=[Oe.R,{autoNotifyRenderFinish:!0}],f=[[Oe.R,Te(Te({},e),{},{displayMode:v.J.BLOCK,autoNotifyRenderFinish:!0})]],h=Object(me.P)(v.B.BITABLE,e,{overrideProps:[d]}),p=Object(me.P)(v.B.MINDMAP,e,{overrideProps:[d]}),g=Object(me.P)(v.B.SHEET,e,{overrideProps:[d]}),b=[[xe.q,e]].concat(ge()(Object(me.P)(v.B.TABLE,e))),y=[[Ee.S,e],[ke.S,e]],m=[[ke.S,e]],_=[[ke.S,e]],k=[[ke.S,e]],O=[[ke.S,e]];return[[v.B.TEXT,i],[v.B.HEADING1,c],[v.B.HEADING2,c],[v.B.HEADING3,c],[v.B.HEADING4,c],[v.B.HEADING5,c],[v.B.HEADING6,c],[v.B.HEADING7,c],[v.B.HEADING8,c],[v.B.HEADING9,c],[v.B.FILE,y],[v.B.CHAT_CARD,m],[v.B.BULLET,s],[v.B.QUOTE,o],[v.B.CALLOUT,o],[v.B.CODE,_],[v.B.ORDERED,l],[v.B.TODO,i],[v.B.IMAGE,u],[v.B.TABLE,b],[v.B.MINDMAP,p],[v.B.IFRAME,f],[v.B.DIAGRAM,f],[v.B.SHEET,g],[v.B.BITABLE,h],[v.B.ISV,f],[v.B.POLL,f],[v.B.BOOKMARK,k],[v.B.JIRA_ISSUE,O],[v.B.WIKI_CATALOG,f],[v.B.WIKI_RECENT,f]]},Re=r("dx_hKIY");function Me(){return Object(ae.k)()}function je(){return Me()}function De(){return Object(ae.f)()}function Ae(){return[Object(l.Y)(T.i,{getTextEditorOptions:De}),Object(l.Y)(ee),Object(l.Y)(h.D,{getTextEditorOptions:je}),Object(l.Y)(ce.T,{getTextEditorOptions:Me}),Object(l.Y)(_.R,{getTextEditorOptions:Me}),Object(l.Y)(ne.y,{getTextEditorOptions:Me}),Object(l.Y)(C.D,{getTextEditorOptions:Me}),Object(l.Y)(S.a,{getTextEditorOptions:Me}),Object(l.Y)(le.Y,{getTextEditorOptions:Me}),Object(l.Y)(b.S),Object(l.Y)(d.G),Object(l.Y)(E.o),Object(l.Y)(s.S),Object(l.Y)(g.S),Object(l.Y)(x.S),Object(l.Y)(re.S),Object(l.Y)(I.S),Object(l.Y)(te.Q),Object(l.Y)(B.S,{getTextEditorOptions:Me}),Object(l.Y)(ie.Y),Object(l.Y)(ue.Z),Object(l.Y)(de.l),Object(l.Y)(y.S),Object(l.Y)(se.S),Object(l.Y)(O.S),Object(l.Y)(k.S),Object(l.Y)(f.S),Object(l.Y)(m.w),Object(l.Y)(oe.A),Object(l.Y)(p.T),Object(l.Y)(he.u,{loadableBlockTypes:[v.B.MINDMAP,v.B.BITABLE,v.B.SHEET,v.B.FILE,v.B.CODE]}),Object(l.Y)(Re.H),Object(l.Y)(pe.S),Object(l.Y)(u.S),Object(l.Y)(fe.B,{getExtensions:we})]}n.default=function(e){var n,r=e.objToken,o=null!==(n=e.scroller)&&void 0!==n?n:a.W,l=function(e){console.error("docx preview editor error",e)};return i.a.createElement("div",{style:{width:"80%",margin:"0 auto"}},i.a.createElement(c.V,{key:r,token:r,scroller:o,recursionProps:{editable:!1,isPreview:!0},onFetchError:l,onError:l,enableVirtualRender:!0,getEditorModules:Ae}))}},dx_ixLp:function(e,n,r){"use strict";r.d(n,"g",(function(){return d})),r.d(n,"R",(function(){return f}));var o,i,c=r("dx_lSNA"),a=r.n(c),l=r("dx_UtDZ");!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.DOC=1]="DOC",e[e.SHEET=2]="SHEET",e[e.BITABLE=3]="BITABLE",e[e.MINDNOTE=4]="MINDNOTE",e[e.FILE=5]="FILE",e[e.SLIDE=6]="SLIDE",e[e.WIKI=7]="WIKI",e[e.DOCX=8]="DOCX"}(i||(i={}));var s=(o={},a()(o,i.UNKNOWN,l.TYPE_ENUM.DOCX),a()(o,i.DOC,l.TYPE_ENUM.DOC),a()(o,i.SHEET,l.TYPE_ENUM.SHEET),a()(o,i.BITABLE,l.TYPE_ENUM.BITABLE),a()(o,i.MINDNOTE,l.TYPE_ENUM.MINDNOTE),a()(o,i.FILE,l.TYPE_ENUM.FILE),a()(o,i.SLIDE,l.TYPE_ENUM.SLIDE),a()(o,i.WIKI,l.TYPE_ENUM.WIKI),a()(o,i.DOCX,l.TYPE_ENUM.DOCX),o),u=Object.entries(s).reduce((function(e,n){return e[n[1]]=Number(n[0]),e}),{}),d=function(e){var n=s[e];return"number"===typeof n?n:l.TYPE_ENUM.DOCX},f=function(e){var n=u[e];return"number"===typeof n?n:i.DOCX}},dx_iyIx:function(e,n,r){"use strict";function o(){this.isBlankDiagram()||(this.isEditable?this.props.isSelected&&this.showPreview():this.showPreview())}r.d(n,"I",(function(){return o}))},dx_j0jk:function(e,n){},dx_j2jx:function(e,n,r){"use strict";var o;r.d(n,"I",(function(){return o})),function(e){e[e.Failed=10]="Failed"}(o||(o={}))},dx_j5jv:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M7.712 11.351L3.34 5.9a.45.45 0 010-.538.278.278 0 01.215-.112h8.89c.168 0 .305.17.305.381a.432.432 0 01-.09.269l-4.372 5.451c-.159.199-.417.199-.576 0z",fill:"#2B2F36"});n.S=function(e){return i.a.createElement("svg",c({width:16,height:16,viewBox:"0 0 16 16",fill:"none"},e),a)}},dx_j6ji:function(e,n,r){"use strict";r.d(n,"A",(function(){return l})),r.d(n,"b",(function(){return o})),r.d(n,"M",(function(){return s})),r.d(n,"O",(function(){return u}));var o,i=r("dx_UtDZ"),c=r("dx_Fimk");function a(e){var n=Object.assign({},e),r=e.interceptedRecord;return r&&(n.block_id=r.id?Object(i.encryptTea)(r.id):"",n.block_type=r.snapshot.type),delete n.interceptedRecord,n}function l(e){var n=a(e);n.intercept_type="user_operation",Object(c.N)("ccm_doc_pre_edit_change_intercept_dev",n)}function s(e){var n=a(e);n.intercept_type="remote_changes",Object(c.N)("ccm_doc_pre_edit_change_intercept_dev",n)}function u(e){Object(c.N)("ccm_doc_pre_edit_change_intercept_dev",a(e))}!function(e){e.HasCacheOp="has_cache_op",e.EditControl="edit_control"}(o||(o={}))},dx_j8ww:function(e,n,r){},dx_j92N:function(e,n,r){"use strict";r.d(n,"l",(function(){return h})),r.d(n,"l9",(function(){return p})),r.d(n,"I",(function(){return g}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_h6a8"),a=r("dx_C7Cb"),l=r("dx_yzqx"),s=r("dx_vE74"),u=r("dx_b28D"),d=r("dx_f4fP"),f=Object(u.e)("scrollable:scrollManage:utils"),h=function e(n){var r=this;i()(this,e),this.scrollableOptions=n,this.getDeltaX=function(e){return e.shiftKey?e.deltaX||e.deltaY||0:e.deltaX||0},this.checkIfHorizontalLeft=function(e){return e<0},this.checkIfMainlyVertical=function(e){return Math.abs(e.deltaY)>Math.abs(e.deltaX)},this.isEventIgnored=function(e){return e.target instanceof Element&&Object(s.Q)(e.target,r.scrollableOptions.ignoreScrollClasses)},this.addWheel=function(e,n){var o,i,c,s=function(e){var n=r.isEventIgnored(e);if(f("onStart(%s.%s), ignored=%s",e.type,e.eventPhase,n),!n){var l=Object(d.C)(e);o=l,i=l,c=Object(a.S)()}},u=function(e){if(o&&i&&c){var a=Object(d.C)(e),s=i.pageX-a.pageX,u=i.pageY-a.pageY,h=o.pageX-a.pageX,p=o.pageY-a.pageY,v=Math.abs(p)/Math.abs(h);if(i=a,s&&v<1){var g=Object.assign(e,a,{deltaX:r.formatDeltaValue(s),deltaY:r.formatDeltaValue(u),isTouchEvent:l.Z.isIPad,touchEventId:c});f("touchmove, deltaX=%d(%d), deltaY=%d(%d)",g.deltaX,s,g.deltaY,u),n(g)}}},h=function(){o=void 0,i=void 0,c=void 0},p={capture:!0,passive:!0},v={capture:!0,passive:!1};return e.addEventListener("touchstart",s,p),document.addEventListener("touchmove",u,v),document.addEventListener("touchend",h,!0),e.addEventListener("wheel",n,!0),function(){e.removeEventListener("touchstart",s,p),document.removeEventListener("touchmove",u,v),document.removeEventListener("touchend",h,!0),e.removeEventListener("wheel",n,!0)}},this.formatDeltaValue=function(e){if(!e)return 0;var n=e<0,r=Object(c.clamp)(Math.abs(e),0,50);return n?-r:r}},p=function(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3,o=e;return{getValue:function(){return o},setValue:function(e){o=e},resetValue:function(e){o=e,clearTimeout(n),n=setTimeout((function(){o=!e}),r)}}},v=window.requestAnimationFrame||window.webkitRequestAnimationFrame||function(e){return setTimeout(e,1e3/60)},g=function(e){var n=[],r=!1,o=function o(i){var c=n.reduce((function(e,n){return e+n}),0);n=[],c?(r=!0,e(c,i),v((function(){return o(i)}))):r=!1};return function(i,a){Object(c.isNumber)(i)?(n.push(i),!r&&o(a)):(n=[],e(i,a))}}},dx_j9j9:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return Be}));var e=r("dx_lSNA"),o=r.n(e),i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_PJYZ"),p=r.n(h),v=r("dx_iWIM"),g=r.n(v),b=r("dx_W7W2"),y=r.n(b),m=r("dx_a1gu"),_=r.n(m),k=r("dx_Nsbk"),O=r.n(k),x=r("dx_c9cXz"),E=r("dx_smKV"),S=r("dx_Y7YZ"),C=r("dx_PcQO"),I=r("dx_TSYQ"),B=r.n(I),T=r("dx_UtDZ"),w=r("dx_h6a8"),R=r("dx_cDcd"),M=r.n(R),j=r("dx_rQGm"),D=r("dx_MoY1"),A=r("dx_yzqx"),P=r("dx_UHze"),L=r("dx_hKul"),N=r("dx_CR0l"),F=r("dx_zEdG"),U=r("dx_CwnG"),H=r("dx_MUMK"),V=r("dx_OJCf"),W=r("dx_HA1r"),z=r("dx_MGoZ"),G=r("dx_B8Bh"),K=r("dx_lSlT"),q=r("dx_gDjg"),X=r("dx_zghO"),Y=r("dx_eGDr"),J=r("dx_D8nn"),Z=r("dx_jRGa"),Q=r("dx_N4Vo"),$=r("dx_Bapk"),ee=r("dx_wH9t"),te=r("dx_olwK"),ne=r("dx_AbAm"),re=r("dx_MsqB"),oe=r("dx_G3VO"),ie=r("dx_Ga6P"),ce=r("dx_jvoO"),ae=r("dx_I7QL"),le=r("dx_rhDI"),se=r("dx_n2gE"),ue=r("dx_O4OS"),de=r("dx_ddxk"),fe=r("dx_LxMw"),he=r("dx_Orag"),pe=r("dx_J93J"),ve=r("dx_Otgx"),ge=r("dx_d5dp"),be=r("dx_IBhU"),ye=r("dx_L6L1"),me=r("dx_nq8x"),_e=r("dx_Cg1F"),ke=r("dx_ZVwH"),Oe=r("dx_Bs0J"),xe=r("dx_X68U"),Ee=(r("dx_Zt69"),r("dx_n6nb"),r("dx_q5qe"));function Se(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Ce(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Se(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Se(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Ie(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=O()(e);if(n){var i=O()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return _()(this,r)}}var Be=function(e){y()(r,e);var n=Ie(r);function r(){var e;u()(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(e=n.call.apply(n,[this].concat(i))).editorInstance=void 0,e.isStopChange=!1,e.state={isEditorFocused:!1,isPopoverVisible:!1,loading:!1},e.noPermissionTipRef=M.a.createRef(),e.handleInit=function(n){e.editorInstance=n,n.clipboard.setCanInternalPasteWhitelist(["lark_docs","lark_sheet"])},e.register=function(n){var r,o;if(e.editorInstance=n,e.isSSR)return[];var i=[new pe.v,new x.p,new E.D,new ce.F,new fe.Z({editor:n,lang:T.i18nHelper.getLanguage(),boundary:e.boundary,block:p()(e),onMentionConfirm:e.handleMentionConfirm,onOpenMentionPanel:e.handleOpenMentionPanel}),new de.R({editor:n,getLinkInfo:e.getLinkInfo}),new ie.N({editor:n,onChange:e.model.handleEditorChange}),new ae.d({editor:n,block:p()(e),selectionAPI:e.selectionAPI,rect:e.props.recursionProps.rect,onFocus:e.handleEditorFocus,onBlur:e.handleEditorBlur}),new le.Q({editor:n,i18n:{},customProtocols:["lark"]}),new se.t({editor:n,selectionAPI:e.selectionAPI,block:p()(e),blockManager:e.blockManager}),new he.U,new ue.q({EndComponent:xe.e,PlaceholderComponent:ke.y,editor:n,block:p()(e)})],c=null===(r=e.props.recursionProps.undoModule)||void 0===r||null===(o=r.getUndoDispatcher)||void 0===o?void 0:o.call(r);return c&&i.push(new ve.M({editor:n,undoDispatcher:c})),i},e.handleCheckDetails=function(){A.S.isMobile?Object(F.P)("ccm_doc_mobile_menu_toolbar_click",{record_id:e.record.id,block_type:e.type},{click:"block_action",action_type:"check_task",object_block_data:Object(U.T)([e.blockId],e.blockManager)}):Object(ge.k)({blockId:e.id,actionType:"click_task_detail",blockManager:e.blockManager});var n=Object(w.get)(window,"globalConfig.common.domain.applink",{});Object(me.n)("https://".concat(n,"/client/todo/detail?guid=").concat(e.model.taskId,"&mode=app"))},e.handleTurnIntoTodo=function(){Object(ne.P)(p()(e),e.blockManager),A.S.isMobile?Object(F.P)("ccm_doc_mobile_menu_toolbar_click",{record_id:e.record.id,block_type:e.type},{click:"block_action",action_type:"click_task_cancel_sync",object_block_data:Object(U.T)([e.blockId],e.blockManager)}):Object(ge.k)({blockId:e.id,actionType:"click_task_cancel_sync",blockManager:e.blockManager})},e.handleDerefer=function(){Object(ne.J)([p()(e)],e.blockManager),A.S.isMobile?Object(F.P)("ccm_doc_mobile_menu_toolbar_click",{record_id:e.record.id,block_type:e.type},{click:"block_action",action_type:"click_task_cancel_quote",object_block_data:Object(U.T)([e.blockId],e.blockManager)}):Object(ge.k)({blockId:e.id,actionType:"click_task_cancel_quote",blockManager:e.blockManager})},e.handleFollow=function(){var n=e.model.isFollowed;e.taskModel.apply(Object(_e.LC)(e.taskData),{afterColla:function(n){var r=n.data;r&&e.model.isFollowed&&Object(ye.E)(r.guid)},immediatelyColla:!0}),A.S.isMobile?Object(F.P)("ccm_doc_mobile_menu_toolbar_click",{record_id:e.record.id,block_type:e.type},{click:"block_action",action_type:"focus_task",action_value:String(!n),object_block_data:Object(U.T)([e.blockId],e.blockManager)}):Object(ge.k)({blockId:e.id,actionType:"click_task_follow",actionValue:String(!n),blockManager:e.blockManager})},e.handleEditorFocus=function(){e.setState({isEditorFocused:!0})},e.handleEditorBlur=function(){e.setState({isEditorFocused:!1}),e.taskModel.collabConnector.flush()},e.addMentionAssignee=function(n){var r=Object(_e.n)(e.taskData.assignees_detail,!0,n);e.handleAssigneeChange(r)},e.handleMentionConfirm=function(n){var r=n.needNotification,o=n.id,i=n.type;Object(F.P)("ccm_mention_panel_click",{record_id:e.record.id,block_type:e.type},{click:"mention_confirm",mention_type:i,mention_obj_id:o?Object(T.encryptTea)(o):null,is_send_notice_flag:String(r),domain:"text",is_operator_flag:i===W.D.USER?String(r):""}),i===W.D.USER&&r&&e.addMentionAssignee(o)},e.handleOpenMentionPanel=function(){Object(F.P)("ccm_doc_content_page_click",{record_id:e.record.id,block_type:e.type,sub_block_type:""},{target:"ccm_mention_panel_view",click:"open_mention_panel"})},e.markCompleted=Object(w.debounce)((function(n){e.taskModel.apply(Object(_e.L)(e.taskData,n),{immediatelyColla:!0})}),0,{leading:!1,trailing:!0}),e.mobileNoPermissionToast=function(){A.S.isMobile&&!Y.r&&(Object(ye.K)(),Object(L.M)(e.id,{actionType:N.e.CLICK_TASK_NO_COMPLETE_PERMISSION_TIP,target:"none"},{blockManager:e.blockManager}))},e.handleCheckboxChange=function(n){e.isCanChecked?(Object(ge.k)({blockId:e.id,actionType:"click_task_status",actionValue:n?"true":"false",blockManager:e.blockManager}),e.markCompleted(n)):!e.translated&&e.editPermission&&e.mobileNoPermissionToast()},e.handleAssigneeChange=function(n){if(n.length>500)Object(ye.X)();else{var r=function(e){return{id:e.assignee_id,isCompleted:Boolean(e.completed_milli_time)}},o=e.taskData.assignees_detail.map(r),i=n.map(r);e.taskModel.apply(Object(_e.g)(e.taskData,n));var c=Object(w.differenceBy)(o,i,"id"),a=o.filter((function(e){return i.find((function(n){return n.id===e.id}))})).map((function(e){return e.id})),l=Object(w.differenceBy)(i.filter((function(e){return a.includes(e.id)})),o.filter((function(e){return a.includes(e.id)})),"isCompleted"),s={value1:Object(T.encryptTea)(e.currentUserId),value2:e.currentUserId===e.model.creatorId?"task_creater":"un_task_creater"};c.forEach((function(){Object(ge.k)({blockId:e.id,actionType:"click_task_remove_executor",actionValue:s,blockManager:e.blockManager})})),l.forEach((function(){Object(ge.k)({blockId:e.id,actionType:"click_task_mark_down",actionValue:s,blockManager:e.blockManager})}))}},e.handleDueTimeChange=function(n){var r=n.isAllDay,o=n.dueTime,i=n.dueTimezone,c=n.reminders;e.taskModel.apply({is_all_day:r,due_time:o,due_timezone:i,reminders:c})},e.handleErrorDelete=l()(c.a.mark((function n(){return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.props.recursionProps.editable){n.next=2;break}return n.abrupt("return");case 2:e.blockManager.applyTransaction("remove-error-block",(function(n){Object(D.y)(n,[e.model])}));case 3:case"end":return n.stop()}}),n)}))),e.handleDeletedRestore=l()(c.a.mark((function n(){return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.model.isTaskEditable&&(e.taskModel.restore(),Object(ge.k)({blockId:e.id,actionType:"click_task_restore",blockManager:e.blockManager}));case 1:case"end":return n.stop()}}),n)}))),e.getLinkInfo=function(){var e=l()(c.a.mark((function e(n){var r,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.url,o=Object(q.O)(r)){e.next=4;break}return e.abrupt("return",{title:"",is_cross_tenant:!1});case 4:return e.next=6,Object(q.m)(Ce({},o));case 6:if(!(i=e.sent)){e.next=9;break}return e.abrupt("return",{title:i.title||"",is_cross_tenant:i.tenant_id!==K.S.getCurrentPageTenantId()});case 9:return e.abrupt("return",{title:"",is_cross_tenant:!1});case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),e.handlePopoverVisibleChange=function(n){e.setState({isPopoverVisible:n})},e.handleBlockPlacehoderClick=function(){!1!==e.props.recursionProps.editable&&(e.selectionAPI.setSelection([{type:X.j.BLOCK,id:e.blockId}]),J.N.emit(J.p.MOBILE.BLOCK_MENU.SHOW_BLOCK_MENU))},e}return f()(r,[{key:"shouldShowFocusButton",value:function(){return!this.model.isDeleted&&Boolean(this.model.taskId)}},{key:"shouldShowDetailsButton",value:function(){return Boolean(this.model.taskId&&this.model.isTaskMember)}},{key:"shouldReferButton",value:function(){return this.editPermission&&!this.model.isDeleted&&Boolean(this.model.isReference)}},{key:"shouldShowTurnIntoTodoButton",value:function(){return this.editPermission&&Boolean(this.model.taskId)&&!this.model.isDeleted&&!this.model.isReference}},{key:"showLoading",value:function(){this.setState({loading:!0})}},{key:"hiddenLoading",value:function(){this.setState({loading:!1})}},{key:"getSelectionRangeRect",value:function(){var e=window.scrollY,n=Object(oe.p)(this.editorInstance);return Ce(Ce({},n),{},{top:n.top+e,bottom:n.bottom+e})}},{key:"blockViewDidMount",value:function(){g()(O()(r.prototype),"blockViewDidMount",this).call(this),this.isHistory||this.isPreview||Object(be.y)(this.docToken)}},{key:"blockViewDidUpdate",value:function(e,n){this.isHistory,g()(O()(r.prototype),"blockViewDidUpdate",this).call(this,e,n)}},{key:"blockViewWillUnmount",value:function(){g()(O()(r.prototype),"blockViewWillUnmount",this).call(this)}},{key:"render",value:function(){var e,n=this,r=this.taskData,i=r.assignees_detail,c=r.due_time,a=Object(_e.G)(this.taskData),l=!this.model.contentState.getActiveZone().isEmpty(),s=B()({"task-block-text-editor":!0,"task-block-text-editor-editable":!0,"task-block-text-editor-line-through":a,"non-empty":l});return M.a.createElement(M.a.Fragment,null,M.a.createElement("div",{className:B()({"task-block-shortcut-ready":!this.isShowLoading,"task-block__container":!0,"task-block-disabled-select":A.S.isMobile&&!this.editable}),style:{borderColor:this.borderColor,backgroundColor:this.props.syncCursorBgColor}},M.a.createElement(Z.R,{editable:this.props.recursionProps.editable,isLoading:this.isShowLoading,isLoadFail:this.isFetchedFail,isCreatedFail:this.isCreatedFail,isDeleted:this.model.isDeleted,isCanDeletedRestore:this.editPermission&&this.model.isTaskEditable,isAnonymous:Object(P.E)(),onDeletedRestore:this.handleDeletedRestore,isHistory:this.isHistory,onClickRetry:this.taskModel.fetch,onErrorDelete:this.handleErrorDelete,onPlacehoderClick:this.handleBlockPlacehoderClick},M.a.createElement(Q.b.Provider,{value:{block:this}},M.a.createElement(Oe.o.Provider,{value:{placeholder:this.editable?t("CreationDoc_Tasks_EnterTaskTitle_Placeholder"):"",taskData:this.taskData,selectionAPI:this.selectionAPI,blockManager:this.blockManager,boundary:this.boundary,editable:this.editable,currentUserId:this.currentUserId,record:this.props.record,blockId:this.id,assigneePickerType:this.props.type,handleAssigneeChange:this.handleAssigneeChange,handleDueTimeChange:this.handleDueTimeChange,block:this,onAssigneeVisibleChange:this.handlePopoverVisibleChange,onDueTimeVisibleChange:this.handlePopoverVisibleChange}},M.a.createElement(ee.J,{guideKey:"task-block-guide-refer",title:t("CreationDoc_Todo_TaskSyncedWithTaskInTasks_OnboardingMessage"),disabled:!this.props.editorAPI.config.editable||!this.model.isReference},M.a.createElement("div",{className:B()((e={},o()(e,"task-block",!0),o()(e,"task-block_content_editable",this.editable),o()(e,"task-block__reference",this.props.editorAPI.config.editable&&this.model.isReference),o()(e,"task-block__empty",!l&&(!i||0===i.length)&&!c),o()(e,"task-block__focus",this.state.isEditorFocused||this.state.isPopoverVisible),o()(e,"task-block-editor-focused",this.state.isEditorFocused||this.state.isPopoverVisible),o()(e,"task-block_content_popoverVisible",this.state.isPopoverVisible),e))},M.a.createElement("span",{className:"task-block-status",contentEditable:!1},M.a.createElement($.M,{udTriggerRef:this.noPermissionTipRef,title:this.props.editorAPI.config.editable&&!this.isCanChecked?t("CreationDoc_Tasks_NoPermissionToEditTask_Toast"):"",onVisibleChange:function(e){e&&Object(L.M)(n.id,{actionType:N.e.CLICK_TASK_NO_COMPLETE_PERMISSION_TIP,target:"none"},{blockManager:n.blockManager})}},M.a.createElement(C.Checkbox,{className:B()({"task-block-ud__checkbox":!0,checkboxChecked:a,checkboxNormal:!0}),checked:a,onCheckChange:this.handleCheckboxChange,onMouseDown:function(e){return e.preventDefault()}}))),M.a.createElement("div",{className:"task-block-content"},M.a.createElement("div",{key:"editor",className:"task-block-editor-wrapper",onClick:function(e){var r;(e.stopPropagation(),n.props.recursionProps.editable&&!n.model.isTaskEditable)&&(A.S.isMobile?n.mobileNoPermissionToast():null===(r=n.noPermissionTipRef.current)||void 0===r||r.setVisible((function(e){return!e})))},onMouseLeave:function(){var e;return null===(e=n.noPermissionTipRef.current)||void 0===e?void 0:e.setVisible(!1)},onKeyDown:function(e){if(Object(V.u)(e.nativeEvent)===H.F.onSelectAll){var r,o=null===(r=n.editorInstance)||void 0===r?void 0:r.selection.getSelection().toPosition();if(o){var i,c;if(0===o.start&&o.len+1===(null===(i=n.editorInstance)||void 0===i?void 0:i.getContentState().getActiveZone().totalWidth()))return;null===(c=n.editorInstance)||void 0===c||c.selection.selectAll(),e.preventDefault(),e.stopPropagation(),e.nativeEvent.preventDefault(),e.nativeEvent.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}}}},M.a.createElement(S.l,{businessKey:"",copyable:this.copyable,editable:this.editable,register:this.register,onInit:this.handleInit,contentState:this.model.contentState,debounceFlush:0,className:s,modules:te.x})),this.model.taskId&&!this.props.recursionProps.isPresentationMode&&M.a.createElement(Ee.s,{taskId:this.model.taskId,isFollowed:this.model.isFollowed,onFollow:this.handleFollow,isShowFocusButton:this.shouldShowFocusButton(),onVisibleChange:this.handlePopoverVisibleChange,isShowDetailsButton:this.shouldShowDetailsButton(),onCheckDetails:this.handleCheckDetails,isShowReferButton:this.shouldReferButton(),onDerefer:this.handleDerefer,isShowTurnIntoTodoButton:this.shouldShowTurnIntoTodoButton(),onTurnIntoTodo:this.handleTurnIntoTodo})))))))),M.a.createElement("div",{style:{paddingLeft:j.X-G.s-G.t,marginLeft:G.s},className:"list-children"},this.renderChildren()))}},{key:"focusElement",get:function(){return A.S.isIOS&&this.editorInstance?this.editorInstance.getContainer():null}},{key:"taskData",get:function(){return this.model.taskData}},{key:"taskModel",get:function(){return this.model.taskModel}},{key:"blockStatus",get:function(){return this.props.record.snapshot.status}},{key:"blockId",get:function(){return this.props.blockId}},{key:"isFetchedFail",get:function(){return Boolean(this.model.taskId&&this.model.taskModel.fetchedStatus===re.FetchedStatus.fail)}},{key:"isCreatedFail",get:function(){return Boolean(!this.model.taskId&&this.blockStatus===re.TaskBlockStatus.Failed)}},{key:"isBlockRendered",get:function(){return!this.isShowLoading}},{key:"blockManager",get:function(){return this.props.recursionProps.blockManager}},{key:"docToken",get:function(){return this.blockManager.getRecordByBlockId(this.blockManager.rootBlockId).id}},{key:"currentUserId",get:function(){return T.userHelper.getCurrentUser().get("id")}},{key:"editable",get:function(){return!Y.r&&!1!==this.props.recursionProps.editable&&this.model.isTaskEditable}},{key:"copyable",get:function(){return this.props.recursionProps.copyable}},{key:"isPreview",get:function(){return!0===this.props.recursionProps.isPreview}},{key:"isShortcut",get:function(){return!0===this.props.recursionProps.isShortcut}},{key:"isSSR",get:function(){return!0===this.props.recursionProps.isSSR}},{key:"isPresentationMode",get:function(){return!0===this.props.recursionProps.isPresentationMode}},{key:"isCanChecked",get:function(){return!this.translated&&!this.isPreview&&!this.isPresentationMode&&(this.model.taskId?this.model.isTaskEditable:this.editPermission)}},{key:"borderColor",get:function(){var e=this.props,n=e.selected,r=e.syncCursorSelected,o=e.syncCursorBorderColor;return!n&&r?o:void 0}},{key:"isShowLoading",get:function(){return!this.isHistory&&(this.state.loading||this.taskModel.fetchedStatus===re.FetchedStatus.fetchting)}}]),r}(z.l)}).call(this,r("dx_E9Eu"))},dx_jBD0:function(e,n,r){"use strict";(function(t){r.d(n,"W",(function(){return s}));var e=r("dx_Q1BS"),o=r("dx_UtDZ"),i=r("dx_cDcd"),c=r.n(i),a=r("dx_Wftd"),l=r("dx_E7E0");function s(n){var r=n.boundary,i=n.block,s=n.data;return s.type===o.TYPE_ENUM.USER?c.a.createElement(e.S,null,c.a.createElement(l.i,{uid:s.token,type:i.props.type,record:i.props.record,blockManager:i.props.recursionProps.blockManager})):c.a.createElement(e.S,{className:"mention-doc-embed-container"},c.a.createElement(a.S,{file_type:s.type,title:s.title||Object(o.getUnnamedTitle)(s.type)||t("common.unnamed_document"),token:s.token,raw_url:decodeURIComponent(s.url),tenant_id:"",boundary:r,componentId:"",blockType:i.props.type,block:i.model}))}}).call(this,r("dx_E9Eu"))},dx_jDMf:function(e,n,r){"use strict";r.d(n,"M",(function(){return h})),r.d(n,"m",(function(){return p})),r.d(n,"s",(function(){return v})),r.d(n,"S",(function(){return g})),r.d(n,"w",(function(){return b}));var o=r("dx_Icqc"),i=r("dx_FBWK"),c=r("dx_MWd8"),a=r("dx_Py6Q"),l=r("dx_aRuT"),s=r("dx_KgXx"),u={},d={text:new Map(Object.keys(l.n).map((function(e){return[e,a.C.includes(e)?"":Object(c.f)(Object(i.getColor)(l.n[e],o.ThemeType.LIGHT))]}))),background:new Map(Object.keys(l.J).map((function(e){return[e,a.C.includes(e)?"":Object(c.f)(Object(i.getColor)(l.J[e],o.ThemeType.LIGHT))]})))},f={text:new Map(Object.keys(l.n).map((function(e){return[e,a.C.includes(e)?"":l.n[e]]}))),background:new Map(Object.keys(l.J).map((function(e){return[e,a.C.includes(e)?"":l.J[e]]})))},h=function(e){var n=u[e];n||(n=function(e){return{text:new Map(Object.keys(l.n).map((function(n){return[n,Object(c.f)(Object(i.getColor)(l.n[n],e))]}))),background:new Map(Object.keys(l.J).map((function(n){return[n,Object(c.f)(Object(i.getColor)(l.J[n],e))]}))),panelBackground:new Map(Object.keys(l.M).map((function(n){return[n,Object(c.f)(Object(i.getColor)(l.M[n],e),l.l[n])]})))}}(e),u[e]=n)},p=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(o.getCurrentThemeType)();u[n]||h(n);var r=u[n];return r[e]},v=function(e){return d[e]},g=function(e){return f[e]},b=function(e,n){var r=Object(s.v)(v(e),n);return r&&g(e).get(r)||n}},dx_jLaS:function(e,n,r){"use strict";(function(t){var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_TSYQ"),p=r.n(h),v=r("dx_UtDZ"),g=r("dx_cDcd"),b=r.n(g),y=r("dx_AERA"),m=r("dx_yYtq"),_=r("dx_M3MB"),k=r("dx_Nv7e"),O=r("dx_CZKf"),x=r("dx_Je9X"),E=r("dx_D8nn"),S=r("dx_h3h2"),C=r("dx_T17T"),I=r("dx_jduI");r("dx_EtmZ");function B(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var T=v.renderHelpers.MultiStageRenderContainer,w=v.renderHelpers.DocxStage,R=v.renderHelpers.Business,M=function(e){l()(r,e);var n=B(r);function r(){var e;o()(this,r);for(var i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).state={showSettingPopover:!1,extend:!1},e.trigger=void 0,e.hide=function(){e.setState({extend:!1,showSettingPopover:!1})},e.handleChoose=function(){Object(k.A)()?Object(k.yO)():(e.setState({showSettingPopover:!0}),Object(I.P)(I.F.ClickChooseCoverButton))},e.handleEditClick=function(n){e.props.isOnline&&(e.setState((function(e){return{extend:!e.extend,showSettingPopover:!1}})),n.stopPropagation(),E.S.trigger(x.F.REMOVE_ALL_SELECTION,[]),Object(I.r)(),Object(I.x)())},e.handleRemove=function(){E.S.trigger(x.F.SET_COVER_DATA,[{type:O.i.NONE}]),e.hide(),Object(I.P)(I.F.ClickRemoveCover)},e.handleDrag=function(){var n=e.props.onDragStart;n&&n(),e.hide(),Object(I.P)(I.F.ClickMoveCoverButton)},e}return c()(r,[{key:"componentDidUpdate",value:function(e){e.isOnline&&!this.props.isOnline&&this.hide()}},{key:"renderCoverPopoverOptions",value:function(){var e=this.props.hasError;return b.a.createElement("ul",{className:"cover-panel-popover-options"},b.a.createElement("li",{className:"cover-panel-popover-options-item",onClick:this.handleChoose},b.a.createElement("i",null,b.a.createElement(_.S,null)),b.a.createElement("span",null,t("CreationDoc_Docs_DocCover_ChooseCover_Option"))),e?null:b.a.createElement("li",{className:"cover-panel-popover-options-item",onClick:this.handleDrag},b.a.createElement("i",null,b.a.createElement(y.S,null)),b.a.createElement("span",null,t("CreationDoc_Docs_DocCover_AdjustCoverPosition_Option"))),b.a.createElement("li",{className:"cover-panel-popover-options-item",onClick:this.handleRemove},b.a.createElement("i",null,b.a.createElement(m.S,null)),b.a.createElement("span",null,t("CreationDoc_Docs_DocCover_RemoveCover_Option"))))}},{key:"render",value:function(){var e=this,n=this.props,r=n.isOnline,o=n.isDragging,i=n.onDragEnd,c=this.state,a=c.showSettingPopover,l=c.extend,s=p()("cover-panel-toolbar",{"cover-panel-toolbar-disable":!r&&!o,"cover-panel-toolbar-active":l||o}),u=function(e,n){return p()(e,{collapse:o&&!n||!o&&n})};return b.a.createElement("div",{className:s},[b.a.createElement("span",{className:u("cover-panel-toolbar-cancel",!0),key:"cancel",onClick:function(){i(!1)}},t("common.cancel")),b.a.createElement("span",{className:u("cover-panel-toolbar-normal",!0),key:"confirm",onClick:function(){i(!0)}},t("common.confirm")),b.a.createElement("span",{className:u("cover-panel-toolbar-normal",!1),ref:function(n){e.trigger=n},key:"edit",onClick:this.handleEditClick},t("CreationDoc_Docs_DocCover_Edit_Button"))],b.a.createElement(C.S,{trigger:this.trigger,extend:l,onClose:this.hide,ignoreClass:["doc-cover-toolbar"]},a?b.a.createElement(T,{renderOnTimeout:!0,business:R.Docx,renderWhen:w.Done},b.a.createElement(S.S,{onHide:this.hide,trigger:this.trigger,popoverActived:a})):this.renderCoverPopoverOptions()))}}]),r}(g.PureComponent);n.S=M}).call(this,r("dx_E9Eu"))},dx_jMMO:function(e,n,r){"use strict";r.d(n,"S",(function(){return v}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_wvVt"),h=r("dx_gLp6"),p=r("dx_O75l"),v=function(){function e(n,r,o,i){var c=this;s()(this,e),this.undoModule=void 0,this.recordId=void 0,this.recordHandlerMap={},this.blockManager=void 0,this.getRecord=void 0,this.undo=function(){c.blockManager.dispatch(p.r.UNDO)},this.redo=function(){c.blockManager.dispatch(p.r.REDO)},this.canUndo=function(){return c.undoModule.canUndo},this.canRedo=function(){return c.undoModule.canRedo},this.recordId=o,this.blockManager=n,this.undoModule=i,this.getRecord=function(){return r().diagram}}return d()(e,[{key:"updateRecord",value:function(){var e=a()(i.a.mark((function e(n){var r,o,c,a=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=Object(f.diff)(this.getRecord().data,n.data,(function(e){return e.unshift("data"),e.unshift("diagram"),e}))).forEach((function(e){"mxCellList"===e.path[e.path.length-2]&&(e.path[e.path.length-1]=Number(e.path[e.path.length-1]))})),o=[],c=[],r.forEach((function(e){e.op!==h.s.ADD&&e.op!==h.s.REPLACE||o.push({path:e.path,value:e.value}),e.op===h.s.REMOVE&&c.push(e.path)})),this.blockManager.applyTransaction("updateDiagram",(function(e){o.forEach((function(n){e.replace(a.recordId,n.path,n.value)})),c.reverse().forEach((function(n){e.remove(a.recordId,n)}))}));case 6:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"handleRecordChange",value:function(e){var n=this;Object.keys(this.recordHandlerMap).forEach((function(r){n.recordHandlerMap[r](e)}))}},{key:"addListener",value:function(e){this.recordHandlerMap[e]=e}},{key:"removeListener",value:function(e){delete this.recordHandlerMap[e]}}]),e}()},dx_jNP1:function(e,n,r){"use strict";r.d(n,"J",(function(){return D}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_om4o"),b=r("dx_TRUJ"),y=r("dx_J4zp"),m=r.n(y),_=r("dx_aUsF"),k=r.n(_),O=r("dx_h6a8");function x(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function E(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?x(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function S(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return C(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function C(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function I(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(n).forEach((function(r){e[r]=n[r]})),e}function B(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;if(Array.isArray(n)){var r,o=S(n);try{for(o.s();!(r=o.n()).done;){var i=r.value;Object.prototype.hasOwnProperty.call(e,i)&&delete e[i]}}catch(a){o.e(a)}finally{o.f()}}else for(var c in n=n||{},e)Object.prototype.hasOwnProperty.call(n,c)&&delete e[c];if(!Object(O.isEmpty)(e))return e}function T(e,n,r){var o={},i=0;e.nodes.forEach((function(e){for(var n=i,r=i+=e.text.length,c=n;c<r;c++)o[c]=I(o[c]||{},e.mark)})),n.forEach((function(e){for(var n=m()(e.range,2),r=n[0],i=n[1],c=r;c<i;c++)o[c]=I(o[c],e.mark)})),r.forEach((function(e){for(var n=m()(e.range,2),r=n[0],i=n[1],c=r;c<i;c++)o[c]=B(o[c],e.mark)||{}}));var c=[];Object.keys(o).reduce((function(e,n){if(null!==e&&Number(e)+1!==Number(n))c.push([Number(n)]);else if(null!==e&&(r=o[e],i=o[n],k()(r,i))){c[c.length-1].push(Number(n))}else c.push([Number(n)]);var r,i;return n}),null);var a=c.map((function(n){1===n.length?n=[n[0],n[0]+1]:n.length>1&&(n=[n[0],n[n.length-1]+1]);var r=o[n[0]];return function(e){void 0===e.mark&&delete e.mark;return e}({text:e.alltext.slice(n[0],n[1]),mark:r})}));return E(E({},e),{},{nodes:a})}function w(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return R(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return R(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function R(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function M(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var j="0",D=function(e){d()(r,e);var n=M(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,null,[{key:"createEmptyInputData",value:function(){return{alltext:"",size:0,nodes:[]}}},{key:"createEmptyClientVars",value:function(){return{apool:{nextNum:0,numToAttrib:{}},initialAttributedTexts:{attribs:{0:""},text:{0:""}}}}},{key:"serialize",value:function(e){if(!e)return this.createEmptyInputData();var n=e.initialAttributedTexts,r=e.apool,o=n.attribs,i=n.text,c=(new g.q).fromJsonable(r),a=o[0],l=i[0];return{alltext:i[0],size:i[0].length,nodes:A(a,l,c)}}},{key:"deserialize",value:function(e){if(!e.nodes.length)return this.createEmptyClientVars();var n,r=e.nodes,o=e.size,c=e.alltext,a=Object(g.Y)(o,"Z",j),l=function(e){var n,r={},o=0,i=new Set,c=w(e);try{for(c.s();!(n=c.n()).done;)for(var a=n.value,l=0,s=Object.entries(a.mark||{});l<s.length;l++){var u=s[l];"string"!==typeof u[1]&&(u[1]=String(u[1]));var d=String(u);i.has(d)||(i.add(d),r[o]=u,o++)}}catch(f){c.e(f)}finally{c.f()}return{numToAttrib:r,nextNum:o}}(r),s=(new g.q).fromJsonable(l),u=w(r);try{for(u.s();!(n=u.n()).done;){var d=n.value,f=Object.entries(d.mark||{});a.insert(d.text,f,s)}}catch(p){u.e(p)}finally{u.f()}var h=Object(g.f)(a.toString())[0].ops;return{initialAttributedTexts:{text:i()({},j,c),attribs:i()({},j,h)},apool:l}}},{key:"deserializePlainText",value:function(e){var n={alltext:e,size:e.length,nodes:[{text:e}]};return this.deserialize(n)}},{key:"getPlainText",value:function(e){return e?"string"===typeof e?e:e.initialAttributedTexts.text[0]:""}},{key:"isEmpty",value:function(e){var n=this.getPlainText(e);return!n||"\n"===n}},{key:"getSize",value:function(e){return this.getPlainText(e).length}},{key:"replaceMark",value:function(e,n,r){return this.replaceMarkKV(e,n,(function(e,n){return[e,r(e,n)]}))}},{key:"replaceMarkKV",value:function(e,n,r){var o=(new g.q).fromJsonable(e.apool);this.eachMark(e,(function(e,i){if(e===n){var c=o.getAttribNum(String([e,i]));o.updateAttrib(c,r(e,i))}})),e.apool=o.toJsonable()}},{key:"addMark",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=r.serialize(e),i=T(o,n,[]);return r.deserialize(i)}},{key:"eachMark",value:function(e,n){return(new g.q).fromJsonable(e.apool).eachAttrib(n)}},{key:"eachMarkByKey",value:function(e,n,r){this.eachMark(e,(function(e,o){e===n&&r(o)}))}}]),r}(b.Q);function A(e,n,r){for(var o=[],i=Object(g.B)(e),c=0,a=function(){var e=i.next(),a={},l=e.attribs,s=e.chars,u=e.opcode;l&&Object(g.p)(l,(function(e){a[r.getAttribKey(e)]=r.getAttribValue(e)}));var d=Object.keys(a).length;if("+"===u){var f=n.substr(c,s),h={text:n.substr(c,s)};d&&(h.mark=a),o.push(h),c+=f.length}};i.hasNext();)a();return o}},dx_jNWT:function(e,n,r){"use strict";r.d(n,"B",(function(){return i}));var o=r("dx_E7EG");function i(e){return Object(o.S)(e,"docx.viewEditors.isOpen",!1)}},dx_jRGa:function(e,n,r){"use strict";(function(t){r.d(n,"R",(function(){return s}));var e=r("dx_h6a8"),o=r("dx_cDcd"),i=r.n(o),c=r("dx_DOue"),a=r("dx_LNON"),l=r("dx_G2jP");function s(n){var r=n.editable,o=n.isLoading,s=n.isLoadFail,u=void 0!==s&&s,d=n.isCreatedFail,f=void 0!==d&&d,h=n.isDeleted,p=void 0!==h&&h,v=n.isCanDeletedRestore,g=void 0!==v&&v,b=n.isAnonymous,y=void 0!==b&&b,m=n.onPlacehoderClick,_=void 0===m?e.noop:m,k=n.onDeletedRestore,O=void 0===k?e.noop:k,x=n.onClickRetry,E=void 0===x?e.noop:x,S=n.onErrorDelete,C=void 0===S?e.noop:S,I=n.isHistory,B=void 0!==I&&I,T=n.children;if(o||B)return i.a.createElement(l.d,{isHistory:B});if(p||u||f||y){var w="";return y?w=t("CreationDoc_Tasks_NoAccessAnonymously_Text"):f?w=t("CreationDoc_Tasks_UnableToCreateTask_Toast",{DeleteBlock:"<DeleteBlock />"}):p?w=g?t("CreationDoc_Todo_TaskDeletedClickToRestore_Text",{ClickToRestore:"<ClickToRestore />"}):t("CreationDoc_Todo_TaskDeleted_Text"):u&&(w=t("CreationDoc_Tasks_UnableToLoadTaskClickToRetry_Text",{ClickToRetry:"<ClickToRetry />"})),i.a.createElement(c.A,{disabled:!0,onClick:_},i.a.createElement("div",{className:"task-block-placeholder-content"},i.a.createElement(a.m,{content:w,placeholders:{ClickToRestore:function(){return i.a.createElement("span",{className:"task-block-error-link",onClick:function(e){e.stopPropagation(),O()}},t("CreationDoc_Todo_TaskDeletedClickToRestore_Text_Variable"))},DeleteBlock:function(){return i.a.createElement("span",{className:r?"task-block-error-link":"",onClick:function(e){e.stopPropagation(),C()}},t("CreationDoc_Tasks_UnableToCreateTask_DeleteVariable"))},ClickToRetry:function(){return i.a.createElement("span",{className:"task-block-error-link",onClick:function(e){e.stopPropagation(),E()}},t("CreationDoc_Tasks_UnableToLoadTaskClickToRetry_Variable"))}}})))}return T}}).call(this,r("dx_E9Eu"))},dx_jduI:function(e,n,r){"use strict";r.d(n,"F",(function(){return o})),r.d(n,"P",(function(){return a})),r.d(n,"r",(function(){return l})),r.d(n,"x",(function(){return s}));var o,i=r("dx_zEdG"),c=r("dx_CwnG");!function(e){e.ClickChooseCoverButton="click_choose_cover_button",e.ClickMoveCoverButton="click_move_cover_button",e.ClickRemoveCover="click_remove_cover"}(o||(o={}));var a=function(e){Object(i.P)("ccm_doc_cover_edit_panel_click",Object(c.F3)(),{click:e,target:e===o.ClickChooseCoverButton?"ccm_doc_cover_choose_panel_view":"none"})},l=function(){Object(i.P)("ccm_doc_content_page_click",Object(c.F3)(),{click:"click_edit_cover_button",target:"ccm_doc_cover_edit_panel_view"})},s=function(){Object(i.T)("ccm_doc_cover_edit_panel_view",Object(c.F3)(),{})}},dx_je71:function(e,n,r){},dx_jl82:function(e,n,r){},dx_jrCs:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o),c=r("dx_BaZy"),a=r.n(c)()({loader:function(){return r.e("dx_ZmM").then(r.bind(null,"dx_EVx5"))},loading:function(){return null},render:function(e,n){var r=e.default;return i.a.createElement(r,n)}});n.S=a},dx_jrwu:function(e,n,r){"use strict";r.d(n,"o",(function(){return a}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=function(){var e=Object(c.useState)(!1),n=i()(e,2),r=n[0],o=n[1];return{hovered:r,handleWrapperMouseLeave:function(){r&&o(!1)},handleWrapperMouseOver:function(){r||o(!0)}}}},dx_jvIN:function(e,n,r){"use strict";r.d(n,"j",(function(){return p}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W7W2"),a=r.n(c),l=r("dx_a1gu"),s=r.n(l),u=r("dx_Nsbk"),d=r.n(u),f=r("dx_KTtu");function h(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var p=function(e){a()(r,e);var n=h(r);function r(e){var o;return i()(this,r),(o=n.call(this,e)).range=void 0,o.type=f.V.BookMarkBlock,o.range=e.range,o}return r}(r("dx_Dw4b").S)},dx_jvoO:function(e,n,r){"use strict";r.d(n,"F",(function(){return h}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W7W2"),a=r.n(c),l=r("dx_a1gu"),s=r.n(l),u=r("dx_Nsbk"),d=r.n(u);function f(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var h=function(e){a()(r,e);var n=f(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).editorWillPaste=function(e){var n=e.deltaSet;return n.forEach((function(e){"Z"===e.zoneType&&e.forEach((function(e){var n;if(null===(n=e.attributes)||void 0===n?void 0:n.hyperlink)try{var r,o=JSON.parse(null===(r=e.attributes)||void 0===r?void 0:r.hyperlink).href;o&&(e.insert=o)}catch(i){}}))})),n},e}return r}(r("dx_N8Nu").o)},dx_k1kQ:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M4.583 4.95c0-.202.165-.367.367-.367h.642c.202 0 .367.165.367.367v12.1a.367.367 0 01-.367.367H4.95a.367.367 0 01-.367-.367V4.95zM16.409 4.583a.367.367 0 00-.367.367v12.1c0 .203.164.367.366.367h.642a.367.367 0 00.367-.367V4.95a.367.367 0 00-.367-.367h-.642zM7.61 11.516c.902 0 1.856-.001 3.197-.007v1.444c0 .427.492.667.829.405l2.775-2.159a.513.513 0 000-.81l-2.775-2.16a.513.513 0 00-.829.406v1.497H7.61a.412.412 0 00-.412.412v.56c0 .227.184.412.412.412z",fill:"#646A73"});n.S=function(e){return i.a.createElement("svg",c({width:22,height:22,viewBox:"0 0 22 22",fill:"none"},e),a)}},dx_k2C3:function(e,n,r){"use strict";r.r(n);var o=r("dx_lSNA"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l={start:0,afterImport:0};l.start=Date.now();var s=r("dx_QxNg"),u=r("dx_TSYQ"),d=r.n(u),f=r("dx_UtDZ"),h=r("dx_h6a8"),p=r("dx_cDcd"),v=r.n(p),g=r("dx_h74D"),b=r("dx_bdgK"),y=r("dx_MuBQ"),m=r("dx_FUAQ"),_=r("dx_LjXK"),k=r("dx_IbkQ"),O=Object(g.connect)((function(e){return{widthMode:Object(_.K)(e)}}),(function(e){return{updateBusinessStage:function(n){e(f.renderHelpers.updateBusinessStage(f.renderHelpers.Business.Docx,n))}}}))(k.S),x=r("dx_hlsL"),E=r("dx_Cgns"),S=r("dx_rQGm"),C=r("dx_yzqx"),I=r("dx_H1q2"),B=r("dx_D9db"),T=r("dx_ABiD"),w=r("dx_GPzN"),R=r("dx_l6la"),M=r("dx_Q5XO"),j=r("dx_E2oU"),D=r("dx_BmAg"),A=r("dx_jNWT"),P=r("dx_jBAU"),L=r("dx_zz3R"),N=r("dx_TTrq"),F=r("dx_Ez6L"),U=r("dx_Fimk"),H=r("dx_eSV8"),V=r("dx_g0R0"),W=r("dx_b28D"),z=r("dx_L2tv"),G=r("dx_lXxx"),K=r("dx_XKQN"),q=r("dx_D8nn"),X=r("dx_MlPX"),Y=r("dx_lwsE"),J=r.n(Y),Z=r("dx_W8MJ"),Q=r.n(Z),$=r("dx_uxuX"),ee=r("dx_C7Cb"),te=r("dx_FvGq"),ne=r("dx_zghO"),re=function(){function e(n){J()(this,e),this.vcController=n,this.lastCallBlockId=void 0}return Q()(e,[{key:"enter",value:function(e){!C.S.isMobile&&this.vcController.selectionAPI&&(this.lastCallBlockId=e,this.vcController.selectionAPI.removeAllSelection())}},{key:"exit",value:function(e){if(!C.S.isMobile&&this.vcController.selectionAPI&&this.vcController.blockManager&&e===this.lastCallBlockId&&this.lastCallBlockId){var n=this.vcController,r=n.isFollow,o=n.blockManager,i=n.selectionAPI;!r&&o.hasBlockViewByBlockId(this.lastCallBlockId)&&i.setSelection([{id:this.lastCallBlockId,type:ne.j.BLOCK}]),this.lastCallBlockId=void 0}}}]),e}(),oe=r("dx_O1Ou"),ie=r("dx_MUhB"),ce=r("dx_moB4"),ae=oe.w.DOCX,le="doc_vcfollow_fetch_miss_dev",se=function(){function e(n){var r=this;J()(this,e),this.vcController=n,this.fetchMissTimer=void 0,this.lastVersionLagInfo=null,this.versionLagFetchMissEnable=C.S.isMobile?Object(f.getMinaConfig)("spacekit.mobile.ms_docx_version_lag_fetch_miss",!1):Object(f.getMinaConfig)("ms_docx_version_lag_fetch_miss",!1),this.handleSyncReady=function(){var e;r.bindEvents(!0),r.handleVersionChange((null===(e=r.sync)||void 0===e?void 0:e.getSyncVersion())||0)},this.handleVersionChange=function(e){var n;e===(null===(n=r.lastVersionLagInfo)||void 0===n?void 0:n.nextVersion)&&r.stopFetchMissTimer("socket version reach"),r.vcController.getVersion(ae)!==e&&r.vcController.setVersion(ae,e)},this.handleVersionLag=function(e){var n,o=null===(n=r.sync)||void 0===n?void 0:n.getSyncVersion();if(e.nextVersion===o)return r.vcController.setVersion(ae,o,!0);!r.versionLagFetchMissEnable||Object(h.isEqual)(e,r.lastVersionLagInfo)||r.fetchMissTimer||(r.lastVersionLagInfo=e,Object(f.LogFlow)(le).push({current_version:e.currVersion,next_version:e.nextVersion}),r.fetchMissTimer=setTimeout((function(){var n;(r.fetchMissTimer=void 0,e.nextVersion!==r.vcController.getVersion(ae))&&(null===(n=r.sync)||void 0===n||n.io.sendHeartbeats((function(){return r.collectFetchMiss("success")}),(function(e){return r.collectFetchMiss("fail",e.toString())}),{isNewHeartbeatsProtocol:!0}))}),Object(f.getMinaConfig)("vc_version_lag_fetch_miss_interval",1e3)))},this.sync?this.handleSyncReady():q.s.once(q.p.COMMON.COLLAB_MODULE_INIT_FINISH,this.handleSyncReady)}return Q()(e,[{key:"destroy",value:function(){this.bindEvents(!1),q.s.off(q.p.COMMON.COLLAB_MODULE_INIT_FINISH,this.handleSyncReady)}},{key:"bindEvents",value:function(e){var n,r=e?"on":"off";null===(n=this.sync)||void 0===n||n[r](s.T.VersionChange,this.handleVersionChange),f.EventEmitter[r]("".concat($.FOLLOW_EVENT,":").concat($.SUITE_VERSION_LAG),this.handleVersionLag)}},{key:"stopFetchMissTimer",value:function(e){this.fetchMissTimer&&(this.collectFetchMiss("cancel",e),clearTimeout(this.fetchMissTimer),this.fetchMissTimer=void 0)}},{key:"collectFetchMiss",value:function(e,n){Object(f.LogFlow)(le).report({status:e,info:n})}},{key:"sync",get:function(){var e,n;return null===(e=this.vcController.blockManager)||void 0===e||null===(n=e.recordManager.collabModule)||void 0===n?void 0:n.sync}}]),e}();function ue(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function de(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ue(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var fe=Object(W.e)("vcController"),he=[$.START_RECORD,$.START_FOLLOW,$.STOP_RECORD,$.STOP_FOLLOW],pe=[{obj:oe.w.DOCX,version:0}],ve=function(){function e(){var n=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f.EventEmitter;J()(this,e),this.eventEmitter=r,this.log=fe,this.ROLE=oe.f,this.VERSION_OBJ=oe.w,this.selectionAPI=void 0,this.fullscreenSelectionHelper=new re(this),this._currentCycle=void 0,this._blockManager=void 0,this.isBlockStructReady=!1,this.waitBlockStructReadyTimer=void 0,this.moduleRegisterPendingMap=new Map,this.moduleRegisterTime=new Map,this.moduleUnregisterFuncMap=new Map,this.otherModuleReplayHandlerPendingMap=new Map,this.otherModuleReplayHandlerResetMap=new Map,this.moduleStateMap=new Map,this.cycleCallback=[],this.destroyCallbackList=[],this.versionList=Object(h.cloneDeep)(pe),this.versionHandler=new se(this),this.vcBlockHelper=new ce.X(this),this.sendVersion=Object(h.debounce)((function(){var e=n.versionList.map((function(e){return e.version})).join(".");fe("%c send version: ".concat(e),"color: #CC0066"),n.eventEmitter.emit("".concat($.FOLLOW_EVENT,":").concat($.SUITE_VERSION_CHANGE),e)}),50),this.sendStateChange=function(e){var r=e.moduleName,o=e.action,i=e.onlyCurrentAction;if(void 0!==i&&i&&o){var c,a=null===(c=n.moduleStateMap.get(r))||void 0===c?void 0:c[o];n.eventEmitter.emit($.FOLLOW_ACTION,{module:r,actionType:o,data:a}),fe("%c state change ".concat(r," [").concat(o,"] : ").concat(JSON.stringify(a)),"color: #CC9933")}else{n.eventEmitter.emit($.FOLLOW_STATE_CHANGE,r);var l=n.moduleStateMap.get(r);fe("%c state change ".concat(r," : ").concat(JSON.stringify(l)),"color: #CC9933")}},this.setBlockManager=function(e){n._blockManager=e||void 0,e&&(n.handleBlockStructReady(),fe("%c set blockManager success","color: #FF6600"))},this.setSelectionAPI=function(e){n.selectionAPI=e},this.register=function(e){var r=e.from,o=void 0===r?oe.Q.MODULE:r,i=e.recordId,c=e.moduleName,l=e.replayHandler,s=e.presenterHandler,u=e.cycleHandler,d=e.otherModuleReplayHandler,f=e.dependBlockStruct,h=void 0===f||f,p=Object(ee.S)(),v=h&&!n.isBlockStructReady;if(o===oe.Q.MODULE&&n.vcBlockHelper.moduleConfigMap.has(c)){if(!i)return void console.error("[vcController]: module [".concat(c,"] register params should include record id"));n.vcBlockHelper.notifyBlockRender({recordId:i,moduleName:c,replayHandler:l,presenterHandler:s})}if(v)fe("%c register ".concat(c," waiting block struct ready"),"color: #FFCC00"),n.moduleRegisterPendingMap.set(p,e),n.moduleUnregisterFuncMap.set(p,(function(){n.moduleRegisterPendingMap.delete(p)}));else{n.moduleRegisterTime.set(c,(n.moduleRegisterTime.get(c)||0)+1),fe("%c register ".concat(c," times: ").concat(n.moduleRegisterTime.get(c)),"color: #FFCC00");var g=[];g.push(n.registerHandler($.FOLLOW_REPLAY,c,l)),1===n.moduleRegisterTime.get(c)&&n.registerModule(e),s&&g.push(n.registerHandler($.PRESENTER_STATE,c,s)),n.otherModuleReplayHandlerPendingMap.forEach((function(e,r){var o=a()(e,2),i=o[0],l=o[1];i===c&&(n.otherModuleReplayHandlerResetMap.set(r,n.registerHandler($.FOLLOW_REPLAY,i,l)),n.otherModuleReplayHandlerPendingMap.delete(r))})),d&&(g=g.concat(Object.keys(d).map((function(e){if(n.moduleRegisterTime.has(e))return n.registerHandler($.FOLLOW_REPLAY,e,d[e]);var r=Object(ee.S)();return n.otherModuleReplayHandlerPendingMap.set(r,[e,d[e]]),n.otherModuleReplayHandlerResetMap.set(r,(function(){return n.otherModuleReplayHandlerPendingMap.delete(r)})),function(){(n.otherModuleReplayHandlerResetMap.get(r)||function(){return null})(),n.otherModuleReplayHandlerResetMap.delete(r)}})))),u&&n.cycleCallback.push(u),n.moduleUnregisterFuncMap.set(p,(function(){n.moduleRegisterTime.set(c,(n.moduleRegisterTime.get(c)||0)-1),(n.moduleRegisterTime.get(c)||0)<=0&&(n.moduleRegisterTime.delete(c),n.moduleStateMap.delete(c),Object($.unregisterVCModule)(c),n.eventEmitter.emit("".concat($.FOLLOW_EVENT,":").concat($.FOLLOW_UNREGISTER),{moduleName:c})),g.forEach((function(e){return e()})),u&&n.popCycleCallback(u)}))}return function(){var e;fe("%c unregister ".concat(c),"color: #FFCC00"),null===(e=n.moduleUnregisterFuncMap.get(p))||void 0===e||e(),n.moduleUnregisterFuncMap.delete(p),i&&n.vcBlockHelper.notifyBlockUnmout({recordId:i,moduleName:c})}},this.sendState=function(e,r,o){var c=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n.moduleStateMap.set(e,de(de({},n.moduleStateMap.get(e)),{},i()({},r,o))),n.sendStateChange({moduleName:e,action:r,onlyCurrentAction:c})},this.getState=function(e,r){var o=n.moduleStateMap.get(e);return(null===o||void 0===o?void 0:o[r])||null},this.sendPosition=function(e,n){Object(f.sendPFLEvent)(e,n)},this.addListenCycleChange=function(e){return n.cycleCallback.push(e),function(){return n.popCycleCallback(e)}},this.destroy=function(){var e;fe("%c destroy start","color: #33CC66"),n.clearWaitBlockStructReadyTimer(),n.moduleRegisterTime.forEach((function(e,n){return Object($.unregisterVCModule)(n)})),n.destroyCallbackList.forEach((function(e){try{e()}catch(n){console.error("[vcController]: destroy error:",n.toString())}})),n.moduleStateMap.clear(),n.moduleRegisterTime.clear(),n.moduleRegisterPendingMap.clear(),n.moduleUnregisterFuncMap.clear(),n.otherModuleReplayHandlerResetMap.clear(),n.otherModuleReplayHandlerPendingMap.clear(),null===(e=n.versionHandler)||void 0===e||e.destroy(),n.vcBlockHelper.destroy(),n.versionList=Object(h.cloneDeep)(pe),n.versionHandler=void 0,n._blockManager=void 0,n.cycleCallback.length=0,n.destroyCallbackList.length=0,fe("%c destroy end","color: #33CC66")},fe("%c init","color: #33CC66"),window.vcController=this,he.forEach((function(e){var o=function(){fe("%c \u751f\u547d\u5468\u671f: ".concat(e),"color: #3300FF"),n._currentCycle=e,n.cycleCallback.forEach((function(n){return n(e)}))};r.on(e,o),n.destroyCallbackList.push((function(){r.off(e,o)}))})),this.setInitCycle()}return Q()(e,[{key:"setInitCycle",value:function(){if(!this._currentCycle){var e=Object(h.get)(window,"vcSdk.status")||Object(h.get)(window,"__vcSdk.vcFollowInstance.status");if(e){var n={Record:$.START_RECORD,Follow:$.START_FOLLOW};this._currentCycle=Object(h.get)(n,e)}}}},{key:"registerModule",value:function(e){var n=this,r=e.moduleName,o=e.defaultState,i=e.muteOptions,c=e.retryOptions,a=e.checkSame,l=e.retryOnVersionMatched;!this.moduleStateMap.has(r)&&this.moduleStateMap.set(r,Object(h.cloneDeep)(o)),Object($.registerVCModule)({moduleName:r,getCurrentModuleState:function(){var e=n.moduleStateMap.get(r);return fe("%c get module state ".concat(r,": ").concat(JSON.stringify(e)),"color: #9900CC"),e}}),this.eventEmitter.emit("".concat($.FOLLOW_EVENT,":").concat($.FOLLOW_REGISTER),{moduleName:r,muteOptions:i,retryOptions:c,checkSame:a,retryOnVersionMatched:l}),setTimeout((function(){n.sendStateChange({moduleName:r})}),50)}},{key:"popDestroyCallback",value:function(e){var n=this.destroyCallbackList.indexOf(e);n>-1&&this.destroyCallbackList.splice(n,1)}},{key:"popCycleCallback",value:function(e){var n=this.cycleCallback.indexOf(e);n>-1&&this.cycleCallback.splice(n,1)}},{key:"registerHandler",value:function(e,n,r){var o=this,i=function(){fe("%c handler ".concat(e," ").concat(n," params: ").concat(JSON.stringify(arguments.length<=0?void 0:arguments[0])),"color: #CC0066"),r.apply(void 0,arguments)};this.eventEmitter.on("".concat(e,":").concat(n),i);var c=function(){o.eventEmitter.off("".concat(e,":").concat(n),i)};return this.destroyCallbackList.push(c),function(){c(),o.popDestroyCallback(c)}}},{key:"handleBlockStructReady",value:function(){var e,n=this;if(null===(e=this.blockManager)||void 0===e?void 0:e.editorAPI.modelService.isInitialDataReady())this.setIsBlockStructReady(!0);else{var r,o=function e(){var r,o=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.clearWaitBlockStructReadyTimer(),o&&n.setIsBlockStructReady(!0),null===(r=n.blockManager)||void 0===r||r.removeListener(te.Q,e)};this.waitBlockStructReadyTimer=setTimeout((function(){console.error("[vcController]: block struct ready timeout"),n.waitBlockStructReadyTimer=void 0,o()}),5e3),null===(r=this.blockManager)||void 0===r||r.addListener(te.Q,o),this.destroyCallbackList.push((function(){return o(!1)}))}}},{key:"setIsBlockStructReady",value:function(e){var n=this;!this.isBlockStructReady&&e&&(this.isBlockStructReady=e,fe("%c block struct ready","color: #FF6600"),this.moduleRegisterPendingMap.forEach((function(e,r){n.register(e),n.moduleRegisterPendingMap.delete(r)})))}},{key:"clearWaitBlockStructReadyTimer",value:function(){this.waitBlockStructReadyTimer&&clearTimeout(this.waitBlockStructReadyTimer),this.waitBlockStructReadyTimer=void 0}},{key:"setVersion",value:function(e,n,r){var o=this.versionList.findIndex((function(n){return n.obj===e}));o>-1&&(n>this.versionList[o].version||r)&&(this.versionList[o].version=n,this.sendVersion())}},{key:"getVersion",value:function(e){var n=this.versionList.find((function(n){return n.obj===e}));return n?n.version:void 0}},{key:"reportReplay",value:function(e,n,r,o){switch(console.debug("[vcController - report]: ",e,n,r,o),e){case oe.s.SUCCESS:Object(ie.w)(n,r);break;case oe.s.FAIL:Object(ie.q)(n,r,o);break;case oe.s.IGNORE:Object(ie.E)(n,r,o);break;default:console.debug("[vcController - report]: unknown report type: ".concat(e))}}},{key:"blockManager",get:function(){return this._blockManager}},{key:"isRecord",get:function(){return this._currentCycle===$.START_RECORD}},{key:"isFollow",get:function(){return this._currentCycle===$.START_FOLLOW}}]),e}(),ge=r("dx_LMYO"),be=r("dx_R1R5"),ye=r("dx_rT1F"),me=r("dx_fLRZ"),_e=r("dx_GXpI"),ke=r("dx_Wwog"),Oe=r("dx_gMOR"),xe={catalogAreaWidth:0,forceAbstract:!1,contentMarginLeft:0,contentCssMarginLeft:0,catalogAreaHeight:0,isBoundaryIntersection:!1,editorStyle:{},hotZoneWidth:0,contentOffset:0,containerWidth:0,animationEnabled:!1},Ee=r("dx_NOtv"),Se=r.n(Ee),Ce=r("dx_Bait"),Ie=r("dx_JZDi"),Be=Se()("layout:useBoundaryIntersection");var Te=r("dx_tfgj"),we=Se()("layout:useCoverIntersection");var Re=r("dx_a3US"),Me=r("dx_B4B2"),je=r("dx_mvce"),De=Object(W.e)("layout:use-element-size");var Ae=Object(h.throttle)((function(e){return(null===e||void 0===e?void 0:e.scrollHeight)||0}),100);function Pe(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Le(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Pe(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pe(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var Ne=Object(W.e)("layout:useDocLayout");var Fe=Object(ke.S)((function(e){return Object(U.N)("docx_layout_calculate_dev",e),{normalWidthLayout:Object(Oe.p)(Le(Le({},e),{},{baseIsAbstract:!1})),absWidthLayout:Object(Oe.p)(Le(Le({},e),{},{baseIsAbstract:!0}))}}),h.isEqual),Ue=Object(ke.S)((function(e){var n=e.isFeed,r=e.contentCssMarginLeft,o=e.animationEnabled,i=e.customBoxWidth,c=e.customPadding,l=e.background;if(n)return{};var s={transition:o?"margin-left ".concat(S.W):"",marginLeft:r};if(c){var u=a()(c,4),d=u[0],f=u[1],p=u[2],v=u[3];!Object(h.isUndefined)(v)&&(s.paddingLeft="".concat(v,"px")),!Object(h.isUndefined)(f)&&(s.paddingRight="".concat(f,"px")),!Object(h.isUndefined)(d)&&(s.paddingTop="".concat(d,"px")),!Object(h.isUndefined)(p)&&(s.paddingBottom="".concat(p,"px"))}return i&&(s.maxWidth="".concat(i,"px")),l&&(s.backgroundColor="var(--bg-body)"),s}),h.isEqual);var He=Object(ke.S)((function(e){var n=e.widthMode,r=e.baseIsAbstract,o=e.commentPanelShown,i=e.isFeed,c=e.isInWiki,a=e.isViewEditors,l=e.prevContainerWidth,s=e.prevWidthMode,u=e.isBoundaryIntersection,d=e.coverIntersectionHeight,f=e.containerWidth,h=e.containerHeight,p=e.containerScrollHeight,v=e.customBoxWidth,g=e.customPadding,b=e.background,y=Fe({containerWidth:f,widthMode:n,isInWiki:c,commentPanelShown:o,isViewEditors:a,customBoxWidth:v,customPadding:g}),m=y.normalWidthLayout,_=y.absWidthLayout,k=r?_:m,O=k.catalogAreaWidth,x=m.contentCssMarginLeft-k.contentCssMarginLeft,E=Object(Oe.z)({containerHeight:h,coverIntersectionHeight:d}),S=f!==l||n!==s,C=function(e,n,r,o){return!(o||r||e>1500&&0!==n)}(p,m.contentCssMarginLeft-_.contentCssMarginLeft,u,S),I=Ue({isFeed:i,contentCssMarginLeft:k.contentCssMarginLeft,animationEnabled:C,customBoxWidth:v,customPadding:g,background:b});return Ne("return(%s,abs=%s,page=%d/%d/%d,cover=%d,boundary=%s,widthChanged=%s), forceAbs=%s, catalog=%d/%d, marginLeft=%d/%d, contentOffset=%d, hotZone=%d, animation=%s",n,r,f,h,p,d,u,S,m.forceAbstract,m.catalogAreaWidth,E.catalogAreaHeight,k.contentMarginLeft,I.marginLeft,x,O,C),Le(Le(Le({},m),E),{},{isBoundaryIntersection:u,editorStyle:I,hotZoneWidth:O,contentOffset:x,containerWidth:f,animationEnabled:C})}),h.isEqual),Ve=function(e){var n=e.pageContainerRef,r=e.widthMode,o=e.baseIsAbstract,i=e.commentPanelShown,c=e.isFeed,l=e.isInWiki,s=e.isViewEditors,u=e.prevContainerWidth,d=e.prevWidthMode,f=e.customBoxWidth,h=e.customPadding,v=e.background,g=function(){var e=Object(p.useState)(!1),n=a()(e,2),r=n[0],o=n[1],i=Object(p.useRef)(null),c=Object(p.useCallback)((function(){null!==i.current&&(o(i.current),i.current=null)}),[]),l=Object(Ie.q)({onResizeEnd:c}),s=Object(p.useCallback)((function(e){e!==i.current&&(Be("handleBoundaryInteraction %s",e),i.current=e,Object(Ie.Q)(l.current)||o(e))}),[l]);return Object(p.useEffect)((function(){return q.S.on(Ce.v.CATALOGUE_BOUNDARY_INTERSECTION,s),function(){q.S.off(Ce.v.CATALOGUE_BOUNDARY_INTERSECTION,s)}}),[s]),r}(),b=function(e){var n=Object(p.useState)(0),r=a()(n,2),o=r[0],i=r[1],c=Object(p.useState)(0),l=a()(c,2),s=l[0],u=l[1],d=Object(Re.r)((function(){var n,r={clientWidth:(null===(n=e.current)||void 0===n?void 0:n.clientWidth)||0,clientHeight:(null===n||void 0===n?void 0:n.clientHeight)||0},o=r.clientWidth,c=r.clientHeight;De("handleElementResize %d/%d",o,c),i(o),u(c),Ae.cancel()})),f=Object(Me.S)(d,10);return Object(p.useEffect)((function(){if(e.current){if(f(),C.Z.isMobile)return window.addEventListener("resize",f),function(){return window.removeEventListener("resize",f)};var n=Object(je.J)(f);return n.observe(e.current,{box:"border-box"}),function(){return n.disconnect()}}}),[f,e]),{clientWidth:o,clientHeight:s,scrollHeight:Ae(e.current)}}(n),y=function(){var e=Object(p.useState)(0),n=a()(e,2),r=n[0],o=n[1],i=Object(p.useCallback)((function(e){var n=e.height,r=e.scene;we("handleCoverIntersectionChange %d, scene=%s",n,r),o(n)}),[]);return Object(p.useEffect)((function(){return q.S.on(Te.F.COVER_INTERSECTION_CHANGE,i),function(){q.S.off(Te.F.COVER_INTERSECTION_CHANGE,i)}}),[i]),r}();if(!b.clientWidth)return xe;var m={widthMode:r,baseIsAbstract:o,commentPanelShown:i,isFeed:c,isInWiki:l,isViewEditors:s,prevContainerWidth:u,prevWidthMode:d,isBoundaryIntersection:g,coverIntersectionHeight:y,containerWidth:b.clientWidth,containerHeight:b.clientHeight,containerScrollHeight:b.scrollHeight,customBoxWidth:f,customPadding:h,background:v};return He(m)},We=r("dx_k64k"),ze=r("dx_BBJ7"),Ge=r("dx_OUFY"),Ke=function(e){Object(p.useEffect)((function(){q.S.emit(Ge.o.ON_CATALOGUE_RECT_CHANGE)}),[e])},qe=r("dx_S1iY"),Xe=r("dx_o0o1"),Ye=r.n(Xe),Je=r("dx_yXPU"),Ze=r.n(Je),Qe=r("dx_BaZy"),$e=r.n(Qe),et=$e()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_qnsi"))},loading:function(){return null}}),tt=$e()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_W3Wi"))},loading:function(){return null},render:function(e,n){var r=e.History;return v.a.createElement(r,n)}}),nt=$e()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_v7vA"))},loading:function(){return null}}),rt=$e()({loader:function(){var e=Ze()(Ye.a.mark((function e(){return Ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!==typeof f.loadSubscription){e.next=3;break}return e.next=3,Object(f.loadSubscription)();case 3:return e.abrupt("return",r.e("dx_MJr").then(r.bind(null,"dx_G7Ej")));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),loading:function(){return null}}),ot=$e()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_vo5z"))},loading:function(){return null}}),it=r("dx_X279"),ct=r("dx_SreQ");l.afterImport=Date.now();r("dx_PVfG");var at=f.renderHelpers.MultiStageRenderContainer,lt=f.renderHelpers.DocxStage,st=f.renderHelpers.Business,ut=C.S.isBytedanceApp&&C.S.isMobile,dt=Object(W.e)("docs:");console.time("doc_init"),Object(U.N)("client_garr_require_dev",{stage:"load_docx_entry_chunk_success",info:JSON.stringify({scm:window.scm,scmdocx:window.scmdocx,scmDocx:window.scmDocx,stack:new Error("get docx entry stack").stack||""})});var ft=f.selectors.share,ht=ft.selectCanEditInvolvingEditMode,pt=ft.selectCurrentSuiteOtherPermissions;w.S.updateStage(T.ET.DOCX_JS_LOADED,l.start),w.S.updateLoadMainStageDurationList(f.FILE_TYPE.DOCX,f.LOAD_MAIN_STAGE_DURATION_LIST_KEY.FILE_JS_LOADED_SUCCESS,l.start),w.S.updateLoadMainStageDurationList(f.FILE_TYPE.DOCX,f.LOAD_MAIN_STAGE_DURATION_LIST_KEY.FILE_ENTRY_LOAD_IMPORT_TIME,l.afterImport),w.S.setExtraData({docx_entry_load_time_import_time:l.afterImport-l.start});var vt=function(e){return!(!e||"url"===w.S.from||C.S.isMobile||!Object(ct.C)())&&!G.u.getInstance().clientvarFetchManager.getClientvar(e)},gt=function(e){var n=e.onClientVarsReady,r=e.token,o=e.store,i=e.tokenFromWiki,c=e.getClientVarsRequestExtraParams,l=e.reportWikiFirstContentLoaded,s=e.reportWikiAllContentLoaded,u=e.onWikiSidebarResize,y=e.getClientVars,m=f.selectors.openDoc.getFeatureConfigSelector,k=!!i,R=Object(p.useRef)(),P=Object(p.useRef)(null),L=Object(p.useRef)(null),N=Object(p.useRef)(),U=Object(p.useRef)(),W=Object(p.useRef)(null),G=Object(p.useRef)(null),K=Object(p.useState)(),Y=a()(K,2),J=Y[0],Z=Y[1],Q=Object(p.useState)(_e.S),$=a()(Q,2),ee=$[0],te=$[1],ne=!!Object(g.useSelector)(ht),re=Object(g.useSelector)(M.R),oe=Object(g.useSelector)(pt).exportable,ie=Object(g.useSelector)(We.F),ce=Object(g.useSelector)(f.selectors.share.ifhaveCommentPermission),ae=Object(g.useSelector)(D.I),le=Object(g.useSelector)(f.selectIsTemplateVisible),se=Object(g.useSelector)(j.X),ue=Object(g.useSelector)(f.selectors.translate.selectTranslateConfig),de=Object(g.useSelector)(f.selectors.translate.selectTranslateStatus),fe=Object(g.useSelector)(j.M),he=Object(p.useMemo)((function(){var e=Object(E.m)(),n=e.subscription,r=e.changes;return!!n&&!!r}),[]),pe=Object(g.useSelector)(_.K),ke=Object(g.useSelector)(A.B),Oe=Object(g.useSelector)(m(f.FEATURE.LIKE)),xe=Object(g.useSelector)(m(f.FEATURE.DIRECTORY)),Ee=Object(g.useSelector)(m(f.FEATURE.COMMENT)),Se=Object(g.useSelector)(m(f.FEATURE.CONTENT)),Ce=Object(g.useSelector)(m(f.FEATURE.HEADER)),Ie=Object(p.useRef)(0),Be=Object(p.useRef)(pe),Te=!(xe&&!xe.enable),we=Se&&Se.unscrollable;Object(qe.D)(),F.S.start(),C.S.isInVC&&!N.current&&(N.current=new ve),Object(p.useEffect)((function(){return console.info("[Docs] isInVC ".concat(C.S.isInVC," ").concat(location.search)),function(){var e;null===(e=N.current)||void 0===e||e.destroy()}}),[]),Object(p.useEffect)((function(){q.S.emit(q.p.COMMON.SWITCH_WIDTH_MODE,pe)}),[pe]);var Re={pageContainerRef:P,widthMode:pe,baseIsAbstract:ee||!Te,commentPanelShown:ae,isInWiki:k,isFeed:C.S.isFeed,isViewEditors:ke,prevContainerWidth:Ie.current,prevWidthMode:Be.current};Se&&(Re.customBoxWidth=Se.maxWidth,Re.customPadding=Se.padding,Re.background=Se.background);var Me=Ve(Re),je=Me.containerWidth,De=Me.contentOffset,Ae=Me.editorStyle;Object(p.useEffect)((function(){return dt("clearInitialCatalogItems"),Object(_e.j)(),Object(_e.E)(),function(){f.resourceSchedulerHelpers.scheduler.cleanup()}}),[]),Object(p.useEffect)((function(){Ie.current=je,Be.current=pe}),[je,pe]),Object(p.useEffect)((function(){q.S.emit(X.g.CONTENT_OFFSET_CHANGED,De)}),[De]),Ke(Ae.marginLeft),Object(p.useEffect)((function(){C.S.isMobile&&!he&&Object(ge.I)()}),[he]),Object(p.useEffect)((function(){if(n(),!C.S.isMobile){var e=Object(it.N)();return e.init(P),function(){e.dispose()}}}),[n]),Ke(Ae.marginLeft);var Pe=Object(p.useCallback)((function(e){Z(e)}),[]),Le=Object(p.useCallback)((function(n){var r=n.getPageMeta();Z(r),U.current=n.blockManager,o.dispatch(f.renderHelpers.updateBusinessStage(f.renderHelpers.Business.Docx,f.renderHelpers.DocxStage.EditorMount)),C.S.isFeed&&(o.dispatch(f.renderHelpers.updateBusinessStage(f.renderHelpers.Business.Docx,f.renderHelpers.DocxStage.SectionNavRendered)),w.S.updateStage(T.ET.FETCH_DOCX_CATALOGUE_SUCCESS),w.S.updateStage(T.ET.RENDER_DOCX_CATALOGUE_SUCCESS)),f.resourceSchedulerHelpers.scheduler.addTask({name:"DocxStage.BlockRendered",action:function(){return new Promise((function(e){o.dispatch(f.renderHelpers.updateBusinessStage(f.renderHelpers.Business.Docx,f.renderHelpers.DocxStage.BlockRendered)),e(!0)}))}}),e.onEditorMounted&&e.onEditorMounted(n)}),[o]),Ne=Object(p.useCallback)((function(e){var n=e.code,r=e.msg,o=e.type,i=e.requestId,c=e.ttLogId,a=e.eagleId,l=e.detail,s=e.url,u=void 0===s?"":s,d=e.queryParams,f=void 0===d?{}:d,h=Object(I.H)(),p=h.scm,v=h.scmDocx,g=new Error("[Editor error]: code: ".concat(n,"; ").concat(o,"; ").concat(r,";"));e.stack&&(g.stack=e.stack);var b=Object(V.n)(g,l);if(console.error("requestId: ".concat(i,"; ttLogId: ").concat(c,"; eagleId=").concat(a,"; detail: ").concat(l)),Object(H.n)(b),Object(I.S)(n)!==I.x.NotOops){var y={error:b,msg:r,type:o,code:n,scm:p,scmDocx:v,url:u,queryParams:f,requestId:i,ttLogId:c,editable:ne,detail:l};W.current=Object(be.S)(y),q.S.emit(q.p.COMMON.SHOW_OOPS,y),w.S.renderFail(T.g.DEV_OOPS)}}),[ne]);Object(p.useEffect)((function(){return function(){W.current&&W.current()}}),[]);var Fe=window.location.hash.slice(1),Ue=Object(p.useCallback)((function(e){dt("handleCatalogBaseShowModeChange: abs=%s",e),te(e)}),[]),He=Object(p.useCallback)((function(e){e.currentTarget.scrollLeft>0&&(e.currentTarget.scrollLeft=0)}),[]),ze=Object(p.useCallback)((function(e){q.S.emit(q.p.COMMON.HOVER_CATALOGUE,e)}),[]),Ge={widthMode:me.z.STANDARD_WIDTH,justifyPosition:me.D.CENTER,onIPadDisplayModeChange:function(){}},Xe=Ge.justifyPosition,Ye=Ge.onIPadDisplayModeChange,Je=Ge.widthMode,Ze=Object(p.useCallback)((function(e){!1===ie&&(o.dispatch(f.actions.permission.copyTextWithoutPermission()),e.preventDefault()),Object(B.fB)(B.f.COPY)}),[ie]);Object(p.useEffect)((function(){if(C.S.isOpendoc&&L){var e=new b.S(Object(h.throttle)((function(){var e=(null===Ce||void 0===Ce?void 0:Ce.enable)?40:0,n=L.current.offsetHeight+e;Object(f.sendOpendocEvent)(f.OPENDOC_EVENT.DOCUMENT_HEIGHT,n)}),100,{trailing:!0}));return e.observe(L.current),function(){return e.disconnect()}}}),[null===Ce||void 0===Ce?void 0:Ce.enable]),dt("render(%s), catalogWidth/Height/marginLeft=%d/%d/%d, abs=%s, comment=%s",pe,Me.catalogAreaWidth,Me.catalogAreaHeight,Ae.marginLeft,ee,ae);var Qe=Object(_e.S)()?[]:Object(_e.r)(),$e=!C.S.isFeed&&v.a.createElement(O,{ref:G,isForceShowAbstract:Me.forceAbstract,isBoundaryIntersection:Me.isBoundaryIntersection,animationEnabled:Me.animationEnabled,maxWidth:Me.catalogAreaWidth,maxHeight:Me.catalogAreaHeight,pageContainer:P.current,pageToken:r,isInWiki:!!k,hotZoneWidth:Me.hotZoneWidth,initialCatalogItems:Qe,onCatalogBaseShowModeChange:Ue,onIPadDisplayModeChange:Ye,onCatalogueHoverChange:ze,onCopy:Ze,blockManager:U.current,defaultPin:xe&&xe.pin,visible:Te});return v.a.createElement(v.a.Fragment,null,v.a.createElement(at,{renderOnTimeout:!0,business:st.Docx,renderWhen:lt.Done},v.a.createElement(z.P,null),v.a.createElement(ot,null)),v.a.createElement("div",{className:d()(S.b3.ROOT,{"has-comment":!C.S.isLarkFeed&&ae,"docx-in-wiki":!!k&&!C.S.isMobile,"opendoc-unscrollable":we}),ref:P,onScroll:He},v.a.createElement("div",{className:"safari-bug-fix",ref:L},v.a.createElement("div",{id:"docx-popup-container"}),v.a.createElement("div",{id:"docx-draggable-rectangle-container"}),v.a.createElement(x.S,null),$e,he&&v.a.createElement(rt,null),!(he&&ut)&&v.a.createElement(ye.K,{justifyPosition:Xe,iPadWidthMode:Je,PCWidthMode:pe,style:Ae,keyBindingHost:document.body,minHeight:200,token:r,tokenFromWiki:i,locate:Fe,scroller:S.b3.ROOT,onEditorMount:Le,awaitFirstSliceClientVars:vt(i)&&y?y:void 0,onPageMetaChange:Pe,onCommentReady:function(e){var n;null===(n=G.current)||void 0===n||n.onCommentReady(e)},onEditorError:Ne,translateConfig:{config:ue,status:de},editable:ne,editing:re,copyable:ie,commentable:ce,exportable:oe,pageMeta:J,vcController:N.current,isTemplateVisible:le,isFirstLineEmpty:se,ref:R,hasCover:fe,isInWiki:!!k&&!C.S.isMobile,getClientVarsRequestExtraParams:c,reportWikiFirstContentLoaded:l,reportWikiAllContentLoaded:s,onWikiSidebarResize:u,openDocxConfig:{globalLikeConfig:Oe,commentConfig:Ee,contentConfig:Se,headerConfig:Ce}}),v.a.createElement(at,{renderOnTimeout:!0,business:st.Docx,renderWhen:lt.Done},v.a.createElement(et,{copyable:ie,vcController:N.current}),v.a.createElement(tt,{minHeight:200,token:r,locate:Fe}),v.a.createElement(nt,null)))))};n.default=function(e){var n=e||{},r=n.store,o=n.storeRemoveHandler,c=n.tokenFromWiki,l=n.onWikiSidebarResize,u=n.getClientVarsRequestExtraParams,d=n.reportWikiFirstContentLoaded,f=n.reportWikiAllContentLoaded,h=n.getClientVars,b=e.match&&e.match.params.token,_=Object(p.useState)(c||b),k=a()(_,2),O=k[0],x=k[1],E=Object(p.useRef)(!1),S=Object(p.useRef)(O),I=!E.current;Object(p.useEffect)((function(){return y.S.initUserPermission(),ut&&m.S.getInstance().init(),function(){o&&o(),ut&&m.S.getInstance().destory()}}),[]);var B=Object(g.useSelector)(j.s);if(E.current)O!==S.current&&(S.current=O,C.S.isMobile||G.u.getInstance().start(S.current,"docs_tsx",new K.o,{restartCodes:[s.e.NO_PERMISSION],awaitFirstSliceClientVars:vt(c)&&h?h:null}));else{w.S.setExtraData(i()({},"docxAppConstructor",Date.now()-w.S.getStartTime())),C.S.isMobile||G.u.getInstance().start(S.current,"docs_tsx",new K.o,{restartCodes:[s.e.NO_PERMISSION],awaitFirstSliceClientVars:vt(c)&&h?h:null}),window.DATA&&window.DATA.clientVars&&Object(L.j)(window.DATA.clientVars,O)&&Object(L.i)("".concat(O,"-").concat(P.q.REFERENCE_ALL),window.DATA.clientVars),E.current=!0}Object(p.useEffect)((function(){null!=O&&B!==O&&r.dispatch(Object(R.s)(O))}),[O]),Object(p.useEffect)((function(){if(!I&&(!S.current||Object(N.B)(S.current)!==b)){x(null);var e=!1;return Promise.resolve().then((function(){e||x(c||b)})),function(){e=!0}}}),[b,c]);var T=Object(p.useCallback)((function(e){return null==O?null:v.a.createElement(gt,Object.assign({},e,{token:O}))}),[O]);return v.a.createElement(Ie.Y,{tokenFromWiki:c,onWikiSidebarResize:l,getClientVarsRequestExtraParams:u,reportWikiFirstContentLoaded:d,reportWikiAllContentLoaded:f},v.a.createElement(ze.a,null,v.a.createElement(T,e)))}},dx_k2kP:function(e,n,r){"use strict";var o=r("dx_v8v5"),i=r("dx_IRIy");r.o(i,"generateTagOptionsByType")&&r.d(n,"generateTagOptionsByType",(function(){return i.generateTagOptionsByType}));var c=r("dx_EBI6");r.d(n,"generateTagOptionsByType",(function(){return c.Q})),n.default=o.F},dx_k2kp:function(e,n,r){"use strict";r.d(n,"R",(function(){return c}));var o=r("dx_E7EG"),i=r("dx_peh1"),c=Object(i.createSelector)((function(e){return Object(o.S)(e,"docx.docsMode")}),(function(e){return e.docsMode}))},dx_k5Bg:function(e,n,r){"use strict";function o(e){var n=e.root;if(n){var r,o=null,i=function(e){o||(o=function(e){for(;e;){if(e.scrollHeight>e.clientHeight)return e;e=e.parentNode}return null}(e.target)),o&&(r=o.scrollTop)},c=function(e){o&&"undefined"!==typeof r&&o.scrollTo({top:r})};return n.addEventListener("touchstart",i,!0),n.addEventListener("fullscreenchange",c,!0),function(){n.removeEventListener("touchstart",i,!0),n.removeEventListener("fullscreenchange",c,!0)}}}r.d(n,"h",(function(){return o}))},dx_k5k3:function(e,n,r){"use strict";r.d(n,"A",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("composing-service")},dx_k64k:function(e,n,r){"use strict";r.d(n,"S",(function(){return s})),r.d(n,"m",(function(){return d})),r.d(n,"F",(function(){return f}));var o=r("dx_UtDZ"),i=r("dx_h6a8"),c=r("dx_peh1"),a=r("dx_FHaN"),l=r("dx_o9oe");function s(e,n,r){var o,c=null===(o=e.docx)||void 0===o?void 0:o.permissions,s=null===c||void 0===c?void 0:c.getIn([n,r,"userPermissions","readable"]);if(!Object(l.F)())return Object(i.isUndefined)(s)||s?a.J.READABLE:a.J.UNREADABLE_ALLOW_APPLY;var u=null===c||void 0===c?void 0:c.getIn([n,r,"embedPermission","code"]);if(u===a.n.ALLOW&&s)return a.J.READABLE;switch(u){case a.n.ALLOW:return a.J.UNREADABLE_ALLOW_APPLY;case a.n.NO_PERMISSION:return a.J.UNREADABLE_NOT_ALLOW_APPLY;case a.n.NETWORK_ERROR:return a.J.NETWORK_ERROR;default:return a.J.LOADING}}var u=function(e){return e.entities.permissions},d=function(e){return Object(c.createSelector)(u,o.selectCurrentSuiteToken,(function(n,r){return n.getIn([r,e])}))},f=Object(c.createSelector)(o.selectors.share.selectCurrentSuiteOtherPermissions,(function(e){var n=e.copyable,r=Object(o.getPermTypeAuthorityResult)(o.PermissionType.FILE_COPY);return!(!n||!r)}))},dx_k7kY:function(e,n,r){"use strict";r.d(n,"I",(function(){return s})),r.d(n,"g",(function(){return u})),r.d(n,"K",(function(){return d})),r.d(n,"t",(function(){return f})),r.d(n,"n",(function(){return h})),r.d(n,"V",(function(){return p})),r.d(n,"C",(function(){return v})),r.d(n,"h",(function(){return g})),r.d(n,"W",(function(){return b})),r.d(n,"f",(function(){return y})),r.d(n,"z",(function(){return m}));var o,i=r("dx_lSNA"),c=r.n(i),a=r("dx_B28d"),l=r("dx_Mzjv"),s="menu-trigger",u="table-menu-trigger",d=56,f=26,h=26,p=40,v=[a.B.QUOTE,a.B.CODE],g=".overlay-container.block-menu-overlay",b="ccm_docx_toolbar_status_monitor_report",y=[l.R.LeftCenter,l.R.BottomLeft,l.R.TopLeft,l.R.RightCenter],m=(o={},c()(o,l.R.LeftCenter,[4,0]),c()(o,l.R.RightCenter,[4,0]),c()(o,l.R.BottomLeft,[0,4]),c()(o,l.R.TopLeft,[0,4]),o)},dx_k7kc:function(e,n,r){"use strict";(function(t){var e=r("dx_lSNA"),o=r.n(e),i=r("dx_J4zp"),c=r.n(i),a=r("dx_PcQO"),l=r("dx_h6a8"),s=r("dx_cDcd"),u=r.n(s),d=r("dx_amgp"),f=r("dx_rXFL"),h=r("dx_uA63");function p(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function v(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?p(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var g={};function b(e){return e===d.G.UNSET?d.G.ON_TRACK:e}function y(e){return!e.percent.error&&!e.start.error&&!e.current.error&&!e.target.error}n.S=function(e){var n=e.updateType,r=e.percent,i=e.current,p=e.start,m=e.target,_=e.children,k=e.mode,O=e.progressStatus,x=e.onSave,E=e.onStatusChange,S=e.onPopoverVisibleChange,C=void 0===S?l.noop:S,I=e.popoverPlacement,B=void 0===I?"bottom":I,T=e.getPopupContainer,w=Object(s.useRef)(null),R=Object(s.useRef)({focusType:null,backendStale:{percent:r,current:i,start:p,target:m},focusStale:{percent:r,current:i,start:p,target:m}}),M=function(e){var n=Object(s.useRef)(e),r=Object(s.useReducer)((function(e,r){return n.current=v(v({},e),r.payload)}),e),o=c()(r,2);return[o[0],o[1],n]}({percent:{error:"",value:""},current:{error:"",value:""},start:{error:"",value:""},target:{error:"",value:""}}),j=c()(M,2),D=j[0],A=j[1],P=function(e){return function(){var n=R.current.focusStale;y(D)||(A({type:g.rollback,payload:o()({},e,{value:String(n[e]),error:""})}),Object.assign(R.current,{focusType:null}),x(!1,v({mode:k},n)))}},L=function(e){return function(n){switch(k){case"simple":!function(e,n){if("percent"===e){var r=n.target.value,o=Object(h.l)(parseFloat(r),0),i=o>=0&&o<=9999,c="";""===r?c=t("CreationDoc_Docs_OKR_Status_Enter"):i||(c=t("CreationDoc_Docs_OKR_Status_EnterRule1")),A({type:g.onChangeSimpleFactory,payload:{percent:{error:c,value:r}}}),x(!1,{mode:k,percent:o||0,progressStatus:b(O)})}}(e,n);break;case"advanced":!function(e,n){var r,i=n.target.value,c=R.current,a=c.focusType,s=c.focusStale,u=Object(h.l)(parseFloat(i),2),d=u>=0&&u<=99999999,f=Object(h.E)(v(v({},s),{},o()({mode:k},a,u))),p=Object(l.lte)(f,9999),y="";switch(e){case"current":""===i?y=t("CreationDoc_Docs_OKR_Status_Enter"):d?p||(y=t("CreationDoc_Docs_OKR_Status_EnterRule3")):y=t("CreationDoc_Docs_OKR_Status_EnterRule2");break;case"start":""===i?y=t("CreationDoc_Docs_OKR_Status_Enter"):d?u===s.target?y=t("CreationDoc_Docs_OKR_Status_EnterRule4"):p||(y=t("CreationDoc_Docs_OKR_Status_EnterRule3")):y=t("CreationDoc_Docs_OKR_Status_EnterRule2");break;case"target":""===i?y=t("CreationDoc_Docs_OKR_Status_Enter"):d?u===s.start?y=t("CreationDoc_Docs_OKR_Status_EnterRule5"):p||(y=t("CreationDoc_Docs_OKR_Status_EnterRule3")):y=t("CreationDoc_Docs_OKR_Status_EnterRule2")}A({type:g.onChangeAdvancedFactory,payload:o()({},a,{error:y,value:i})}),x(!1,(r={mode:k},o()(r,a,u||0),o()(r,"progressStatus",b(O)),r))}(e,n)}}},N=function(){y(D)},F=function(e){return{error:D[e].error,value:D[e].value,onFocus:(n=e,function(){Object.assign(R.current,{focusType:n,focusStale:{percent:r,current:i,start:p,target:m}})}),onBlur:P(e),onChange:L(e),onPressEnter:N};var n};return u.a.createElement(a.Popover,{trigger:"click",placement:B,onVisibleChange:function(e){if(C(e),e)return Object.assign(R.current,{backendStale:{percent:r,current:i,start:p,target:m}}),void A({type:g.save_progress_rate,payload:{percent:{value:String(r),error:""},start:{value:String(p),error:""},current:{value:String(i),error:""},target:{value:String(m),error:""}}});var n=R.current.backendStale;y(D)?(x(!0),d.W.ADVANCED):x(!1,v({mode:k},n))},getPopupContainer:T,content:u.a.createElement(f.S,Object.assign({updateType:n},F("percent"),{current:F("current"),start:F("start"),target:F("target"),mode:k,progressStatus:O,onStatusChange:E,onModeChange:function(e){var n=R.current,c=n.focusType,a=n.focusStale,s=y(D);if(Object.assign(R.current,{focusType:null}),s){if("simple"===e){var u=Object(l.clamp)(Object(h.E)({mode:d.W.ADVANCED,percent:r,start:p,current:i,target:m}),0,9999);x(!1,{mode:e,percent:u}),A({type:g.handleModeChange,payload:{percent:{value:String(u),error:""}}})}if("advanced"===e){var f=Object(l.clamp)(Object(h.K)({percent:r,start:p,target:m}),0,99999999);x(!1,{mode:e,current:f}),A({type:g.handleModeChange,payload:{current:{value:String(f),error:""}}})}}if(!s&&c){if(A({type:g.handleModeChange,payload:o()({},c,{value:String(a[c]),error:""})}),e===d.W.SIMPLE){var b=Object(l.clamp)(Object(h.E)(v(v({},a),{},{mode:d.W.ADVANCED})),0,9999);x(!1,v(v({},a),{},{mode:e,percent:b})),A({type:g.handleModeChange,payload:{percent:{value:String(b),error:""}}})}if(e===d.W.ADVANCED){var _=Object(l.clamp)(Object(h.K)(a),0,99999999);x(!1,v(v({},a),{},{mode:e,current:_})),A({type:g.handleModeChange,payload:{current:{value:String(_),error:""}}})}}}}))},Object(h.F)(_,{ref:w}))}}).call(this,r("dx_E9Eu"))},dx_k7lD:function(e,n,r){},dx_k8Uk:function(e,n,r){},dx_k8kI:function(e,n,r){"use strict";var o;r.d(n,"o",(function(){return o})),r.d(n,"w2",(function(){return c})),r.d(n,"Jt",(function(){return a})),r.d(n,"w",(function(){return l})),r.d(n,"a",(function(){return s})),r.d(n,"rC",(function(){return u})),r.d(n,"r",(function(){return d})),r.d(n,"b",(function(){return f})),r.d(n,"Q",(function(){return h})),r.d(n,"J",(function(){return p})),r.d(n,"h",(function(){return v})),r.d(n,"v",(function(){return i})),function(e){e.INSERT_CHILD="insertChild",e.DELETE_CHILD="deleteChild",e.UPDATE="updateObject",e.UPDATE_PARENT="updateParentId"}(o||(o={}));var i,c="PAINT",a="SCROLL_END",l="layoutRecalculated",s="BUFFER_CHANGED",u="VIEWPORT_CHANGED",d="enterBuffer",f="leaveBuffer",h="enterViewport",p="leaveViewport",v="VIEWPORT_LOCKED";!function(e){e.ADD="ADD_ADDITIONAL_ACTIVE_NODE",e.REMOVE="REMOVE_ADDITIONAL_ACTIVE_NODE"}(i||(i={}))},dx_k9kc:function(e,n,r){"use strict";r.d(n,"F",(function(){return D})),r.d(n,"M",(function(){return A})),r.d(n,"G",(function(){return f.G})),r.d(n,"c",(function(){return f.c})),r.d(n,"Gw",(function(){return P})),r.d(n,"Fi",(function(){return H})),r.d(n,"g",(function(){return V}));var o,i=r("dx_h6a8"),c=r("dx_zEdG"),a=r("dx_Sj0J"),l=r("dx_D5D1"),s=r("dx_gwTP"),u=r("dx_rldU"),d=r("dx_CwnG"),f=r("dx_Dsxx"),h=r("dx_lSNA"),p=r.n(h),v=r("dx_MUMK"),g=r("dx_B28d");!function(e){e.EDIT_PENCIL_KIT="editPencilKit",e.STYLE="style",e.COMMENT="comment",e.COPY_LINK="copyLink",e.CUT="cut",e.COPY="copy",e.DELETE="delete",e.ALIGN="align",e.VIEW="view",e.CARD_VIEW="cardView",e.TEXT_VIEW="textView",e.PREVIEW_VIEW="previewView",e.SEPARATOR="separator",e.TEXT="plainText",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.H7="h7",e.H8="h8",e.H9="h9",e.HN="hn",e.BLOCK_QUOTE="blockquote",e.CODE_LIST="insertcodelist",e.CODE_BLOCK="insertcodeblock",e.INLINE_CODE="inlinecode",e.CHECKBOX="checkbox",e.CHECKLIST="checkList",e.ORDERED_LIST="insertorderedlist",e.UNORDERED_LIST="insertunorderedlist",e.BOLD="bold",e.ITALIC="italic",e.UNDERLINE="underline",e.STRIKE_THROUGH="strikethrough",e.HIGHLIGHT="highlight",e.BLOCK_BACKGROUND="blockbackground",e.INDENT_RIGHT="indentright",e.INDENT_LEFT="indentleft",e.ALIGN_LEFT="alignleft",e.ALIGN_CENTER="aligncenter",e.ALIGN_RIGHT="alignright",e.BLOCK_ALIGN_LEFT="blockalignleft",e.BLOCK_ALIGN_CENTER="blockaligncenter",e.BLOCK_ALIGN_RIGHT="blockalignright",e.DEBUG_BLOCK="DEBUG_BLOCK",e.REFRESH_BLOCK="REFRESH_BLOCK",e.INSERT_TASK="insertTask",e.FOCUS_TASK="focusTask",e.CHECK_DETAILS="checkDetails",e.CANCEL_REALTIME_REFERENCE="cancelRealtimeReference",e.CANCEL_SYNC_TASK="cancelSyncTask"}(o||(o={}));var b,y,m,_,k,O,x,E;o.EDIT_PENCIL_KIT;!function(e){e.INDENT_TRANSFORM="indentTransform",e.TEXT_TRANSFORM="textTransform",e.ALIGN_TRANSFORM="alignTransform",e.TEXT_BLOCK_TRANSFORM="textBlockTransform"}(b||(b={})),function(e){e.ICON_WITH_TEXT="iconWithText",e.ICON_ALONE="iconAlone",e.ICON_IN_GROUP="iconInGroup",e.ICON_WITH_RIGHT_ARROW="iconWithRightArrow",e.ICON_WITH_DOWN_ARROW="iconWithDownArrow",e.GROUP="group",e.SEPARATOR="separator",e.COLORED_ICON_WITH_TEXT="coloredIconWithText",e.SCROLLABLE_GROUP="scrollableGroup"}(y||(y={})),function(e){e.LEFT="LEFT",e.RIGHT="RIGHT",e.NONE="NONE",e.BOTH="BOTH"}(m||(m={})),function(e){e.BLOCK_MENU_PANEL="blockMenuPanel",e.TOOLBAR_MENU_PANEL="toolBarMenuPanel",e.HIGHLIGHT_PANEL="highlightPanel",e.REACTION_PANEL="reactionPanel",e.VISION_MENU_PANEL="visionMenuPanel",e.ALIGN_MENU_PANEL="alignMenuPanel"}(_||(_={})),function(e){e.reloadBlockWithOnlineResource="reloadWithOnlineResource",e.reloadBlockWithDebugResource="reloadWithDebugResource"}(k||(k={})),function(e){e.HEADING_BUTTON_GROUP="headingButtonGroup",e.SEPARATOR_BUTTON_GROUP="separatorButtonGroup",e.CHECKBOX_BUTTON_GROUP="checkboxButtonGroup",e.UNORDER_LIST_BUTTON_GROUP="unorderButtonGroup",e.ORDER_LIST_BUTTON_GROUP="orderButtonGroup",e.CODE_BLOCK_BUTTON_GROUP="codeblockButtonGroup",e.BLOCKQUETE_BUTTON_GROUP="blockqueteButtonGroup"}(O||(O={})),function(e){e.LEFT_SWIPE="LEFT_SWIPE",e.RIGHT_SWIPE="RIGHT_SWIPE",e.SELECTION="SELECTION",e.LONG_PRESS="LONG_PRESS",e.UNKNOWN="UNKNOWN"}(x||(x={})),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(E||(E={}));var S,C,I,B=r("dx_UtDZ");(C=S||(S={}))[C.Doc=B.NUM_SUITE_TYPE.DOC]="Doc",C[C.Sheet=B.NUM_SUITE_TYPE.SHEET]="Sheet",C[C.Equation=4]="Equation",function(e){e.KEY_BOARD="keyboard",e.CLOSE="close",e.SET_PANEL_HEIGHT="setPanelHeight",e._SEPARATOR_="separator",e.ADD_NEW_BLOCK="addNewBlock",e.BLOCK_TRANSFORM="blockTransform",e.TEXT_TRANSFORM="textTransform",e.ALIGN_TRANSFORM="alignTransform",e.CHECKBOX="checkbox",e.CHECKLIST="checkList",e.REMINDER="reminder",e.MENTION="mention",e.TRANS_TASK="transTask",e.INSERT_IMAGE="insertImage",e.INSERT_FILE="insertFile",e.PLAIN_TEXT="plainText",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.H7="h7",e.H8="h8",e.H9="h9",e.HN="hn",e.ORDERED_LIST="orderedList",e.UNORDERED_LIST="unorderedList",e.CODE_LIST="codeList",e.BLOCK_QUOTE="blockQuote",e.CALLOUT_BLOCK="calloutBlock",e.BOLD="bold",e.ITALIC="italic",e.UNDERLINE="underline",e.STRIKE_THROUGH="strikethrough",e.INLINE_CODE="inlineCode",e.HIGHLIGHT="highlight",e.INDENT_LEFT="indentLeft",e.INDENT_RIGHT="indentRight",e.ALIGN_LEFT="alignLeft",e.ALIGN_CENTER="alignCenter",e.ALIGN_RIGHT="alignRight",e.INSERT_SEPARATOR="insertSeparator",e.MENTION_USER="mentionUser",e.MENTION_CHAT="mentionChat",e.MENTION_FILE="mentionFile",e.INSERT_TABLE="insertTable",e.PENCIL_KIT="pencilKit",e.INSERT_REMINDER="insertReminder",e.OKR="okr",e.TASK="task",e.INSERT_TASK="insertTask",e.INSERT_EQUATION="equation",e.INSERT_SHEET="insertSheet",e.INSERT_BITABLE="insertBitable",e.INSERT_MINDNOTE="insertMindnote"}(I||(I={}));r("dx_lwsE"),r("dx_W8MJ"),r("dx_W7W2"),r("dx_a1gu"),r("dx_Nsbk");r("dx_AA3h"),r("dx_wvVt"),r("dx_yzqx");var T,w,R,M,j=r("dx_nddJ");!function(e){e.TURN_INTO="turn_into_",e.ADD="add_",e.ADD_INLINE="add_inline_"}(M||(M={}));var D={arrow_up:"arrow_up",arrow_down:"arrow_down",arrow_left:"arrow_left",arrow_right:"arrow_right",shift_arrow_up:"shift_arrow_up",shift_arrow_down:"shift_arrow_down",shift_arrow_left:"shift_arrow_left",shift_arrow_right:"shift_arrow_right",backspace:"backspace",enter:"enter",shift_enter:"shift_enter",meta_shift_enter:"meta_shift_enter",shift_cmd_up:"shift_cmd_up",shift_cmd_down:"shift_cmd_down",shift_ctrl_up:"shift_ctrl_up",shift_ctrl_down:"shift_ctrl_down",tab:"tab",untab:"untab",bold:"bold",italic:"italic",underline:"underline",strikethrough:"strikethrough",link:"link",inlineCode:"inlineCode",metaEnter:"meta_enter",select_all:"select_all",keydown:"keydown",newPage:"new_page",highlight:"highlight",turn_into_heading1:"turn_into_".concat(g.B.HEADING1),turn_into_heading2:"turn_into_".concat(g.B.HEADING2),turn_into_heading3:"turn_into_".concat(g.B.HEADING3),turn_into_heading4:"turn_into_".concat(g.B.HEADING4),turn_into_heading5:"turn_into_".concat(g.B.HEADING5),turn_into_heading6:"turn_into_".concat(g.B.HEADING6),turn_into_heading7:"turn_into_".concat(g.B.HEADING7),turn_into_heading8:"turn_into_".concat(g.B.HEADING8),turn_into_heading9:"turn_into_".concat(g.B.HEADING9),turn_into_ordered:"turn_into_".concat(g.B.ORDERED),turn_into_bullet:"turn_into_".concat(g.B.BULLET),turn_into_quote:"turn_into_".concat(g.B.QUOTE),turn_into_quote_container:"turn_into_".concat(g.B.QUOTE_CONTAINER),turn_into_code:"turn_into_".concat(g.B.CODE),turn_into_text:"turn_into_".concat(g.B.TEXT),turn_into_callout:"turn_into_".concat(g.B.CALLOUT),turn_into_todo:"turn_into_".concat(g.B.TODO),turn_task:"turn_task",add_divider:"add_".concat(g.B.DIVIDER),exit:"exit",collapse:"collapse",expand:"expand",minus:"minus",comment:"comment",text_align_left:"text_align_left",text_align_right:"text_align_right",text_align_center:"text_align_center",copy_anchor_link:"copy_anchor_lick",add_diagram:"add_".concat(g.B.DIAGRAM),add_iframe:"add_".concat(g.B.IFRAME),add_bookmark:"add_".concat(g.B.BOOKMARK),add_image:"add_".concat(g.B.IMAGE),add_file:"add_".concat(g.B.FILE),at:"at",add_inline_user:"add_inline_user",add_inline_mention_doc:"add_inline_mention_doc",add_inline_link:"add_inline_link",add_inline_reminder:"add_inline_reminder",add_inline_equation:"add_inline_".concat(g.B.EQUATION),add_chat_card:"add_".concat(g.B.CHAT_CARD),add_sheet:"add_".concat(g.B.SHEET),add_bitable:"add_".concat(g.B.BITABLE),add_mindmap:"add_".concat(g.B.MINDMAP),add_grid_column:"add_".concat(g.B.GRID_COLUMN),add_table:"add_".concat(g.B.TABLE),add_isv:"add_".concat(g.B.ISV),add_okr:"add_".concat(g.B.OKR),add_task:"add_".concat(g.B.TASK),copy:"copy",cut:"cut",paste:"paste",undo:"undo",redo:"redo",merge_cell:"merge_cell",color:"color",backgroundColor:"backgroundColor",remove_highlight:"remove_highlight",find:"find",replace:"replace",open_helper:"open_helper",advanced_search:"advanced_search",block_color:"block_color",display_mode:"display_mode"},A=(T={},p()(T,v.F.onArrowUp,D.arrow_up),p()(T,v.F.onArrowDown,D.arrow_down),p()(T,v.F.onArrowLeft,D.arrow_left),p()(T,v.F.onArrowRight,D.arrow_right),p()(T,v.F.onShiftArrowUp,D.shift_arrow_up),p()(T,v.F.onShiftArrowDown,D.shift_arrow_down),p()(T,v.F.onShiftArrowLeft,D.shift_arrow_left),p()(T,v.F.onShiftArrowRight,D.shift_arrow_right),p()(T,v.F.onBackspace,D.backspace),p()(T,v.F.onEnter,D.enter),p()(T,v.F.onShiftEnter,D.shift_enter),p()(T,v.F.onUnTab,D.untab),p()(T,v.F.onTab,D.tab),p()(T,v.F.onBold,D.bold),p()(T,v.F.onItalic,D.italic),p()(T,v.F.onUnderline,D.underline),p()(T,v.F.onStrikeThrough,D.strikethrough),p()(T,v.F.onLink,D.link),p()(T,v.F.onInlineCode,D.inlineCode),p()(T,v.F.onMetaEnter,D.metaEnter),p()(T,v.F.onSelectAll,D.select_all),p()(T,v.F.onKeyDown,D.keydown),p()(T,v.F.onNewPage,D.newPage),p()(T,v.F.onTurnIntoHeading1,D.turn_into_heading1),p()(T,v.F.onTurnIntoHeading2,D.turn_into_heading2),p()(T,v.F.onTurnIntoHeading3,D.turn_into_heading3),p()(T,v.F.onTurnIntoHeading4,D.turn_into_heading4),p()(T,v.F.onTurnIntoHeading5,D.turn_into_heading5),p()(T,v.F.onTurnIntoHeading6,D.turn_into_heading6),p()(T,v.F.onTurnIntoHeading7,D.turn_into_heading7),p()(T,v.F.onTurnIntoHeading8,D.turn_into_heading8),p()(T,v.F.onTurnIntoHeading9,D.turn_into_heading9),p()(T,v.F.onTurnIntoOrdered,D.turn_into_ordered),p()(T,v.F.onTurnIntoBullet,D.turn_into_bullet),p()(T,v.F.onTurnIntoTask,D.turn_into_todo),p()(T,v.F.onTurnIntoQuote,D.turn_into_quote),p()(T,v.F.onTurnIntoQuoteContainer,D.turn_into_quote_container),p()(T,v.F.onTurnIntoCode,D.turn_into_code),p()(T,v.F.onTurnIntoText,D.turn_into_text),p()(T,v.F.onTurnIntoCallout,D.turn_into_callout),p()(T,v.F.onAddDivider,D.add_divider),p()(T,v.F.onAddReminder,D.add_inline_reminder),p()(T,v.F.onMetaShiftEnter,D.meta_shift_enter),p()(T,v.F.onShiftCmdUp,D.shift_cmd_up),p()(T,v.F.onShiftCmdDown,D.shift_cmd_down),p()(T,v.F.onShiftCtrlUp,D.shift_ctrl_up),p()(T,v.F.onShiftCtrlDown,D.shift_ctrl_down),p()(T,v.F.onExit,D.exit),p()(T,v.F.onCollapse,D.collapse),p()(T,v.F.onExpand,D.expand),p()(T,v.F.onToggleTask,D.turn_into_todo),p()(T,v.F.onMinus,D.minus),p()(T,v.F.onComment,D.comment),p()(T,v.F.onHelpSiderbar,D.open_helper),p()(T,v.F.TextAlignLeft,D.text_align_left),p()(T,v.F.TextAlignCenter,D.text_align_center),p()(T,v.F.TextAlignRight,D.text_align_right),p()(T,v.F.onFind,D.find),p()(T,v.F.onReplace,D.replace),p()(T,v.F.onAdvancedSearch,D.advanced_search),T);w={},p()(w,I.H1,D.turn_into_heading1),p()(w,I.H2,D.turn_into_heading2),p()(w,I.H3,D.turn_into_heading3),p()(w,I.H4,D.turn_into_heading4),p()(w,I.H5,D.turn_into_heading5),p()(w,I.H6,D.turn_into_heading6),p()(w,I.H7,D.turn_into_heading7),p()(w,I.H8,D.turn_into_heading8),p()(w,I.H9,D.turn_into_heading9),p()(w,I.ORDERED_LIST,D.turn_into_ordered),p()(w,I.UNORDERED_LIST,D.turn_into_bullet),p()(w,I.CHECKLIST,D.turn_into_todo),p()(w,I.CHECKBOX,D.turn_into_todo),p()(w,I.TRANS_TASK,D.turn_task),p()(w,I.CODE_LIST,D.turn_into_code),p()(w,I.BLOCK_QUOTE,D.turn_into_quote_container),p()(w,I.PLAIN_TEXT,D.turn_into_text),p()(w,I.INSERT_IMAGE,D.add_image),p()(w,I.INSERT_TABLE,D.add_table),p()(w,I.INSERT_FILE,D.add_file),p()(w,I.INSERT_SEPARATOR,D.add_divider),p()(w,I.MENTION_USER,D.add_inline_user),p()(w,I.MENTION_CHAT,D.add_chat_card),p()(w,I.MENTION_FILE,D.add_inline_mention_doc),p()(w,I.MENTION,D.at),p()(w,I.REMINDER,D.add_inline_reminder),p()(w,I.INSERT_REMINDER,D.add_inline_reminder),p()(w,I.INSERT_TASK,D.add_task),p()(w,I.INSERT_EQUATION,D.add_inline_equation),p()(w,I.INSERT_SHEET,D.add_sheet),p()(w,I.INSERT_BITABLE,D.add_bitable),p()(w,I.INSERT_MINDNOTE,D.add_mindmap),p()(w,I.BOLD,D.bold),p()(w,I.ITALIC,D.italic),p()(w,I.UNDERLINE,D.underline),p()(w,I.STRIKE_THROUGH,D.strikethrough),p()(w,I.INLINE_CODE,D.inlineCode),p()(w,I.HIGHLIGHT,D.highlight),p()(w,I.INDENT_LEFT,D.untab),p()(w,I.INDENT_RIGHT,D.tab),p()(w,I.ALIGN_LEFT,D.text_align_left),p()(w,I.ALIGN_CENTER,D.text_align_center),p()(w,I.ALIGN_RIGHT,D.text_align_right),R={},p()(R,o.COPY,o.COPY),p()(R,o.CUT,o.CUT),p()(R,o.COMMENT,o.COMMENT),p()(R,o.DELETE,o.DELETE),p()(R,o.COPY_LINK,o.COPY_LINK),p()(R,o.HIGHLIGHT,"none"),p()(R,o.TEXT,D.turn_into_text),p()(R,o.H1,D.turn_into_heading1),p()(R,o.H2,D.turn_into_heading2),p()(R,o.H3,D.turn_into_heading3),p()(R,o.H4,D.turn_into_heading4),p()(R,o.H5,D.turn_into_heading5),p()(R,o.H6,D.turn_into_heading6),p()(R,o.H7,D.turn_into_heading7),p()(R,o.H8,D.turn_into_heading8),p()(R,o.H9,D.turn_into_heading9),p()(R,o.HN,"none"),p()(R,o.SEPARATOR,"none"),p()(R,o.CHECKBOX,D.turn_into_todo),p()(R,o.ORDERED_LIST,D.turn_into_ordered),p()(R,o.UNORDERED_LIST,D.turn_into_bullet),p()(R,o.CODE_BLOCK,D.turn_into_code),p()(R,o.BLOCK_QUOTE,D.turn_into_quote_container),p()(R,o.BOLD,D.bold),p()(R,o.ITALIC,D.italic),p()(R,o.UNDERLINE,D.underline),p()(R,o.INLINE_CODE,D.inlineCode),p()(R,o.STRIKE_THROUGH,D.strikethrough),p()(R,o.INDENT_LEFT,D.tab),p()(R,o.INDENT_RIGHT,D.untab),p()(R,o.ALIGN_LEFT,D.text_align_left),p()(R,o.ALIGN_CENTER,D.text_align_center),p()(R,o.ALIGN_RIGHT,D.text_align_right),p()(R,o.BLOCK_ALIGN_LEFT,j.G.alignLeft),p()(R,o.BLOCK_ALIGN_CENTER,j.G.alignCenter),p()(R,o.BLOCK_ALIGN_RIGHT,j.G.alignRight);function P(e){return!(function(e){return[D.bold,D.italic,D.strikethrough,D.underline,D.inlineCode,D.tab,D.untab,D.backspace].includes(e)}(e)||e===D.select_all)}function L(e){if("string"===typeof e){var n=N(e);if(n)return n+e}if(Object(i.isPlainObject)(e))for(var r=0,o=Object.keys(e);r<o.length;r++){var c=o[r],a=N(c);if(a)return a+c;if(D[c])return c}return e}function N(e){return Object.values(M).find((function(n){return!!D[n+e]}))||""}function F(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return U(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function U(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var H=Object(l.A)((function(e,n){var r,o=e.actionType,l=e.blocks,h=e.blockManager,p=e.source,v=e.actionObject,g=e.click,b=void 0===g?f.c.block_action:g,y=e.sendImmediately,m=void 0===y||y,_=e.actionValue,k=e.target,O=e.selectionAPI,x=e.category,E=e.mark,S=e.isSubPanel,C="ccm_doc_".concat(p,"_click"),I={record_id:"",block_type:"",sub_block_type:""},B=[],T=F(l);try{for(T.s();!(r=T.n()).done;){var w=r.value.id,R=Object(d.p)(w,h);if(R.record_id){var M=Object(d.p)(R.parentBlockId,h);I.record_id||(I=Object(i.pick)(M,["record_id","block_type","sub_block_type"])),B.push(Object(d.S)(R))}}}catch(N){T.e(N)}finally{T.f()}var j={target:k,action_type:L(o),action_object:v||Object(d.t)(O),click:b,object_block_data:B};if(n&&Object.assign(j,n),_&&(j.action_value=_),x&&(j.category=x),"undefined"!==typeof S&&(j.is_sub_panel=S?"true":"false"),p===f.G.slash_panel){var D=l[0];if(D.editor){var A=E?Object(a.N)(D,E).toPosition():D.editor.selection.getSelection().toPosition(),P=D&&D.model&&D.model.zoneState.getModelText().slice(A.start+1,A.start+A.len)||"";j.is_search_result=P?"true":"false"}else j.is_search_result="false"}return!k&&u.F[j.action_type]&&(j.target=u.F[j.action_type]),m?(Object(c.P)(C,I,j),null):new s.a(C,s.v.Click,I,j)})),V=Object(l.A)((function(e){var n=e.blockId,r=e.subClick,o=e.blockManager;Object(c.P)("ccm_doc_content_page_click",Object(d.m)(n,o),{click:"open_slash_panel",sub_click:r})}))},dx_kGKL:function(e,n,r){"use strict";(function(t){var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_iWIM"),f=r.n(d),h=r("dx_W7W2"),p=r.n(h),v=r("dx_a1gu"),g=r.n(v),b=r("dx_Nsbk"),y=r.n(b),m=r("dx_TSYQ"),_=r.n(m),k=r("dx_UtDZ"),O=r("dx_h6a8"),x=r("dx_cDcd"),E=r.n(x),S=r("dx_yzqx"),C=r("dx_UHze"),I=r("dx_hKul"),B=r("dx_CR0l"),T=r("dx_luPr"),w=r("dx_B28d"),R=r("dx_MGoZ"),M=r("dx_Ogyw"),j=r("dx_f4Wj"),D=r("dx_Np2v"),A=r("dx_f1HX"),P=r("dx_ciOt");function L(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=y()(e);if(n){var i=y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return g()(this,r)}}var N=function(e){p()(r,e);var n=L(r);function r(){var e;l()(this,r);for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return(e=n.call.apply(n,[this].concat(a))).state={loading:!0,loadSuccess:!1},e.handleFetchChatCardError=function(){T.R.reportBlockLoadError({id:e.model.id,type:e.model.type})},e.setJoinState=function(n){var r=Object.assign({},e.state.chatCardInfo,{hasJoin:n}),o=Object.assign({},e.state,{chatCardInfo:r});e.setState(o)},e.handleClickJoin=c()(o.a.mark((function n(){var r,i;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r=e.snapshot.chat_token,n.next=4,Object(j.G)(r);case 4:if(!(i=n.sent).data.code){n.next=9;break}return Object(A.b)({type:"error",content:D.H[i.data.code]||t("etherpad.join_group_failed")}),4012===i.data.code&&e.setJoinState(!0),n.abrupt("return");case 9:e.setJoinState(!0),n.next=17;break;case 12:return n.prev=12,n.t0=n.catch(0),console.log("err",n.t0),Object(A.b)({type:"error",content:t("common.network_error")}),n.abrupt("return");case 17:case"end":return n.stop()}}),n,null,[[0,12]])}))),e.handleChatBtnClick=function(n){Object(I.M)(e.id,{actionType:B.e.CLICK_CHAT_CARD,actionValue:{value1:n}},{blockManager:e.blockManager})},e.handleClickOpen=Object(O.debounce)((function(n){n.stopPropagation(),k.openChat&&Object(k.openChat)(e.snapshot.chat_id),Object(I.M)(e.id,{actionType:B.e.CLICK_CHAT_CARD,actionValue:{value1:B.w.OPEN}},{blockManager:e.blockManager})}),S.S.isMobile&&S.S.isIPad?310:0),e.handleClickLoading=function(){e.state.loadSuccess||e.fetchChatCardInfo(!1,!0)},e.getViewSnapshot=function(){return e.hostElement.querySelector(".chat-card-inner")},e}return u()(r,[{key:"blockViewDidMount",value:function(){f()(y()(r.prototype),"blockViewDidMount",this).call(this),this.snapshot.chat_token&&!Object(C.E)()&&this.fetchChatCardInfo(!1)}},{key:"blockViewDidUpdate",value:function(e,n){f()(y()(r.prototype),"blockViewDidUpdate",this).call(this,e,n),e.record.snapshot.chat_token!==this.record.snapshot.chat_token&&this.fetchChatCardInfo(!1)}},{key:"fetchChatCardInfo",value:function(){var e=c()(o.a.mark((function e(){var n,r,i,c,a,l,s,u,d,f,h,p,v=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(v.length>0&&void 0!==v[0])||v[0],r=v.length>1&&void 0!==v[1]&&v[1],!n||!this.state.loading){e.next=4;break}return e.abrupt("return");case 4:if(this.setState({loading:!0,loadSuccess:!1}),e.prev=5,i=this.snapshot.chat_token,c=this.blockManager.rootRecordId,a=window.User.id,A.i.instance&&A.i.instance.pageToken===c&&A.i.instance.userId===a||(A.i.instance=new A.i(c,a)),!r){e.next=16;break}return e.next=13,A.i.instance.retry(i);case 13:e.t0=e.sent,e.next=19;break;case 16:return e.next=18,A.i.instance.fetch(i);case 18:e.t0=e.sent;case 19:l=e.t0,s=l.is_cross_tenant,u=l.is_external,d=l.has_join,f=l.url,h=l.content,p=l.group_desc,this.setState({loading:!1,loadSuccess:!0,chatCardInfo:{isExternal:u,hasJoin:d,isCrossTenant:s,icon:f,name:h,desc:p}}),e.next=28;break;case 24:e.prev=24,e.t1=e.catch(5),this.setState({loading:!1,loadSuccess:!1}),this.handleFetchChatCardError();case 28:case"end":return e.stop()}}),e,this,[[5,24]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){if(Object(C.E)())return E.a.createElement(P.b,null);var e=this.props.syncCursorBorderColor,n=this.state,r=n.loading,o=n.loadSuccess,i=E.a.createElement(E.a.Fragment,null);return i=r||!o?E.a.createElement(P.i,{borderColor:e,onClick:this.handleClickLoading}):E.a.createElement(P.y,{icon:this.state.chatCardInfo.icon,name:this.state.chatCardInfo.name,desc:this.state.chatCardInfo.desc,hasJoin:this.state.chatCardInfo.hasJoin,isReadOnly:this.config.get("isHistory")||this.config.get("isShortcut"),disable:this.state.chatCardInfo.isExternal&&!this.state.chatCardInfo.isCrossTenant,showExternalLabel:this.state.chatCardInfo.isCrossTenant,borderColor:e,onConfirmJoin:this.handleClickJoin,onConfirmOpen:this.handleClickOpen,onChatBtnClick:this.handleChatBtnClick}),E.a.createElement("div",{className:_()("chat-card-container","align-".concat(this.snapshot.align||w.D.LEFT))},E.a.createElement("div",{className:_()("chat-card-inner",M.B)},E.a.createElement("div",{className:"chat-card-clip-container"},i)))}},{key:"chatCardInfo",get:function(){return this.state.chatCardInfo}},{key:"contentElement",get:function(){return this.hostElement.querySelector(".chat-card-inner")}}]),r}(R.l);N.type=D.L,n.S=N}).call(this,r("dx_E9Eu"))},dx_kHZM:function(e,n,r){},dx_kLTg:function(e,n,r){"use strict";r.d(n,"l",(function(){return a})),r.d(n,"W",(function(){return l})),r.d(n,"K",(function(){return s})),r.d(n,"H",(function(){return u}));var o=r("dx_B28d"),i=r("dx_Tsyy"),c=r("dx_USRY"),a="NOTIFY_BLOCK_WIDTH",l="CLEAR_CELL_MIN_WIDTH",s=new Map([[o.B.GRID,i.s],[o.B.CODE,330],[o.B.CALLOUT,100],[o.B.DIAGRAM,360],[o.B.MINDMAP,360],[o.B.CHAT_CARD,360],[o.B.VIEW,360],[o.B.POLL,320],[o.B.BOOKMARK,156]]),u=new Map([[c.t.Preview,360],[c.t.Card,400]])},dx_kP4l:function(e,n,r){"use strict";(function(t){r.d(n,"z",(function(){return e})),r.d(n,"d",(function(){return o})),r.d(n,"S",(function(){return D})),r.d(n,"R",(function(){return F})),r.d(n,"u",(function(){return U})),r.d(n,"I",(function(){return W})),r.d(n,"T",(function(){return z})),r.d(n,"J",(function(){return G}));var e,o,i=r("dx_J4zp"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_UtDZ"),f=r("dx_h6a8"),h=r("dx_cDcd"),p=r.n(h),v=r("dx_iHWM"),g=r("dx_rQGm"),b=r("dx_PQBD"),y=r("dx_yzqx"),m=r("dx_DnxT"),_=r("dx_AAGW"),k=r("dx_UmoL"),O=r("dx_Fimk"),x=r("dx_CwnG"),E=r("dx_TwmW"),S=r("dx_B28d"),C=r("dx_hFUV"),I=r("dx_vOIB"),B=r("dx_B8Bh"),T=r("dx_zghO"),w=r("dx_pxpU"),R=r("dx_Ogyw");!function(e){e.INNER_TAB="inner_tab",e.NO_PREV_SIBLING="no_prev_sibling",e.MAX_LEVEL="max_level",e.CAN_NOT_INDENT="can_not_indent",e.BLOCK_INDENT="block_indent",e.TEXT_INDENT="text_indent",e.PREV_SIBLING_IS_NOT_NESTABLE="prev_sibling_is_not_nestable",e.NEED_SHOW_SETTING_TIP="need_show_setting_tip",e.PAGE_BLOCK="page_block"}(e||(e={})),function(e){e.web_text_bubble_toolbar="web_text_bubble_toolbar",e.web_menu_panel="web_menu_panel",e.above_block="above_block"}(o||(o={}));var M="docx_show_indent_tips",j=new(function(){function e(){l()(this,e),this.state=void 0,this.reset(),K()&&!y.S.isMobile&&_.S.get("".concat(m.r.ccmSetting,"/get?setting_key=text_indent"),{baseURL:Object(k.q)()}).then((function(e){if(e&&0===e.code&&e.data){var n,r,o="text_indent"===(null===(n=e.data[0])||void 0===n?void 0:n.setting_key)&&(null===(r=e.data[0])||void 0===r?void 0:r.setting_value);o&&localStorage.setItem("text_indent_enable",o)}})).catch((function(e){console.error("get text_indent_enable config occur error:",e)}))}return u()(e,[{key:"getState",value:function(){return this.state}},{key:"set",value:function(e){this.state=Object.assign({},this.state,e)}},{key:"reset",value:function(){this.state={blockId:0,prevBrotherBlockIds:[],showingTips:!1}}}]),e}());function D(){return j}function A(e){var n=e.parent;return(null===n||void 0===n?void 0:n.type)===S.B.VIEW?n:e}function P(e){var n=e.blockManager,r=e.id,o=A(n.getBlockModelByBlockId(r));return!!(null===o||void 0===o?void 0:o.previousSibling)}function L(e){var n=e.blockManager,r=e.id,o=A(n.getBlockModelByBlockId(r)).previousSibling;if(!o)return!1;var i=n.getBlockModelByBlockId(o.id),c=Array.isArray(i.record.snapshot.children);return Object(S.q)().includes(i.type)&&c}function N(e){var n=e.blockManager,r=e.id,o=n.getBlockModelByBlockId(r),i=n.getBlockMaxLevelInContainer(o);return S.h.includes(o.type)?o.depth-1<g.w&&i+1<g.p:i<g.w}function F(e){return 1===e.model.snapshot.text_indent}function U(e,n){return!H(e,n)&&P(e)&&L(e)&&N(e)}function H(e,n){var r=K(),o=!r||r&&q();return(Object(E.S)()||Object(d.getMinaConfig)("ccm.docx.web.text_indent_setting",!0))&&o&&function(e){var n=e.blockManager,r=e.id;return n.getBlockModelByBlockId(r).type===S.B.TEXT}(e)&&!Object(b.R)(e.id,e.blockManager,S.B.TABLE)&&V(n)&&W(e)&&!F(e)}function V(e){return!(null===e||void 0===e?void 0:e.mouse)}function W(e){var n=e.selectionAPI.getSelection();if(1===n.length){var r=n[0],o=r.selection;return r.type===T.j.TEXT&&0===(null===o||void 0===o?void 0:o.start)}return!1}function z(n,r){var o=function(e){if(!K())return!1;var n=e.selectionAPI.getSelection(),r=c()(n,1)[0];if(!r)return!1;var o=q(),i=r.id,a=r.selection,l=r.type,s=e.model.root.children[0];if(!s)return!1;var u=s.id===i,d=l===T.j.TEXT&&0===(null===a||void 0===a?void 0:a.start)&&0===(null===a||void 0===a?void 0:a.end),f="true"===window.localStorage.getItem(M);return u&&d&&!f&&!o}(n),i=U(n,r),a=H(n,r),l=function(e,n){var r=e.blockManager,o=e.id,i=r.getBlockModelByBlockId(o),a=e.selectionAPI.getSelection(),l=c()(a,1)[0];return l&&l.type===T.j.TEXT&&S.M.includes(i.type)&&V(n)}(n,r);return"page"===n.model.type?e.PAGE_BLOCK:o?e.NEED_SHOW_SETTING_TIP:l?e.INNER_TAB:a?e.TEXT_INDENT:i?e.BLOCK_INDENT:P(n)?N(n)?L(n)?e.CAN_NOT_INDENT:e.PREV_SIBLING_IS_NOT_NESTABLE:e.MAX_LEVEL:e.NO_PREV_SIBLING}function G(n,r,o,i,c){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s="",u=!0;if(X()){var d,h=!1,g=[],m={view_show_position:i,object_block_data:Object(x.J)(n,o)},_=!1;switch(r){case e.BLOCK_INDENT:case e.TEXT_INDENT:case e.INNER_TAB:case e.PAGE_BLOCK:s="",u=!1;break;case e.MAX_LEVEL:s=t("CreationDoc_Docs_Indent_MaxOneLevel"),u=!0;break;case e.NEED_SHOW_SETTING_TIP:var k=function(){y.S.isLarkFeed?window.open("".concat(window.location.href.split(/[?#]/)[0],"?open_text_indent_setting=true"),"_blank","noopener=yes,noreferrer=yes"):window.dispatchEvent(Object(v.x)("ModalManagerOpenModal",{detail:{modalName:"GLOBAL_SETTINGS",modalProps:{source:"homepage",highlightAnimatedKey:"enable_text_indent"}}})),Object(O.N)("ccm_doc_toast_click",{target:"space_personal_info_setting_view",toast_reason:"un_support_first_line_indent_toast",view_show_position:"above_block"})};s=p.a.createElement("span",null,t("CreationDoc_Docs_LinktoEnableIndent"),p.a.createElement("span",{className:"block-tips-link",onClick:k},t("CreationDoc_Docs_LinktoEnableIndent_Button"))),m.toast_reason="un_support_first_line_indent_toast",window.localStorage.setItem(M,"true");break;case e.NO_PREV_SIBLING:case e.PREV_SIBLING_IS_NOT_NESTABLE:case e.CAN_NOT_INDENT:var E,T=n.getBlockModelByBlockId(o),j=T.parent,A=Object(I.q)(T);if(!j){m.toast_reason="un_support_tab_can_not_tab_brother_toast",s=t("CreationDoc_Docs_Indent_Unable");break}var P=j.children.findIndex((function(e){return e.id===o}));if(P<=0){m.toast_reason=1===A?"un_support_tab_can_not_tab_brother_toast":"un_support_muilt_tab_toast",s=t(1===A?"CreationDoc_Docs_Indent_Unable":"CreationDoc_Docs_Indent_MaxOneLevel");break}for(var L=function(e){var r,o=n.getBlockModelByBlockIdNotCheck(e),i=e;(null===o||void 0===o?void 0:o.type)===S.B.VIEW&&(i=null===(r=o.children[0])||void 0===r?void 0:r.id);var c=i?n.getBlockModelByBlockIdNotCheck(i):null;if(!c)return"";var a=c.type;return a===S.B.ISV?c.getText().replace(/(\[|\])/g,""):C.L[a]},N=Object(b.w)(null===(E=j.children[P-1])||void 0===E?void 0:E.type),F=3,U=[],H="",V=0;V<=F;){var W=j.children[P-1-V++];if(!W)break;if(Object(B.K)(W.type)){if("web_menu_panel"===i)s=t("CreationDoc_Docs_Toolbar_IndentNotSupported",void 0,void 0,H,Object(f.uniq)(U).join("\u3001"));else{s=t("CreationDoc_Docs_IndentNotSupported_PressTabAgain",void 0,void 0,Object(f.uniq)(U).join("\u3001"));var z=D();z.set({prevBrotherBlockIds:g,blockId:o,showingTips:!0})}a&&(d=function(){var e=g.reduce((function(e,r){var o=n.getBlockViewByBlockIdNotCheck(r);return o&&e.push(o),e}),[]);Object(R.I)(e)}),m.toast_reason="un_support_tab_can_tab_brother_toast",m.up_brother_block_type=U.join(","),h=!0;break}var G=L(W.id);G&&(g.push(W.id),U.push(G),H||(H=G))}h||(m.toast_reason="un_support_tab_can_not_tab_brother_toast",s=t("CreationDoc_Docs_Indent_UnableUnderneath",void 0,void 0,N));break;default:s="",u=!1}if(s&&a)try{var K,q,Y,J,Z=n.getBlockViewByBlockId(o),Q=Z.hostElement.firstElementChild;(null===(K=Q)||void 0===K?void 0:K.classList.contains("docx-block-zero-space"))&&(Q=Q.nextElementSibling),(null===(q=Q)||void 0===q?void 0:q.classList.contains("author-host"))&&((J=Q).classList.add("is-in-indent-animation"),Q=Q.nextElementSibling);var $,ee=null===(Y=Q)||void 0===Y?void 0:Y.querySelector(".author-line-extend");if(ee)null===($=Q)||void 0===$||$.classList.add("animation-indent--author--line--extend");if(Q&&!Q.classList.contains("animation-indent--right")){Q.classList.add("animation-indent--right"),_=!0;var te=function e(){var r,i;Q.classList.remove("animation-indent--right"),Q.classList.remove("animation-indent--author--line--extend"),null===(r=J)||void 0===r||r.classList.remove("is-in-indent-animation"),n.dispatch(w.i,[o,s]),null===(i=d)||void 0===i||i(),Q.removeEventListener("animationend",e)};Q.addEventListener("animationend",te)}}catch(ne){console.log("indent helper \u62ff\u4e0d\u5230 instance")}return l&&m.toast_reason&&Object(O.N)("ccm_doc_toast_view",m),c&&s&&!_&&n.dispatch(w.i,[o,s]),{tips:s,showTips:u,collectorParams:m,prevBrotherBlockIds:g,hasListBlockUpper:h}}}function K(){return Object(d.getMinaConfig)("ccm.docx.web.text_indent_setting",!1)}function q(){return!("close"===localStorage.getItem("text_indent_enable"))}function X(){return Object(d.getMinaConfig)("ccm.docx.block_indentation_tips",!0)}}).call(this,r("dx_E9Eu"))},dx_kTtG:function(e,n,r){"use strict";(function(t){r.d(n,"z",(function(){return h}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_UtDZ"),l=r("dx_cDcd"),s=r.n(l),u=r("dx_Fimk"),d=r("dx_R0R3"),f=function(){function e(){o()(this,e),this.resolve=null}return c()(e,[{key:"open",value:function(){var e=this;return new Promise((function(n){e.resolve=n,a.Toast.show({key:d.m,content:s.a.createElement("div",{className:"toast-confirm"},s.a.createElement("p",{className:"toast-text"},t("CreationDoc_Todo_TaskDeletedInTasksClickToCancel_Toast")),s.a.createElement("button",{type:"button",className:"toast-button",onClick:function(){e.close(!0),Object(u.N)("ccm_docs_toast_click",{click:"click_cancel_delete_task_center",target:"none",sub_view:"sync_delete_task_center"})}},t("common.undo"))),duration:d.Y,className:"permissionToast",cancelText:t("common.undo"),onClose:function(){return e.close(!1)}})}))}},{key:"isOpen",value:function(){return!!this.resolve}},{key:"close",value:function(e){this.resolve&&(this.resolve(e),this.resolve=null),a.Toast.remove(d.m)}}]),e}();f.CANCEL_TOAST_KEY=d.m;var h=new f}).call(this,r("dx_E9Eu"))},dx_kZ3l:function(e,n,r){"use strict";r.d(n,"C",(function(){return u})),r.d(n,"X",(function(){return d})),r.d(n,"S",(function(){return f})),r.d(n,"A",(function(){return h})),r.d(n,"h",(function(){return p})),r.d(n,"j",(function(){return v})),r.d(n,"JI",(function(){return g})),r.d(n,"O",(function(){return b})),r.d(n,"J",(function(){return m})),r.d(n,"uq",(function(){return _})),r.d(n,"R",(function(){return k})),r.d(n,"k",(function(){return O})),r.d(n,"u",(function(){return x})),r.d(n,"Z",(function(){return E})),r.d(n,"r",(function(){return S})),r.d(n,"d",(function(){return C}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_uZlF"),a=r("dx_vdIl");function l(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?l(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function u(e){return 0===e.start.line&&0===e.start.offset}function d(e){var n=e.editor.getContentState().getZoneState(e.start.zoneId);if(!n)return!1;var r=n.totalWidth()-1;return e.toPosition().start+e.toPosition().len===r}function f(e){var n="len"in e?e:e.toPosition();return[n.start,n.start+n.len]}function h(e){return Array.isArray(e)?{zoneId:a.x,start:e[0],len:e[1]-e[0]}:e.toPosition()}function p(e){var n=e.toPosition();return{start:n.start,end:n.start+n.len}}function v(e,n){var r=g(e.model.zoneState,n);return new c.A(s(s({editor:e.editor},r),{},{state:e.model.zoneState}))}function g(e,n){var r=e.getZoneId(),o=e.offsetToPoint(n[0]),i=e.offsetToPoint(n[1]);return{start:s(s({},o),{},{zoneId:r}),end:s(s({},i),{},{zoneId:r})}}function b(e){var n=e.start.zoneId,r=e.editor.getContentState().getZoneState(n);if(!r)return!1;var o=r.length(),i=r.getLine(o-1);if(!i)return!1;var c=e.editor.rectModule.getCaretRect(s(s({},e.start),{},{line:0,offset:0}),n),a=e.editor.rectModule.getCaretRect(s(s({},e.start),{},{line:o-1,offset:i.length()-1}),n);return!y(c.top,a.top)}function y(e,n){return void 0===e||void 0===n||Math.abs(e-n)<8}function m(e){var n=e.toPosition(),r=n.zoneId,o=e.editor.getContentState().getZoneState(r);if(!o)return!1;var i=o.offsetToPoint(n.start+n.len+1),c=e.editor.rectModule.getCaretRect(e.end,r),a=e.editor.rectModule.getCaretRect(s(s({},i),{},{zoneId:r}),r);return!y(c.top,a.top)}function _(e){var n=e.toPosition(),r=n.zoneId,o=e.editor.getContentState().getZoneState(r);if(!o)return!1;var i=o.offsetToPoint(n.start+n.len+1),c=e.editor.rectModule.getCaretRect(s(s({},e.start),{},{offset:o.getModelText().length-1}),r),a=e.editor.rectModule.getCaretRect(s(s({},i),{},{zoneId:r}),r);return y(c.top,a.top)}function k(e){var n=e.start.zoneId,r=e.editor.rectModule.getCaretRect(e.end,n);if(0!==e.start.line)return!1;var o=e.editor.rectModule.getCaretRect(s(s({},e.start),{},{offset:0}),n);return!!y(r.top,o.top)}function O(e){var n=e.end.zoneId,r=e.editor.rectModule.getCaretRect(e.end,n),o=e.editor.getContentState().getZoneState(n);if(!o||e.start.line!==o.length()-1)return!1;var i=e.editor.rectModule.getCaretRect(s(s({},e.start),{},{offset:o.getModelText().length-1}),n);return!!y(r.top,i.top)}function x(e,n){var r=e.editor,o={line:0,offset:0,zoneId:e.zoneId},i=new c.A({editor:r,start:o,end:o,state:e.zoneState});e.setSelection(i,n),r.focus(e.zoneId)}function E(e){var n=e.zoneState,r=e.editor,o=n.totalWidth(),i=s(s({},n.offsetToPoint(o)),{},{zoneId:n.getZoneId()}),a=new c.A({editor:r,start:i,end:i,state:n});e.setSelection(a),r.focus(e.zoneId)}function S(e,n){var r=n.left,o=n.top,i=e.left+r,c=e.top+o;return{left:i,top:c,bottom:e.bottom+o,right:e.right+r,height:e.height,width:e.width,x:i,y:c}}function C(e,n,r){var o=e.editor,i=e.getSelection();if(i){var a=S(o.rectModule.getCaretRect(i.start,e.zoneId),o.getRect(e.zoneId)),l=n.zoneState,s=r?l.length()-1:0,u=l.getLine(s);if(u){var d,f,h,p,v=u.length(),g={line:s,offset:0,zoneId:l.getZoneId()},y={line:s,offset:v,zoneId:l.getZoneId()},m=S(o.rectModule.getRangeRect(new c.A({editor:o,start:g,end:y,state:l}),n.zoneId),o.getRect(n.zoneId)),_=new c.A({editor:o,start:g,end:g,state:l}),x=new c.A({editor:o,start:y,end:y,state:l});if(!b(_)&&a.left<=m.left)return n.setSelection(_),void o.focus(n.zoneId);if(!b(x)&&a.left>=m.right)return n.setSelection(x),void o.focus(n.zoneId);for(var E=0;E<v;E++){var C=r?v-1-E:E,I={line:s,offset:C,zoneId:l.getZoneId()},B=new c.A({editor:o,start:I,end:I,state:l});if(p=B,!(!r?k(p):O(p))){if(d=B,!r){var T={line:s,offset:Math.max(C-2,0),zoneId:l.getZoneId()};d=new c.A({editor:o,start:T,end:T,state:l})}break}var w=S(o.rectModule.getRangeRect(B,n.zoneId),o.getRect(n.zoneId));if(w.left===a.left||0===E&&(!r&&w.left>a.left||r&&w.left<a.left)){d=B;break}if(f&&h&&(!r&&w.left>a.left||r&&w.left<a.left)){d=Math.abs(h.left-a.left)<Math.abs(w.left-a.left)?f:B;break}f=B,h=w}(d=d||f)&&(n.setSelection(d),o.focus(n.zoneId))}}}},dx_khWp:function(e,n,r){},dx_kqrv:function(e,n,r){"use strict";r.d(n,"P",(function(){return o})),r.d(n,"l",(function(){return i})),r.d(n,"h",(function(){return c})),r.d(n,"I",(function(){return a})),r.d(n,"F",(function(){return l})),r.d(n,"O",(function(){return s})),r.d(n,"s",(function(){return u})),r.d(n,"e",(function(){return d})),r.d(n,"i",(function(){return f}));var o=484,i=90,c=264,a=280,l=20,s=8,u=48,d=314,f="handleShowPopoverCommand"},dx_l1le:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return N}));var e=r("dx_lSNA"),o=r.n(e),i=r("dx_lwsE"),c=r.n(i),a=r("dx_W8MJ"),l=r.n(a),s=r("dx_PJYZ"),u=r.n(s),d=r("dx_iWIM"),f=r.n(d),h=r("dx_W7W2"),p=r.n(h),v=r("dx_a1gu"),g=r.n(v),b=r("dx_Nsbk"),y=r.n(b),m=r("dx_LcNA"),_=r("dx_M30o"),k=r("dx_TSYQ"),O=r.n(k),x=r("dx_cDcd"),E=r.n(x),S=r("dx_rQGm"),C=r("dx_hKul"),I=r("dx_CR0l"),B=r("dx_B8Bh"),T=r("dx_EdHe"),w=r("dx_cGa6"),R=r("dx_ABby"),M=r("dx_BBJ7"),j=r("dx_T7To"),D=r("dx_QPuw");r("dx_Wy0Q");function A(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function P(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?A(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function L(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=y()(e);if(n){var i=y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return g()(this,r)}}var N=function(e){p()(r,e);var n=L(r);function r(){var e;c()(this,r);for(var i=arguments.length,a=new Array(i),l=0;l<i;l++)a[l]=arguments[l];return(e=n.call.apply(n,[this].concat(a))).contentRef=E.a.createRef(),e.state={isFocus:!1,isMouseEntered:!1,isCursorInCheckBox:!1,editMode:M.N.Mouse},e.onFocus=function(){e.editor.isFocus(e.model.zoneId)&&e.setState({isFocus:!0})},e.onBlur=function(){e.editor.isFocus(e.model.zoneId)||e.setState({isFocus:!1})},e.handleContentWillChange=function(n){var r=n.deltaSet;e.model.isDone&&r.forEach((function(e){e.ops.forEach((function(e){Object(_.X)(e)&&(e.attributes=P(P({},e.attributes),{},o()({},R.z,"true")))}))}))},e.onMouseMove=function(n){e.state.isMouseEntered&&e.editable&&e.cursorInCheckBox(n)&&e.setState({isCursorInCheckBox:!0})},e.handleClickIcon=function(n){if(e.editable&&e.cursorInCheckBox(n)){var r=u()(e).selectionAPI,o=r.getSelection();r.isSingleTextSelection(o)&&!r.isCursor(o)&&r.removeAllSelection(),Object(C.M)(e.id,{actionType:I.e.CLICK_TODO_STATUS,actionValue:{value1:String(!e.model.isDone)}},{blockManager:e.blockManager}),e.blockManager.applyTransaction("toggleTodoBlock",(function(n){n.replace(e.record.id,["done"],!e.model.isDone)})),n.stopPropagation()}},e.renderExtensions=function(){if(e.props.recursionProps.isSSR)return null;var n=e.state.isMouseEntered&&e.state.editMode===M.N.Mouse;return e.editable?E.a.createElement(D.q,{containerWidth:e.contentWidth,textBlock:u()(e),blockManager:e.blockManager,visible:n}):null},e.onMouseEnter=function(){e.setState({isMouseEntered:!0})},e.onMouseLeave=function(){e.setState({isMouseEntered:!1,isCursorInCheckBox:!1})},e.cursorInCheckBox=function(e){var n,r,o=e.target;if(!o)return!1;var i=o.firstChild;if(!i)return!1;var c=(null===(n=(r=i).getBoundingClientRect)||void 0===n?void 0:n.call(r))||i.parentNode.getBoundingClientRect(),a=c.left,l=c.top,s=[c.left-8-8,c.top+8],u=10.4;a=s[0]+u;var d=s[0]-u;l=s[1]-u;var f=s[1]+u,h=e.clientX,p=e.clientY;return h>=d&&h<=a&&p<=f&&p>=l},e.handleMouseDown=function(n){e.cursorInCheckBox(n)&&n.preventDefault()},e}return l()(r,[{key:"blockViewDidMount",value:function(){var e,n,o;f()(y()(r.prototype),"blockViewDidMount",this).call(this),null===(e=this.contentRef.current)||void 0===e||e.addEventListener("mouseenter",this.onMouseEnter),null===(n=this.contentRef.current)||void 0===n||n.addEventListener("mouseleave",this.onMouseLeave),null===(o=this.contentRef.current)||void 0===o||o.addEventListener("mousemove",this.onMouseMove),this.editor.on(m.L.FOCUS,this.onFocus),this.editor.on(m.L.BLUR,this.onBlur),this.editor.on(m.L.CONTENT_WILL_CHANGE,this.handleContentWillChange,{zoneId:this.model.zoneId}),this.model.isDone&&this.applyLineThroughMark(this.model.isDone)}},{key:"blockViewWillUnmount",value:function(){var e,n,o;f()(y()(r.prototype),"blockViewWillUnmount",this).call(this),null===(e=this.contentRef.current)||void 0===e||e.removeEventListener("mouseenter",this.onMouseEnter),null===(n=this.contentRef.current)||void 0===n||n.removeEventListener("mouseleave",this.onMouseLeave),null===(o=this.contentRef.current)||void 0===o||o.removeEventListener("mousemove",this.onMouseMove),this.editor.off(m.L.FOCUS,this.onFocus),this.editor.off(m.L.BLUR,this.onBlur),this.editor.off(m.L.CONTENT_WILL_CHANGE,this.handleContentWillChange)}},{key:"blockViewDidUpdate",value:function(e,n){f()(y()(r.prototype),"blockViewDidUpdate",this).call(this,e,n),!!e.record.snapshot.done!==this.model.isDone&&this.applyLineThroughMark(this.model.isDone)}},{key:"applyLineThroughMark",value:function(e){var n=this.model.zoneState,r={line:0,offset:0,zoneId:n.getZoneId()},i=P(P({},n.offsetToPoint(n.totalWidth())),{},{zoneId:n.getZoneId()});e?this.model.setAttributes({start:r,end:i},o()({},R.z,"true"),{extra:{shouldCollab:!1}}):this.model.setAttributes({start:r,end:i},o()({},R.z,""),{extra:{shouldCollab:!1}})}},{key:"isEmptyText",value:function(e){return 0===e.text.initialAttributedTexts.text[0].length}},{key:"render",value:function(){var e=!1,n=(Object(j.R)(),O()({"todo-block_hover_checkbox":this.state.isCursorInCheckBox&&this.editable,"todo-block":!0,"task-done":this.model.isDone,"todo-block_focus":this.state.isFocus,"todo-block_content_editable":this.editable,"todo-block_new":e,"todo-block_new_square":e,"todo-block_old":!0}));return E.a.createElement(E.a.Fragment,null,E.a.createElement("div",{className:n,ref:this.contentRef},E.a.createElement("div",{className:"todo-block_content todo-align-".concat(this.model.snapshot.align||"left"),onClick:this.handleClickIcon,onMouseDown:this.handleMouseDown},f()(y()(r.prototype),"render",this).call(this)),E.a.createElement("div",null,this.renderExtensions())),this.model.children.length>0?E.a.createElement("div",{style:{paddingLeft:S.X-B.s-B.t,marginLeft:B.s},className:"list-children"},this.renderChildren()):null)}},{key:"placeholder",get:function(){return Object(w.Q)()?"":t("reminder.line.placeholder")}},{key:"contentElement",get:function(){return this.contentRef.current}},{key:"contentWidth",get:function(){var e;return null===(e=this.contentRef.current)||void 0===e?void 0:e.clientWidth}}]),r}(T.S)}).call(this,r("dx_E9Eu"))},dx_l3l3:function(e,n,r){},dx_l4lV:function(e,n,r){"use strict";(function(t){var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_iWIM"),l=r.n(a),s=r("dx_W7W2"),u=r.n(s),d=r("dx_a1gu"),f=r.n(d),h=r("dx_Nsbk"),p=r.n(h),v=r("dx_UtDZ"),g=r("dx_h6a8"),b=r("dx_cDcd"),y=r.n(b),m=r("dx_bdgK"),_=r("dx_H0Hj"),k=r("dx_zEdG"),O=r("dx_B28d"),x=r("dx_MGoZ"),E=r("dx_Ap6o");function S(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=p()(e);if(n){var i=p()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return f()(this,r)}}var C;!function(e){e.ROW="row",e.COLUMN="column"}(C||(C={}));var I=function(e){u()(r,e);var n=S(r);function r(e){var i;return o()(this,r),(i=n.call(this,e)).resizeObserver=void 0,i.initResizeObserver=function(){var e=i.hostElement;e&&(i.resizeObserver||(i.resizeObserver=new m.S(i.handleResize)),i.resizeObserver.observe(e))},i.handleResize=Object(g.throttle)((function(){i.calcDisplayType()}),100),i.handleClick=function(e){Object(k.P)("ccm_doc_content_page_click",{record_id:i.record.id,block_type:i.type},{click:"block_custom_action",action_type:"click_bookmark",target:"none"}),Object(_.w)(i.snapshot.bookmark.url,e,!1)},i.state={shouldLoadCover:!1,display:C.ROW},i}return c()(r,[{key:"blockViewDidMount",value:function(){l()(p()(r.prototype),"blockViewDidMount",this).call(this),this.calcDisplayType(),this.blockManager.layoutManager.isBlockInViewport(this.id)&&this.initResizeObserver()}},{key:"blockViewWillUnmount",value:function(){l()(p()(r.prototype),"blockViewWillUnmount",this).call(this),this.disconnectResizeObserver()}},{key:"enterBuffer",value:function(){this.setState({shouldLoadCover:!0})}},{key:"enterViewport",value:function(){this.setState({shouldLoadCover:!0}),this.initResizeObserver()}},{key:"leaveViewport",value:function(){this.disconnectResizeObserver()}},{key:"disconnectResizeObserver",value:function(){this.resizeObserver&&this.resizeObserver.disconnect()}},{key:"calcDisplayType",value:function(){var e,n=null===(e=this.hostElement)||void 0===e?void 0:e.getBoundingClientRect();if(null===n||void 0===n?void 0:n.width){var r=n.width,o=this.state.display,i=r>288?C.ROW:C.COLUMN;i!==o&&this.setState({display:i})}}},{key:"renderLoading",value:function(e){return y.a.createElement(v.WithBeforeUnloadReminder,{history:v.history,hasUnSaveData:function(){return!0},getUnSaveTip:function(){return t("CreationDoc_Docs_WebCardLoading_LeaveSubtitle")}},y.a.createElement(E.X,{url:e}))}},{key:"renderCard",value:function(){var e=this.snapshot.bookmark;return y.a.createElement(E.x,Object.assign({},e,{onClick:this.handleClick,shouldShowCover:Boolean(!this.isShortcut&&!this.isPDF&&e.cover_url),shouldLoadCover:this.state.shouldLoadCover,display:this.state.display}))}},{key:"renderContent",value:function(){var e=this.snapshot.bookmark,n=e.title,r=e.url;return this.isSSR?y.a.createElement(E.X,{url:r}):n?y.a.createElement(y.a.Fragment,null,this.renderCard()):y.a.createElement(y.a.Fragment,null,this.renderLoading(r))}},{key:"render",value:function(){return y.a.createElement("div",{className:"docx-bookmark-wrapper",style:{boxShadow:this.borderColor?"0 0 0 1px ".concat(this.borderColor):void 0}},y.a.createElement("div",{className:"docx-bookmark-content"},this.renderContent()))}},{key:"isPDF",get:function(){return!0===this.props.recursionProps.isPDF}},{key:"isShortcut",get:function(){return!0===this.props.recursionProps.isShortcut}},{key:"isSSR",get:function(){return!0===this.props.recursionProps.isSSR}},{key:"borderColor",get:function(){var e=this.props,n=e.syncCursorSelected,r=e.syncCursorBorderColor;return n?r:void 0}}]),r}(x.l);I.type=O.B.BOOKMARK,n.S=I}).call(this,r("dx_E9Eu"))},dx_l6hu:function(e,n,r){"use strict";r.d(n,"i",(function(){return l}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_I11I"),a=r("dx_FHaN");function l(e){if(e.model.isDestroyed)return!1;var n=e.model.getSelection();return!!n&&!e.model.getAttributes(n.start,n.end).some((function(e){var n=i()(e,1)[0];return[a.O,c.B,"equation"].includes(n)}))}},dx_l6la:function(e,n,r){"use strict";r.d(n,"Y",(function(){return i.Y})),r.d(n,"Y5",(function(){return i.Y5})),r.d(n,"N",(function(){return c})),r.d(n,"M",(function(){return a})),r.d(n,"R",(function(){return l})),r.d(n,"vn",(function(){return s})),r.d(n,"k",(function(){return u})),r.d(n,"v",(function(){return d})),r.d(n,"d",(function(){return f})),r.d(n,"w",(function(){return h})),r.d(n,"q",(function(){return p})),r.d(n,"e",(function(){return v})),r.d(n,"vu",(function(){return g})),r.d(n,"s",(function(){return b})),r.d(n,"m",(function(){return y}));var o=r("dx_Uh2b"),i=r("dx_A3AG");function c(e){return{type:o.R.SetCoverInfo,payload:e||null}}function a(){return{type:o.R.UploadCoverStart}}function l(){return{type:o.R.UploadCoverFail}}function s(){return{type:o.R.UploadCoverCancel}}function u(e){return{type:o.R.SetCoverList,payload:e}}var d=function(e){return{type:o.R.SelectBidirectionalLinkListTab,payload:e}},f=function(e){return{type:o.R.UpdateBidirectionalLinkListCount,payload:e}},h=function(){return{type:o.R.KeepBidirectionalLinkListShowing,payload:void 0}},p=function(){return{type:o.R.ResetBidirectionalLinkList,payload:void 0}},v=function(e){return{type:o.R.UpdateBidirectionalLinkListVisibilitySetting,payload:e}},g=function(e){return{type:o.R.UpdateBidirectionalRefLinkList,payload:e}};function b(e){return{type:o.R.SetPageToken,payload:e}}function y(e){return{type:o.R.SetIsFirstLineEmpty,payload:e}}},dx_l6li:function(e,n,r){"use strict";r.d(n,"V",(function(){return Ce}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_PJYZ"),h=r.n(f),p=r("dx_W7W2"),v=r.n(p),g=r("dx_a1gu"),b=r.n(g),y=r("dx_Nsbk"),m=r.n(y),_=r("dx_QxNg"),k=r("dx_cDcd"),O=r.n(k),x=r("dx_x1WV"),E=r("dx_Xdvu");function S(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var C,I,B,T,w,R,M,j,D,A,P,L=function(e){v()(r,e);var n=S(r);function r(){var e;s()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).container=null,e.inited=!1,e.setContainerRef=function(n){e.container=n,n&&!e.inited&&e.init()},e.editor=void 0,e.handleEditorMounted=function(){var n={blockManager:e.blockManager,fold:e.fold};e.props.onMount&&e.props.onMount(n);var r=h()(e).blockManager;r&&e.props.onError&&r.on(_.Ra.ERROR,e.props.onError)},e}return d()(r,[{key:"componentWillUnmount",value:function(){var e={blockManager:this.blockManager,fold:this.fold};this.props.onUnmount&&this.props.onUnmount(e);var n=this.blockManager;n&&this.props.onError&&n.off(_.Ra.ERROR,this.props.onError),this.editor&&(this.editor.destroy(),this.editor=null)}},{key:"init",value:function(){var e=a()(i.a.mark((function e(){var n,r=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.props.createDocxEditor(this.container),this.editor=n,n.api.lifecycle.editorDidMount$.subscribe(this.handleEditorMounted),n.api.modelService.initialDataReady$.subscribe((function(){n.mount(r.container)}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return O.a.createElement("div",{ref:this.setContainerRef,className:"page-preview-container",style:{position:"relative"}})}},{key:"blockManager",get:function(){var e;return null===(e=this.editor)||void 0===e?void 0:e.api.getService(x.a)}},{key:"editorContext",get:function(){var e;return null===(e=this.editor)||void 0===e?void 0:e.api.getService(E.a)}},{key:"fold",get:function(){var e;return null===(e=this.editorContext)||void 0===e?void 0:e.fold}}]),r}(O.a.Component),N=r("dx_RIqP"),F=r.n(N),U=r("dx_lSNA"),H=r.n(U),V=r("dx_Vvd7"),W=r("dx_UtDZ"),z=r("dx_Yrx2"),G=r("dx_xlCA"),K=r("dx_I05X"),q=r("dx_yzqx"),X=r("dx_f650"),Y=r("dx_jBAU"),J=r("dx_mKvd"),Z=r("dx_T3tg"),Q=r("dx_Kkjd"),$=r("dx_g14w"),ee=r("dx_yG8O"),te=r.n(ee),ne=r("dx_Uyc2"),re=r.n(ne),oe=(r("dx_A1AB"),r("dx_xjz2")),ie=r("dx_C7Cb"),ce=r("dx_B28d"),ae=r("dx_FP3m"),le=r("dx_hSCS"),se=r("dx_ppc6"),ue=r("dx_uOSm"),de=r("dx_e46e"),fe=r("dx_G2Gn"),he=r("dx_Je9X"),pe=r("dx_MP54"),ve=r("dx_e6eH"),ge=r("dx_qZ2L"),be=r("dx_hD2y"),ye=r("dx_eyH3"),me=r("dx_vira"),_e=Object(oe.s)(E.a)((I=function(){function e(){var n=this;s()(this,e),this.getIsMobileEditMode=void 0,this.fold=void 0,this.coverModule=void 0,this.blockitModule=void 0,this.autoExpandCellModule=void 0,this.blockViewportAdapter=void 0,this.viewport=void 0,this.headingModule=void 0,this.layout=void 0,te()(this,"selectionAPI",B,this),te()(this,"config",T,this),te()(this,"blockManager",w,this),te()(this,"rect",R,this),te()(this,"eventEmitter",M,this),this.vcKey=void 0,this.uuid=Object(ie.S)(),this.getOrderMode=function(){var e=n.config;return!e.get("isPDF")&&e.get("isShortcut")?ye.l.SHORTCUT:e.get("isPDF")?ye.l.PDF:ye.l.PREVIEW}}return d()(e,[{key:"init",value:function(e){var n=e.getIsMobileEditMode;this.getIsMobileEditMode=n;var r=this.config,o=this.blockManager,i=r.get("container");this.fold=new pe.S(o),this.selectionAPI.init({getContentContainer:function(){return i},boundaryAreaContainer:r.get("boundary"),selectionAreaContainer:document.body,unSelectableType:[ce.B.SELECTION,ce.B.GRID,ce.B.GRID_COLUMN,ce.B.VIEW]},this.fold),r.get("isPreview")||(this.coverModule=new he.S({blockManager:o,pageToken:r.get("token"),editable:r.get("editable"),selectionAPI:this.selectionAPI})),this.viewport=new me.o({container:r.get("boundary"),selectionAPI:this.selectionAPI,fold:this.fold,rect:this.rect,blockManager:o,eventEmitter:this.eventEmitter}),this.vcKey={token:r.get("token")},this.blockitModule=fe.S.creatorBlockitModule("".concat(this.vcKey.token,"_").concat(this.uuid),o),this.autoExpandCellModule=new ue.S(this.blockManager),this.blockViewportAdapter=new de.S({blockManager:this.blockManager}),this.headingModule=new ve.a({blockManager:this.blockManager,eventEmitter:this.eventEmitter,env:this.getOrderMode()}),this.layout=new ge.S({catalogue:new be.S,content:new be.S,comment:new be.S,editor:new be.S((function(){return i}))})}},{key:"toPlainObject",value:function(){return{selectionAPI:this.selectionAPI,blockManager:this.blockManager,boundary:this.boundary,fold:this.fold,editable:this.editable,editPermission:this.editPermission,isMobileEditMode:this.isMobileEditMode,copyable:this.copyable,exportable:this.exportable,scroller:this.scroller,rect:this.rect,eventEmitter:this.eventEmitter,layout:this.layout,container:this.container,viewport:this.viewport,tokenFromWiki:this.config.get("tokenFromWiki"),blockViewportAdapter:this.blockViewportAdapter,headingModule:this.headingModule}}},{key:"destroy",value:function(){this.fold.destroy(),this.viewport.destroy(),this.blockViewportAdapter.destroy(),this.headingModule.destroy(),fe.S.destroyBlockitModule(this.blockitModule,"".concat(this.vcKey.token,"_").concat(this.uuid)),this.autoExpandCellModule.destroy()}},{key:"isMobileEditMode",get:function(){var e,n;return null!==(e=null===(n=this.getIsMobileEditMode)||void 0===n?void 0:n.call(this))&&void 0!==e&&e}},{key:"boundary",get:function(){return this.config.get("boundary")}},{key:"scroller",get:function(){return this.config.get("scroller")}},{key:"container",get:function(){return this.config.get("container")}},{key:"editable",get:function(){return this.config.get("editable")}},{key:"editPermission",get:function(){return this.config.get("editPermission")}},{key:"copyable",get:function(){return this.config.get("copyable")}},{key:"exportable",get:function(){return this.config.get("exportable")}}]),e}(),B=re()(I.prototype,"selectionAPI",[se.S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),T=re()(I.prototype,"config",[V.j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),w=re()(I.prototype,"blockManager",[x.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=re()(I.prototype,"rect",[ae.z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),M=re()(I.prototype,"eventEmitter",[le.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),C=I))||C;function ke(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var Oe=Object(V.H)({providers:[_e]})((P=function(e){v()(r,e);var n=ke(r);function r(){var e;s()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),te()(e,"context",A,h()(e)),e}return d()(r,[{key:"init",value:function(){this.context.init(this.options)}},{key:"destroy",value:function(){this.context.destroy()}}]),r}(V.G),D=P,A=re()(D.prototype,"context",[E.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),j=D))||j;function xe(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Ee(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?xe(Object(r),!0).forEach((function(n){H()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xe(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Se(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var Ce=function(e){v()(r,e);var n=Se(r);function r(e){var o;return s()(this,r),(o=n.call(this,e)).editor=void 0,o.reactReduxContext=void 0,o.isUnmounted=!1,o.state={fetchError:!1,fetchLoading:!0,clientVars:null,headingClientVars:null,coverInfo:null},o.onMount=function(e){o.props.onMount&&o.props.onMount(e);var n=o.getCoverInfo(e.blockManager);o.setState({coverInfo:n})},o.onUnmount=function(e){o.props.onUnmount&&o.props.onUnmount(e)},o.createDocxEditor=function(e){var n,r=o.props.recursionProps,i=Object(z.U)({config:Ee({container:e,boundary:e,token:o.props.token,editable:!1,editPermission:!1,preview:!0,getEditable:function(){return!1},scroller:o.getScrollerForLayoutManager()},r),rendererOptions:{BlockContextProvider:function(e){return Object(X.I)(o.reactReduxContext,e)},layoutConfig:{scroller:o.getScrollerForLayoutManager(),enableVirtualRender:null!==(n=o.props.enableVirtualRender)&&void 0!==n&&n,enableIdleWorker:!1,errorFrom:"recordRenderer"}},modules:[Object(V.Y)(Oe,{getIsMobileEditMode:function(){return!1}})].concat(F()(o.props.getEditorModules()))});o.editor=i;var c=o.editor.api.getService(Z.e);return c.token=o.state.clientVars.id,Promise.resolve().then((function(){if(!o.isUnmounted){var e=o.state.headingClientVars;i.api.lifecycle.editorWillMount$.subscribe((function(){var n=i.api.getService(E.a).headingModule;n&&n.initOrderFromClientvars(e,e.id)}));var n=o.state.clientVars;c.add(n.id,Q.J.NORMAL,n,!0)}})),i},o.onUnmount=o.onUnmount.bind(h()(o)),o}return d()(r,[{key:"componentDidMount",value:function(){this.fetchPage()}},{key:"componentWillUnmount",value:function(){this.isUnmounted=!0}},{key:"fetchPage",value:function(){var e=a()(i.a.mark((function e(){var n,r,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.setState({fetchLoading:!0}),n=this.props.token,e.next=5,Y.S.fetchClientVars({token:n,canUseCache:this.props.canUseCache});case 5:r=e.sent,o=r.data,c=o,this.props.recursionProps.isNeedToBlock&&(o=Object(J.L)(o)),G.n.applyClientVar(o),this.setState({fetchLoading:!1,fetchError:!1,clientVars:o,headingClientVars:c}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),this.setState({fetchLoading:!1,fetchError:!0,coverInfo:null}),this.props.onFetchError&&this.props.onFetchError(e.t0);case 18:case"end":return e.stop()}}),e,this,[[0,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"getScrollerForLayoutManager",value:function(){var e,n,r=this.props.scroller;return q.S.isMobile&&q.S.isLark?window:r?"string"===typeof r?null!==(e=document.querySelector(r))&&void 0!==e?e:window:null!==(n=r.current)&&void 0!==n?n:window:window}},{key:"getCoverInfo",value:function(e){var n,r=e.getBlockModelByBlockId(e.getRootBlockId()).record.snapshot.cover;return r&&r.type?(n={type:r.type,offset_ratio_x:r.offset_ratio_x,offset_ratio_y:r.offset_ratio_y},H()(n,Object($.o)(r.type),Object($.q)(r)),H()(n,"src",Object($.I)(r)),H()(n,"lightSrc",Object($.H)(r)),H()(n,"mime_type",r.mime_type),H()(n,"status",r.status),n):null}},{key:"render",value:function(){var e=this;return O.a.createElement(X.l,{store:W.store},(function(n){if(e.reactReduxContext=n,!e.state.fetchLoading&&!e.state.fetchError)return O.a.createElement(O.a.Fragment,null,e.props.recursionProps.isPreview&&O.a.createElement(K.S,{coverInfo:e.state.coverInfo}),O.a.createElement(L,{onError:e.props.onError,onMount:e.onMount,onUnmount:e.onUnmount,createDocxEditor:e.createDocxEditor}))}))}},{key:"blockManager",get:function(){var e;return null===(e=this.editor)||void 0===e?void 0:e.api.getService(x.a)}}]),r}(O.a.Component)},dx_l6lq:function(e,n,r){"use strict";r.d(n,"h",(function(){return C})),r.d(n,"A",(function(){return I})),r.d(n,"B",(function(){return B}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_C7Cb"),s=r("dx_ADkB"),u=r("dx_xs2W"),d=r("dx_B28d"),f=r("dx_hMKL"),h=r("dx_WKxm"),p=r("dx_u6uu"),v=r("dx_IdzY"),g=r("dx_cQo6"),b=r("dx_bkVC"),y=r("dx_UTG8"),m=r("dx_XlRC"),_=r("dx_Y27Y"),k=["application/x-editor-kit-business-key","application/x-editor-kit-fragment","application/x-vnd.google-docs-document-slice-clip+wrapped","text/_notion-page-source-production","text/_notion-text-production"];function O(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function x(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?O(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function E(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return S(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function S(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function C(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments.length>4?arguments[4]:void 0,u=function(e){return Object(g.Z)(e,o,i)},b=[],k=!0,O=E(e.entries());try{var S=function(){var g,_=a()(r.value,2),O=_[0],E=_[1],S=E.children,I=void 0===S?[]:S,B=E.data,w=void 0===B?{}:B,R=E.payload,M=E.context,j=Object(l.S)();(i[j]=x({},R),i[j].usedToBeQuote=!!E.context.usedToBeQuote,i[j].isWhiteSpacePre=E.context.isWhiteSpacePre,w.type!==d.B.IFRAME||Object(s.k)(w))||(w.type=d.B.TEXT,w.nodes=[{text:null===(g=w)||void 0===g?void 0:g.original_text,type:v.B.PLAINTEXT}]);if(w.reference&&k){if(j=w.reference.id,o[j])return"continue";I=[]}else if(w.type===d.B.TABLE)for(var D=w.cell_set,A=0,P=Object.keys(D);A<P.length;A++){var L=P[A],N=D[L],F=N.children,U=N.merge_info,H=C(F,n,o,i,c).recordIds;o[L]={id:L,snapshot:{children:H,type:d.B.CELL}},D[L]={block_id:L,merge_info:U}}else if(Object(s.k)(w)){var V=w.original_text,W=Object(s.k)(w),z=W===p.C.xigua||W===p.C.tiktok?"":void 0,G=Object(h.V)(V,{url:z,type:W});R.scale&&(G.iframe.height=G.iframe.original_height*R.scale,G.iframe.width=G.iframe.original_width*R.scale,G.iframe.is_modified=!0),w=Object(f.F)(G)}else if(Array.isArray(w.nodes)){if(w.type===d.B.ORDERED){var K=E.context,q=K.orderedListNumber,X=K.orderedListId,Y=e.slice(0,O).find((function(e){return e.context.orderedListId===X})),J=e[O-1]&&e[O-1].data.type===d.B.ORDERED;w.seq=Object(m.C)(q)?String(q):"auto","fake"===X?w.seq=J?"auto":"1":Y&&(w.seq="auto")}var Z=w.nodes.map((function(e){var n=e.text;return n=M.isWhiteSpacePre||T(E.node,"pre")?n.replace(/\r/g," "):n.replace(/\r\n/g," ").replace(/\r|\n/g," "),e.text=n,e.text=e.text.replace(/[\t]+/g," ").replace(/[\u200b-\u200f\uFEFF\u202a-\u202e]/g,""),e})),Q=Z.reduce((function(e,n){return e+n.text}),"").replace(/(\n+$)|(^\n)/g,"").normalize();w.text="\n"===Q?y.InputPipe.deserializePlainText(""):y.InputPipe.deserialize({nodes:Z,alltext:Q,size:Q.length}),Z.forEach((function(e){e.inlineblock&&u(e.inlineblock)})),delete w.nodes,M.indentLevel&&(w.text_indent=1),M.align&&(w.align=M.align)}if(!w.type)return console.warn("ignore data without type, data=",w),"continue";var $=w;if(I.length){var ee=C(I,n,o,i,c).recordIds;$=x(x({},$),{},{children:ee})}o[j]={snapshot:$,id:j},b.push(j)};for(O.s();!(r=O.n()).done;)S()}catch(I){O.e(I)}finally{O.f()}return{recordIds:b,recordMap:o,payloadMap:i,rootId:c,source:_.L.HTML}}function I(e){var n=e.getData(_.L.TEXT);if(!Object(u.t)(n))return!1;var r=e.getData(_.L.HTML),o=(new DOMParser).parseFromString(r,"text/html");return 1===o.body.childElementCount&&o.body.children[0]&&"A"===o.body.children[0].tagName?o.body.children[0].href===n:o.body.innerHTML.trim()===n}function B(e,n){var r={},o=k.some((function(e){return n.includes(e)})),i=Object(b.h)();return(o||i.from===d.G.innerCopyPaste||i.from===d.G.innerCutPaste||/microsoft/i.test(e.documentElement.innerHTML))&&(r.supportStyle=!0),r}function T(e,n){return!!e&&(!!e.nodeName.toLowerCase().includes(n)||T(e.parentNode,n))}},dx_l7lm:function(e,n,r){"use strict";r.d(n,"q",(function(){return u}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r("dx_XW5M"),l=r("dx_IvU4"),s=r("dx_D8nn"),u=function(e){var n=e.commentable,r=Object(c.useState)(void 0),o=i()(r,2),u=o[0],d=o[1];Object(c.useEffect)((function(){n!==u&&d(!1!==n&&void 0)}),[n]);var f=Object(c.useCallback)((function(){if(!1!==n){var e=l.S.getPanelStatus(a.t.TextualToolbar);d(!e&&void 0)}}),[n]);return Object(c.useEffect)((function(){return s.S.on(s.p.COMMON.FORCE_UPDATE_BLOCK_MENU_TOOLBAR_STATUS,f),function(){s.S.off(s.p.COMMON.FORCE_UPDATE_BLOCK_MENU_TOOLBAR_STATUS,f)}}),[f]),{commentVisible:u,checkCommentToolbarShow:f}}},dx_l8lP:function(e,n,r){"use strict";r.d(n,"j",(function(){return f})),r.d(n,"L",(function(){return h})),r.d(n,"Lo",(function(){return p})),r.d(n,"Z",(function(){return b}));var o,i,c,a,l,s=r("dx_lSNA"),u=r.n(s),d=r("dx_Lqhf"),f={COLOR_PINK_LIGHT_BACKGROUND:"COLOR_PINK_LIGHT_BACKGROUND",COLOR_ORANGE_LIGHT_BACKGROUND:"COLOR_ORANGE_LIGHT_BACKGROUND",COLOR_YELLOW_LIGHT_BACKGROUND:"COLOR_YELLOW_LIGHT_BACKGROUND",COLOR_GREEN_LIGHT_BACKGROUND:"COLOR_GREEN_LIGHT_BACKGROUND",COLOR_BLUE_LIGHT_BACKGROUND:"COLOR_BLUE_LIGHT_BACKGROUND",COLOR_PURPLE_LIGHT_BACKGROUND:"COLOR_PURPLE_LIGHT_BACKGROUND",COLOR_GRAY_LIGHT_BACKGROUND:"COLOR_GRAY_LIGHT_BACKGROUND",COLOR_GRAY_SLIGHT_BACKGROUND:"COLOR_GRAY_SLIGHT_BACKGROUND",COLOR_PINK_DARK_BACKGROUND:"COLOR_PINK_DARK_BACKGROUND",COLOR_ORANGE_DARK_BACKGROUND:"COLOR_ORANGE_DARK_BACKGROUND",COLOR_YELLOW_DARK_BACKGROUND:"COLOR_YELLOW_DARK_BACKGROUND",COLOR_GREEN_DARK_BACKGROUND:"COLOR_GREEN_DARK_BACKGROUND",COLOR_BLUE_DARK_BACKGROUND:"COLOR_BLUE_DARK_BACKGROUND",COLOR_PURPLE_DARK_BACKGROUND:"COLOR_PURPLE_DARK_BACKGROUND",COLOR_GRAY_DARK_BACKGROUND:"COLOR_GRAY_DARK_BACKGROUND",COLOR_DEFAULT_BACKGROUND:"COLOR_DEFAULT_BACKGROUND",COLOR_PINK_TEXT:"COLOR_PINK_TEXT",COLOR_ORANGE_TEXT:"COLOR_ORANGE_TEXT",COLOR_YELLOW_TEXT:"COLOR_YELLOW_TEXT",COLOR_GREEN_TEXT:"COLOR_GREEN_TEXT",COLOR_BLUE_TEXT:"COLOR_BLUE_TEXT",COLOR_PURPLE_TEXT:"COLOR_PURPLE_TEXT",COLOR_GRAY_TEXT:"COLOR_GRAY_TEXT",COLOR_DEFAULT_TEXT:"COLOR_DEFAULT_TEXT",COLOR_CLEAR:"COLOR_CLEAR"},h=(o={},u()(o,f.COLOR_DEFAULT_BACKGROUND,"bg-float"),u()(o,f.COLOR_GRAY_LIGHT_BACKGROUND,"ccmtoken-doc-highlightcolor-neutral-soft"),u()(o,f.COLOR_PINK_LIGHT_BACKGROUND,"ccmtoken-doc-highlightcolor-red-soft"),u()(o,f.COLOR_ORANGE_LIGHT_BACKGROUND,"ccmtoken-doc-highlightcolor-orange-soft"),u()(o,f.COLOR_YELLOW_LIGHT_BACKGROUND,"ccmtoken-doc-highlightcolor-sunflower-soft"),u()(o,f.COLOR_GREEN_LIGHT_BACKGROUND,"ccmtoken-doc-highlightcolor-green-soft"),u()(o,f.COLOR_BLUE_LIGHT_BACKGROUND,"ccmtoken-doc-highlightcolor-blue-soft"),u()(o,f.COLOR_PURPLE_LIGHT_BACKGROUND,"ccmtoken-doc-highlightcolor-purple-soft"),u()(o,f.COLOR_GRAY_SLIGHT_BACKGROUND,"ccmtoken-doc-highlightcolor-neutral-light"),u()(o,f.COLOR_GRAY_DARK_BACKGROUND,"ccmtoken-doc-highlightcolor-neutral-solid"),u()(o,f.COLOR_PINK_DARK_BACKGROUND,"ccmtoken-doc-highlightcolor-red-solid"),u()(o,f.COLOR_ORANGE_DARK_BACKGROUND,"ccmtoken-doc-highlightcolor-orange-solid"),u()(o,f.COLOR_YELLOW_DARK_BACKGROUND,"ccmtoken-doc-highlightcolor-sunflower-solid"),u()(o,f.COLOR_GREEN_DARK_BACKGROUND,"ccmtoken-doc-highlightcolor-green-solid"),u()(o,f.COLOR_BLUE_DARK_BACKGROUND,"ccmtoken-doc-highlightcolor-blue-solid"),u()(o,f.COLOR_PURPLE_DARK_BACKGROUND,"ccmtoken-doc-highlightcolor-purple-solid"),o),p=(i={},u()(i,f.COLOR_DEFAULT_TEXT,"text-title"),u()(i,f.COLOR_GRAY_TEXT,"N500"),u()(i,f.COLOR_PINK_TEXT,"R600"),u()(i,f.COLOR_ORANGE_TEXT,"O600"),u()(i,f.COLOR_YELLOW_TEXT,"Y600"),u()(i,f.COLOR_GREEN_TEXT,"G600"),u()(i,f.COLOR_BLUE_TEXT,"B600"),u()(i,f.COLOR_PURPLE_TEXT,"P600"),i),v=(c={},u()(c,f.COLOR_DEFAULT_BACKGROUND,"default"),u()(c,f.COLOR_GRAY_LIGHT_BACKGROUND,"gray-light-bg"),u()(c,f.COLOR_PINK_LIGHT_BACKGROUND,"pink-light-bg"),u()(c,f.COLOR_ORANGE_LIGHT_BACKGROUND,"orange-light-bg"),u()(c,f.COLOR_YELLOW_LIGHT_BACKGROUND,"yellow-light-bg"),u()(c,f.COLOR_GREEN_LIGHT_BACKGROUND,"green-light-bg"),u()(c,f.COLOR_BLUE_LIGHT_BACKGROUND,"blue-light-bg"),u()(c,f.COLOR_PURPLE_LIGHT_BACKGROUND,"purple-light-bg"),u()(c,f.COLOR_GRAY_SLIGHT_BACKGROUND,"gray-slight-bg"),u()(c,f.COLOR_GRAY_DARK_BACKGROUND,"gray-dark-bg"),u()(c,f.COLOR_PINK_DARK_BACKGROUND,"pink-dark-bg"),u()(c,f.COLOR_ORANGE_DARK_BACKGROUND,"orange-dark-bg"),u()(c,f.COLOR_YELLOW_DARK_BACKGROUND,"yellow-dark-bg"),u()(c,f.COLOR_GREEN_DARK_BACKGROUND,"green-dark-bg"),u()(c,f.COLOR_BLUE_DARK_BACKGROUND,"blue-dark-bg"),u()(c,f.COLOR_PURPLE_DARK_BACKGROUND,"purple-dark-bg"),c),g=(a={},u()(a,f.COLOR_DEFAULT_TEXT,"default"),u()(a,f.COLOR_PINK_TEXT,"pink-text"),u()(a,f.COLOR_ORANGE_TEXT,"orange-text"),u()(a,f.COLOR_YELLOW_TEXT,"yellow-text"),u()(a,f.COLOR_GREEN_TEXT,"green-text"),u()(a,f.COLOR_BLUE_TEXT,"blue-text"),u()(a,f.COLOR_PURPLE_TEXT,"purple-text"),u()(a,f.COLOR_GRAY_TEXT,"gray-text"),a),b=(l={},u()(l,d.D.Text,g),u()(l,d.D.Background,v),l)},dx_l8lr:function(e,n,r){"use strict";r.d(n,"y",(function(){return W}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W7W2"),a=r.n(c),l=r("dx_a1gu"),s=r.n(l),u=r("dx_Nsbk"),d=r.n(u),f=r("dx_B28d"),h=r("dx_KHvq");function p(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var v=function(e){a()(r,e);var n=p(r);function r(){return i()(this,r),n.apply(this,arguments)}return r}(h.H);v.type=f.B.QUOTE;var g=r("dx_W8MJ"),b=r.n(g),y=r("dx_Vvd7"),m=r("dx_n4v0"),_=r("dx_N9dL"),k=r("dx_fEKD"),O=r("dx_L0LN"),x=r("dx_QxNg");function E(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var S=function(e){a()(r,e);var n=E(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).sub=void 0,e.handleTransaction=function(n){n.options.from===x.H.local&&(e.record.snapshot.children.length||e.modelService.applyTransaction("QuoteContainerRemoveSelf",(function(n){var r,o=null===(r=e.parent)||void 0===r?void 0:r.recordId;o&&n.removeChildren(o,[e.record.id])})))},e}return b()(r,[{key:"onInit",value:function(){this.sub=this.modelService.change$.subscribe(this.handleTransaction)}},{key:"onDestroy",value:function(){var e;null===(e=this.sub)||void 0===e||e.unsubscribe()}}]),r}(r("dx_NMQJ").D);S.type=f.B.QUOTE_CONTAINER;var C,I=r("dx_xjz2"),B=r("dx_tt0H"),T=r("dx_JXmB"),w=Object(I.s)(B.U)(C=function e(){i()(this,e),this.blockType=f.B.QUOTE_CONTAINER,this.checkFunc=T.M})||C,R=r("dx_iWIM"),M=r.n(R),j=r("dx_cDcd"),D=r.n(j),A=r("dx_rQGm");r("dx_j8ww");function P(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var L=function(e){a()(r,e);var n=P(r);function r(){return i()(this,r),n.apply(this,arguments)}return b()(r,[{key:"render",value:function(){var e=this.renderChildren();return D.a.createElement("div",{className:"quote-block"},M()(d()(r.prototype),"render",this).call(this),e?D.a.createElement("div",{style:{paddingLeft:A.X},className:"text-children"},e):null)}}]),r}(h.N),N=r("dx_MGoZ");r("dx_TqzH");function F(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var U,H=function(e){a()(r,e);var n=F(r);function r(){return i()(this,r),n.apply(this,arguments)}return b()(r,[{key:"blockViewDidMount",value:function(){M()(d()(r.prototype),"blockViewDidMount",this).call(this)}},{key:"blockViewWillUnmount",value:function(){M()(d()(r.prototype),"blockViewWillUnmount",this).call(this)}},{key:"render",value:function(){return D.a.createElement("div",{className:"quote-container-block"},D.a.createElement("div",{className:"quote-container-block-children"},this.renderChildren({className:"quote-container-render-unit"})))}}]),r}(N.l);function V(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var W=Object(y.H)({providers:[w,{provide:_.RecordSnapshotCreator,useValue:{type:f.B.QUOTE,create:m.D}},{provide:_.RecordSnapshotCreator,useValue:{type:f.B.QUOTE_CONTAINER,create:k.b}}]})(U=function(e){a()(r,e);var n=V(r);function r(){return i()(this,r),n.apply(this,arguments)}return b()(r,[{key:"blocks",get:function(){return[[v,{viewCreator:L,options:this.options.getTextEditorOptions()}],[S,{viewCreator:H}]]}}]),r}(O.h))||U},dx_lBTJ:function(e,n,r){"use strict";function o(){return Promise.all([r.e("dx_j1jX"),r.e("dx_U5U")]).then(r.bind(null,"dx_EWn2"))}r.d(n,"v",(function(){return o}))},dx_lNX7:function(e,n,r){},dx_lPJP:function(e,n,r){"use strict";(function(t){r.d(n,"Z",(function(){return p}));var e=r("dx_f2fg"),o=r("dx_TSYQ"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c),l=r("dx_CqjN"),s=r("dx_d5dp"),u=r("dx_Cg1F"),d=r("dx_N4Vo"),f=r("dx_LBAU"),h=r("dx_ZXpo");r("dx_QnNH");function p(n){var r,o=n.assignees,p=void 0===o?[]:o,v=n.onChange,g=n.blockId,b=n.record,y=n.type,m=n.blockManager,_=n.selectionAPI,k=n.boundary,O=n.disabled,x=n.onVisibleChange,E=Object(c.useRef)(null),S=function(e){v(Object(u.i)(p,!e.completed_milli_time,e.assignee_id))},C=function(e){v(Object(u.n)(p,!1,e.assignee_id))},I=Object(c.useCallback)((function(e){var n;null===(n=window.getSelection())||void 0===n||n.removeAllRanges(),e.preventDefault(),e.stopPropagation(),!O&&E.current&&(Object(h.t)({blockManager:m,selectionAPI:_,boundary:k,target:E.current,onChange:v,assignees:p,blockId:g,onVisibleChange:x}),Object(s.k)({blockId:g,actionType:"click_task_mention_people_panel",target:"ccm_mention_panel_view",blockManager:m}))}),[m,_,k,p,v,O,g,x]),B=Object(l.i)({onClick:function(e){return I(e)}});return a.a.createElement(a.a.Fragment,null,(!O||p.length>0)&&a.a.createElement("span",{className:"task-block-gap",style:{marginRight:p.length>0?3:8}}),p.map((function(e){return a.a.createElement(f.Y,{key:e.assignee_id,assignee:e,record:b,type:y,blockManager:m,disabled:O,toggleAssigneeCompleted:S,deletedAssignee:C})})),!O&&a.a.createElement("span",{ref:E,onClick:I,className:(r="add-user-wrapper","task-block__assignee-picker__".concat(r)),onTouchStart:B,onTouchEnd:B,onTouchMove:B},a.a.createElement(d.a,{tooltipProps:{title:t("CreationDoc_Tasks_AddAssignee_Placeholder")},type:"icon",size:"small",icon:a.a.createElement(e.S,null),className:i()({"task-block-action-btn":!0,"task-block--addUserTabKey":!0})})))}}).call(this,r("dx_E9Eu"))},dx_lROi:function(e,n,r){"use strict";r.d(n,"p",(function(){return b})),r.d(n,"A",(function(){return m})),r.d(n,"K",(function(){return _})),r.d(n,"X",(function(){return k})),r.d(n,"Q",(function(){return x})),r.d(n,"t",(function(){return S})),r.d(n,"C",(function(){return C})),r.d(n,"I",(function(){return I}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_x56x"),s=r("dx_zEdG"),u=r("dx_CwnG"),d=r("dx_kZ3l"),f=r("dx_Jl0O");function h(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return p(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function p(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function v(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function g(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?v(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function b(e){return Number(e.toFixed(0))}function y(e){var n;if(e&&e.length)try{return n=e.replace(/([.*+?^=!:${}()|[\]/\\])/g,"\\$1"),new RegExp(n,"ig")}catch(r){if(!(r instanceof SyntaxError))throw r}}function m(e,n){var r=y(n);if(!r)return[];for(var o=[],i=r.exec(e);null!==i;){var c=i[0];if(!c.length)break;var a=i.index;o.push({start:a,end:c.length+a}),i=r.exec(e)}return o}function _(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(s.P)("ccm_doc_find_replace_panel_click",Object(u.F3)(),g({click:e,target:"none"},n))}function k(){Object(s.T)("ccm_doc_find_replace_panel_view",Object(u.F3)(),{object_block_data:"[]"})}function O(e){var n=e.getClientRects(),r=n[0],o=n[n.length-1];return{height:r.height,startLeft:r.left,startTop:r.top,startBottom:r.bottom,endLeft:o.right,endBottom:o.bottom}}function x(e,n,r){var o=i()(n,2),c=o[0],a=o[1];try{var l=document.createRange();return l.setStart(e,c),l.setEnd(e,a),O(l)}catch(s){null===r||void 0===r||r(s)}}function E(e,n){var r,o=0,i=h(e);try{for(i.s();!(r=i.n()).done;){var c=r.value;if(!c.firstChild||c.firstChild.nodeType!==Node.TEXT_NODE)return;var a=c.firstChild.textContent.length;if(!(o+a<n))return{node:c.firstChild,offset:n-o};o+=a}}catch(l){i.e(l)}finally{i.f()}}function S(e,n,r){var o,c,a="======== [highlightView]";try{c=e.editor.selection.toDOMRange(Object(d.j)(e,n),{ignoreNormalize:!0})}catch(v){console.log(a,"getEmbedRect1 error: ",v)}if(c){var s=c.endContainer,u=null===s||void 0===s||null===(o=s.parentElement)||void 0===o?void 0:o.closest("[".concat(l.n,"]")),f=null===u||void 0===u?void 0:u.querySelector(".embed-text-container");if(null===f||void 0===f?void 0:f.firstChild){if(f.firstChild.nodeType===Node.TEXT_NODE){var h=f.firstChild;return x(h,r,(function(o){console.log(a,"getEmbedRect2 error: ",{e:o,blockId:e.id,range:n,offset:r,textLength:h.textContent.length})}))}var p=Array.from(f.childNodes);if(p.every((function(e){return"span"===e.nodeName.toLowerCase()}))){if(r[0]<0||r[1]>f.textContent.length)return;return function(e,n,r){var o=i()(n,2),c=o[0],a=o[1],l=E(e,c);if(l){var s=E(e,a);if(s)try{var u=document.createRange();return u.setStart(l.node,l.offset),u.setEnd(s.node,s.offset),O(u)}catch(v){null===r||void 0===r||r(v)}}}(p,r,(function(o){console.log(a,"getEmbedRect3 error: ",{e:o,blockId:e.id,range:n,offset:r,textLength:f.textContent})}))}}}}function C(e){var n=e.block,r=e.rect,o=S(n,e.range,e.offset);if(!o)return Object(f.b)();var i={left:o.startLeft,top:o.startTop,bottom:o.endBottom,right:o.endLeft,width:0,height:o.height},c=r.getBlockClientRect(n.id)||Object(f.b)();return Object(f.l)(i,c)}var I={extraParams:{target:"none",action_object:"text",click:"hotkey_action"},setObjectBlockData:function(e){var n=Object(u.p)(e.getRootBlockId(),e);this.extraParams.object_block_data=[Object(u.S)(n)]},report:function(e){Object(s.P)("ccm_doc_content_page_click",Object(u.F3)(),g(g({},this.extraParams),{},{action_type:e}))}}},dx_lSlT:function(e,n,r){"use strict";var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_UtDZ"),d=r("dx_O4O8"),f=r.n(d),h=r("dx_Tumq");var p=new(function(){function e(){a()(this,e),this.currentPageTenantId="",this.mentionUrlMap=new Map,this.mentionTitleMap=new Map,this.eventEmitter=new f.a}return s()(e,[{key:"updateTitles",value:function(e){if(e)for(var n=0,r=Object.entries(e);n<r.length;n++){var o=i()(r[n],2),c=o[0],a=o[1];this.setTitle(c,a)}else console.log("[Mention Doc] mention_page_title undefined")}},{key:"updateUrls",value:function(e){if(e)for(var n=0,r=Object.entries(e);n<r.length;n++){var o=i()(r[n],2),c=o[0],a=o[1];this.setUrl(c,a)}else console.log("[Mention Doc] external_mention_url undefined")}},{key:"applyClientVar",value:function(e){var n=e.meta_map,r=e.mention_page_title,o=e.external_mention_url,i=e.id;if(this.updateTitles(r),this.updateUrls(o),i&&n){var c=n[i];c?this.currentPageTenantId=c.tenant_id:console.log("[Mention Doc] clientvars meta_map data without current page")}else console.log("[Mention Doc] clientvars meta_map data without id or meta_map")}},{key:"applyNewChangesExtra",value:function(e){var n=e.mention_page_title,r=e.external_mention_url;this.updateTitles(n),this.updateUrls(r)}},{key:"getCurrentPageTenantId",value:function(){return this.currentPageTenantId}},{key:"setTitle",value:function(e,n){this.mentionTitleMap.set(e,n),this.eventEmitter.emit(h.c.TitlesChange,e,n)}},{key:"getTitle",value:function(e){return this.mentionTitleMap.get(e)}},{key:"setUrl",value:function(e,n){this.mentionUrlMap.set(e,n),this.eventEmitter.emit(h.c.UrlsChange,e,n)}},{key:"getUrl",value:function(e){return this.mentionUrlMap.get(e)}},{key:"setDocInfo",value:function(e,n){n.mentionType===u.TYPE_ENUM.DOCX&&n.title&&this.setTitle(e,n.title),n.url&&this.setUrl(e,n.url)}}]),e}());n.S=p},dx_lUPZ:function(e,n,r){"use strict";r.d(n,"I",(function(){return _})),r.d(n,"g",(function(){return k})),r.d(n,"V",(function(){return O})),r.d(n,"z",(function(){return x})),r.d(n,"C",(function(){return B})),r.d(n,"W",(function(){return T}));var o=r("dx_VkAN"),i=r.n(o),c=r("dx_PcQO"),a=r("dx_Dtiu"),l=r.n(a),s=r("dx_u2Th");function u(){var e=i()(["\n  &&& {\n    box-sizing: border-box;\n    width: 32px;\n    height: 32px;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    padding: 0;\n    border-radius: 6px;\n    border: 0;\n    outline: 0;\n  }\n"]);return u=function(){return e},e}function d(){var e=i()(["\n  position: relative;\n  box-sizing: border-box;\n  border: 1px solid ",";\n  border-radius: 50%;\n  width: 16px;\n  height: 16px;\n  background: ",";\n  transition: background 0.2s ease, border 0.2s ease;\n  cursor: ",";\n\n  :hover {\n    border-color: ",";\n  }\n\n  ::after {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 6px;\n    height: 6px;\n    background: ",";\n    border-radius: 50%;\n    transition: background 0.2s ease;\n  }\n"]);return d=function(){return e},e}function f(){var e=i()(["\n  &&& {\n    .ud__popover-content {\n      padding: 0;\n    }\n  }\n"]);return f=function(){return e},e}function h(){var e=i()(["\n  position: absolute;\n  box-sizing: border-box;\n  width: 0;\n  height: 100%;\n  top: 0;\n  bottom: 0;\n  left: 100%;\n  background: linear-gradient(to bottom right, var(--B100) 0%, var(--B100) 50%, transparent 50%, transparent 100%);\n"]);return h=function(){return e},e}function p(){var e=i()(["\n          transform: scaleX(0);\n        "]);return p=function(){return e},e}function v(){var e=i()(["\n          animation: 300ms "," ease;\n          transform: scaleX(1);\n        "]);return v=function(){return e},e}function g(){var e=i()(["\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  width: 0;\n  background-color: var(--B100);\n  z-index: 0;\n  transition: width 150ms ease;\n  transform-origin: left center;\n  ","\n\n  @media print {\n    & {\n      animation: none !important;\n    }\n  }\n"]);return g=function(){return e},e}function b(){var e=i()(["\n  background-color: var(--bg-base);\n\n  textarea {\n    cursor: inherit;\n  }\n\n  & > * {\n    z-index: 1;\n  }\n"]);return b=function(){return e},e}function y(){var e=i()(["\n  0% {\n    transform: scaleX(0);\n  }\n  50% {\n    transform: scaleX(0);\n  }\n  100% {\n    transform: scaleX(1);\n  }\n"]);return y=function(){return e},e}var m=Object(a.keyframes)(y()),_=l()(s.e)(b()),k=l.a.div(g(),(function(e){return e.showResult?Object(a.css)(v(),m):Object(a.css)(p())})),O=l.a.div(h()),x=l()(c.Popover)(f()),E=[["var(--N500)","var(--N400)"],["var(--B500)","var(--N400)"]],S=[["transparent","var(--N200)"],["var(--B500)","var(--N400)"]],C=[["transparent","transparent"],["var(--static-white)","var(--N200)"]],I=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];switch(e){case"border":return E[Number(n)][Number(r)];case"background":return S[Number(n)][Number(r)];case"ink":return C[Number(n)][Number(r)];default:return""}},B=l.a.div(d(),(function(e){return I("border",e.checked,e.disabled)}),(function(e){return I("background",e.checked,e.disabled)}),(function(e){return e.disabled?"":"pointer"}),(function(e){return e.disabled?"":"var(--B500)"}),(function(e){return I("ink",e.checked,e.disabled)})),T=l()(c.IconButton)(u())},dx_lVRe:function(e,n,r){},dx_lXkh:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M10.606 16.491l-3.207-.008a.225.225 0 01-.158-.384l3.1-3.1a.3.3 0 01.424 0l1.43 1.431 3.793-3.793a.3.3 0 01.512.212v5.426c0 .124-.1.225-.225.225h-5.607a.226.226 0 01-.062-.009zM5.25 19.5a.75.75 0 01-.75-.75V5.25a.75.75 0 01.75-.75h13.5a.75.75 0 01.75.75v13.5a.75.75 0 01-.75.75H5.25zM6 18h12V6H6v12zM7.5 7.5h2.25v2.25H7.5V7.5z",fill:"currentColor"});n.S=function(e){return i.a.createElement("svg",c({width:24,height:24,viewBox:"0 0 24 24",fill:"none"},e),a)}},dx_lXou:function(e,n,r){"use strict";r.d(n,"S",(function(){return q}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_RIqP"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_W7W2"),v=r.n(p),g=r("dx_a1gu"),b=r.n(g),y=r("dx_Nsbk"),m=r.n(y),_=r("dx_tP01"),k=r("dx_B28d"),O=r("dx_zghO"),x=r("dx_bfji"),E=r("dx_n3n9"),S=r("dx_tVvo"),C=r("dx_Vkod"),I=r("dx_lSNA"),B=r.n(I),T=r("dx_J4zp"),w=r.n(T),R=r("dx_UtDZ"),M=r("dx_WRwK"),j=r("dx_QBqw"),D=r("dx_FNDK"),A=r("dx_tsDa"),P=r("dx_U4Wv"),L=r("dx_vwWk");function N(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function F(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?N(Object(r),!0).forEach((function(n){B()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function U(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return H(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return H(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function H(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var V=function(){function e(n,r){d()(this,e),this.blockManager=n,this.headingModule=r,this.getCopyCellBorderWidthStyle=function(e,n,r,o){var i=["left","top"];return e===n&&i.push("right"),r===o&&i.push("bottom"),i.map((function(e){return"border-".concat(e,":rgb(222, 224, 227) solid 1px;")})).join("")}}return h()(e,[{key:"parse",value:function(e,n,r,o){var i=this,c=new M.n(this.blockManager,n,{}),a=c.getBlockIds(),l=Object(D.m)(n),s=!l||l&&Object(D.p)(n,this.blockManager),u=this.blockToNodes(a,{needInherit:s,partialContext:c,getTextSelectRange:r,singleTextSelection:l,isInAcrossSelectRange:o}),d=document.createElement("div"),f=this.blockManager.getRootRecordId();d.setAttribute("data-page-id",f);var h=a.some((function(e){var n=i.blockManager.getBlockModelByBlockId(e).type;return n!==k.B.DIVIDER&&!k.o.includes(n)})).toString();return d.setAttribute("data-docx-has-block-data",h),d.innerHTML=this.toHTML(u),Object(R.makePublicUrlEffective)(!0),d}},{key:"blockToNodes",value:function(e,n,r){var o=this,i=n.needInherit,c=n.partialContext,a=n.getTextSelectRange,l=n.singleTextSelection,u=n.isInAcrossSelectRange;if(0===e.length)return[];var d=e.length>=1&&this.blockManager.getBlockModelByBlockId(e[0]),f=this.blockManager.getBlockViewByBlockIdNotCheck(e[0]),h=l&&1===e.length&&d&&k.o.includes(d.type)&&(null===f||void 0===f?void 0:f.isFocus());return Object(A.A)(this.blockManager,e)?this.copyCellNodes(e,n):e.reduce((function(e,l){var d=o.blockManager.getBlockModelByBlockId(l);if(d.type===k.B.TABLE)return e.push.apply(e,s()(o.handleCopyTable(d.id,n))),e;if(!r&&[k.B.OBJECTIVE,k.B.KEY_RESULT].includes(d.type))return Object(P.e)({nodes:e,model:d,children:[],blockManager:o.blockManager,headingModule:o.headingModule,needInherit:i,getTextSelectRange:a,parentModel:r});var f=h?[]:o.blockToNodes(d.children.map((function(e){return e.id})).filter((function(e){return!c.shouldSkip(e)&&u(e)})),n,d);return Object(P.e)({nodes:e,model:d,children:f,blockManager:o.blockManager,headingModule:o.headingModule,needInherit:i,getTextSelectRange:a,parentModel:r})}),[])}},{key:"toHTML",value:function(e){var n,r="",o=U(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;r+=Object(L.R)(i)}}catch(c){o.e(c)}finally{o.f()}return r}},{key:"copyCellNodes",value:function(e,n){for(var r=this,o=this.blockManager.getBlockModelByBlockId(e[0]).parent,i=null===o||void 0===o?void 0:o.record.snapshot,c=Object.entries(Object(j.Q)(i)).reduce((function(n,o){var i=w()(o,2),c=i[0],a=i[1];return r.blockManager.getBlockIdsByRecordId(c).forEach((function(r){e.includes(r)&&(n[a]=r)})),n}),{}),a=Object.keys(c),l=Object(j.c)(i),s=i.column_set,u=i.columns_id,d=Object(j.xp)({cellIds:a,layoutInfo:l,snapshot:i}),f=d.startRow,h=d.startCol,p=d.endRow,v=d.endCol,g=[],b=f;b<=p;b++){for(var y={tagName:"tr",attrs:{style:"height:39px;"},children:[]},m=h;m<=v;m++){var _=l[b][m];if(_.cellId===_.sourceCellId){var k,O=c[_.cellId],x=O?this.blockManager.getBlockModelByBlockId(O):null,E=x?x.children.map((function(e){return e.id})):[],S=x&&x.children.length?x.children[0].record.snapshot.align:"left",C={tagName:"td",attrs:{colspan:_.colSpan,rowspan:_.rowSpan,style:"".concat(this.getCopyCellBorderWidthStyle(m,v,b,p),"font-size:10pt;").concat(S?"text-align: ".concat(S):"")},children:this.blockToNodes(E,F(F({},n),{},{needInherit:!0}))};null===(k=y.children)||void 0===k||k.push(C)}}g.push(y)}for(var I=[],B=[],T=h;T<=v;T++){var R=u[T],M=s[R].column_width;I.push(M),B.push({tagName:"col",attrs:{width:s[R].column_width}})}var D={tagName:"colgroup",children:B};return[{tagName:"div",children:[{tagName:"table",attrs:{class:"ace-table","data-ace-table-col-widths":I.join(";"),style:"border:none;border-collapse:collapse;table-layout:fixed;width:500px;"},children:[D,{tagName:"tbody",children:g}]}]}]}},{key:"handleCopyTable",value:function(e,n){var r=this.blockManager.getBlockModelByBlockId(e).children.map((function(e){return e.id}));return this.copyCellNodes(r,n)}}]),e}(),W=r("dx_EjFk"),z=r("dx_Y27Y"),G=r("dx_l6lq");function K(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var q=function(e){v()(r,e);var n=K(r);function r(){var e;d()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).format=z.L.HTML,e.blockBuilder=new x.S,e.htmlBuilder=new V(e.blockManager,e.headingModule),e.imageUploader=void 0,e.key="pasting",e.transformGithubPasteNode=function(n,r){var o;1===n.length&&(null===(o=e.blockManager.getBlockModelByBlockIdNotCheck(n[0].id))||void 0===o?void 0:o.type)===k.B.CODE&&(r.querySelectorAll("byte-sheet-html-origin").forEach((function(e){var n=document.createElement("div");n.innerHTML=e.innerHTML,e.parentElement.replaceChild(n,e)})),r.querySelectorAll("table").forEach((function(e){e.querySelectorAll("tr").forEach((function(e){var n=document.createElement("div");n.innerHTML=e.innerHTML,e.parentElement.replaceChild(n,e)}));var n=document.createElement("pre");n.innerHTML=e.innerHTML,e.parentElement.innerHTML=n.outerHTML})))},e}return h()(r,[{key:"shouldCopy",value:function(){return!0}},{key:"onCopyBlock",value:function(e){return e.id}},{key:"onCopy",value:function(e,n,r){var o=this,i={},c=s()(r);if(this.selectionAPI.isTextSelectionAcrossBlocks(r)){var a=Object(C.d)(this.blockManager,r,!0,(function(e){var n=o.blockManager.getBlockModelByBlockId(e).parent;return!!n&&(!![k.B.GRID,k.B.GRID_COLUMN].includes(n.type)||n.type===k.B.PAGE)})),l=a.rangeMap,u=a.newSelectedBlockIds;i=l;var d=Object(C.c)(this.blockManager,u,!0);r=r.reduce((function(e,n){return d.includes(n.id)&&e.push({id:n.id,type:O.j.BLOCK}),e}),[])}var f=this.htmlBuilder.parse(r.map((function(e){return e.id})),r,Object(C.V)(this.blockManager,this.selectionAPI,r,i),Object(C.p)(this.blockManager,this.selectionAPI,c));return'<meta charset="utf-8">'.concat(f.outerHTML)}},{key:"shouldPaste",value:function(e,n,r){return(!r.clipboardData||!Object(G.A)(r.clipboardData))&&(1===e.length&&e[0].type===O.j.TEXT&&this.handleReminderPaste(n)&&(this.blockManager.getBlockViewByBlockId(e[0].id).type,k.B.CODE),!0)}},{key:"onPaste",value:function(){var e=a()(i.a.mark((function e(n,r,o){var c,a,l,s,u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.transformGithubPasteNode(n,r),c=Object(G.B)(r,o.getTypes()),a=this.blockBuilder.parse(r,c),l=a.data,s=a.pageId,this.imageUploader=new W.J({pageToken:Object(_.m)(this.blockManager)}),u=Object(G.h)(l,this.blockManager,{},{},s),Object(S.s)(Object.assign({},this.options,{proxyClipboardData:o}),u,this.format);case 6:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"handleReminderPaste",value:function(e){return/data-inline-type="reminder"/.test(e)}}]),r}(E.S)},dx_lZWw:function(e,n,r){"use strict";r.d(n,"F",(function(){return u})),r.d(n,"f",(function(){return d})),r.d(n,"X",(function(){return f})),r.d(n,"Y",(function(){return h}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_RIqP"),a=r.n(c),l=r("dx_Jl0O"),s=r("dx_pmiW");function u(e,n){if(e.id===n.id)return e.id;var r=e.path.slice(0),o=n.path.slice(0);r.push(e.id),o.push(n.id);for(var i=0;r.length&&o.length&&r[i]===o[i];)i++;return r[i-1]}function d(e){var n=function(e){return e.every((function(n){return n.id===e[0].id}))};if(n(e))return e[0].path.slice(-1)[0];for(var r=e.map((function(e){return{id:e.id,path:[].concat(a()(e.path),[e.id])}})),o=0;n(r);)o++;return r[0].path[o-1]}function f(e){var n=e.ancestorId,r=e.blockManager,o=e.y,i=e.rect,c=r.getBlockModelByBlockId(n).children.filter((function(e){return!!e}));if(c.length<2)return!1;var a=Object(l.w)(i.getOriginBlockRect(c.shift().id)),u=(a.x+a.width)/2,d=o+.1;return d>a.y+a.height&&(d<Object(l.w)(i.getOriginBlockRect(c.pop().id)).y&&function(e,n,r){var o=0,i=n.length-1;for(;o<=i;){var c=Math.floor(o+(i-o)/2),a=Object(l.w)(r(n[c].id));if(a.top>e.bottom)i=c-1;else{if(!(a.bottom<e.top))return!Object(s.L)(a,e,s.Z.TOUCH);o=c+1}}return!0}(new DOMRect(u,d,.1,.1),c,i.getOriginBlockRect.bind(i)))}function h(e,n,r){var o=function(e,n){if(e.id===n.id)return[e.id,n.id];var r=e.path.slice(0),o=n.path.slice(0);r.push(e.id),o.push(n.id);for(var i=0;r.length&&o.length&&r[i]===o[i];)i++;return[r[i],o[i]]}(n,r),c=i()(o,2),a=c[0],l=c[1],s=e.findIndex((function(e){return e&&e.id===a})),u=e.findIndex((function(e){return e&&e.id===l}));return s<=u?[s,u]:[u,s]}},dx_ldXi:function(e,n,r){"use strict";r.d(n,"s",(function(){return c})),r.d(n,"B",(function(){return a}));var o=r("dx_UtDZ"),i=(r("dx_yzqx"),r("dx_UHze"));function c(){return!Object(i.E)()&&(Object(o.getMinaConfig)("okr_block_enable",!1)||function(){var e=String(o.docsLocation.host),n=e.indexOf(".");return n>=0&&".feishu.cn"===e.slice(n)}())}function a(){return Object(o.getMinaConfig)("ccm.doc.okr1.0copytodocx",!1)}},dx_lg5u:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 23c6.075 0 11-4.925 11-11S18.075 1 12 1 1 5.925 1 12s4.925 11 11 11zM11 7.5a.5.5 0 01.5-.5h1a.5.5 0 01.5.5v6a.5.5 0 01-.5.5h-1a.5.5 0 01-.5-.5v-6zm0 8a.5.5 0 01.5-.5h1a.5.5 0 01.5.5v1a.5.5 0 01-.5.5h-1a.5.5 0 01-.5-.5v-1z",fill:"#F80"});n.S=function(e){return i.a.createElement("svg",c({width:24,height:24,viewBox:"0 0 24 24",fill:"none"},e),a)}},dx_lhRo:function(e,n,r){"use strict";r.d(n,"N",(function(){return m})),r.d(n,"U",(function(){return _})),r.d(n,"v",(function(){return k})),r.d(n,"h",(function(){return O})),r.d(n,"g",(function(){return x}));var o,i,c=r("dx_lSNA"),a=r.n(c),l=r("dx_RIqP"),s=r.n(l),u=r("dx_Icqc"),d=r("dx_FBWK"),f=r("dx_MWd8"),h=r("dx_Py6Q"),p=r("dx_JFYx"),v=r("dx_KgXx"),g={},b=(o={},a()(o,p.Pi.TextColor,new Map(Object.keys(p.N).map((function(e){return[e,h.C.includes(e)?"":Object(f.f)(Object(d.getColor)(p.N[e],u.ThemeType.LIGHT))]})))),a()(o,p.Pi.BackgroundColor,new Map([].concat(s()(new Map(Object.keys(p.a).map((function(e){return[e,h.C.includes(e)?"":Object(f.f)(Object(d.getColor)(p.a[e],u.ThemeType.LIGHT))]})))),s()(new Map(Object.keys(p.d).map((function(e){return[e,h.C.includes(e)?"":Object(f.f)(Object(d.getColor)(p.d[e],u.ThemeType.LIGHT))]}))))))),a()(o,p.Pi.Border,{light:new Map(Object.keys(p.S).map((function(e){return[e,h.C.includes(e)?"":Object(f.f)(Object(d.getColor)(p.S[e],u.ThemeType.LIGHT))]}))),dark:new Map(Object.keys(p.i).map((function(e){return[e,h.C.includes(e)?"":Object(f.f)(Object(d.getColor)(p.i[e],u.ThemeType.LIGHT))]})))}),o),y=(i={},a()(i,p.Pi.TextColor,new Map(Object.keys(p.N).map((function(e){return[e,h.C.includes(e)?"":p.N[e]]})))),a()(i,p.Pi.BackgroundColor,new Map([].concat(s()(new Map(Object.keys(p.a).map((function(e){return[e,h.C.includes(e)?"":p.a[e]]})))),s()(new Map(Object.keys(p.d).map((function(e){return[e,h.C.includes(e)?"":p.d[e]]}))))))),a()(i,p.Pi.Border,{light:new Map(Object.keys(p.S).map((function(e){return[e,h.C.includes(e)?"":p.S[e]]}))),dark:new Map(Object.keys(p.i).map((function(e){return[e,h.C.includes(e)?"":p.i[e]]})))}),i),m=function(e){var n=g[e];n||(n=function(e){return{text:new Map(Object.keys(p.N).map((function(n){return[n,Object(f.f)(Object(d.getColor)(p.N[n],e))]}))),lightBackground:new Map(Object.keys(p.a).map((function(n){return[n,Object(f.f)(Object(d.getColor)(p.a[n],e))]}))),darkBackground:new Map(Object.keys(p.d).map((function(n){return[n,Object(f.f)(Object(d.getColor)(p.d[n],e))]}))),lightBorder:new Map(Object.keys(p.S).map((function(n){return[n,Object(f.f)(Object(d.getColor)(p.S[n],e))]}))),darkBroder:new Map(Object.keys(p.i).map((function(n){return[n,Object(f.f)(Object(d.getColor)(p.i[n],e))]}))),panelBorder:new Map(Object.keys(p.n6).map((function(n){return[n,Object(f.f)(Object(d.getColor)(p.n6[n],e))]}))),panelBackground:new Map(Object.keys(p.l).map((function(n){return[n,Object(f.f)(Object(d.getColor)(p.l[n],e),p.n[n])]})))}}(e),g[e]=n)},_=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(u.getCurrentThemeType)();g[n]||m(n);var r=g[n];return r[e]},k=function(e){return b[e]},O=function(e){return y[e]},x=function(e,n){if(e===p.Pi.Border){var r=b[p.Pi.Border],o=y[p.Pi.Border],i=Object(v.v)(r.light,n);return i?o.light.get(i)||n:(i=Object(v.v)(r.dark,n))&&o.dark.get(i)||n}var c=k(e),a=O(e),l=Object(v.v)(c,n);return l&&a.get(l)||n}},dx_lmzW:function(e,n,r){"use strict";r.d(n,"S",(function(){return k}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_TSYQ"),v=r.n(p),g=r("dx_cDcd"),b=r.n(g),y=r("dx_MGoZ"),m=r("dx_Z8yN");r("dx_WKAt");function _(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var k=function(e){s()(r,e);var n=_(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).DividerRef=b.a.createRef(),e.getViewSnapshot=function(){return e.DividerRef.current},e}return a()(r,[{key:"render",value:function(){return b.a.createElement("div",{className:"divider-block ".concat(this.editable?"editable":""),ref:this.DividerRef},b.a.createElement("div",{className:v()("divider-block__container",m.N)},b.a.createElement("div",{className:"divider-block__content"})))}}],[{key:"selectionTargetFilter",value:function(e){return!e.closest(".divider-block__container")}}]),r}(y.l)},dx_lnCS:function(e,n,r){"use strict";r.d(n,"Y",(function(){return c})),r.d(n,"q",(function(){return a})),r.d(n,"YD",(function(){return l})),r.d(n,"w",(function(){return s}));var o=r("dx_AAGW"),i=4000003;function c(e,n){return o.S.get("/poll/details",{params:{page_id:e,block_id:n},shouldRetry:function(e){return e.code===i},retryMaxCount:5,retryDelay:2e3})}function a(e,n,r,i){return o.S.get("/poll/option/data",{params:{page_id:e,block_id:n,option_id:r,offset:i},shouldRetry:!0,retryMaxCount:5,retryDelay:2e3})}function l(e,n,r){return o.S.post("/poll/votes",{page_id:e,block_id:n,option_map:r},{shouldRetry:!0,retryMaxCount:3,retryDelay:5e3})}function s(e,n){return o.S.post("/poll/publish",{page_id:e,block_id:n},{shouldRetry:!0,retryMaxCount:5,retryDelay:1e3})}},dx_lpLe:function(e,n,r){"use strict";(function(t){r("dx_bsRf");var e=r("dx_rVaU"),o=r.n(e),i=r("dx_J4zp"),c=r.n(i),a=r("dx_h6a8"),l=r("dx_cDcd"),s=r.n(l),u=r("dx_D8nn"),d=r("dx_nQiu"),f=r("dx_Mzjv"),h=r("dx_HqbJ"),p=r("dx_viBb"),v=r("dx_If1T"),g=r("dx_NLqU"),b=r("dx_t1W5"),y=r("dx_JgGi"),m=r("dx_CkQe"),_=r("dx_JUlI"),k=function(e){var n,r=e.item,o=e.index,i=e.hovered,d=e.vertical,f=e.showIconColor,h=e.submenuManager,p=e.setItemRef,y=e.onItemHover,m=e.onItemClick,_=e.children,k=e.mouseModeRef,O=e.blockManager,x=e.selectionAPI,E=e.boundary,S=e.eventEmitter,C=Object(g.S)(!!r.guideInfo),I=c()(C,3),B=I[0],T=I[1],w=I[2],R=Object(l.useState)(null),M=c()(R,2),j=M[0],D=M[1],A=Object(l.useMemo)((function(){return Object(a.debounce)((function(){var e,n;return null===(e=r.guideInfo)||void 0===e||null===(n=e.onHover)||void 0===n?void 0:n.call(e)}),100)}),[null===(n=r.guideInfo)||void 0===n?void 0:n.onHover]),P=Object(l.useCallback)((function(){T(),A(),h.enterItemNormal(r.name),y(o)}),[y,o,h,T,r.name]),L=Object(l.useCallback)((function(){w(),A.cancel(),(d||r.unselectOnMouseLeave)&&y(-1)}),[d,r.unselectOnMouseLeave,w,y]),N=Object(l.useCallback)((function(e){p(o,e),D(e)}),[p,o]);return Object(l.useEffect)((function(){return S.on(u.p.COMMON.HIDE_GUIDE_POPOVER,w),function(){S.off(u.p.COMMON.HIDE_GUIDE_POPOVER,w)}}),[S,w]),!r.guideInfo||O||x||E?s.a.createElement(b.Fs,{setItemRef:N,item:r,showIconColor:f,hovered:i,onItemEnter:P,onItemLeave:L,showArrow:!1,vertical:d,onItemClick:m,mouseModeRef:k},_,r.guideInfo&&s.a.createElement(v.S,{guideInfo:r.guideInfo,visible:i&&B,target:j,blockManager:O,selectionAPI:x,boundary:E})):(console.error("[docx menu props error]: item which has guide must need following props: 'blockManager', 'selectionAPI', 'boundary' !"),null)},O=function(e){var n=e.item,r=Object(l.useCallback)((function(e){var r;null===(r=n.onSwitch)||void 0===r||r.call(n,e)}),[n.onSwitch]);return s.a.createElement(k,e,s.a.createElement(o.a,{defaultChecked:n.defaultSwitchChecked,onChange:r,size:"small",disabled:n.switchDisabled}))},x=function(e){var n=e.item,r=e.onItemClick,o=Object(l.useRef)(null),i=Object(l.useCallback)((function(){var e;null===(e=o.current)||void 0===e||e.showTooltip()}),[]),c=Object(l.useCallback)((function(){var e;null===(e=o.current)||void 0===e||e.hideTooltip()}),[]),a=Object(l.useCallback)((function(e){!n.disabled&&Object(_.k)(n)&&r(n,e)}),[n,r]),u=Object(l.useCallback)((function(e){n.disabled||(i(),a(e))}),[n.disabled,i,a]);return s.a.createElement(b.G,{ref:o,item:n,placement:"top"},s.a.createElement(b.F,{hovered:!1,useItemClass:!1,actived:n.active,name:n.name,className:"flatten-item",onTouchToClick:u,onClick:a,onMouseEnter:i,onMouseLeave:c},n.icon))},E=function(e){var n=e.item.children,r=e.onItemClick,o=e.onItemHover,i=e.submenuManager,c=Object(l.useCallback)((function(){i.willLeaveItem(),o(-1)}),[i,o]);return s.a.createElement(b.F,{hovered:!1,onMouseEnter:c,useItemClass:!1,className:"flatten-item-list"},n.filter((function(e){return!!e})).filter(_.B).map((function(e){return s.a.createElement(x,{key:e.name,item:e,onItemClick:r})})))},S=function(e){var n=e.item,r=n.text,o=n.name,i=n.isLoading,c=n.showNewTag,a=e.hovered,u=e.submenuManager,d=e.onItemHover,f=e.mouseModeRef,h=Object(l.useCallback)((function(){f.current&&(u.willLeaveItem(),d(-2))}),[f,u,d]);return s.a.createElement(b.F,{className:"menu-title-item",name:o,hovered:a,onMouseEnter:h},r,c&&s.a.createElement("div",{className:"menu-title-item-new-tag"},s.a.createElement("p",null,t("CreationDoc_Wiki_Block_NewTag"))),i&&s.a.createElement(b.l,null))},C=function(){return s.a.createElement(b.F,{hovered:!1,useItemClass:!1,className:"menu-divider-item"})},I=function(e){var n=e.item,r=e.index,o=e.hovered,i=e.showIconColor,a=e.submenuManager,u=e.vertical,v=e.boundary,g=e.blockManager,_=e.selectionAPI,k=e.isRootMenuItem,O=e.onItemHover,x=e.onItemClick,E=e.onItemActive,S=e.onClose,C=e.onRefresh,I=e.eventEmitter,B=e.setMenuRef,T=e.mouseModeRef,w=Object(l.useState)(!1),R=c()(w,2),M=R[0],j=R[1],D=Object(l.useRef)(null),A=Object(l.useRef)(o);Object(l.useLayoutEffect)((function(){A.current=o}),[o]);var P=Object(l.useCallback)((function(n){D.current=n,e.setItemRef(r,n)}),[r]),L=Object(l.useCallback)((function(){var e;return null===(e=D.current)||void 0===e?void 0:e.closest(".".concat(d.P))}),[]),N=Object(l.useCallback)((function(){a.enterItemHasSubmenu({key:n.name,onShow:function(){j(!0)},onHide:function(){j(!1),u&&A.current&&O(-1)}}),O(r)}),[O,r,a,n,u,o]),F=Object(l.useCallback)((function(){var e,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];!k&&(null===(e=n.menuProps)||void 0===e?void 0:e.closeAfterMouseLeave)||r?a.leaveItem():a.willLeaveItem()}),[n.menuProps,k,a]),U=Object(l.useCallback)((function(){(u||n.unselectOnMouseLeave)&&F()}),[u,n.unselectOnMouseLeave,F]);Object(l.useEffect)((function(){var e=function(e){e===n.name&&N()},r=function(e){e===n.name&&F()};return I.on(p.Z,e),I.on(p.g,r),function(){I.off(p.Z,e),I.off(p.g,r)}}),[n.name,I,N,F]);var H=Object(l.useState)(void 0),V=c()(H,2),W=V[0],z=V[1],G=Object(l.useCallback)((function(e){return z(e),n.type===m.F.SubmenuItemWithChildren}),[n.type]),K=Object(l.useMemo)((function(){return n.type===m.F.SubmenuItemWithChildren?s.a.createElement(h.S,Object.assign({items:n.children,blockManager:g,selectionAPI:_,boundary:v,setMenuRef:B,onSelfClose:F,onClose:S,onItemClick:x,onItemActive:E,closeAfterMouseLeave:u,className:"docx-submenu-panel",maxHeight:W},n.menuProps)):s.a.createElement(n.component,{onRefresh:C,onSelfClose:F,onClose:S,setMenuRef:B})}),[n,g,_,v,B,F,C,S,x,E,u,W]),q=Object(l.useMemo)((function(){return n.submenuDefaultDirection?n.submenuDefaultDirection:u?n.type===m.F.SubmenuItemWithComponent?f.R.BottomCenter:f.R.BottomLeft:f.R.RightCenter}),[n.submenuDefaultDirection,n.type,u]);return s.a.createElement(b.Fs,{hovered:o,item:n,setItemRef:P,showArrow:!n.notShowArrow,vertical:u,showIconColor:i,onItemEnter:N,onItemLeave:U,onItemClick:x,mouseModeRef:T},s.a.createElement(y.S,Object.assign({visible:M,getSubmenuContainer:L,target:D.current,boundary:v,blockManager:g,selectionAPI:_,defaultDirection:q,beforeChangeMaxHeight:G,reverse:!0,adjust:!u,isComponent:n.type===m.F.SubmenuItemWithComponent},n.overlayProps),K))};n.S=function(e){switch(e.item.type){case m.F.MenuItemNormal:return s.a.createElement(k,e);case m.F.MenuItemWithSwitch:return s.a.createElement(O,e);case m.F.MenuItemWithFlattenItems:return s.a.createElement(E,e);case m.F.SubmenuItemWithComponent:case m.F.SubmenuItemWithChildren:return e.blockManager&&e.selectionAPI&&e.boundary?s.a.createElement(I,e):(console.error("[docx menu props error]: submenu item must need following props: 'blockManager', 'selectionAPI', 'boundary' !"),null);case m.F.Title:return s.a.createElement(S,e);case m.F.Divider:return s.a.createElement(C,e);default:return null}}}).call(this,r("dx_E9Eu"))},dx_luPr:function(e,n,r){"use strict";r.d(n,"F",(function(){return k})),r.d(n,"R",(function(){return S}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_RIqP"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_P5PS"),h=r("dx_ABiD"),p=r("dx_GPzN"),v=r("dx_B28d"),g=r("dx_c7yg"),b=r("dx_USRY"),y=r("dx_D8nn");function m(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function _(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?m(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var k,O=[v.B.FILE],x="ccm_block_load_duration_dev";!function(e){e.INIT="init",e.SHOW="show",e.DATA_LOAD_START="dataLoadStart",e.JS_READY="jsReady",e.DATA_READY="dataReady",e.TTV="ttv",e.TTU="ttu"}(k||(k={}));var E=[v.B.TABLE,v.B.SHEET,v.B.DIAGRAM,v.B.IFRAME,v.B.MINDMAP,v.B.BITABLE,v.B.POLL,v.B.FILE,v.B.IMAGE],S=new(function(){function e(){var n=this;s()(this,e),this.blockLoadRecords={},this.needReportBlockIds=[],this.blockManager=void 0,this.id2FromMap=new Map,this.createModelSubscription=void 0,this.firstScreenBlockIds=[],this.firstScreenBlockIdsInWhileList=[],this.hasFirstScreenBlockIdsInWhileList=!1,this.viewBlockMarkLeave=function(){"hidden"===document.visibilityState&&Object.keys(n.blockLoadRecords).forEach((function(e){n.blockLoadRecords[e].show&&(n.blockLoadRecords[e].viewBlockHasLeave=!0)}))},this.handleBlockModelCreate=function(e){n.id2FromMap.set(e.model.id,e.options.from||"init")},y.S.once(h.C.RENDER_DOCX_FIRST_SCREEN_SUCCESS,(function(){var e,r,o;n.firstScreenBlockIds=null===(e=n.blockManager)||void 0===e||null===(r=e.layoutManager)||void 0===r?void 0:r.getViewportBlocks(),(null===(o=n.firstScreenBlockIds)||void 0===o?void 0:o.length)&&(n.firstScreenBlockIdsInWhileList=n.firstScreenBlockIds.filter((function(e){var r,o=null===(r=n.blockManager)||void 0===r?void 0:r.getBlockModelByBlockId(e);return!!o&&E.includes(o.type)}))),n.firstScreenBlockIdsInWhileList.length?n.hasFirstScreenBlockIdsInWhileList=!0:p.S.setFirstScreenBlockLoaded()})),window.addEventListener("visibilitychange",this.viewBlockMarkLeave)}return d()(e,[{key:"getImageCountInSameViewport",value:function(){var e,n,r,o,i,c=this,l=null===(e=this.blockManager)||void 0===e||null===(n=e.layoutManager)||void 0===n?void 0:n.getViewportBlocks(),s=null===(r=this.blockManager)||void 0===r||null===(o=r.layoutManager)||void 0===o?void 0:o.getBufferBlocks();return(null===(i=[].concat(a()(l),a()(s)).filter((function(e){var n;return(null===(n=c.blockLoadRecords[e])||void 0===n?void 0:n.type)===v.B.IMAGE})))||void 0===i?void 0:i.length)||0}},{key:"blockTTVisTTU",value:function(e){return!O.includes(e)}},{key:"blockLoadRecordsModify",value:function(e){var n=e.id,r=this.blockLoadRecords[n];r&&(this.blockLoadRecords[n]=_(_({},r),e))}},{key:"clearStageInfo",value:function(e,n){this.blockLoadRecords[n]&&delete this.blockLoadRecords[n][e]}},{key:"reportBlockLoadStage",value:function(e,n){var r=this;Promise.resolve().then((function(){var o,c=n.id;if(e===k.INIT)return r.needReportBlockIds.push(c),void("type"in n&&(r.blockLoadRecords[c]=_({init:n.time},n)));if(!r.needReportBlockIds.length)return r.blockLoadRecords={},window.removeEventListener("visibilitychange",r.viewBlockMarkLeave),null===(o=r.createModelSubscription)||void 0===o||o.unsubscribe(),void r.id2FromMap.clear();var a=r.blockLoadRecords[c];if(a&&(r.blockLoadRecords[c]=_(_({},a),{},i()({},e,n.time)),r.shouldCollectEnd(e,a))){n.isFromCache&&(r.blockLoadRecords[c]=_(_({},r.blockLoadRecords[c]),{},{isFromCache:!0})),r.hasFirstScreenBlockIdsInWhileList&&(r.firstScreenBlockIdsInWhileList=r.firstScreenBlockIdsInWhileList.filter((function(e){return e!==c})),0===r.firstScreenBlockIdsInWhileList.length&&p.S.setFirstScreenBlockLoaded()),a.ttv||(a.ttv=a.ttu),r.blockTeaReport(r.blockLoadRecords[c]);var l=r.needReportBlockIds.indexOf(c);l>-1&&r.needReportBlockIds.splice(l,1)}}))}},{key:"reportBlockLoadError",value:function(e){var n=e.id,r={block_type:e.type,block_id:n,is_first_screen:this.firstScreenBlockIds.includes(n)?1:0,error_reason:"error"};p.S.setOtherEventData("ccm_block_load_fail_dev",r)}},{key:"setBlockManager",value:function(e){this.blockManager=e,this.createModelSubscription=e.modelService.blockModelCreate$.subscribe(this.handleBlockModelCreate)}},{key:"blockTeaReport",value:function(e){var n=e.type,r=e.id,o=e.isRetry,i=e.init,c=e.show,a=e.jsReady,l=e.dataLoadStart,s=e.dataReady,u=e.ttv,d=e.ttu,f=e.viewType,h=e.viewBlockHasLeave,v=e.profile,g=e.isFromCache,b={block_type:n,block_id:r,is_onscreen:c?1:0,is_first_screen:this.firstScreenBlockIds.includes(r)?1:0,is_retry:o,block_file_type:"string"===typeof f?f.toLocaleLowerCase():f,view_block_has_leave:h?1:0,from:this.id2FromMap.get(r),load_main_stage_duration_list:JSON.stringify({block_init:i,block_show_in_viewport:c,block_js_loaded_success:a,block_data_request_start:l,fetch_block_data_success:s,block_ttv:u,block_ttu:d}),block_profile:v&&{image_token:v.token,image_type:v.mimeType,image_size:v.size,image_show_width:v.width,image_show_length:v.height,image_in_same_viewport_cnt:v.isSSR?v.firstScreenImageCount:this.getImageCountInSameViewport(),is_from_cache:g?1:0}};c&&(void 0!==u&&(b.load_ttv_duration_ms=Math.max(u-c,0)),void 0!==d&&(b.load_ttu_duration_ms=Math.max(d-c,0))),console.info(x,b),p.S.setOtherEventData(x,b)}},{key:"shouldCollectEnd",value:function(e,n){var r,o=n.type,c=n.viewType;return((r={},i()(r,g.O,(function(){switch(c){case b.t.Card:case b.t.Inline:return e===k.TTV;case b.t.Preview:return e===k.TTU;default:return!1}})),i()(r,v.B.ISV,(function(){return e===k.TTU})),r)[o]||function(){return o&&f.e.has(o)?e===k.TTU:e===k.TTU||e===k.TTV})()}}]),e}())},dx_lvfY:function(e,n,r){"use strict";r.d(n,"D",(function(){return i})),r.d(n,"I",(function(){return c}));var o=r("dx_FBWK"),i=(r("dx_Ngi8"),Object(o.getThemeColorByToken)("S50-FG"),Object(o.getThemeColorByToken)("S100-FG"),Object(o.getThemeColorByToken)("S200-FG"),Object(o.getThemeColorByToken)("S300-FG"),Object(o.getThemeColorByToken)("S400-FG"),Object(o.getThemeColorByToken)("ccmtoken-doc-highlightcolor-sunflower-solid"),Object(o.getThemeColorByToken)("S600-FG"),Object(o.getThemeColorByToken)("S700-FG"),Object(o.getThemeColorByToken)("S800-FG"),Object(o.getThemeColorByToken)("S900-FG"),Object(o.getThemeColorByToken)("bg-body"),"0 3px 12px 0 var(--shadow-default-md)");function c(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.replace("#","");3===r.length&&(r=r.split("").map((function(e){return"".concat(e).concat(e)})).join(""));var o=parseInt(r.substr(0,2),16),i=parseInt(r.substr(2,2),16),c=parseInt(r.substr(4,2),16),a=n;return"string"===typeof a?(a="/ ".concat(n,"%"),"rgba(".concat(o," ").concat(i," ").concat(c," ").concat(a,")")):(a>1&&(a/=100),1===a?"rgb(".concat(o,", ").concat(i,", ").concat(c,")"):"rgba(".concat(o,", ").concat(i,", ").concat(c,", ").concat(a,")"))}},dx_lwLI:function(e,n,r){"use strict";r.d(n,"F",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("structure-query")},dx_m0BX:function(e,n,r){"use strict";r.d(n,"F",(function(){return s})),r.d(n,"E",(function(){return u}));var o=r("dx_Dq30"),i=r("dx_yzqx"),c=r("dx_DbCN"),a=r("dx_sNGG"),l=r("dx_lROi");function s(e){var n;return!!e.getRecord(e.getRootRecordId()).snapshot.cover&&(null===(n=document.querySelector(".".concat(o.P)))||void 0===n?void 0:n.clientHeight)||0}function u(e){var n,r,o,s,u=e.scrollContainer,d=e.startTop,f=e.endBottom,h=e.left,p=e.right,v=e.horizonScrollContainer,g=i.S.isMobile;if(g?(o="html, body",n=window.scrollY,r=window.innerHeight,s=a.e):(o=u,n=Object(c.h)(o),r=Object(c.O)(o),s=a.n),g||d<=n||f>=n+r){var b=Object(l.p)(d)-s,y=b-n;if(Math.abs(y)>900){var m=b+(n<b?-300:300);$(o).scrollTop(m)}$(o).animate({scrollTop:b},250)}if(v&&void 0!==p&&void 0!==h){var _,k=v.getBoundingClientRect().width,O=v.scrollLeft,x=v.offsetLeft,E=p-h;h-=x,p-=x,E>=k||p<=O||h>=k+O?_=h:(p>=O+k&&(_=p-E),h<O&&(_=h)),void 0!==_&&$(v).animate({scrollLeft:_},250)}}},dx_m0me:function(e,n,r){},dx_m5Ht:function(e,n,r){"use strict";var o;r.d(n,"z",(function(){return o})),function(e){e[e.none=0]="none",e[e.creating=1]="creating",e[e.success=2]="success",e[e.fail=3]="fail"}(o||(o={}))},dx_m5zM:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M13.056 8A5.056 5.056 0 112.944 8a5.056 5.056 0 0110.112 0z",stroke:"#BACEFD",strokeWidth:3.889}),l=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M15 8.389C15 4.373 12.243 1 8 1v3.889c1.771 0 3.111 1.293 3.111 3.5a1.944 1.944 0 003.889 0z",fill:"#3370FF"});n.S=function(e){return i.a.createElement("svg",c({width:16,height:16,viewBox:"0 0 16 16",fill:"none"},e),a,l)}},dx_m7mq:function(e,n,r){},dx_mGN1:function(e,n,r){"use strict";r.d(n,"c",(function(){return x}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_cDcd"),v=r.n(p),g=r("dx_yzqx"),b=r("dx_B28d"),y=r("dx_Vau3");r("dx_qdiz");function m(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var _=function(){return g.S.isMobile&&g.S.isIOS?v.a.createElement("div",{className:"selection-locator"}):null},k=v.a.createElement("div",{className:"docx-block-zero-space"},v.a.createElement("span",{"data-zero-space":!0},"\u200b"));function O(e){return function(n){return n.displaymode===b.J.INLINE?null:e}}var x=function(e){s()(r,e);var n=m(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"getBeforeSlot",value:function(){return O(v.a.createElement(v.a.Fragment,null,k,v.a.createElement(_,null)))}},{key:"getAfterSlot",value:function(){return O(v.a.createElement(v.a.Fragment,null,v.a.createElement(_,null),k))}}]),r}(y.A)},dx_mKvd:function(e,n,r){"use strict";(function(e){r.d(n,"L",(function(){return _}));var o=r("dx_cDf5"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_B28d"),s=r("dx_B8Bh"),u=r("dx_ZG9w"),d=r("dx_T7TM"),f=r("dx_TwmW");function h(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return p(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return p(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function p(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function v(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function g(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?v(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var b=Number(e.env.MAX_RENDERED_BLOCK_COUNT||50),y="heading";function m(e,n){(Object(f.S)()||d.T)&&console.info("[pruneClinetVars] ".concat(e," recordMap"),n&&Object.keys(n).length)}function _(e,n){var r=null===e||void 0===e?void 0:e.id,o=null===e||void 0===e?void 0:e.block_map;if(!r||!o)return console.log("pruneClientVars empty clientVars"),e;m("origin",o),I(r,o),m("removed fold",o);var i={};R(o[r])(o,i,b,n),m("pruned",i);var c=g({},i);return g(g({},e),{},{block_map:c})}function k(e,n,r){var o=e.data;if(function(e){return Object(u.S)(e)&&Object(s.K)(e.type)}(o)){var i=Object(u.W)(o);(null===i||void 0===i?void 0:i.length)&&i.forEach((function(e){var o=n[e];o&&(r[e]=o)}))}}function O(e){return Object(s.K)(e.data.type)&&e.data.folded?[]:e.data.children||[]}function x(e){return e.startsWith(y)}function E(e){return Number(e.slice(y.length))}function S(e,n,r,o){for(var i=r;i<n.length;i++){var c=e[n[i]];if(!c)return 1/0;var a=c.data.type;if(x(a)&&E(a)<=o)return i}return 1/0}function C(e,n){n&&n.forEach((function(n){var r=e[n];r&&(C(e,r.data.children),delete e[n])}))}function I(e,n){if(n&&e){var r=n[e];if(r){var o=r.data.children,i=[];if(o){for(var c=-1;++c<o.length;){var a=o[c],l=n[a];if(l){var s=l.data.type,u=x(s);if(!u&&l.data.folded)C(n,l.data.children),l.data.children=[];else if(u&&l.data.folded){var d=S(n,o,c+1,E(s));C(n,l.data.children),l.data.children=[],C(n,o.slice(Math.min(o.length,c+1),d)),c=d-1}else I(a,n);l.data.folded=!1,i.push(a)}}r.data.children=i}}}}function B(e,n,r,o,c){var a=0;if(!1===(null===c||void 0===c?void 0:c.table))a=10;else{var l=function(){if(!e)return{v:0};var i=e.id;r[i]=e;for(var c,l=r[i].data,s=l.rows_id,u=l.columns_id,d=l.cell_set,f=(c=d,Object.values(c).some((function(e){var n=e.merge_info;return n&&(n.col_span>1||n.row_span>1)}))),p=0;p<s.length;p++){var v=s[p],g=0;if(!f&&M(o,a))if("break"===function(){var e=s.splice(p);return u.forEach((function(n){e.forEach((function(e){var r="".concat(e).concat(n);d[r]&&delete d[r]}))})),"break"}())break;var b,y=h(u);try{for(y.s();!(b=y.n()).done;){var m=b.value,_="".concat(v).concat(m);if(d[_]){var k=d[_].block_id;r[k]=n[k],g=Math.max(g,R(n[k])(n,r,f?1/0:o-a))}}}catch(O){y.e(O)}finally{y.f()}a+=g}}();if("object"===i()(l))return l.v}return a}function T(e,n,r,o,i){var c=0;r[e.id]=e;var a,l=O(e),s=h(l);try{for(s.s();!(a=s.n()).done;){var u=a.value;r[u]=n[u]}}catch(v){s.e(v)}finally{s.f()}var d,f=h(l);try{for(f.s();!(d=f.n()).done;){var p=d.value;r[p]=n[p],c=Math.max(c,R(n[p])(n,r,o))}}catch(v){f.e(v)}finally{f.f()}return c}function w(e,n,r,o,i){var c=0,a=e.id;r[a]=n[a];var l,s=[],u=h(O(r[a]));try{for(u.s();!(l=u.n()).done;){var d=l.value;if(M(o,c))break;c++,s.push(d);var f=n[d];f.data.folded||(c+=R(f)(n,r,o-c))}}catch(p){u.e(p)}finally{u.f()}return k(e,n,r),r[a].data=g(g({},r[a].data),{},{children:s}),c}function R(e){var n=w;return e?(l.B.GRID===e.data.type?n=T:l.B.TABLE===e.data.type&&(n=B),function(r,o,i,c){return n(e,r,o,i,c)}):function(){return 0}}function M(e,n){return e<n}}).call(this,r("dx_o8ox"))},dx_mYvZ:function(e,n,r){"use strict";(function(t){r.d(n,"g",(function(){return e}));var e,o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_bUYd"),h=r("dx_zz3R"),p=r("dx_g0R0");function v(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return g(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function g(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function b(e){var n=setTimeout((function(){clearTimeout(n),e()}),0)}!function(e){e[e.WAITING=-1]="WAITING",e[e.PROCESSING=0]="PROCESSING",e[e.SUCCESS=1]="SUCCESS",e[e.FAILED=2]="FAILED",e[e.ERROR=3]="ERROR"}(e||(e={}));var y=function(){function n(r){var o=this;s()(this,n),this.taskMap=new Map,this.waitingList=[],this.uploadingSet=new Set,this.imageCodeToRecordIdMap=new Map,this.isPolling=!1,this.pollingTimer=null,this.collectorManager=void 0,this.flushPolling=function(){o.isPolling||o.poll()},this.poll=a()(i.a.mark((function n(){var r,c;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(0!==o.uploadingSet.size){n.next=3;break}return o.isPolling=!1,n.abrupt("return");case 3:if(o.isPolling=!0,o.clearExcessTask(),!((r=Array.from(o.imageCodeToRecordIdMap.keys())).length>0)){n.next=12;break}return n.next=9,h.q.checkImage(r);case 9:c=n.sent,c.data.forEach((function(n){var r=n.image_code,i=n.image_status,c=n.token,a=o.imageCodeToRecordIdMap.get(r),l=a&&o.taskMap.get(a);if(l)switch(l.status=i,i){case e.FAILED:case e.ERROR:o.handleDeleteTask(l),o.handleSaveFailed(l,i);break;case e.SUCCESS:l.fileToken=c,o.handleDeleteTask(l),o.handleSaveSuccess(l);case e.PROCESSING:}}));case 12:o.pollingTimer=setTimeout(o.poll,1e3);case 13:case"end":return n.stop()}}),n)}))),this.clearExcessTask=function(){var n,r=v(o.imageCodeToRecordIdMap.values());try{for(r.s();!(n=r.n()).done;){var i=n.value,c=o.taskMap.get(i);!c||c.count>0?c&&c.count--:(o.handleSaveFailed(c,e.ERROR),o.handleDeleteTask(c))}}catch(a){r.e(a)}finally{r.f()}},this.handleSaveFailed=function(e,n){Object(f.h)({type:"error",closable:!0,content:t("etherpad.image_save_failed"),duration:5e3,errorContext:Object(p.G)(new Error("handleSaveFailed failed!"))}),b((function(){return e.callback(n)})),o.collectorManager.get(e.blockId).logSaveExternalImage(e.fileToken,e.recordId,!1,e.startTime)},this.handleSaveSuccess=function(){var n=a()(i.a.mark((function n(r){return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:b((function(){return r.callback(e.SUCCESS,r.fileToken)})),o.collectorManager.get(r.blockId).logSaveExternalImage(r.fileToken,r.recordId,!0,r.startTime);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),this.handleDeleteTask=function(e){if(o.isPolling=!1,o.taskMap.has(e.recordId)&&(o.taskMap.delete(e.recordId),o.uploadingSet.delete(e.recordId),e.imageCode&&o.imageCodeToRecordIdMap.delete(e.imageCode),o.uploadingSet.size<9&&o.waitingList.length>0)){var n=o.waitingList.shift(),r=o.taskMap.get(n);r&&(o.handleStartSave(r,r.recordId),o.uploadingSet.add(r.recordId),o.flushPolling())}},this.stopTask=function(e){var n=o.taskMap.get(e);n&&o.handleDeleteTask(n)},this.destroy=function(){o.isPolling=!1,o.pollingTimer&&clearTimeout(o.pollingTimer),o.taskMap.clear(),o.uploadingSet.clear(),o.waitingList.length=0},this.collectorManager=r}return d()(n,[{key:"addTask",value:function(n,r,o,i){var c={blockId:n,recordId:r,imageUrl:o,imageCode:"",fileToken:"",count:120,callback:i,startTime:performance.now(),status:e.WAITING};this.taskMap.set(r,c),this.uploadingSet.size<9?this.handleStartSave(c,r):this.waitingList.push(r)}},{key:"handleStartSave",value:function(){var n=a()(i.a.mark((function n(r,o){var c,a;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.uploadingSet.add(r.recordId),n.prev=1,n.next=4,h.q.createImage(r.imageUrl,o);case 4:c=n.sent,a=c.data.image_code,this.imageCodeToRecordIdMap.set(a,r.recordId),r.imageCode=a,this.flushPolling(),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(1),this.handleSaveFailed(r,e.WAITING),this.handleDeleteTask(r);case 15:case"end":return n.stop()}}),n,this,[[1,11]])})));return function(e,r){return n.apply(this,arguments)}}()}]),n}();n.S=y}).call(this,r("dx_E9Eu"))},dx_mak7:function(e,n,r){"use strict";var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_h6a8"),s=function(){function e(){var n=this;i()(this,e),this.currentKey="",this.visible=!1,this.isLeaving=!1,this.onShow=l.noop,this.onHide=l.noop,this.willShow=Object(l.debounce)((function(){n.showTooltip()}),300),this.hideTimer=null,this.willHide=function(){n.hideTimer=window.setTimeout((function(){n.triggerHide(!0),n.hideTimer=null,n.visible=!1,n.currentKey=""}),200)}}return a()(e,[{key:"showTooltip",value:function(){this.onShow(!this.visible),this.visible=!0}},{key:"triggerShow",value:function(){this.visible?this.showTooltip():this.willShow()}},{key:"triggerHide",value:function(e){this.isLeaving=!1,this.onHide(e)}},{key:"clearHideTimerIfNecessary",value:function(){this.hideTimer&&(window.clearTimeout(this.hideTimer),this.hideTimer=null)}},{key:"enterItemHasTooltip",value:function(e,n,r){this.clearHideTimerIfNecessary(),this.isLeaving=!1,this.currentKey!==e&&(this.triggerHide(!1),this.currentKey=e,this.onShow=n,this.onHide=r,this.triggerShow())}},{key:"leaveItemHasTooltip",value:function(){this.isLeaving||(this.willShow.cancel(),this.isLeaving=!0,this.visible?this.willHide():this.currentKey="")}},{key:"isTooltipShowCurrentKey",value:function(e){return this.currentKey===e}}]),e}();n.S=new s},dx_md5I:function(e,n,r){"use strict";r.d(n,"N",(function(){return a}));var o=r("dx_hB37"),i=r("dx_vdIl"),c=r("dx_h6a8");function a(e,n){var r=e.getContentState(),a=r.getActiveZone(),l=function(e,n){var r=e.getActiveZone(),o={start:{line:0,offset:0},end:{line:r.length(),offset:r.getLine(r.length()-1).length()}};return r.getEntities(o).filter((function(e){var r=e.attributes;return!!r&&Object(c.isMatch)(r,n)}))}(r,n);return 0===l.length?new o.A({editor:e,start:{zoneId:i.x,line:0,offset:0},end:{zoneId:i.x,line:a.length()-1,offset:a.getLine(a.length()-1).length()-1}}):new o.A({editor:e,start:l[0].start,end:l[0].end})}},dx_miEo:function(e,n,r){"use strict";var o,i,c;r.d(n,"y",(function(){return o})),r.d(n,"o",(function(){return i})),r.d(n,"Y",(function(){return c})),function(e){e.PRELOAD="0",e.RENDER="1",e.MOVEOUT="2"}(o||(o={})),function(e){e.MANUAL="MANUAL",e.REPLAY="REPLAY"}(i||(i={})),function(e){e.Unmount="unmount",e.VC="vc",e.VC_NO_REGISTER="vc_no_register"}(c||(c={}))},dx_mkyW:function(e,n,r){"use strict";(function(t){r.d(n,"h",(function(){return F}));var e,o,i,c,a=r("dx_lwsE"),l=r.n(a),s=r("dx_W8MJ"),u=r.n(s),d=r("dx_W7W2"),f=r.n(d),h=r("dx_a1gu"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=r("dx_Uyc2"),y=r.n(b),m=r("dx_vtL4"),_=r("dx_Q1BS"),k=r("dx_N8Nu"),O=r("dx_alfx"),x=r("dx_vdIl"),E=r("dx_cDcd"),S=r.n(E),C=r("dx_e8ez"),I=r("dx_x1WV"),B=r("dx_D8nn"),T=r("dx_cHnW"),w=r("dx_FHaN"),R=r("dx_Wftd"),M=r("dx_gDjg"),j=r("dx_uOsn"),D=r("dx_wqNP"),A=r("dx_xKBv"),P=r("dx_XiKs"),L=r("dx_bPy9");function N(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}var F=(e=Object(m.R)(999),c=i=function(e){f()(r,e);var n=N(r);function r(e){var o;l()(this,r),(o=n.call(this)).inlineBlockManager=void 0,o.scroller=void 0,o.editor=void 0,o.destory=function(){B.S.off(P.F,o.handlePasteRecordAfterApply),B.S.off(P.Q,o.handlePasteRecordAfterAccepted)};var i=e.blockManager,c=e.scroller,a=e.editor;return o.inlineBlockManager=new T.m(i),o.scroller=c,o.editor=a,B.S.on(P.F,o.handlePasteRecordAfterApply),B.S.on(P.Q,o.handlePasteRecordAfterAccepted),o}return u()(r,[{key:"handlePasteRecordAfterApply",value:function(e,n,r){Object(O.Z)(e.text.initialAttributedTexts,e.text.apool).get(x.x).ops.forEach((function(e){var o;if(null===(o=e.attributes)||void 0===o?void 0:o[w.O]){var i=JSON.parse(e.attributes[w.O]);i.type===w.k.DOC?Object(M.lQ)(i,n,r):i.type===w.k.FILE&&Object(C.d)(i.data.source_block_id,r)}}))}},{key:"handlePasteRecordAfterAccepted",value:function(e,n,r){Object(O.Z)(e.text.initialAttributedTexts,e.text.apool).get(x.x).ops.forEach((function(e){var o;if(null===(o=e.attributes)||void 0===o?void 0:o[w.O]){var i=JSON.parse(e.attributes[w.O]);i.type===w.k.FILE&&i.data.need_copy_resource&&Object(C.w)(i,n,r)}}))}}]),u()(r,[{key:"match",value:function(e){return e===r.KEY}},{key:"render",value:function(e){var n,o,i=e.attributes[r.KEY],c=null===(n=e.op.insert)||void 0===n?void 0:n.length;try{o=JSON.parse(i)}catch(b){console.error("parse inline component mark fail in render, origin string is:",i,b)}if(!o)return null;var a=this.inlineBlockManager.editorAPI,l=a.modelService.getBlockModelByBlockId(Object(L.j)(e.zoneId));if(!l)return null;var s=e.lineState.getEntities([[r.KEY,i]]);if(e.key=o.id,s.length>1&&(e.key+="-".concat(Math.random())),o.type===w.k.USER){var u=o.data;return S.a.createElement(_.S,{autoSelectOnClick:!1,length:c,className:w.Y},S.a.createElement(A.S,{blockManager:a.getService(I.a),record:l.record,type:l.type,uid:u.uid,mentionId:u.mention_id,isSSR:a.config.get("isSSR"),isHistory:a.config.get("isHistory")}))}if(o.type===w.k.REMINDER)return S.a.createElement(_.S,{autoSelectOnClick:!1,length:c},S.a.createElement(D.S,{data:o,model:l,editor:this.editor}));if(o.type===w.k.DOC){var d=o.data,f=d.file_type,h=d.title,p=d.token,v=d.raw_url,g=d.tenant_id;return S.a.createElement(_.S,{autoSelectOnClick:!1,length:c,className:"mention-doc-embed-container"},S.a.createElement(R.S,{file_type:f,title:h,token:p,raw_url:v,tenant_id:g,boundary:this.scroller,blockType:l.type,block:l,componentId:o.id}))}return o.type===w.k.FILE?S.a.createElement(_.S,{autoSelectOnClick:!1,className:"embed-inline-block",length:c},S.a.createElement(j.S,{componentData:o,manager:this.inlineBlockManager})):S.a.createElement(_.S,{length:c},S.a.createElement("div",{className:"fallback-block inline"},"[",t("block.placeholder.new_app"),"]"))}}]),r}(k.o),i.init=!1,i.KEY=w.O,o=c,y()(o.prototype,"render",[e],Object.getOwnPropertyDescriptor(o.prototype,"render"),o.prototype),o)}).call(this,r("dx_E9Eu"))},dx_ml3I:function(e,n,r){"use strict";r.d(n,"S",(function(){return l}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_h6a8"),a=r("dx_cDcd");function l(e){var n=Object(a.useCallback)((function(){return window.visualViewport?window.visualViewport:{width:document.documentElement.clientWidth,height:document.documentElement.clientHeight}}),[]),r=Object(a.useState)((function(){return n()})),o=i()(r,2),l=o[0],s=o[1],u=Object(a.useCallback)((function(){s((function(e){var r=n();return Object(c.isEqual)(e,r)?e:r}))}),[]),d=Object(a.useRef)(Object(c.debounce)(u,200));return Object(a.useEffect)((function(){if(e){var n=function(){window.visualViewport&&u()},r=function(){window.visualViewport&&d.current()};return n(),window.addEventListener("resize",n),window.addEventListener("focusin",r),window.addEventListener("scroll",n),function(){window.removeEventListener("resize",n),window.removeEventListener("scroll",n),window.removeEventListener("focusin",r)}}}),[e,u]),l}},dx_mljG:function(e,n,r){"use strict";r.d(n,"W",(function(){return i}));var o=r("dx_K9Ia"),i={setFoldState$:new o.Z,setFoldStatus$:new o.Z}},dx_moB4:function(e,n,r){"use strict";r.d(n,"X",(function(){return _}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_o0o1"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_uxuX"),v=r("dx_h6a8"),g=r("dx_PciH"),b=r("dx_O1Ou");function y(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function m(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?y(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var _=function(){function e(n){var r=this;d()(this,e),this.vcController=n,this.moduleConfigMap=new Map,this.pendingBlockModuleStateMap=new Map,this.hasRegisterBlockModuleRecordIdsMap=new Map,e.instance=this,Promise.resolve().then((function(){return r.initModuleConfig()}))}return h()(e,null,[{key:"addModuleConfigGetter",value:function(){var n=s()(a.a.mark((function n(r){return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.moduleConfigGetters.push(r);case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()}]),h()(e,[{key:"setModuleConfig",value:function(){var e=s()(a.a.mark((function e(n){var r,o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.moduleName,o=n.recordIdsFromStateGetter,i=n.requiredBlockNotRegisterReplayHandler,!this.moduleConfigMap.has(r)){e.next=3;break}return e.abrupt("return");case 3:this.moduleConfigMap.set(r,{recordIdsFromStateGetter:o,requiredBlockNotRegisterReplayHandler:i}),this.moduleInit(n);case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"initModuleConfig",value:function(){var n=this;e.moduleConfigGetters.forEach((function(e){n.setModuleConfig(e(n))}))}},{key:"moduleInit",value:function(e){var n=e.moduleName,r=e.defaultState;this.vcController.register(m(m({},e),{},{from:b.Q.VC_BLOCK_HELPER,replayHandler:this.getModuleReplayAndPresenterHandler(n,p.FOLLOW_REPLAY,r),presenterHandler:this.getModuleReplayAndPresenterHandler(n,p.PRESENTER_STATE),cycleHandler:this.getModuleCycleHandler(n)}))}},{key:"getModuleReplayAndPresenterHandler",value:function(e,n,r){var o=this;return function(i){var c,a,l=i.actionType,s=i.data,u=i.uuid,d=o.vcController.blockManager;n===p.FOLLOW_REPLAY&&(null===r||void 0===r?void 0:r[l])&&!(null===(c=o.hasRegisterBlockModuleRecordIdsMap.get(e))||void 0===c?void 0:c.length)&&Object(v.isEqual)(s,r[l])&&o.vcController.reportReplay(b.s.IGNORE,u,"ignore default state by vc block helper");var f=o.moduleConfigMap.get(e),h=((null===f||void 0===f?void 0:f.recordIdsFromStateGetter(l,s))||[]).filter((function(n){var r;return!(null===(r=o.hasRegisterBlockModuleRecordIdsMap.get(e))||void 0===r?void 0:r.includes(n))}));if(o.vcController.log("%c [VC_BLOCK_HELPER] wait ".concat(e," render ").concat(h.toString()),"color: #FFCC00"),!(h.length<=0)){null===f||void 0===f||null===(a=f.requiredBlockNotRegisterReplayHandler)||void 0===a||a.call(f,i);var g=o.pendingBlockModuleStateMap.get(e)||new Map;o.pendingBlockModuleStateMap.has(e)||o.pendingBlockModuleStateMap.set(e,g),g.forEach((function(e,r){var i=e.get(l);i&&i.uuid!==u&&n===p.FOLLOW_REPLAY&&o.reportPendingModuleAction(i,r,"ignore by next action arrived"),e.delete(l)}));var y=[];h.forEach((function(e){var n=g.get(e)||new Map;g.set(e,n.set(l,i)),y=y.concat((null===d||void 0===d?void 0:d.getBlockIdsByRecordId(e))||[])})),null===d||void 0===d||d.layoutManager.renderNodeByIdSync(Object(v.uniq)(y))}}}},{key:"reportPendingModuleAction",value:function(e,n,r){if(e){if(g.L.has(e))return g.L.get(e,this.vcController,(function(e){return e.data.offsetRatioMap})).report(b.s.IGNORE,{info:r,recordId:n});this.vcController.reportReplay(b.s.IGNORE,e.uuid,r,void 0)}}},{key:"getModuleCycleHandler",value:function(e){var n=this;return function(r){if(r===p.STOP_FOLLOW){var o=n.pendingBlockModuleStateMap.get(e);null===o||void 0===o||o.forEach((function(e,r){e.forEach((function(e){n.reportPendingModuleAction(e,r,"ignore by stop follow")}))})),n.pendingBlockModuleStateMap.delete(e)}}}},{key:"destroy",value:function(){var n=this;this.pendingBlockModuleStateMap.forEach((function(e){e.forEach((function(e,r){e.forEach((function(e){n.reportPendingModuleAction(e,r,"ignore by destroy")}))}))})),this.pendingBlockModuleStateMap.clear(),this.hasRegisterBlockModuleRecordIdsMap.clear(),this.moduleConfigMap.clear(),e.instance=void 0}},{key:"notifyBlockRender",value:function(e){var n,r=this,o=e.recordId,i=e.moduleName,c=e.replayHandler,a=e.presenterHandler;this.hasRegisterBlockModuleRecordIdsMap.has(i)?null===(n=this.hasRegisterBlockModuleRecordIdsMap.get(i))||void 0===n||n.push(o):this.hasRegisterBlockModuleRecordIdsMap.set(i,[o]);var l=this.pendingBlockModuleStateMap.get(i);if(l&&l.has(o)){var s=l.get(o);s&&s.forEach((function(e){var n=function(n){return r.vcController.log("%c [VC_BLOCK_HELPER] ".concat(n," handler params: ").concat(JSON.stringify(e)),"color: #CC0066")};r.vcController.isFollow?(n("replay"),c(e)):(n("presenter"),null===a||void 0===a||a(e))})),l.delete(o)}}},{key:"notifyBlockUnmout",value:function(e){var n=e.recordId,r=e.moduleName;if(this.hasRegisterBlockModuleRecordIdsMap.has(r)){this.vcController.log("%c [VC_BLOCK_HELPER] block unmount, moduleName ".concat(r,", recordId ").concat(n,"}"),"color: #FFCC00");var o=this.hasRegisterBlockModuleRecordIdsMap.get(r).filter((function(e){return e!==n}));this.hasRegisterBlockModuleRecordIdsMap.set(r,o)}}}]),e}();_.instance=void 0,_.waitVcBlockHelperInit=void 0,_.moduleConfigGetters=[]},dx_moZV:function(e,n,r){},dx_mopU:function(e,n,r){"use strict";r.d(n,"C",(function(){return d})),r.d(n,"v",(function(){return h})),r.d(n,"U",(function(){return v})),r.d(n,"c",(function(){return g})),r.d(n,"Cn",(function(){return b})),r.d(n,"a",(function(){return y})),r.d(n,"M",(function(){return m}));var o=r("dx_xWWg"),i=r("dx_wy2R"),c=r.n(i),a=r("dx_wqNP"),l=r("dx_c3cO"),s={"GMT-11:00":"Pacific/Niue","GMT-10:00":"Pacific/Honolulu","GMT-09:00":"Pacific/Gambier","GMT-09:30":"Pacific/Marquesas","GMT-08:00":"Pacific/Pitcairn","GMT-07:00":"America/Dawson_Creek","GMT-06:00":"America/Costa_Rica","GMT-05:00":"America/Panama","GMT-04:00":"America/Puerto_Rico","GMT-03:00":"America/Argentina/Buenos_Aires","GMT-02:00":"Atlantic/South_Georgia","GMT-01:00":"Atlantic/Cape_Verde","GMT+00:00":"Etc/GMT","GMT+01:00":"Africa/Algiers","GMT+02:00":"Africa/Johannesburg","GMT+03:00":"Europe/Moscow","GMT+04:00":"Asia/Dubai","GMT+04:30":"Asia/Kabul","GMT+05:00":"Indian/Maldives","GMT+05:30":"Asia/Calcutta","GMT+06:00":"Asia/Thimphu","GMT+07:00":"Asia/Bangkok","GMT+08:00":"Asia/Shanghai","GMT+08:30":"Asia/Pyongyang","GMT+09:00":"Asia/Tokyo","GMT+10:00":"Asia/Vladivostok","GMT+11:00":"Pacific/Noumea","GMT+12:00":"Pacific/Funafuti","GMT+13:00":"Pacific/Enderbury","GMT+14:00":"Pacific/Kiritimati"};function u(e,n){return e.toString().padStart(n,"0")}function d(){var e,n,r,o,i;if("undefined"!==typeof Intl&&(null===(e=Intl)||void 0===e||null===(n=e.DateTimeFormat)||void 0===n||null===(r=n.call(e))||void 0===r||null===(o=r.resolvedOptions)||void 0===o?void 0:o.call(r)))return null!==(i=(new Intl.DateTimeFormat).resolvedOptions().timeZone)&&void 0!==i?i:"Asia/Shanghai";var c=function(){var e=(new Date).getTimezoneOffset(),n=u(Math.floor(Math.abs(e)/60),2),r=u(Math.floor(Math.abs(e)%60),2);return"GMT".concat(e<=0?"+":"-").concat(n,":").concat(r)}(),a=s[c];return a||"Asia/Shanghai"}function f(e,n){return n?"UTC":e}function h(e){var n=e.time,r=e.timezone,o=e.isAllDay,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number(new Date)/1e3,a=p({timestamp:n,timezone:f(r,o),isAllDay:o}),l=c()(1e3*i);return a.isBefore(l,o?"day":"second")||!o&&a.isSame(l,"second")?-1:l.isSame(a,"day")?0:1}function p(e){var n=e.timestamp,r=e.isAllDay;return void 0!==r&&r?c()(c.a.utc(1e3*n).format("YYYY-MM-DD")):c()(1e3*n)}function v(e){var n=e.dueTime,r=e.dueTimezone,i=e.isAllDay,c=e.reminders,a=p({timestamp:n,timezone:r,isAllDay:i}),s=a.valueOf();i&&(s=a.set(l.J).valueOf());var u=Boolean(c.filter((function(e){return-1!==e.time})).length),d=u?c[0]:void 0,f=s;d&&(d.type===o.i.ABSOLUTE&&(f=d.time),d.type===o.i.RELATIVE&&(f=i?s+(Object(l.q)(l.I,l.p,0)-324e5-60*d.time*1e3):s-60*d.time*1e3));return{reminderId:"",expireTime:s,isWholeDay:i,shouldNotify:u,notifyTime:f}}function g(e){var n=e.expireTime,r=e.isWholeDay,i=e.shouldNotify,a=e.notifyTime,s=c()(n),u=r?c.a.utc(s.format("YYYY-MM-DD")).unix():s.unix(),f=[];if(i)if(r){var h=a-n,p=(Object(l.q)(l.I,l.p,0)-324e5-h)/60/1e3|0;p&&f.push({type:o.i.RELATIVE,time:p})}else f.push({type:o.i.RELATIVE,time:(n-a)/60/1e3});return{dueTime:u,dueTimezone:r?"UTC":d(),isAllDay:r,reminders:f}}function b(e){var n=v({dueTime:e.dueTime,dueTimezone:e.dueTimezone,isAllDay:e.isAllDay,reminders:e.reminders}),r=n.isWholeDay?l.Y:l.R,o=n.notifyTime-n.expireTime,i=r.findIndex((function(e){return e.value===o}));return~i?r[i].text:""}function y(e){var n=v({dueTime:e.dueTime,dueTimezone:e.dueTimezone,isAllDay:e.isAllDay||!1,reminders:[]});return Object(a.R)(n.expireTime,n.isWholeDay)}function m(){return{dueTime:c()().add(1,"days").set({hour:18,minute:0,second:0,millisecond:0}).unix(),dueTimezone:d(),isAllDay:!1,reminders:[{type:o.i.RELATIVE,time:30}]}}c.a},dx_mvce:function(e,n,r){"use strict";r.d(n,"J",(function(){return i}));var o=r("dx_bdgK");function i(e){return new o.S(e)}},dx_mwQr:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M16.153 20.721A10.999 10.999 0 0022 11c0-6.075-4.925-11-11-11S0 4.925 0 11c0 4.213 2.369 7.873 5.847 9.721L11 24l5.153-3.279z",fill:"#3370FF"}),l=i.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10.45 6a.2.2 0 00-.2.2v4.05H6.2a.2.2 0 00-.2.2v1.1c0 .11.09.2.2.2h4.05v4.05c0 .11.09.2.2.2h1.1a.2.2 0 00.2-.2v-4.05h4.05a.2.2 0 00.2-.2v-1.1a.2.2 0 00-.2-.2h-4.05V6.2a.2.2 0 00-.2-.2h-1.1z",fill:"#fff"});n.S=function(e){return i.a.createElement("svg",c({width:22,height:24,viewBox:"0 0 22 24",fill:"none"},e),a,l)}},dx_mz66:function(e,n,r){"use strict";var o,i;r.d(n,"J",(function(){return o})),r.d(n,"i",(function(){return i})),function(e){e.Free="free",e.Proportional="proportional",e.Horizontal="horizontal",e.Vertical="vertical"}(o||(o={})),function(e){e.Left="left-horizontal",e.Right="right-horizontal",e.Top="top-vertical",e.Bottom="bottom-vertical",e.LeftTop="left-top",e.LeftBottom="left-bottom",e.RightTop="right-top",e.RightBottom="right-bottom"}(i||(i={}))},dx_n0nF:function(e,n,r){"use strict";r.d(n,"M",(function(){return i})),r.d(n,"i",(function(){return c})),r.d(n,"G",(function(){return o})),r.d(n,"u",(function(){return a}));var o,i="subscription",c="changes";!function(e){e.LOADING="LOADING",e.FAILED="FAILED",e.NORMAL="NORMAL",e.DENIED="DENIED"}(o||(o={}));var a="docx-subscription-loading"},dx_n2gE:function(e,n,r){"use strict";r.d(n,"t",(function(){return R}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_LcNA"),m=r("dx_N8Nu"),_=r("dx_yzqx"),k=r("dx_ObwN"),O=r("dx_MUMK"),x=r("dx_OJCf"),E=r("dx_kZ3l"),S=r("dx_Xdvu"),C=r("dx_zghO"),I=r("dx_AbAm"),B=r("dx_G3VO");function T(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}function w(e,n){var r=e.selection.getSelection(),o=Object(B.O)(r),i=Object(B.c)(r,!n);return!o||o&&i}var R=function(e){h()(r,e);var n=T(r);function r(e){var o;return s()(this,r),(o=n.call(this)).props=e,o.editor=void 0,o.handleKeydown=function(){var e=a()(i.a.mark((function e(n){var r,c,a,l,s,u,d,f,h,p,v,g,b,y,m,B;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=o.props,c=r.block,a=r.blockManager,l=r.selectionAPI,!(s=r.editor).getStatus("isComposing")){e.next=3;break}return e.abrupt("return");case 3:if((u=Object(x.u)(n.nativeEvent))!==O.F.onArrowUp&&u!==O.F.onArrowDown){e.next=8;break}return d=u===O.F.onArrowDown,w(s,d)&&l.setSelection([{id:c.id,type:C.j.BLOCK}]),e.abrupt("return");case 8:if(u!==O.F.onArrowRight&&u!==O.F.onArrowLeft||!s.isFocus()){e.next=13;break}if(!document.activeElement||!$(document.activeElement).hasClass("task-block-tabable")){e.next=11;break}return e.abrupt("return");case 11:return E.X(s.selection.getSelection())&&(null===(f=c.hostElement.querySelector(".task-block-tabable"))||void 0===f||f.focus({preventScroll:!0})),e.abrupt("return");case 13:if(u!==O.F.onTab&&u!==O.F.onUnTab){e.next=25;break}return n.preventEvent(),n.stopEvent(),n.nativeEvent.preventDefault(),n.nativeEvent.stopPropagation(),n.nativeEvent.stopImmediatePropagation(),h=s.selection.getSelection().toPosition(),l.setSelection([{id:c.id,type:C.j.BLOCK}]),p=c.record.id,Object(x.G)(a,u),requestAnimationFrame((function(){var e;l.removeAllSelection();var n=a.getBlockViewsByRecordId(p)[0];null===n||void 0===n||null===(e=n.editorInstance)||void 0===e||e.selection.setSelection(h,!0)})),e.abrupt("return");case 25:if(u!==O.F.onEnter){e.next=42;break}if(!n.shiftKey||(_.S.isIOS||_.S.isIPad)&&!k.S.isIPadLarkHandware()){e.next=28;break}return e.abrupt("return");case 28:if(n.preventEvent(),n.stopEvent(),n.nativeEvent.preventDefault(),n.nativeEvent.stopPropagation(),n.nativeEvent.stopImmediatePropagation(),!s.isEmpty()){e.next=36;break}return Object(I.w)(c,a),e.abrupt("return");case 36:return g=s.selection.getSelection(),b=c.editorAPI.getService(S.a).fold.isFolded(c.id),y=!b&&(null===(v=c.model.children)||void 0===v?void 0:v.length)>0,m=!E.C(g),Object(I.F)({parentBlockId:m&&y?c.id:c.parentId,insertPosition:m&&y?0:m?c.model.position+1:c.model.position,blockManager:a,forceFocus:m}),e.abrupt("return");case 42:"Backspace"===n.key&&((B=s.selection.getSelection()).isCollapsed()&&0===B.start.line&&0===B.start.offset&&s.isEmpty()?(n.preventEvent(),n.nativeEvent.preventDefault(),n.stopEvent(),n.nativeEvent.stopPropagation(),n.nativeEvent.stopImmediatePropagation(),Object(I.w)(c,a)):(n.stopPropagation(),n.nativeEvent.stopPropagation(),n.nativeEvent.stopImmediatePropagation()));case 43:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),o.editor=e.editor,o.editor.on(y.L.KEYDOWN,o.handleKeydown,0),o}return d()(r,[{key:"destroy",value:function(){this.editor.off(y.L.KEYDOWN,this.handleKeydown)}}]),r}(m.o)},dx_n3Q4:function(e,n,r){"use strict";r.d(n,"k",(function(){return s})),r.d(n,"u",(function(){return u}));var o,i=r("dx_J4zp"),c=r.n(i),a=r("dx_cDcd"),l=new(r("dx_D8nn").i);function s(e){l.trigger(o.GRID_COLUMN_RESIZING,[e])}function u(){var e=Object(a.useState)(!1),n=c()(e,2),r=n[0],i=n[1],s=Object(a.useCallback)((function(e){i(e)}),[]);return Object(a.useEffect)((function(){return l.on(o.GRID_COLUMN_RESIZING,s),function(){l.off(o.GRID_COLUMN_RESIZING,s)}}),[s]),r}!function(e){e.GRID_COLUMN_RESIZING="GRID_COLUMN_RESIZING"}(o||(o={}))},dx_n3mc:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);r("dx_TSyI");n.S=function(e){var n=e.style,r=e.children;return i.a.createElement("div",{className:"okr-section",style:n},r)}},dx_n3n9:function(e,n,r){"use strict";r.d(n,"S",(function(){return c}));var o=r("dx_lwsE"),i=r.n(o),c=function e(n){i()(this,e),this.options=n,this.blockManager=void 0,this.boundary=void 0,this.selectionAPI=void 0,this.headingModule=void 0,this.format=void 0,this.blockManager=n.blockManager,this.selectionAPI=n.selectionAPI,this.boundary=n.boundary,this.headingModule=n.headingModule}},dx_n4nI:function(e,n,r){},dx_n4v0:function(e,n,r){"use strict";r.d(n,"D",(function(){return u}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_fEKD"),a=r("dx_UTG8");function l(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?l(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;return Object(c.b)(s({text:a.InputPipe.createEmptyClientVars()},e),n)}},dx_n5nO:function(e,n,r){},dx_n5nx:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return L}));var e=r("dx_lSNA"),o=r.n(e),i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_PJYZ"),p=r.n(h),v=r("dx_W7W2"),g=r.n(v),b=r("dx_a1gu"),y=r.n(b),m=r("dx_Nsbk"),_=r.n(m),k=r("dx_UtDZ"),O=r("dx_bUYd"),x=r("dx_ahlY"),E=r("dx_l6la"),S=r("dx_c6Cp"),C=r("dx_imty"),I=r("dx_T3tg"),B=r("dx_eGDr"),T=r("dx_Ayao"),w=r("dx_D8nn"),R=r("dx_MlPX"),M=r("dx_A8lo"),j=r("dx_Rr9s");r("dx_CN0g");function D(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function A(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?D(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function P(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=_()(e);if(n){var i=_()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return y()(this,r)}}var L=function(e){g()(r,e);var n=P(r);function r(){var e;return u()(this,r),(e=n.call(this)).activeCommentId=void 0,e.startNewComment=void 0,e.setActiveCommentId=void 0,e.scrollCommentToContent=void 0,e.setOperatableUnSubmitCommentIds=void 0,e.toggleMessagePanel=void 0,e.getMessagePanelShown=void 0,e.ignoreKeydownSelector=[".page-main",".text-toolbar",".sheet-toolbar-wrapper",".bitable-float-toolbar-container",".docx-selection-hidden-textarea"],e.messagePanelShown=null,e.lastClickedMentionOptions=null,e.lastClickedCommentSource=void 0,e.handleEditorMount=function(n){console.log("[message-mention] handleEditorMount");var r=n.blockManager,o=n.viewport;e.blockManager=r,e.viewport=o,e.isEditorMount=!0,e.retryMentionClick(),k.EventEmitter.on(k.EVENTS.PC.DOCS.EDITOR_JUMP_TO_GUID_POSITION,e.handleAnchorLinkClick);try{var i=e.getMessagePanelShown();w.S.emit(R.g.DOC_COMMENT_SHOW_CHANGE,i),e.messagePanelShown=i,k.store.dispatch(Object(E.Y)(i))}catch(c){console.error("getMessagePanelShown error",c)}},e.handleAnchorLinkClick=function(e){w.S.emit(C.H.LocateBlockWithRecordId,e)},e.setCommentModule=function(n){var r=n.scroller,o=n.commentModule;e.scroller=r,e.commentModule=o,k.commentReporter.setLogContext(Object(S.d)(o,!1)),e.commentModule.on(T.M.COMMENT_POSITION_CHANGE,e.handleCommentPositionChange),e.commentModule.on(T.M.ADD_TEMP_COMMENT,e.handleAddTempComment),e.commentModule.on(T.M.START_NEW_DOC_COMMENT,e.handleStartNewDocComment),e.commentModule.on(T.M.ACTIVE_COMMENT_CHANGE,e.handleActivateCommentChange),e.commentModule.on(T.M.ACTIVATE_COMMENT,e.handleActiveComment),e.commentModule.on(T.M.DEACTIVATE_COMMENT,e.handleDeactivateComment),e.commentModule.updateAllCommentPosition(!0)},e.destroy=function(){var n;null===(n=e.controller)||void 0===n||n.destroy(),e.controller=null,k.EventEmitter.off(k.EVENTS.PC.DOCS.EDITOR_JUMP_TO_GUID_POSITION,e.handleAnchorLinkClick),e.commentModule&&(e.commentModule.off(T.M.COMMENT_POSITION_CHANGE,e.handleCommentPositionChange),e.commentModule.off(T.M.ADD_TEMP_COMMENT,e.handleAddTempComment),e.commentModule.off(T.M.START_NEW_DOC_COMMENT,e.handleStartNewDocComment),e.commentModule.off(T.M.ACTIVE_COMMENT_CHANGE,e.handleActivateCommentChange),e.commentModule.off(T.M.ACTIVATE_COMMENT,e.handleActiveComment),e.commentModule.off(T.M.DEACTIVATE_COMMENT,e.handleDeactivateComment))},e.handleSetListMethod=function(n){var r=n.startNewComment,o=n.setMessagePositions,i=n.setActiveCommentId,c=n.scrollCommentToContent,a=n.setOperatableUnSubmitCommentIds,l=n.toggleMessagePanel,s=n.getMessagePanelShown;e.startNewComment=r,e.setMessagePositions=o,e.setActiveCommentId=i,e.scrollCommentToContent=c,e.setOperatableUnSubmitCommentIds=a,e.toggleMessagePanel=l,e.getMessagePanelShown=s},e.handleSetListProps=function(){if(e.controller){var n=p()(e),r=n.onMentionClick,o=n.onCommentClick,i=n.onHoverCommentChanged,c=n.cancelNewComment,a=n.resolveComment,l=n.reopenComment,s=n.saveComment,u=n.removeComment,d=n.ignoreKeydownSelector,f=n.onGetMessagePanelShown,h=n.onPannelDisplayStateChange;e.controller.setListProps({onMentionClick:r,onCommentClick:o,onHoverCommentChanged:i,cancelNewComment:c,resolveComment:a,reopenComment:l,saveComment:s,removeComment:u,ignoreKeydownSelector:d,mentionSource:k.NUM_SUITE_TYPE.DOCX,onGetMessagePanelShown:f,onPannelDisplayStateChange:h})}},e.onPannelDisplayStateChange=function(){w.S.emit(R.g.DOC_COMMENT_SHOW_CHANGE_TRANSITION_END)},e.onGetMessagePanelShown=function(n){w.S.emit(R.g.DOC_COMMENT_SHOW_CHANGE,n),e.messagePanelShown!==n&&(e.messagePanelShown=n,k.store.dispatch(Object(E.Y)(n))),n?Object(S.J)():e.commentModule.deactivateComment(B.Fr.feedClosePanel)},e.handleStartNewDocComment=function(n){e.commentModule.startNewDocComment(n)},e.handleAddTempComment=function(n){var r=n.quote,o=n.commentId;e.toggleMessagePanel(!0),e.setOperatableUnSubmitCommentIds(o),e.commentModule.once(T.M.COMMENT_POSITION_CHANGE,l()(c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=e.commentModule.getPositionByCommentId(o))){n.next=7;break}return n.next=4,e.commentModule.commentScroller.scrollToComment(o,"handleAddTempComment");case 4:e.lastClickedCommentSource="all",e.commentModule.activeCommentChange({activeCommentId:o,prevActiveCommentId:e.activeCommentId,callSource:"FeedAddTempComment",shouldFocus:!0}),e.scrollCommentToContent(o,r.top+Object(x.y)()-e.scroller.scrollTop||0,"all");case 7:case"end":return n.stop()}}),n)})))),e.startNewComment(r,o)},e.handleActiveComment=function(n){var r=n.commentId,o=n.scrollOffset;n.from!==B.M.panel&&(e.lastClickedCommentSource="all"),e.commentModule.activeCommentChange({activeCommentId:r,prevActiveCommentId:e.activeCommentId,panelTop:o?-o:o,callSource:"FeedActiveComment"})},e.handleActivateCommentChange=function(n){var r=n.activeCommentId,o=n.shouldFocus;if(r){var i=e.commentModule.getCommentByCommentId(r);if(i&&!i.finished&&e.activeCommentId!==r){e.setActiveCommentId(r,!!o);var c=e.commentModule.getPositionByCommentId(r);if(c){var a=e.lastClickedCommentSource;e.scrollCommentToContent(r,Math.floor(c.top)+Object(x.y)()-e.scroller.scrollTop||0,a)}e.activeCommentId=r}}else e.activeCommentId=null},e.handleDeactivateComment=function(){e.setActiveCommentId(null),e.commentModule.activeCommentChange({activeCommentId:null,prevActiveCommentId:e.activeCommentId,callSource:"FeedDeactivateComment"})},e.onMentionClick=function(){var n=l()(c.a.mark((function n(r,o,i){var a,l,s,u;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=e.blockManager&&e.isAllDataReady&&e.isEditorMount,console.log("[message-mention/onMentionClick]",{mentionId:r,mentionOffsetTop:o,isReady:l,extra:i}),s=null===(a=e.blockManager)||void 0===a?void 0:a.editorAPI.getService(I.e),l){n.next=7;break}return e.lastClickedMentionOptions={mentionId:r,extra:i,mentionOffsetTop:o},null===s||void 0===s||s.startApplyAllMode(),n.abrupt("return");case 7:return n.next=9,M.c.find(r,i,e.blockManager,"lark-feed");case 9:if(u=n.sent,null===s||void 0===s||s.stopApplyAllMode(),void 0!==u){n.next=14;break}return e.showToast(),n.abrupt("return");case 14:M.c.scroll(A(A({},u),{},{mentionId:r,mentionOffsetTop:o,extra:i}),{viewport:e.viewport,blockManager:e.blockManager},e.showToast,"lark-feed");case 15:case"end":return n.stop()}}),n)})));return function(e,r,o){return n.apply(this,arguments)}}(),e.showToast=function(){k.Toast.remove(j.C),Object(O.v)({key:j.C,duration:3e3,closable:!0,content:t("feed.mention_deleted")})},e.onCommentClick=function(n,r,o){var i=n.is_whole,c=n.comment_id,a=n.comment_list;i?e.tryToScrollToWholeComment(c,a[0].reply_id):(e.lastClickedCommentSource=o,e.tryToActiveComment(n.comment_id,r))},e.onHoverCommentChanged=function(n,r){var o=null,i=null;n&&(o=n.commentId),r&&(i=r.commentId),e.commentModule.hoverCommentChange({hoverCommentId:i,prevHoverCommentId:o,activeCommentId:e.activeCommentId})},e.cancelNewComment=function(n){var r;null===(r=e.commentModule.getInnerCommentModule())||void 0===r||r.cancelComment({commentId:n.commentId})},e.resolveComment=function(){var n=l()(c.a.mark((function n(r,o){var i;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=e.commentModule.getInnerCommentModule()){n.next=3;break}return n.abrupt("return");case 3:return n.next=5,i.resolveComment({commentId:o.commentId});case 5:e.commentModule.handleCommentDidResolve(o.commentId);case 6:case"end":return n.stop()}}),n)})));return function(e,r){return n.apply(this,arguments)}}(),e.reopenComment=function(e,n){},e.saveComment=function(n,r){var o,i=(new Date).valueOf(),c=null===(o=e.commentModule.getInnerCommentModule())||void 0===o?void 0:o.data.getComment(n.commentId);c&&(c.update({commentId:r,createTime:i,finishTime:i,unSubmitted:!1,updateTime:i}),e.commentModule.handleCommentChange([],{addedComments:[],deletedComments:[],resolveStatusChangedComments:[],updatedComments:[c]},{type:T.K.REMOTE}));var a,l,s=e.getPositionList(),u=s.find((function(e){return e.commentId===n.commentId}));u&&(u.commentId=r,null===(a=(l=e).setMessagePositions)||void 0===a||a.call(l,s));e.commentModule.handleCommentDidAdd(n.commentId,r),e.commentModule.activateComment(r,void 0,B.M.newComment)},e.removeComment=function(n,r){var o=T.K.LOCAL;n.toUpperCase()!==T.K.LOCAL&&(o=T.K.REMOTE),e.commentModule.handleCommentChange([],{addedComments:[],deletedComments:[r],resolveStatusChangedComments:[],updatedComments:[]},{type:o})},e.retryMentionClick=function(){if(e.lastClickedMentionOptions){var n=e.lastClickedMentionOptions,r=n.mentionOffsetTop,o=n.mentionId,i=n.extra;e.lastClickedMentionOptions=null,setTimeout((function(){e.onMentionClick(o,r,i)}),0)}},e.defaultClickedCommentSource=B.M.panel,e.controller=new k.MessageController(k.EventEmitter),e.controller.onSetListMethod(e.handleSetListMethod),e.handleSetListProps(),e}return f()(r,[{key:"handleAllDataReady",value:function(){console.log("[message-mention] handleAllDataReady"),this.isAllDataReady=!0,this.retryMentionClick(),this.retryCommentClick()}},{key:"tryToScrollToWholeComment",value:function(e,n){this.commentModule.scrollToWholeComment(e,n)}}]),r}(j.S)}).call(this,r("dx_E9Eu"))},dx_n6nb:function(e,n,r){},dx_n71n:function(e,n,r){"use strict";(function(t){var e=r("dx_lSNA"),o=r.n(e),i=r("dx_PcQO"),c=r("dx_TSYQ"),a=r.n(c),l=r("dx_h6a8"),s=r("dx_cDcd"),u=r.n(s),d=r("dx_Yz4Z"),f=r("dx_MBBr"),h=(r("dx_INf6"),"okr-combo-progress");n.S=function(e){var n=e.progressStatus,r=e.start,c=e.current,s=e.target,p=e.onStatusChange,v=void 0===p?l.noop:p,g=r.error||c.error||s.error,b=Object(d.S)(16);return u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:a()("".concat(h,"__field"),"".concat(h,"__field-gap"))},u.a.createElement("div",{className:"".concat(h,"__field")},t("CreationDoc_Docs_OKR_Status")),u.a.createElement("div",{className:"".concat(h,"__field-controller")},u.a.createElement(f.S,{value:n,onChange:v}))),u.a.createElement("div",{className:a()("".concat(h,"__field"),o()({},"has-error",g))},u.a.createElement("div",null,u.a.createElement("div",{className:"".concat(h,"__field-column")},u.a.createElement("div",{className:"".concat(h,"__field-title")},t("CreationDoc_Docs_OKR_Status_Start")),u.a.createElement("div",{className:a()("".concat(h,"__field-controller"),o()({},"has-error",r.error))},u.a.createElement(i.Input,Object.assign({maxLength:15},r,{error:!!r.error})))),u.a.createElement("div",{className:"".concat(h,"__field-column")},u.a.createElement("div",{className:"".concat(h,"__field-title")},t("CreationDoc_Docs_OKR_Status_Current")),u.a.createElement("div",{className:a()("".concat(h,"__field-controller"),o()({},"has-error",c.error))},u.a.createElement(i.Input,Object.assign({ref:b,maxLength:15},c,{error:!!c.error})))),u.a.createElement("div",{className:"".concat(h,"__field-column")},u.a.createElement("div",{className:"".concat(h,"__field-title")},t("CreationDoc_Docs_OKR_Status_Target")),u.a.createElement("div",{className:a()("".concat(h,"__field-controller"),o()({},"has-error",s.error))},u.a.createElement(i.Input,Object.assign({maxLength:15},s,{error:!!s.error}))))),g&&u.a.createElement("div",{className:"".concat(h,"--error")},g)))}}).call(this,r("dx_E9Eu"))},dx_n8nr:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return ne}));var e=r("dx_RIqP"),o=r.n(e),i=r("dx_lSNA"),c=r.n(i),a=r("dx_o0o1"),l=r.n(a),s=r("dx_J4zp"),u=r.n(s),d=r("dx_yXPU"),f=r.n(d),h=r("dx_lwsE"),p=r.n(h),v=r("dx_W8MJ"),g=r.n(v),b=r("dx_iWIM"),y=r.n(b),m=r("dx_W7W2"),_=r.n(m),k=r("dx_a1gu"),O=r.n(k),x=r("dx_Nsbk"),E=r.n(x),S=r("dx_jtB3"),C=r("dx_QxNg"),I=r("dx_PcQO"),B=r("dx_TSYQ"),T=r.n(B),w=r("dx_cDcd"),R=r.n(w),M=r("dx_bdgK"),j=r("dx_mwQr"),D=r("dx_WLRK"),A=r("dx_rQGm"),P=r("dx_PQBD"),L=r("dx_MoY1"),N=r("dx_zEdG"),F=r("dx_CwnG"),U=r("dx_qkDo"),H=r("dx_B28d"),V=r("dx_JWrU"),W=r("dx_GWFd"),z=r("dx_MGoZ"),G=r("dx_n3Q4"),K=r("dx_QBqw"),q=r("dx_iw8O"),X=r("dx_tp1j"),Y=r("dx_Tsyy"),J=r("dx_GzEb"),Z=r("dx_xFJs");r("dx_SIER");function Q(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function $(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Q(Object(r),!0).forEach((function(n){c()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ee(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=E()(e);if(n){var i=E()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return O()(this,r)}}var te=function(e,n,r){return Object(K.V)(e,n)?r>=Y.s:r>=Y.S},ne=function(e){_()(r,e);var n=ee(r);function r(){var e;p()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).isAlignHorizontal=!0,e.idRatioMap=new Map,e.currentMultiBlockInLine=null,e.notifiedResizing=!1,e.ref=Object(w.createRef)(),e.dragInfo={x:0,y:0,columnGapIndex:-1,width:0},e.subs=void 0,e.containerResizeObserver=void 0,e.state={draggingColumnGapIndex:-1,draggerKey:1,parentContainerWidth:window.innerWidth,isFocus:!1},e.updateCurrentMultiBlockInLine=function(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=e.model,o=r.children,i=null;if(o.length<2)return e.currentMultiBlockInLine=null,!1;for(var c=0;c<o.length;c++){var a=o[c],l=a.children[0];if(l){if(i){if(i===l.type)continue;i=null;break}i=l.type}}var s=i&&e.currentMultiBlockInLine===i;return i===H.B.IMAGE&&n&&Object(Z.q)(!!s),e.currentMultiBlockInLine=i,s},e.updateGridAndColumnSize=function(){var n=e.model;if(n.children.length<2)e.currentMultiBlockInLine=null;else{var r=e.state.parentContainerWidth,o=n.children.map((function(e){return e.children[0]})),i=Object(Z.T)(e.currentMultiBlockInLine,r,o)||[];i.length>=2&&e.blockManager.applyTransaction("updateGridAndChildBlockRatio",(function(e){n.children.forEach((function(n,r){e.replace(n.recordId,["width_ratio"],i[r].widthRatio),e.replace(i[r].id,["image","scale"],i[r].scale)}))}))}},e.watchContainerResize=function(){var n,r=null===(n=e.hostElement)||void 0===n?void 0:n.parentElement;if(r){var o=new M.S(e.updateParentContainerWidth);o.observe(r),e.containerResizeObserver=o}},e.stopWatchContainerResize=function(){var n;null===(n=e.containerResizeObserver)||void 0===n||n.disconnect(),delete e.containerResizeObserver},e.updateParentContainerWidth=function(){var n,r=null===(n=e.hostElement)||void 0===n?void 0:n.parentElement;if(r&&e.blockManager.layoutManager.isBlockActive(e.id)){var o=r.clientWidth;e.setState({parentContainerWidth:o},(function(){var n=te(e.blockManager,e.id,o);e.isAlignHorizontal!==n&&(e.isAlignHorizontal=n,e.editorAPI.getService(J.B).saveCalculateModel(e.props.blockId,e.isAlignHorizontal),e.blockManager.layoutManager.didUpdateNode(e.id,!0))}))}},e.handleRecordChange=function(n){e.updateCurrentMultiBlockInLine(),e.editable&&n.options.from===C.H.local&&e.checkRemoveSelf()},e.handleFocusChange=function(n){e.state.isFocus!==n&&e.setState({isFocus:n})},e.checkRemoveSelf=f()(l.a.mark((function n(){var r,o,i,c,a,s,d,f,h,p,v,g,b,y;return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!((r=e.model).children.length>1)){n.next=3;break}return n.abrupt("return");case 3:return e.currentMultiBlockInLine=null,1===(o=e.selectionAPI.getSelection()).length&&(d=u()(o,1),f=d[0],h=f.selection,p=f.type,h&&(v=h.start,g=h.end,"text"===p&&h&&g-v===0&&(i=f.id,a=v,s=g))),n.next=8,e.blockManager.applyTransaction("checkRemoveSelfInGridBlock",(function(n){var o=r.parent.record.id,a=r.position+1;r.children.forEach((function(r){Object(L.y)(n,r.children.map((function(e){return e.id})),e.blockManager),r.children.forEach((function(e){var r=Object(L.t)(n,o,a++,[e.record.id]);i&&e.id===i&&(c=r[0])}))})),Object(L.y)(n,[r.id],e.blockManager)}));case 8:c&&(b=e.blockManager.getBlockIdsByRecordId(c)[0],null===(y=e.blockManager.getBlockViewByBlockId(b))||void 0===y||y.setBlockFocus(!0),null===y||void 0===y||y.model.setSelection({start:a,len:s-a},!0));case 9:case"end":return n.stop()}}),n)}))),e.handleMouseDown=function(n,r){if(e.editable&&"path"!==n.target.tagName){var o=e.ref.current?e.ref.current.getBoundingClientRect().width:0;e.dragInfo={x:n.clientX,y:n.clientY,columnGapIndex:r,width:o},e.setState({draggingColumnGapIndex:r}),document.body.classList.add("grid-block-dragging"),document.addEventListener(U.K.mousemove,e.handleMouseMove),document.addEventListener(U.K.mouseup,e.handleMouseUp)}},e.handleMouseMove=function(n){if(e.editable){e.notifiedResizing||(e.notifiedResizing=!0,e.blockManager.dispatch(A.ln,!0),Object(G.k)(!0));var r=n.clientX-e.dragInfo.x;e.changeWidthRatio(e.dragInfo.columnGapIndex,r)}},e.handleMouseUp=function(){e.editable&&(e.notifiedResizing=!1,e.blockManager.dispatch(A.ln,!1),Object(G.k)(!1),document.removeEventListener(U.K.mousemove,e.handleMouseMove),document.removeEventListener(U.K.mouseup,e.handleMouseUp),e.saveWidthRatio(),document.body.classList.remove("grid-block-dragging"),e.setState({draggingColumnGapIndex:-1}),e.dragInfo={x:0,y:0,columnGapIndex:-1,width:0})},e}return g()(r,[{key:"blockViewDidMount",value:function(){var e=this;y()(E()(r.prototype),"blockViewDidMount",this).call(this),this.updateCurrentMultiBlockInLine(!1);var n=this.editorAPI.modelService;this.subs=[n.change$.subscribe(this.handleRecordChange)],X.S.register(this.id,this.handleFocusChange),this.updateParentContainerWidth(),setTimeout((function(){e.watchContainerResize()}),100)}},{key:"blockViewWillUnmount",value:function(){var e;y()(E()(r.prototype),"blockViewWillUnmount",this).call(this),this.stopWatchContainerResize(),null===(e=this.subs)||void 0===e||e.forEach((function(e){return e.unsubscribe()})),this.subs=void 0,this.editorAPI.getService(J.B).deleteCalculateModel(this.props.blockId),X.S.unregister(this.id,this.handleFocusChange)}},{key:"enterBuffer",value:function(){this.updateParentContainerWidth()}},{key:"changeWidthRatio",value:function(e,n){var r=n/this.dragInfo.width,o=this.getColumnByIndex(e),i=this.getColumnByIndex(e+1),c=o.props.record.snapshot.width_ratio,a=i.props.record.snapshot.width_ratio;c+r<Y.R&&(r=Y.R-c),a-r<Y.R&&(r=a-Y.R);var l=(c+a)/2-c,s=Math.round(10*(c+r))/10-c;Math.abs(l-r)<.01?r=l:Math.abs(s-r)<.01&&(r=s),this.idRatioMap.set(o.id,c+r),o.setState({widthRatio:c+r}),this.idRatioMap.set(i.id,a-r),i.setState({widthRatio:a-r})}},{key:"saveWidthRatio",value:function(){var e=this,n=this.blockManager.getBlockModelByBlockId(this.id).children.map((function(n){var r=n.id;return e.blockManager.getBlockViewByBlockId(r)}));this.blockManager.applyTransaction("saveWidthRatio",(function(r){n.forEach((function(n){var o=n.model.snapshot.width_ratio,i=n.state.widthRatio;o!==i&&Object(N.P)("ccm_doc_content_page_click",Object(F.m)(n.id,e.blockManager),{click:"block_resize",before_size:"1x".concat(Math.round(100*o)),after_size:"1x".concat(Math.round(100*i))}),r.replace(n.record.id,["width_ratio"],n.state.widthRatio)}))}))}},{key:"getColumnByIndex",value:function(e){var n=this.blockManager.getBlockModelByBlockId(this.id).children[e].id;return this.blockManager.getBlockViewByBlockId(n)}},{key:"addColumnToRight",value:function(){var e=f()(l.a.mark((function e(n){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.t)({blockManager:this.blockManager,gridBlockId:this.id,columnIndex:n+1,transactionName:"clickAddColumnBtn",highlight:!0});case 2:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"renderChildren",value:function(e){var n=this,r=this.props,o=r.blockId,i=r.record,a=r.recursionProps,l=a.blockManager,s=i.snapshot.children||[],u=this.editable&&s.length<Y.t;return R.a.createElement(S.R,{id:o,reconciler:l.layoutManager.getReconciler(),renderChild:function(r,o,i){var a=Object(W.c)(V.S,r),d=a?Object(W.l)(V.S,r):r,f=l.getRecordByBlockId(d).id,h=2*s.indexOf(f)+(a?1:0),p=h===2*s.length-1,v=Math.floor(h/2),g=n.state.draggingColumnGapIndex===v;if(a){i.className=T()("column-gap j-column-gap",{dragging:g,disabled:p});var b=c()({},U.t.mousedown,p?void 0:function(e){return n.handleMouseDown(e,v)});return R.a.createElement("div",Object.assign({contentEditable:!1,className:"column-gap-inner",key:p?"dragger-last":"dragger-".concat(n.state.draggerKey,"-").concat(v)},b),u&&!g&&R.a.createElement(I.Tooltip,{title:t("CreationDoc_Docs_DocXBlock_AddColumn_Title"),placement:"top",popupAlign:{targetOffset:[0,8]},mouseEnterDelay:300},R.a.createElement("div",{className:"circle",onClick:function(){Object(N.P)("ccm_doc_content_page_click",Object(F.m)(n.id,n.blockManager),{click:"block_custom_action",action_type:"click_add_column",object_block_data:Object(F.T)([n.id],n.blockManager)}),n.setState({draggerKey:n.state.draggerKey+1}),n.addColumnToRight(v)}},R.a.createElement(D.S,{className:"circle-dot"}),R.a.createElement(j.S,{className:"add-column"}))),n.editable&&R.a.createElement("div",{className:T()("dragger-hot-spots",{"editable-cursor":n.editable})},R.a.createElement("div",{className:"dragger"})))}var y=l.getBlockModelByBlockId(r),m=n.idRatioMap.get(r);return m||(m=y.record.snapshot.width_ratio,n.idRatioMap.set(r,m)),n.editorAPI.viewService.render(r,{recursionProps:Object.assign({},n.props.recursionProps,{isInGrid:!0}),hostElementRef:o,isVertical:e,style:Object(Z.j)(n.blockManager,r,e)})},className:"grid-render-unit",childContainerTag:Object(W.c)(V.S,o)?"div":void 0,watchProps:$($({},a),{},{childrenIds:s,isVertical:e,draggingColumnGapIndex:this.state.draggingColumnGapIndex})})}},{key:"render",value:function(){var e=this.state,n=e.parentContainerWidth,r=e.isFocus,o=e.draggingColumnGapIndex,i=!te(this.blockManager,this.id,n);return R.a.createElement("div",{className:T()("grid-block","j-grid-block",{"grid-vertical":i,"grid-horizontal":!i,"grid-focus":r,"grid-editable":this.editable,"grid-dragging":-1!==o}),ref:this.ref},this.renderChildren(i))}},{key:"isWithBoundary",get:function(){return!0}},{key:"currentMultiBlockInLineValue",get:function(){return this.currentMultiBlockInLine}}],[{key:"isValidParentType",value:function(e,n){return e===H.B.PAGE||!(!n||Object(P.o)(H.B.GRID,n))&&[H.B.PROGRESS,H.B.CELL].concat(o()(H.BM)).includes(e)}},{key:"getClosestGridBlockId",value:function(e){var n=e.closest(".j-grid-block");return n&&Object(q.S)(n)||null}},{key:"selectionTargetFilter",value:function(e){return!e.closest(".j-grid-block .j-column-gap")}}]),r}(z.l);ne.blockForLayoutNodeBuilder=new J.B}).call(this,r("dx_E9Eu"))},dx_nAwp:function(e,n,r){"use strict";r.d(n,"T",(function(){return s}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_dIhn"),s=function(){function e(){i()(this,e),this.taskList=[],this.isPerformTasks=!1}return a()(e,[{key:"addTask",value:function(e){var n=this;this.taskList.push(e);this.isPerformTasks||(this.isPerformTasks=!0,Object(l.f)((function e(r){for(;r.timeRemaining()>0&&n.taskList.length>0;){var o=n.taskList.shift();o&&o()}n.taskList.length>0?Object(l.f)(e):n.isPerformTasks=!1})))}},{key:"destroy",value:function(){this.taskList.length=0}}]),e}()},dx_nFCg:function(e,n,r){"use strict";(function(t){r.d(n,"b",(function(){return a})),r.d(n,"C",(function(){return l})),r.d(n,"G",(function(){return s}));var e=r("dx_QRvo");function o(n){return n<=0||n>e.O}function i(n){return n.length>e.G}function c(n){return e.f.test(n)}function a(e){var n=e.name,r=e.size;return!(i(n)||c(n)||o(r))}function l(e){for(var n=0,r=0;r<e.length;r++)e.charCodeAt(r)>127||94===e.charCodeAt(r)?n+=2:n+=1;return n>20?"".concat(e.substring(0,10),"..."):e}function s(n){var r,a=l(n.name);if(i(n.name))r="\u300c".concat(a,"\u300d ").concat(t("drive.file_name_valid"));else if(c(n.name))r="\u300c".concat(a,"\u300d ").concat(t("CreationDoc_Alert_FileNameInvalid_Toast"));else if(o(n.size)){var s=Math.floor(e.O/1024/1024/1024);r="\u300c".concat(a,"\u300d ").concat(t("CreationDoc_Drive_Upload_Failed_ZeroOrTooLarge",void 0,"","".concat(s)))}return r}}).call(this,r("dx_E9Eu"))},dx_nJBA:function(e,n,r){},dx_nQiu:function(e,n,r){"use strict";r.d(n,"P",(function(){return o})),r.d(n,"Y",(function(){return i})),r.d(n,"W",(function(){return c})),r.d(n,"L",(function(){return a})),r.d(n,"Z",(function(){return l})),r.d(n,"N",(function(){return s})),r.d(n,"LB",(function(){return u})),r.d(n,"z",(function(){return d})),r.d(n,"S",(function(){return f}));var o="overlay-container",i=180,c=720,a=1080,l=230,s=340,u=190,d=42,f=[0,-8]},dx_nTXv:function(e,n,r){"use strict";(function(t){var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_lwsE"),l=r.n(a),s=r("dx_PJYZ"),u=r.n(s),d=r("dx_iWIM"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_W7W2"),g=r.n(v),b=r("dx_a1gu"),y=r.n(b),m=r("dx_Nsbk"),_=r.n(m),k=r("dx_TSYQ"),O=r.n(k),x=r("dx_UtDZ"),E=r("dx_cDcd"),S=r.n(E),C=r("dx_bUYd"),I=r("dx_gK2j"),B=r("dx_yzqx"),T=r("dx_Fimk"),w=r("dx_eSV8"),R=r("dx_g0R0"),M=r("dx_B28d"),j=r("dx_MGoZ"),D=r("dx_zghO"),A=r("dx_D8nn"),P=r("dx_gLp6"),L=r("dx_OYpu"),N=r("dx_iyIx"),F=r("dx_jMMO");r("dx_IsMn");function U(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=_()(e);if(n){var i=_()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return y()(this,r)}}window.isSSR&&r.e("dx_VOQc").then(r.t.bind(null,"dx_jqNq",7)).then((function(e){window.DiagramViewerModule=e})).catch((function(){window.DiagramViewerModule=null}));var H=function(e){g()(r,e);var n=U(r);function r(e){var i;return l()(this,r),(i=n.call(this,e)).diagramViewer=void 0,i.viewerModule=void 0,i.loadingOvertimeSetTimeout=void 0,i.diagramRecordManager=void 0,i.containerDom=null,i.isEditMode=!1,i.svgCache=null,i.isSvgCacheExpired=!1,i.isRendered=!1,i.state={svg:null,isSelected:!1,isDiagramLoadingError:!1},i.notifyLoadingPlaceholderClear=function(e){i.blockManager.layoutManager.notifyRenderFinish(i.id),i.isRendered=!0,i.props.onBlockReady&&i.props.onBlockReady(),i.setState({isDiagramLoadingError:e})},i.handleRecordChange=function(e){i.isSvgCacheExpired=!0,i.diagramRecordManager.handleRecordChange(e),!i.isEditMode&&i.updateSvg()},i.handleClick=N.I.bind(u()(i)),i.enterEditMode=function(){var e=c()(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(x.isOnline)()&&!x.diagramResourceLoader.loaded){e.next=10;break}if(i.isEditMode=!0,n!==P.G.AUTO){e.next=5;break}return e.next=5,Object(w.E)(400);case 5:return e.next=7,x.graphEditorManager.enter({manager:i.diagramRecordManager,blockId:i.id,blockElement:i.containerDom&&i.containerDom.firstChild,diagramType:i.snapshot.diagram.diagramType,docxblockInstance:u()(i)});case 7:Object(T.N)("click_enter_full_screen",{source:n,block_type:"diagram",block_subtype:i.snapshot.diagram.diagramType}),e.next=11;break;case 10:Object(C.h)({content:t("LarkCCM_DocX_EditFlowchart_OfflineEditFailed"),errorContext:Object(R.G)(new Error("get custom service link failed"))});case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),i.exitEditMode=function(){x.graphEditorManager.exit()},i.handleExitGraphEditor=function(){var e=i.snapshot.diagram.diagramType;i.isEditMode&&(i.isEditMode=!1,i.updateSvg(),i.selectionAPI.setSelection([{id:i.id,type:D.j.BLOCK}]),Object(T.N)("click_exit_full_screen",{source:"click_btn",block_type:"diagram",block_subtype:e}))},i.isBlankDiagram=function(){return i.model.isBlankDiagram()},i.setRef=function(e){i.containerDom=e},i.getSvg=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return i.diagramViewer?1===e?(i.svgCache&&!i.isSvgCacheExpired||(i.svgCache=i.diagramViewer.getSvg(null,e,B.S.isMobile?12:16),i.isSvgCacheExpired=!1),i.svgCache):i.diagramViewer.getSvg(null,e,B.S.isMobile?12:16):null},i.exportImage=function(){x.graphEditorManager.exportImage(i.id,u()(i))},i.tryToHideLoading=function(){i.props.onBlockReady&&(i.state.svg&&i.props.onBlockReady())},i.diagramBlockRetry=function(){Object(x.isOnline)()&&(i.props.updateOuterLoadingComponent(i.props.loadingComponent),i.setState({isDiagramLoadingError:void 0}),i.blockViewDidMount())},i.diagramRecordManager=new F.S(i.blockManager,(function(){return i.snapshot}),i.record.id,i.props.recursionProps.undoModule),i.props.onRecordChange(i.handleRecordChange),i}return p()(r,[{key:"pageToken",get:function(){return this.props.editorAPI.config.get("token")}},{key:"isEditable",get:function(){return this.props.editorAPI.config.editable}},{key:"isBlockRendered",get:function(){return this.isRendered}},{key:"isSSR",get:function(){return this.editorAPI.config.get("isSSR")}}]),p()(r,[{key:"showPreview",value:function(){A.N.emit(A.p.COMMON.OPEN_IMAGE_VIEWER,this)}},{key:"blockViewDidMount",value:function(){var e=c()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f()(_()(r.prototype),"blockViewDidMount",this).call(this),e.next=3,this.initDiagramViewer();case 3:this.updateSvg(!0),x.EventEmitter.on(P.Q.EXIT_GRAPH_EDITOR,this.handleExitGraphEditor),A.N.on(A.p.COMMON.SHOW_OOPS,this.exitEditMode),this.blockManager.dispatch(P.Q.LOADED,this),this.tryToHideLoading();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"blockViewWillUnmount",value:function(){f()(_()(r.prototype),"blockViewWillUnmount",this).call(this),this.isRendered=!1,x.EventEmitter.off(P.Q.EXIT_GRAPH_EDITOR,this.handleExitGraphEditor),A.N.off(A.p.COMMON.SHOW_OOPS,this.exitEditMode),this.isEditMode&&(this.blockManager.isUnmount?(this.exitEditMode(),this.handleExitGraphEditor()):x.graphEditorManager.exitWithBlockId(this.id)),this.diagramViewer.destroy(),this.loadingOvertimeSetTimeout&&clearTimeout(this.loadingOvertimeSetTimeout)}},{key:"updateSvg",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.viewerModule){var r,o,i=this.viewerModule.diagramRecord2Xml,c=i(this.snapshot.diagram);if(this.diagramViewer.decode(c),n)r=(null===(o=this.props.blockSSRDom)||void 0===o?void 0:o.querySelector(".docx-diagram-displayer_svg svg"))||this.diagramViewer.getSvg(null,1,2);else r=this.diagramViewer.getSvg(null,1,2);this.setState({svg:r},(function(){e.tryToHideLoading(),e.blockManager.layoutManager.notifyNodeHeightChange(e.id)})),this.isRendered=!0}}},{key:"initDiagramViewer",value:function(){var e=c()(o.a.mark((function e(){var n,r=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.loadingOvertimeSetTimeout=window.setTimeout((function(){r.notifyLoadingPlaceholderClear(!0),r.loadingOvertimeSetTimeout=void 0}),2e4),e.next=4,x.diagramResourceLoader.getDiagramViewer();case 4:this.viewerModule=e.sent,clearTimeout(this.loadingOvertimeSetTimeout),this.loadingOvertimeSetTimeout=void 0,n=this.viewerModule.DiagramViewer,this.diagramViewer=new n,this.state.isDiagramLoadingError&&this.setState({isDiagramLoadingError:!1}),e.next=17;break;case 12:e.prev=12,e.t0=e.catch(0),this.notifyLoadingPlaceholderClear(!0),clearTimeout(this.loadingOvertimeSetTimeout),this.loadingOvertimeSetTimeout=void 0;case 17:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"setSelected",value:function(e){this.setState({isSelected:e})}},{key:"removeXmlnsAttr",value:function(e){var n=this;e&&e.children.length&&Array.from(e.children).forEach((function(e){e.removeAttribute("xmlns"),n.removeXmlnsAttr(e)}))}},{key:"renderSvg",value:function(){var e=this;if(!window.DiagramViewerModule)return null;var n=window.DiagramViewerModule,r=n.DiagramViewer,o=n.diagramRecord2Xml,i=new r,c=o(this.snapshot.diagram);i.decode(c);var a=i.getSvg(null,1,2);return a.querySelectorAll("foreignObject").forEach((function(n){e.removeXmlnsAttr(n)})),a}},{key:"render",value:function(){var e,n=this.props,r=n.isShowLoading,o=n.syncCursorSelected,i=n.syncCursorBorderColor,c=this.state,a=c.svg,l=c.isSelected,s=c.isDiagramLoadingError?{id:this.model.id,type:this.model.type}:void 0;return S.a.createElement(I.S,{onClickRetry:this.diagramBlockRetry,loadingError:s,style:{height:220}},S.a.createElement("div",{onClick:this.handleClick,ref:this.setRef,className:O()("docx-diagram-displayer-container",{hidden:r})},S.a.createElement(L.S,{svg:this.isSSR?this.renderSvg():a,diagramType:this.snapshot.diagram.diagramType,selected:l,syncCursorSelected:o,syncCursorBorderColor:i,isBlankDiagram:this.isBlankDiagram,width:null===(e=this.hostElement)||void 0===e?void 0:e.clientWidth})))}}]),r}(j.l);H.type=M.B.DIAGRAM,n.S=H}).call(this,r("dx_E9Eu"))},dx_nWLU:function(e,n,r){"use strict";var o;r.d(n,"W",(function(){return o})),function(e){e[e.success=0]="success",e[e.offlineError=1]="offlineError",e[e.insertBlockError=2]="insertBlockError",e[e.createTokenError=3]="createTokenError"}(o||(o={}))},dx_nd1Q:function(e,n,r){"use strict";r.d(n,"a",(function(){return c}));var o=r("dx_zEdG"),i=r("dx_CwnG"),c=function(){Object(o.P)("ccm_doc_content_page_click",Object(i.F3)(),{click:"click_add_cover_button",target:"ccm_doc_cover_choose_panel_view"})}},dx_nddJ:function(e,n,r){"use strict";r.d(n,"G",(function(){return i})),r.d(n,"J",(function(){return l}));var o,i,c=r("dx_lSNA"),a=r.n(c);!function(e){e.comment="comment",e.alignLeft="align_left",e.alignRight="align_right",e.alignCenter="align_center",e.codeCopy="code_copy",e.codeLanguageSwitch="code_language_switch",e.codeAutoWrap="code_auto_wrap",e.fontColor="text_color",e.backgroundColor="background_color",e.clearColor="clear_color",e.fullScreen="full_screen",e.fileDownload="file_donwload",e.refreshPage="refresh_page",e.openPage="open_page",e.borderColor="border_color",e.randomColor="random_color",e.gridDownload="grid_download",e.gridEdit="grid_edit",e.openJira="open_jira",e.syncJira="synchronize_jira",e.threeStateSwitch="three_state_switch"}(i||(i={}));var l={comment:i.comment,refresh:i.refreshPage,download:i.gridDownload,edit:i.gridEdit,fullscreen:i.fullScreen,redirect:i.openPage,"align left":i.alignLeft,"align center":i.alignCenter,"align right":i.alignRight,threeStateSwitch:i.threeStateSwitch,open_jira:i.openJira,synchronize_jira:i.syncJira};o={},a()(o,i.alignLeft,!0),a()(o,i.alignCenter,!0),a()(o,i.alignRight,!0)},dx_neHd:function(e,n,r){"use strict";r.d(n,"b",(function(){return v}));var o,i=r("dx_RIqP"),c=r.n(i),a=r("dx_lSNA"),l=r.n(a),s=r("dx_a8pA"),u=r("dx_DwtJ"),d=r("dx_QxNg"),f=(o={},l()(o,u.x.RefreshOnly,[d.e.HANDLE_NEWCHANGES_NOT_EXIST_RECORD,d.e.VERSION_TOO_OLD,s.y.TooOldPage,s.y.CursorExpired,s.y.BlockCountOverLimit,s.y.DataMigrate,s.y.TooManyChildrenInBlock,s.y.TooManyTableCell,s.y.TooManyTableColumn,s.y.DataMigrate]),l()(o,u.x.CopyRefresh,[s.y.ParamEmptyOrInvalid,s.y.DataDeleted,s.y.DataNotFound,s.y.RequestExceedLimit,s.y.ServerException,s.y.OverLimitChanges,s.y.TooManyPageOperation,d.e.APPLY_FAILED,d.e.CHANGE_CALLBACK_ERROR,d.e.ILLEGAL_RECORD_SNAPSHOT,d.e.ENTITY_NOT_EXIST,d.e.SET_VERSION_ERROR,d.e.SET_LOCAL_FAILED,d.e.COLLECT_FAILED,d.e.SUBMIT_OVER_TIME]),l()(o,u.x.ContactUs,[s.y.Unknown,s.y.AlgorithmFail,s.y.SchemaInvalid,s.y.MountPointError,s.y.IdConflict,d.e.COMPOSE_TO_LOCAL_FAILED,d.e.TRANSFORM_X_FAILED,d.e.TRANSFORM_Y_FAILED,d.e.BLOCK_BUILD_FAILED]),l()(o,u.x.PermissionDenied,[s.y.PermissionDenied,d.e.NO_PERMISSION]),l()(o,u.x.OverLimit,[s.y.BlockCountOverLimit,s.y.TooManyChildrenInBlock]),l()(o,u.x.Noop,[s.y.OverLimitQuota]),l()(o,u.x.NotOops,[d.e.NETWORK_ERROR]),o);function h(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function p(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?h(Object(r),!0).forEach((function(n){l()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var v=p(p({},f),{},l()({},u.x.NotOops,[].concat(c()(f[u.x.NotOops]),[s.y.LoginRequired])))},dx_nesn:function(e,n,r){"use strict";r.d(n,"S",(function(){return O}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_cDcd"),b=r("dx_K8h1"),y=r("dx_Vau3"),m=r("dx_D8nn"),_=r("dx_B1Bt");function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var O=function(e){d()(r,e);var n=k(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"toggleBlockMask",value:function(e,n){var r=this.blockManager.getBlockViewByBlockIdNotCheck(e);r&&r.blockMaskManager.toggleMask("reminder-highlighted",n,{backgroundColor:b.uY.BLOCK_BG_HOVER})}},{key:"getEffect",value:function(){var e=this;return function(n){var r=Object(g.useState)(!1),o=i()(r,2),c=o[0],a=o[1],l=n.model.id,s=Object(g.useCallback)((function(){var e;(null===(e=_.Z.block)||void 0===e?void 0:e.id)===l&&a(!0)}),[l]),u=Object(g.useCallback)((function(){var e=_.Z.block;e&&e.id!==l||a(!1)}),[l]),d=Object(g.useCallback)((function(e){e.prev.blockId!==e.curr.blockId&&(e.prev.blockId===l&&a(!1),e.curr.blockId===l&&a(!0))}),[l]);Object(g.useEffect)((function(){return m.N.on(_.X.OPEN_POPOVER,s),m.N.on(_.X.UPDATE_POPOVER,d),m.N.on(_.X.CLOSE_POPOVER,u),function(){m.N.off(_.X.OPEN_POPOVER,s),m.N.off(_.X.UPDATE_POPOVER,d),m.N.off(_.X.CLOSE_POPOVER,u)}}),[s,u,d]),Object(g.useEffect)((function(){e.toggleBlockMask(l,c)}),[c,l]),Object(g.useEffect)((function(){e.toggleBlockMask(l,!1)}),[l])}}}]),r}(y.A)},dx_nheZ:function(e,n,r){},dx_niVl:function(e,n,r){"use strict";var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_gwTP"),s=r("dx_CwnG"),u=function(){function e(){i()(this,e),this.setStatus=void 0,this.loadStatus=void 0,this.sendEventWithDelay=void 0,this.setStatus=!1,this.loadStatus=!1}return a()(e,[{key:"initEvent",value:function(){return new l.a("ccm_doc_cover_choose_panel_click",l.v.Click,Object(s.F3)(),{click:"click_choose_cover"})}},{key:"applyCover",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.setStatus=!0,this.sendEventWithDelay&&this.sendEventWithDelay.setExtraData(e),this.send(n)}},{key:"loadCover",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loadStatus=!0,this.sendEventWithDelay&&this.sendEventWithDelay.setExtraData(e),this.send()}},{key:"init",value:function(){this.loadStatus=this.setStatus=!1,this.sendEventWithDelay=this.initEvent()}},{key:"send",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.sendEventWithDelay&&(e||this.setStatus&&this.loadStatus)&&(this.sendEventWithDelay.send(),this.setStatus=this.loadStatus=!1,this.sendEventWithDelay=null)}}]),e}();n.S=new u},dx_nq8x:function(e,n,r){"use strict";r.d(n,"n",(function(){return c}));var o,i=r("dx_FBWK");function c(e){i.isNativeFrame?window.open(e):(o||(o=document.createElement("iframe"),document.body.appendChild(o)),o).src=e}},dx_nsra:function(e,n,r){},dx_nwMI:function(e,n,r){"use strict";r.d(n,"f",(function(){return x}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_PJYZ"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_h6a8"),b=r("dx_cDcd"),y=r.n(b);function m(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}function _(e,n){return Math.min(n.length-1,Math.max(0,e))}function k(e){return e<=0?0:e+1}function O(e,n){var r=e.startIndex,o=e.endIndex,i=e.viewportItemNum;return{fixedStartIndex:_(Math.min(r,n.length-i),n),fixedEndIndex:_(Math.max(o,i),n)}}var x=function(e){d()(r,e);var n=m(r);function r(e){var o;i()(this,r),(o=n.call(this,e)).scroller=null,o.offViewportHeightOrOffsetTopChange=null,o.handleScroll=Object(g.throttle)((function(){o.updateRangeToRender()}),50,{leading:!0}),o.lastScrollTop=0,o.updateRangeToRender=function(e){var n=o.props.itemHeight,r=a()(o).lastScrollTop,i=e?o.props.initScrollTop:o.getScrollTop();o.lastScrollTop=i;var c=i<r,l=o.getViewportHeight(),s=i+l/2-o.calculateContainerOffsetTop(),u=Math.max(0,Math.ceil(s/n)),d=o.getViewportItemNum(l),f=Math.ceil(d/2);if(c){var h=u-f-f,p=u+f;o.setRenderRange({startIndex:h,endIndex:p,viewportItemNum:d})}else{var v=u-f-1,g=u+f+f;o.setRenderRange({startIndex:v,endIndex:g,viewportItemNum:d})}},o.beforePlaceholderRef=Object(b.createRef)(),o.afterPlaceholderRef=Object(b.createRef)(),o.placeholderWidth=0;var c=o.props.isSSR?100:0;return o.placeholderWidth=o.props.initPlaceholderWidth,o.state={startIndex:0,endIndex:c,renderRangeBeforeFix:{startIndex:0,endIndex:c,viewportItemNum:0}},o}return s()(r,null,[{key:"getDerivedStateFromProps",value:function(e,n){var r=O(n.renderRangeBeforeFix,e.listData),o=r.fixedStartIndex,i=r.fixedEndIndex;return o!==n.startIndex||i!==n.endIndex?{startIndex:o,endIndex:i}:null}}]),s()(r,[{key:"componentDidMount",value:function(){this.bindEvents()}},{key:"componentWillUnmount",value:function(){this.unbindEvents()}},{key:"componentDidUpdate",value:function(e,n){e.listData.length!==this.props.listData.length&&this.updateRangeToRender(),this.props.onPaint({prevListData:e.listData.slice(n.startIndex,k(n.endIndex)),newListData:this.props.listData.slice(this.state.startIndex,k(this.state.endIndex)),prevFullData:e.listData,newFullData:this.props.listData})}},{key:"bindEvents",value:function(){var e;this.offViewportHeightOrOffsetTopChange||(this.scroller=this.containerRef.current.closest(this.props.scroller),null===(e=this.scroller)||void 0===e||e.addEventListener("scroll",this.handleScroll,{passive:!0}),this.offViewportHeightOrOffsetTopChange=this.props.onViewportHeightOrOffsetTopChange(this.updateRangeToRender),this.updateRangeToRender(!0))}},{key:"unbindEvents",value:function(){var e,n;this.handleScroll.cancel(),null===(e=this.scroller)||void 0===e||e.removeEventListener("scroll",this.handleScroll),this.scroller=null,null===(n=this.offViewportHeightOrOffsetTopChange)||void 0===n||n.call(this),this.offViewportHeightOrOffsetTopChange=null}},{key:"getViewportHeight",value:function(){return this.props.getViewportHeight()}},{key:"calculateContainerOffsetTop",value:function(){var e=this.containerRef.current;if(!e||!this.scroller)return 0;for(var n=this.scroller,r=0,o=e;o&&o!==n;)r+=o.offsetTop,o=o.offsetParent;return r}},{key:"getScrollTop",value:function(){var e,n;return null!==(e=null===(n=this.scroller)||void 0===n?void 0:n.scrollTop)&&void 0!==e?e:0}},{key:"getViewportItemNum",value:function(e){return Math.ceil(e/this.props.itemHeight)}},{key:"setRenderRange",value:function(e){var n=O(e,this.props.listData),r=n.fixedStartIndex,o=n.fixedEndIndex;Object.assign(this.state.renderRangeBeforeFix,e),r===this.state.startIndex&&o===this.state.endIndex||this.setState({startIndex:r,endIndex:o})}},{key:"setPlaceholderWidth",value:function(e){this.placeholderWidth!==e&&(this.placeholderWidth=e,this.beforePlaceholderRef.current&&(this.beforePlaceholderRef.current.style.minWidth="".concat(e,"px")),this.afterPlaceholderRef.current&&(this.afterPlaceholderRef.current.style.minWidth="".concat(e,"px")))}},{key:"render",value:function(){var e,n=this,r=this.state,o=r.startIndex,i=r.endIndex,c=this.props,a=c.listData,l=c.itemHeight,s=c.className,u=c.style,d=c.getBeforePlaceholderHeight,f=this.placeholderWidth,h=a.slice(o,i+1),p="".concat(null!==(e=null===d||void 0===d?void 0:d(h,o))&&void 0!==e?e:o*l,"px"),v="".concat((a.length-1-i)*l,"px");return y.a.createElement("ul",{className:s,style:u,ref:this.containerRef},y.a.createElement("li",{className:"fixed-size-list-placeholder",ref:this.beforePlaceholderRef,style:{height:p,minWidth:f}}),h.map((function(e,r){return n.props.renderItem(e,r+o)})),y.a.createElement("li",{className:"fixed-size-list-placeholder",ref:this.afterPlaceholderRef,style:{height:v,minWidth:f}}))}},{key:"containerRef",get:function(){return this.props.containerRef}}]),r}(b.PureComponent)},dx_o2oA:function(e,n,r){"use strict";r.d(n,"I",(function(){return o}));var o="block-paste-placeholder"},dx_o3oO:function(e,n,r){"use strict";r.d(n,"W",(function(){return o}));var o=".template-center-preview__wrapper.docx-container-wrapper"},dx_o54o:function(e,n,r){"use strict";r.d(n,"T",(function(){return D}));var o,i,c,a,l,s=r("dx_lwsE"),u=r.n(s),d=r("dx_W7W2"),f=r.n(d),h=r("dx_a1gu"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=r("dx_Vvd7"),y=r("dx_yG8O"),m=r.n(y),_=r("dx_W8MJ"),k=r.n(_),O=r("dx_Uyc2"),x=r.n(O),E=(r("dx_A1AB"),r("dx_xjz2")),S=r("dx_b28D"),C=r("dx_NUzf"),I=r("dx_OyqL"),B=r("dx_BH3T"),T=r("dx_x1WV"),w=r("dx_mljG"),R=Object(S.e)("block:block-mask-updater"),M=Object(E.s)(I.W)((i=function(){function e(){var n=this;u()(this,e),m()(this,"blockManager",c,this),m()(this,"editorAPI",a,this),this.maskSubs=[],this.blockListeners=new Map,this.lastBlockRects=new Map,this.handleOverflowBlockChange=function(e,r){Object(B.T)(e.type)&&n.handleBlockChange(e.id,!1,!0,r)},this.handleBlockUnmount=function(e,r){var o=e.id;n.lastBlockRects.delete(o),n.removeBlockListener(o),Object(B.T)(e.type)&&n.handleBlockChange(e.id,!1,!1,r)},this.handleBlockChange=function(e,r,o,i){var c=n.getParentListeners(e,r);if(c.length){var a=n.blockManager.getBlockModelByBlockId(e);if(!(o&&Object(B.T)(a.type))||n.checkAndCacheBlockRect(e)){var l="".concat(i,".").concat(a.type,"-").concat(a.id);c.forEach((function(e){return e(l)}))}}}}return k()(e,[{key:"addBlockListener",value:function(e,n){this.blockListeners.set(e,n),this.addMaskListeners("addBlock")}},{key:"removeBlockListener",value:function(e){this.blockListeners.delete(e),this.blockListeners.size||this.removeMaskListeners("removeBlock.empty")}},{key:"addMaskListeners",value:function(e){var n=this;if(!(this.maskSubs.length>0)){R("%s: add mask listeners",e);var r=this.editorAPI,o=r.viewService,i=r.modelService;this.maskSubs=[o.blockViewMount$.subscribe((function(e){return n.handleOverflowBlockChange(e.blockView.model,"viewMount")})),o.blockViewUnmount$.subscribe((function(e){return n.handleBlockUnmount(e.blockView.model,"viewUnmount")})),o.blockViewUpdate$.subscribe((function(e){return n.handleOverflowBlockChange(e.blockView.model,"viewUpdate")})),i.blockModelStructUpdate$.subscribe((function(e){return n.handleBlockChange(e.model.id,!0,!0,"modelStructUpdate")})),w.W.setFoldStatus$.subscribe((function(e){return n.handleBlockChange(e.blockId,!0,!0,"setFoldStatus.".concat(e.folded))}))]}}},{key:"removeMaskListeners",value:function(e){this.maskSubs.length&&(R("%s: remove mask listeners",e),this.maskSubs.forEach((function(e){return e.unsubscribe()})),this.maskSubs=[])}},{key:"getParentListeners",value:function(e,n){var r=this,o=this.editorAPI.modelService.getBlockModelAncestorPathByBlockId(e);return n&&o.push(e),o.map((function(e){return r.blockListeners.get(e)})).filter((function(e){return e}))}},{key:"checkAndCacheBlockRect",value:function(e){var n=this.blockManager.getBlockViewByBlockId(e).getExtendedContentRect();return!Object(C.P)(n,this.lastBlockRects.get(e))&&(this.lastBlockRects.set(e,n),!0)}}]),e}(),c=x()(i.prototype,"blockManager",[T.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=x()(i.prototype,"editorAPI",[b.Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=i))||o;function j(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}var D=Object(b.H)({providers:[M]})(l=function(e){f()(r,e);var n=j(r);function r(){return u()(this,r),n.apply(this,arguments)}return r}(b.G))||l},dx_o68o:function(e,n,r){"use strict";r.d(n,"Q",(function(){return l})),r.d(n,"i",(function(){return s})),r.d(n,"A",(function(){return u}));var o=r("dx_FBWK"),i=r("dx_UtDZ"),c=r("dx_AA3h"),a=r("dx_yzqx");function l(){return Object(o.isShortCut)()||(a.S.isMobile?Object(c.getFgMobileTrueInDev)(c.FG_MOBILE_KEYS.WIKI_DOCX_CATALOG_ENABLED):Object(i.getMinaConfig)("ccm.wiki.docx_catalog_block_enabled",!1))}function s(){return Object(o.isShortCut)()||(a.S.isMobile?Object(c.getFgMobileTrueInDev)(c.FG_MOBILE_KEYS.WIKI_DOCX_RECENT_BLOCK_ENABLED):Object(i.getMinaConfig)("ccm.wiki.docx_recent_block_enabled",!1))}function u(){return Object(i.getMinaConfig)("ccm.wiki.docx_block_new_tag_enabled",!1)}},dx_o6oG:function(e,n,r){"use strict";r.d(n,"c",(function(){return O})),r.d(n,"L",(function(){return x}));var o,i=r("dx_rQGm"),c=r("dx_vOIB"),a=r("dx_FNDK"),l=r("dx_lSNA"),s=r.n(l),u=r("dx_RIqP"),d=r.n(u),f=r("dx_PQBD"),h=r("dx_B28d"),p=r("dx_F81q"),v={allowTypes:[]},g={},b={allowTypes:[].concat(d()(h.hI),[h.B.QUOTE_CONTAINER,h.B.TASK])},y={allowTypes:p.T},m={checkIsAllowBlock:function(e){return![h.B.TABLE,h.B.SHEET,h.B.BITABLE,h.B.OKR,h.B.OBJECTIVE,h.B.KEY_RESULT,h.B.PROGRESS].includes(e)}},_=(o={},s()(o,h.B.IMAGE,v),s()(o,h.B.DIVIDER,v),s()(o,h.B.CHAT_CARD,v),s()(o,h.B.DIAGRAM,v),s()(o,h.B.IFRAME,v),s()(o,h.B.SHEET,v),s()(o,h.B.FILE,v),s()(o,h.B.MINDMAP,v),s()(o,h.B.QUOTE,v),s()(o,h.B.BULLET,g),s()(o,h.B.ORDERED,g),s()(o,h.B.TODO,g),s()(o,h.B.TEXT,g),s()(o,h.B.HEADING1,g),s()(o,h.B.HEADING2,g),s()(o,h.B.HEADING3,g),s()(o,h.B.HEADING4,g),s()(o,h.B.HEADING5,g),s()(o,h.B.HEADING6,g),s()(o,h.B.HEADING7,g),s()(o,h.B.HEADING8,g),s()(o,h.B.HEADING9,g),s()(o,h.B.CODE,{allowTypes:[].concat(d()(h.hI),[h.B.CODE]),onlyInTextSelection:!0}),s()(o,h.B.OKR,{allowTypes:[h.B.OBJECTIVE,h.B.KEY_RESULT,h.B.PROGRESS]}),s()(o,h.B.OBJECTIVE,{allowTypes:[h.B.KEY_RESULT,h.B.PROGRESS]}),s()(o,h.B.KEY_RESULT,{allowTypes:[h.B.PROGRESS]}),s()(o,h.B.PROGRESS,{allowTypes:[].concat(d()(h.O),d()(h.BM),[h.B.IMAGE,h.B.VIEW,h.B.GRID,h.B.GRID_COLUMN]),allowExitRecusion:!0}),s()(o,h.B.CALLOUT,b),s()(o,h.B.GRID_COLUMN,{checkIsAllowBlock:function(e,n){return e!==h.B.BITABLE&&(![h.B.OKR,h.B.OBJECTIVE,h.B.KEY_RESULT,h.B.PROGRESS].includes(e)&&(Object(f.o)(h.B.PROGRESS,n)?_[h.B.PROGRESS].allowTypes.includes(e):!Object(f.o)(h.B.TABLE,n)||![h.B.TABLE,h.B.SHEET].includes(e)))}}),s()(o,h.B.TABLE,m),s()(o,h.B.CELL,m),s()(o,h.B.QUOTE_CONTAINER,y),o),k=r("dx_xVHQ"),O="BLOCK_FORCE_ALLOW";function x(e,n,r,o,l){if(!r.children||0===r.children.length)return r;var s=r.children[0].depth,u=Object(c.q)(r);if(s>i.p||u>i.w)return r.children=[],void Object(k.F)();var d=r.children.reduce((function(i,c){var s,u=c.type;(function(e,n,r,o,i){var c=!0,l=r;function s(r,c){if(o===O)return!0;var l;if(!e.getBlockModelCreatorByBlockType(o))return null===i||void 0===i||null===(l=i.onNoCreator)||void 0===l||l.call(i),!1;if(!c)return!0;var s=!Object(a.m)(n);return!(!c.onlyInTextSelection||!s)||(c.checkIsAllowBlock?c.checkIsAllowBlock(o,r):c.allowTypes?c.allowTypes.includes(o):!c.banTypes||!c.banTypes.includes(o))}for(;l;){var u=l.type,d=_[u];if(d&&d.allowExitRecusion&&s(l,d)){c=!0;break}if(!s(l,d)){c=!1;break}l=l.parent}return c})(e,n,r,u,l)?(i.push(c),x(e,n,c,o,l)):null===l||void 0===l||null===(s=l.onFilterInvalidBlock)||void 0===s||s.call(l,c);return i}),[]);r.children=d}},dx_o7oA:function(e,n,r){},dx_o8Rd:function(e,n,r){"use strict";var o=document.createElement("style");o.type="text/css";var i=document.body.appendChild(o).sheet,c={},a=function(e){var n=-1,r=e instanceof RegExp;return[].find.call(i.cssRules,(function(o,i){var c=o.selectorText;return r?!!e.test(c)&&(n=i,!0):c===e&&(n=i,!0)})),n},l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=a(e);-1!==n&&i.deleteRule(n)};n.S={hasRule:function(e){return-1!==a(e)},hasRuleById:function(e){return!!e&&!!c[e]},insertRule:function(e,n){var r=i.cssRules,o=r.length?r.length:0,a=i.insertRule(e,o);if(n){var l=r[a];l instanceof CSSStyleRule&&(c[n]=l.selectorText)}},deleteRuleById:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=c[e];n&&(l(n),delete c[e])},deleteRulesByRegExp:function(e,n){if(e){for(var r=i.cssRules,o=[],a=r.length-1;a>=0;a--){var l=r[a];if(l instanceof CSSStyleRule){var s=l.selectorText;s.match(e)&&(o.push(s),i.deleteRule(a))}}n&&o.find((function(e){for(var n in c)if(c[n]===e)return delete c[n],!0;return!1}))}},deleteRuleBySelectorText:l}},dx_o9oe:function(e,n,r){"use strict";r.d(n,"a",(function(){return i})),r.d(n,"d",(function(){return c})),r.d(n,"F",(function(){return a}));var o=r("dx_UtDZ");function i(){return Object(o.getMinaConfig)("ccm.docx.mention_doc_quick_share_enable",!1)}var c=function(){return Object(o.getMinaConfig)("ccm.doc.use_file_preview_com",!1)};function a(){return Object(o.getMinaConfig)("ccm.permission.set_embed_restricted_client",!1)}},dx_oCtg:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return I}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_FBWK"),p=r("dx_PcQO"),v=r("dx_TSYQ"),g=r.n(v),b=r("dx_cDcd"),y=r.n(b),m=r("dx_BaZy"),_=r.n(m),k=r("dx_yzqx"),O=r("dx_SpiB"),x=r("dx_c0wU");r("dx_eYtq");function E(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var S=_()({loader:function(){return r.e("dx_fXN").then(r.bind(null,"dx_Vjtp"))},loading:function(){return null}}),C=_()({loader:function(){return r.e("dx_fXN").then(r.bind(null,"dx_kKxQ"))},loading:function(){return y.a.createElement(p.Loading,null)}}),I=function(e){l()(r,e);var n=E(r);function r(){var e;o()(this,r);for(var i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).visible=!1,e.state={visible:!1},e.handleEmojiSelect=function(n){n.id&&e.props.onEmojiSelect(n.id),e.toggleVisible()},e.toggleVisible=function(){if(!k.S.isMobile&&e.props.editable&&(e.setState({visible:!e.visible}),e.visible=!e.visible,e.visible)){var n=e.props.selectionAPI,r=n.getSelection();n.isSingleTextSelection(r)&&!n.isCursor(r)&&n.removeAllSelection()}},e.handleVisibleChange=function(n){e.visible=n,e.setState({visible:n})},e.renderPicker=function(){return y.a.createElement(S,{native:!0,showPreview:!1,i18n:O.c,onSelect:e.handleEmojiSelect,recent:Object(x.O)(),emojisToShowFilter:function(e){var n=e.unified;return!!O.ie[n]},color:Object(h.getThemeColorByToken)("text-link-hover")})},e}return c()(r,[{key:"render",value:function(){var e=y.a.createElement("div",{onClick:this.toggleVisible,className:g()("callout-block-emoji",{disabled:!this.props.editable||k.S.isMobile})},y.a.createElement(C,{emoji:this.props.emojiId||O.L[0],size:20,native:!0}));return!this.props.editable||k.S.isMobile?e:y.a.createElement(p.Popover,{visible:this.state.visible,content:this.renderPicker(),trigger:"click",placement:"bottom",onVisibleChange:this.handleVisibleChange,overlayClassName:"callout-emoji-picker-popover",destroyOnHide:!0},y.a.createElement(p.Tooltip,{title:t("CreationDoc_Docs_CalloutBlock_ChangeIcon_Toast"),placement:"top"},e))}}]),r}(b.PureComponent)}).call(this,r("dx_E9Eu"))},dx_oDE6:function(e,n,r){"use strict";r.d(n,"U",(function(){return o})),r.d(n,"u",(function(){return l})),r.d(n,"t",(function(){return a})),r.d(n,"l",(function(){return s})),r.d(n,"o",(function(){return u})),r.d(n,"E",(function(){return d})),r.d(n,"D",(function(){return f})),r.d(n,"q",(function(){return h}));var o,i=r("dx_B28d"),c=r("dx_XW5M");!function(e){e.AddColumn="add_column",e.MentionPeople="mention_people",e.MentionPage="mention_page",e.Reminder="reminder",e.SaveAsTemplate="save_as_template",e.Link="link",e.NewPage="new_page",e.Copy="copy",e.CopyLink="copy_link",e.CopyLiveQuote="copy_live_quote",e.Cut="cut",e.Delete="delete",e.ConvertToPage="convert_to_page",e.Comment="comment",e.AddBelow="add_below",e.DebugUseLocalResource="debug_use_local_resource",e.DebugReload="debug_reload",e.Embeds="embeds",e.OKR="okr",e.Template="template",e.More="more",e.BlockStyle="block_style",e.Align="align",e.AlignLeft="align_left",e.AlignCenter="align_center",e.AlignRight="align_right",e.Indent="indent",e.IncreaseIndentation="increase_indentation",e.ReduceIndentation="reduce_indentation",e.Bold="bold",e.Strikethrough="strikethrough",e.Italic="italic",e.Underline="underline",e.InlineCode="inline_code",e.TextHighlight="text_highlight",e.SinglePoll="single_poll",e.MultiplePoll="multiple_poll",e.Jira="jira",e.JiraIssue="jira_issue",e.JiraFilter="jira_filter"}(o||(o={}));var a,l=new Set([c.t.BlockToolbar]);!function(e){e[e.NotMatchLevel=0]="NotMatchLevel",e[e.LowGroupLevel=1]="LowGroupLevel",e[e.LowItemLevel=2]="LowItemLevel",e[e.HighGroupLevel=3]="HighGroupLevel",e[e.HighItemLevel=4]="HighItemLevel"}(a||(a={}));var s=[i.B.GRID,i.B.TABLE,i.B.CELL,i.B.GRID_COLUMN,i.B.OBJECTIVE,i.B.KEY_RESULT,i.B.PROGRESS,i.B.QUOTE_CONTAINER],u=[i.B.PAGE],d=900,f=480,h=640},dx_oDxX:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M6.813 1.648l5.349 5.348-5.349 5.35a.375.375 0 000 .53l.53.53a.375.375 0 00.53 0l5.88-5.88a.75.75 0 000-1.06L7.873.586a.375.375 0 00-.53 0l-.53.531a.375.375 0 000 .53z",fill:"#646A73"}),l=i.a.createElement("path",{d:"M.138 1.648l5.349 5.348-5.349 5.35a.375.375 0 000 .53l.53.53a.375.375 0 00.53 0l5.88-5.88a.75.75 0 000-1.06L1.198.586a.375.375 0 00-.53 0l-.53.531a.375.375 0 000 .53z",fill:"#646A73"});n.S=function(e){return i.a.createElement("svg",c({width:14,height:14,viewBox:"0 0 14 14",fill:"none"},e),a,l)}},dx_oECv:function(e,n,r){"use strict";r.d(n,"D",(function(){return A}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_N9dL"),g=r("dx_B28d"),b=r("dx_L0LN"),y=r("dx_lSNA"),m=r.n(y),_=r("dx_NOtv"),k=r.n(_),O=r("dx_n4v0"),x=r("dx_z0z2");function E(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function S(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?E(Object(r),!0).forEach((function(n){m()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}k()("getStruct");var C,I,B=r("dx_sGRh"),T=r("dx_HcsW"),w=r("dx_SreQ"),R=r("dx_T7TM"),M=r("dx_RPzs"),j=r("dx_GFgd");function D(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var A=(C=Object(p.H)({providers:[T.V,{provide:v.RecordSnapshotCreator,useValue:{type:g.B.CODE,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.B.CODE;return Object(O.D)(S({language:localStorage.getItem(x.i)||x.E,wrap:!1},e),n)}}}]}),C(I=function(e){s()(r,e);var n=D(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"blocks",get:function(){return[[B.R,{viewCreator:Object(w.i8)()||R.T?M.Y:j.Y,options:this.options.getTextEditorOptions()}]]}}]),r}(b.h))||I)},dx_oJay:function(e,n,r){"use strict";r.d(n,"w",(function(){return h}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_B28d"),s=r("dx_ZG9w"),u=r("dx_kZ3l"),d=r("dx_hDVN"),f=r("dx_Sj0J");function h(e){return p.apply(this,arguments)}function p(){return(p=a()(i.a.mark((function e(n){var r,o,c,a,h,p,v,g,b,y;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.block,o=n.blockManager,c=n.mark,a=n.needReplaceRangeText,h=void 0!==a&&a,p=n.needAddNewBlock,v=n.range,g=r,b=[0,0],Object(s.U)(r)&&(v?b=v:r.model.isEmpty?b=[0,0]:(y=Object(f.N)(r,c).toPosition(),b=[y.start,y.start+y.len]),h&&r.replaceTextAndUpdateSelection(u.j(r,b),null)),!p){e.next=9;break}return e.next=7,Object(d.S)({blockManager:o,blocks:[r],newBlockType:l.B.TEXT});case 7:g=e.sent,b=[0,0];case 9:return e.abrupt("return",Promise.resolve([g,b]));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},dx_oQO4:function(e,n,r){"use strict";var o,i,c,a;r.d(n,"v",(function(){return o})),r.d(n,"J",(function(){return i})),r.d(n,"u",(function(){return c})),function(e){e.COLUMN="column",e.ROW="row"}(o||(o={})),function(e){e.COL="col",e.ROW="row"}(i||(i={})),function(e){e.cell="cell",e.cellInner="cellInner"}(c||(c={})),function(e){e.SCROLL="scroll"}(a||(a={}))},dx_oWrv:function(e,n,r){"use strict";r.d(n,"Y",(function(){return o}));var o=8e3},dx_oZYG:function(e,n,r){"use strict";(function(t){r.d(n,"k",(function(){return i})),r.d(n,"S",(function(){return c})),r.d(n,"l",(function(){return a}));var e,o=r("dx_hB4y");!function(e){e.LOOK_UP="LOOK_UP",e.SELECT="SELECT",e.SELECT_ALL="SELECT_ALL",e.CUT="CUT",e.COPY="COPY",e.PASTE="PASTE",e.COMMENT="COMMENT",e.DELETE="DELETE",e.EDIT="EDIT",e.OPEN_LINK="OPEN_LINK",e.COPY_LINK="COPY_LINK",e.CUT_LINK="CUT_LINK",e.COMMENT_LINK="COMMENT_LINK",e.COMMENT_VIEW="COMMENT_VIEW",e.OPEN_ORIGIN_LINK="OPEN_ORIGIN_LINK",e.VIEW_ABBREVIATION="VIEW_ABBREVIATION",e.IGNORE_ABBREVIATION="IGNORE_ABBREVIATION"}(e||(e={}));e.LOOK_UP,Object(o.v)(t("mobile.menu.look_up")),e.SELECT,Object(o.v)(t("mobile.menu.select")),e.SELECT_ALL,Object(o.v)(t("mobile.menu.select_all"));var i={id:e.CUT,text:Object(o.v)(t("mobile.menu.cut"))},c={id:e.COPY,text:Object(o.v)(t("mobile.menu.copy"))},a={id:e.PASTE,text:Object(o.v)(t("mobile.menu.paste"))};e.COMMENT,Object(o.v)(t("mobile.menu.comment")),e.EDIT,Object(o.v)(t("mobile.menu.edit")),e.OPEN_LINK,Object(o.v)(t("mobile.menu.open_link")),e.COPY_LINK,Object(o.v)(t("mobile.menu.copy_link")),e.CUT_LINK,Object(o.v)(t("mobile.menu.cut_link")),e.COMMENT_LINK,Object(o.v)(t("mobile.menu.comment_link")),e.COMMENT_VIEW,Object(o.v)(t("CreationDoc_ViewComments")),e.OPEN_ORIGIN_LINK,Object(o.v)(t("CreationDoc_Docs_WebBookmark_Open_Tooltip")),e.VIEW_ABBREVIATION,Object(o.v)(t("CreationDoc_Docs_Teampedia_Tap")),e.IGNORE_ABBREVIATION,Object(o.v)(t("CreationDoc_Docs_Teampedia_Off"))}).call(this,r("dx_E9Eu"))},dx_oftt:function(e,n,r){"use strict";var o=r("dx_Z2Zw");r.d(n,"D",(function(){return o.D})),r.d(n,"n",(function(){return o.n}))},dx_og6C:function(e,n,r){"use strict";r.d(n,"R",(function(){return u}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_AA3h"),a=r("dx_ahlY"),l=(r("dx_NLUy"),r("dx_D8nn")),s=r("dx_BB1U");function u(e){var n=e.rectInfo,r=e.useAnimate,o=void 0===r||r,u=window._currentViewHeight||window.innerHeight,d=window.scrollY,f=s.C,h=Object(a.y)(),p=h+n.top,v=h+n.top+n.height,g=function(e,n){return n<s.c?[e,e]:n<s.C+s.c?[e,e+s.c]:[e,e+n-s.C]}(d,u),b=i()(g,2),y=b[0],m=b[1];if(p>y&&v<m||u<=s.c)return!1;var _=p<y&&p-s.H||p>m&&p-u+f;if(_){return c.scrollHelper.preciseScroll({scrollTo:_,useAnimate:o,startCallback:function(){l.s.emit(l.p.MOBILE.COMMON.SCROLL_TO_SELECTION_START)},completeCallback:function(){l.s.emit(l.p.MOBILE.COMMON.SCROLL_TO_SELECTION_COMPLETED)},failCallback:function(){l.s.emit(l.p.MOBILE.COMMON.SCROLL_TO_SELECTION_FAILED)}}),!0}}},dx_oggq:function(e,n,r){"use strict";r.d(n,"r",(function(){return Pe}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_EDG4"),a=r("dx_cDcd"),l=r.n(a);function s(){return s=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},s.apply(this,arguments)}var u=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_ae_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_ae_nor_svg__b"})),d=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#D136D1",xlinkHref:"#icon_file_ae_nor_svg__a"}),l.a.createElement("use",{fill:"#B320B3",xlinkHref:"#icon_file_ae_nor_svg__b"})),l.a.createElement("path",{d:"M7.649 10.703h16.648V27.35H7.65z"}),l.a.createElement("path",{d:"M10.799 21.677l-1.048 2.84a.284.284 0 01-.265.187H8.311a.287.287 0 01-.284-.29c0-.035.007-.07.02-.104l3.964-10.394a.284.284 0 01.264-.185h1.3c.118 0 .223.073.265.185l3.965 10.394a.291.291 0 01-.162.374.278.278 0 01-.103.02h-1.19a.284.284 0 01-.265-.187l-1.045-2.84h-4.241zm.521-1.513h3.198l-1.587-4.162-1.61 4.162zm9.063 2.937c.252.299.6.446 1.054.446.39 0 .71-.101.943-.296l.144-.12c.07-.06.115-.11.161-.179.037-.056.074-.124.112-.211.046-.103.116-.15.238-.14l.932.064c.167.011.213.172.171.313-.133.45-.283.654-.736 1.083-.52.475-1.183.717-1.965.717-.871 0-1.595-.307-2.123-.904-.535-.6-.796-1.39-.796-2.393 0-.915.252-1.68.754-2.282.525-.667 1.241-1.004 2.133-1.004.983 0 1.744.352 2.246 1.044.44.6.671 1.437.694 2.495a.24.24 0 01-.235.245h-4.156c.062.486.204.856.429 1.122zm1.043-3.675c-.423 0-.751.137-1.005.418-.22.244-.364.56-.436.96h2.918c-.148-.937-.627-1.378-1.477-1.378z",fill:"#FFF",fillRule:"nonzero"})),f=function(e){return l.a.createElement("svg",s({width:32,height:32,viewBox:"0 0 32 32"},e),u,d)};function h(){return h=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},h.apply(this,arguments)}var p=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.514 0H15.18c.2 0 .391.079.533.22l6.009 5.957a.757.757 0 01.224.537v19.772c0 .836-.678 1.514-1.514 1.514H1.514A1.514 1.514 0 010 26.486V1.514C0 .678.678 0 1.514 0z",id:"icon_file_ai_nor_svg__a"})),v=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("mask",{id:"icon_file_ai_nor_svg__b",fill:"#fff"},l.a.createElement("use",{xlinkHref:"#icon_file_ai_nor_svg__a"})),l.a.createElement("use",{fill:"#F80",xlinkHref:"#icon_file_ai_nor_svg__a"}),l.a.createElement("path",{d:"M15.514 0h6.432v6.432h-4.919a1.514 1.514 0 01-1.513-1.513V0z",fill:"#DE7802",mask:"url(#icon_file_ai_nor_svg__b)"})),l.a.createElement("path",{d:"M7.649 10.703h16.648V27.35H7.65z"}),l.a.createElement("path",{d:"M14.333 13.73c.116 0 .221.073.264.184l3.964 10.394a.291.291 0 01-.16.375.278.278 0 01-.104.02h-1.19a.284.284 0 01-.265-.188l-1.045-2.84h-4.241l-1.048 2.84a.284.284 0 01-.265.188H9.067a.287.287 0 01-.283-.29c0-.036.006-.071.02-.105l3.964-10.394a.284.284 0 01.264-.184h1.3zm7.7 5.675c.21 0 .38.17.38.379v4.54c0 .21-.17.379-.38.379h-.945a.378.378 0 01-.378-.379v-4.54c0-.21.169-.379.378-.379h.946zM13.689 16l-1.61 4.162h3.197L13.688 16zm8.346.757c.209 0 .378.17.378.378v.946c0 .21-.17.378-.378.378h-.946a.378.378 0 01-.378-.378v-.946c0-.209.169-.378.378-.378h.946z",fill:"#FFF",fillRule:"nonzero"})),g=function(e){return l.a.createElement("svg",h({width:32,height:32,viewBox:"0 0 32 32"},e),p,v)};function b(){return b=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},b.apply(this,arguments)}var y=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_android_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_android_nor_svg__b"})),m=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#34C724",xlinkHref:"#icon_file_android_nor_svg__a"}),l.a.createElement("use",{fill:"#2EA121",xlinkHref:"#icon_file_android_nor_svg__b"})),l.a.createElement("path",{d:"M7.649 10.703h16.648V27.35H7.65z"}),l.a.createElement("path",{d:"M19.378 17.135v6.136a.683.683 0 01-.582.676l-.1.007h-.453v1.505a.757.757 0 01-1.506.103l-.007-.103v-1.505h-1.514v1.505a.757.757 0 01-1.506.103l-.007-.103v-1.505h-.452a.683.683 0 01-.676-.582l-.007-.1v-6.137h6.81zm-8.324 0c.383 0 .7.285.75.654l.007.103v2.27a.757.757 0 01-1.507.103l-.007-.103v-2.27c0-.418.34-.757.757-.757zm9.838 0c.418 0 .757.339.757.757v2.27a.757.757 0 11-1.514 0v-2.27c0-.418.339-.757.757-.757zm-6.925-5.066l.047.063.645 1.104c.404-.17.848-.263 1.314-.263.485 0 .946.101 1.363.284l.654-1.12a.342.342 0 01.464-.125l.004.002a.339.339 0 01.124.466l-.65 1.113a3.402 3.402 0 011.44 2.571l.006.214h-6.81c0-1.17.59-2.202 1.489-2.815l-.636-1.088a.339.339 0 01.062-.42l.063-.046.004-.002c.139-.08.311-.05.417.062zm.87 2.678a.378.378 0 100 .756.378.378 0 000-.756zm2.271 0a.378.378 0 100 .757.37.37 0 00.378-.379.378.378 0 00-.378-.378z",fill:"#FFF",fillRule:"nonzero"})),_=function(e){return l.a.createElement("svg",b({width:32,height:32,viewBox:"0 0 32 32"},e),y,m)};function k(){return k=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},k.apply(this,arguments)}var O=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_audio_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_audio_nor_svg__b"})),x=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#34C724",xlinkHref:"#icon_file_audio_nor_svg__a"}),l.a.createElement("use",{fill:"#2EA121",xlinkHref:"#icon_file_audio_nor_svg__b"})),l.a.createElement("path",{d:"M7.649 10.703h16.648V27.35H7.65z"}),l.a.createElement("path",{d:"M15.566 11.947l.076.01 4.687 1.1c.158.037.275.17.29.332l.193 1.974a.378.378 0 01-.458.406l-3.787-.835a.151.151 0 00-.183.162l.764 8.012a.51.51 0 01-.043.246 3.026 3.026 0 01-6.05-.127 3.027 3.027 0 014.864-2.405l-.74-8.463a.378.378 0 01.463-.402z",fill:"#FFF"})),E=function(e){return l.a.createElement("svg",k({width:32,height:32,viewBox:"0 0 32 32"},e),O,x)};function S(){return S=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},S.apply(this,arguments)}var C=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_code_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_code_nor_svg__b"})),I=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#3370FF",xlinkHref:"#icon_file_code_nor_svg__a"}),l.a.createElement("use",{fill:"#245BDB",xlinkHref:"#icon_file_code_nor_svg__b"})),l.a.createElement("path",{d:"M7.649 10.703h16.648V27.35H7.65z"}),l.a.createElement("path",{d:"M13.61 15.526l-3.506 3.69 3.506 3.69a.343.343 0 01-.005.475l-.002.001-.47.47a.319.319 0 01-.46-.007l-4.175-4.394a.343.343 0 010-.47l4.175-4.394a.319.319 0 01.46-.006l.47.47a.343.343 0 01.007.475zm8.353 3.69l-3.255-3.69a.362.362 0 01.005-.474v-.002l.438-.47a.282.282 0 01.427.007l3.876 4.395a.362.362 0 010 .469l-3.876 4.394a.282.282 0 01-.427.007l-.437-.47a.362.362 0 01-.007-.474v-.002l3.256-3.69zm-5.118-6.998l.682.074c.187.02.32.176.299.349l-1.629 12.918c-.022.173-.19.297-.376.277l-.683-.073c-.186-.02-.32-.177-.298-.35l1.629-12.918c.022-.173.19-.297.376-.277z",fill:"#FFF"})),B=function(e){return l.a.createElement("svg",S({width:32,height:32,viewBox:"0 0 32 32"},e),C,I)};function T(){return T=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},T.apply(this,arguments)}var w=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_excel_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_excel_nor_svg__b"})),R=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#34C724",xlinkHref:"#icon_file_excel_nor_svg__a"}),l.a.createElement("use",{fill:"#2EA121",xlinkHref:"#icon_file_excel_nor_svg__b"})),l.a.createElement("path",{d:"M7.649 10h16.648v16.649H7.65z"}),l.a.createElement("path",{d:"M11.182 12.649h1.515c.067 0 .13.033.168.088l2.911 4.22 2.927-4.22a.204.204 0 01.168-.088h1.515a.204.204 0 01.166.323L16.76 18.29l4.094 5.766a.204.204 0 01-.167.322h-1.515a.204.204 0 01-.168-.088l-3.228-4.665-3.212 4.665a.204.204 0 01-.169.088H10.88a.204.204 0 01-.167-.322l4.063-5.766-3.761-5.32a.204.204 0 01.167-.321z",fill:"#FFF",fillRule:"nonzero"})),M=function(e){return l.a.createElement("svg",T({width:32,height:32,viewBox:"0 0 32 32"},e),w,R)};function j(){return j=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},j.apply(this,arguments)}var D=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_image_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_image_nor_svg__b"})),A=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#FFC60A",xlinkHref:"#icon_file_image_nor_svg__a"}),l.a.createElement("use",{fill:"#DC9B04",xlinkHref:"#icon_file_image_nor_svg__b"})),l.a.createElement("path",{d:"M8 11h16.649v16.649H8z"}),l.a.createElement("path",{d:"M23.351 14.838a.454.454 0 01.149.336v9.448c0 .209-.17.378-.378.378h-8.767l-.01-.001L8.376 25a.303.303 0 01-.232-.497l4.89-5.833a.757.757 0 011.16 0l2.428 2.896 6.088-6.697a.454.454 0 01.641-.03zM11.743 12c.418 0 .757.339.757.757v1.486a.757.757 0 01-.757.757h-1.486a.757.757 0 01-.757-.757v-1.486c0-.418.339-.757.757-.757h1.486z",fill:"#FFF"})),P=function(e){return l.a.createElement("svg",j({width:32,height:32,viewBox:"0 0 32 32"},e),D,A)};function L(){return L=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},L.apply(this,arguments)}var N=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_keynote_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_keynote_nor_svg__b"})),F=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#3370FF",xlinkHref:"#icon_file_keynote_nor_svg__a"}),l.a.createElement("use",{fill:"#245BDB",xlinkHref:"#icon_file_keynote_nor_svg__b"})),l.a.createElement("path",{d:"M7.649 10.703h16.648V27.35H7.65z"}),l.a.createElement("path",{d:"M16.352 20.919v3.405c0 .418.34.757.757.757h1.514a.378.378 0 110 .757h-5.298a.378.378 0 110-.757h1.514a.757.757 0 00.757-.757V20.92h.756zm5.462-1.514a.214.214 0 01.136.379l-.286.236a.622.622 0 01-.396.142H10.681a.622.622 0 01-.396-.142l-.287-.236a.214.214 0 01.135-.379h11.681zm-1.719-6.054c.314 0 .578.233.618.544l.557 4.375H10.676l.557-4.375a.622.622 0 01.618-.544h8.244z",fill:"#FFF"})),U=function(e){return l.a.createElement("svg",L({width:32,height:32,viewBox:"0 0 32 32"},e),N,F)};function H(){return H=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},H.apply(this,arguments)}var V=l.a.createElement("defs",null,l.a.createElement("path",{d:"M2 0h19.586a1 1 0 01.707.293l9.414 9.414a1 1 0 01.293.707V40a2 2 0 01-2 2H2a2 2 0 01-2-2V2a2 2 0 012-2z",id:"icon_file_numbers_nor_svg__a"})),W=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(8 3)"},l.a.createElement("mask",{id:"icon_file_numbers_nor_svg__b",fill:"#fff"},l.a.createElement("use",{xlinkHref:"#icon_file_numbers_nor_svg__a"})),l.a.createElement("use",{fill:"#34C724",xlinkHref:"#icon_file_numbers_nor_svg__a"}),l.a.createElement("path",{d:"M22 0h10v10h-8a2 2 0 01-2-2V0z",fill:"#2EA121",mask:"url(#icon_file_numbers_nor_svg__b)"})),l.a.createElement("g",{transform:"translate(12 16)"},l.a.createElement("path",{d:"M0 0h24v24H0z"}),l.a.createElement("path",{d:"M15.807 2.736c.157 0 .284.127.284.284v14.705a.284.284 0 01-.284.284h-2.705a.284.284 0 01-.284-.284V3.02c0-.157.127-.284.284-.284h2.705zm4.91 3.818c.156 0 .283.127.283.284v10.887a.284.284 0 01-.284.284h-2.705a.284.284 0 01-.284-.284V6.838c0-.157.127-.284.284-.284h2.705zm-9.819 3.818c.157 0 .284.127.284.284v7.069a.284.284 0 01-.284.284H8.193a.284.284 0 01-.284-.284v-7.069c0-.157.127-.284.284-.284h2.705zm-4.91 3.818c.158 0 .285.127.285.284v3.25a.284.284 0 01-.284.285H3.284A.284.284 0 013 17.725v-3.25c0-.158.127-.285.284-.285h2.705z",fill:"#FFF"}),l.a.createElement("rect",{fill:"#FFF",x:2.182,y:19.645,width:19.636,height:1.091,rx:.284}))),z=function(e){return l.a.createElement("svg",H({width:48,height:48,viewBox:"0 0 48 48"},e),V,W)};function G(){return G=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},G.apply(this,arguments)}var K=l.a.createElement("defs",null,l.a.createElement("path",{d:"M2 0h19.586a1 1 0 01.707.293l9.414 9.414a1 1 0 01.293.707V40a2 2 0 01-2 2H2a2 2 0 01-2-2V2a2 2 0 012-2z",id:"icon_file_pages_nor_svg__a"})),q=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(8 3)"},l.a.createElement("mask",{id:"icon_file_pages_nor_svg__b",fill:"#fff"},l.a.createElement("use",{xlinkHref:"#icon_file_pages_nor_svg__a"})),l.a.createElement("use",{fill:"#F80",xlinkHref:"#icon_file_pages_nor_svg__a"}),l.a.createElement("path",{d:"M22 0h10v10h-8a2 2 0 01-2-2V0z",fill:"#DE7802",mask:"url(#icon_file_pages_nor_svg__b)"})),l.a.createElement("g",{transform:"translate(12 16)"},l.a.createElement("path",{d:"M0 0h24v24H0z"}),l.a.createElement("path",{d:"M11.118 16.206a.114.114 0 01.014.188l-3.096 2.425a.114.114 0 01-.183-.105l.553-3.894a.114.114 0 01.17-.082l2.542 1.468zm5.71-12.392c.68.392.912 1.26.52 1.938l-5.524 9.569a.114.114 0 01-.156.041L9.031 13.84a.114.114 0 01-.042-.155l5.525-9.568a1.419 1.419 0 011.938-.52l.377.218z",fill:"#FFF"}),l.a.createElement("rect",{fill:"#FFF",x:2.182,y:20.202,width:19.636,height:1.091,rx:.284}))),X=function(e){return l.a.createElement("svg",G({width:48,height:48,viewBox:"0 0 48 48"},e),K,q)};function Y(){return Y=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Y.apply(this,arguments)}var J=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_pdf_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_pdf_nor_svg__b"})),Z=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#F54A45",xlinkHref:"#icon_file_pdf_nor_svg__a"}),l.a.createElement("use",{fill:"#D83931",xlinkHref:"#icon_file_pdf_nor_svg__b"})),l.a.createElement("path",{d:"M7.649 10.703h16.648V27.35H7.65z"}),l.a.createElement("path",{d:"M23.674 21.179c-.344-.403-1.05-.6-2.158-.6-.645 0-1.532.017-2.424.15-2.436-1.757-3.007-3.643-3.007-3.643s.416-1.044.443-2.75c.017-1.078-.154-1.882-.59-2.228a1.224 1.224 0 00-.727-.27.971.971 0 00-.573.178c-1.266.914.117 5.22.154 5.336a38.289 38.289 0 01-2.126 4.336c-.251.438-.251.447-.42.646 0 0-2.217 1.1-3.256 2.318-.588.689-.607 1.162-.576 1.516.05.425.592.805 1.138.805.022 0 .045 0 .067-.002.555-.034 1.171-.186 1.857-.835.497-.47 1.056-1.746 1.774-2.995 2.06-.577 3.873-.989 5.392-1.224 1.114.592 2.772 1.261 3.9 1.261.38 0 .684-.076.906-.226.265-.18.378-.403.448-.817.07-.414-.027-.728-.222-.956zm-2.422.648c1.03 0 1.586.182 1.872.334.089.047.153.092.198.13-.08.062-.239.141-.526.141-.475 0-1.099-.201-1.86-.6.108-.003.214-.005.316-.005zm-5.91-9.077a.09.09 0 01.003-.004c.16.118.235.95.22 1.43-.02.647-.025.897-.106 1.294-.22-.828-.236-2.316-.116-2.72zm.052 6.05c.502.827 1.138 1.664 1.855 2.303-1.4.3-2.562.575-3.398.868a25.868 25.868 0 001.543-3.171zm-5.651 7.003c.127-.187.473-.55 1.35-1.252-.471 1.085-1 1.252-1.491 1.514.037-.086.083-.176.14-.262z",fill:"#FFF"})),Q=function(e){return l.a.createElement("svg",Y({width:32,height:32,viewBox:"0 0 32 32"},e),J,Z)};function $(){return $=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},$.apply(this,arguments)}var ee=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_PPT_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_PPT_nor_svg__b"})),te=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#F80",xlinkHref:"#icon_file_PPT_nor_svg__a"}),l.a.createElement("use",{fill:"#DE7802",xlinkHref:"#icon_file_PPT_nor_svg__b"})),l.a.createElement("path",{d:"M7.649 10h16.648v16.649H7.65z"}),l.a.createElement("path",{d:"M13.73 19.585v4.976a.196.196 0 01-.196.196h-1.149a.196.196 0 01-.196-.196V12.845c0-.109.088-.196.196-.196h4.389c.798 0 1.462.09 1.991.271.534.184.962.439 1.28.767.317.326.538.704.664 1.13.122.414.183.848.183 1.3 0 .686-.145 1.259-.44 1.716-.29.45-.666.806-1.128 1.067a4.834 4.834 0 01-1.54.535c-.561.1-1.126.15-1.693.15H13.73zm2.394-1.342c.523 0 .99-.031 1.4-.095.397-.06.73-.174 1-.338.262-.16.464-.376.608-.653.145-.278.22-.652.22-1.122 0-.679-.222-1.179-.664-1.518-.452-.347-1.195-.527-2.23-.527H13.73v4.253h2.394z",fill:"#FFF",fillRule:"nonzero"})),ne=function(e){return l.a.createElement("svg",$({width:32,height:32,viewBox:"0 0 32 32"},e),ee,te)};function re(){return re=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},re.apply(this,arguments)}var oe=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_ps_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_ps_nor_svg__b"})),ie=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#3370FF",xlinkHref:"#icon_file_ps_nor_svg__a"}),l.a.createElement("use",{fill:"#245BDB",xlinkHref:"#icon_file_ps_nor_svg__b"})),l.a.createElement("path",{opacity:.1,d:"M7.649 10.703h16.648V27.35H7.65z"}),l.a.createElement("path",{d:"M11.053 24.402a.302.302 0 01-.3.303h-.915a.3.3 0 01-.298-.303V14.031a.3.3 0 01.298-.303H13.4c.666 0 1.22.08 1.665.243.455.166.82.4 1.092.698.272.298.462.644.57 1.033.102.37.154.756.154 1.16 0 .619-.125 1.138-.377 1.554a2.795 2.795 0 01-.962.967c-.383.23-.815.39-1.296.48a7.539 7.539 0 01-1.402.132h-1.79v4.407zm1.818-5.829c.419 0 .792-.026 1.12-.08.304-.05.558-.142.763-.274a1.25 1.25 0 00.45-.514c.11-.223.165-.529.165-.914 0-.547-.162-.945-.492-1.214-.345-.281-.927-.427-1.735-.427h-2.089v3.423h1.818zm7.155 4.99c.25.188.629.285 1.134.285.245 0 .452-.028.622-.085.165-.055.297-.126.397-.213a.875.875 0 00.223-.288.76.76 0 00.072-.328c0-.23-.063-.382-.193-.48a2.032 2.032 0 00-.674-.315 9.607 9.607 0 00-.97-.218c-.378-.066-.768-.162-1.057-.298a2.415 2.415 0 01-.904-.706c-.277-.358-.347-.773-.347-1.265 0-.623.233-1.144.69-1.544.45-.393 1.075-.588 1.866-.588.758 0 1.382.173 1.87.521.505.361.825.996.926 1.806a.284.284 0 01-.246.317c-.017.002-.017.002-.035.002h-.762a.284.284 0 01-.281-.246c-.056-.42-.22-.743-.46-.899-.263-.172-.604-.26-1.024-.26-.41 0-.712.083-.907.243a.706.706 0 00-.27.585c0 .204 0 .359.163.546.162.187.465.327.71.411.247.084.625.176.974.25.377.078.73.19 1.056.336.345.154.635.364.866.628.252.288.376.677.376 1.161 0 .356-.079.676-.236.957a2.023 2.023 0 01-.637.689c-.262.177-.57.31-.922.396a4.683 4.683 0 01-1.123.127 3.13 3.13 0 01-1.119-.187 2.492 2.492 0 01-.85-.529 2.443 2.443 0 01-.551-.79 2.184 2.184 0 01-.209-.853.284.284 0 01.268-.3h.777c.134 0 .25.095.278.226.102.491.265.721.509.905z",fill:"#FFF",fillRule:"nonzero"})),ce=function(e){return l.a.createElement("svg",re({width:32,height:32,viewBox:"0 0 32 32"},e),oe,ie)};function ae(){return ae=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},ae.apply(this,arguments)}var le=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_sketch_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_sketch_nor_svg__b"})),se=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#F80",xlinkHref:"#icon_file_sketch_nor_svg__a"}),l.a.createElement("use",{fill:"#DE7802",xlinkHref:"#icon_file_sketch_nor_svg__b"})),l.a.createElement("path",{d:"M8 11h16.649v16.649H8z"}),l.a.createElement("path",{d:"M22.132 17.53l-2.462-3.302a.566.566 0 00-.454-.228h-6.839a.566.566 0 00-.452.226L9.437 17.53a.566.566 0 00.03.718l6.052 6.772a.354.354 0 00.528 0l6.053-6.773c.18-.201.193-.5.032-.716z",fill:"#FFF",fillRule:"nonzero"})),ue=function(e){return l.a.createElement("svg",ae({width:32,height:32,viewBox:"0 0 32 32"},e),le,se)};function de(){return de=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},de.apply(this,arguments)}var fe=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_text_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_text_nor_svg__b"})),he=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#3370FF",xlinkHref:"#icon_file_text_nor_svg__a"}),l.a.createElement("use",{fill:"#245BDB",xlinkHref:"#icon_file_text_nor_svg__b"})),l.a.createElement("path",{d:"M8 11h16.649v16.649H8z"}),l.a.createElement("path",{d:"M16.77 14.514v10.3a.19.19 0 01-.189.19h-1.135a.19.19 0 01-.19-.19v-10.3h-5.068a.19.19 0 01-.19-.19V13.19a.19.19 0 01.19-.189H21.81a.19.19 0 01.19.19v1.134a.19.19 0 01-.19.19h-5.04z",fill:"#FFF"})),pe=function(e){return l.a.createElement("svg",de({width:32,height:32,viewBox:"0 0 32 32"},e),fe,he)};function ve(){return ve=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},ve.apply(this,arguments)}var ge=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_unknow_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_unknow_nor_svg__b"})),be=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#9CA3AD",xlinkHref:"#icon_file_unknow_nor_svg__a"}),l.a.createElement("use",{fill:"#646A73",xlinkHref:"#icon_file_unknow_nor_svg__b"})),l.a.createElement("path",{d:"M7.649 10.703h16.648V27.35H7.65z"}),l.a.createElement("path",{d:"M16.16 12.216c1.236 0 2.23.356 2.987 1.073.72.681 1.081 1.602 1.081 2.749a3.66 3.66 0 01-.76 2.255c-.209.266-.676.72-1.518 1.482-.42.367-.661.618-.849.937-.25.43-.371.87-.371 1.361v.549a.19.19 0 01-.19.189h-1.154a.19.19 0 01-.189-.19v-.548c0-.58.121-1.12.359-1.594.288-.618.835-1.247 1.72-2.02.56-.56.733-.74.854-.891.38-.488.566-.978.566-1.492 0-.754-.221-1.355-.645-1.796-.444-.445-1.088-.664-1.947-.664-.963 0-1.664.314-2.142.95-.378.474-.59.9-.63 1.713a9.425 9.425 0 00-.006.29.19.19 0 01-.19.188h-1.135a.19.19 0 01-.189-.191c.001-.15.003-.248.005-.296.052-1.177.411-1.923 1.08-2.702.787-.907 1.875-1.352 3.263-1.352zm-.755 12.108h1.136a.19.19 0 01.189.19v1.135a.19.19 0 01-.19.189h-1.135a.19.19 0 01-.189-.19v-1.134a.19.19 0 01.19-.19z",fill:"#FFF",fillRule:"nonzero"})),ye=function(e){return l.a.createElement("svg",ve({width:32,height:32,viewBox:"0 0 32 32"},e),ge,be)};function me(){return me=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},me.apply(this,arguments)}var _e=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_video_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_video_nor_svg__b"})),ke=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#3370FF",xlinkHref:"#icon_file_video_nor_svg__a"}),l.a.createElement("use",{fill:"#245BDB",xlinkHref:"#icon_file_video_nor_svg__b"})),l.a.createElement("path",{d:"M7 11h16.649v16.649H7z"}),l.a.createElement("path",{d:"M10.757 15h7.486c.383 0 .7.285.75.654l.007.103v7.486c0 .383-.285.7-.654.75l-.103.007h-7.486a.757.757 0 01-.75-.654L10 23.243v-7.486c0-.383.285-.7.654-.75l.103-.007h7.486zm11.819 1.792a.568.568 0 01.075.282v4.854a.568.568 0 01-.85.493l-1.799-1.028v-3.784l1.8-1.028a.568.568 0 01.774.211zM13.1 16.5h-1.2a.4.4 0 00-.4.4v1.2c0 .22.18.4.4.4h1.2a.4.4 0 00.4-.4v-1.2a.4.4 0 00-.4-.4z",fill:"#FFF"})),Oe=function(e){return l.a.createElement("svg",me({width:32,height:32,viewBox:"0 0 32 32"},e),_e,ke)};function xe(){return xe=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},xe.apply(this,arguments)}var Ee=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_word_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_word_nor_svg__b"})),Se=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#3370FF",xlinkHref:"#icon_file_word_nor_svg__a"}),l.a.createElement("use",{fill:"#245BDB",xlinkHref:"#icon_file_word_nor_svg__b"})),l.a.createElement("path",{d:"M7.649 10.703h16.648V27.35H7.65z"}),l.a.createElement("path",{d:"M15.98 16.598l-2.046 7.57a.21.21 0 01-.204.156h-1.205a.21.21 0 01-.202-.153l-2.775-9.795a.21.21 0 01.203-.268h1.209a.21.21 0 01.203.158l1.975 7.635 2.05-7.637a.21.21 0 01.203-.156h1.178a.21.21 0 01.203.156L18.81 21.9l1.974-7.633a.21.21 0 01.203-.158h1.209a.21.21 0 01.203.268l-2.775 9.795a.21.21 0 01-.202.153h-1.205a.21.21 0 01-.204-.156l-2.033-7.57z",fill:"#FFF",fillRule:"nonzero"})),Ce=function(e){return l.a.createElement("svg",xe({width:32,height:32,viewBox:"0 0 32 32"},e),Ee,Se)};function Ie(){return Ie=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},Ie.apply(this,arguments)}var Be,Te=l.a.createElement("defs",null,l.a.createElement("path",{d:"M1.5 0h14.086a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V26.5a1.5 1.5 0 01-1.5 1.5h-19A1.5 1.5 0 010 26.5v-25A1.5 1.5 0 011.5 0z",id:"icon_file_zip_nor_svg__a"}),l.a.createElement("path",{d:"M16.293.293l5.414 5.414A1 1 0 0121.91 6H17.5A1.5 1.5 0 0116 4.5V.09a1 1 0 01.293.203z",id:"icon_file_zip_nor_svg__b"})),we=l.a.createElement("g",{fill:"none",fillRule:"evenodd"},l.a.createElement("g",{transform:"translate(5 2)"},l.a.createElement("use",{fill:"#3370FF",xlinkHref:"#icon_file_zip_nor_svg__a"}),l.a.createElement("use",{fill:"#245BDB",xlinkHref:"#icon_file_zip_nor_svg__b"})),l.a.createElement("path",{d:"M8 11h16.649v16.649H8z"}),l.a.createElement("path",{d:"M20 13a1 1 0 011 1v10a1 1 0 01-1 1h-8a1 1 0 01-1-1V14a1 1 0 011-1h8zm-2.7 5.5h-1.1a.2.2 0 00-.2.2v1.1c0 .11.09.2.2.2h1.1a.2.2 0 00.2-.2v-1.1a.2.2 0 00-.2-.2zM15.8 17h-1.1a.2.2 0 00-.193.147l-.007.053v1.1a.2.2 0 00.147.193l.053.007h1.1a.2.2 0 00.193-.147L16 18.3v-1.1a.2.2 0 00-.2-.2zm1.5-1.5h-1.1a.2.2 0 00-.193.147L16 15.7v1.1a.2.2 0 00.147.193L16.2 17h1.1a.2.2 0 00.193-.147l.007-.053v-1.1a.2.2 0 00-.2-.2zM15.8 14h-1.1a.2.2 0 00-.193.147l-.007.053v1.1a.2.2 0 00.147.193l.053.007h1.1a.2.2 0 00.193-.147L16 15.3v-1.1a.2.2 0 00-.2-.2zm-1.6 7h3.6c.11 0 .2.09.2.2v2.6a.2.2 0 01-.2.2h-3.6a.2.2 0 01-.2-.2v-2.6c0-.11.09-.2.2-.2zm.8 2h2v-1h-2v1z",fill:"#FFF"})),Re=function(e){return l.a.createElement("svg",Ie({width:32,height:32,viewBox:"0 0 32 32"},e),Te,we)};function Me(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function je(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Me(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Me(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function De(e,n){var r={};return e.forEach((function(e){return r[e]=n})),r}var Ae=je(je(je(je(je(je(je(je(je(je({},De(c.BOX_WORD_FILE_TYPE,Ce)),De(c.BOX_EXCEL_FILE_TYPE,M)),De(c.BOX_PPT_FILE_TYPE,ne)),De(c.BOX_IMAGE_FILE_TYPE,P)),De(c.BOX_AUDIO_FILE_TYPE,E)),De(c.BOX_VIDEO_FILE_TYPE,Oe)),De(c.BOX_TXT_FILE_TYPE,pe)),De(c.BOX_ARCHIVE_FILE_TYPE,Re)),De(c.BOX_PREVIEWABLE_CODE_FILE_TYPES,B)),{},(Be={},i()(Be,c.BOX_FILE_TYPE.PDF,Q),i()(Be,c.BOX_FILE_TYPE.AE,f),i()(Be,c.BOX_FILE_TYPE.AI,g),i()(Be,c.BOX_FILE_TYPE.PSD,ce),i()(Be,c.BOX_FILE_TYPE.PSB,ce),i()(Be,c.BOX_FILE_TYPE.SKETCH,ue),i()(Be,c.BOX_FILE_TYPE.APK,_),i()(Be,c.BOX_FILE_TYPE.KEY,U),i()(Be,c.BOX_FILE_TYPE.PAGES,X),i()(Be,c.BOX_FILE_TYPE.NUMBERS,z),Be));function Pe(e){return e=e.toLowerCase(),Ae[e]||ye}},dx_olpz:function(e,n,r){},dx_olwK:function(e,n,r){"use strict";r.d(n,"x",(function(){return j})),r.d(n,"g",(function(){return D}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_qJ1M"),a=r("dx_TjZK"),l=r("dx_WrO8"),s=r("dx_TwjU"),u=r("dx_BuQo"),d=r("dx_uZlF"),f=r("dx_lwsE"),h=r.n(f),p=r("dx_W8MJ"),v=r.n(p),g=r("dx_iWIM"),b=r.n(g),y=r("dx_W7W2"),m=r.n(y),_=r("dx_a1gu"),k=r.n(_),O=r("dx_Nsbk"),x=r.n(O),E=r("dx_e4eN"),S=r("dx_alfx"),C=r("dx_bKfB"),I=r("dx_G3VO");function B(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return T(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function T(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function w(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=x()(e);if(n){var i=x()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return k()(this,r)}}var R,M=function(e){m()(r,e);var n=w(r);function r(){return h()(this,r),n.apply(this,arguments)}return v()(r,[{key:"cloneEmptyState",value:function(){return new r(this.getZoneId(),b()(x()(r.prototype),"cloneEmptyState",this).call(this).getContent())}},{key:"applyDelta",value:function(e){return this.apply(e,this.applyCallback)}},{key:"split",value:function(e){var n=Object(I.A)(e),r=n.zoneId,o=n.start,i=n.len,c=new E.m({zoneId:r}).retain(o).delete(this.totalWidth()-o-1),a=new E.m({zoneId:r}).delete(o+i);return[this.apply(c,this.applyCallback),this.apply(a,this.applyCallback)]}},{key:"remove",value:function(e){var n=Object(I.A)(e),r=n.zoneId,o=n.start,i=n.len,c=new E.m({zoneId:r}).retain(o).delete(i);return this.apply(c,this.applyCallback)}},{key:"merge",value:function(e){var n=Object(S.Z)(e.initialAttributedTexts,e.apool).get("0"),r=new E.m({zoneId:this.getZoneId()}).retain(this.totalWidth()-1).concat(n);return this.apply(r,this.applyCallback)}},{key:"replace",value:function(e,n,r){var o=Object(I.A)(e),i=o.zoneId,c=o.start,a=o.len,l=new E.m({zoneId:i}).retain(c).delete(a).insert(n,r);return this.apply(l,this.applyCallback)}},{key:"multiReplace",value:function(e){var n=this;e.forEach((function(e){e.toBeReplaced=Array.isArray(e.toBeReplaced)?e.toBeReplaced:[e.toBeReplaced]})),e=e.sort((function(e,n){return e.range[0]-n.range[0]}));var r,o=-1,i=0,c=this,a=B(e);try{var l=function(){var e=r.value,a=e.range,l=e.toBeReplaced;if(a[0]<o)throw new Error("range overlap");var s=[a[0]+i,a[1]+i],u=Object(I.A)(s),d=u.zoneId,f=u.start,h=u.len,p=new E.m({zoneId:d}).retain(f).delete(h);l.forEach((function(e){p.insert(e.text,e.mark)})),c=c.apply(p,n.applyCallback);var v=l.reduce((function(e,n){return n.text.length+e}),0),g=a[1]-a[0];i+=v-g,o=a[1]};for(a.s();!(r=a.n()).done;)l()}catch(s){a.e(s)}finally{a.f()}return c}},{key:"applyCallback",value:function(){}}]),r}(C.h),j=(R={},i()(R,c.m.ContentState,u.O),i()(R,c.m.Range,d.A),i()(R,c.m.ZoneState,M),i()(R,c.m.UndoModule,a.b),i()(R,c.m.InputModel,l.V),R),D=new s.M;D.set(j)},dx_ooSz:function(e,n,r){"use strict";r.d(n,"Y",(function(){return T}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_N9dL"),g=r("dx_B28d"),b=r("dx_L0LN"),y=r("dx_vQix");function m(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var _=function(e){s()(r,e);var n=m(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"isEmptyText",value:function(e){return 0===e.text.initialAttributedTexts.text[0].length}},{key:"isDone",get:function(){return!!this.record.snapshot.done}}]),r}(r("dx_KHvq").H);_.type=g.B.TODO;var k,O,x=r("dx_xjz2"),E=r("dx_tt0H"),S=r("dx_JXmB"),C=Object(x.s)(E.U)(k=function e(){i()(this,e),this.blockType=g.B.TODO,this.checkFunc=S.M})||k,I=r("dx_l1le");function B(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var T=Object(p.H)({providers:[C,{provide:v.RecordSnapshotCreator,useValue:{type:g.B.TODO,create:y.B}}]})(O=function(e){s()(r,e);var n=B(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"blocks",get:function(){return[[_,{viewCreator:I.S,options:this.options.getTextEditorOptions()}]]}}]),r}(b.h))||O},dx_owqk:function(e,n,r){},dx_oxJ8:function(e,n,r){"use strict";r.d(n,"Y",(function(){return k}));var o,i,c=r("dx_lwsE"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_N9dL"),g=r("dx_fEKD"),b=r("dx_B28d"),y=r("dx_LcKp"),m=r("dx_j9j9");function _(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var k=Object(p.H)({providers:[{provide:v.RecordSnapshotCreator,useValue:{type:b.B.TASK,create:g.b}}]})((i=function(e){s()(r,e);var n=_(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).blocks=[[y.v,{viewCreator:m.S}]],e}return r}(p.y),o=i))||o},dx_ozfA:function(e,n,r){"use strict";r.d(n,"B",(function(){return d})),r.d(n,"Q",(function(){return f})),r.d(n,"sM",(function(){return h})),r.d(n,"p",(function(){return p})),r.d(n,"s",(function(){return v}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_PQBD"),a=r("dx_c0wU"),l=r("dx_B28d");function s(e,n){if(!e.hasBlockModelByBlockId(n))return!1;var r=e.getBlockPath(n);return[].concat(i()(r),[n]).reverse().some((function(n){return e.getBlockModelByBlockId(n).type===l.B.CELL}))}var u=function(e){return l.D4.includes(e)};function d(e){for(var n=e.record.snapshot,r=n.folded,o=n.type,i=e;i.parent;){var c=i.parent.record.snapshot.type;if(c===l.B.CALLOUT||c===l.B.CELL||c===l.B.TABLE)return!1;i=i.parent}if("string"===typeof o&&u(o))return!0===r}function f(e){return u(e.type)}var h=function(e,n){var r,o=n.getRecordByBlockId(e);return!(!o||!o.snapshot)&&(!(Object(c.R)(e,n,l.r)||s(n,e)||Object(a.K)(e,n))&&(!!o.snapshot.type.includes("heading")||!!l.D4.includes(o.snapshot.type)&&((null===(r=o.snapshot.children)||void 0===r?void 0:r.length)>0||!0===o.snapshot.folded)))};function p(e){var n=!1;return function(){if(!n)return n=!0,Promise.resolve().then((function(r){try{e()}catch(o){console.error(o)}n=!1}))}}function v(e,n){for(var r=Array.isArray(n)?n:[n],o=e;o&&o.parent;){if(r.includes(o.parent.type))return!0;o=o.parent}return!1}},dx_p1pN:function(e,n,r){"use strict";r.d(n,"v",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("client-var")},dx_p1pd:function(e,n,r){"use strict";(function(t){var e=r("dx_lSNA"),o=r.n(e),i=r("dx_TSYQ"),c=r.n(i),a=r("dx_UtDZ"),l=r("dx_cDcd"),s=r.n(l),u=r("dx_amgp"),d=r("dx_jrwu"),f=(r("dx_l3l3"),"okr-progress-status-tag");n.S=function(e){var n,r,i=e.status,h=e.className,p=e.onHover,v=Object(d.o)(),g=v.hovered,b=v.handleWrapperMouseOver,y=v.handleWrapperMouseLeave,m=(n={},o()(n,u.G.ON_TRACK,t("CreationDoc_Docs_OKR_StatusCustom_Normal")),o()(n,u.G.AT_RISK,t("CreationDoc_Docs_OKR_StatusOnly_AtRisk")),o()(n,u.G.OFF_TRACK,t("CreationDoc_Docs_OKR_StatusOnly_Delayed")),o()(n,u.G.UNSET,t("CreationDoc_Docs_OKR_StatusUnavailable")),n),_=c()((r={},o()(r,"".concat(f,"__ontrack"),i===u.G.ON_TRACK),o()(r,"".concat(f,"__atrisk"),i===u.G.AT_RISK),o()(r,"".concat(f,"__offtrack"),i===u.G.OFF_TRACK),o()(r,"".concat(f,"__unset"),i===u.G.UNSET),o()(r,"".concat(f,"__english-version"),"zh"!==a.i18nHelper.getLanguage()),r),f);return Object(l.useEffect)((function(){g&&(null===p||void 0===p||p())}),[g,p]),s.a.createElement("div",{className:c()("".concat(f,"__wrapper"),h),onMouseOver:b,onMouseLeave:y},s.a.createElement("span",{className:_},m[i]))}}).call(this,r("dx_E9Eu"))},dx_p3b8:function(e,n,r){"use strict";var o,i;r.d(n,"n",(function(){return i})),function(e){e.Embedded="embedded",e.Covered="covered"}(o||(o={})),function(e){e.FULL_FLOATING="floating",e.FULL_NORMAL="normal",e.ABSTRACT="abstract"}(i||(i={}))},dx_p4pT:function(e,n,r){},dx_pI28:function(e,n,r){},dx_pLTH:function(e,n,r){"use strict";(function(t){r.d(n,"e",(function(){return c}));var e=r("dx_wy2R"),o=r.n(e),i=86400,c=function(e){if(!e)return"";var n=o()(e);if(!n.isValid())return"";var r=o()().unix()-n.unix(),c=r<i;if(c&&r<=60)return t("CreationDoc_Docs_OKR_Sync_Progress_JustNow");if(c&&r<3600)return t("CreationDoc_Docs_OKR_Sync_Progress_FewMins");if(c&&r<i)return t("CreationDoc_Docs_OKR_Sync_Progress_FewHrs");var a=Math.floor(r/i);if(a>=1&&a<2)return t("CreationDoc_Docs_OKR_Sync_Progress_Ytd");if(a>=2&&a<31)return t("CreationDoc_Docs_OKR_Sync_Progress_FewDs");var l=Math.floor(r/2678400);return t(l>=1&&l<12?"CreationDoc_Docs_OKR_Sync_Progress_FewMths":"CreationDoc_Docs_OKR_Sync_Progress_FewYrs")}}).call(this,r("dx_E9Eu"))},dx_pSSt:function(e,n,r){"use strict";(function(t){r.d(n,"X",(function(){return v}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_B28d");function p(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var v=function(e){l()(r,e);var n=p(r);function r(e){return o()(this,r),n.call(this,e)}return c()(r,[{key:"getText",value:function(){return"[".concat(t("CreationDoc_Docs_CalloutBlock_Tab"),"]")}}]),r}(r("dx_NMQJ").D);v.type=h.B.CALLOUT}).call(this,r("dx_E9Eu"))},dx_pU8o:function(e,n,r){"use strict";r.d(n,"y",(function(){return a}));var o=r("dx_UtDZ"),i=r("dx_D9db"),c=r("dx_QRvo");function a(e){var n=e.id,r=e.snapshot.file,a=r.token,l=r.name,s=r.mimeType;Object(i.fB)(i.f.DOWNLOAD,{ccm_download_type:s||"other"});var u={name:l,token:a,type:o.NUM_SUITE_TYPE.FILE,mountPoint:{type:c.s,token:n}};return o.FileHelpers.downloadFiles([u])}},dx_pVRx:function(e,n,r){"use strict";var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W7W2"),a=r.n(c),l=r("dx_a1gu"),s=r.n(l),u=r("dx_Nsbk"),d=r.n(u),f=r("dx_Vvd7"),h=r("dx_N9dL"),p=r("dx_T4T0"),v=r("dx_Z22N"),g=r("dx_B28d"),b=r("dx_fEKD");var y,m,_,k,O=r("dx_yG8O"),x=r.n(O),E=r("dx_W8MJ"),S=r.n(E),C=r("dx_PJYZ"),I=r.n(C),B=r("dx_iWIM"),T=r.n(B),w=r("dx_Uyc2"),R=r.n(w),M=(r("dx_A1AB"),r("dx_UtDZ")),j=r("dx_zUqt"),D=r("dx_NMQJ"),A=r("dx_x1WV"),P=r("dx_G2Gn"),L=r("dx_bkVC"),N=r("dx_wTwg"),F=r("dx_j2jx");function U(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var H=(k=_=function(e){a()(r,e);var n=U(r);function r(e){var o;return i()(this,r),o=n.call(this,e),x()(o,"blockManager",m,I()(o)),o.blockitModule=P.S.getBlockitModule(),o.getBlockName=function(){var e=o.getBlockInfo(),n=M.i18nHelper.getLocale();return e?e.name[n]?e.name[n]:e.name["en-US"]:""},o}return S()(r,[{key:"onPasteRecordAfterApply",value:function(e){var n=this;if(!Object(M.isOnline)())return T()(d()(r.prototype),"onPasteRecordAfterApply",this).call(this,e);var o=e.schema;if(o&&this.blockitModule){var i=Object(L.h)();if(i.from===g.G.innerCutPaste&&1===i.pasteTimes){var c=Object(N.F)(o);if(c)return void this.blockManager.applyTransaction("updateISVBlockId",(function(e){e.replace(n.record.id,["app_block_id"],c)}),{undoable:!1})}this.blockitModule.pasteBlock(o,{uuid:Object(j.k)()},this.blockManager.getRootRecordId()).then((function(e){var r=e.blockID;n.blockManager.applyTransaction("updateISVBlockId",(function(e){e.replace(n.record.id,["app_block_id"],r)}),{undoable:!1})})).catch((function(){n.blockManager.applyTransaction("updateISVBlockStatus",(function(e){e.replace(n.record.id,["status"],F.I.Failed)}))}))}else this.blockManager.applyTransaction("updateISVBlockStatus",(function(e){e.replace(n.record.id,["status"],F.I.Failed)}))}},{key:"getBlockInfo",value:function(){return this.blockitModule?this.blockitModule.getBlockInfo(this.snapshot.block_type_id):null}},{key:"getText",value:function(){return"[".concat(this.getBlockName(),"]")}}]),r}(D.D),_.type=g.B.ISV,y=k,m=R()(y.prototype,"blockManager",[A.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),y),V=r("dx_o0o1"),W=r.n(V),z=r("dx_lSNA"),G=r.n(z),K=r("dx_yXPU"),q=r.n(K),X=r("dx_J4zp"),Y=r.n(X),J=r("dx_TSYQ"),Z=r.n(J),Q=r("dx_cDcd"),$=r.n(Q),ee=r("dx_faye"),te=r.n(ee),ne=r("dx_bdgK"),re=r("dx_C7Cb"),oe=r("dx_iHWM"),ie=r("dx_UHze"),ce=r("dx_luPr"),ae=r("dx_MGoZ"),le=r("dx_Ogyw"),se=r("dx_D8nn"),ue=r("dx_ey54"),de=r("dx_QVce"),fe=r("dx_yT1x"),he=r("dx_m5Ht");r("dx_eSAc");function pe(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function ve(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?pe(Object(r),!0).forEach((function(n){G()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pe(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ge(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var be=document.createElement("div");be.classList.add("placeHolderContainer"),document.body.appendChild(be);var ye={promise:null,param:{}},me={},_e=1e3,ke=function(e){a()(r,e);var n=ge(r);function r(e){var o,c;return i()(this,r),(c=n.call(this,e)).containerResizeObserver=new ne.S((function(){c.blockManager.layoutManager.notifyNodeHeightChange(c.id)})),c.state={loadedStatus:he.z.none,loadedBlockInfo:!1,refreshing:!1,blockIcon:"",blockName:"",boundaryWidth:_e,staticHtml:""},c.loadedStatus=he.z.none,c.$container=null,c.$layout=null,c.isInBuffer=!1,c.blockitModule=null,c._onLoadedSignal=new Set,c.alignType=void 0,c.uuid=Object(re.S)(),c.fetchingStaticData=!1,c.debugMode={useLocalPack:!1,hasLocalPack:!1,isOnline:!0},c.hideLoadingHandler=function(e){e===c.$container&&c.hideLoading()},c.showLoadingHandler=function(e){e===c.$container&&c.props.onLoadingShow&&!c.isBlockSSRRenderFinish&&c.props.onLoadingShow()},c.onResize=function(){var e,n=(null===(e=c.boundary)||void 0===e?void 0:e.clientWidth)||_e;if(c.state.boundaryWidth!==n&&c.setState({boundaryWidth:n}),c.updateRect(),c.blockitModule){var r=c.blockitModule.getBlockInstance(c.blockViewId);if(r&&c.$layout)c.$layout.clientWidth&&c.isInBuffer&&c.blockitModule.triggerEventAPI(M.CCM_API.ON_CONTAINER_RESIZE,{opBlock:r.tag,container:c.$layout})}},c.setRef=function(e){c.$container=e},c.setLayoutRef=function(e){c.$layout=e},c.createViewSnapshot=function(){var e=document.createElement("div");return e.classList.add("docx-isv-block"),te.a.render(c.renderPlaceholder(),e),be.appendChild(e),e},c.getViewSnapshot=function(){return me[c.blockTypeId]||(me[c.blockTypeId]=c.createViewSnapshot()),me[c.blockTypeId]},c.getContainer=function(){return c.$container},c.setStaticView=function(){c.blockitModule&&c.shouldFetchStaticData&&(c.fetchingStaticData=!0,c.blockitModule.getStaticBlock(c.isvBlockId).then((function(e){if(e){var n=e.ssrData;n&&(c.setState({staticHtml:n}),c.hideLoading(),ce.R.reportBlockLoadStage(ce.F.TTV,{id:c.model.id,time:(new Date).getTime()}))}})).catch((function(e){console.log("debug getStaticBlock list error",e)})))},c.pageReadyHandler=function(){ce.R.reportBlockLoadStage(ce.F.TTU,{id:c.model.id,time:(new Date).getTime()}),c.hideLoading(),c.clearStaticHtml(),c.setState({loadedStatus:he.z.success})},c.renderPlaceholder=function(){var e=c.getBlockFilledIcon(),n=c.model.getBlockName();return c.getPlaceholderView(n,e||"")},c.renderRefreshPlaceholder=function(){var e;return $.a.createElement(fe.v,{style:{width:(null===(e=c.boundary)||void 0===e?void 0:e.clientWidth)||"100%"}})},c.renderSSRContent=function(){var e=c.state.staticHtml;return $.a.createElement("div",{className:"isv-block-ssr-container",dangerouslySetInnerHTML:{__html:e}})},c.renderShortcut=function(){var e=c.state,n=e.blockIcon,r=e.blockName;return c.getPlaceholderView(r,n)},c.setAlignType=function(e){c.alignType=e||g.D.LEFT},c.getAlignType=function(){var e;return null!==(e=c.alignType)&&void 0!==e?e:g.D.LEFT},c.shouldStopPropagation=function(e){var n=e.nativeEvent.composedPath(),r=Y()(n,1)[0];r&&r instanceof HTMLElement&&((["textarea","input"].includes(r.tagName.toLowerCase())||"true"===r.contentEditable)&&e.stopPropagation())},c.blockitModule=c.model.blockitModule,c.blockManager.addListener(ue.G,c.onResize),c.isInBuffer=c.blockManager.layoutManager.isBlockActive(c.id),c.state.boundaryWidth=(null===(o=c.boundary)||void 0===o?void 0:o.clientWidth)||_e,c.blockitModule&&(c.blockitModule.subscribeEvent(M.CCM_BLOCKIT_SDK_EVENT.LOADING_HIDE,c.hideLoadingHandler),c.blockitModule.subscribeEvent(M.CCM_BLOCKIT_SDK_EVENT.LOADING_SHOW,c.showLoadingHandler),c.props.recursionProps.isShortcut||(c.setStaticView(),c.blockitModule.getBlockList().then((function(){c.setState({loadedBlockInfo:!0})})).catch((function(e){console.log("debug fetch list error",e)})))),c}return S()(r,[{key:"updateRect",value:function(){if(this.$layout){var e=this.$layout.clientWidth,n=this.$layout.clientHeight;this.blockitModule&&e&&this.blockitModule.setBlockRect(this.blockViewId,{width:e,height:n})}}},{key:"menuIcon",value:function(){var e=this.getBlockIcon()||"";return $.a.createElement("div",{className:"isv-menu-icon"},$.a.createElement("img",{src:e,draggable:"false"}))}},{key:"getShortcutListInfo",value:function(){var e=q()(W.a.mark((function e(n,o){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=q()(W.a.mark((function e(i,c){var a;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.blockTypeMap.has(n)){e.next=2;break}return e.abrupt("return",i(r.blockTypeMap.get(n)));case 2:return o.every((function(e){return ye.param[e]}))&&ye.promise||(a={},o.forEach((function(e){a[e]=1})),ye.param=a,ye.promise=Object(M.getShortcutBlockList)(o)),e.prev=3,e.next=6,ye.promise;case 6:return e.sent.forEach((function(e){var n={"zh-CN":"","en-US":"","ja-JP":""};e.name.forEach((function(e){return n[e.lang]=e.title})),e.name&&(n={"zh-CN":n.zh_cn||n.en_us||"","en-US":n.en_us||n.zh_cn||"","ja-JP":n.ja_jp||n.en_us||n.zh_cn||""}),r.blockTypeMap.set(e.blockTypeID,ve(ve({},e),{},{name:n}))})),e.abrupt("return",i(r.blockTypeMap.get(n)));case 11:e.prev=11,e.t0=e.catch(3),c(e.t0);case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(n,r){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"onLoaded",value:function(e){var n=this;return this._onLoadedSignal.add(e),this.state.loadedStatus===he.z.success&&this._drainLoadedSignal(),function(){n._onLoadedSignal.delete(e)}}},{key:"blockViewDidMount",value:function(){var e=q()(W.a.mark((function e(){return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:T()(d()(r.prototype),"blockViewDidMount",this).call(this),this.setup();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setup",value:function(){var e=this,n=this.config.get("isHistory"),r=this.config.get("isShortcut");if(this.updateRect(),this.hostElement&&this.containerResizeObserver.observe(this.hostElement),n)this.hideLoading(),this.setState({loadedStatus:he.z.success});else if(r){var o=new Set;Array.from(this.editorAPI.modelService.getRecordMap().values()).forEach((function(e){e.snapshot.type===g.B.ISV&&o.add(e.snapshot.block_type_id)})),this.getShortcutListInfo(this.blockTypeId,Array.from(o)||[]).then((function(n){e.hideLoading();var r=M.i18nHelper.getLocale();return e.setState({loadedStatus:he.z.success,blockIcon:(null===n||void 0===n?void 0:n.icon)||"",blockName:(null===n||void 0===n?void 0:n.name[r||"en-US"])||""}),e._drainLoadedSignal(),window.setTimeout((function(){window.dispatchEvent(Object(oe.x)("ISVBlockDidRender"))}))})).catch((function(){e.setState({loadedStatus:he.z.fail})}))}else this.setStaticView(),this.mountAppBlock()}},{key:"mountAppBlock",value:function(){var e=q()(W.a.mark((function e(){var n=this;return W.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isvBlockId||M.CCMBlockitSDK.generateCollectionInfo(this.blockViewId),this.blockitModule&&this.$container&&this.shouldMountBlock&&(M.CCMBlockitSDK.generateCollectionInfo(this.blockViewId),this.blockitModule.subscribeFirstPaintEvent(String(this.pageToken),(function(){M.CCMBlockitSDK.setCollectionInfo(n.blockViewId,{first_paint:!0})})),this.setState({loadedStatus:he.z.creating}),this.loadedStatus=he.z.creating,M.CCMBlockitSDK.subscribeEvent(M.CCM_BLOCKIT_SDK_EVENT.UPGRADE_AT_ONCE,(function(e){e===n.blockViewId&&(n.hideLoading(),n.setState({refreshing:!0,loadedStatus:he.z.creating}))})),M.CCMBlockitSDK.subscribeEvent(M.CCM_BLOCKIT_SDK_EVENT.UPGRADE_FINISHED,(function(e){e===n.blockViewId&&(n.setState({refreshing:!1,loadedStatus:he.z.success}),n._drainLoadedSignal(),n.clearStaticHtml())})),M.CCMBlockitSDK.subscribeEvent(M.CCM_BLOCKIT_SDK_EVENT.LOADED,(function(e){e===n.blockViewId&&(n.pageReadyHandler(),n._drainLoadedSignal(),n.props.recursionProps.isPresentationMode&&se.S.emit(se.p.PRESENTATION.FORCE_UPDATE_PAGINATION))})),M.CCMBlockitSDK.subscribeEvent(M.CCM_BLOCKIT_SDK_EVENT.LOAD_FAIL,(function(e){e===n.blockViewId&&n.pageReadyHandler()})),this.blockitModule.mountBlock({blockId:this.isvBlockId,blockTypeId:this.blockTypeId,mountPoint:this.$container,flag:this.blockViewId}).catch((function(e){n.hideLoading(),n.clearStaticHtml(),n.setState({loadedStatus:e.hasShowError?he.z.success:he.z.fail})})));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"clearStaticHtml",value:function(){this.setState({staticHtml:""})}},{key:"blockViewDidUpdate",value:function(e,n){T()(d()(r.prototype),"blockViewDidUpdate",this).call(this,e,n);var o=this.blockStatus,i=this.isvBlockId,c=e.record.snapshot,a=c.status,l=c.app_block_id;a||o?this.hideLoading():l!==i&&this.setup()}},{key:"enterBuffer",value:function(){this.isInBuffer=!0,this.onResize(),this.blockitModule,this.mountAppBlock()}},{key:"leaveBuffer",value:function(){this.isInBuffer=!1,this.blockitModule}},{key:"hideLoading",value:function(){this.blockManager.layoutManager.notifyRenderFinish(this.id),this.props.onBlockReady&&this.props.onBlockReady()}},{key:"blockViewWillUnmount",value:function(){var e,n,o;T()(d()(r.prototype),"blockViewWillUnmount",this).call(this),this.containerResizeObserver.disconnect(),this.config.get("isHistory")||(this.blockManager.removeListener(ue.G,this.onResize),null===(e=this.blockitModule)||void 0===e||e.unSubscribeEvent(M.CCM_BLOCKIT_SDK_EVENT.LOADING_HIDE,this.hideLoadingHandler),null===(n=this.blockitModule)||void 0===n||n.unSubscribeEvent(M.CCM_BLOCKIT_SDK_EVENT.LOADING_SHOW,this.showLoadingHandler),null===(o=this.blockitModule)||void 0===o||o.destroyInstance(this.blockViewId),me[this.blockTypeId]&&be.removeChild(me[this.blockTypeId]),delete me[this.blockTypeId])}},{key:"getDebugMode",value:function(){var e,n,r=null===(e=this.blockitModule)||void 0===e?void 0:e.getBlockLocalPackMode(this.blockTypeId),o=null===(n=this.blockitModule)||void 0===n?void 0:n.isBlockUseLocal(this.blockViewId);return r&&(this.debugMode=ve(ve(ve({},this.debugMode),r),{},{useLocalPack:!!o})),this.debugMode}},{key:"getBlockInfo",value:function(){return this.blockitModule?this.blockitModule.getBlockInfo(this.blockTypeId):null}},{key:"getBlockIcon",value:function(){var e=this.getBlockInfo();return e?e.icon:""}},{key:"getBlockFilledIcon",value:function(){var e=this.getBlockInfo();return e?e.filledIcon:""}},{key:"getShowFrame",value:function(){if(this.blockitModule){var e=this.blockitModule.getBlockConfig(this.blockViewId);if(e&&e.showFrame)return e.showFrame}return!1}},{key:"render",value:function(){var e=this.config.get("isHistory"),n=this.config.get("isShortcut"),r=this.config.get("isPreview"),o=this.props,i=o.syncCursorSelected,c=o.syncCursorBorderColor,a=this.state.refreshing;this.setAlignType(this.snapshot.align);var l=Z()("isv-block-layout",{"is-preview":r,"justify-left":this.alignType===g.D.LEFT,"justify-center":this.alignType===g.D.CENTER,"justify-right":this.alignType===g.D.RIGHT}),s=Z()("isv-block-container",le.B,{"hide-overflow":this.shouldShowPlaceholder,"show-frame":this.getShowFrame(),"isv-hidden":a});return(this.blockStatus||this.isShowVcRoomsTips)&&this.hideLoading(),$.a.createElement("div",{className:l,ref:this.setLayoutRef,style:{width:this.state.boundaryWidth}},$.a.createElement("div",{className:s,ref:this.setRef,style:{borderColor:i?c:void 0},onClick:this.shouldStopPropagation},$.a.createElement(de.z,{loadedStatus:this.state.loadedStatus,showVCRoomsUpdateTips:this.isShowVcRoomsTips,isLoadFail:this.showLoadFail,isShortcut:n,isHistory:e,isForceRefreshing:a,getBlockName:this.model.getBlockName,renderShortcut:this.renderShortcut,renderPlaceholder:this.renderPlaceholder,renderRefreshPlaceholder:this.renderRefreshPlaceholder,renderSSRContent:this.renderSSRContent})))}},{key:"onCopy",value:function(){return this.blockitModule?this.blockitModule.generateSchema(this.isvBlockId,{uuid:Object(j.k)()}):""}},{key:"_drainLoadedSignal",value:function(){this._onLoadedSignal.forEach((function(e){e()})),this._onLoadedSignal.clear()}},{key:"getPlaceholderView",value:function(e,n){var r=Z()("placeholder-view",{history:this.isHistory});return $.a.createElement("div",{className:r},$.a.createElement("div",{className:"information"},$.a.createElement("img",{src:n}),e),$.a.createElement("div",{className:"gray-block"}))}},{key:"blockViewId",get:function(){return"".concat(this.record.id,"_").concat(this.uuid)}},{key:"pageToken",get:function(){return this.blockManager.getRootRecordId()}},{key:"isLoading",get:function(){return this.state.loadedStatus===he.z.creating}},{key:"isInValid",get:function(){return this.state.loadedStatus<he.z.success}},{key:"isBlockSSRRenderFinish",get:function(){return!!this.state.staticHtml}},{key:"blockTypeId",get:function(){return this.snapshot.block_type_id}},{key:"isvBlockId",get:function(){return this.snapshot.app_block_id}},{key:"blockStatus",get:function(){return this.snapshot.status}},{key:"showLoadFail",get:function(){return this.state.loadedStatus===he.z.fail||this.blockStatus===F.I.Failed}},{key:"isShowVcRoomsTips",get:function(){var e=M.userHelper.getCurrentUser();return!!e&&String(e.get("user_type"))===M.USER_TYPE.TEMPORARY}},{key:"shouldMountBlock",get:function(){return this.isvBlockId&&!this.blockStatus&&this.isInBuffer&&this.state.loadedStatus===he.z.none&&this.loadedStatus===he.z.none&&!this.isShowVcRoomsTips&&!this.shouldShowPlaceholder}},{key:"shouldFetchStaticData",get:function(){return this.isvBlockId&&!this.fetchingStaticData&&this.isInValid&&!Object(ie.E)()}},{key:"shouldShowPlaceholder",get:function(){return this.isHistory||this.props.recursionProps.isShortcut}},{key:"isBlockRendered",get:function(){return!this.isLoading}}]),r}(ae.l);ke.CLASS_NAME="docx-isv-block",ke.blockTypeMap=new Map;var Oe,xe,Ee,Se=ke;function Ce(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var Ie=(Oe=Object(f.H)({providers:[{provide:v.I,useClass:p.V,args:[g.B.ISV,{isAsync:!0,shouldRetain:!0,defaultHeight:220,ensureLayout:!0}]},{provide:h.RecordSnapshotCreator,useValue:{type:g.B.ISV,create:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.B.IMAGE;return Object(b.b)(e,n)}}}]}),Oe((Ee=function(e){a()(r,e);var n=Ce(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).blocks=[[H,{viewCreator:Se}]],e}return r}(f.y),xe=Ee))||xe),Be=Ie;n.S=Be},dx_pcp3:function(e,n,r){},dx_peiN:function(e,n,r){},dx_pk3x:function(e,n,r){"use strict";(function(t){r.d(n,"z",(function(){return I})),r.d(n,"v",(function(){return B})),r.d(n,"t",(function(){return T})),r.d(n,"D",(function(){return w})),r.d(n,"f",(function(){return R})),r.d(n,"k",(function(){return M})),r.d(n,"B",(function(){return j})),r.d(n,"DU",(function(){return D})),r.d(n,"i",(function(){return A}));var e=r("dx_RIqP"),o=r.n(e),i=r("dx_smKV"),c=r("dx_c9cXz"),a=r("dx_t9tY"),l=r("dx_x2xl"),s=r("dx_b1b3"),u=r("dx_Ymuy"),d=r("dx_hz0n"),f=r("dx_TOMr"),h=r("dx_KJJu"),p=r("dx_VAwJ"),v=r("dx_W3kT"),g=r("dx_X6Xj"),b=(r("dx_K02k"),r("dx_UHze")),y=r("dx_A5O8"),m=r("dx_s9st"),_=r("dx_cGa6"),k=r("dx_eqfA"),O=r("dx_a7X6"),x=r("dx_KI1b"),E=r("dx_S3cA"),S=[[l.t],[i.D],[O.v],[O.L],[O.t],[O.R],[s.V],[O.P],[O.vz],[c.p]],C=[].concat(S,[[O.V],[u.O],[d.t],[f.d],[h.L]]),I=j(S),B=j(C);function T(){var e=[[p.R,{authorId:Object(b.K)().userId||""}],[O.hi],[O.hS],[O.h,{renderEquationContent:m.j,getPopupContainer:function(){return document.querySelector("#docx-popup-container")}}],[v.j],[O.K]].concat(o()(Object(k.q)()));return Object(E.A)()&&e.push([x.p]),y.S.checkShouldRegisComment()&&e.push([O.W]),j(e)}function w(){var e=[[O.q],[O.Rf],[O.Z],[g.m]];return e.push([O.U]),T().concat(j(e))}function R(){var e=[[p.R,{authorId:Object(b.K)().userId||""}],[O.hi],[O.hS],[O.Rf],[O.Z],[O.h,{renderEquationContent:m.j,getPopupContainer:function(){return document.querySelector("#docx-popup-container")}}]];return Object(E.A)()&&e.push([x.p]),y.S.checkShouldRegisComment()&&e.push([O.W]),j(e)}function M(){var e=[[g.m],[O.q],[O.Rf],[O.Z]];return Object(_.Q)()||e.push([O.U]),R().concat(j(e))}function j(e){return e.map((function(e){return{name:e[0].name,main:e}}))}var D=a.N.filter((function(e){return!1===["copy","cut","paste","resize"].includes(e)})),A={"codeblock.cancel_auto_wrap":t("sheet.cancel_auto_wrap"),"codeblock.auto_wrap":t("sheet.auto_wrap"),"codeblock.copy":t("FeishuDocs_Admin_QuickInvite_ButtonText_Copy"),"common.copied":t("common.copied"),"codeblock.search":t("CreationDoc_Docs_Codeblock_Search_Placeholder"),"codeblock.search_placeholder":t("CreationDoc_Docs_Codeblock_SearchLanguage_Placeholder"),"codeblock.change_language":t("CreationDoc_Docs_Codeblock_ChangeLanguage_Tips")}}).call(this,r("dx_E9Eu"))},dx_pmiW:function(e,n,r){"use strict";var o;function i(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.TOUCH;switch(r){case o.CENTER:var c=n.left+n.width/2,a=n.top+n.height/2;return c>=e.left&&c<=e.right&&a>=e.top&&a<=e.bottom;case o.VERTICAL_CENTER:var l=n.top+n.height/2;return e.right>=n.left&&e.left<=n.right&&l>=e.top&&l<=e.bottom;case o.COVER:return n.left>=e.left&&n.top>=e.top&&n.right<=e.right&&n.bottom<=e.bottom;case o.TOUCH:return e.right>=n.left&&e.left<=n.right&&e.bottom>=n.top&&e.top<=n.bottom;case o.OUTSIDE_TOUCH:return(e.left<=n.left||e.top<=n.top||e.bottom>=n.bottom||e.right>=n.right)&&i(e,n,o.TOUCH);default:throw new Error("Unkown intersection mode: ".concat(r))}}r.d(n,"Z",(function(){return o})),r.d(n,"L",(function(){return i})),function(e){e[e.TOUCH=0]="TOUCH",e[e.CENTER=1]="CENTER",e[e.COVER=2]="COVER",e[e.VERTICAL_CENTER=3]="VERTICAL_CENTER",e[e.OUTSIDE_TOUCH=4]="OUTSIDE_TOUCH"}(o||(o={}));r("dx_TRUJ")},dx_ppSI:function(e,n,r){},dx_ppc6:function(e,n,r){"use strict";r.d(n,"p",(function(){return M})),r.d(n,"L",(function(){return w}));var o,i,c,a,l,s,u,d,f=r("dx_N5N8"),h=r("dx_yG8O"),p=r.n(h),v=r("dx_lwsE"),g=r.n(v),b=r("dx_W8MJ"),y=r.n(b),m=r("dx_Uyc2"),_=r.n(m),k=(r("dx_A1AB"),r("dx_Vvd7")),O=r("dx_xjz2"),x=r("dx_dvfR"),E=r("dx_yIs4"),S=r("dx_B28d"),C=r("dx_ZG9w"),I=r("dx_iw8O"),B=r("dx_BaTw"),T=r("dx_P58d"),w=Object(O.S3)("click-root-service"),R=[S.B.IMAGE,S.B.FILE,S.B.DIAGRAM,S.B.MINDMAP],M=(o=Object(O.s)(w),i=Object(O.a)(),c=Object(O.a)(),o((l=function(){function e(){var n=this;g()(this,e),p()(this,"dynamicView",s,this),p()(this,"selectionAPI",u,this),p()(this,"dynamicLifeCycle",d,this),this.subs=[],this.clickDetector=void 0,this.handleClick=function(e){var r;if(n.clickDetector.allowResetSelection&&!e.shiftKey){var o=e.target instanceof HTMLElement&&Object(I.S)(e.target);if(o){var i=null===(r=n.dynamicView.get())||void 0===r?void 0:r.getBlockViewByBlockId(o);if(i)if(!R.includes(i.type))(n.selectionAPI.getSelection().filter((function(e){return e.type===T.j.BLOCK})).map((function(e){return e.id})).includes(o)||i.hostElement.closest(".selected"))&&1===e.detail&&(n.selectionAPI.removeAllSelection(),Object(C.f)(i)&&n.setTextBlockCaret(i,e.clientX,e.clientY))}}}}return y()(e,[{key:"init",value:function(){this.bindClickEvent()}},{key:"bindClickEvent",value:function(){var e=this,n=this.dynamicLifeCycle.get();n&&(this.subs.push(n.editorDidMount$.subscribe((function(){var n,r=e.dynamicView.get(),o=null===r||void 0===r||null===(n=r.rootBlockView)||void 0===n?void 0:n.hostElement;o&&(o.addEventListener("click",e.handleClick,!1),e.clickDetector=new B.c(o))}))),this.subs.push(n.editorWilDestroy$.subscribe((function(){var n,r=e.dynamicView.get(),o=null===r||void 0===r||null===(n=r.rootBlockView)||void 0===n?void 0:n.hostElement;o&&(o.removeEventListener("click",e.handleClick,!1),e.clickDetector.destroy())}))))}},{key:"setTextBlockCaret",value:function(e,n,r){var o=Object(B.f)(n,r),i=o.textNode,c=o.offset;if(i&&Object(E.S)(c)){var a=Object(x.F)(i,e.editor);if(a){var l=a.toPosition().start+c;this.selectionAPI.setSelection([{id:e.id,type:T.j.TEXT,selection:{start:l,end:l}}])}}}},{key:"destroy",value:function(){this.subs.forEach((function(e){return e.unsubscribe()}))}}]),e}(),s=_()(l.prototype,"dynamicView",[i,k.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=_()(l.prototype,"selectionAPI",[f.w],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=_()(l.prototype,"dynamicLifeCycle",[c,k.X],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=l))||a);n.S=f.w},dx_pqP2:function(e,n,r){"use strict";var o=r("dx_Xkil");r.d(n,"r",(function(){return o.S}))},dx_prDn:function(e,n,r){"use strict";r.d(n,"y",(function(){return l}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c);function l(e){var n=!1;return a()(i.a.mark((function r(){var o=arguments;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n){r.next=2;break}return r.abrupt("return");case 2:return n=!0,r.prev=3,r.next=6,e.apply(void 0,o);case 6:r.next=10;break;case 8:r.prev=8,r.t0=r.catch(3);case 10:n=!1;case 11:case"end":return r.stop()}}),r,null,[[3,8]])})))}},dx_pxpU:function(e,n,r){"use strict";r.d(n,"i",(function(){return o})),r.d(n,"e",(function(){return i}));var o="SHOW_BLOCK_TIPS",i="CLOSE_BLOCK_TIPS"},dx_pzI1:function(e,n,r){"use strict";r.d(n,"X",(function(){return d})),r.d(n,"Z",(function(){return f})),r.d(n,"e",(function(){return v}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_UtDZ"),a=r("dx_C7Cb");function l(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}var s,u,d="AT_USER_BLOCK",f="mentionBlock",h={};!function(e){e.INLINE="inline",e.CARD="card",e.PREVIEW="preview"}(s||(s={})),function(e){e.BLOCK="block",e.INLINE="inline"}(u||(u={}));var p=function(e){var n=e.blockType,r=e.initData,o=e.props,c=e.depLoading;if(h[n]&&o&&!o.viewType){var d=h[n];o.viewType=d,d===s.INLINE?o.displayMode=u.INLINE:o.displayMode=u.BLOCK}var f=r||{},p=c?{depLoading:c}:{};return function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?l(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({blockId:Object(a.S)(),blockType:n,props:o||{},initData:escape(JSON.stringify(f))},p)};function v(e){var n;if(e.type===c.TYPE_ENUM.USER){var r=e,o=r.type,i=r.id,a=r.cn_name,l=r.en_name,s=r.avatar_url,u=r.email,h=r.isReply;n={blockType:d,props:{data:{user:{avatar_url:encodeURIComponent(s),type:o,id:i,cn_name:a,en_name:l,email:u}}}},h&&(n.props.data.user.isReply=h)}else{var v=e,g=v.link,b=void 0===g?"":g,y=v.type,m=v.title,_=v.token,k=v.url,O=void 0===k?"":k;n={blockType:f,props:{link:encodeURIComponent(b)||encodeURIComponent(O),type:y,title:m,token:_}}}return p(n)}},dx_pzLC:function(e,n,r){"use strict";(function(t){var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_B28d"),p=r("dx_NMQJ"),v=r("dx_gLp6");function g(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var b=function(e){l()(r,e);var n=g(r);function r(){var e;o()(this,r);for(var i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).isBlankDiagram=function(){return e.snapshot.diagram.data.mxCellList.length<=2},e}return c()(r,[{key:"getText",value:function(){return this.snapshot.diagram.diagramType===v.O.UML?"[".concat(t("CreationDoc_Docs_UMLDiagram_Title"),"]"):"[".concat(t("CreationDoc_Docs_FlowDiagram_Title"),"]")}}]),r}(p.D);b.type=h.B.DIAGRAM,n.S=b}).call(this,r("dx_E9Eu"))},dx_q0q0:function(e,n,r){"use strict";var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_QBqw"),s=new(function(){function e(){var n=this;i()(this,e),this.layoutMap=new Map,this.tableScrollLeft=null,this.getLayout=function(e,r){return n.layoutMap.has(e)||n.layoutMap.set(e,Object(l.c)(r)),n.layoutMap.get(e)},this.getTableScrollLeft=function(){return n.tableScrollLeft},this.clear=function(){n.layoutMap.clear(),n.tableScrollLeft=null}}return a()(e,[{key:"setLayout",value:function(e,n){this.layoutMap.set(e,n)}},{key:"setTableScrollLeft",value:function(e){this.tableScrollLeft=e}}]),e}());n.S=s},dx_q0q6:function(e,n,r){"use strict";var o=r("dx_k5k3");r.d(n,"A",(function(){return o.A}));r("dx_HLaa")},dx_q20L:function(e,n,r){"use strict";(function(t){var e,o,i,c,a=r("dx_o0o1"),l=r.n(a),s=r("dx_yXPU"),u=r.n(s),d=r("dx_yG8O"),f=r.n(d),h=r("dx_lwsE"),p=r.n(h),v=r("dx_W8MJ"),g=r.n(v),b=r("dx_PJYZ"),y=r.n(b),m=r("dx_iWIM"),_=r.n(m),k=r("dx_W7W2"),O=r.n(k),x=r("dx_a1gu"),E=r.n(x),S=r("dx_Nsbk"),C=r.n(S),I=r("dx_Uyc2"),B=r.n(I),T=(r("dx_A1AB"),r("dx_UtDZ")),w=r("dx_B28d"),R=r("dx_NMQJ"),M=r("dx_x1WV"),j=r("dx_WKxm");function D(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=C()(e);if(n){var i=C()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return E()(this,r)}}var A=(c=i=function(e){O()(r,e);var n=D(r);function r(e){var i;return p()(this,r),i=n.call(this,e),f()(i,"blockManager",o,y()(i)),i}return g()(r,[{key:"onPasteRecordAfterApply",value:function(){var e=u()(l.a.mark((function e(n){var o,i,c,a,s,u=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(T.isOnline)()){e.next=2;break}return e.abrupt("return",_()(C()(r.prototype),"onPasteRecordAfterApply",this).call(this,n));case 2:if(""===(o=this.record.snapshot).iframe.component.url){e.next=5;break}return e.abrupt("return");case 5:return i=o.iframe.component,c=i.type,a=i.original_text,e.next=8,Object(j.J)(c,a);case 8:return s=e.sent,e.next=11,this.blockManager.applyTransaction("replaceIframeUrlAfterPaste",(function(e){e.replace(u.record.id,["iframe","component","url"],s)}));case 11:setTimeout((function(){var e;null===(e=u.editorAPI.viewService.getBlockViewByBlockId(u.id))||void 0===e||e.refreshIframe()}),0);case 12:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"getText",value:function(){return"[".concat(t("line_popover.web-page"),"]")}}]),r}(R.D),i.type=w.B.IFRAME,e=c,o=B()(e.prototype,"blockManager",[M.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e);n.S=A}).call(this,r("dx_E9Eu"))},dx_q3qZ:function(e,n,r){"use strict";(function(e){r.d(n,"r",(function(){return B}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_iWIM"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_QxNg"),m=r("dx_bLiB"),_=r("dx_h6a8"),k=r("dx_cDcd"),O=r.n(k);function x(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function E(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?x(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function S(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var C=e.env.NODEJS,I=e.env.MOBILE_SSR,B=function(e){h()(r,e);var n=S(r);function r(e){var o;a()(this,r),(o=n.call(this,e)).isRoot=void 0,o.recordData=void 0,o.componentTag=void 0,o.componentProps=void 0,o.hostElementRef=O.a.createRef(),o.recordChangeCallbacks=void 0,o.transactionName="",o.notifyRecordChange=function(e){var n;o.transactionName=e.options.transactionName||"",null===(n=o.recordChangeCallbacks)||void 0===n||n.forEach((function(n){return n(e)}))},o.observeRecordChange=function(e){o.recordChangeCallbacks||(o.recordChangeCallbacks=[]),o.recordChangeCallbacks.push(e)};var i=o.getHostElementRef(),c=null==i.current;return o.isRoot=c,o.recordData=C?o.props.model.record:o.cloneRecordData(),o.componentTag=e.renderProps.tag||(c?"div":O.a.Fragment),o.componentProps=c?{ref:i}:null,!c&&o.updateContainer(e),o}return s()(r,[{key:"shouldComponentUpdate",value:function(e,n){var o=this;if(this.props.model.isDestroyed)return!1;if(!d()(b()(r.prototype),"shouldComponentUpdate",this).call(this,e,n)){var i,c,a=this.transactionName;if("flushInput"===a||"deleteBackward"===a||"composition"===a)return!1;var l=(null===(i=this.props.options.blockDeps)||void 0===i?void 0:i.map((function(e){return Object(_.get)(o.props,e)})))||[],s=(null===(c=this.props.options.blockDeps)||void 0===c?void 0:c.map((function(n){return Object(_.get)(e,n)})))||[];if(l.length===s.length&&l.every((function(e,n){return e===s[n]})))return!1}var u=["blockId","renderProps.className","renderProps.attribute","model.type","wrapperClassName","model.record.id"];return this.recordData=C?this.props.model.record:this.cloneRecordData(),this.isRoot||Object(_.isEqualWith)(u.map((function(e){return Object(_.get)(o.props,e)})),u.map((function(n){return Object(_.get)(e,n)})))||(this.recordData=this.cloneRecordData(),this.updateContainer(e)),!0}},{key:"componentDidMount",value:function(){this.props.model.record.on(y.Ra.CHANGE,this.notifyRecordChange),d()(b()(r.prototype),"componentDidMount",this).call(this)}},{key:"componentWillUnmount",value:function(){d()(b()(r.prototype),"componentWillUnmount",this).call(this),this.props.model.record.off(y.Ra.CHANGE,this.notifyRecordChange)}},{key:"render",value:function(){var e,n,o=this.props,i=o.renderProps,c=o.model,a=null!==(e=null===(n=i.getWrapperClassName)||void 0===n?void 0:n.call(i,c.id))&&void 0!==e?e:"",l=i.className,s=i.attribute,u={blockId:c.id,className:l,type:c.type,wrapperClassName:a,recordId:c.record.id,attribute:s},f=this.getContainerAttributes(u),h=f.cls,p=f.attributes,v=this.componentTag,g=this.componentProps,y=v===O.a.Fragment?g:E(E(E({},g),p),{},{className:h,style:i.style});return O.a.createElement(v,y,d()(b()(r.prototype),"render",this).call(this))}},{key:"_notifyToReRender",value:function(){this.recordData=this.cloneRecordData(),d()(b()(r.prototype),"_notifyToReRender",this).call(this)}},{key:"_getBlockProps",value:function(){var e,n=this.props,o=n.model,i=n.options;return Object.assign(d()(b()(r.prototype),"_getBlockProps",this).call(this),{record:this.recordData,type:o.type,blockId:o.id,recordId:o.record.id,parentId:null===(e=o.parent)||void 0===e?void 0:e.id,hostElementRef:this.getHostElementRef(),options:null===i||void 0===i?void 0:i.options,onRecordChange:this.observeRecordChange})}},{key:"updateContainer",value:function(e){var n,r=e.renderProps,o=r.getWrapperClassName,i=r.hostElementRef,c=r.className,a=r.attribute,l=e.model,s=null!==(n=null===o||void 0===o?void 0:o(l.id))&&void 0!==n?n:"",u={blockId:l.id,className:c,type:l.type,wrapperClassName:s,recordId:l.record.id,attribute:a},d=this.getContainerAttributes(u),f=d.cls,h=d.attributes,p=null===i||void 0===i?void 0:i.current;p.setAttribute("class",f),Object.keys(h).forEach((function(e){p.setAttribute(e,h[e])}))}},{key:"getContainerAttributes",value:function(e){var n=e.blockId,r=e.className,o=e.type,i=e.wrapperClassName,c=e.recordId,a=e.attribute,l=["block",r,i,"docx-".concat(o,"-block")].filter(Boolean).join(" "),s={"data-block-type":o};return C?s["data-record-id"]=c:I?s["data-block-id"]=n:(s["data-block-id"]=n,s["data-record-id"]=c),{cls:l,attributes:Object.assign({},s,a)}}},{key:"getHostElementRef",value:function(){return this.props.renderProps.hostElementRef||this.hostElementRef}},{key:"cloneRecordData",value:function(){var e=this.props.model.record;return{id:e.id,snapshot:Object(_.cloneDeep)(e.snapshot)}}}]),r}(m.O)}).call(this,r("dx_o8ox"))},dx_q5qe:function(e,n,r){"use strict";(function(t){r.d(n,"s",(function(){return k}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_o7AQ"),c=r("dx_ghwW"),a=r("dx_B84B"),l=r("dx_c9cX"),s=r("dx_yEcx"),u=r("dx_m87l"),d=r("dx_PcQO"),f=r("dx_TSYQ"),h=r.n(f),p=r("dx_UtDZ"),v=r("dx_cDcd"),g=r.n(v),b=r("dx_yzqx"),y=r("dx_N4Vo"),m=r("dx_wH9t"),_=function(e){e.preventDefault(),e.stopPropagation()},k=function(e){var n=e.onVisibleChange,r=e.isShowFocusButton,f=e.isFollowed,k=e.onFollow,O=e.isShowDetailsButton,x=e.onCheckDetails,E=e.isShowReferButton,S=e.onDerefer,C=e.isShowTurnIntoTodoButton,I=e.onTurnIntoTodo,B=Object(v.useState)(!1),T=o()(B,2),w=T[0],R=T[1],M=function(e){R(e),null===n||void 0===n||n(e),e&&(Object(p.collectEvent)("ccm_doc_task_more_operation_view",{}),setTimeout((function(){var e,n=null===(e=document.querySelectorAll(".task-block-toolbar-more-menu .ud__menu-normal-item"))||void 0===e?void 0:e[0];null===n||void 0===n||n.focus({preventScroll:!0})})))};return g.a.createElement(d.Dropdown,{disabled:b.S.isMobile||!r&&!O&&!E&&!C,trigger:["hover"],placement:"bottomRight",overlayClassName:"task-block-toolbar-more-menu task-block-dropdown-keydown-menu",visible:w,onVisibleChange:function(e){M(e)},mouseEnterDelay:200,mouseLeaveDelay:200,destroyOnHide:!0,showAction:["click","mouseEnter"],hideAction:["click","mouseLeave"],overlay:g.a.createElement(d.Menu,{onMouseDown:function(e){e.preventDefault()}},r&&g.a.createElement(d.Menu.Item,{key:"follow",icon:f?g.a.createElement(i.S,{className:"task-block--ud__icon-actived"}):g.a.createElement(c.S,null),onClick:function(e){_(e.domEvent),k(),M(!1)}},t(f?"CreationDoc_Tasks_FollowingTask_Hover":"CreationDoc_Tasks_FollowThisTask_Hover")),O&&g.a.createElement(d.Menu.Item,{key:"detail",icon:g.a.createElement(a.S,null),onClick:function(e){_(e.domEvent),x(),M(!1)}},t("LarkCCM_Tasks_ViewInAppTasks_MenuOptions")),E&&g.a.createElement(m.J,{guideKey:"task-block-guide-derefer",title:t("CreationDoc_Todo_Unsync_OnboardingMessage")},g.a.createElement(d.Menu.Item,{key:"derefer",icon:g.a.createElement(l.S,null),onClick:function(e){_(e.domEvent),S(),M(!1)}},t("CreationDoc_Todo_UnsyncFromTask_Button"))),C&&g.a.createElement(d.Menu.Item,{key:"turnIntoTodo",icon:g.a.createElement(s.S,null),onClick:function(e){_(e.domEvent),I(),M(!1)}},t("CreationDoc_Tasks_UnsnycToTasks_MenuOption")))},g.a.createElement("div",{className:"task-block-toolbar",onMouseDown:function(e){e.preventDefault()},onClickCapture:function(e){w&&(e.preventDefault(),e.stopPropagation())}},g.a.createElement(y.a,{style:{margin:"0 3px"},icon:g.a.createElement(u.S,null),size:"small",type:"icon",className:h()({"task-block--ud__icon-default":!0,"task-block-toolbar-icon-btn":!0})})))}}).call(this,r("dx_E9Eu"))},dx_qANE:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return S}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_J4zp"),l=r.n(a),s=r("dx_m4ma"),u=r("dx_c9cX"),d=r("dx_cDcd"),f=r.n(d),h=r("dx_faye"),p=r.n(h),v=r("dx_HqbJ"),g=r("dx_CkQe"),b=r("dx_XW5M"),y=r("dx_IvU4"),m=r("dx_D8nn"),_=r("dx_Mzjv"),k=r("dx_z3zX"),O=r("dx_BBJ7"),x=(r("dx_OxKN"),"link-editor-container");function E(e){var n=e.link,r=e.target,o=[{name:"is link",type:g.F.MenuItemNormal,extra:{behavior:g.l.CreateNoOps},className:"is-link",text:n},{name:"edit link",type:g.F.MenuItemNormal,extra:{behavior:g.l.CreateNoOps},text:"",tip:t("CreationDoc_DocX_EditLink_Tooltip"),icon:f.a.createElement(s.S,null),action:function(){!function(){var n=e.handleEditClick;n&&n()}()}},{name:"delete link",type:g.F.MenuItemNormal,extra:{behavior:g.l.CreateNoOps},text:"",tip:t("CreationDoc_DocX_RemoveLink_Tooltip"),icon:f.a.createElement(u.S,null),action:function(){!function(){var n=e.handleUnlink;n&&n()}()}}],i=Object(d.useState)(y.S.getPanelStatus(b.t.TextualToolbar)),c=l()(i,2),a=c[0],h=c[1],p=function(e){h(e)};Object(d.useEffect)((function(){return m.S.on(m.p.COMMON.TEXT_TOOLBAR_STATUS_CHANGE,p),function(){m.S.off(m.p.COMMON.TEXT_TOOLBAR_STATUS_CHANGE,p)}}),[]);var x=Object(O.Y)(e.blockManager.editorAPI).editMode,E="string"===typeof r?document.querySelector(r):r;if(!E)return null;var S=E||document.querySelector(".root"),C=parseInt(window.getComputedStyle(S).lineHeight,10),I=-(E.getBoundingClientRect().height-C)/2,B=e.visible&&x===O.N.Mouse;return f.a.createElement(k.S,{visible:B&&!a,selectionAPI:e.selectionAPI,blockManager:e.blockManager,boundary:e.scroller,target:E,offset:[0,I],sticky:[!0,!1],direction:_.R.BottomCenter,reverse:!0},f.a.createElement("div",{className:"link-edit-container",onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave},f.a.createElement(v.S,{selectionAPI:e.selectionAPI,blockManager:e.blockManager,boundary:e.scroller,items:o,onItemClick:function(e,n){e.action&&e.action(n,e)},style:{display:"flex"},keyboard:!1,vertical:!0})))}var S=function(){function e(){var n=this;o()(this,e),this.showTimer=null,this.hideTimer=null,this.container=null,this.attached=!1,this.clearTimers=function(){n.hideTimer&&(window.clearTimeout(n.hideTimer),n.hideTimer=null),n.showTimer&&(window.clearTimeout(n.showTimer),n.showTimer=null)},this.handleMouseEnter=function(e){n.hideTimer&&(window.clearTimeout(n.hideTimer),n.hideTimer=null),n.showTimer||(n.showTimer=window.setTimeout((function(){n.show(Object.assign(e,{onMouseEnter:function(){return n.handleMouseEnter(e)},onMouseLeave:function(){return n.handleMouseLeave()}}))}),300))},this.handleMouseLeave=function(){n.clearTimers(),n.container&&(n.hideTimer=window.setTimeout((function(){n.hide()}),300))},this.hide=function(){n.clearTimers(),n.container&&n.attached&&(p.a.unmountComponentAtNode(n.container),n.attached=!1)},this.show=function(e){n.clearTimers(),p.a.render(f.a.createElement(E,e),n.container),n.attached=!0},this.container=document.getElementById(x),this.container||(this.container=document.createElement("div"),this.container.setAttribute("id",x),document.body.appendChild(this.container))}return c()(e,[{key:"destroy",value:function(){this.clearTimers()}}]),e}()}).call(this,r("dx_E9Eu"))},dx_qBEj:function(e,n,r){"use strict";r.d(n,"t",(function(){return a})),r.d(n,"D",(function(){return l}));var o=r("dx_Fimk"),i=r("dx_eSV8"),c="docx_virtual_render_oops_dev";function a(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n&&Object(i.n)(e.message||c),Object(o.N)(c,e)}function l(e){return Object(o.N)("docx_virtual_render_info_dev",e)}},dx_qDPQ:function(e,n,r){"use strict";var o,i,c;r.d(n,"h",(function(){return o})),r.d(n,"M",(function(){return i})),r.d(n,"t",(function(){return c})),r.d(n,"w",(function(){return a})),function(e){e[e.ORIGINAL=0]="ORIGINAL",e[e.TRANSLATION=1]="TRANSLATION"}(o||(o={})),function(e){e[e.MAIN_BODY=1]="MAIN_BODY",e[e.COMMENTS=2]="COMMENTS",e[e.UNKNOWN=3]="UNKNOWN"}(i||(i={})),function(e){e[e.SUCCESS=0]="SUCCESS",e[e.FAIL=1]="FAIL",e[e.NETWORK_ERROR=2]="NETWORK_ERROR",e[e.UNAVAILABLE=3]="UNAVAILABLE",e[e.CANCEL=4]="CANCEL"}(c||(c={}));var a={TRANSLATION_UNAVAILABLE:11002}},dx_qGrX:function(e,n,r){"use strict";r.d(n,"S",(function(){return i}));var o=r("dx_cDcd");function i(){var e=Object(o.useRef)((function(){})),n=Object(o.useCallback)((function(){e.current()}),[]);return[e,n]}},dx_qHDV:function(e,n,r){"use strict";r.d(n,"k",(function(){return b})),r.d(n,"j",(function(){return m.j})),r.d(n,"R",(function(){return m.R})),r.d(n,"y9",(function(){return m.y})),r.d(n,"y",(function(){return ee})),r.d(n,"q",(function(){return X})),r.d(n,"w",(function(){return ne})),r.d(n,"H",(function(){return y})),r.d(n,"u",(function(){return z})),r.d(n,"N",(function(){return ce})),r.d(n,"W",(function(){return le}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_cDf5"),s=r.n(l);function u(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function d(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?u(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var f=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"px";return"number"===typeof e?e+n:e};function h(e,n,r){var o=e&&e.style;if(o)if("object"===s()(n))for(var i=0,c=Object.entries(n);i<c.length;i++){var l=a()(c[i],2),u=l[0],d=l[1];o[u]=f(d)}else r&&"string"===typeof n&&(o[n]=f(r))}function p(e){var n=e;return d(d({},n),{},{x:n.clientX,y:n.clientY,target:n.target})}function v(e){var n=e.path||e.composedPath&&e.composedPath();if(n&&n.length>0)return n;for(var r=e.target;r;)n.push(r),r=r.parentElement;return n}function g(e,n){return e instanceof HTMLElement&&(e.classList?e.classList.contains(n):!!e.getAttribute&&(e.getAttribute("class")||"").split(" ").some((function(e){return e===n})))}function b(e,n){for(var r=e;r;){if(g(r,n))return!0;r=r.parentNode}return!1}var y,m=r("dx_qHgq"),_=r("dx_lwsE"),k=r.n(_),O=r("dx_W8MJ"),x=r.n(O),E=r("dx_W7W2"),S=r.n(E),C=r("dx_a1gu"),I=r.n(C),B=r("dx_Nsbk"),T=r.n(B),w=r("dx_NOtv"),R=r.n(w),M=r("dx_h6a8"),j=r("dx_O4O8"),D=r.n(j),A=r("dx_yzqx"),P=r("dx_SreQ"),L=r("dx_bbfH"),N=r("dx_pmiW"),F=r("dx_D8nn"),U=r("dx_UtDZ"),H=r("dx_imty"),V=R()("selection:core: scrollable"),W=function(){function e(n,r){var o=this;k()(this,e),this.instance=n,this.options=r,this.manualScroll=function(e){if(o.instance.checkIfNeedCalcSelectablesIfLazy()){o.freezeDefaultScroll(!1);var n=o.instance,r=n.selectionContext.scrollSpeed,i=o.options.manualScrollSpeed,c=e.deltaY?e.deltaY>0?1:-1:0,a=e.deltaX?e.deltaX>0?1:-1:0;n.selectionContext.update({scrollSpeed:{x:(r.x||0)+a*i,y:(r.y||0)+c*i}}),V("manualScroll",n.selectionContext.scrollSpeed),n._handleTapMove(e,!1),e.preventDefault()}}}return x()(e,[{key:"onDelayMove",value:function(e){window.addEventListener("wheel",this.manualScroll,{passive:!1})}},{key:"freezeDefaultScroll",value:function(e){var n=A.S.isMobile,r=A.S.isLarkFeed;if(!n){var o=this.instance.options.boundaryAreaContainer,i=e?"hidden":"";o.style.overflow!==i&&(Object.assign(o.style,{overflow:i,paddingRight:r?void 0:e?"".concat(U.domHelper.getScrollBarWidth(),"px"):0}),o.style.overflow=i,F.S.trigger(H.H.FreezeDefaultScroll,[e]))}}},{key:"onTapMove",value:function(e){var n=this,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=this.instance,i=function i(){var c=n.options.scrollSpeedDivider,a=o.selectionContext,l=a.scrollSpeed,s=a.targetContainer;if(null!==l.x||null!==l.y){if(r&&n.freezeDefaultScroll(!0),null!==l.y&&0!==l.y){var u=l.y/c;s.scrollTop+=Math.ceil(Math.abs(u))*(u/Math.abs(u))}o.handleAreaChange(e),requestAnimationFrame(i)}else n.freezeDefaultScroll(!1)};requestAnimationFrame(i)}},{key:"onTabStop",value:function(){window.removeEventListener("wheel",this.manualScroll),this.freezeDefaultScroll(!1)}},{key:"calcScrollSpeed",value:function(e){var n=e.targetContainer,r=n.scrollTop,o=n.scrollHeight,i=n.clientHeight,c=n.scrollLeft,a=n.scrollWidth,l=n.clientWidth,s=e.targetBoundary,u=this.options.scrollThresholdOfBoundary,d=e.scrollSpeed,f=e.endX,h=e.endY;f<s.left+u.x?d.x=c?-Math.abs(s.left-f):null:f>s.left+s.width-u.x?d.x=a-c-l?Math.abs(s.left+s.width-f):null:d.x=null,h<s.top+u.y?(d.y=r?-Math.abs(s.top-h):null,V("scrollThresholdOfBoundary.y",u.y,d.y)):h>s.top+s.height-u.y?d.y=o-r-i?Math.abs(s.top+s.height-h):null:d.y=null,e.update({scrollSpeed:d})}}]),e}();!function(e){e[e.NORMAL=0]="NORMAL",e[e.LAZY=1]="LAZY"}(y||(y={}));var z=function(){function e(){k()(this,e),this.renderMode=y.LAZY,this.enableMultiTextSelection=Object(P.P)(),this.isNeedResolveIfLazy=void 0,this.scrollSpeed={x:null,y:null},this.singleClick=!1,this.tripleClick=!1,this.scrollAvailable=!1,this.beginTarget=void 0,this.endTarget=void 0,this.endX=0,this.endY=0,this.targetContainer=void 0,this.targetBoundary=void 0,this.selectables=[],this.selectableCompleted=!1,this.lateralContainerBlockId=null,this.intersectSelectedBlocksMap=new Map,this.staticBeginX=0,this.staticBeginY=0}return x()(e,[{key:"setup",value:function(e){var n=e.beginX,r=e.beginY,o=e.targetContainer;return this.staticBeginX=(n||0)+((null===o||void 0===o?void 0:o.scrollLeft)||0),this.staticBeginY=(r||0)+((null===o||void 0===o?void 0:o.scrollTop)||0),delete e.beginX,delete e.beginY,this.update(e)}},{key:"update",value:function(e){var n=this;return Object.keys(e).forEach((function(r){n[r]=e[r]})),this}},{key:"destroy",value:function(){this.scrollSpeed={x:null,y:null},this.singleClick=!1,this.scrollAvailable=!1,this.beginTarget=void 0,this.endTarget=void 0,this.staticBeginX=0,this.staticBeginY=0,this.endX=0,this.endY=0,this.selectables=[],this.renderMode=y.LAZY,this.isNeedResolveIfLazy=!1,this.intersectSelectedBlocksMap.clear()}},{key:"shouldBuildMultiText",get:function(){return this.enableMultiTextSelection&&this.renderMode===y.LAZY}},{key:"beginX",get:function(){if(this.targetContainer){var e=this.targetContainer.scrollLeft;return this.staticBeginX-e}return 0}},{key:"beginY",get:function(){if(this.targetContainer){var e=this.targetContainer.scrollTop;return this.staticBeginY-e}return 0}}]),e}();function G(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return K(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return K(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function K(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function q(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=T()(e);if(n){var i=T()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return I()(this,r)}}var X,Y=R()("docx:selection:EventDriver"),J=["#docx-popup-container",".embed-spreadsheet",".docx-reminder-popover-wrapper",".docx-mindnote-block-container",".block-overlay",".catalogue",".doc-cover-wrapper","#docCommentContainer",".message-container",".isv-block-container",".find-replace-box-wrapper",".poll-input-textarea",".editor-kit-equation-popover-wrapper",".bidirection-link-list",".".concat(L.q.TABLE_HEADER),".docx-global-comment",'div[class*="mention-container__main"]'];!function(e){e.startTargetFilter="startTargetFilter"}(X||(X={}));var Z=function(e){S()(r,e);var n=q(r);function r(){var e;k()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i)))._frame=document,e.selectionContext=void 0,e.scrollable=void 0,e.rectPainter=void 0,e.store=void 0,e.startTargetFilter=[],e.isSelecting=!1,e.lastSelectionType=void 0,e._activated=!0,e.options=void 0,e.handleBrowserSelectionChange=function(n){if(e.fire(m.j.browserSelectionChange,n),A.S.isMobile){var r=getSelection();if("Range"===(null===r||void 0===r?void 0:r.type)){var o=(null===r||void 0===r?void 0:r.rangeCount)?null===r||void 0===r?void 0:r.getRangeAt(0):void 0;if(o&&r&&"Range"!==e.lastSelectionType){var i=o.startContainer,c=o.endContainer;if(e.isIgnoreNode(i,J)||e.isIgnoreNode(c,J))return;e.lastSelectionType=null===r||void 0===r?void 0:r.type,F.N.emit(F.p.COMMON.SELECTING_TAP_MOVE,!0)}}else e.lastSelectionType=null===r||void 0===r?void 0:r.type,F.N.emit(F.p.COMMON.SELECTING_TAP_STOP,!1)}},e._handleTapStart=function(n){if(e.isActive()&&!n.shiftKey)if(e.isIgnoreEvent(n,J))Y("click on ignored element, return, %o",n.target);else{var r=p(n),o=r.x,i=r.y,c=r.target;Y("start x, y",o,i);var a=c;if(e.isSelecting&&0!==n.button)return e._handleTapStop(n);if(a&&0===n.button){var l=e.options.boundaryAreaContainer;if(e.startTargetFilter.some((function(e){return!e(a)})))Y("selection intercept!");else{var s=a.getBoundingClientRect(),u=l.getBoundingClientRect(),d=Object(N.L)(u,s),f=v(n).includes(l);if(!d||!f)return Y("target not in boundary: %o",a),void e.onTargetNotInBoundray();F.N.emit(F.p.COMMON.SELECTING_TAP_START),e.fire(m.j.beforeStart,n);var h=e.computeRenderModeByStartTarget(a),g=e.serilizeTarget(a,o,i),b=null;h===y.LAZY&&(b=e.getClosestLateralContainerBlockId(a)),e.selectionContext.setup({beginTarget:g,targetContainer:A.S.isMobile?document.scrollingElement||void 0:l,targetBoundary:u,beginX:o,beginY:i,singleClick:!0,renderMode:h,lateralContainerBlockId:b}),Y("setup startpoint",g),e._frame.addEventListener("mousemove",e._delayedTapMove,{passive:!1}),e._frame.addEventListener("mouseup",e._handleTapStop,!0),e._frame.addEventListener("dragend",e._handleTapStop,!0)}}}},e.handleContextmenu=function(){e.fire(m.j.contextmenu)},e.isIgnoreEvent=function(n,r){var o=n.target;return!!o&&e.isIgnoreElement(o,r)},e.isIgnoreNode=function(n,r){var o=n.parentElement;return!!o&&e.isIgnoreElement(o,r)},e.isIgnoreElement=function(e,n){if(n){var r,o=!1,i=G(n);try{for(i.s();!(r=i.n()).done;){var c,a=r.value,l=G($(a).toArray());try{for(l.s();!(c=l.n()).done;){var s=c.value;if(s===e||$.contains(s,e)){o=!0;break}}}catch(u){l.e(u)}finally{l.f()}if(o)break}}catch(u){i.e(u)}finally{i.f()}return o}return!1},e._delayedTapMove=function(n){var r,o=p(n),i=o.x,c=o.y,a=o.target,l=e.options,s=l.startXThresholdWhenLazy,u=l.startYThresholdWhenLazy,d=l.startThresholdWhenNormal,f=e.selectionContext,h=f.beginX,v=f.beginY,g=f.renderMode,b=f.enableMultiTextSelection;if(null===(r=e.options.blockManager)||void 0===r?void 0:r.editable){var _=Math.abs(i-h),k=Math.abs(c-v);if(g===y.NORMAL){var O=_+k<d;if(Y("_delayedTapMove skip=%s(%s+%s < %s)",O,_,k,d),O)return}else if(g===y.LAZY&&!b){var x=e.getClosestLateralContainerBlockId(a),E=_<s||k<u,S=x===e.selectionContext.lateralContainerBlockId,C=E&&S;if(Y("_delayedTapMove skip=%s, smallDelta=%s(%s<%s || %s<%s), isSameId=%s(%s,%s)",C,E,_,s,k,u,S,e.selectionContext.lateralContainerBlockId,x),C)return}}if(e.isActive()){e.selectionContext.renderMode===y.NORMAL&&e.clearBrowserTextSelection(),e._frame.removeEventListener("mousemove",e._delayedTapMove),e._frame.addEventListener("mousemove",e._handleTapMove,{passive:!1}),e.selectionContext.renderMode===y.NORMAL&&e.rectPainter.show();var I=e.selectionContext,B=I.targetContainer,T=I.targetBoundary;e.selectionContext.update({singleClick:!1});var w=A.S.isMobile?B.clientHeight:B.scrollHeight,R=A.S.isMobile?B.clientWidth:B.scrollWidth,M=[Math.round(w)!==Math.round(T.height),Math.round(R)!==Math.round(T.width)].includes(!0);e.selectionContext.update({scrollAvailable:M}),M&&e.scrollable.onDelayMove(n),Y("targetBoundary=%o",T),e.rectPainter.layout({host:{top:T.y,left:T.x,width:T.width,height:T.height}}),e.fire(m.j.start,n),e._handleTapMove(n),n.preventDefault()}},e._handleTapMove=Object(M.throttle)((function(n){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=p(n),i=o.x,c=o.y,a=o.target,l=e.selectionContext.scrollSpeed;e.selectionContext.update({endX:i,endY:c,endTarget:a}),e.isSelecting=!0,F.N.emit(F.p.COMMON.SELECTING_TAP_MOVE,!0);var s=e.checkIfNeedCalcSelectablesIfLazy();e.selectionContext.update({isNeedResolveIfLazy:s});var u=![e.selectionContext.scrollAvailable,null!==l.x||null!==l.y,s].includes(!1);u?(Y("move: scroll"),e.scrollable.onTapMove(n,r)):e.handleAreaChange(n,s)}),30),e._handleTapStop=function(n){e._handleTapMove.cancel(),e.isSelecting=!1,Object(P.P)()||e.selectionContext.isNeedResolveIfLazy&&n&&n.stopPropagation(),e._frame.removeEventListener("mousemove",e._delayedTapMove),e._frame.removeEventListener("mousemove",e._handleTapMove),e._frame.removeEventListener("mouseup",e._handleTapStop),e._frame.removeEventListener("dragend",e._handleTapStop),e.scrollable.onTabStop(),F.N.emit(F.p.COMMON.SELECTING_TAP_STOP,!1),n&&e.fire(m.j.stop,n),e.selectionContext.destroy(),e.rectPainter.hide(),e.store.clearTmpSelection()},e.handleAreaChange=function(n){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.rectPainter.calcAreaRect(e.selectionContext),e.scrollable.calcScrollSpeed(e.selectionContext),r&&(e.calcSelectables(),e.selectionContext.selectables.length>0&&(e.store.computeAndUpdate({selectables:e.selectionContext.selectables,areaRect:e.rectPainter._areaDomRect,selectableCompleted:e.selectionContext.selectableCompleted}),e.store.tmpStored.length&&e.selectionContext.renderMode===y.NORMAL&&e.clearBrowserTextSelection(),e.fire(m.j.move,n))),e.rectPainter.redrawArea(e.selectionContext)},e}return x()(r,[{key:"isActive",value:function(){return this._activated}},{key:"activate",value:function(){this._activated=!0}},{key:"deactivate",value:function(){this._activated=!1}},{key:"register",value:function(e,n){this[e]&&this[e].indexOf(n)<0&&this[e].push(n)}},{key:"unregister",value:function(e,n){this[e]&&(this[e]=this[e].filter((function(e){return e!==n})))}},{key:"setup",value:function(){this.scrollable=new W(this,{scrollSpeedDivider:this.options.scrollSpeedDivider,manualScrollSpeed:this.options.manualScrollSpeed,scrollThresholdOfBoundary:this.options.scrollThresholdOfBoundary}),this.enable()}},{key:"cancel",value:function(){this._handleTapStop()}},{key:"enable",value:function(){this._frame.addEventListener("mousedown",this._handleTapStart),this._frame.addEventListener("contextmenu",this.handleContextmenu),this._frame.addEventListener("selectionchange",this.handleBrowserSelectionChange),this.enableAddition()}},{key:"disable",value:function(){this._frame.removeEventListener("mousedown",this._handleTapStart),this._frame.removeEventListener("contextmenu",this.handleContextmenu),this._frame.removeEventListener("selectionchange",this.handleBrowserSelectionChange),this.disableAddition()}},{key:"destroy",value:function(){this.disable(),this.rectPainter.destroy(),this.store.destroy(),this._frame.removeEventListener("mousemove",this._delayedTapMove),this._frame.removeEventListener("mousemove",this._handleTapMove),this._frame.removeEventListener("mouseup",this._handleTapStop),this._frame.removeEventListener("dragend",this._handleTapStop),this._frame.removeEventListener("selectionchange",this.handleBrowserSelectionChange)}},{key:"serilizeTarget",value:function(e,n,r){return e}},{key:"fire",value:function(e,n){var r={event:n,instance:this,area:this.rectPainter._area,continue:!0,renderMode:this.selectionContext.renderMode,items:this.store.tmpStored.slice()};this.emit(e,r)}},{key:"frame",get:function(){return this._frame}}]),r}(D.a);function Q(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=T()(e);if(n){var i=T()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return I()(this,r)}}var ee=function(e){S()(r,e);var n=Q(r);function r(){return k()(this,r),n.apply(this,arguments)}return x()(r,[{key:"enableAddition",value:function(){}},{key:"disableAddition",value:function(){}}]),r}(Z),te=R()("docx:selection:RectPainter"),ne=function(){function e(n){k()(this,e),this.options=n,this._frame=document,this._area=void 0,this._areaDomRect=void 0,this._hostElement=void 0,this.setup()}return x()(e,[{key:"setup",value:function(){return this._area=this._frame.createElement("div"),this._hostElement=this._frame.createElement("div"),this._hostElement.appendChild(this._area),this._area.classList.add(this.options.selectionAreaClass||""),h(this._area,{willChange:"top, left, bottom, right, width, height",top:0,left:0,position:"fixed"}),h(this._hostElement,{overflow:"hidden",position:"fixed",transform:"translate3d(0, 0, 0)",pointerEvents:"none",zIndex:"99"}),this}},{key:"show",value:function(){this.options.selectionAreaContainer.appendChild(this._hostElement)}},{key:"hide",value:function(){this._hostElement.remove()}},{key:"layout",value:function(e){h(this._hostElement,{top:e.host.top,left:e.host.left,width:e.host.width,height:e.host.height})}},{key:"redrawArea",value:function(e){var n=e.targetBoundary,r=this._areaDomRect,o=r.x,i=r.y,c=r.width,a=r.height,l=this._area.style;l.transform="translate3d(".concat(o-n.x,"px,").concat(i-n.y,"px, 0)"),l.width="".concat(c,"px"),l.height="".concat(a,"px")}},{key:"calcAreaRect",value:function(e){this._areaDomRect=function(e){var n=e.targetBoundary,r=e.endX,o=e.endY;r<n.left?r=n.left:r>n.left+n.width&&(r=n.left+n.width);o<n.top?o=n.top:o>n.top+n.height&&(o=n.top+n.height);var i=Math.min(e.beginX,r),c=Math.min(e.beginY,o),a=Math.max(e.beginX,r),l=Math.max(e.beginY,o);return te("\u77e9\u5f62\u4f4d\u7f6e",i,c,a,l),new DOMRect(i,c,a-i,l-c)}(e)}},{key:"destroy",value:function(){this._hostElement.remove()}}]),e}();function re(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return oe(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oe(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function oe(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function ie(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=T()(e);if(n){var i=T()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return I()(this,r)}}var ce,ae=R()("sophon:selection: SelectionModel");!function(e){e.CHANGE_WHEN_SELECTING="changewhenselecting",e.CHANGE="change",e.CHANGING="changing"}(ce||(ce={}));var le=function(e){S()(r,e);var n=ie(r);function r(e){var o;return k()(this,r),(o=n.call(this)).options=e,o.stored=[],o.tmpStored=[],o.emitedTmpStored=void 0,o}return x()(r,[{key:"onSelectionChangeWhenSelecting",value:function(e){this.on(ce.CHANGE_WHEN_SELECTING,e)}},{key:"offSelectionChangeWhenSelecting",value:function(e){this.off(ce.CHANGE_WHEN_SELECTING,e)}},{key:"onSelectionChange",value:function(e){this.on(ce.CHANGE,e)}},{key:"offSelectionChange",value:function(e){this.off(ce.CHANGE,e)}},{key:"onSelectionChanging",value:function(e){this.on(ce.CHANGING,e)}},{key:"offSelectionChanging",value:function(e){this.off(ce.CHANGING,e)}},{key:"destroy",value:function(){this.removeAllListeners(ce.CHANGE_WHEN_SELECTING),this.removeAllListeners(ce.CHANGE),this.removeAllListeners(ce.CHANGING)}},{key:"transaction",value:function(e,n){var r=this._copy(this.stored);e();var o=!this.isStoreEqual(r,this.stored);return o&&this.emit(ce.CHANGE,r,this._copy(this.stored),n),o&&ae("change",r,this.stored),o}},{key:"isStoreEqual",value:function(e,n){var r=this;return e.length===n.length&&e.every((function(e,o){return r.isModelStrictEqual(e,n[o])}))}},{key:"getSelection",value:function(){return this.stored}},{key:"getTmpSelection",value:function(){return this.tmpStored}},{key:"clearTmpSelection",value:function(){this.tmpStored=[]}},{key:"computeAndUpdate",value:function(e){var n=e.selectables,r=e.areaRect,o=e.selectableCompleted,i=void 0!==o&&o,c=this.options.mode;this.tmpStored=[];var a,l=re(n);try{for(l.s();!(a=l.n()).done;){var s=a.value;if(i)this._pushItem(this.tmpStored,s);else{var u=this.modelToRect(s);Object(N.L)(r,u,c)&&this._pushItem(this.tmpStored,s)}}}catch(d){l.e(d)}finally{l.f()}this.emitSelectionChaning()}},{key:"emitSelectionChaning",value:function(){var e=this.emitedTmpStored||this.stored;this.isStoreEqual(e,this.tmpStored)||(this.emitedTmpStored=this.tmpStored,this.emit(ce.CHANGING,e,this.tmpStored))}},{key:"_removeItem",value:function(e,n){var r=this.indexOf(e,n);~r&&e.splice(r,1)}},{key:"_pushItem",value:function(e,n){var r=this.indexOf(e,n);~r?e[r]=n:e.push(n)}},{key:"_copy",value:function(e){return JSON.parse(JSON.stringify(e))}}]),r}(D.a)},dx_qHgq:function(e,n,r){"use strict";var o,i,c,a;r.d(n,"j",(function(){return i})),r.d(n,"R",(function(){return c})),r.d(n,"y",(function(){return a})),function(e){e[e.TOUCH=0]="TOUCH",e[e.CENTER=1]="CENTER",e[e.COVER=2]="COVER"}(o||(o={})),function(e){e.start="start",e.move="move",e.stop="stop",e.beforeStart="beforeStart",e.browserSelectionChange="browserSelectionChange",e.contextmenu="contextmenu"}(i||(i={})),function(e){e.touchstart="touchstart",e.touchend="touchend",e.touchmove="touchmove"}(c||(c={})),function(e){e.start="start",e.end="end"}(a||(a={}))},dx_qKbM:function(e,n,r){"use strict";r.d(n,"S",(function(){return u}));var o=r("dx_TSYQ"),i=r.n(o),c=r("dx_cDcd"),a=r.n(c),l=r("dx_a6aj"),s=(r("dx_y0f4"),r("dx_CH2c"));function u(e){var n=e.text||l.s;return Object(c.useEffect)((function(){Promise.resolve().then((function(){var n;null===(n=e.renderFinishCb)||void 0===n||n.call(e)}))}),[]),a.a.createElement("span",{onTouchStart:e.onTouchStart,onTouchEnd:e.onTouchEnd,onTouchMove:e.onTouchMove,onMouseDown:e.onMouseDown,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onClick:e.onClick,className:i()("embed-inline-link",e.className,{failed:!!e.failHint}),style:e.style},a.a.createElement("span",null,e.logo,a.a.createElement("span",{className:"text embed-text-container",style:e.textStyle},e.autoSpace?a.a.createElement(s.c,{text:e.text||l.s}):n,e.failHint?a.a.createElement("span",{className:"fail-hint"},e.failHint):null)))}},dx_qKh5:function(e,n,r){"use strict";r.d(n,"h",(function(){return N})),r.d(n,"n",(function(){return F.n})),r.d(n,"r",(function(){return P.r}));var o,i,c,a,l,s=r("dx_yG8O"),u=r.n(s),d=r("dx_lwsE"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_PJYZ"),g=r.n(v),b=r("dx_W7W2"),y=r.n(b),m=r("dx_a1gu"),_=r.n(m),k=r("dx_Nsbk"),O=r.n(k),x=r("dx_Uyc2"),E=r.n(x),S=(r("dx_A1AB"),r("dx_Vvd7")),C=r("dx_xjz2"),I=r("dx_UtDZ"),B=r("dx_Uh2b"),T=function(e){return{type:B.R.ChangeDocsModeState,payload:e}},w=r("dx_iCYT"),R=r("dx_k2kp"),M=r("dx_SMoc"),j=Object(C.s)(M.h)(o=function(){function e(){f()(this,e)}return p()(e,[{key:"getBearDocsMode",value:function(){return Object(R.R)(I.store.getState())}},{key:"setSuitHeaderSwitchShow",value:function(e){I.store.dispatch(T({type:w.Y.CHANGE_SHOW,value:e}))}},{key:"setBearDocsMode",value:function(e){I.store.dispatch(T({type:w.Y.SWITCH_MODE,value:e}))}}]),e}())||o,D=r("dx_QzB0"),A=r("dx_uqnA"),P=r("dx_hoya");function L(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=O()(e);if(n){var i=O()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return _()(this,r)}}var N=Object(S.H)({providers:[j,A.z]})((l=function(e){y()(r,e);var n=L(r);function r(){var e;f()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),u()(e,"service",a,g()(e)),e}return p()(r,[{key:"init",value:function(){Object(P.r)()&&this.service.init()}},{key:"destroy",value:function(){Object(P.r)()&&this.service.destroy()}}]),r}(S.G),c=l,a=E()(c.prototype,"service",[D.H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=c))||i,F=r("dx_DdSJ")},dx_qUru:function(e,n,r){"use strict";r.d(n,"n",(function(){return c})),r.d(n,"Z",(function(){return o})),r.d(n,"G",(function(){return a})),r.d(n,"k",(function(){return l})),r.d(n,"O",(function(){return s}));var o,i=r("dx_B28d"),c=(i.B.SHEET,i.B.BITABLE,i.B.MINDMAP,i.B.FILE,"UPDATE_LOADABLE_BLOCK_COMPONENT");!function(e){e.LOADING="LOADING",e.RENDERING="RENDERING",e.RENDERED="RENDERED"}(o||(o={}));var a=3e4,l=1e4,s=3},dx_qVXE:function(e,n,r){},dx_qYkn:function(e,n,r){"use strict";r.d(n,"z",(function(){return i}));var o=r("dx_Uh2b");function i(e){return{type:o.R.UpdateEmbedObjPermission,payload:e}}},dx_qZ2L:function(e,n,r){"use strict";r.d(n,"S",(function(){return h}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_yzqx"),s=r("dx_Bait"),u=r("dx_D8nn"),d=r("dx_X279"),f=r("dx_MlPX"),h=function(){function e(n){var r=this;i()(this,e),this.catalogue=void 0,this.comment=void 0,this.content=void 0,this.editor=void 0,this.eventEmitter=new u.i,this.removeListener=[],this.initEvent=function(){var e=function(){var e;(e=r.catalogue).emitLayoutChange.apply(e,arguments)};u.S.on(s.v.CATALOGUE_RECT_CHANGE,e),r.removeListener.push((function(){return u.S.removeListener(s.v.CATALOGUE_RECT_CHANGE,e)}));var n=function(){var e;(e=r.comment).emitLayoutChange.apply(e,arguments)};u.S.on(f.g.DOC_COMMENT_SHOW_CHANGE_TRANSITION_END,n),r.removeListener.push((function(){return u.S.removeListener(f.g.DOC_COMMENT_SHOW_CHANGE_TRANSITION_END,n)}));var o=function(){r.comment.isNeedUpdateCache=!0,r.catalogue.isNeedUpdateCache=!0};l.S.isMobile?(window.addEventListener("resize",o),r.removeListener.push((function(){window.removeEventListener("resize",o)}))):r.removeListener.push(Object(d.N)().onResize(o)),r.initEmitLayoutChange()},this.initEmitLayoutChange=function(){var e=r.catalogue.onLayoutChange((function(e){r.eventEmitter.emit(f.g.LAYOUT_CHANGE,{type:"catalogue",value:e})})),n=r.comment.onLayoutChange((function(e){r.eventEmitter.emit(f.g.LAYOUT_CHANGE,{type:"comment",value:e})}));r.removeListener.push(e,n)};var o=n.catalogue,c=n.comment,a=n.content,h=n.editor;this.catalogue=o,this.comment=c,this.content=a,this.editor=h,this.initEvent()}return a()(e,[{key:"destroy",value:function(){this.removeListener.forEach((function(e){"function"===typeof e&&e()}))}}]),e}()},dx_qcGr:function(e,n,r){"use strict";r.d(n,"T",(function(){return c}));var o=r("dx_J4zp"),i=r.n(o);function c(e){var n={orderMap:{}},r=null;e.forEach((function(e){var o=e.positionPath.length;e.positionPath.reduce((function(n,c,a){var l=i()(c,2),s=l[0];return null===l[1]?(r=e,n):(n[s]||(n[s]={orderMap:{}}),a===o-1&&(n[s].target=e),n[s].orderMap)}),n.orderMap)}));var o=[];return function e(n,r){var o=n.orderMap,i=Object.keys(o).sort((function(e,n){return Number(e)-Number(n)}));i.length&&i.forEach((function(n){var i=o[n];i.target&&r.push(i.target),e(i,r)}))}(n,o),r&&o.unshift(r),o}},dx_qdTf:function(e,n,r){"use strict";r.d(n,"O",(function(){return a})),r.d(n,"X",(function(){return l})),r.d(n,"b",(function(){return s})),r.d(n,"o",(function(){return u})),r.d(n,"D",(function(){return f})),r.d(n,"A",(function(){return h})),r.d(n,"i",(function(){return p}));var o=r("dx_rQGm"),i=r("dx_B28d"),c=r("dx_VY1y");function a(e){for(var n=e,r=n.parent;r;){if(c.O.includes(r.type)||r.type===i.B.OKR)return!0;r=(n=r).parent}return!1}function l(e){if(!e.parent||e.parent.type===i.B.PAGE)return 0;var n=[i.B.BULLET,i.B.ORDERED,i.B.TODO].includes(e.parent.type)?o.X-1:o.X;return e.parent.type===i.B.VIEW?l(e.parent):l(e.parent)+n}function s(e){var n=e.parent;if(!n||n.type===i.B.PAGE)return e;for(var r=function(e){for(var n=[e],r=e.parent;r;)n.unshift(r),r=r.parent;return n}(e),o=1;o<r.length;o++){var c=r[o];if(i.h.includes(c.type))return c}return r[r.length-1]}function u(e){for(;e.parent&&e.parent.type!==i.B.PAGE;){if(e.type===i.B.CELL)return e;if(e.parent.type===i.B.CELL)return e.parent;e=e.parent}return null}function d(e){for(var n=e;n.parent;){if(n.parent.type===i.B.PAGE)return null;if(Object(i.q)().includes(n.parent.type)&&n.parent.snapshot.folded)return n.parent;n=n.parent}return null}function f(e){for(var n=e.previous;n&&c.A.includes(n.type);)n=n.previous;if(!n||n.type===i.B.PAGE)return null;if(i.O.includes(e.type)){for(var r=e.parent.children,o=null,l=null,s=e.position-1;s>=0;s--){var u=r[s];if(!o&&i.O.includes(u.type)&&(o=u),u.type===e.type){l=u;break}}if(l&&l.snapshot.folded)return l;if(o&&o.snapshot.folded)return o}if(d(n)){for(;d(n);)n=d(n);return n}for(;n&&a(n);)n=n.parent;return i.w.includes(e.type)&&e.parent&&(n=f(e.parent)),n}function h(e){for(var n=e.next;n&&c.A.includes(n.type);)n=n.next;if(i.O.includes(e.type)&&e.snapshot.folded){for(var r=e.parent.children,o=e.position+1;o<r.length;o++){var l=r[o],s=c.e.indexOf(l.type),u=c.e.indexOf(e.type);if(s>-1&&s<=u)return l}return null}if(Object(i.q)().includes(e.type)&&e.children.length>0&&e.snapshot.folded){for(e=e.children[e.children.length-1];Object(i.q)().includes(e.type)&&e.children.length>0;)e=e.children[e.children.length-1];var d;return e.next&&e.next.type===i.B.CELL?null===(d=e.parent)||void 0===d?void 0:d.next:e.next}for(;n&&a(n);){var f=n.parent.children;n=f[f.length-1].next}return n}function p(e,n){if(!e)return!1;try{var r=n.getBlockViewByBlockId(e);if(r.type===i.B.BITABLE&&function(e){var n=e.blockManager.rootBlockId===e.parentId;return e.getIsHalfFullScreen()&&n}(r)||r.type===i.B.BITABLE&&r.actualScrollLeft>0||r.type===i.B.IFRAME&&r.isLeftSideOverflowEditor||r.type===i.B.TABLE&&r.scrollManage.getScrollStatus().scrollLeft>0||r.type===i.B.SHEET&&r.actualScrollLeft>0)return!0}catch(o){return!1}}},dx_qdiz:function(e,n,r){},dx_qkDo:function(e,n,r){"use strict";r.d(n,"x",(function(){return i})),r.d(n,"K",(function(){return c})),r.d(n,"t",(function(){return a}));var o=r("dx_yzqx"),i=function(){var e;return o.S.isIPad&&o.S.isSafari&&!!(null===(e=window)||void 0===e?void 0:e.PointerEvent)},c=i()?{mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"}:{mousedown:"mousedown",mousemove:"mousemove",mouseup:"mouseup"},a=i()?{mousedown:"onPointerDown",mousemove:"onPointerMove",mouseup:"onPointerUp"}:{mousedown:"onMouseDown",mousemove:"onMouseMove",mouseup:"onMouseUp"}},dx_qu5W:function(e,n,r){"use strict";r.d(n,"W",(function(){return X}));var o,i,c,a,l,s,u,d,f,h,p,v,g=r("dx_yG8O"),b=r.n(g),y=r("dx_lwsE"),m=r.n(y),_=r("dx_W8MJ"),k=r.n(_),O=r("dx_PJYZ"),x=r.n(O),E=r("dx_W7W2"),S=r.n(E),C=r("dx_a1gu"),I=r.n(C),B=r("dx_Nsbk"),T=r.n(B),w=r("dx_Uyc2"),R=r.n(w),M=(r("dx_A1AB"),r("dx_Vvd7")),j=r("dx_k5k3"),D=r("dx_xjz2"),A=r("dx_B28d"),P=Object(D.s)(j.A)((a=function(){function e(){var n=this;m()(this,e),this._isComposing=!1,b()(this,"viewService",c,this),this.subscriptions=void 0,this.updateComposing=function(e){"compositionstart"!==e.type&&"compositionupdate"!==e.type?"compositionend"!==e.type||n.isComposing&&n.setIsComposing(!1):n.isComposing||n.setIsComposing(!0)},this.handleBlockViewMount=function(e){e.props.type===A.B.PAGE&&n.bindEvents()},this.handleBlockViewUnmount=function(e){e.props.type===A.B.PAGE&&n.bindEvents(!1)}}return k()(e,[{key:"setIsComposing",value:function(e){this._isComposing=e}},{key:"init",value:function(){this.subscriptions=[this.viewService.blockViewMount$.subscribe(this.handleBlockViewMount),this.viewService.blockViewUnmount$.subscribe(this.handleBlockViewUnmount)]}},{key:"destroy",value:function(){this.subscriptions.forEach((function(e){return e.unsubscribe()}))}},{key:"bindEvents",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=e?"addEventListener":"removeEventListener";this.rootEditableElement[n]("compositionstart",this.updateComposing),this.rootEditableElement[n]("compositionupdate",this.updateComposing),this.rootEditableElement[n]("compositionend",this.updateComposing)}},{key:"isComposing",get:function(){return this._isComposing}},{key:"rootEditableElement",get:function(){var e,n=null===(e=this.viewService.rootBlockView)||void 0===e?void 0:e.contentElement;return(null===n||void 0===n?void 0:n.closest('[data-content-editable-root="true"]'))||document}}]),e}(),i=a,c=R()(i.prototype,"viewService",[M.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=i))||o,L=P,N=r("dx_HLaa"),F=r("dx_UtS6"),U=r("dx_NOtv"),H=r.n(U),V=r("dx_ZG9w"),W=r("dx_KFmR"),z=r("dx_iw8O"),G=H()("MouseEventService"),K=Object(D.s)(N.D)((s=function(){function e(){var n=this;m()(this,e),this._isMouseDown=!1,this.editors=new Set,b()(this,"viewService",u,this),this.handleMouseDown=function(e){var r=e.clientX,o=e.clientY,i=r-window.pageXOffset,c=o-window.pageYOffset,a=Object(F.f)(i,c).textNode,l=a&&Object(z.S)(a),s=l&&n.viewService.getBlockViewByBlockId(l);s&&Object(V.f)(s)&&(n.dispatchEvent(e,s.editor),n.editors.add(s.editor),G("===> handleMouseDown dispatch editor %O",s.editor.getContainer())),n._isMouseDown=!0},this.handleMouseUp=function(e){n.editors.forEach((function(r){n.dispatchEvent(e,r),G("===> handleMouseup dispatch editor %O",r.getContainer())})),n.editors.clear(),n._isMouseDown=!1}}return k()(e,[{key:"init",value:function(){document.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("mouseup",this.handleMouseUp)}},{key:"destroy",value:function(){document.removeEventListener("mousedown",this.handleMouseDown),document.removeEventListener("mouseup",this.handleMouseUp)}},{key:"dispatchEvent",value:function(e,n){var r=Object(W.u)(e,n);n.getDelegator().dispatchNativeEvent(r),r.defaultPrevented&&e.preventDefault()}},{key:"isMouseDown",get:function(){return this._isMouseDown}}]),e}(),u=R()(s.prototype,"viewService",[M.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=s))||l;function q(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=T()(e);if(n){var i=T()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return I()(this,r)}}var X=Object(M.H)({providers:[L,K]})((v=function(e){S()(r,e);var n=q(r);function r(){var e;m()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),b()(e,"composingService",h,x()(e)),b()(e,"mouseEventService",p,x()(e)),e}return k()(r,[{key:"init",value:function(){this.composingService.init(),this.mouseEventService.init()}},{key:"destroy",value:function(){this.composingService.destroy(),this.mouseEventService.destroy()}}]),r}(M.G),f=v,h=R()(f.prototype,"composingService",[j.A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=R()(f.prototype,"mouseEventService",[N.D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=f))||d},dx_r2rw:function(e,n,r){"use strict";r.d(n,"S",(function(){return O}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_cDcd"),b=r.n(g),y=r("dx_yzqx"),m=r("dx_Vau3"),_=r("dx_zghO");r("dx_OpCt");function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var O=function(e){d()(r,e);var n=k(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"getWrapper",value:function(e){var n=this.options,r=n.isEffectiveInPart,o=n.disabled;return function(n){var c=n.blockId,a=n.recursionProps,l=a.selectionAPI,s=!!a.editPermission,u=!!a.isPresentationMode,d=!!l.getSelection().find((function(e){var n=e.id;return c===n})),f=Object(g.useState)(d),h=i()(f,2),p=h[0],v=h[1],m=Object(g.useCallback)((function(e,n){var r=n.some((function(e){return e.id===c}));v(r)}),[c]);if(b.a.useEffect((function(){return s&&l.onSelectionChange(m),function(){s&&l.offSelectionChange(m)}}),[s,l,m]),Object(g.useMemo)((function(){return null===o||void 0===o?void 0:o(n)}),[n]))return b.a.createElement(e,n);var k=function(){p&&y.S.isLark&&y.S.isMobile?l.removeAllSelection():!s&&!u||p||y.S.isLark&&y.S.isMobile||l.setSelection([{id:c,type:_.j.BLOCK}])};return r?b.a.createElement("div",{onClick:function(e){e.stopPropagation(),l.removeAllSelection(),y.S.isSafari&&l.restoreFocus()}},b.a.createElement(e,Object.assign({isSelected:p},n,{onBlockClick:function(e){e.stopPropagation(),k()}}))):b.a.createElement("div",{onClick:k,className:"block-content-container",contentEditable:!1},b.a.createElement(e,Object.assign({isSelected:p},n)))}}}]),r}(m.A)},dx_r37e:function(e,n,r){"use strict";r.d(n,"q",(function(){return u}));var o,i=r("dx_lSNA"),c=r.n(i),a=r("dx_CwnG"),l=r("dx_XW5M"),s=(o={},c()(o,l.t.Add,"ccm_doc_add_panel_click"),c()(o,l.t.BlockMenu,"ccm_doc_web_menu_panel_click"),c()(o,l.t.Slash,"ccm_doc_slash_panel_click"),o),u=function(e){var n=e.block,r=e.panelType,o=e.target,i=e.blockManager,c=e.actionType;return{eventName:r&&s[r],action_type:c,object_block_data:Object(a.T)([n.id],i),target:o,click:"block_action"}}},dx_r3rH:function(e,n,r){"use strict";r.d(n,"M",(function(){return s})),r.d(n,"m",(function(){return u})),r.d(n,"z",(function(){return d})),r.d(n,"mH",(function(){return f}));var o,i=r("dx_J4zp"),c=r.n(i),a=r("dx_cDcd"),l=new(r("dx_D8nn").i);function s(e){l.trigger(o.TEXT_TOOLBAR_HOVER,[e])}function u(e){l.trigger(o.TABLE_CELL_TEXT_TOOLBAR_HOVER,[e])}function d(e){l.trigger(o.TABLE_POPOVER_TEXT_TOOLBAR_HOVER,[e])}function f(){var e=Object(a.useState)(!1),n=c()(e,2),r=n[0],i=n[1],s=Object(a.useState)(!1),u=c()(s,2),d=u[0],f=u[1],h=Object(a.useState)(!1),p=c()(h,2),v=p[0],g=p[1],b=Object(a.useCallback)((function(e){i(e)}),[]),y=Object(a.useCallback)((function(e){f(e)}),[]),m=Object(a.useCallback)((function(e){g(e)}),[]);return Object(a.useEffect)((function(){return l.on(o.TEXT_TOOLBAR_HOVER,b),l.on(o.TABLE_CELL_TEXT_TOOLBAR_HOVER,y),l.on(o.TABLE_POPOVER_TEXT_TOOLBAR_HOVER,m),function(){l.off(o.TEXT_TOOLBAR_HOVER,b),l.off(o.TABLE_CELL_TEXT_TOOLBAR_HOVER,y),l.off(o.TABLE_POPOVER_TEXT_TOOLBAR_HOVER,m)}}),[b,y,m]),r||d||v}!function(e){e.TEXT_TOOLBAR_HOVER="TEXT_TOOLBAR_HOVER",e.TABLE_CELL_TEXT_TOOLBAR_HOVER="TABLE_CELL_TEXT_TOOLBAR_HOVER",e.TABLE_POPOVER_TEXT_TOOLBAR_HOVER="TABLE_POPOVER_TEXT_TOOLBAR_HOVER"}(o||(o={}))},dx_r3ra:function(e,n,r){"use strict";function o(){var e,n;return{promise:new Promise((function(r,o){e=r,n=o})),resolve:e,reject:n}}r.d(n,"t",(function(){return o}))},dx_r4RQ:function(e,n,r){"use strict";r.d(n,"A",(function(){return l})),r.d(n,"s",(function(){return s})),r.d(n,"E",(function(){return u})),r.d(n,"m",(function(){return f})),r.d(n,"M",(function(){return h})),r.d(n,"o",(function(){return p})),r.d(n,"t",(function(){return v}));var o,i=r("dx_lSNA"),c=r.n(i),a=r("dx_B28d"),l="[shortcut]",s=".pdf",u=".docx-page-block",d=(o={},c()(o,a.B.HEADINGN,[".heading"]),c()(o,a.B.BULLET,[".list"]),c()(o,a.B.TABLE,["tr"]),c()(o,a.B.TODO,[".todo-block"]),c()(o,a.B.TASK,[".task-block"]),c()(o,a.B.IMAGE,[".docx-image-block"]),c()(o,a.B.DIAGRAM,[".docx-diagram-block"]),c()(o,a.B.MINDMAP,[".docx-mindnote-block"]),c()(o,a.B.FILE,[".docx-file-block"]),c()(o,a.B.BITABLE,[".docx-bitable-block .bitable-block-container",".docx-bitable-block .docx-block-loading-container",".shortcut-block-error-container"]),c()(o,a.B.SHEET,[".docx-sheet-block"]),c()(o,a.B.POLL,[".docx-poll-block"]),c()(o,a.B.ISV,[".docx-isv-block"]),c()(o,a.B.CHAT_CARD,[".docx-chat_card-block"]),c()(o,a.B.JIRA_ISSUE,[".docx-jira_issue-block"]),c()(o,a.B.JIRA_FILTER,[".docx-jira_filter-block"]),c()(o,a.B.IFRAME,[".iframe-placeholder-container"]),c()(o,a.B.BOOKMARK,[".docx-bookmark-block"]),o),f=new Set;Object.values(d).forEach((function(e){e.forEach((function(e){e&&f.add(e)}))}));var h=function(){var e=document.createElement("div");e.style.width="1in";var n=document.getElementsByTagName("body")[0];n.appendChild(e);var r=getComputedStyle(e,null).getPropertyValue("width");return n.removeChild(e),parseFloat(r)}(),p=7.48259842519685,v=10.90259842519685},dx_r4mc:function(e,n,r){"use strict";r.d(n,"S",(function(){return N}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_RIqP"),a=r.n(c),l=r("dx_o0o1"),s=r.n(l),u=r("dx_yXPU"),d=r.n(u),f=r("dx_lwsE"),h=r.n(f),p=r("dx_W8MJ"),v=r.n(p),g=r("dx_iWIM"),b=r.n(g),y=r("dx_W7W2"),m=r.n(y),_=r("dx_a1gu"),k=r.n(_),O=r("dx_Nsbk"),x=r.n(O),E=r("dx_QxNg"),S=r("dx_cDcd"),C=r.n(S),I=r("dx_faye"),B=r("dx_vOIB"),T=r("dx_w8Jj"),w=r("dx_FvGq"),R=r("dx_Vau3"),M=r("dx_k8kI"),j=r("dx_r61a"),D=r("dx_XlRC");function A(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return P(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function P(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function L(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=x()(e);if(n){var i=x()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return k()(this,r)}}var N=function(e){m()(r,e);var n=L(r);function r(e){var o;return h()(this,r),(o=n.call(this,e)).map=o.blockManager.orderMap,o.pending=new Set,o.updateOrderCallbacks=new Map,o.hasUpdateOrderScheduled=!1,o.bufferChangedCallbacks=new Set,o.onBufferChanged=function(e){var n=e.enterBlocks,r=e.leaveBlocks,i=new Set(n),c=new Set(r);o.bufferChangedCallbacks.forEach((function(e){return e(i,c)}))},o.onAfterRecordChange=d()(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(T.i)();case 2:o.flushToUpdateOrder();case 3:case"end":return e.stop()}}),e)}))),o.blockManager.addListener(M.a,o.onBufferChanged),o.blockManager.recordManager.on(E.q.CHANGE,o.onAfterRecordChange),o}return v()(r,[{key:"destroy",value:function(){b()(x()(r.prototype),"destroy",this).call(this),this.blockManager.recordManager.off(E.q.CHANGE,this.onAfterRecordChange),this.blockManager.removeListener(M.a,this.onBufferChanged)}},{key:"scheduleToUpdateOrder",value:function(e){var n=this;this.pending.add(e),this.hasUpdateOrderScheduled||(this.hasUpdateOrderScheduled=!0,Promise.resolve().then((function(){n.hasUpdateOrderScheduled=!1,n.flushToUpdateOrder()})))}},{key:"getPreviousBlockPosition",value:function(e,n){if(n>0){if(!Object(D.J)(e[n--]))for(;Object(D.J)(e[n]);)--n;return n}return-1}},{key:"getPreviousOrderedBlockPositionIncludeDeleted",value:function(e,n){if(n>0){for(;--n>=0&&!Object(D.D)(e[n]););return n}return-1}},{key:"getPreviousOrderedBlockPosition",value:function(e,n){if(n>0){if(Object(D.J)(e[n]))for(;--n>=0&&!Object(D.D)(e[n]););else for(;--n>=0&&(!Object(D.D)(e[n])||Object(D.J)(e[n])););return n}return-1}},{key:"getNextBlockPosition",value:function(e,n){var r=e.length;if(n<r){if(!Object(D.J)(e[n++]))for(;Object(D.J)(e[n]);)++n;return n}return r}},{key:"getNextOrderedBlockPositionIncludeDeleted",value:function(e,n){var r=e.length;if(n<r){for(;++n<=r&&!Object(D.D)(e[n]););return n}return r}},{key:"getNextOrderedBlockPosition",value:function(e,n){var r=e.length;if(n<r){if(Object(D.J)(e[n]))for(;++n<=r&&!Object(D.D)(e[n]););else for(;++n<=r&&(!Object(D.D)(e[n])||Object(D.J)(e[n])););return n}return r}},{key:"getBlockOrder",value:function(e){if(!e)return 0;var n=this.map;if(!n.has(e.record.id)){var r;if(!Object(D.D)(e))return 0;var o=1,i=Object(D.J)(e),c=(null===(r=e.parent)||void 0===r?void 0:r.children)||[],a=e.position,l=this.getPreviousBlockPosition(c,a);if(l>=0){for(;Object(D.D)(c[l])&&!n.has(c[l].record.id);){var s=l-1;if(i){if(!Object(D.J)(c[l]))break}else s=this.getPreviousBlockPosition(c,l);if(s<0)break;l=s}for(Object(D.q)(c[l])&&(o=this.getBlockOrder(c[l])+1),l=i?l+1:this.getNextBlockPosition(c,l);l!==a;)n.set(c[l].record.id,o++),l=i?l+1:this.getNextBlockPosition(c,l)}return n.set(e.record.id,o),o}return Object(D.D)(e)?n.get(e.record.id):(n.delete(e.record.id),0)}},{key:"getBlockOrderNew",value:function(e){if(!e)return 0;var n=this.map;if(!n.has(e.record.id)){var r;if(Object(D.i)(e)){var o=Number(e.record.snapshot.seq);return n.set(e.record.id,o),o}var i=1,c=Object(D.J)(e),a=(null===(r=e.parent)||void 0===r?void 0:r.children)||[],l=e.position,s=this.getPreviousOrderedBlockPosition(a,l);if(s>=0){for(;!Object(D.i)(a[s])&&!n.has(a[s].record.id);){var u=this.getPreviousOrderedBlockPositionIncludeDeleted(a,s);if(c){if(!Object(D.J)(a[s]))break}else u=this.getPreviousOrderedBlockPosition(a,s);if(u<0)break;s=u}for(i=this.getBlockOrderNew(a[s])+1,s=c?this.getNextOrderedBlockPositionIncludeDeleted(a,s):this.getNextOrderedBlockPosition(a,s);s<l;)n.set(a[s].record.id,i++),s=c?this.getNextOrderedBlockPositionIncludeDeleted(a,s):this.getNextOrderedBlockPosition(a,s)}return n.set(e.record.id,i),i}return Object(D.D)(e)?n.get(e.record.id):(n.delete(e.record.id),0)}},{key:"updateOrder",value:function(e){var n;if(!Object(D.D)(e))return this.map.delete(e.record.id),null;var r=(null===(n=e.parent)||void 0===n?void 0:n.children)||[],o=r[this.getPreviousBlockPosition(r,e.position)];if(o&&!Object(D.q)(o)){return this.map.set(e.record.id,1),1}var i=this.getBlockOrder(o)+1;return this.map.set(e.record.id,i),i}},{key:"updateOrderNew",value:function(e){var n;if(e.isDestroyed)return this.map.delete(e.record.id),null;if(!Object(D.D)(e))return this.map.delete(e.record.id),null;if(Object(D.i)(e)){var r=Number(e.record.snapshot.seq);return this.map.set(e.record.id,r),r}var o=(null===(n=e.parent)||void 0===n?void 0:n.children)||[],i=o[this.getPreviousOrderedBlockPosition(o,e.position)],c=this.getBlockOrderNew(i)+1;return this.map.set(e.record.id,c),c}},{key:"flushToUpdateOrder",value:function(){var e=this;if(this.pending.size){var n=this.blockManager,r=a()(this.pending).map((function(e){return n.hasBlockModelByBlockId(e)?n.getBlockModelByBlockId(e):null}));r.sort((function(e,n){return e?n?e.depth-n.depth||e.position-n.position:-1:1})),this.pending.clear();var o=this.updateOrderCallbacks;Object(I.unstable_batchedUpdates)((function(){var n,i=A(r);try{for(i.s();!(n=i.n()).done;){var c=n.value;if(!c)break;var a,l=null;if(null!=(l=Object(D.q)(c)?e.updateOrder(c):e.updateOrderNew(c)))null===(a=o.get(c.id))||void 0===a||a(l)}}catch(s){i.e(s)}finally{i.f()}}))}}},{key:"getWrapper",value:function(e){var n=this;return function(r){var o=r.blockId,c=r.model,a=Object(S.useState)((function(){return Object(D.q)(c)?n.getBlockOrder(c):n.getBlockOrderNew(c)})),l=i()(a,2),s=l[0],u=l[1];return Object(S.useLayoutEffect)((function(){var e=function(e){s!==e&&u(e)},r=function(r,i){if(r.has(o))return n.scheduleToUpdateOrder(o),void n.updateOrderCallbacks.set(o,e);i.has(o)&&n.updateOrderCallbacks.delete(o)};return n.blockManager.layoutManager.isBlockActive(o)&&n.updateOrderCallbacks.set(o,e),n.bufferChangedCallbacks.add(r),function(){n.bufferChangedCallbacks.delete(r)}}),[o,s]),Object(S.useEffect)((function(){return function(){n.updateOrderCallbacks.delete(o)}}),[o]),Object(S.useEffect)((function(){var e=function(){n.scheduleToUpdateOrder(o)},r=function(){if(!n.pending.has(o)){n.scheduleToUpdateOrder(o);var e,r=A(Object(D.q)(c)?Object(D.Y)(n.blockManager,o,j.b.DOWN):Object(D.c)(n.blockManager,o,j.b.DOWN));try{for(r.s();!(e=r.n()).done;){var i=e.value;n.scheduleToUpdateOrder(i.blockId)}}catch(a){r.e(a)}finally{r.f()}}};return n.blockManager.addListener(j.O,e,o),n.blockManager.addListener(w.f,e,o),n.blockManager.addListener(w.m,r,o),function(){n.blockManager.removeListener(j.O,e,o),n.blockManager.removeListener(w.f,e,o),n.blockManager.removeListener(w.m,r,o)}}),[o,c]),C.a.createElement(e,Object.assign({},r,{order:s,level:Object(B.q)(c)}))}}}]),r}(R.A)},dx_r61a:function(e,n,r){"use strict";r.d(n,"h",(function(){return l})),r.d(n,"b",(function(){return i})),r.d(n,"i",(function(){return s})),r.d(n,"O",(function(){return u}));var o,i,c=r("dx_lSNA"),a=r.n(c),l=999999999;!function(e){e[e.UP=1]="UP",e[e.DOWN=2]="DOWN"}(i||(i={}));var s=(o={},a()(o,i.UP,-1),a()(o,i.DOWN,1),o),u="ORDERED_ORDER_UPDATE"},dx_r7Ym:function(e,n,r){"use strict";r.d(n,"s",(function(){return x})),r.d(n,"D",(function(){return E}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lSNA"),s=r.n(l),u=r("dx_UtDZ"),d=r("dx_MoY1"),f=r("dx_hDVN"),h=r("dx_Sj0J"),p=r("dx_FH1m"),v=r("dx_U9rT"),g=r("dx_kZ3l"),b=r("dx_fEKD"),y=r("dx_B28d"),m=r("dx_Jwfk"),_=r("dx_cqMB");function k(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function O(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?k(Object(r),!0).forEach((function(n){s()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function x(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y.B.MINDMAP;return Object(b.b)(O(O({height:m.Y},e),{},{token:""}),n)}function E(e){return S.apply(this,arguments)}function S(){return(S=a()(i.a.mark((function e(n){var r,o,c,a,l,s,b,m,k,O,x;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(u.isOnline)()){e.next=3;break}return console.error("[mindmap] insertMindMap failed when offline"),e.abrupt("return",{code:_.u.offlineError});case 3:if(console.info("[mindmap] start insertMindMap"),r=n.block,o=n.blockManager,c=n.isAppend,a=n.mark,l=[r],s="",b=r,!c){e.next=12;break}return e.next=11,Object(f.S)({blockManager:o,blocks:l,newBlockType:y.B.TEXT});case 11:b=e.sent;case 12:return m=Object(h.N)(b,null!==a&&void 0!==a?a:{}),e.next=15,Object(p.q)(o,b,g.S(m),o.createInitModel(y.B.MINDMAP,{token:s}));case 15:if(k=e.sent){e.next=18;break}return e.abrupt("return",{code:_.u.insertBlockError});case 18:return O=o.getBlockModelByBlockId(k),e.prev=19,x=o.editorAPI.getService(v.i).getDepLoader(),e.next=23,x.generateMindnoteTokenByDefaultData(k);case 23:s=e.sent,e.next=30;break;case 26:return e.prev=26,e.t0=e.catch(19),o.hasBlockModelByBlockId(k)&&o.applyTransaction("deleteMindmapBlock",(function(e){k&&Object(d.y)(e,[O])})),e.abrupt("return",{code:_.u.createTokenError,error:e.t0});case 30:return o.applyTransaction("updateMindmapBlock",(function(e){var n;try{n=o.getRecordByBlockId(k).id}catch(r){return void console.error("updateMindmapBlock error",r)}e.replace(n,["token"],s)}),{undoable:!1}),e.abrupt("return",{code:_.u.success,newBlockId:k});case 32:case"end":return e.stop()}}),e,null,[[19,26]])})))).apply(this,arguments)}},dx_r7r3:function(e,n,r){},dx_rAjM:function(e,n,r){},dx_rC1h:function(e,n,r){},dx_rCbK:function(e,n,r){"use strict";r.d(n,"X",(function(){return i})),r.d(n,"b",(function(){return c})),r.d(n,"e",(function(){return a})),r.d(n,"q",(function(){return l})),r.d(n,"Q",(function(){return s})),r.d(n,"n",(function(){return u})),r.d(n,"r",(function(){return d})),r.d(n,"v",(function(){return f})),r.d(n,"K",(function(){return h})),r.d(n,"p",(function(){return p})),r.d(n,"s",(function(){return v}));var o=r("dx_Mzjv"),i="SHOW_INLINE_TRIGGER",c="HIDE_INLINE_TRIGGER",a=[o.R.BottomLeft,o.R.TopLeft],l=[0,2],s=240,u=220,d=160,f=420,h="inline-trigger-place-holder",p="inline-trigger",v="data-placeholder"},dx_rG4Y:function(e,n,r){},dx_rGeQ:function(e,n,r){"use strict";r.d(n,"S",(function(){return f}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r("dx_yzqx"),l=r("dx_S6dX"),s=r("dx_tX8z"),u=r("dx_ml3I"),d=function(e,n,r){var o=i()(r,2),c=o[0],l=o[1];return a.S.ios||a.S.isWebKit?new DOMRect(e.x+12+c,Math.max(e.y,0)+12+l,e.width-24-2*c,(e.y>0?Math.min(e.height,n.height-e.y):n.height)-24-2*l):new DOMRect(e.x+12+c,e.y+12+l,e.width-24-2*c,e.height-24-2*l)};function f(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[0,0],a=Object(s.l)(e,n,r),f=Object(u.S)(r),h=Object(c.useState)(d(a,f,o)),p=i()(h,2),v=p[0],g=p[1];return Object(c.useEffect)((function(){g((function(e){var n=d(a,f,o);return Object(l.K)(e,n)?e:n}))}),[a,f,o]),v}},dx_rR5J:function(e,n,r){"use strict";r.d(n,"M",(function(){return o})),r.d(n,"i",(function(){return i})),r.d(n,"Q",(function(){return c}));var o=87,i=79,c=89},dx_rT1F:function(e,n,r){"use strict";(function(t){r.d(n,"K",(function(){return Ke}));var e=r("dx_lSNA"),o=r.n(e),i=(r("dx_TDbF"),r("dx_CCvh")),c=r.n(i),a=r("dx_RIqP"),l=r.n(a),s=r("dx_o0o1"),u=r.n(s),d=r("dx_yXPU"),f=r.n(d),h=r("dx_lwsE"),p=r.n(h),v=r("dx_W8MJ"),g=r.n(v),b=r("dx_PJYZ"),y=r.n(b),m=r("dx_W7W2"),_=r.n(m),k=r("dx_a1gu"),O=r.n(k),x=r("dx_Nsbk"),E=r.n(x),S=r("dx_uxuX"),C=r("dx_Vvd7"),I=r("dx_QxNg"),B=r("dx_xjz2"),T=r("dx_FBWK"),w=r("dx_TSYQ"),R=r.n(w),M=r("dx_UtDZ"),j=r("dx_h6a8"),D=r("dx_cDcd"),A=r.n(D),P=r("dx_Yrx2"),L=r("dx_T1GN"),N=r.n(L),F=r("dx_Xppr"),U=r("dx_rQGm"),H=r("dx_xQPx"),V=r("dx_yzqx"),W=r("dx_SreQ"),z=r("dx_UHze"),G=r("dx_GPzN"),K=r("dx_f650"),q=r("dx_xWbU"),X=r("dx_jBAU"),Y=r("dx_LbJg"),J=r("dx_Fimk"),Z=r("dx_vGb7"),Q=r("dx_WdfZ"),$=r("dx_imty"),ee=r("dx_fqRu"),te=r("dx_M7MP"),ne=r("dx_O5Om"),re=r("dx_Xdvu"),oe=r("dx_qu5W"),ie=r("dx_EqZO"),ce=r("dx_ChZh"),ae=r("dx_Dtqr"),le=r("dx_P58d"),se=r("dx_UhQm"),ue=r("dx_W7Th"),de=r("dx_bkVC"),fe=r("dx_eGDr"),he=r("dx_Ogyw"),pe=r("dx_hoya"),ve=r("dx_D8nn"),ge=r("dx_FwAy"),be=r("dx_Z50P"),ye=r("dx_B1Bt"),me=r("dx_iheU"),_e=r("dx_K2KV"),ke=r("dx_BBJ7"),Oe=r("dx_X279"),xe=r("dx_JZDi"),Ee=r("dx_qBEj"),Se=r("dx_dr3d"),Ce=r("dx_G3GD"),Ie=r("dx_xI7u"),Be=r("dx_JHBk"),Te=r("dx_KdQW"),we=r("dx_fLRZ"),Re=r("dx_tWVV"),Me=r("dx_SXeD"),je=r("dx_hE7T");r("dx_vevK"),r("dx_ODGH"),r("dx_aaXo");function De(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Ae(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?De(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Pe(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=E()(e);if(n){var i=E()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return O()(this,r)}}var Le=M.renderHelpers.MultiStageRenderContainer,Ne=M.renderHelpers.DocxStage,Fe=M.renderHelpers.Business,Ue=Object(je.N)(Re.U),He=Object(je.N)(Re.O),Ve=Object(je.N)(Re.lm),We=function(e){return e<=540},ze=function(e){return e>520&&e<=800},Ge=function(e){return e>800&&e<=1425},Ke=function(e){_()(r,e);var n=Pe(r);function r(){var e;p()(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(e=n.call.apply(n,[this].concat(i)))._isOpenKeyboard=!1,e.editor=null,e.scroller=null,e.contentRef=A.a.createRef(),e.isHistoryVisible=!1,e.reactReduxContext=void 0,e.globalStateService=void 0,e.taskQueue=new be.W,e.state={editorLoading:!0,editorError:!1,isDataReady:!Object(ce.U)(),isOfflineApplied:!Object(ae.C)()},e.container=null,e.scrollingDetector=void 0,e.cancelSetEditorLoading=void 0,e.lastBreakpoint="lg",e.onRootResize=function(n){if(e.props.tokenFromWiki&&n){var r=n.width,o="lg";if(We(r)?o="xs":ze(r)?o="sm":Ge(r)&&(o="md"),e.contentRef.current&&e.lastBreakpoint!==o){var i=e.contentRef.current.classList;i.remove("page-main-in-wiki-".concat(e.lastBreakpoint)),i.add("page-main-in-wiki-".concat(o)),e.lastBreakpoint=o}}},e.getEditorStyle=function(){return e.props.style},e.handleHistoryCloseComment=function(n){var r;null===(r=e.commentModule)||void 0===r||r.toggleCommentPanel(!1),e.isHistoryVisible=n},e.handleDataReady=function(){var n,r;Object(Me.m)(),X.S.updateRecentList(e.props.token,null===(n=(r=e.props).getClientVarsRequestExtraParams)||void 0===n?void 0:n.call(r)),e.setState({isDataReady:!0})},e.postHandleDataReady=function(){!V.S.isInVC&&e.blockManager&&!Object(W.P)()&&Object(ge.S)(e.blockManager)&&e.focusTitle(),Object(M.getMinaConfig)("ccm.docx.comment_delay_enable",!1)&&setTimeout((function(){e.commentModule&&e.taskQueue.defer(e.commentModule.load)}),50)},e.handleAfterUndoRedo=function(){var n=f()(u.a.mark((function n(r,o,i,c){var a,l,s,d,f,h,p;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o&&o.selection&&!o.applyOptions.undoNotSetSelection){n.next=3;break}return null===c||void 0===c||c(),n.abrupt("return");case 3:if(a=o.selection,l=a.prev,s=a.next,i!==le.q.Undo){n.next=11;break}if(n.t0=void 0!==(null===(d=l[0])||void 0===d?void 0:d.id),!n.t0){n.next=9;break}return n.next=9,null===(f=e.viewport)||void 0===f?void 0:f.scrollToBlock(l[0].id,void 0,void 0,"handleAfterUndoRedo");case 9:n.next=16;break;case 11:if(i!==le.q.Redo){n.next=16;break}if(n.t1=void 0!==(null===(h=s[0])||void 0===h?void 0:h.id),!n.t1){n.next=16;break}return n.next=16,null===(p=e.viewport)||void 0===p?void 0:p.scrollToBlock(s[0].id,void 0,void 0,"handleAfterUndoRedo");case 16:null===c||void 0===c||c();case 17:case"end":return n.stop()}}),n)})));return function(e,r,o,i){return n.apply(this,arguments)}}(),e.handleAllDataReady=function(){var n,r,o;null===(n=(r=e.props).reportWikiAllContentLoaded)||void 0===n||n.call(r),null===(o=e.pcMessage)||void 0===o||o.handleAllDataReady(),ue.g.fetchIgnoreAbbreviationList()},e.handleFirstScreenReady=function(){var n,r;null===(n=(r=e.props).reportWikiFirstContentLoaded)||void 0===n||n.call(r)},e.createDocxEditor=function(n){e.container=n;var r=Object(Me.n)(e.props,n);e.scroller=r;var o=Object(Me.l)(e.props,n),i=e.props,c=i.token,a=i.commentable,s=i.hasCover,u=i.tokenFromWiki,d=i.onWikiSidebarResize,f=i.getClientVarsRequestExtraParams,h=i.reportWikiFirstContentLoaded,p=i.reportWikiAllContentLoaded,v=i.awaitFirstSliceClientVars,g={token:c,copyable:e.props.copyable,editable:e.canEdit,editPermission:e.editable,commentable:a,container:n,boundary:o,scroller:r,hasCover:s,reactReduxContext:e.reactReduxContext,translated:e.translated,getEditorStyle:e.getEditorStyle,isInWiki:e.props.isInWiki,isMain:!0,awaitFirstSliceClientVars:v},b=new B.j;return b.bind({provide:ke.y,useValue:e.globalStateService}),Object(P.U)({config:g,rootInjector:b,rendererOptions:{BlockContextProvider:function(n){return Object(K.I)(e.reactReduxContext,n)},RootBlockContextProvider:function(e){return A.a.createElement(xe.Y,{tokenFromWiki:u,onWikiSidebarResize:d,getClientVarsRequestExtraParams:f,reportWikiFirstContentLoaded:h,reportWikiAllContentLoaded:p},A.a.createElement(ke.a,null,e))},layoutConfig:{enableCheckViewportVisibility:Object(Se.J)(),scroller:e.getScrollerForLayoutManager(),errorFrom:"pageMain"}},modules:[Object(C.Y)(_e.x,{contentRef:function(){return e.contentRef.current},getIsMobileEditMode:function(){return e.props.editing},vcController:e.props.vcController,onContextInit:function(n){var r=n.eventEmitter;r.on(ie.R.CLIENTVAR_SUB_TASK_FINISH,e.handleFirstScreenReady),r.on(ie.R.CLIENTVAR_FETCH_ALLOW_EDIT,e.handleDataReady),r.on(ie.R.POST_CLIENTVAR_FETCH_ALLOW_EDIT,e.postHandleDataReady),r.on(ie.R.CLIENTVAR_APPLY_ALL_DONE,e.handleAllDataReady)},onContextDestroy:function(n){var r=n.eventEmitter;r.off(ie.R.CLIENTVAR_SUB_TASK_FINISH,e.handleFirstScreenReady),r.off(ie.R.CLIENTVAR_FETCH_ALLOW_EDIT,e.handleDataReady),r.off(ie.R.POST_CLIENTVAR_FETCH_ALLOW_EDIT,e.postHandleDataReady),r.off(ie.R.CLIENTVAR_APPLY_ALL_DONE,e.handleAllDataReady)}}),Object(C.Y)(me.s,{onFetchError:e.handleFetchError,onError:e.props.onEditorError,getClientVarsRequestExtraParams:e.props.getClientVarsRequestExtraParams,getCanEdit:function(){return e.canEdit}}),Object(C.Y)(oe.W)].concat(l()(Object(Te.Z)({config:g,undo:{boundary:e.props.keyBindingHost}})))})},e.sendOpendocEventScrollToThrottle=Object(j.throttle)((function(e){var n=e.target;Object(M.sendOpendocEvent)(M.OPENDOC_EVENT.SCROLL_TOP,n.scrollTop)}),16,{leading:!0,trailing:!0}),e.releaseCollabAndEdit=function(n){var r,o,i;if(!e.state.isOfflineApplied){e.setState({isOfflineApplied:!0},(function(){var e=Date.now()-n;console.info("releaseCollabAndEdit, duration: ".concat(e)),Object(J.N)("backup_restore_release_edit_dev",{duration:e})})),null===(r=e.eventEmitter)||void 0===r||r.emit($.H.OfflineApplyEnd);var c=null===(o=e.blockManager)||void 0===o||null===(i=o.recordManager.collabModule)||void 0===i?void 0:i.sync;c&&c.switchCollabMode(!0)}},e.createDocxSuccessful=function(){var n;null===(n=e.commentModule)||void 0===n||n.load()},e.handleMount=function(n){var r;try{if(Object(Me.E)(),e.editor=n,e.commentModule){var o=e.props.commentable;V.S.isMobile&&!Object(M.isOnline)()&&(o=!1),e.commentModule.setCommentable(o)}var i=n.blockManager;i.getRecord(e.props.token).on(I.Ra.CHANGE,e.handleRecordChange);var c=i.recordManager,a=c.backupModule,l=c.collabModule,s=Date.now();null===a||void 0===a||a.restore({baseVersion:null===l||void 0===l?void 0:l.getSyncVersion(),beforeRestore:function(){return s=Date.now()},onApplyEnd:function(){return e.releaseCollabAndEdit(s)},afterRestore:function(){return e.releaseCollabAndEdit(s)}}),e.setMinHeight(e.props.minHeight),e.cancelSetEditorLoading=Object(te.H)((function(){e.setState({editorLoading:!1,editorError:!1})}),i.lazyRecordStatus),e.props.onEditorMount&&e.props.onEditorMount(n),G.S.setExtraData({editable:e.props.editable?"true":"false"}),ve.S.trigger($.H.PageEditable,[n]);var u,d=e.props.locate;if(i.recordManager.on(I.q.CHANGE,e.handleRecordManagerChange),Z.Z.setBlockManager(i),Z.Z.listen(),ye.Z.init(),V.S.isIOS&&V.S.isBytedanceApp?requestAnimationFrame((function(){Object(Me.k)(e.viewport,e.blockManager.layoutManager,{locate:d})})):Object(Me.k)(e.viewport,e.blockManager.layoutManager,{locate:d,isInWiki:e.props.isInWiki}),d&&ve.S.trigger($.H.LocateBlockWithRecordId,[d]),V.S.isOpendoc)null===(u=e.scroller)||void 0===u||u.addEventListener("scroll",e.sendOpendocEventScrollToThrottle)}catch(f){Object(J.N)("doc_bug_track_mobile",{action:"error_in_mount",info:JSON.stringify({message:null===f||void 0===f?void 0:f.message,err:f,stack:null===f||void 0===f?void 0:f.stack})})}null===(r=e.commentModule)||void 0===r||r.ready((function(){var n,r;e.commentModule&&(null===(n=(r=e.props).onCommentReady)||void 0===n||n.call(r,e.commentModule))}))},e.handleUnmount=function(n){var r,o,i;(Object(Me.X)(),ye.Z.destroy(),G.S.setProfileContext(j.noop),c.a.destroyAll(),n.blockManager)&&(n.blockManager.getRecord(e.props.token).off(I.Ra.CHANGE,e.handleRecordChange),n.blockManager.recordManager.off(I.q.CHANGE,e.handleRecordManagerChange));(Z.Z.unlisten(),Z.Z.resetBlockManager(),e.props.onEditorUnMount&&e.props.onEditorUnMount(n),e.editor=null,Object(de.d)(),Object(Me.m)(),null===(r=(o=e).cancelSetEditorLoading)||void 0===r||r.call(o),V.S.isOpendoc)&&(null===(i=e.scroller)||void 0===i||i.removeEventListener("scroll",e.sendOpendocEventScrollToThrottle))},e.handleOnError=function(e,n,r){Object(Ee.t)(Ae({message:e.message,source:n,from:"pageMain"},r))},e.handleFetchError=function(n){I.Z0.includes(n.code)||e.setState({editorLoading:!1,editorError:!0})},e.handleCopyAll=function(n){if(e.selectionAPI&&e.props.copyable)if(V.S.isBytedanceApp&&V.S.isAndroid)Object(ee.g)(e.selectionAPI,n);else{var r=Object(ee.q)(e.selectionAPI);n&&n(r)}},e.handleKeyboardStatusChange=function(n){e._isOpenKeyboard=n},e.locateBlockWithRecordId=function(){var n=f()(u.a.mark((function n(r,o){var i,c,a,l,s,d,h,p;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(s=y()(e),d=s.editor){n.next=3;break}return n.abrupt("return");case 3:return null===(i=e.selectionAPI)||void 0===i||i.removeAllSelection(),h=d.blockManager,n.next=7,null===(c=e.viewport)||void 0===c?void 0:c.scrollToRecord(r,function(){var e=f()(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:h.layoutManager.getViewportHelper().setScrollTop(n-90);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 7:if(p=n.sent,window.history.replaceState(null,"","".concat(location.pathname).concat(location.search)),p){n.next=11;break}return n.abrupt("return",o&&o());case 11:return n.next=13,null===(a=e.fold)||void 0===a?void 0:a.forceShowFoldedBlock(p,e.editable);case 13:null===(l=e.commentModule)||void 0===l||l.deactivateComment(fe.Fr.afterLocateToBlock),setTimeout((function(){var e=h.getBlockViewByBlockIdNotCheck(p);e&&Object(he.I)([e])}));case 15:case"end":return n.stop()}}),n)})));return function(e,r){return n.apply(this,arguments)}}(),e.handleRecordChange=function(n){var r;if(e.props.onPageMetaChange){var o=n.ops.find((function(e){return"text"===e.p[0]})),i=n.ops.find((function(e){return"full_width"===e.p[0]})),c=null===(r=e.editor)||void 0===r?void 0:r.getPageMeta();if((o||i)&&c&&e.props.onPageMetaChange(c),o&&c){M.EventEmitter.emit("".concat(S.FOLLOW_EVENT,":SUITE_TITLE_CHANGE"),{title:c.title});var a={title:c.title,token:Object(M.getToken)()};ve.S.emit(ve.p.MOBILE.COMMON.TITLE_CHANGE,a),ve.N.emit(ve.p.COMMON.TITLE_CHANGE,a)}if(e.editor&&n.ops.find((function(e){return"delete"===e.p[0]})))e.blockManager.getRecord(e.props.token).snapshot.delete&&e.setState({editorError:!0})}},e.handleRecordManagerChange=function(n){var r=n.recordOps,o=n.options;e.blockManager&&o.from===I.H.local&&Object(Q.x)(r,e.blockManager)},e.handleBeforeUnload=function(n){var r;if(e.editor&&(null===(r=e.blockManager.recordManager.collabModule)||void 0===r?void 0:r.getSubmittingStatus())){var o=t("editor.leave_page_warning_message");return n.returnValue=!0,o}return!1},e.handleOnline=function(){var n;e.props.commentable&&(null===(n=e.commentModule)||void 0===n||n.setCommentable(!0)),!e.isHistoryVisible&&ve.S.emit(ve.p.MOBILE.COMMON.REFRESH_HEADER)},e.handleOffline=function(){var n;e.props.commentable&&(null===(n=e.commentModule)||void 0===n||n.setCommentable(!1)),!e.isHistoryVisible&&ve.S.emit(ve.p.MOBILE.COMMON.REFRESH_HEADER)},e}return g()(r,[{key:"getEditableStatus",value:function(e,n,r,o){var i=this.state.isOfflineApplied;return Object(Me.Y)(e,n)&&r&&!o&&i}},{key:"getSnapshotBeforeUpdate",value:function(){return this.blockManager&&this.blockManager.dispatch(U.Y),null}},{key:"componentDidMount",value:function(){ve.S.on($.H.LocateBlockWithRecordId,this.locateBlockWithRecordId),ve.S.on($.H.CopyAll,this.handleCopyAll),ve.S.on(ve.p.MOBILE.COMMON.KEYBOARD_VISIBLE_CHANGED,this.handleKeyboardStatusChange),ve.N.on(se.r.AFTER_UNDO_REDO,this.handleAfterUndoRedo),window.addEventListener("beforeunload",this.handleBeforeUnload),window.addEventListener("online",this.handleOnline),window.addEventListener("offline",this.handleOffline),window.PageMain=this,Y.S.addListener(this.props.token,this.createDocxSuccessful),Object(Me.G)(),V.S.isMobile||Object(Oe.N)().onResize(this.onRootResize),ve.S.on(Ie.X,this.handleHistoryCloseComment),Object(Me.y)(this)}},{key:"componentDidUpdate",value:function(e){var n,r,o,i=this.props,c=i.copyable,a=i.minHeight,l=i.pageMeta,s=i.commentable,u=null===(n=this.editor)||void 0===n||null===(r=n.editor)||void 0===r?void 0:r.api;u&&(u.getService(re.a).clipboard.update({copyable:c,editable:this.canEdit}),u.config.update({copyable:c,editable:this.canEdit,editPermission:this.editable,translated:this.translated,getEditorStyle:this.getEditorStyle,isInWiki:this.props.isInWiki}));if(e.minHeight!==a&&this.setMinHeight(a),this.commentModule&&e.commentable!==s){var d=s;V.S.isMobile&&!Object(M.isOnline)()&&(d=!1),this.commentModule.setCommentable(d)}(null===(o=e.pageMeta)||void 0===o?void 0:o.fullWidth)!==(null===l||void 0===l?void 0:l.fullWidth)&&this.editor&&this.editor.handleResize()}},{key:"componentWillUnmount",value:function(){window.PageMain=null,V.S.isMobile||Object(Oe.N)().offResize(this.onRootResize),ve.S.off($.H.LocateBlockWithRecordId,this.locateBlockWithRecordId),ve.S.off($.H.CopyAll,this.handleCopyAll),ve.S.off(ve.p.MOBILE.COMMON.KEYBOARD_VISIBLE_CHANGED,this.handleKeyboardStatusChange),ve.N.off(se.r.AFTER_UNDO_REDO,this.handleAfterUndoRedo),window.removeEventListener("beforeunload",this.handleBeforeUnload),window.removeEventListener("online",this.handleOnline),window.removeEventListener("offline",this.handleOffline),Y.S.removeListener(this.props.token,this.createDocxSuccessful),this.container=null,ve.S.off(Ie.X,this.handleHistoryCloseComment),Object(Me.V)(this),ne.w.clear()}},{key:"focusTitle",value:function(){setTimeout((function(){document.querySelector(".page-block-content .text-editor").focus()}),1e3)}},{key:"getScrollerForLayoutManager",value:function(){var e,n,r,o=this.props.scroller;return fe.r||V.S.isMobile&&V.S.isLark?window:o?"string"===typeof o?null!==(e=null===(n=this.container)||void 0===n?void 0:n.closest(".".concat(o)))&&void 0!==e?e:window:null!==(r=o.current)&&void 0!==r?r:window:window}},{key:"setMinHeight",value:function(e){var n=H.s.enable_page_min_height,r=this.blockManager;if(r&&n){var o=r.rootBlockId,i=r.getBlockViewByBlockId(o);i&&i.hostElement&&i.hostElement.setAttribute("style","min-height: ".concat(e,"px"))}}},{key:"render",value:function(){var e,n=this,r=this.props,i=r.justifyPosition,c=r.iPadWidthMode,a=r.vcController,l=r.PCWidthMode,s=r.openDocxConfig,u=s.commentConfig,d=this.state,f=d.editorError,h=d.editorLoading;if(f)return A.a.createElement("div",{className:"editor-exception"},A.a.createElement("div",{className:"editor-exception__detail"},A.a.createElement("img",{src:N.a}),A.a.createElement("div",{className:"editor-exception__message"},t("request.unknown_mistake"))));var p=this.props,v=p.editable,g=p.tokenFromWiki,b=p.style,y=p.token,m=!!(null===(e=this.editorContext)||void 0===e?void 0:e.catalogue)?l===q.M.FullWidth&&void 0!==(null===b||void 0===b?void 0:b.marginLeft):l===q.M.FullWidth,_=R()("page-main",o()({"full-width":c===we.z.FULL_WIDTH||m,uneditable:!1===v,"docx-in-feed":V.S.isFeed,translated:this.translated},"page-main-in-wiki-".concat(this.lastBreakpoint),!!g&&!V.S.isMobile)),k=R()("page-main-item",{"justify-left":i===we.D.LEFT,"justify-right":i===we.D.RIGHT}),O=Object(z.E)(),x=!(this.isShowBottomTemplate||this.isTemplatePreview||O)&&!(s.globalLikeConfig&&!s.globalLikeConfig.enable),E=!(this.isShowBottomTemplate||this.isTemplatePreview)&&!(s.commentConfig&&!s.commentConfig.global.enable),S=!V.S.isMobile&&Object(M.isBidirectionalLinkListEnabled)()&&!(this.isShowBottomTemplate||this.isTemplatePreview||O),C=!(s.commentConfig&&!s.commentConfig.partial.enable),I={};return u&&u.partial&&(I.defaultShow=u.partial.open),A.a.createElement("div",{className:_,ref:this.contentRef},A.a.createElement("div",{className:"doc-position"}),A.a.createElement(K.l,{store:M.store},(function(e){return n.reactReduxContext=e,A.a.createElement(ke.M,null,(function(e){return n.globalStateService=e,A.a.createElement(Ce.u,{style:b,className:k,focusTitleOnMount:!n.props.locate&&!V.S.isInVC,createDocxEditor:n.createDocxEditor,onMount:n.handleMount,onUnmount:n.handleUnmount,hasCover:n.props.hasCover})}))})),!h&&this.editorContext&&A.a.createElement(A.a.Fragment,null,C&&A.a.createElement(Ue,Object.assign({commentModule:this.commentModule,vcController:a,selectionApi:this.selectionAPI,blockManager:this.blockManager,fold:this.fold,scroller:this.scroller},I)),A.a.createElement(Le,{renderOnTimeout:!0,business:Fe.Docx,renderWhen:Ne.Done},S&&A.a.createElement(Re.k,{noteToken:this.props.token,editorStyle:b,isCloseButtonEnabled:v}),!fe.r&&!V.S.isOpendoc&&A.a.createElement(Re.o,null),!fe.r&&!V.S.isOpendoc&&A.a.createElement(Re.G,null),x&&A.a.createElement(Re.l,{style:b,token:y}),E&&A.a.createElement(He,{noteToken:this.props.token,isCommentable:this.props.commentable,commentModule:this.commentModule,canCopy:this.props.copyable,style:b,selectionApi:this.selectionAPI,vcController:a}),A.a.createElement(Re.P,null),V.S.isPcWeb&&A.a.createElement(Ve,{blockManager:this.blockManager,commentModule:this.commentModule}),V.S.isPcWeb&&A.a.createElement(Re.S,{selectionAPI:this.selectionAPI,blockManager:this.blockManager}),!V.S.isMobile&&this.scroller&&A.a.createElement(Re.H,{blockManager:this.blockManager,eventEmitter:this.eventEmitter,fold:this.fold,commentModule:this.commentModule,editable:this.canEdit,copyable:this.props.copyable,viewport:this.viewport,rect:this.rect,scrollContainer:this.scroller,selectionAPI:this.selectionAPI}),V.S.isMobile&&!fe.r&&this.scroller&&A.a.createElement(Re.t,{blockManager:this.blockManager,eventEmitter:this.eventEmitter,fold:this.fold,commentModule:this.commentModule,editable:this.canEdit,viewport:this.viewport,rect:this.rect,scrollContainer:this.scroller,selectionAPI:this.selectionAPI}),A.a.createElement(Re.i,{selectionAPI:this.selectionAPI,blockManager:this.blockManager,translateConfig:this.props.translateConfig}),V.S.isOpendoc&&A.a.createElement(M.OpendocFooter,{className:"page-main-item",style:b}),A.a.createElement(Be.B,null),V.S.isInVC&&M.VCExec&&A.a.createElement(M.VCExec,null))),A.a.createElement(F.S,null))}},{key:"isOpenKeyboard",get:function(){return this._isOpenKeyboard}},{key:"canEdit",get:function(){var e=this.props,n=e.editable,r=void 0!==n&&n,o=e.editing,i=void 0!==o&&o;return this.getEditableStatus(r,i,this.state.isDataReady,this.enterTranslateMode)}},{key:"editable",get:function(){return this.props.editable}},{key:"translated",get:function(){return this.props.translateConfig.status.translated}},{key:"enterTranslateMode",get:function(){return this.props.translateConfig.status.had_enter_translate_mode}},{key:"isTemplatePreview",get:function(){return"template_preview"===M.urlHelper.parseQuery(window.location.href).from}},{key:"blockManager",get:function(){var e;return null===(e=this.editor)||void 0===e?void 0:e.blockManager}},{key:"eventEmitter",get:function(){var e;return null===(e=this.blockManager)||void 0===e?void 0:e.eventEmitter}},{key:"editorContext",get:function(){var e,n;return null===(e=this.editor)||void 0===e||null===(n=e.editor)||void 0===n?void 0:n.api.getService(re.a)}},{key:"commentModule",get:function(){var e;return null===(e=this.editorContext)||void 0===e?void 0:e.commentModule}},{key:"pcMessage",get:function(){var e;return null===(e=this.editorContext)||void 0===e?void 0:e.pcMessage}},{key:"selectionAPI",get:function(){var e;return null===(e=this.editorContext)||void 0===e?void 0:e.selectionAPI}},{key:"viewport",get:function(){var e;return null===(e=this.editorContext)||void 0===e?void 0:e.viewport}},{key:"fold",get:function(){var e;return null===(e=this.editorContext)||void 0===e?void 0:e.fold}},{key:"rect",get:function(){var e;return null===(e=this.editorContext)||void 0===e?void 0:e.rect}},{key:"undoModule",get:function(){var e;return null===(e=this.editorContext)||void 0===e?void 0:e.undoModule}},{key:"isShowBottomTemplate",get:function(){var e=this.props,n=e.editable,r=e.isFirstLineEmpty,o=e.isTemplateVisible,i=e.editing;return(Object(pe.r)()?i:n)&&!Object(M.getHideTemplateFromQuery)()&&r&&o&&!V.S.isInVC&&!Object(T.getIsCrossBrand)()}}]),r}(A.a.Component);Ke.defaultProps={editable:!1,editing:!1,copyable:!1}}).call(this,r("dx_E9Eu"))},dx_rXFL:function(e,n,r){"use strict";(function(t){var e=r("dx_QILm"),o=r.n(e),i=r("dx_TSYQ"),c=r.n(i),a=r("dx_cDcd"),l=r.n(a),s=r("dx_amgp"),u=r("dx_n71n"),d=r("dx_d8VX"),f=(r("dx_INf6"),"okr-combo-progress");n.S=function(e){var n=e.mode,r=e.onModeChange,i=(e.updateType,o()(e,["mode","onModeChange","updateType"]));return l.a.createElement("div",{className:c()(f,n===s.W.SIMPLE?"okr-simple-progress":"okr-advanced-progress")},function(){switch(n){case s.W.SIMPLE:return l.a.createElement(d.S,i);case s.W.ADVANCED:return l.a.createElement(u.S,i);default:return null}}(),l.a.createElement("div",{className:"".concat(f,"__switcher"),onMouseDown:function(){r(n===s.W.SIMPLE?s.W.ADVANCED:s.W.SIMPLE)}},n===s.W.SIMPLE?t("CreationDoc_Docs_OKR_ModeAdvanced"):t("CreationDoc_Docs_OKR_ModeBasic")))}}).call(this,r("dx_E9Eu"))},dx_rXO6:function(e,n,r){},dx_rdYh:function(e,n,r){"use strict";r.d(n,"L",(function(){return c})),r.d(n,"X",(function(){return a}));var o=r("dx_h6a8"),i=r("dx_YCIe");function c(e,n){return Math.abs(e-n)<=i.w}function a(e,n){var r=e[n];if(!Object(o.isUndefined)(r)){var i=Object(o.isNumber)(r)?r:r.offsetRatio;return Object(o.isUndefined)(i)?void 0:Object(o.clamp)(i,0,1)}}},dx_rhDI:function(e,n,r){"use strict";r.d(n,"Q",(function(){return h}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W7W2"),a=r.n(c),l=r("dx_a1gu"),s=r.n(l),u=r("dx_Nsbk"),d=r.n(u);function f(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var h=function(e){a()(r,e);var n=f(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).handleMouseLeave=function(){},e.handleMouseEnter=function(){},e}return r}(r("dx_cyoC").Q)},dx_rjb4:function(e,n,r){"use strict";(function(t){var e=r("dx_cDcd"),o=r.n(e),i=r("dx_amgp"),c=r("dx_L41L"),a=r("dx_n3mc");n.S=function(e){var n=e.showScore,r=e.showTooltip,l=e.weightType,s=e.canEdit,u=e.score,d=e.weight,f=void 0===d?0:d,h=e.saveScore,p=e.onScoreChange,v=e.onInputActive,g=e.onHoverScore,b=u/100||0,y=l===i.k.KR?t("CreationDoc_Docs_OKR_Score_Specs",{score:b,weight:f}):t("CreationDoc_Docs_OKR_Score_Tooltips"),m=function(e){return e.closest(".okr-block")||document.body},_=function(e){e&&g()};return o.a.createElement(o.a.Fragment,null,n?s?o.a.createElement(a.S,{style:{width:37,marginLeft:8}},o.a.createElement(c.S,{inputWidth:35,value:b,onBlur:function(e){return h(100*e)},onChange:function(e){return p(100*e)},hoverHint:y,rangeErrorHint:t("CreationDoc_Docs_OKR_Score_Score_Range"),minValue:0,maxValue:1,onPreviewVisibleChange:_,getPopupContainer:m,onActive:v})):o.a.createElement(a.S,{style:{width:37,marginLeft:8}},o.a.createElement(c.S,{inputWidth:35,value:b,editable:!1,hoverHint:y,showTooltip:r,onPreviewVisibleChange:_,getPopupContainer:m})):null)}}).call(this,r("dx_E9Eu"))},dx_rldU:function(e,n,r){"use strict";r.d(n,"k",(function(){return o})),r.d(n,"H",(function(){return c})),r.d(n,"F",(function(){return s})),r.d(n,"u",(function(){return l})),r.d(n,"z",(function(){return d})),r.d(n,"a",(function(){return u}));var o,i,c,a=r("dx_B28d");!function(e){e.REMINDER="reminder",e.USER="user",e.MENTION_DOC="mention_doc",e.LINK="link"}(o||(o={})),function(e){e.USER="user",e.DOCS="docs",e.FILE="file",e.CHAT="chat",e.TABLE="table",e.BITABLE="bitable",e.SHEET="sheet",e.VOTE="vote",e.JIRA="jira",e.IFRAME="iframe"}(i||(i={})),function(e){e.SELECT_WHOLE="select_whole",e.SELECT_PART="select_part",e.HOVER_WHOLE="hover_whole",e.HOVER_RIGHT="hover_right"}(c||(c={}));var l,s={comment:"ccm_comment_view",link:"ccm_doc_link_edit_page_view"};!function(e){e.TEXT="text",e.BLOCK="block"}(l||(l={}));var u,d=[a.B.BLANK,a.B.PENDING];!function(e){e.Title="title",e.Text="text",e.PartComment="part_comment",e.FullComment="full_comment",e.PagePraise="page_praise"}(u||(u={}))},dx_rrS6:function(e,n,r){"use strict";r.d(n,"S",(function(){return u}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_UtDZ"),s=r("dx_GPzN"),u=function(){function e(n){i()(this,e),this.handler=n,this.isDataReady=!1,this.isDataReadyForStage=!1,this.isRenderSuccess=!1,this.isRenderSuccessForStage=!1}return a()(e,[{key:"dataReady",value:function(e){this.isDataReady||(this.isDataReady=!0,s.S.updateStage(e))}},{key:"dataReadyForStage",value:function(e){this.isDataReadyForStage||(this.isDataReadyForStage=!0,s.S.updateLoadMainStageDurationList(l.FILE_TYPE.DOCX,e))}},{key:"didUpdate",value:function(e){!this.isRenderSuccess&&this.isDataReady&&(this.isRenderSuccess=!0,s.S.updateStageByNextRender(e),this.handler&&this.handler.onFirstRenderAfterDataReady&&this.handler.onFirstRenderAfterDataReady())}},{key:"didUpdateForStage",value:function(e){!this.isRenderSuccessForStage&&this.isDataReadyForStage&&(this.isRenderSuccessForStage=!0,s.S.updateLoadMainStageDurationListByNextRender(l.FILE_TYPE.DOCX,e))}},{key:"switchDocToken",value:function(){this.isDataReady=!1,this.isRenderSuccess=!1}}]),e}()},dx_rriR:function(e,n,r){"use strict";(function(t){r.d(n,"Q",(function(){return _}));var e,o=r("dx_lSNA"),i=r.n(o),c=r("dx_PcQO"),a=r("dx_TSYQ"),l=r.n(a),s=r("dx_cDcd"),u=r.n(s),d=r("dx_aFyr"),f=r("dx_S0SF"),h=r("dx_yzqx"),p=r("dx_UTG8"),v=(r("dx_Y8YI"),r("dx_ZeFe")),g=r("dx_u2Th"),b=r("dx_lUPZ"),y=r("dx_s4k9"),m=(e={},i()(e,v.v.single,t("common.single_option")),i()(e,v.v.multiple,t("block.poll_type_multiple")),e),_=u.a.memo(u.a.forwardRef((function(e,n){var r=e.value,o=e.defaultTitle,i=e.pollType,a=e.isAnonymous,s=e.editable,v=e.unPublishVisible,_=e.onChange,k=e.onEditClick,O=e.canEdit,x=e.recordId,E=e.isHistory,S=void 0!==E&&E;return u.a.createElement("div",{className:l()("poll-block-header__container",{"is-windows":h.S.isWindows})},u.a.createElement("div",{className:"poll-block-header__title--wrapper"},u.a.createElement("div",{className:"poll-block-header__icon-wrapper",style:{maxHeight:s?40:22}},u.a.createElement("span",{style:{display:"inline-flex"}},u.a.createElement(d.S,{width:18,height:18}))),u.a.createElement("div",{className:"poll-block-header__title"},u.a.createElement(g.e,{ref:n,className:l()("poll-block-input__title"),recordId:x,editable:!S&&s,value:S?void 0:r,onChange:_,maxLength:[y.g,t("block.poll_title_exceeded",{},"","".concat(y.g))],size:"large",placeholder:"".concat(t("block.poll_title_placeholder"),"..."),focusedStyle:{borderColor:"var(--I500)"}}),!S&&!s&&void 0!==o&&!p.InputPipe.serialize(r).alltext&&u.a.createElement("div",{className:"header-placeholder"},o)),O&&!s&&u.a.createElement("div",{className:"poll-block-header__edit"},u.a.createElement(b.W,{onClick:k,style:{display:"inline-flex"},icon:u.a.createElement(f.S,{width:18,height:18})}))),!S&&u.a.createElement("div",{className:"poll-block-header__labels"},v?u.a.createElement(c.Tag,{size:"extra-small",className:"poll-block-header__label"},t("CreationDoc_Docs_Poll_Unpublished_Title")):u.a.createElement(u.a.Fragment,null,u.a.createElement(c.Tag,{size:"extra-small",className:"poll-block-header__label"},m[i]),void 0!==a&&u.a.createElement(c.Tag,{size:"extra-small",className:"poll-block-header__label"},t(a?"CreationDoc_Docs_Poll_Anon_Tag":"CreationDoc_Docs_Poll_Open_Tag")))))})))}).call(this,r("dx_E9Eu"))},dx_s04s:function(e,n,r){"use strict";r.d(n,"N",(function(){return s})),r.d(n,"x",(function(){return u})),r.d(n,"B",(function(){return d})),r.d(n,"h",(function(){return f})),r.d(n,"S",(function(){return h}));var o=r("dx_RIqP"),i=r.n(o),c=r("dx_h6a8"),a=r("dx_B28d"),l=r("dx_P58d");function s(e){return[a.B.GRID,a.B.GRID_COLUMN,a.B.ASSOC_ROOT,a.B.ASSOC_NODE,a.B.SELECTION,a.B.VIEW,a.B.OBJECTIVE,a.B.KEY_RESULT,a.B.PROGRESS].includes(e)}function u(e,n,r){for(var o,i=e,c=n.getBlockModelByBlockId(i);c&&(o=c.type,[a.B.ASSOC_ROOT,a.B.ASSOC_NODE,a.B.SELECTION].includes(o));){var l=n.getBlockModelByBlockId(i);if(r){if(!l.next)return null;i=(c=n.getBlockModelByBlockId(l.next.id)).id}else{var s;if(!l.previous)return null;i=(c=n.getBlockModelByBlockId(null===(s=l.previous)||void 0===s?void 0:s.id)).id}}return i||e}function d(e,n){var r=n.getBlockModelByBlockId(e),o=r.type;return o===a.B.GRID||o===a.B.GRID_COLUMN||o===a.B.ASSOC_ROOT?r.children.reduce((function(e,r){return e.push.apply(e,i()(d(r.id,n))),e}),[]):o===a.B.VIEW?n.getBlockModelByBlockId(e).children.map((function(e){return e.id})):[e]}function f(e,n){return Object(c.flatten)(e.map((function(e){return d(e,n)}))).map((function(e){return{id:e,type:l.j.BLOCK}}))}function h(e,n){var r=n.getBlockModelByBlockId(e).parent;if(!r)return null;var o=n.getBlockModelByBlockId(r.id);if(o.type===a.B.GRID_COLUMN){if(!o.parent)throw new Error("parent block must have a parent");return o.parent.id}return o.type===a.B.VIEW?o.id:null}},dx_s1qv:function(e,n,r){"use strict";var o=r("dx_FHaN");r.d(n,"AT_USER_EMBED_CONTAINER",(function(){return o.Y})),r.d(n,"EmbedObjPermissionCode",(function(){return o.J})),r.d(n,"INLINE_COMPONENT_MARK",(function(){return o.O})),r.d(n,"INLINE_COMPONENT_TYPE",(function(){return o.k}));var i=r("dx_HTwv");r.d(n,"generateInlineComponent",(function(){return i.o})),r.d(n,"generateInlineComponnetNodes",(function(){return i.N})),r.d(n,"parseInlineComponentDataByNode",(function(){return i.p}));r("dx_j0jk")},dx_s4k9:function(e,n,r){"use strict";r.d(n,"g",(function(){return o}));var o=100},dx_s4sk:function(e,n,r){"use strict";r.d(n,"y",(function(){return C}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_cDcd"),b=r.n(g),y=r("dx_VmZB"),m=r("dx_PQBD"),_=r("dx_VXD2"),k=r("dx_B28d"),O=r("dx_USRY"),x=r("dx_Vau3"),E=r("dx_ey54");function S(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var C=function(e){d()(r,e);var n=S(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"getWrapper",value:function(e){var n=this;return function(r){var o=Object(g.useState)(0),c=i()(o,2),a=c[0],l=c[1],s=n.blockManager,u=r.record.snapshot,d=r.isSelected,f=Object(k.DK)(u.type);if(Object(g.useEffect)((function(){if(f){var e=function(){l(Object(_.N)())};return e(),s.addListener(E.G,e),function(){return s.removeListener(E.G,e)}}}),[r.blockId,s,f]),!Object(m.Y)(u)||r.displaymode===O.t.Inline)return b.a.createElement(e,r);r.onBlockReady&&r.onBlockReady();var h={};f&&(a&&(h.maxWidth=a),h.position="relative");return b.a.createElement("div",{className:"docx-resource-block-container",style:h},b.a.createElement(y.S,{isSelected:d,blockType:u.type}),b.a.createElement("div",{style:{display:"none"}},b.a.createElement(e,r)))}}}]),r}(x.A)},dx_s9Aa:function(e,n,r){"use strict";r.d(n,"L",(function(){return g})),r.d(n,"i",(function(){return y})),r.d(n,"r",(function(){return _})),r.d(n,"g",(function(){return x})),r.d(n,"Z",(function(){return S}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_I7IE"),s=r("dx_NOtv"),u=r.n(s),d=r("dx_UtDZ"),f=r("dx_zUqt"),h=r("dx_AIJo"),p=u()("abbreviation:request"),v=new l.S;function g(){return b.apply(this,arguments)}function b(){return(b=a()(i.a.mark((function e(){var n,r,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.querySettings();case 3:if(n=e.sent,p("reqAbbreviationConfig res=".concat(JSON.stringify(n))),n&&0===n.code&&n.data){e.next=7;break}return e.abrupt("return",[0,0]);case 7:return r=n.data,o=r.app_installed,c=r.doc.is_enabled,e.abrupt("return",[Number(o),Number(c)]);case 11:return e.prev=11,e.t0=e.catch(0),p("reqAbbreviationConfig error",e.t0),e.abrupt("return",[0,0]);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function y(){return m.apply(this,arguments)}function m(){return(m=a()(i.a.mark((function e(){var n,r,o,c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=Object(f.k)(),e.next=4,v.queryIgnoreList({typeId:n,typeCode:h.m.Doc});case 4:if(r=e.sent,o=r.code,c=r.data,a=r.msg,p("reqIgnoreAbbreviationList code=".concat(o," msg=").concat(a," data=").concat(JSON.stringify(c))),0!==o||!c){e.next=11;break}return e.abrupt("return",c.words||[]);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),p("reqIgnoreAbbreviationList ERROR",e.t0);case 16:return e.abrupt("return",[]);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})))).apply(this,arguments)}function _(e){return k.apply(this,arguments)}function k(){return(k=a()(i.a.mark((function e(n){var r,o,c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=Object(f.k)(),e.next=4,v.setIgnoreWord({word:n,typeId:r,typeCode:h.m.Doc});case 4:o=e.sent,c=o.code,a=o.msg,p("reqAddIgnoreAbbreviation code=".concat(c," msg=").concat(a)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),p("reqAddIgnoreAbbreviation ERROR",e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function O(e){var n=JSON.parse(JSON.stringify(e));return n.forEach((function(e){delete e.id,delete e.version})),n}function x(e){return E.apply(this,arguments)}function E(){return(E=a()(i.a.mark((function e(n){var r,o,c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.blocks,o=n.sequenceId,c=n.useCache,e.prev=1,e.next=4,v.docHighlight({blocks:c?r:O(r),doc_id:Object(f.k)(),doc_type:"docx"});case 4:if(!(a=e.sent)||0!==a.code||!a.data){e.next=7;break}return e.abrupt("return",{sequenceId:o,blocks:r,data:a.data});case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),p("reqDocxHighlight ERROR: ".concat(JSON.stringify(e.t0)));case 12:return e.abrupt("return",{sequenceId:o,blocks:[],data:{phrases:[]}});case 13:case"end":return e.stop()}}),e,null,[[1,9]])})))).apply(this,arguments)}function S(e,n){return Object(d.request)({method:"get",url:"/api/meta/",params:{token:e,type:n}})}v.init()},dx_s9st:function(e,n,r){"use strict";var o=r("dx_Y6Yc");r.d(n,"j",(function(){return o.j}))},dx_sBQB:function(e,n,r){"use strict";r.d(n,"J",(function(){return s}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=null;function s(){return u.apply(this,arguments)}function u(){return(u=a()(i.a.mark((function e(){var n,o,c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=null===(n=window)||void 0===n||null===(o=n.User)||void 0===o?void 0:o.id){e.next=3;break}throw new Error("no user id when init store");case 3:if(!l){e.next=5;break}return e.abrupt("return",l);case 5:return e.prev=5,e.next=8,Promise.all([r.e("dx_ikF"),r.e("dx_gP1")]).then(r.bind(null,"dx_OgHW"));case 8:return a=e.sent,l=new a.Storage(c),e.abrupt("return",l);case 13:throw e.prev=13,e.t0=e.catch(5),e.t0;case 16:case"end":return e.stop()}}),e,null,[[5,13]])})))).apply(this,arguments)}},dx_sDWs:function(e,n,r){"use strict";r.d(n,"i",(function(){return M}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_N9dL"),g=r("dx_B28d"),b=r("dx_n4v0"),y=r("dx_L0LN"),m=r("dx_iWIM"),_=r.n(m);function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var O=function(e){s()(r,e);var n=k(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"find",value:function(e){var n;return(null===(n=this.view)||void 0===n?void 0:n.state.isShowTitle)?_()(h()(r.prototype),"find",this).call(this,e):(this.findKeyword=e,this.findChildrenKeyword(e))}},{key:"view",get:function(){return this.editorAPI.viewService.getBlockViewByBlockId(this.id)}}]),r}(r("dx_KHvq").H);O.type=g.B.PAGE;var x,E,S,C=r("dx_xjz2"),I=r("dx_tt0H"),B=r("dx_JXmB"),T=Object(C.s)(I.U)(x=function e(){i()(this,e),this.blockType=g.B.PAGE,this.checkFunc=B.M})||x,w=r("dx_L9Lc");function R(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var M=(E=Object(p.H)({providers:[T,{provide:v.RecordSnapshotCreator,useValue:{type:g.B.PAGE,create:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.B.PAGE;return Object(b.D)(e,n)}}}]}),E(S=function(e){s()(r,e);var n=R(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"blocks",get:function(){return[[O,{viewCreator:w.S,options:this.options.getTextEditorOptions()}]]}}]),r}(y.h))||S)},dx_sGRh:function(e,n,r){"use strict";r.d(n,"R",(function(){return S}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_M30o"),b=r("dx_e4eN"),y=r("dx_B28d"),m=r("dx_KHvq"),_=r("dx_IdzY"),k=r("dx_bPy9"),O=r("dx_Vd2b"),x=r("dx_z0z2");function E(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var S=function(e){d()(r,e);var n=E(r);function r(e){var o;return a()(this,r),(o=n.call(this,e)).enableTranslate=!1,o}return s()(r,[{key:"language",get:function(){return this.record.snapshot.language||x.E}}]),s()(r,[{key:"getUpdateContext",value:function(){var e,n=Object(k.w)(this.snapshot.text).get(_.x),r=Object(O.r)(new g.q(i()({},this.zoneId,this.zoneState.getContent(!0))),(function(e,n){var r;return e.includes(_.I)&&(null===(r=n[e])||void 0===r?void 0:r.includes(x.w))})).get(this.zoneId),o=this.contentState,c=this.editorAPI.viewService.getBlockViewByBlockId(this.id),a=null===c||void 0===c||null===(e=c.model.getSelection())||void 0===e?void 0:e.toPosition().start,l=new b.m({zoneId:this.zoneId}).concat(Object(g.n)(r,n,a)),s=o.apply.bind(this.contentState);return{shouldUpdate:!Object(g.m)(l),applyFunction:s,applyData:l}}}]),r}(m.H);S.type=y.B.CODE},dx_sNGG:function(e,n,r){"use strict";(function(t){r.d(n,"x",(function(){return e})),r.d(n,"H",(function(){return o})),r.d(n,"X",(function(){return i})),r.d(n,"i",(function(){return c})),r.d(n,"Y",(function(){return a})),r.d(n,"n",(function(){return l})),r.d(n,"e",(function(){return s}));var e={findTab:t("CreationDoc_DocX_FindReplace_Find_tab"),replaceTab:t("CreationDoc_DocX_FindReplace_Replace_tab"),replaceAllBtn:t("CreationDoc_DocX_FindReplace_All_btn"),prevBtn:t("CreationDoc_DocX_FindReplace_Previous_btn"),nextBtn:t("CreationDoc_DocX_FindReplace_Next_btn"),findBtn:t("CreationDoc_DocX_FindReplace_Find_btn"),replaceBtn:t("CreationDoc_DocX_FindReplace_Replace_btn"),findLabel:t("CreationDoc_DocX_FindReplace_Find_tab"),replaceLabel:t("CreationDoc_DocX_FindReplace_Replace_field"),replaceAll:t("CreationDoc_DocX_FindReplace_Range"),findInputPlaceholder:t("CreationDoc_DocX_FindReplace_Range"),replaceInputPlaceholder:t("CreationDoc_DocX_FindReplace_placeholder"),findAndReplace:t("CreationDoc_DocX_FindReplace_title"),noPermissionTips:function(e){return t(e%2===0?"CreationDoc_DocX_FindReplace_NoPermission_tip_plural":"CreationDoc_DocX_FindReplace_NoPermission_tip_singular",{},"",e.toString())},helpCenter:t("CreationDoc_DocX_HC_tooltips")},o={next:"Enter",prev:"Shift + Enter"},i="invisible-button-group-wrapper",c=423,a={OPEN_PANEL:"openPanel",RANGE_CHANGE:"rangeChange",HIGHLIGHT_UPDATE:"highlight_update",THIRD_PARTY_CONTENT_CHANGE:"third_party_content_change",COMMENT_MATCH_CHANGE:"comment_match_change",GLOBAL_COMMENT_MATCH_CHANGE:"global_comment_match_change",COMMENT_HIGHLIGHT_CHANGE:"comment_highlight_change",GLOBAL_COMMENT_HIGHLIGHT_CHANGE:"global_comment_highlight_change",EXIT_FIND_SEARCH:"exit_find_search"},l=360,s=64}).call(this,r("dx_E9Eu"))},dx_sYmP:function(e,n,r){"use strict";r.d(n,"n",(function(){return f})),r.d(n,"s",(function(){return v}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_MoY1"),s=r("dx_f4Wj"),u=r("dx_B28d"),d=[u.B.CALLOUT,u.B.CODE];function f(e,n){return h.apply(this,arguments)}function h(){return(h=a()(i.a.mark((function e(n,r){var o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.rootRecordId,e.next=3,Object(s.W)(n,o);case 3:return c=e.sent.data,e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,n){var r,o,i,c;if(null===(r=e.parent)||void 0===r?void 0:r.id)if(o=n.getBlockModelByBlockId(e.parent.id),d.includes(o.type)&&(null===(c=o.parent)||void 0===c?void 0:c.id)){var a=o;o=n.getBlockModelByBlockId(o.parent.id),i=a.position+1}else i=e.position+1;else o=e,i=0;return{insertBlock:o,insertPosition:i}}function v(e){return g.apply(this,arguments)}function g(){return(g=a()(i.a.mark((function e(n){var r,o,c,a,s,d,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.chatId,o=n.chatToken,c=n.block,a=n.blockManager,s=p(c.model,a),d=s.insertBlock,f=s.insertPosition,e.next=4,a.applyTransaction("mention chat",(function(e){Object(l.l)(e,d.recordId,f,[{type:u.B.CHAT_CARD,chat_id:r,chat_token:o,children:[]}])}));case 4:return e.abrupt("return",d.children[f].id);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},dx_sb6Q:function(e,n,r){"use strict";r.d(n,"S",(function(){return y}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_Vvd7"),d=r("dx_B28d"),f=r("dx_ozfA"),h=r("dx_BaTw");function p(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return v(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return v(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function v(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function g(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function b(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?g(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var y=function(){function e(n,r,o){a()(this,e),this.blockManager=n,this.scrollContainer=r,this.fold=o}return s()(e,[{key:"dealWithBlockSelectionIndent",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!n||!e||!this.blockManager.hasBlockViewByBlockId(e))return n;var o=this.blockManager.getBlockViewByBlockId(e),i=n,c=[d.B.HEADING1,d.B.HEADING2,d.B.HEADING3,d.B.HEADING4,d.B.HEADING5,d.B.HEADING6,d.B.HEADING7,d.B.HEADING8,d.B.HEADING9,d.B.BULLET,d.B.ORDERED,d.B.TODO,d.B.TEXT,d.B.DIVIDER];return c.includes(o.type)&&(i=b(b({},n),{},{x:n.x+r,left:n.left+r,width:n.width-2*r,right:n.right+r})),i}},{key:"getClosestBlock",value:function(e,n,r){var o=this.blockManager.getBlockViewByBlockIdNotCheck(e);if(!o)return u.V;if(o.type===d.B.TABLE)return e;if(Object(f.Q)(o)&&o.props.record.snapshot.folded)return e;var i=this.blockManager.getBlockModelByBlockId(e),c=i;if(i&&i.children.length>0){var a,l=p(i.children);try{for(l.s();!(a=l.n()).done;){var s=a.value;if(this.blockManager.layoutManager.isBlockActive(s.id)){var v=Object(h.w)(this.blockManager,s.id,this.scrollContainer);if(!(v=this.dealWithBlockSelectionIndent(s.id,v,4)))break;var g=v,b=g.top,y=g.bottom,m=g.left,_=g.right;if(b>r||m>n)break;if(!(y<r||_<n)){c=s;break}c=s}}}catch(k){l.e(k)}finally{l.f()}}return c.id===e?c.id:this.getClosestBlock(c.id,n,r)}},{key:"findClosestY",value:function(e,n){var r=this.blockManager.getBlockViewByBlockId(e);if(Object(f.Q)(r)&&this.fold.isFolded(e))return e;var o=this.blockManager.getBlockModelByBlockId(e),i=o,c=!1;if(o&&o.children.length>0){var a,l=p(o.children);try{for(l.s();!(a=l.n()).done;){var s=a.value,d=Object(h.w)(this.blockManager,s.id,this.scrollContainer);if(!d)break;var v=d.top,g=d.bottom;if(v>n){c=!0;break}if(!(g<n)){c=!1,i=s;break}c=!0,i=s}}catch(y){l.e(y)}finally{l.f()}}var b=c&&i.children.length<=0;return i.id===e?i.id:b?u.V:this.findClosestY(i.id,n)}},{key:"findClosestX",value:function(e,n,r){var o=this.blockManager.getBlockViewByBlockId(e);if(Object(f.Q)(o)&&o.props.record.snapshot.folded)return e;var i=this.blockManager.getBlockModelByBlockId(e),c=i;if(i&&i.children.length>0){var a,l=p(i.children);try{for(l.s();!(a=l.n()).done;){var s=a.value,u=Object(h.w)(this.blockManager,s.id,this.scrollContainer);if(!u)break;var d=u.left,v=u.right;if(d>n)break;if(!(v<n)){c=s;break}c=s}}catch(y){l.e(y)}finally{l.f()}}var g=c.id===e||r&&r===c.record.snapshot.type?c.id:this.findClosestX(c.id,n);if(r)return g;var b=this.blockManager.getBlockModelByBlockId(g);return b.nextSibling?b.nextSibling.id:g}}]),e}()},dx_sdxW:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("circle",{opacity:.4,cx:30,cy:30,r:30,fill:"#000"});n.S=function(e){return i.a.createElement("svg",c({width:60,height:60,viewBox:"0 0 60 60",fill:"none"},e),a)}},dx_shqt:function(e,n,r){"use strict";r.d(n,"a",(function(){return F}));var o,i,c,a,l,s,u,d,f,h,p,v,g=r("dx_yG8O"),b=r.n(g),y=r("dx_lwsE"),m=r.n(y),_=r("dx_W8MJ"),k=r.n(_),O=r("dx_Uyc2"),x=r.n(O),E=(r("dx_A1AB"),r("dx_Vvd7")),S=r("dx_QxNg"),C=r("dx_xjz2"),I=r("dx_eSV8"),B=r("dx_B28d"),T=r("dx_hSCS"),w=r("dx_LSUT"),R=r("dx_EqZO"),M=r("dx_T3tg"),j=r("dx_MMMl"),D=r("dx_tt0H"),A=r("dx_H2H4"),P=r("dx_acOG"),L=r("dx_j6ji"),N=r("dx_JXmB"),F=(o=Object(C.s)(P.N),i=Object(C.a)(),c=Object(C.e)(),o((v=function(){function e(){var n=this;m()(this,e),this.dataApplyFinished=!1,b()(this,"modelService",s,this),b()(this,"layoutManager",u,this),b()(this,"lazyConsumer",d,this),b()(this,"recordManager",f,this),this.isLocalChange=!1,this.reported=!1,b()(this,"checkers",h,this),b()(this,"eventEmitter",p,this),this.handleApplyAllDone=function(){n.dataApplyFinished=!0},this.shouldSkipIntercept=function(){return n.dataApplyFinished||!n.lazyConsumer.isPreEditableEnable()},this.keyEventsInterceptor=new A.j(this),this.handleBeforeChange=function(e){e.options.from===S.H.local&&(n.isLocalChange=!0)},this.handleAfterChange=function(){n.isLocalChange=!1,n.reported=!1},this.handleBeforeOpApply=function(e){var r=e.recordOp;if(n.lazyConsumer.isPreEditableEnable()&&!n.dataApplyFinished&&n.isLocalChange&&!n.reported)try{var o,i;r.ops.some((function(e){var c=(Object(S.bG)(e)||Object(S.y)(e)||Object(S.P)(e))&&e.p[0],a=Object(S.ZH)(e)&&"children"===e.p[0]&&"number"===typeof e.p[1]&&"string"===typeof e.action.ld;if(c)i="UPDATE_ATTRIBUTE";else{if(!a)return!1;i="DELETE_CHILD"}if(r.record.snapshot.type===B.B.PENDING)return o=r.record,!0;if(e.subType||"text"===e.p[0])return!1;if(c&&n.modelService.getBlockModelsByRecordId(r.record.id)[0]){var l,s=n.modelService.getBlockModelsByRecordId(r.record.id)[0],u=!n.canBlockEdit(s.record,s.type,{type:"UPDATE_ATTRIBUTE",changedKey:e.p[0].toString()||"",newValue:(null===e||void 0===e||null===(l=e.action)||void 0===l?void 0:l.oi)||""});return u&&(o=r.record),u}if(a){var d=!n.canBlockEdit(r.record,r.record.snapshot.type,{type:"DELETE_CHILD",index:e.p[1]});return d&&(o=r.record),d}return!1}))&&o&&i&&!n.reported&&(Object(L.O)({interceptedRecord:o,edit_type:i,stack:(new Error).stack||""}),n.reported=!0)}catch(c){console.error(null===c||void 0===c?void 0:c.message),Object(I.n)(new Error("encounter error when try to log uncatched user change"))}}}return k()(e,[{key:"init",value:function(){this.eventEmitter.on(R.R.CLIENTVAR_APPLY_ALL_DONE,this.handleApplyAllDone),this.recordManager.on(S.q.BEFORE_OPERATION_APPLY,this.handleBeforeOpApply),this.recordManager.on(S.q.BEFORE_CHANGE,this.handleBeforeChange),this.recordManager.on(S.q.CHANGE,this.handleAfterChange)}},{key:"canBlockEdit",value:function(e,n,r){if(this.shouldSkipIntercept())return!0;if(Object(N.n)(e))return!1;if("INSERT_CHILD"===r.type)return!0;var o=this.modelService.getBlockModelsByRecordId(e.id)[0];if("UPDATE_ATTRIBUTE"===r.type&&o&&Object(N.G)(o))return!1;if("DELETE_CHILD"===r.type){if(!o)return!1;var i=o.children[r.index];if(!i||Object(N.G)(i))return!1}var c=this.checkers.get().find((function(e){return e.blockType===n}));return!c||c.checkFunc({record:e,action:r,modelService:this.modelService,layoutManager:this.layoutManager})}},{key:"destroy",value:function(){this.eventEmitter.off(R.R.CLIENTVAR_APPLY_ALL_DONE,this.handleApplyAllDone),this.recordManager.off(S.q.BEFORE_OPERATION_APPLY,this.handleBeforeOpApply),this.recordManager.off(S.q.BEFORE_CHANGE,this.handleBeforeChange),this.recordManager.off(S.q.CHANGE,this.handleAfterChange)}}]),e}(),l=v,s=x()(l.prototype,"modelService",[E.VA],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),u=x()(l.prototype,"layoutManager",[j.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),d=x()(l.prototype,"lazyConsumer",[M.e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),f=x()(l.prototype,"recordManager",[w.A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=x()(l.prototype,"checkers",[i,c,D.U],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),p=x()(l.prototype,"eventEmitter",[T.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=l))||a)},dx_sy4h:function(e,n,r){},dx_szkV:function(e,n,r){},dx_t1W5:function(e,n,r){"use strict";r.d(n,"l",(function(){return O})),r.d(n,"F",(function(){return E})),r.d(n,"G",(function(){return I})),r.d(n,"Fs",(function(){return B}));r("dx_QU2i");var o=r("dx_d1El"),i=r.n(o),c=r("dx_Y0Yg"),a=r("dx_M21Q"),l=r("dx_kefW"),s=r("dx_PcQO"),u=r("dx_TSYQ"),d=r.n(u),f=r("dx_cDcd"),h=r.n(f),p=r("dx_yzqx"),v=r("dx_CqjN"),g=r("dx_viBb"),b=r("dx_J4zp"),y=r.n(b),m=r("dx_h6a8"),_=r("dx_mak7");var k=r("dx_JUlI"),O=function(){return h.a.createElement(s.Loading,{size:"small",style:{marginLeft:4}})},x=function(e){var n=e.item,r=n.icon,o=n.text,i=n.desc,c=n.suffix,a=n.textTag,l=e.showIconColor,s=e.extraContent;return h.a.createElement("div",{className:"menu-item-content"},r&&h.a.createElement("div",{className:d()("menu-icon",{"show-icon-color":l})},r),h.a.createElement("div",{className:"menu-item-main-box-wrapper"},h.a.createElement("div",{className:"menu-item-main-box"},o&&h.a.createElement("div",{className:"menu-text"},o,a&&h.a.createElement("span",{className:"menu-tag"},a)),c&&h.a.createElement("div",{className:"menu-suffix"},c),s),i&&h.a.createElement("div",{className:"menu-item-desc"},i)))},E=function(e){var n=e.hovered,r=e.actived,o=e.disabled,i=e.setItemRef,c=e.useItemClass,a=void 0===c||c,l=e.className,s=e.title,u=e.name,g=e.onMouseEnter,b=e.onMouseLeave,y=e.onMouseMove,m=e.onClick,_=e.onTouchToClick,k=e.children,O=Object(f.useCallback)((function(e){p.S.isIPad?(e.persist(),setTimeout((function(){return null===_||void 0===_?void 0:_(e)}))):null===_||void 0===_||_(e)}),[_]),x=Object(f.useCallback)(Object(v.i)({onClick:function(e){return O(e)}}),[O]),E=Object(f.useCallback)((function(e){e.preventDefault()}),[]);return h.a.createElement("div",{ref:i,className:d()(l,{"panel-menu-item":a,"menu-item-hovered":n,"menu-item-actived":r,"menu-item-disabled":o}),"data-name":u,onTouchStart:x,onTouchMove:x,onTouchEnd:x,onClick:m,onMouseEnter:g,onMouseLeave:b,onMouseMove:y,onMouseDown:E,title:s},k)},S=function(e){var n=e.vertical;return Object(f.useMemo)((function(){return h.a.createElement("div",{className:"item-arrow"},n?h.a.createElement(c.S,{className:"arrow-down"}):h.a.createElement(a.S,null))}),[n])},C=function(){return Object(f.useMemo)((function(){return h.a.createElement("div",{className:"item-checked"},h.a.createElement(l.S,null))}),[])},I=Object(f.forwardRef)((function(e,n){var r=e.item,o=e.placement,c=e.vertical,a=e.children,l=function(e,n){var r=n.placement,o=n.vertical,i=Object(f.useState)(Object(m.uniqueId)()),c=y()(i,1)[0],a=Object(f.useMemo)((function(){return(!e.disabled||e.forceShowTip)&&!!e.tip}),[e.disabled,e.tip]),l=Object(f.useState)(!1),s=y()(l,2),u=s[0],d=s[1],h=Object(f.useState)(!1),p=y()(h,2),v=p[0],g=p[1],b=Object(f.useMemo)((function(){var n;return null!==(n=null!==r&&void 0!==r?r:e.tipPlacement)&&void 0!==n?n:o?"top":"right"}),[r,e.tipPlacement,o]),k=Object(f.useMemo)((function(){return{targetOffset:["top","bottom"].includes(b)?[0,4]:[-4,0]}}),[o]),O=Object(f.useMemo)((function(){return v?.1:0}),[v]),x=Object(f.useCallback)((function(){a&&_.S.enterItemHasTooltip(c,(function(n){var r;d(!0),g(n),null===(r=e.onTooltipShow)||void 0===r||r.call(e)}),(function(e){d(!1),g(e)}))}),[a,c,e.onTooltipShow]),E=Object(f.useCallback)((function(){_.S.isTooltipShowCurrentKey(c)&&_.S.leaveItemHasTooltip()}),[c]);return Object(f.useEffect)((function(){return function(){return E()}}),[E]),{hasTooltip:a,visible:u,align:k,placement:b,transitionTime:O,showTooltip:x,hideTooltip:E}}(r,{placement:o,vertical:c}),s=l.hasTooltip,u=l.visible,d=l.placement,p=l.align,v=l.transitionTime,g=l.showTooltip,b=l.hideTooltip;return Object(f.useImperativeHandle)(n,(function(){return{showTooltip:g,hideTooltip:b}}),[g,b]),s?h.a.createElement(i.a,{visible:u,title:r.tip,placement:d,align:p,mouseEnterDelay:v,mouseLeaveDelay:v,trigger:"hover",overlayClassName:"toolbar-button-tooltip"},a):a})),B=function(e){var n=e.hovered,r=e.showIconColor,o=e.item,i=e.showArrow,c=e.className,a=e.vertical,l=void 0!==a&&a,s=e.useItemClass,u=e.onItemClick,p=e.setItemRef,v=e.onMouseEnter,b=e.onMouseLeave,y=e.onItemEnter,m=e.onItemLeave,_=e.children,O=e.mouseModeRef,B=Object(f.useMemo)((function(){return!l&&o.active}),[l,o.active]),T=Object(f.useMemo)((function(){return!Object(k.k)(o)}),[o]),w=Object(f.useRef)(null),R=Object(f.useRef)(null),M=Object(f.useCallback)((function(e){if(l){var n,r,o=e.target.closest(".".concat(g.T));return o?!(null===(r=w.current)||void 0===r?void 0:r.contains(o)):null===(n=w.current)||void 0===n?void 0:n.contains(e.target)}return!0}),[l]),j=Object(f.useCallback)((function(e){w.current=e,null===p||void 0===p||p(e)}),[p]),D=Object(f.useCallback)((function(e){var n;null===(n=o.onUnMount)||void 0===n||n.call(o),!o.disabled&&M(e)&&Object(k.k)(o)&&(null===u||void 0===u||u(o,e))}),[o,M,u,o.onUnMount]),A=Object(f.useCallback)((function(e){!o.disabled&&M(e)&&(D(e),null===y||void 0===y||y())}),[o.disabled,D,y,M]),P=Object(f.useCallback)((function(){var e;null===(e=R.current)||void 0===e||e.showTooltip(),null===y||void 0===y||y()}),[y]),L=Object(f.useCallback)((function(){var e;null===(e=R.current)||void 0===e||e.hideTooltip(),null===m||void 0===m||m()}),[m]),N=Object(f.useCallback)((function(e){var n;O.current&&(null===v||void 0===v||v(e),null===(n=o.onMouseEnter)||void 0===n||n.call(o,e),P())}),[O,v,o.onMouseEnter,P]),F=Object(f.useCallback)((function(e){var n;null===b||void 0===b||b(e),null===(n=o.onMouseLeave)||void 0===n||n.call(o,e),L()}),[b,o.onMouseLeave,L]);Object(f.useEffect)((function(){return o.onUnMount}),[o.onUnMount]);var U=Object(f.useMemo)((function(){return d()(o.className,c,{"panel-submenu-item":i,"no-click-action":T})}),[o.className,c,i,T]),H=Object(f.useMemo)((function(){return h.a.createElement(h.a.Fragment,null,_,i&&h.a.createElement(S,{vertical:l}),B&&h.a.createElement(C,null))}),[_,i,B]),V=Object(f.useMemo)((function(){return h.a.createElement(E,{hovered:n,actived:o.active,disabled:o.disabled,useItemClass:s,className:U,title:o.title,name:o.name,setItemRef:j,onTouchToClick:A,onClick:D,onMouseEnter:N,onMouseLeave:F},h.a.createElement(x,{showIconColor:r,item:o,extraContent:H}))}),[n,o,s,U,j,A,D,N,F,r,H,l]);return h.a.createElement(I,{ref:R,item:o,vertical:l},V)}},dx_t2F6:function(e,n,r){},dx_t3tJ:function(e,n,r){"use strict";(function(t){var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_dvfR"),p=r("dx_SrB6"),v=r("dx_TSYQ"),g=r.n(v),b=r("dx_UtDZ"),y=r("dx_cDcd"),m=r.n(y),_=r("dx_yzqx"),k=r("dx_CqjN"),O=r("dx_H0Hj"),x=r("dx_B28d"),E=r("dx_MGoZ"),S=r("dx_TOEA"),C=r("dx_u3Zu"),I=r("dx_ZG9w"),B=r("dx_USRY"),T=r("dx_eGDr");r("dx_TJ4O");function w(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var R=function(e){l()(r,e);var n=w(r);function r(){var e;o()(this,r);for(var i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).state={editable:e.editorAPI.config.editable},e.getLinkUrl=function(){return e.snapshot.linkUrl},e.editableChangeSub=void 0,e.handleEditableChange=function(n){e.setState({editable:n})},e.openJira=function(n){var r;n.preventDefault(),n.stopPropagation(),n.nativeEvent.stopImmediatePropagation(),n.nativeEvent.stopPropagation();var o=e.getLinkUrl();if(!T.r&&_.S.isMobile&&(null===(r=e.ParentTextBlock)||void 0===r?void 0:r.editable))e.selectInlineJira(n);else{var i=e.props.recursionProps.isHistory,c=Boolean(i);Object(O.w)(o,n,!c),Object(b.collectEvent)("ccm_doc_enter_jira_issue_click",{target:"none",click:"jira_issue_block"})}},e.handleLongPress=function(n){n.preventDefault(),n.stopPropagation(),e.selectInlineJira(n)},e.handleTouch=Object(k.i)({onClick:e.openJira,onLongPress:e.handleLongPress}),e.selectInlineJira=function(n){var r=e.ParentTextBlock;if(r&&Object(I.f)(r)){var o=$(n.target).closest(".docx-jira_issue-block"),i=o.length&&o[0];if(i){var c=Object(h.F)(i,r.editor);c&&r.model.setSelection(c,!0)}}},e.onDeleteViewClick=function(n){n.preventDefault(),n.stopPropagation(),n.nativeEvent.stopImmediatePropagation(),n.nativeEvent.stopPropagation(),e.selectInlineJira(n)},e.handleClickViewTouch=Object(k.i)({onClick:e.onDeleteViewClick,onLongPress:e.onDeleteViewClick}),e.renderInlineView=function(){var n=g()({"docx-jira-issue--inline":!0});return m.a.createElement("div",{className:n,onClick:e.openJira,onTouchStart:e.handleTouch,onTouchEnd:e.handleTouch,onTouchMove:e.handleTouch},m.a.createElement("img",{className:"jira-issue-type-icon",src:e.typeIcon}),m.a.createElement("span",{className:"embed-text-container"},m.a.createElement("span",null,"".concat(e.issueKey," ").concat(e.summary," ")),m.a.createElement("span",{className:"jira-issue-status"}," ".concat(e.statusValue," "))),m.a.createElement(S.S,{sync:e.model.syncWhenInit,editable:e.state.editable}))},e.renderDeleteView=function(){return m.a.createElement("span",{className:"docx-jira-issue--deleted",onClick:e.handleClickViewTouch,onTouchStart:e.handleClickViewTouch,onTouchMove:e.handleClickViewTouch,onTouchEnd:e.handleClickViewTouch},m.a.createElement("span",{className:"jira-issue-warning-icon"},m.a.createElement(p.S,null)),m.a.createElement("span",{className:"embed-text-container"},m.a.createElement("span",{className:"jira-issue-key"},e.issueKey),m.a.createElement("span",{className:"jira-issue-tip"},t("doc.jira.is_deleted"))))},e}return c()(r,[{key:"getViewType",value:function(){return this.props.displaymode===B.t.Inline?B.t.Inline:this.props.viewType!==B.t.Inline?this.props.viewType:void 0}},{key:"blockViewDidMount",value:function(){var e=this.editorAPI.config;this.editableChangeSub=e.editableChange$.subscribe(this.handleEditableChange)}},{key:"blockViewWillUnmount",value:function(){var e;null===(e=this.editableChangeSub)||void 0===e||e.unsubscribe()}},{key:"render",value:function(){var e=this.getViewType();return this.isDelete?this.renderDeleteView():e===B.t.Inline?this.renderInlineView():null}},{key:"snapshot",get:function(){return this.model.snapshot}},{key:"isDelete",get:function(){return this.snapshot.isDelete}},{key:"issueKey",get:function(){return Object(C.c)(this.snapshot)}},{key:"statusValue",get:function(){return Object(C.j)(this.snapshot)}},{key:"summary",get:function(){return Object(C.I)(this.snapshot)}},{key:"typeIcon",get:function(){var e=this.snapshot,n=e.typeIconBase64,r=e.typeIconUrl;return n||r}},{key:"lastSyncTime",get:function(){return this.snapshot.lastSyncTime}},{key:"ParentTextBlock",get:function(){return this.parentId?this.blockManager.getBlockViewByBlockId(this.parentId):null}}]),r}(E.l);R.type=x.B.JIRA_ISSUE,n.S=R}).call(this,r("dx_E9Eu"))},dx_t4JV:function(e,n,r){},dx_tFZp:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return w}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_lSNA"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_W7W2"),p=r.n(h),v=r("dx_a1gu"),g=r.n(v),b=r("dx_Nsbk"),y=r.n(b),m=r("dx_UtDZ"),_=r("dx_C7Cb"),k=r("dx_YzVl"),O=r("dx_yaFe"),x=r("dx_Ai6r"),E=r("dx_InLz"),S=r("dx_n3n9"),C=r("dx_tVvo"),I=r("dx_C1Ca"),B=r("dx_Y27Y");function T(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=y()(e);if(n){var i=y()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return g()(this,r)}}var w=function(e){p()(r,e);var n=T(r);function r(){var e;u()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).format=B.L.FILES,e}return f()(r,[{key:"shouldCopy",value:function(e){return!1}},{key:"shouldPaste",value:function(e,n,r){if(this.filterImageFile(n).length>0){var o,i=null===(o=r.clipboardData)||void 0===o?void 0:o.getData(B.L.HTML);if(i){var c=document.createElement("div");if(c.innerHTML=i,!Array.from(c.children).filter((function(e){if(!Object(E.U)(e))return!1;var n=e.getAttribute("style");return!n||!n.includes("mso-ignore:")})).length)return!0}return Object(m.maybeImagePaste)(r)}return!0}},{key:"onCopyBlock",value:function(e){}},{key:"onCopy",value:function(e,n){}},{key:"onPaste",value:function(){var e=l()(o.a.mark((function e(n,r,i){var a,l,s=this;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n[n.length-1]){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,this.filterValidImage(r);case 5:return a=e.sent,e.next=8,this.createClientVars(this.filterImageFile(a));case 8:if(l=e.sent){e.next=11;break}return e.abrupt("return");case 11:Object(C.s)(Object.assign({},this.options,{proxyClipboardData:i}),l,this.format,c()({},I.q.afterBlockIdCreated,(function(e){var n,r=e.oldRecordId,o=e.blockId,i=null===(n=l.payloadMap[r])||void 0===n?void 0:n.file;if(i){var c=window.URL.createObjectURL(i);s.blockManager.editorAPI.getService(O.V).addData(o,c)}})));case 12:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"filterImageFile",value:function(e){for(var n=[],r=0;r<e.length;r++){var o=e[r];this.isPasteImageFile(o)&&n.push(o)}return n}},{key:"filterValidImage",value:function(e){return Object(m.filterWeChatDoubleImage)(e)}},{key:"isPasteImageFile",value:function(e){return e.type.startsWith("image/")}},{key:"createClientVars",value:function(){var e=l()(o.a.mark((function e(n){var r,i,c,a,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.map((function(e){return Object(x.y)(e)})),e.prev=1,e.next=4,Promise.all(r);case 4:return i=e.sent,c={},a={},l=i.map((function(e,r){var o=Object(_.S)();return c[o]={id:o,snapshot:e},a[o]={file:n[r]},o})),e.abrupt("return",{recordMap:c,recordIds:l,payloadMap:a});case 11:e.prev=11,e.t0=e.catch(1),Object(k.F)({type:"error",content:"".concat(t("common.upload_image_failed")," ").concat(String(e.t0.msg||""))});case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(n){return e.apply(this,arguments)}}()}]),r}(S.S)}).call(this,r("dx_E9Eu"))},dx_tJg8:function(e,n,r){},dx_tOIf:function(e,n,r){"use strict";r.d(n,"U",(function(){return l}));var o=r("dx_TQtZ"),i=r("dx_LN7G"),c=r("dx_cDcd"),a=r.n(c),l=(r("dx_t2F6"),function(e){var n=e.visible,r=e.style,c=e.onVisibleChange;return n?a.a.createElement("div",{className:"okrx-block-visibility__switch",style:r,onClick:function(){c(!1)}},a.a.createElement(o.S,null)):a.a.createElement("div",{className:"okrx-block-visibility__switch",style:r,onClick:function(){c(!0)}},a.a.createElement(i.S,null))})},dx_tP01:function(e,n,r){"use strict";r.d(n,"m",(function(){return s})),r.d(n,"x",(function(){return d}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=(r("dx_J4zp"),r("dx_h6a8"));r("dx_ZG9w"),r("dx_zghO");function s(e){var n=e.rootBlockId;return e.getRecordByBlockId(n).id}function u(e){return Object(l.flatten)(e.map((function(e){return e.children.length>0?u(e.children):e})))}function d(e,n){return f.apply(this,arguments)}function f(){return(f=a()(i.a.mark((function e(n,r){var o,c,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=u(n),!((c=o.map((function(e){return e.id})).filter((function(e){return r.hasBlockModelByBlockId(e)&&!r.hasBlockViewByBlockId(e)}))).length>0)){e.next=5;break}return e.next=5,r.layoutManager.renderNodeById(c);case 5:return a=n.map((function(e){return r.getBlockViewByBlockId(e.id)})),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},dx_tPxY:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return N}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_lSNA"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_UtDZ"),p=r("dx_h6a8"),v=r("dx_cDcd"),g=r.n(v),b=r("dx_bUYd"),y=r("dx_yzqx"),m=r("dx_l6la"),_=r("dx_JMey"),k=r("dx_Bv2G"),O=r("dx_zEdG"),x=r("dx_CwnG"),E=r("dx_CZKf"),S=r("dx_imty"),C=r("dx_g0R0"),I=r("dx_TwmW"),B=r("dx_B28d"),T=r("dx_FvGq"),w=r("dx_D8nn"),R=r("dx_niVl"),M=r("dx_tfgj"),j=r("dx_CYRP"),D=r("dx_gLqT"),A=r("dx_g14w");function P(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function L(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?P(Object(r),!0).forEach((function(n){l()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var N=function(){function e(n){var r=this,i=n.blockManager,a=n.pageToken,s=n.editable,d=n.selectionAPI;u()(this,e),this.blockManager=void 0,this.pageToken=void 0,this.coverInfo=null,this.tokenToSrcMap={},this.fileSrc="",this.editable=void 0,this.selectionAPI=void 0,this.handleEditableChange=function(e){var n=e.curr;r.editable=n},this.handleCoverUpdate=function(e){try{var n,o=e.depth,i=e.isRoot,c=e.record.snapshot;if(0!==o||!i||c.type!==B.B.PAGE)return;var a=c.cover,s=Object(A.e)(a),u=s?r.tokenToSrcMap[a.token]||Object(A.I)(a):"",d=s?(n={type:a.type,offset_ratio_x:a.offset_ratio_x,offset_ratio_y:a.offset_ratio_y},l()(n,Object(A.o)(a.type),Object(A.q)(a)),l()(n,"src",u),l()(n,"lightSrc",Object(A.H)(a)),l()(n,"mime_type",a.mime_type),l()(n,"status",a.status),n):null;if(Object(p.isEqual)(r.coverInfo,d))return;r.coverInfo=d,r.updateCoverInfo(r.coverInfo),r.isCoverUploading()&&r.cancelCoverUpload()}catch(f){console.error("cover update error",f)}},this.handleUpdateCoverPosition=function(e){if(e){var n=e.offset_ratio_x,o=void 0===n?0:n,i=e.offset_ratio_y,c=void 0===i?0:i,a=L(L({},Object(p.pick)(e,["type","url","token","mime_type"])),{},{offset_ratio_x:o,offset_ratio_y:c});r.blockManager.applyTransaction("handlePageCoverChange",(function(e){e.replace(r.pageToken,["cover"],a)}))}},this.clearCoverInfo=function(){r.updateCoverInfo(null)},this.handleSetPresetCover=function(){var e=c()(o.a.mark((function e(n,i){var c,a,l,s,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.token,a=n.contentType,e.prev=1,l=Object(A.x)(c,a),r.updateCoverInfo({type:E.i.Preset,src:l,lightSrc:Object(A.S)(c,a),offset_ratio_x:0,offset_ratio_y:0,mime_type:a}),e.next=6,Object(j.Y)([c],r.pageToken);case 6:if((s=e.sent)&&s.code===j.v.SUCCESS&&s.data&&s.data.succ_files){e.next=9;break}return e.abrupt("return",r.collectChangeCover(D.q.FAIL_COPY_TOKEN,i,s&&s.code));case 9:if(r.checkCoverUploadStatus(i)){e.next=11;break}return e.abrupt("return");case 11:if(r.checkEditableStatus(i)){e.next=13;break}return e.abrupt("return");case 13:return u=s.data.succ_files[c],r.tokenToSrcMap[u]=l,r.applyDocCover(u,E.i.Preset,a),e.abrupt("return",r.collectChangeCover(D.q.SUCCESS,i));case 19:return e.prev=19,e.t0=e.catch(1),console.log("copy cover image error",e.t0),e.abrupt("return",r.collectChangeCover(D.q.FAIL_UNKNOWN,Object.assign(i,{error:e.t0,err:e.t0.message})));case 23:case"end":return e.stop()}}),e,null,[[1,19]])})));return function(n,r){return e.apply(this,arguments)}}(),this.handleSetNoneCover=function(e){r.applyDocCover(""),Object(O.P)("ccm_doc_cover_choose_panel_click",Object(x.F3)(),{click:"click_remove_cover"})},this.handleRemoveAllSelection=function(){r.selectionAPI.removeAllSelection()},this.blockManager=i,this.pageToken=a,this.editable=s||!1,this.selectionAPI=d,this.blockManager.addListener(T.d,this.handleCoverUpdate),this.blockManager.addListener(T.F,this.handleCoverUpdate),this.blockManager.addListener(T.o,this.handleCoverUpdate),w.S.on(M.F.UPDATE_COVER_POSITION,this.handleUpdateCoverPosition),w.S.on(M.F.REMOVE_ALL_SELECTION,this.handleRemoveAllSelection),w.S.on(S.H.EditableChange,this.handleEditableChange),Object(I.S)()&&window.addEventListener("clear",this.clearCoverInfo)}return f()(e,[{key:"destroy",value:function(){this.blockManager.removeListener(T.d,this.handleCoverUpdate),this.blockManager.removeListener(T.F,this.handleCoverUpdate),this.blockManager.removeListener(T.o,this.handleCoverUpdate),w.S.off(M.F.UPDATE_COVER_POSITION,this.handleUpdateCoverPosition),w.S.off(S.H.EditableChange,this.handleEditableChange),w.S.off(M.F.REMOVE_ALL_SELECTION,this.handleRemoveAllSelection),Object(I.S)()&&window.removeEventListener("clear",this.clearCoverInfo),this.coverInfo=null,this.tokenToSrcMap={},this.cancelCoverUpload(),this.updateCoverInfo(null)}},{key:"isCoverUploading",value:function(){return Object(_.n)(h.store.getState())}},{key:"cancelCoverUpload",value:function(){h.store.dispatch(Object(m.vn)())}},{key:"collectChangeCover",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0,o=n.err,i=n.error;switch(e){case D.q.FAIL_CONFLICT:break;case D.q.SUCCESS:this.isCoverUploading()&&this.cancelCoverUpload();break;default:var c,a=e===D.q.FAIL_OFFLINE,l=e===D.q.FAIL_UPLOAD_IMAGE&&o?o:t(a?"CreationDoc_Docs_DocCover_NoInternetConnection_Toast":"CreationDoc_Docs_DocCover_FailedToModify_Toast");if(!a){var s=new Error("collectChangeCover failed");c=Object(C.G)(n.error||s,s)}(null===i||void 0===i?void 0:i.code)!==k.g.SPACE||y.S.isMobile?(null===i||void 0===i?void 0:i.code)!==k.g.USER_NO_DRIVE&&(null===i||void 0===i?void 0:i.code)!==k.g.USER_DRIVE||y.S.isMobile?Object(b.y)({type:"error",key:"cover_error_tips",content:g.a.createElement("div",{style:{whiteSpace:"nowrap"}},l),duration:3e3,errorContext:c}):h.showUserLimitDialog&&Object(h.showUserLimitDialog)(k.O.IMAGE):h.showPicLimitDialog&&Object(h.showPicLimitDialog)(h.PicLimitType.STORAGE_SPACE,{type:h.StorageSpaceType.UPLOAD_FILE}),a||h.store.dispatch(Object(m.N)(this.coverInfo)),h.store.dispatch(Object(m.R)()),console.info("collectChangeCover error",L(L({},n),{},{status_code:e}))}r&&Object.assign(n,{backend_status_code:r}),e!==D.q.SUCCESS&&Object.assign(n,{load_status:"set_fail"}),R.S.applyCover(L(L({},n),{},{frontend_status_code:e}),e!==D.q.SUCCESS)}},{key:"applyDocCover",value:function(){var e,n=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,c=r&&o?(e={},l()(e,Object(A.o)(o),r),l()(e,"type",o),l()(e,"offset_ratio_x",0),l()(e,"offset_ratio_y",0),l()(e,"mime_type",i||"image/jpeg"),e):null;this.blockManager.applyTransaction("handlePageCoverChange",(function(e){e.replace(n.pageToken,["cover"],c)}))}},{key:"updateCoverInfo",value:function(e){h.store.dispatch(Object(m.N)(e?L({},e):e))}},{key:"checkCoverUploadStatus",value:function(e){return!!this.isCoverUploading()||(this.collectChangeCover(D.q.FAIL_CONFLICT,e),!1)}},{key:"checkEditableStatus",value:function(e){return!!this.editable||(this.collectChangeCover(D.q.FAIL_AUTHORITY_CHANGE,e),!1)}},{key:"getCommonCollectParam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.coverId,r=e.type,o=e.coverSource,i=e.series,c=void 0===i?"":i,a=e.contentType,l=void 0===a?"":a,s={action_type:o,cover_style:"upload",cover_id:"upload",pic_file_type:l};return r===E.i.Preset&&(s.cover_style=c,s.cover_id=n),s}}]),e}()}).call(this,r("dx_E9Eu"))},dx_tQ7S:function(e,n){},dx_tSNM:function(e,n,r){"use strict";r.d(n,"c",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("offline-sync")},dx_tVvo:function(e,n,r){"use strict";(function(t){r.d(n,"s",(function(){return A}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_lSNA"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_e4eN"),u=r("dx_alfx"),d=r("dx_h6a8"),f=r("dx_bUYd"),h=r("dx_PQBD"),p=r("dx_MoY1"),v=r("dx_yzqx"),g=r("dx_Z7ZC"),b=r("dx_HpeV"),y=r("dx_UHze"),m=r("dx_B28d"),_=r("dx_B8Bh"),k=r("dx_NbrS"),O=r("dx_ZG9w"),x=r("dx_kZ3l"),E=r("dx_zghO"),S=r("dx_Y27Y"),C=r("dx_bkVC"),I=r("dx_UTG8"),B=r("dx_UydN"),T=r("dx_vqyt"),w=r("dx_XSmB"),R=r("dx_C1Ca"),M=r("dx_IVxn");function j(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function D(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?j(Object(r),!0).forEach((function(n){c()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function A(e,n,r,o){return P.apply(this,arguments)}function P(){return P=l()(o.a.mark((function e(n,r,i,c){var a,j,A,P,L,N,F,U,H,V,W,z,G,K,q,X,Y,J,Z,Q,$,ee,te,ne,re,oe,ie,ce,ae,le,se,ue,de,fe,he,pe,ve,ge,be,ye,me,_e=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(me=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:J(),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:q();if(e&&n.type.startsWith("heading")&&n.record.snapshot.folded){var r=P.findFoldedBlocks(n.id);return!!(null===r||void 0===r?void 0:r.length)}return!1},ye=function(e,n){var r=Object.keys(e);if(1===r.length){var o=r[0],i=e[o],c=n[o];if(i.snapshot.type===m.B.IMAGE&&!c.file&&c.src.startsWith("blob:"))return!0}return!1},be=function(e){var n=U.parentBlockStruct;if(U.isSelectRoot)return{position:0,parentRecordId:n.record.id};var r=n.recordId,o=q(),i=J(),c=!1;if(me(i,o)){var a=P.findFoldedBlocks(o.id).pop();o=j.getBlockViewByBlockId(a),i=!1,c=!0}var l=n.children.findIndex((function(e){return e.id===o.id})),s=n.children[l],u=l,d=l+1;if(i){var f,h=o,p=null===(f=h.model.getSelection())||void 0===f?void 0:f.toPosition();if(!p)return{position:d,parentRecordId:n.record.id};var v=p.start,g=v+p.len,y=I.InputPipe.getPlainText(h.record.snapshot.text).length,m=p.isCollapsed(),_=s.record.snapshot.children,E=h.model.zoneState;if(g===y&&0===v)return ge(e,h.id,u),{position:u,parentRecordId:n.record.id};if(g===y)return m||Object(O.y)(h,e),_&&_.length?{position:0,parentRecordId:s.record.id}:{position:h.model.isEmpty?u:d,parentRecordId:n.record.id};if(0===v)return m||Object(O.y)(h,e),{position:u,parentRecordId:r,ignoreAddNewLine:!0};var S=Object(b.k)(s.record.snapshot.text,[0,v]),C=e.createChildren([D(D({},s.record.snapshot),{},{children:[],text:S})]);e.insertChildren(r,u,C),Object(k.D)(e,S,C[0]);var B=x.j(h,[g,E.totalWidth()-1]),T=E.slice(B.start,B.end).getContent();return h.model.updateContent(T,{extra:{op:e}}),{position:d,parentRecordId:n.record.id}}return{position:c?u+1:u,parentRecordId:n.record.id,pasteIntoFold:c}},ge=function(e,n,r){var o=j.getBlockModelByBlockId(n),i=o.parent;if(i){void 0===r&&(r=o.position);var c=o.children.map((function(e){return e.recordId}));Object(p.y)(e,[n],j),c.length&&(e.replaceChildren(o.recordId,[]),Object(p.t)(e,i.recordId,r,c))}},ve=function(e,n){return e.range=n,e},pe=function(e){return delete e.op,delete e.createRecord,e},he=function(e){var n=r.recordIds,o=Y();return 1===n.length&&(!o.children||0===o.children.length)&&o.type===e},fe=function(e,n,r){return e.op=n,e.createRecord=r,e},de=function(e,n){se(e,n)},ue=function(e){var n=Object(C.h)(),r=n.from,o=n.pasteTimes;return Object(M.L)({blockManager:j,snapshot:e,applyFrom:r,applyTime:o})},se=function(e,n){U.applyRecordIds.push(n),U.recordIdToTempIdMap.set(n,e),U.tempIdToRecordIdMap.set(e,n)},le=function(e,n){return function(r,o){return Object(w.M)(D(D({},z),{},{op:e}),r,o||U.parentBlockStruct.record.id,n)}},ae=function(){return(ae=l()(o.a.mark((function e(){var n,c,a,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=ve(U),c=q(),!me(J(),c)){e.next=7;break}return a=P.findFoldedBlocks(c.id),l=a.pop(),e.next=7,j.layoutManager.renderNodeById(l);case 7:return e.next=9,j.applyTransaction("pasteIntoBlock",(function(e){var n=Object(C.h)(),o=n.pasteTimes,c=n.from,a=n.pasteFlag,l=c===m.G.innerCutPaste&&0===o,s=!l,u=!1;i===S.L.DOCX_RECORD&&r.pasteFlag===a&&l&&(u=!0);var d=function(e){return!j.getBlockIdsByRecordId(e).length&&(u&&m.t.includes(r.recordMap[e].snapshot.type))},f=fe(U,e,le(e,{getIsOnlyRemovePosition:d,shouldReplaceAuthor:s}));K(R.q.beforeBlockDataApply,f);var h=J();if(r.recordIds.length){var p=be(e),v=p.position,g=p.parentRecordId;if(p.pasteIntoFold&&j.layoutManager.getReconciler().debouncePaint(),Z())Object(B.m)(e,j.editorAPI);else if(h){var b=q();if(b.model.isEmpty&&b.type!==m.B.PAGE){var k,O=Y(),x=(null===(k=O.children)||void 0===k?void 0:k.length)||0;if(O.type!==m.B.TEXT||0!==x&&!Object(_.K)(b.type)||(O.type=b.type),1===r.recordIds.length&&O.type===m.B.TEXT&&he(m.B.TEXT)){["text_indent","align"].forEach((function(e){var n=b.record.snapshot[e];n&&(O[e]=n)}))}}}else U.selectedBlocks.forEach((function(n){var r=j.getBlockModelByBlockId(n.id);r.parent&&e.removeChildren(r.parent.recordId,[r.recordId])}));var E=Object(y.K)().userId,I=r.recordIds.map((function(n){var r=Object(w.M)(D(D({},z),{},{op:e}),n,g,{getIsOnlyRemovePosition:d,recursive:!0,shouldReplaceAuthor:s,userId:E});return K(R.q.afterBlockIdCreated,{oldRecordId:n,blockId:r}),r}));e.insert(g,["children",v],I),pe(f)}}),{afterTransactionAccepted:function(){K(R.q.onDataAccept,n)},isInPaste:!0});case 9:K(R.q.onDataApply,n);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)},ce=function(){return ae.apply(this,arguments)},ie=function(){return(ie=l()(o.a.mark((function e(){var n,i,c,l,d,f,h;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=q(),c=i.model.getSelection()){e.next=4;break}return e.abrupt("return");case 4:return l=c.toPosition(),f=0,e.next=8,j.applyTransaction("applyPlainTextIntoTextualBlock",(function(e){var n=fe(U,e);if(K(R.q.beforeBlockDataApply,n),r.recordIds.length){var o=[r.recordIds[0],i.record.id],a=o[0],d=o[1],h=Object(w.z)(D(D({},z),{},{op:e}),a,d);ue(h);var p=h.text,v=Object(u.Z)(p.initialAttributedTexts,p.apool).get("0");f=v.length();var b=Object(O.w)(i.model,c);v=v.compose((new s.m).retain(v.length(),b));var y=new s.m({zoneId:l.zoneId}).retain(l.start).delete(l.len).concat(v);i.model.apply(y,{extra:{op:e},type:"pasteTextIntoTextualBlock"});var m=i.model.zoneState.toAttributeText();Object(g.w)(e,i.record,m),de(a,d),pe(n)}}),{afterTransactionAccepted:function(){K(R.q.onDataAccept,d)}});case 8:h=(null===(n=i.model.getSelection())||void 0===n?void 0:n.toPosition())||{},d=ve(U,D(D({},h),{},{start:l.start,len:f})),a&&i.focus(),K(R.q.onDataApply,d);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)},oe=function(){return ie.apply(this,arguments)},re=function(){var e=A.getSelection(),o=j.getBlockModelByBlockId(e[0].id),c=o.parent||o,a=$(e);return{blockManager:j,originalSelectedBlocks:e,selectedBlocks:e,data:r,isSelectRoot:null===o.parent,format:i,parentBlockStruct:c,isPasteIntoBlock:a,applyRecordIds:[],recordIdToTempIdMap:new Map,tempIdToRecordIdMap:new Map,editorContext:n}},ne=function(){return(ne=l()(o.a.mark((function e(){var n,i,c,a,l,s,u,f,p,v,g;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.recordIds,i=U.tempIdToRecordIdMap.get(n[0]),c=U.tempIdToRecordIdMap.get(n[n.length-1]),a=j.getBlockModelByBlockId(j.getBlockIdsByRecordId(i)[0]).id,l=j.getBlockModelByBlockId(j.getBlockIdsByRecordId(c)[0]),e.next=7,P.forceShowFoldedBlock(a,j.editable);case 7:if(l.nextSibling&&P.handleBlockShow({btmAffectedSib:l.nextSibling}),(s=P.findFoldedByBlock(l.id))?l=j.getBlockModelByBlockId(s):l.children.length&&Object(_.K)(l.type)&&(l=ee(l)),!m.hI.includes(l.type)){e.next=18;break}return u=l.id,e.next=14,L.scrollToBlock(u);case 14:f=l.getText().length,A.setSelection([{type:E.j.TEXT,id:l.id,selection:{start:f,end:f}}]),e.next=34;break;case 18:if((null===(p=l.parent)||void 0===p?void 0:p.type)===m.B.VIEW&&(l=l.parent),v=l.next,g=l.parent,(m.h.includes(l.type)||l.type===m.B.VIEW)&&(v=l.nextSibling),m.h.includes(g.type)&&Object(d.last)(g.children).id===l.id&&(v=null),!v||!m.hI.includes(v.type)){e.next=31;break}return u=v.id,e.next=27,L.scrollToBlock(u);case 27:j.getBlockViewByBlockId(v.id).model.setSelection({start:0,len:0},!0),e.next=34;break;case 31:return e.next=33,Object(h.A)(j,A,L,l.id,!0,!0,!0);case 33:u=e.sent;case 34:case"end":return e.stop()}}),e)})))).apply(this,arguments)},te=function(){return ne.apply(this,arguments)},ee=function(e){for(var n=e;null===(r=n.children)||void 0===r?void 0:r.length;){var r;n=n.children[n.children.length-1]}return n},$=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U.selectedBlocks,n=q(e),o=J(e);if(0===r.recordIds.length||n.type===m.B.CODE&&o)return!0;if(!o||!Q())return!1;var i=n.record.snapshot.children,c=Array.isArray(i)&&i.length>0,a=n.model.isEmpty&&!c;return!a||n.type!==m.B.TEXT},Q=function(){var e=Y();return i!==S.L.DOCX_RECORD&&1===r.recordIds.length&&m.hI.includes(e.type)&&(!e.children||0===e.children.length)},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U.selectedBlocks;return A.isTextSelectionAcrossBlocks(e)},J=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U.selectedBlocks;return 1===e.length&&e[0].type===E.j.TEXT},Y=function(){return N[r.recordIds[0]].snapshot},X=function(){var e=A.getSelection(),n=j.getBlockModelByBlockId(e[0].id);return J(e)&&n.type===m.B.CODE},q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U.selectedBlocks;return j.getBlockViewByBlockId(e[0].id)},K=function(e,n){H.callHook(e,n)},a=!(_e.length>4&&void 0!==_e[4])||_e[4],j=n.blockManager,A=n.selectionAPI,P=n.fold,L=n.viewport,N=r.recordMap,F=r.payloadMap,r.recordIds.length){e.next=33;break}return e.abrupt("return",[]);case 33:if(!(Object.keys(N).length>2e3)||X()){e.next=36;break}return Object(f.v)({content:t("CreationDoc_DocX_blocks_copy_tooMany_failed_content")}),e.abrupt("return");case 36:if(!v.S.isSafari||!ye(N,F)){e.next=38;break}return e.abrupt("return");case 38:if(U=re(),H=new T.S(j,r,c),V=U.parentBlockStruct,W=U.tempIdToRecordIdMap,z={recordMap:N,parentBlockStruct:V,tempIdToRecordIdMap:W,beforeCreateNewRecord:ue,afterCreateNewRecord:de},K(R.q.preprocessData,U),r.recordIds.length){e.next=45;break}return e.abrupt("return",[]);case 45:if(!(G=$())){e.next=51;break}return e.next=49,oe();case 49:e.next=53;break;case 51:return e.next=53,ce();case 53:if(r.recordIds.length){e.next=55;break}return e.abrupt("return");case 55:G||te();case 56:case"end":return e.stop()}}),e)}))),P.apply(this,arguments)}}).call(this,r("dx_E9Eu"))},dx_tWVV:function(e,n,r){"use strict";r.d(n,"G",(function(){return M})),r.d(n,"U",(function(){return j})),r.d(n,"O",(function(){return D})),r.d(n,"l",(function(){return A})),r.d(n,"o",(function(){return P})),r.d(n,"P",(function(){return L})),r.d(n,"lm",(function(){return N})),r.d(n,"S",(function(){return F})),r.d(n,"H",(function(){return U})),r.d(n,"t",(function(){return H})),r.d(n,"i",(function(){return V})),r.d(n,"k",(function(){return W}));var o=r("dx_cDcd"),i=r.n(o),c=r("dx_BaZy"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_o0o1"),m=r.n(y),_=r("dx_yXPU"),k=r.n(_),O=r("dx_yQ5Y"),x=r("dx_rJ2n"),E=r("dx_UtDZ"),S=r("dx_h6a8"),C=r("dx_T7TM");function I(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var B={id:""},T=Object(S.once)(k()(m.a.mark((function e(){var n,o,i,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O.S.registerPlugin(new(function(e){h()(r,e);var n=I(r);function r(){return s()(this,r),n.apply(this,arguments)}return d()(r,[{key:"showUserProfile",value:function(e,n){Object(E.showUserProfile)(e,n)}}]),r}(x.U))),e.next=3,r.e("dx_uzow").then(r.bind(null,"dx_s74u"));case 3:n=e.sent,o=n.config,i=n.Env,c=Object(S.get)(window,"globalConfig.common.product","feishu"),o.init({appName:"bear-web-x",appVersion:"0.1.0",locale:E.i18nHelper.getLocale(),appRegion:"feishu"===c?"cn":"va",env:C.T?i.Dev:C.Z?i.Boe:i.Production,user:window.User||B});case 8:case"end":return e.stop()}}),e)}))));var w=r("dx_Fimk");function R(e){return function(n){return n.error&&Object(w.N)("ccm_doc_comment_loadable",{state:"error",loadable:e,message:n.error.message,data:JSON.stringify({stack:n.error.stack})}),n.timeout&&Object(w.N)("ccm_doc_comment_loadable",{state:"timeout",loadable:e}),null}}var M=a()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_z5DI"))},loading:function(){return null}}),j=a()({loader:function(){return r.e("dx_PtD").then(r.bind(null,"dx_Z4vw"))},loading:R("docComment")}),D=a()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_oOXr"))},loading:R("globalComment")}),A=a()({loader:function(){return T(),Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_N9m0"))},loading:function(){return null}}),P=a()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_Eeoe"))},loading:function(){return null}}),L=a()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_uyGt"))},loading:function(){return null}}),N=a()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_v6vh"))},loading:R("print")}),F=a()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_vsAT"))},loading:function(){return null}}),U=a()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_m0mm"))},loading:function(){return null}}),H=a()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_YEav"))},loading:function(){return null},render:function(e,n){var r=e.default;return i.a.createElement(r,n)}}),V=a()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_IUdR"))},loading:function(){return null}}),W=a()({loader:function(){return Promise.all([r.e("dx_kgU"),r.e("dx_WAh"),r.e("dx_UTc"),r.e("dx_pvz"),r.e("dx_W9i")]).then(r.bind(null,"dx_j13B"))},loading:function(){return null}})},dx_tX8z:function(e,n,r){"use strict";r.d(n,"e",(function(){return h})),r.d(n,"l",(function(){return p}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_m3ds"),a=r("dx_cDcd"),l=r("dx_NMuw"),s=r("dx_Z8yN"),u=r("dx_D8nn"),d=r("dx_S6dX"),f=r("dx_ml3I");function h(e){return e?e.getBoundingClientRect():new DOMRect(0,0,0,0)}function p(e,n,r,o){var p=Object(a.useState)(h(e)),v=i()(p,2),g=v[0],b=v[1],y=Object(a.useCallback)((function(){b((function(n){var r=h(e);return Object(d.K)(n,r)?n:r}))}),[e]);Object(a.useEffect)((function(){if(y(),r){var n=0,o=new MutationObserver((function(){n||(n=setTimeout((function(){y(),n=0})))}));if(e&&e instanceof Node){var i=e.closest("div.block")||e.closest("div.overlay-container");o.observe(i||e,{attributes:!0,childList:!0,subtree:!0})}return window.addEventListener("resize",y),function(){o.disconnect(),window.removeEventListener("resize",y),n&&clearTimeout(n)}}}),[y,e,r]),Object(a.useEffect)((function(){return u.S.on(u.p.COMMON.UPDATE_OVERLAY_POSITION,y),function(){u.S.off(u.p.COMMON.UPDATE_OVERLAY_POSITION,y)}}),[y]),Object(a.useEffect)((function(){var e=function(e){!0===e?b(new DOMRect(0,0,0,0)):setTimeout((function(){return y()}))};return n.addListener(s.F,e),n.addListener(l.v.CATALOGUE_UPDATE,e),function(){n.removeListener(s.F,e),n.removeListener(l.v.CATALOGUE_UPDATE,e)}}),[n,y]),Object(a.useEffect)((function(){return u.S.on(u.p.COMMON.UPDATE_OVERLAY_POSITION,y),function(){u.S.off(u.p.COMMON.UPDATE_OVERLAY_POSITION,y)}}),[y]),Object(a.useEffect)((function(){if(o&&r)return o.addEventListener("scroll",y,!0),function(){o.removeEventListener("scroll",y,!0)}}),[o,r,y]);var m=Object(f.S)(r);return Object(a.useEffect)((function(){(c.S.ios||c.S.isWebKit)&&y()}),[m,c.S.ios,c.S.isWebKit]),g}},dx_tXxH:function(e,n,r){"use strict";r.d(n,"R",(function(){return v})),r.d(n,"RE",(function(){return g}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_UtDZ"),s=r("dx_d2dg"),u=r("dx_B28d"),d=r("dx_OPAz"),f=r("dx_GLPm"),h=r("dx_fEKD"),p=r("dx_W3mR");function v(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.B.SHEET;return Object(h.b)(e,n)}function g(e){return b.apply(this,arguments)}function b(){return(b=a()(i.a.mark((function e(n){var r,o,c,a,h,v,g,b,y,m,_;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(l.isOnline)()){e.next=3;break}return console.error("[sheet] insertSheet failed when offline"),e.abrupt("return",{code:p.X.offlineError});case 3:return console.info("[sheet] start insertSheet"),r=n.block,o=n.blockManager,c=n.row,a=n.col,h=n.mark,v=n.isAppend,g="",e.next=8,Object(s.x)({block:r,blockManager:o,isAppend:v,mark:null!==h&&void 0!==h?h:{},newBlockType:u.B.SHEET,newBlockOptions:{token:g}});case 8:if(b=e.sent,console.info("[sheet] insertSheet:".concat(b)),b){e.next=12;break}return e.abrupt("return",{code:p.X.insertBlockError});case 12:return y=o.getBlockModelByBlockId(b),e.next=15,o.editorAPI.getService(d.H).getBridge("");case 15:return m=e.sent,_=y.record.id,e.prev=17,e.next=20,m.addSheetBlock(_,c,a);case 20:g=e.sent,o.editorAPI.getService(d.H).token=Object(f.U)(g).token||"",e.next=29;break;case 24:return e.prev=24,e.t0=e.catch(17),console.error("[sheet] addSheetBlock error",e.t0),o.hasBlockModelByBlockId(b)&&o.applyTransaction("deleteSheetBlock",(function(e){b&&e.removeChildren(y.parent.record.id,[_])})),e.abrupt("return",{code:p.X.createTokenError,error:e.t0});case 29:return o.applyTransaction("updateSheetBlock",(function(e){var n;try{n=o.getRecordByBlockId(b).id}catch(i){console.error("[sheet] getRecordByBlockId error",i);var r=Object(f.U)(g).id;return void m.delSheetBlock(_,r)}e.replace(n,["token"],g)}),{undoable:!1}),e.abrupt("return",{code:p.X.success,newBlockId:b});case 31:case"end":return e.stop()}}),e,null,[[17,24]])})))).apply(this,arguments)}},dx_tfgj:function(e,n,r){"use strict";r.d(n,"F",(function(){return o})),r.d(n,"C",(function(){return i}));var o={COVER_INTERSECTION_CHANGE:"cover_intersection_change",SET_COVER_DATA:"set_cover_data",UPDATE_COVER_POSITION:"update_cover_position",REMOVE_ALL_SELECTION:"remove_all_selection"},i=".doc-cover-wrapper"},dx_tgFd:function(e,n,r){"use strict";var o,i,c;r.d(n,"S",(function(){return o})),r.d(n,"f",(function(){return i})),r.d(n,"K",(function(){return c})),function(e){e.modify="modify",e.add="add",e.remove="remove"}(o||(o={})),function(e){e[e.UnKnow=-1]="UnKnow",e[e.Add=0]="Add",e[e.TextChange=1]="TextChange",e[e.InsertNode=2]="InsertNode",e[e.DeleteNode=3]="DeleteNode",e[e.InitNode=4]="InitNode",e[e.InsertChildNode=5]="InsertChildNode",e[e.InsertChildrenNodes=6]="InsertChildrenNodes",e[e.NormalPropertyChange=7]="NormalPropertyChange",e[e.ComplexPropertyChange=8]="ComplexPropertyChange",e[e.ListChange=9]="ListChange"}(i||(i={})),function(e){e.NO_DATA="NO_DATA",e.OFFLINE="OFFLINE",e.FAILED="FAILED",e.NO_SECRET="NO_SECRET"}(c||(c={}))},dx_tokD:function(e,n,r){"use strict";r.d(n,"B",(function(){return M}));var o,i,c,a,l,s,u=r("dx_J4zp"),d=r.n(u),f=r("dx_yG8O"),h=r.n(f),p=r("dx_lwsE"),v=r.n(p),g=r("dx_W8MJ"),b=r.n(g),y=r("dx_PJYZ"),m=r.n(y),_=r("dx_W7W2"),k=r.n(_),O=r("dx_a1gu"),x=r.n(O),E=r("dx_Nsbk"),S=r.n(E),C=r("dx_Uyc2"),I=r.n(C),B=(r("dx_A1AB"),r("dx_Vvd7")),T=r("dx_h6a8"),w=r("dx_Xdvu");function R(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=S()(e);if(n){var i=S()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return x()(this,r)}}var M=Object(B.H)()((s=function(e){k()(r,e);var n=R(r);function r(){var e;v()(this,r);for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];return e=n.call.apply(n,[this].concat(i)),h()(e,"view",c,m()(e)),h()(e,"context",a,m()(e)),h()(e,"instantiation",l,m()(e)),e.extensions=[],e.subs=void 0,e}return b()(r,[{key:"init",value:function(){var e=this,n=this.instantiation;this.options.getExtensions(this.context.toPlainObject()).forEach((function(r){var o=d()(r,2),i=o[0],c=o[1].map((function(r){var o=Object(T.isArray)(r)?r:[r,{}],i=d()(o,2),c=i[0],a=i[1],l=n.instantiate(c,a);return e.extensions.push(l),l}));e.view.registerViewExtensions(c,{blockTypeMatcher:function(e){return e===i}})}))}},{key:"destroy",value:function(){var e;null===(e=this.subs)||void 0===e||e.forEach((function(e){return e.unsubscribe()})),this.extensions.forEach((function(e){return e.destroy()}))}}]),r}(B.G),i=s,c=I()(i.prototype,"view",[B.p],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=I()(i.prototype,"context",[w.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=I()(i.prototype,"instantiation",[B.x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=i))||o},dx_tp1j:function(e,n,r){"use strict";r.d(n,"S",(function(){return _}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_h6a8"),v=r("dx_cDcd"),g=r.n(v),b=r("dx_Vau3"),y=r("dx_Z8yN");function m(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var _=function(e){s()(r,e);var n=m(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).heldBlockId=null,e.hold=function(n){e.heldBlockId&&e.blur([e.heldBlockId]),n&&e.focus([n]),e.heldBlockId=n},e}return a()(r,[{key:"focus",value:function(e){var n=this;e.forEach((function(e){n.blockManager.getBlockPath(e).forEach((function(e){var n=r.observers.get(e);null===n||void 0===n||n.forEach((function(e){return e(!0)}))}))}))}},{key:"blur",value:function(e){var n=this;e.forEach((function(e){n.blockManager.getBlockPath(e).forEach((function(e){var n=r.observers.get(e);null===n||void 0===n||n.forEach((function(e){return e(!1)}))}))}))}},{key:"getEffect",value:function(){var e=this;return function(n){var o=n.recursionProps.editPermission,i=Object(v.useCallback)((function(n,r){var o=n.map((function(e){return e.id})).filter((function(n){return e.heldBlockId!==n})),i=r.map((function(e){return e.id})).filter((function(n){return e.heldBlockId!==n})),c=Object(p.intersection)(o,i),a=Object(p.difference)(o,c),l=Object(p.difference)(i,c);e.blur(a),e.focus(l)}),[]),c=Object(v.useCallback)((function(n){var r=(null===n||void 0===n?void 0:n.targetId)||null;e.hold(r)}),[]);return g.a.useEffect((function(){return o&&e.selectionAPI.onSelectionChange(i),function(){o&&e.selectionAPI.offSelectionChange(i)}}),[o,i]),g.a.useEffect((function(){return e.blockManager.addListener(r.HOLD_EVENT,e.hold),function(){e.blockManager.removeListener(r.HOLD_EVENT,e.hold)}}),[]),g.a.useEffect((function(){return e.blockManager.addListener(y.W,c),function(){e.blockManager.removeListener(y.W,c)}}),[c]),null}}}],[{key:"register",value:function(e,n){var o=r.observers.get(e);o?o.add(n):r.observers.set(e,new Set([n]))}},{key:"unregister",value:function(e,n){var o=r.observers.get(e);o&&o.delete(n)}}]),r}(b.A);_.observers=new Map,_.HOLD_EVENT="FocusObserver:Hold"},dx_tq79:function(e,n,r){"use strict";r.d(n,"N",(function(){return y})),r.d(n,"s",(function(){return m})),r.d(n,"y",(function(){return k}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_TSYQ"),s=r.n(l),u=r("dx_NOtv"),d=r.n(u),f=r("dx_h6a8"),h=r("dx_O7Od"),p=r("dx_haL5"),v=r("dx_bbfH"),g=d()("table:header:helper"),b={startCol:-1,startRow:-1,endCol:-1,endRow:-1};function y(e,n){var r,o,c=function(e,n){var r=e.headerIndex,o=e.headerType,c=n.ids,a=n.headerSelectionManager,l=a.headerSelection,s=a.cellSelection,u=s.selectedCells,d=s.focusedCell,h=u||b,v=h.startCol,y=h.startRow,m=h.endCol,_=h.endRow,k=d||{col:-1,row:-1},O=k.col,x=k.row,E=o===p.v.COLUMN?[v,m,O]:[y,_,x],S=i()(E,3),C=S[0],I=S[1],B=S[2],T=function(e,n,r){var o=e.headerIndex,i=e.headerType,c=n;return Boolean(c&&c.headerType===i&&c.selectedLineIds.includes(r[o]))}(e,l,c),w=l&&Object(f.isEqual)(l.focusHeader,e),R=B===r&&!l,M=C<=r&&r<=I&&!l,j=w||R;0===r&&g("getHeaderStatus index=%s.%s focused(cell=%s,header=%s), selected(cell=%s,header=%s)",o,r,R,w,M,T);return{isFocused:j,cellSelected:M,headerSelected:T}}(e,n),l=c.isFocused,u=c.cellSelected,d=c.headerSelected;return{isFocused:l,headerSelected:d,headerCls:s()(v.q.TABLE_HEADER,(r={},a()(r,v.q.TABLE_HEADER_SELECTED,d),a()(r,v.q.TABLE_HEADER_FOCUSED,l),a()(r,v.q.TABLE_HEADER_CELL_SELECTED,u),r)),resizeBtnCls:s()("table-resizer-button",(o={},a()(o,h.T,!0),a()(o,"table-resizer-button--selected",d),o))}}function m(e){var n=function(e){return e===p.v.COLUMN?p.J.COL:p.J.ROW}(e);return"table-header-bar table-header-bar--".concat(n)}function _(e,n,r){var o=e.getBlockViewByBlockId(n).hostElement.querySelectorAll(r);if(o.length){var i=document.createRange();i.setStart(o[0],0);var c=o[o.length-1];return i.setEnd(c,c.childNodes.length),i}}function k(e,n){return _(e,n,".".concat(v.q.TABLE_HEADER_SELECTED))}},dx_tsDa:function(e,n,r){"use strict";r.d(n,"U",(function(){return _})),r.d(n,"e",(function(){return k})),r.d(n,"b",(function(){return O})),r.d(n,"t",(function(){return x})),r.d(n,"Z",(function(){return C})),r.d(n,"U9",(function(){return I})),r.d(n,"A",(function(){return B}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_RIqP"),a=r.n(c),l=r("dx_NOtv"),s=r("dx_yzqx"),u=r("dx_B28d"),d=r("dx_BEcL"),f=r("dx_QBqw"),h=r("dx_HirW");function p(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function v(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?p(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function g(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return b(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function b(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var y=Object(l.debug)("clipboard/utils/table"),m=function(e){return(null===e||void 0===e?void 0:e.type)===u.B.CELL};function _(e,n){return n.every((function(n){return m(e.getBlockModelByBlockId(n.id))}))}function k(e,n){return!!n[0]&&O(e,n[0].id)}function O(e,n){if(!e.hasBlockModelByBlockId(n))return!1;var r=e.getBlockPath(n);return[].concat(a()(r),[n]).reverse().some((function(n){return m(e.getBlockModelByBlockId(n))}))}function x(e,n){var r=n.map((function(n){return e.getBlockViewByBlockId(n).cellId})),o=e.getBlockModelByBlockId(n[0]).parent,i=null===o||void 0===o?void 0:o.record.snapshot,c=Object(f.c)(i),a=Object(f.xp)({cellIds:r,layoutInfo:c,snapshot:i}),l=a.startRow,s=a.startCol,u=l*i.columns_id.length+s,d=null===o||void 0===o?void 0:o.children[u];return null===d||void 0===d?void 0:d.id}var E={check:function(){return!0},handle:function(e,n,r,o){var i=n[r].snapshot,c=Object.keys(i.cell_set),a=e.map((function(e){return c.find((function(n){return i.cell_set[n].block_id===e}))})).filter(Boolean),l=Object(f.xp)({cellIds:a,layoutInfo:Object(f.c)(i),snapshot:i}),s=l.startRow,u=l.startCol,d=l.endRow,p=l.endCol,b=i.rows_id.slice(s,d+1),y=i.columns_id.slice(u,p+1);n[r].snapshot.rows_id=b,n[r].snapshot.columns_id=y,e.splice(0,e.length,r);var m,_=g(b);try{for(_.s();!(m=_.n()).done;){var k,O=m.value,x=g(y);try{for(x.s();!(k=x.n()).done;){var E=k.value,S=i.cell_set["".concat(O).concat(E)].block_id;if(!n[S]){var C=Object(h.lj)(o,S)[S],I=C.snapshot;n[S]=v(v({},C),{},{snapshot:v(v({},I),{},{children:[],comments:[]})})}}}catch(B){x.e(B)}finally{x.f()}}}catch(B){_.e(B)}finally{_.f()}}},S=[{check:function(e,n,r){var o=e.map((function(e){var n=r.getBlockIdsByRecordId(e)[0];return r.getBlockViewByBlockId(n)})),i=r.getBlockIdsByRecordId(n)[0],c=r.getBlockModelByBlockId(i),a=Object(f.o)(o,c),l=a.allSelectedColIndexes,s=a.allSelectedRowIndexes,u=l.length,d=s.length;return!(!u&&!d||1===u||1===d)&&(!u&&d||u&&!d)},handle:function(e,n,r,o){var i=e.map((function(e){var n=o.getBlockIdsByRecordId(e)[0];return o.getBlockViewByBlockId(n)})),c=o.getBlockIdsByRecordId(r)[0],a=o.getBlockModelByBlockId(c),l=a.record.snapshot,s=l.columns_id,u=l.rows_id,d=Object(f.o)(i,a),h=d.allSelectedColIndexes,p=d.allSelectedRowIndexes,v=h.length&&!p.length,g=!h.length&&p.length;if(!v&&!g)return E.handle(e,n,r,o);var b=g?p.map((function(e){return u[e]})):u,y=v?h.map((function(e){return s[e]})):s;n[r].snapshot.rows_id=b,n[r].snapshot.columns_id=y,e.splice(0,e.length,r)}},E];function C(e,n,r){if(e.every((function(e){var r;return(null===(r=n[e])||void 0===r?void 0:r.snapshot.type)===u.B.CELL}))){var o=Object.keys(n).find((function(e){return n[e].snapshot.type===u.B.TABLE}));if(!o)return;var i,c=g(S);try{for(c.s();!(i=c.n()).done;){var a=i.value;if(a.check(e,o,r))return void a.handle(e,n,o,r)}}catch(l){c.e(l)}finally{c.f()}}}function I(e,n,r){if(y(".tryDeleteCellContent: blockIds=%o",n),B(e,n)){var o=function(){e.applyTransaction("cellCutAction",(function(r){var o,i=g(n);try{for(i.s();!(o=i.n()).done;){var c=o.value,a=e.getBlockModelByBlockId(c);Object(d.n)(r,a.record.id)}}catch(l){i.e(l)}finally{i.f()}}))};try{var i=n.map((function(n){return e.getBlockViewByBlockId(n)})),c=e.getBlockModelByBlockId(i[0].parentId),a=c.record.snapshot,l=a.columns_id,u=a.rows_id,h=i.length,p=l.length,b=u.length;if(h<Math.min(p,b))return o(),!0;var m=Object(f.o)(i,c),_=m.allSelectedColIndexes,k=m.allSelectedRowIndexes;if(!k.length&&!_.length)return o(),!0;var O={layoutInfo:Object(f.c)(c.record.snapshot),blockManager:e,tableId:c.id};Object(f.S)(_,k,p,b,{tableBlock:c,blockManager:e,selectionAPI:r});var x=function(){var e=_.length===p;Object(d.x)(v(v({},O),{},{target:_})),!e&&Object(d.O)(v(v({},O),{},{target:k}))};s.Z.isIPad?setTimeout(x,0):x()}catch(E){console.error("[doc table cut error]",E)}return!0}}function B(e,n){return n.every((function(n){return m(e.getBlockModelByBlockId(n))}))}},dx_tt0H:function(e,n,r){"use strict";r.d(n,"U",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("edit-checker")},dx_tuYG:function(e,n,r){},dx_tylp:function(e,n,r){"use strict";function o(e,n){var r=function r(){e.removeEventListener("transitionend",r),n.onEnd()};if(n.beforeStart(),!n.animationEnabled)return n.onStart(),void n.onEnd();requestAnimationFrame((function(){n.onStart(),e.addEventListener("transitionend",r)}))}r.d(n,"b",(function(){return o}))},dx_u2Th:function(e,n,r){"use strict";r.d(n,"e",(function(){return j}));var o,i=r("dx_lSNA"),c=r.n(i),a=r("dx_VkAN"),l=r.n(a),s=r("dx_RIqP"),u=r.n(s),d=r("dx_J4zp"),f=r.n(d),h=r("dx_vF1F"),p=r("dx_PcQO"),v=r("dx_h6a8"),g=r("dx_cDcd"),b=r.n(g),y=r("dx_bdgK"),m=r("dx_C7Cb"),_=r("dx_TfZh"),k=r("dx_UTG8"),O=r("dx_D2DF"),x="\n  min-height:0 !important;\n  max-height:none !important;\n  height:0 !important;\n  visibility:hidden !important;\n  overflow:hidden !important;\n  position:absolute !important;\n  z-index:-1000 !important;\n  top:0 !important;\n  border: none !important;\n  right:0 !important\n",E=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","font-variant","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"];function S(e){return Number.isNaN(e)?0:e}function C(e){var n=window.getComputedStyle(e),r=e.style;function o(e){return n.getPropertyValue(e)||r[e]}var i=o("box-sizing")||o("-webkit-box-sizing"),c=S(parseFloat(o("padding-bottom"))+parseFloat(o("padding-top"))),a=S(parseFloat(o("border-bottom-width"))+parseFloat(o("border-top-width")));return{sizingStyle:E.map((function(e){return"".concat(e,":").concat(o(e))})).join(";"),paddingSize:c,borderSize:a,boxSizing:i}}var I=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e)return"";var r=window.getComputedStyle(e);return[].concat(E,u()(n)).map((function(e){return"".concat(e,":").concat(r.getPropertyValue(e))})).join(";")};r("dx_is2H");function B(){var e=l()(["\n                ","\n              "]);return B=function(){return e},e}function T(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function w(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?T(Object(r),!0).forEach((function(n){c()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function R(){var e=l()(["\n            font-size: ","px;\n            display: flex;\n            border: 1px solid;\n            border-radius: 6px;\n            border-color: ",";\n            transition: border-color 0.2s;\n            line-height: 22px;\n            :hover {\n              border-color: ",";\n            }\n            :focus {\n              border-color: ",";\n            }\n          "]);return R=function(){return e},e}function M(){var e=l()(["\n      display: block;\n      width: 100%;\n      color: inherit;\n      background-color: inherit;\n      resize: none;\n      padding: 0;\n      border: 0;\n      margin: 0;\n      outline: none;\n      min-height: 22px;\n\n      &:disabled {\n        color: inherit;\n        opacity: 1;\n      }\n\n      ::-webkit-scrollbar {\n        display: none;\n      }\n    "]);return M=function(){return e},e}var j=b.a.memo(b.a.forwardRef((function(e,n){var r,i,c,a=e.autoFocus,l=e.editable,s=void 0===l||l,d=e.defaultValue,E=e.value,S=e.onChange,T=e.maxLength,j=e.placeholder,D=e.prefix,A=e.prefixStyle,P=e.suffix,L=e.suffixStyle,N=e.className,F=e.style,U=e.size,H=void 0===U?"medium":U,V=e.minRows,W=void 0===V?1:V,z=e.maxRows,G=e.focusedStyle,K=e.recordId,q=Object(g.useRef)(Object(m.S)()),X=Object(g.useRef)(!1),Y=Object(g.useState)("".concat(K,"-").concat(O.h)),J=f()(Y,1)[0],Z=Object(g.useMemo)((function(){return"number"===typeof T?[T,void 0]:Array.isArray(T)&&2===T.length?u()(T):[void 0,void 0]}),[T]),Q=f()(Z,2),$=Q[0],ee=Q[1],te=Object(g.useMemo)((function(){return k.InputPipe.serialize(d).alltext}),[d]),ne=Object(g.useMemo)((function(){if(void 0!==E)return k.InputPipe.serialize(E).alltext}),[E]),re=Object(g.useState)(null!==te&&void 0!==te?te:""),oe=f()(re,2),ie=oe[0],ce=oe[1];Object(g.useEffect)((function(){void 0!==ne&&ce(ne)}),[ne]);var ae=Object(g.useState)({}),le=f()(ae,2),se=le[0],ue=le[1],de=Object(g.useRef)(null);Object(g.useImperativeHandle)(n,(function(){return de.current}));var fe=Object(g.useCallback)((function(){if(de.current){var e=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;o||((o=document.createElement("textarea")).setAttribute("tab-index","-1"),o.setAttribute("aria-hidden","true"),document.body.appendChild(o)),e.getAttribute("wrap")?o.setAttribute("wrap",e.getAttribute("wrap")):o.removeAttribute("wrap");var i=C(e),c=i.paddingSize,a=i.borderSize,l=i.boxSizing,s=i.sizingStyle;o.setAttribute("style","".concat(s,";").concat(x)),o.value=e.value||e.placeholder||"";var u,d=Number.MIN_SAFE_INTEGER,f=Number.MAX_SAFE_INTEGER,h=o.scrollHeight;if("border-box"===l?h+=a:"content-box"===l&&(h-=c),null!==n||null!==r){o.value=" ";var p=o.scrollHeight-c;null!==n&&(d=p*n,"border-box"===l&&(d=d+c+a),h=Math.max(d,h)),null!==r&&(f=p*r,"border-box"===l&&(f=f+c+a),u=h>f?"":"hidden",h=Math.min(f,h))}return{height:h,minHeight:d,maxHeight:f,overflowY:u}}(de.current,W,z);e&&ue(e)}}),[W,z,de]),he=Object(g.useCallback)((function(){fe()}),[fe]),pe=Object(g.useRef)(new y.S(he)),ve=Object(g.useCallback)((function(){X.current=!0}),[]),ge=Object(g.useCallback)((function(){X.current=!1}),[]),be=Object(g.useCallback)((function(e){X.current&&e.stopPropagation()}),[]);Object(g.useEffect)((function(){var e=de.current;return pe.current=new y.S(he),e&&pe.current.observe(e),function(){pe.current.disconnect()}}),[he]),Object(g.useEffect)((function(){var e=de.current;return e&&(e.addEventListener("compositionstart",ve),e.addEventListener("compositionend",ge),e.addEventListener("keydown",be)),function(){e&&(e.removeEventListener("compositionstart",ve),e.removeEventListener("compositionend",ge),e.removeEventListener("keydown",be))}}),[]),Object(g.useLayoutEffect)((function(){fe()}),[ie,fe]);var ye=Object(_.S)((function(e){var n=k.InputPipe.deserializePlainText(e);null===S||void 0===S||S(n)}),200),me=Object(g.useCallback)((function(e){var n=e.target.value,r=n.replace(/\s/g,"");void 0!==$&&r.length>$?ee&&p.toast.error({key:q.current,content:ee}):(ce(n),ye(n))}),[$,ee,ye]),_e=Object(g.useState)(!1),ke=f()(_e,2),Oe=ke[0],xe=ke[1],Ee=Object(g.useCallback)((function(e){s&&de.current&&(e.stopPropagation(),de.current.focus())}),[s,de]),Se=Object(g.useCallback)((function(){xe(!0)}),[]),Ce=Object(g.useCallback)((function(){xe(!1)}),[]);Object(g.useEffect)((function(){a&&s&&de.current&&de.current.focus()}),[de,a,s]);var Ie=Object(g.useMemo)((function(){var e=s?1:0;return{lineHeight:"22px",padding:s?"".concat(("large"===H?9:5)-e,"px ").concat(12-e,"px"):0,borderWidth:e}}),[H,s]),Be=Object(h.Z)(M());return b.a.createElement("div",{className:Object(h.u)(Object(h.Z)(R(),"large"===H?16:14,s&&Oe?null!==(r=null===G||void 0===G?void 0:G.borderColor)&&void 0!==r?r:"var(--B500)":"transparent",null!==(i=null===G||void 0===G?void 0:G.borderColor)&&void 0!==i?i:"var(--B500)",null!==(c=null===G||void 0===G?void 0:G.borderColor)&&void 0!==c?c:"var(--B500)"),N),style:w(w(w({},Ie),Object(v.pickBy)(F,(function(e){return void 0!==e&&""!==e}))),s&&Oe?Object(v.pickBy)(G,(function(e){return void 0!==e&&""!==e})):null),onClick:Ee},D&&b.a.createElement("div",{className:"poll-input-prefix",style:w({display:"flex",justifyContent:"center",marginRight:8,flex:"1 0 auto"},A)},D),b.a.createElement("div",{style:{flex:"1 1 100%",position:"relative"}},b.a.createElement("div",{className:Object(h.u)(Be,Object(h.Z)(B(),I(de.current,["white-space","word-break"])),"poll-input-fake-textarea"),style:{position:"absolute",pointerEvents:"none",color:"transparent"}},ie),b.a.createElement("textarea",{name:J,ref:de,disabled:!s,readOnly:!s,value:ie,onChange:me,placeholder:s?j:"",className:Object(h.u)(Be,"poll-input-textarea"),style:w({lineHeight:"22px",boxSizing:"border-box"},se),onFocus:Se,onBlur:Ce})),P&&b.a.createElement("div",{style:w({display:"flex",justifyContent:"center",marginLeft:8,flex:"1 0 auto"},L)},P))})))},dx_u3Zu:function(e,n,r){"use strict";r.d(n,"c",(function(){return i})),r.d(n,"I",(function(){return c})),r.d(n,"j",(function(){return a})),r.d(n,"n",(function(){return l})),r.d(n,"S",(function(){return s})),r.d(n,"Z",(function(){return u}));var o=r("dx_B28d"),i=function(e){return e.issueKey||""},c=function(e){var n;return(null===(n=e.issueRecordMap.summary)||void 0===n?void 0:n.value)||""},a=function(e){var n=e.issueRecordMap.status;if(!n||!n.property||!n.property.options)return"";var r=n.property.options.selectOptions,o=null===r||void 0===r?void 0:r.find((function(e){return e.id===n.value}));return(null===o||void 0===o?void 0:o.name)||""},l=function(e){var n=e.isDelete,r=i(e),o=c(e),l=a(e);return n?{issueKey:r,summary:"",status:""}:{issueKey:r,summary:o,status:l}};function s(e){return!e||Date.now()-e>144e5}function u(e){return e.type===o.B.JIRA_ISSUE}},dx_u6Hh:function(e,n,r){"use strict";r.d(n,"c",(function(){return a})),r.d(n,"G",(function(){return l})),r.d(n,"Z",(function(){return s})),r.d(n,"z",(function(){return u}));var o=r("dx_UtDZ"),i=r("dx_B28d"),c={bullet:i.B.BULLET,number:i.B.ORDERED,check:i.B.TODO,done:i.B.TODO};function a(e){var n=e.dataset.list;if(void 0!==n){var r={type:"",level:0,isDone:!1};try{var o=n.match(/(\D+)(\d+)/),a=o[1],l=o[2];r.type=c[a]||i.B.BULLET,r.level=Number(l),"done"===a&&(r.isDone=!0)}catch(s){console.error("get list level failed")}return r}}function l(e){var n=e.dataset.href,r=e.parentElement&&"SPAN"===e.parentElement.tagName&&e.parentElement.className.includes("mention");if(!n&&!r)return!1;var i=e.getAttribute("href")||"";return Boolean(Object(o.isSuiteUrl)(i))}function s(e,n){var r=e.querySelectorAll("[".concat(n,"]"));if(!(0===r.length||r.length>1)){var o=r[0].getAttribute(n);if(o){var i;try{i=JSON.parse(o)}catch(c){console.error("parse doc meta detail failed")}return i}}}function u(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"card";e.children?e.children.push(n):e.children=[n];var o={card:"Card",preview:"Preview"};e.data.type=i.B.VIEW,e.data.view_type=o[r],e.alive=!0}},dx_u6uu:function(e,n,r){"use strict";r.d(n,"C",(function(){return i})),r.d(n,"J",(function(){return c})),r.d(n,"n",(function(){return u}));var o,i,c,a=r("dx_lSNA"),l=r.n(a),s=r("dx_mz66");!function(e){e.xigua="xigua",e.youtube="youtube",e.bilibili="bilibili",e.bilibiliBv="bilibili-bv",e.bilibiliBp="bilibili_bp",e.bilibilip="bilibilip",e.youku="youku",e.airtable="airtable",e.baidumap="baidumap",e.autonavi="autonavi",e.gmaps="gmaps",e.tiktok="tiktok",e.figma="figma",e.datastudio="datastudio",e.ad="ad",e.says="says",e.survey="survey",e.trello="trello",e.vimeo="vimeo",e.imgur="imgur",e.speakerdeck="speakerdeck",e.instagram="instagram",e.facebook="facebook",e.googleDrive="googleDrive",e.oneDrive="oneDrive",e.openStreetMap="openStreetMap",e.marvelapp="marvelapp",e.prezi="prezi",e.jinshuju="jinshuju",e.soundcloud="soundcloud",e.spotify="spotify",e.pastebin="pastebin",e.lucidchart="lucidchart",e.drawIO="drawIO",e.modao="modao",e.canva="canva",e.slideshare="slideshare",e.haikudeck="haikudeck",e.upscribe="upscribe",e.wenjuan="wenjuan",e.indify="indify",e.jcode="jcode",e.codepen="codepen",e.tiktokCode="tiktokCode",e.trelloCode="trelloCode",e.vimeoCode="vimeoCode",e.instagramCode="instagramCode",e.facebookCode="facebookCode",e.googleDriveCode="googleDriveCode",e.datastudioCode="datastudioCode",e.openstreetmapCode="openstreetmapCode",e.figmaCode="figmaCode",e.soundcloudCode="soundcloudCode",e.pastebinCode="pastebinCode",e.lucidchartCode="lucidchartCode",e.drawIOCode="drawIOCode",e.slideshareCode="slideshareCode",e.speakerdeckCode="speakerdeckCode",e.haikudeckCode="haikudeckCode",e.feishu_survey="feishu_survey",e.lark_survey="lark_survey",e.tea_bulletin="tea_bulletin",e.tea_bulletin_suffix="tea_bulletin_suffix",e.tea_report="tea_report",e.aeolus="aeolus"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Flexible=1]="Flexible",e[e.Fixed=2]="Fixed",e[e.LeftRight=3]="LeftRight",e[e.UpDown=4]="UpDown",e[e.Down=5]="Down"}(c||(c={}));var u=(o={},l()(o,c.Flexible,s.J.Free),l()(o,c.Fixed,s.J.Proportional),l()(o,c.UpDown,s.J.Vertical),o)},dx_uA63:function(e,n,r){"use strict";r.d(n,"F",(function(){return u})),r.d(n,"l",(function(){return d})),r.d(n,"E",(function(){return f})),r.d(n,"K",(function(){return h}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_h6a8"),a=r("dx_cDcd"),l=r.n(a),s=r("dx_amgp");function u(e){if(!l.a.isValidElement(e))throw new Error("element should be a valid element.");if(e.type===l.a.Fragment)throw new Error("element should be a valid element except a fragment element.");for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return l.a.cloneElement.apply(l.a,[e].concat(r))}function d(e,n){var r=String(e).split("."),o=i()(r,2),c=o[0],a=o[1];return n<=0||!a?parseInt(c,10):parseFloat("".concat(c,".").concat(a.slice(0,Math.min(n,a.length))))}function f(e){var n=e.mode,r=e.percent,o=e.current,i=e.start,a=e.target;return n===s.W.SIMPLE?r:a===i?0:Object(c.round)(100*(o-i)/(a-i))}function h(e){var n=e.percent,r=e.start,o=e.target;return Object(c.round)(n*(o-r)/Math.pow(10,2)+r)}},dx_uFpl:function(e,n,r){"use strict";r.d(n,"X",(function(){return f}));var o=r("dx_PcQO"),i=r("dx_cDcd"),c=r.n(i),a=r("dx_VkAN"),l=r.n(a),s=r("dx_Dtiu");function u(){var e=l()(["\n  color: var(--N600);\n  font-size: 14px;\n  line-height: 22px;\n"]);return u=function(){return e},e}var d=r.n(s).a.div(u()),f=c.a.memo((function(e){var n=e.title,r=e.options,a=void 0===r?[]:r,l=e.defaultValue,s=e.value,u=e.onChange,f=e.disabled,h=void 0!==f&&f,p=e.style,v=e.className,g=Object(i.useCallback)((function(e){null===u||void 0===u||u(e)}),[u]);return c.a.createElement("div",{style:p,className:v},c.a.createElement(d,null,n),c.a.createElement(o.Radio.Group,Object.assign({direction:"vertical",defaultValue:l},"value"in e?{value:s}:null,{disabled:h}),a.map((function(e){return c.a.createElement("div",{style:{marginTop:8},key:e.value,onClick:function(n){n.stopPropagation(),g(e.value)}},c.a.createElement(o.Radio,{value:e.value},e.label))}))))}))},dx_uGy8:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M.667 1.334c0-.369.298-.667.666-.667h1.334c.368 0 .666.298.666.667v1.333a.667.667 0 01-.666.667H1.333a.667.667 0 01-.666-.667V1.334zM6.667 1.334c0-.369.298-.667.666-.667h1.334c.368 0 .666.298.666.667v1.333a.667.667 0 01-.666.667H7.333a.667.667 0 01-.666-.667V1.334zM15.333 1.334a.667.667 0 00-.666-.667h-1.334a.667.667 0 00-.666.667v1.333c0 .368.298.667.666.667h1.334a.667.667 0 00.666-.667V1.334z",fill:"#646A73"});n.S=function(e){return i.a.createElement("svg",c({width:16,height:4,viewBox:"0 0 16 4",fill:"none"},e),a)}},dx_uLXv:function(e,n,r){"use strict";r.d(n,"x",(function(){return k})),r.d(n,"K",(function(){return O}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_RIqP"),s=r.n(l),u=r("dx_yXPU"),d=r.n(u),f=r("dx_lwsE"),h=r.n(f),p=r("dx_W8MJ"),v=r.n(p),g=r("dx_UtDZ"),b=r("dx_h6a8"),y=r("dx_xlCA");function m(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function _(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?m(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var k=function(){function e(n){var r=this;h()(this,e),this.type=n,this.waitMap=new Map,this.fetchMap=new Map,this.cacheMap={},this.debounceFetch=Object(b.debounce)(d()(i.a.mark((function e(){var n,o,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=s()(r.waitMap.keys())).length){e.next=3;break}return e.abrupt("return");case 3:if(n.forEach((function(e){return r.move(e,r.waitMap,r.fetchMap)})),o=_({},r.cacheMap),c=Object(b.difference)(n,Object.keys(r.cacheMap)),r.cacheMap={},!c.length){e.next=21;break}return e.prev=8,e.t0=Object,e.t1={},e.t2=o,e.next=14,r.doFetch(c);case 14:e.t3=e.sent,o=e.t0.assign.call(e.t0,e.t1,e.t2,e.t3),e.next=21;break;case 18:e.prev=18,e.t4=e.catch(8),console.error(r.type,"doFetch error",e.t4);case 21:n.forEach((function(e){var n=r.fetchMap.get(e),i=o[e];if(n){if(!i)return console.warn(r.type,"contentMap id not found",e),n.retryCount<1?(n.retryCount++,r.move(e,r.fetchMap,r.waitMap),void r.debounceFetch()):(r.fetchMap.delete(e),void n.reject(new Error("contentMap id not found ".concat(e))));r.fetchMap.delete(e),n.resolve(i)}else console.warn(r.type,"fetchMap id not found",e)}));case 22:case"end":return e.stop()}}),e,null,[[8,18]])}))),100),this.setCache=function(e,n){r.cacheMap[e]=n},this.clearCache=Object(b.debounce)((function(e){try{delete r.cacheMap[e]}catch(n){}}),20)}return v()(e,[{key:"fetch",value:function(e){if(this.fetchMap.has(e))return this.fetchMap.get(e).result;if(this.waitMap.has(e))return this.waitMap.get(e).result;var n={retryCount:0};return n.result=new Promise((function(e,r){return Object.assign(n,{resolve:e,reject:r})})),this.waitMap.set(e,n),this.debounceFetch(),n.result}},{key:"cache",value:function(e,n){this.cacheMap[e]=n}},{key:"getAndClearCache",value:function(e){var n=this.cacheMap[e];return this.clearCache(e),n}},{key:"move",value:function(e,n,r){var o=n.get(e);n.delete(e),r.set(e,o)}}]),e}();function O(e,n){e&&Object.keys(e).forEach((function(n){var r=e[n];r.due_time=Number(r.due_time)||0,r.update_mill_time=Number(r.update_mill_time)||0,r.completed_milli_time=Number(r.completed_milli_time)||0,r.assignees_detail.forEach((function(e){e.completed_milli_time=Number(e.completed_milli_time)||0,delete e.assigner_id})),delete r.assignee_ids,delete r.follower_ids})),n&&Object.keys(n).forEach((function(e){n[e]&&(n[e].uid=e,y.n.setCache(e,n[e]),null===g.suiteUserManager||void 0===g.suiteUserManager||g.suiteUserManager.addUser(e))}))}},dx_uOSm:function(e,n,r){"use strict";var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_QxNg"),s=r("dx_B28d"),u=r("dx_USRY"),d=r("dx_FvGq"),f=r("dx_D8nn"),h=r("dx_kLTg"),p=r("dx_IWRl"),v=function(){function e(n){var r=this;i()(this,e),this.blockManager=n,this.pathMap=new Map,this.handleBlockMount=function(e){var n=e.blockId,o=e.parentId,i=e.type;if(o){var c=Object(p.b)(r.blockManager,o);if(c&&h.K.has(i)){r.pathMap.set(n,r.blockManager.getBlockPath(n));var a=r.blockManager.getRecordByBlockId(n).id,l=r.blockManager.getRecordByBlockId(c).id,s=h.K.get(i);f.S.emit(h.l,{cellId:l,recordId:a,minWidth:s})}}},this.handleTransaction=function(e){var n=e.options,o=e.recordOps;n.from===l.H.local&&o.forEach((function(e){var n=e.id,o=r.blockManager.getBlockIdsByRecordId(n)[0],i=e.record.snapshot.type===s.B.VIEW,c=Object(p.b)(r.blockManager,o);if(i&&c){var a=r.blockManager.getRecordByBlockId(c).id;e.ops.forEach((function(e){if(Object(p.y)(e)){var r=h.H.get(u.t.Card);f.S.emit(h.l,{cellId:a,recordId:n,minWidth:r})}if(Object(p.Y)(e)){var o=h.H.get(u.t.Preview);f.S.emit(h.l,{cellId:a,recordId:n,minWidth:o})}}))}}))},this.handleBlockUnmount=function(e){var n=e.recordId,o=e.blockId,i=r.pathMap.get(o);if(i){r.pathMap.delete(o);var c=Object(p.b)(r.blockManager,o,i,!0);if(c&&h.K.has(e.type)){var a=r.blockManager.getRecordByBlockId(c).id;f.S.emit(h.W,{cellId:a,recordId:n})}}},this.init()}return a()(e,[{key:"init",value:function(){this.blockManager.addListener(d.T,this.handleBlockMount),this.blockManager.addListener(d.n,this.handleBlockUnmount)}},{key:"destroy",value:function(){this.blockManager.removeListener(d.T,this.handleBlockMount),this.blockManager.removeListener(d.n,this.handleBlockUnmount)}}]),e}();n.S=v},dx_uOsn:function(e,n,r){"use strict";var o=r("dx_J4zp"),i=r.n(o),c=r("dx_cDcd"),a=r("dx_D0JG");n.S=function(e){var n=e.manager,r=e.componentData,o=r.data.source_block_id||r.id,l=n.editorAPI.config.get("isSSR"),s=n.editorAPI.config.get("isShortcut"),u=n.editorAPI.config.get("isPDF"),d=Object(c.useState)((function(){return o&&(l||s||u)?n.getInlineBlockModelByRecordId(o):null})),f=i()(d,2),h=f[0],p=f[1],v=Object(c.useState)(0),g=i()(v,2),b=g[0],y=g[1];return Object(c.useEffect)((function(){var e=n.blockManager,r=function(e){n.isInUsed(e.oldChild)&&y((function(e){return e+1}))},i=o?n.getInlineBlockModelByRecordId(o):null;if(i)return e.addListener(a.Y,r,i.id),function(){e.removeListener(a.Y,r,i.id)}}),[o,n]),Object(c.useEffect)((function(){var e=o?n.getInlineBlockModelByRecordId(o):null;return p(e),function(){e&&n.returnInlineBlockModelByBlockId(e.id)}}),[b,o,n]),null==h||h.isDestroyed?null:n.renderInlineBlockByBlockId(h.id)}},dx_uQZk:function(e,n,r){"use strict";r.d(n,"x",(function(){return re}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_cDf5"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_iWIM"),h=r.n(f),p=r("dx_W7W2"),v=r.n(p),g=r("dx_a1gu"),b=r.n(g),y=r("dx_Nsbk"),m=r.n(y),_=r("dx_QxNg"),k=r("dx_UtDZ"),O=r("dx_h6a8"),x=r("dx_cDcd"),E=r("dx_yzqx"),S=r("dx_z8zm"),C=r("dx_Fimk"),I=r("dx_bPy9"),B=r("dx_B6I0"),T=r("dx_hIkB"),w=r("dx_eGDr"),R=r("dx_Ayao"),M=r("dx_upU1"),j=r("dx_D8nn"),D=r("dx_MlPX"),A=r("dx_RIqP"),P=r.n(A),L=r("dx_J4zp"),N=r.n(L),F=r("dx_C7Cb"),U=r("dx_d2dg"),H=r("dx_ZG9w"),V=r("dx_Vau3"),W=r("dx_k8kI"),z=r("dx_o8Rd"),G=r("dx_BrJR");function K(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function q(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?K(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):K(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function X(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Y(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Y(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Y(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function J(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var Z=function(e){v()(r,e);var n=J(r);function r(){var e;s()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).highlightSet=new Set,e.commentMarkMap=new Map,e.activeCommentId=null,e.delayFallbackCommentIds=new Set,e.activeCommentChangeList=[],e.handleBufferChanged=Object(O.debounce)((function(){var n=e.delayFallbackCommentIds;if(0!==n.size){var r,o=X(e.blockManager.layoutManager.getReconciler().getActiveNodes());try{for(o.s();!(r=o.n()).done;){var i=r.value;if(n.has(i)){var c=e.blockManager.getBlockModelByBlockId(i).record.snapshot.comments;if(c&&Object(O.isArray)(c)&&e.fallbackCommentsWithBlockId(c,i),n.delete(i),0===n.size)return}}}catch(a){o.e(a)}finally{o.f()}}}),100),e.handleCommentReady=function(){e.addMark()},e.handleActivateCommentChange=function(n){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.activeCommentChangeList.includes(n)||e.activeCommentChangeList.push(n),!(e.activeCommentChangeList.length>1)||r){var o=n.prevActiveCommentId,i=n.activeCommentId;o&&e.removeCommentHighlight(o),i?(e.activeCommentId=i,e.addCommentHighlight(i,!0)):e.activeCommentId=null,e.activeCommentChangeList.shift(),e.activeCommentChangeList.length&&e.handleActivateCommentChange(e.activeCommentChangeList[0],!0)}},e.handleAddedComment=function(n){var r=n.commentId;e.fallbackComment(r),e.addCommentMark(r),e.addCommentHighlightFallback(r)},e.addCommentHighlightFallback=function(n){e.activeCommentId===n&&e.addCommentHighlight(n,!0),setTimeout((function(){e.activeCommentId===n&&e.addCommentHighlight(n,!0)}))},e.handleAddedFallbackComment=function(n){var r=n.commentId;e.fallbackComment(r)},e.handleUpdateComment=function(n){var r=n.commentId,o=e.comment.getCommentByCommentId(r);o&&!Object(M.O)(o)&&e.addCommentMark(r)},e.handleDeleteComment=function(n){var r=n.commentId;e.removeCommentMark(r),e.removeCommentHighlight(r)},e.handleResolveComment=function(n){e.removeCommentMark(n.commentId),e.removeCommentHighlight(n.commentId)},e.restoreCommentHighlight=function(n){n.options.from===_.H.remote&&e.highlightSet.forEach((function(r){e.findCommentsBlock(r,(function(e){e.forEach((function(e){e.record.id===n.record.id&&e.addCommentHighlight(r)}))}))}))},e}return d()(r,[{key:"getEffect",value:function(){var e=this;return function(n){Object(x.useEffect)((function(){return e.comment.on(R.M.COMMENT_READY,e.handleCommentReady),e.comment.on(R.M.ACTIVE_COMMENT_CHANGE_BEFORE_SCROLL,e.handleActivateCommentChange),e.comment.on(R.M.DELETE_COMMENT,e.handleDeleteComment),e.comment.on(R.M.RESOLVE_COMMENT,e.handleResolveComment),e.comment.on(R.M.ADDED_COMMENT,e.handleAddedComment),e.comment.on(R.M.ADDED_FALLBACK_COMMENT,e.handleAddedFallbackComment),e.comment.on(R.M.UPDATE_COMMENT,e.handleUpdateComment),e.blockManager.addListener(W.a,e.handleBufferChanged),e.addMark(),function(){e.activeCommentChangeList.length=0,e.handleBufferChanged.cancel(),e.blockManager.removeListener(W.a,e.handleBufferChanged),e.comment.off(R.M.COMMENT_READY,e.handleCommentReady),e.comment.off(R.M.ACTIVE_COMMENT_CHANGE_BEFORE_SCROLL,e.handleActivateCommentChange),e.comment.off(R.M.DELETE_COMMENT,e.handleDeleteComment),e.comment.off(R.M.RESOLVE_COMMENT,e.handleResolveComment),e.comment.off(R.M.ADDED_COMMENT,e.handleAddedComment),e.comment.off(R.M.ADDED_FALLBACK_COMMENT,e.handleAddedFallbackComment),e.comment.off(R.M.UPDATE_COMMENT,e.handleUpdateComment),e.clearMark()}}),[])}}},{key:"addCommentMark",value:function(e){if(!this.commentMarkMap.has(e)){var n=this.comment.getCommentByCommentId(e);if(!(null===n||void 0===n?void 0:n.parentType)||!n.parentToken){var r=Object(G.B)(e),o=Object(G.j)(r),i=[];o.forEach((function(e){var n=Object(F.S)();z.S.insertRule(e,n),i.push(n)})),this.commentMarkMap.set(e,i)}}}},{key:"addMark",value:function(){var e=this;this.comment.getDocComments(!0).forEach((function(n){var r=n.commentId;e.fallbackComment(r),e.addCommentMark(r)}))}},{key:"clearMark",value:function(){var e,n=X(this.commentMarkMap.keys());try{for(n.s();!(e=n.n()).done;){var r=e.value;this.removeCommentMark(r)}}catch(o){n.e(o)}finally{n.f()}}},{key:"fallbackComment",value:function(e){var n=this;Array.from(this.comment.getRecordsByCommentId(e)||[]).forEach((function(e){var r=n.blockManager.getBlockIdsByRecordId(e),o=n.blockManager.getRecord(e).snapshot.comments;o&&Object(O.isArray)(o)&&r.forEach((function(e){n.blockManager.hasBlockViewByBlockId(e)?n.fallbackCommentsWithBlockId(o,e):n.delayFallbackCommentIds.add(e)}))}))}},{key:"fallbackCommentsWithBlockId",value:function(e,n){var r=this.blockManager.getBlockViewByBlockIdNotCheck(n);if(r&&Object(H.f)(r)){var o=r.model,c=o.zoneState,a=o.zoneId,l={line:0,offset:0,zoneId:a},s=q(q({},c.offsetToPoint(c.totalWidth())),{},{zoneId:a}),u=r.model.getAttributes(l,s).map((function(e){return i()({},e[0],e[1])})).reduce((function(e,n){return Object.assign(e,n)}),{}),d=e.filter((function(e){return!u[Object(M.i)(e)]}));if(d.length){var f=d.reduce((function(e,n){return e[Object(M.i)(n)]="true",e}),{});r.model.setAttributes({start:l,end:s},f,{extra:{shouldCollab:!1}})}}}},{key:"removeCommentMark",value:function(e){if(this.commentMarkMap.has(e)){var n=this.commentMarkMap.get(e);n&&n.forEach((function(e){z.S.deleteRuleById(e)})),this.commentMarkMap.delete(e)}}},{key:"addCommentHighlight",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];!r&&this.highlightSet.has(e)||this.comment.isThirdPartyComment(e)||this.findCommentsBlock(e,(function(r){r.forEach((function(r){r.addCommentHighlight(e),Object(U.k)(r)&&r.record.on(_.Ra.CHANGE,n.restoreCommentHighlight)})),n.highlightSet.add(e)}))}},{key:"removeCommentHighlight",value:function(e){var n=this;this.highlightSet.has(e)&&(this.comment.isThirdPartyComment(e)||this.findCommentsBlock(e,(function(r){r.forEach((function(r){n.activeCommentId&&n.activeCommentId!==e?r.removeCommentHighlight(e,n.activeCommentId):r.removeCommentHighlight(e),Object(U.k)(r)&&r.record.off(_.Ra.CHANGE,n.restoreCommentHighlight)})),n.highlightSet.delete(e)})))}},{key:"findCommentsBlock",value:function(e,n){var r=this,o=this.comment.getRecordsByCommentId(e)||[],i=Array.from(o).reduce((function(e,n){var o=N()(e,2),i=o[0],c=o[1],a=r.blockManager.getBlockIdsByRecordId(n),l=a.filter((function(e){return!r.blockManager.getBlockViewByBlockIdNotCheck(e)}));return[[].concat(P()(i),P()(a)),[].concat(P()(c),P()(l))]}),[[],[]]),c=N()(i,2),a=c[0],l=c[1],s=function(){n(a.reduce((function(e,n){var o=r.blockManager.getBlockViewByBlockIdNotCheck(n);return o?[].concat(P()(e),[o]):e}),[]))};l.length?this.blockManager.layoutManager.renderNodeById(l).then((function(){return s()})).catch((function(e){console.info("[CommentModule] RenderNodeError:".concat(JSON.stringify(e))),s()})):s()}}]),r}(V.A);function Q(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function $(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Q(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ee(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return te(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return te(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function te(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function ne(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var re=function(e){v()(r,e);var n=ne(r);function r(){var e;s()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).lastSelectionChangeTrigger=new B.o,e.commentNewAlignFgEnabled=Object(k.getMinaConfig)("ccm.docx.comment.new_click_content_align",!1),e.preSelection=[],e.activateCommentSelection=null,e.isCheckCommentShow=!1,e.handleCheckCommentModeChange=function(n){var r=n.shown;e.isCheckCommentShow=r},e.handleFixCursor=function(){if(e.activateCommentSelection){var n=e.options.selectionAPI,r=n.getSelection();Object(O.isEqual)(r,e.activateCommentSelection)||n.setSelection(e.activateCommentSelection),e.activateCommentSelection=null}},e.handleRecordChange=function(n){var r,o=e.preSelection,i=ee(n.recordOps);try{var c=function(){var n,i=r.value,c=ee(i.ops);try{for(c.s();!(n=c.n()).done;){if("type"===n.value.p[0]&&o.find((function(n){return e.blockManager.getBlockIdsByRecordId(i.id).includes(n.id)})))return{v:e.comment.deactivateComment(w.Fr.blockTurnInto)}}}catch(a){c.e(a)}finally{c.f()}};for(i.s();!(r=i.n()).done;){var l=c();if("object"===a()(l))return l.v}}catch(s){i.e(s)}finally{i.f()}},e.handleSelectionChange=function(n,r){if(Object(S.E)(k.store.getState())!==T.h.PAGINATION){if(e.preSelection=n,1!==r.length){var o;if(Object(G.d)(null===(o=window.getSelection())||void 0===o?void 0:o.focusNode))return;return e.activeCommentId&&e.comment.deactivateComment(w.Fr.hasNoSelectedBlock),e.activeCommentId=null,void(e.activateCommentSelection=null)}var i=r[0],c=i.id,a=i.selection,l=e.blockManager.getBlockModelByBlockIdNotCheck(c);if(l){var s=l.recordId,u=e.comment.getCommentsByRecordId(s);if(u&&u.size)if(l.zoneState){var d=l.zoneState,f=d.getModelText().length,h=a||{start:0,end:f-1},p=h.start,v=h.end,g=v;p===v&&(g=Math.min(v+1,f));var b=$($({},d.offsetToPoint(p)),{},{zoneId:d.getZoneId()}),y=$($({},d.offsetToPoint(g)),{},{zoneId:d.getZoneId()}),m=Object(I.e)(l.zoneState,{start:b,end:y}),_=e.activeCommentId&&Object(M.i)(e.activeCommentId);if(_&&m[_])return;var O=e.comment.getDocComments(!0);for(var x in m){var B="";if(x.startsWith(w.Zz)?B=x.slice(w.Zz.length):x.startsWith(w.i7)&&(B=x.slice(w.i7.length)),B&&O.has(B)){if(p===v&&(e.activateCommentSelection=r),Object(C.N)("ccm_comment_view",{source:"text_click",comment_type:"part_comment"}),e.activeCommentId!==B){var R=Object(k.selectCheckCommentShown)(k.store.getState()),j=e.commentNewAlignFgEnabled&&!R&&!E.S.isLarkFeed;e.comment.activateComment(B,void 0,w.M.interaction,void 0,void 0,j?r[0]:void 0),e.activeCommentId=B}return}}if(e.isCheckCommentShow)return;e.activeCommentId&&(e.comment.deactivateComment(w.Fr.selectionOutOfComment),e.activeCommentId=null)}else{var D=e.comment.getPositionList().find((function(n){var r,o=n.commentId;return u.has(o)&&!(null===(r=e.comment)||void 0===r?void 0:r.isThirdPartyTypeComment(o))}));D&&e.activeCommentId!==D.commentId&&(e.comment.activateComment(D.commentId,void 0,w.M.interaction),e.activeCommentId=D.commentId)}else{if(e.isCheckCommentShow)return;e.activeCommentId&&(e.comment.deactivateComment(w.Fr.selectedBlockHasNoComment),e.activeCommentId=null)}}}},e.handleHoverCommentChange=function(n){var r=n.hoverCommentId,o=n.prevHoverCommentId,i=n.activeCommentId;o&&o!==i&&o&&e.removeCommentHighlight(o),r&&e.addCommentHighlight(r)},e}return d()(r,[{key:"getEffect",value:function(){var e=this,n=h()(m()(r.prototype),"getEffect",this).call(this);return function(r){n(r),Object(x.useEffect)((function(){return e.lastSelectionChangeTrigger.init(e.handleSelectionChange),e.selectionAPI.onSelectionChange(e.lastSelectionChangeTrigger.handleSelectionChange),e.comment.on(R.M.HOVER_COMMENT_CHANGE,e.handleHoverCommentChange),e.blockManager.recordManager.on(_.q.CHANGE,e.handleRecordChange),j.S.on(D.g.DOC_COMMENT_SHOW_CHANGE_TRANSITION_END,e.handleFixCursor),k.EventEmitter.on("CHECK_COMMENT_TOGGLE",e.handleCheckCommentModeChange),function(){e.selectionAPI.offSelectionChange(e.lastSelectionChangeTrigger.handleSelectionChange),e.comment.off(R.M.HOVER_COMMENT_CHANGE,e.handleHoverCommentChange),e.blockManager.recordManager.off(_.q.CHANGE,e.handleRecordChange),j.S.off(D.g.DOC_COMMENT_SHOW_CHANGE_TRANSITION_END,e.handleFixCursor),k.EventEmitter.off("CHECK_COMMENT_TOGGLE",e.handleCheckCommentModeChange),e.lastSelectionChangeTrigger.destroy()}}),[])}}}]),r}(Z)},dx_uSID:function(e,n,r){"use strict";var o=r("dx_IoVS");r.d(n,"FallbackBlockReactModule",(function(){return o.y}));r("dx_Qhqg")},dx_uT6L:function(e,n,r){"use strict";(function(t){var e,o=r("dx_J4zp"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_PcQO"),s=r("dx_UtDZ"),u=r("dx_cDcd"),d=r.n(u),f=r("dx_lg5u"),h=r("dx_bUYd"),p=r("dx_H1q2"),v=r("dx_imty"),g=r("dx_g0R0"),b=r("dx_D8nn"),y=r("dx_vW17"),m=r("dx_S0qQ"),_=r("dx_bME5"),k=(r("dx_qVXE"),e={},a()(e,p.x.RefreshOnly,[m.n.REFRESH,m.n.CANCEL]),a()(e,p.x.CopyRefresh,[m.n.CONTACT,m.n.COPY,m.n.REFRESH,m.n.CANCEL]),a()(e,p.x.ContactUs,[m.n.CONTACT,m.n.REFRESH,m.n.CANCEL]),a()(e,p.x.PermissionDenied,[m.n.COPY,m.n.REFRESH,m.n.CANCEL]),a()(e,p.x.OverLimit,[m.n.CREATE,m.n.REFRESH]),e),O=function(){return b.S.emit(v.H.CopyAll,(function(e){Object(_.F)(m.K.COPY,e?y.p:y.q),Object(h.y)({type:e?"success":"error",content:t(e?"CreationDoc_DocX_Copied_Toast":"CreationDoc_DocX_CopiedFailed_Toast"),errorContext:Object(g.G)(new Error("handleCopy failed!"))})}))},x=function(){Object(_.F)(m.K.REFRESH),location.reload()},E=function(){Object(_.F)(m.K.CONTACT),s.feedbackHelper.clickFeedBack()};n.S=function(e){var n=e.type,r=e.code,o=e.editable,c=e.onUnmount,a=e.getErrorContext,h=Object(u.useState)(!1),v=i()(h,2),b=v[0],y=v[1],S=o&&!!document.queryCommandSupported&&["copy","cut"].every((function(e){return document.queryCommandSupported(e)})),C=(k[r]||k[n]||k[m.n.CONTACT]).filter((function(e){return!(!S&&e===m.n.COPY)})).map((function(e){switch(e){case m.n.CONTACT:return d.a.createElement(l.Button,{onClick:E},t("CreationDoc_DocX_ContactSupport_Button"));case m.n.COPY:return d.a.createElement(l.Button,{onClick:O},t("CreationDoc_DocX_CopyContent_Button"));case m.n.REFRESH:return d.a.createElement(l.Button,{type:"primary",onClick:x,style:{marginLeft:12}},t("CreationDoc_DocX_Refresh_Button"));case m.n.CREATE:return d.a.createElement(l.Button,{onClick:function(){y(!0),Object(_.F)(m.K.CREATE),s.store.dispatch(Object(s.createBlankFile)({isCtrlOrMetaKeyClicked:!1,createType:s.NUM_SUITE_TYPE.DOCX,isFromTemplateCenter:!1,type:"CREATE"}))},loading:b},t("CreationDoc_Alert_CopyAll_NewDocs_btn"));default:return null}})).filter(Boolean),I=Object(g.U)();console.log("show oops modal. editable: ".concat(o,", supportCopy: ").concat(S)),Object(u.useEffect)((function(){Object(_.D)(n)}),[]);var B=I?d.a.createElement("div",{className:"oops-modal__content__copy",onClick:function(){return function(){var e=a();Object(g.v)(e)}()}},t("CreationDoc_DocX_BugReport_Copy")):null,T=d.a.createElement("div",{className:"oops-modal__footer"},C.length>2?C[0]:d.a.createElement("div",null),d.a.createElement("div",{className:"oops-modal__footer-right"},C.length>2?C.slice(1):C)),w=Object(p.V)(n,r,o),R=w.title,M=w.content,j=d.a.createElement("div",{className:"oops-modal__header"},d.a.createElement(f.S,null),d.a.createElement("div",{className:"oops-modal__title"}," ",R," "));return d.a.createElement(l.Dialog,{visible:!0,centered:!0,width:420,header:j,footer:T,keyboardClosable:!1,closable:!1,onAfterClose:c,wrapClassName:"oops-modal"},d.a.createElement("div",{className:"oops-modal__content"},d.a.createElement("div",null,M),B))}}).call(this,r("dx_E9Eu"))},dx_ukKW:function(e,n,r){"use strict";r.d(n,"TM",(function(){return b})),r.d(n,"m",(function(){return y})),r.d(n,"c",(function(){return m})),r.d(n,"T",(function(){return _})),r.d(n,"w",(function(){return k})),r.d(n,"LW",(function(){return O})),r.d(n,"s",(function(){return x})),r.d(n,"Vb",(function(){return E})),r.d(n,"e",(function(){return S})),r.d(n,"U",(function(){return C})),r.d(n,"i",(function(){return I})),r.d(n,"y",(function(){return B})),r.d(n,"o",(function(){return T})),r.d(n,"L",(function(){return w})),r.d(n,"V",(function(){return R}));var o=r("dx_UtDZ"),i=r("dx_T7TM"),c={passport:{origin:window.location.origin,appId:26},drive:{origin:window.location.origin,host:window.location.host,appId:"2002"}},a={passport:{origin:window.location.origin,appId:3932},drive:{origin:window.location.origin,host:window.location.host,appId:"2002"}},l=!i.Z,s={passport:{origin:l?window.location.origin:"https://passport.feishu-boe.cn",appId:26},drive:{origin:l?window.location.origin:"https://box-sdk.feishu-boe.cn",host:l?window.location.host:"box-sdk.feishu-boe.cn",appId:"2002"}},u={passport:{origin:window.location.origin,appId:26},drive:{origin:window.location.origin,host:window.location.host,appId:"2002"}},d=(i.V&&i.Y||(i.V||i.T),r("dx_yzqx")),f=r("dx_Bv2G"),h=r("dx_Mtob");r("dx_xs2W"),r("dx_J4zp");function p(e,n,r){if(!r)return e;var o=new RegExp("([?&])".concat(n,"=.*?(&|$)"),"i"),i=-1!==e.indexOf("?")?"&":"?";return e.match(o)?e.replace(o,"$1".concat(n,"=").concat(r,"$2")):"".concat(e+i+n,"=").concat(r)}var v;!function(e){e.EQUAL="equal",e.ALLOW_DOWN="allow_down",e.NEAR="near",e.ALLOW_UP="allow_up",e.ALLOW_UP_DEFAULT="allow_up_default"}(v||(v={}));var g=/\/api\/box\/stream\/download\/(?:v\d+\/)?(all|cover)\/(\w*)/;function b(e){return!!e&&g.test(e)}function y(e){return Object.keys(e).filter((function(n){return void 0!==e[n]})).map((function(n){return"".concat(n,"=").concat(encodeURIComponent("".concat(e[n])))})).join("&")}function m(e){var n=e.fileId,r=e.recordId,o=e.width,i=e.height,c=e.scale,a=e.imageType,l=e.forceCover,s=void 0!==l&&l;if(!n)return"";if(d.S.isMobile){var u=_(n,r);return u=function(e,n,r){return e=p(e,"width","".concat(n)),e=p(e,"height","".concat(r))}(u,o,i),u=p(u,"type","image"),u=p(u,"scale","".concat(c)),a&&(u=p(u,"contentType",a.split("/")[1]||"")),u}return s||!x(a)&&!k(o,i)?_(n,r,{policy:v.EQUAL,fallback_source:1,width:1280,height:1280}):_(n,r)}function _(e,n,r){var c={mountPoint:{type:f.O.IMAGE,token:n},coverOptions:r},a=Object(o.getDriveImageUrl)(e,c);if(i.T){var l=new URL(a);a="".concat(location.origin).concat(l.pathname).concat(l.search)}return O(a)}function k(e,n){return n>1280&&1280*e/n<730}function O(e){return d.S.ios?e.replace(/https?:/,location.protocol):e}function x(e){return"image/gif"===e}function E(e){var n=e.mimeType,r=e.size;return x(n)&&r>h.j}function S(e){var n=e.slice(0,4);n=new Uint8Array(n);for(var r=[],o=0;o<n.byteLength;o++)r.push(n[o].toString(16));return function(e){switch(e){case"89504E47":return"image/png";case"47494638":return"image/gif";case"FFD8FFDB":case"FFD8FFE0":case"FFD8FFE1":case"FFD8FFE2":case"FFD8FFE3":case"FFD8FFE8":return"image/jpeg";case"52494646":return"image/webp";default:return""}}(r.join("").toUpperCase())}function C(e){var n=e.data,r=e.key,o=e.algorithm,i=e.iv;return new Promise((function(e,c){if(crypto&&crypto.subtle){var a=I(r),l=new Uint8Array(i),s=new Uint8Array(n);crypto.subtle.importKey("raw",a,o,!1,["decrypt"]).then((function(e){return crypto.subtle.decrypt({name:o,iv:l},e,s)})).then(e).catch(c)}else c(new Error("[image plugin] can't decrypt for not support web crypto."))}))}function I(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=atob(e),r=n.length,o=new Uint8Array(r),i=0;i<r;i++)o[i]=n.charCodeAt(i);return o}var B=!/opendoc=true/.test(location.search)&&d.S.isOpendoc;function T(e){return/^data:image\/\w*;base64,/.test(e)}function w(e){return new Promise((function(n,r){var o=new Image;o.onload=function(){n({isSuccess:!0,imageSize:{width:o.width,height:o.height}})},o.onerror=function(){n({isSuccess:!1,imageSize:{width:0,height:0}})},o.src=e}))}function R(e){for(var n=e.split(","),r=n[0].match(/:(.*?);/)[1],o=r.split("/")[1],i=atob(n[1]),c=i.length,a=new Uint8Array(c);c--;)a[c]=i.charCodeAt(c);return new File([a],"filename.".concat(o),{type:r})}},dx_unUv:function(e,n,r){"use strict";(function(t){r.d(n,"Z",(function(){return p})),r.d(n,"x",(function(){return g})),r.d(n,"c",(function(){return b})),r.d(n,"M",(function(){return y}));r("dx_QU2i");var e=r("dx_d1El"),o=r.n(e),i=r("dx_TQtZ"),c=r("dx_cDcd"),a=r.n(c),l=r("dx_E7E5"),s=r("dx_W6Wt"),u=r("dx_VeJB"),d=r("dx_iLNO"),f=r("dx_yzqx"),h=r("dx_KXll");r("dx_fgPx");function p(e){var n=e.size,r=e.status;return"failure"===r?a.a.createElement("div",{className:"save-tip"},a.a.createElement(l.S,{className:"icon"}),a.a.createElement("span",{className:"desc"},t("mention.saved_failure"))):"saving"===r?a.a.createElement("div",{className:"save-tip saving"},a.a.createElement(s.S,{className:"icon"}),a.a.createElement("span",{className:"desc"},t("mention.saving"))):a.a.createElement("div",null,Object(h.h)(n,!0))}var v=Object(d.J)(i.S);function g(e){var n=e.onClick,r=e.isPresentationMode;return a.a.createElement("div",{className:"btn-preview tooltip-host",onClick:n},f.S.isMobile?a.a.createElement(i.S,null):a.a.createElement(o.a,{title:t("mention.preview")},a.a.createElement(v,{isPresentationMode:r})))}function b(){return a.a.createElement("div",{className:"rotate-loading"})}function y(e){var n=e.progress;return a.a.createElement("div",{className:"progress"},a.a.createElement("div",{className:"progress-text"},n,"%"),a.a.createElement(u.S,{progress:n}))}}).call(this,r("dx_E9Eu"))},dx_upU1:function(e,n,r){"use strict";r.d(n,"S",(function(){return T})),r.d(n,"i",(function(){return w})),r.d(n,"y",(function(){return R})),r.d(n,"l",(function(){return M})),r.d(n,"a",(function(){return j})),r.d(n,"t",(function(){return D})),r.d(n,"O",(function(){return A})),r.d(n,"d",(function(){return P})),r.d(n,"x",(function(){return L})),r.d(n,"v",(function(){return N})),r.d(n,"J",(function(){return F})),r.d(n,"k",(function(){return U})),r.d(n,"V",(function(){return H})),r.d(n,"m",(function(){return V})),r.d(n,"L",(function(){return W})),r.d(n,"q",(function(){return z})),r.d(n,"u",(function(){return G})),r.d(n,"j",(function(){return q})),r.d(n,"GF",(function(){return X})),r.d(n,"I",(function(){return Y})),r.d(n,"c",(function(){return J})),r.d(n,"G",(function(){return Z})),r.d(n,"n",(function(){return Q})),r.d(n,"tQ",(function(){return $}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_RIqP"),s=r.n(l),u=r("dx_M30o"),d=r("dx_e4eN"),f=r("dx_UtDZ"),h=r("dx_AA3h"),p=r("dx_C7Cb"),v=r("dx_yzqx"),g=r("dx_B28d"),b=r("dx_IdzY"),y=r("dx_WXfY"),m=r("dx_ZG9w"),_=r("dx_UTG8"),k=r("dx_qx8A"),O=r.n(k),x=r("dx_eGDr");function E(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function S(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?E(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function C(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return I(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return I(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function I(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}var B=new RegExp(/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i),T=function(){return Object(p.S)()},w=function(e){return"comment-id-".concat(e)},R=function(e){return"".concat(b.I,"comment-id-").concat(e)},M=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.zoneState,i=r?R(n):w(n),c=null,a=o.getEntities([[i,"true"]]);return a.length>0&&a.forEach((function(n){var r=e.rangeToPosition(n);r&&(c?c[1]=r.start+r.len:c=[r.start,r.start+r.len])})),c},j=function(e,n){var r,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=_.InputPipe.serialize(e.snapshot.text),c=o?R(n):w(n),a=0,l=null,s=C(i.nodes);try{for(s.s();!(r=s.n()).done;){var u=r.value;if(!l&&u.mark&&u.mark[c])l=[a,u.text.length];else if(l&&u.mark&&u.mark[c])l[1]=a+u.text.length;else if(l&&(!u.mark||!u.mark[c]))return l;a+=u.text.length}}catch(d){s.e(d)}finally{s.f()}return l},D=function(e){return 1===e.isWhole||!0===e.isWhole},A=function(e){return 1===e.finish||!0===e.finished},P=function(e){return e.tempCommentId||e.tmpCommentId||""},L=function(e,n){return e.filter((function(e){var r=D(e),o=A(e),i="all"===n.type||("doc"===n.type?!r:r),c=!n.filterOutFinished||!o;return i&&c})).reduce((function(e,n){return e.set(n.commentId,n),e}),new Map)},N=function(e){return new Set(Object.values(e.apool.numToAttrib).filter((function(e){return e[0].startsWith("comment-id-")})).map((function(e){return e[0].slice("comment-id-".length)})))},F=function(e,n){return{deletedSet:new Set(s()(e).filter((function(e){return!n.has(e)}))),addedSet:new Set(s()(n).filter((function(n){return!e.has(n)})))}};function U(e,n){return Object(m.i)(e)?O.a.getState().appState.translate.status.translated?Object(y.Z)(e,n.recordManager):Object(y.X)(e.record.snapshot,n.recordManager):e.getText()}var H=function(e){return B.test(e)},V=function(e,n){if(!e)return!1;var r=n.getBlockModelByBlockId(e);return!!r.parent&&r.record.snapshot.type===g.B.FILE&&r.parent.record.snapshot.type!==g.B.VIEW},W=function(e,n){var r=V(e,n),o=function(e,n){return!!e&&n.getBlockModelByBlockId(e).type===g.B.JIRA_ISSUE}(e,n);return r||o},z=function(e){var n=e.model.snapshot,r=n.comments,o=n.text.apool.numToAttrib,i=Object.values(o).reduce((function(e,n){return Object.assign(e,a()({},n[0],n[1]))}),{});return(r||[]).filter((function(e){return!i[w(e)]}))},G=function(e,n,r,o){var i,c=n.isShow(e);if(c)return{blockRect:i=r.getBlockRect(e),visible:c};var a=n.findFoldedByBlock(e);if(!a)return{blockRect:i=r.getBlockRect(e),visible:c};var l=o.hasBlockModelByBlockId(a)&&o.getBlockModelByBlockId(a);if(l&&Object(m.i)(l)){var s=l.zoneState&&l.zoneState.totalWidth(),u=s>0?s-1:0;i=r.getRangeRect(a,[u,u])}else i=r.getBlockRect(a);return{blockRect:i,visible:c}};function K(e,n){return e.reduce((function(e,r){return e.push(r),e.push.apply(e,s()(n.findFoldedBlocks(r))),e}),[])}var q=function(e,n){return[e.rootBlockId].concat(s()(K(e.layoutManager.getViewportBlocks(),n)),s()(K(e.layoutManager.getBufferBlocks(),n)))},X=function(e,n,r){var o,i,c=r.getBlockModelByBlockId(e.blockId),a=r.getBlockModelByBlockId(n.blockId);return V(c.id,r)&&(null===(o=c.parent)||void 0===o?void 0:o.id)===a.id?n:V(a.id,r)&&(null===(i=a.parent)||void 0===i?void 0:i.id)===c.id?e:null};function Y(e,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=e.editor,c=e.model,l=w(n),s=R(n),f=[l,s],h=w(o),p=R(o),v=[h,p],g={},b=c.zoneState.getEntities((function(e){return!!f.includes(e)}));r&&""!==o&&(b=b.filter((function(e){return!v.some((function(n){return!!e.attributes[n]}))}))),b.length&&(g[c.zoneId]=b);var y=new u.q;Object.keys(g).forEach((function(e){var n=0;g[e].forEach((function(o){var i=c.rangeToPosition(o);i||(i={start:0,len:0});var l=i,s=l.start,u=l.len,f=s-n,h=y.get(e)||new d.m({zoneId:e});h.retain(f),h.retain(u,a()({},x.l4,r?"":"true")),y.get(e)?y.replace(e,h):y.add(e,h),n+=f+u}))})),i.setStopUpdateSelection(!0);try{e.model.apply(y,{extra:{shouldCollab:!1}})}catch(m){console.error("[CommentModule] apply highlight error",m)}setTimeout((function(){i.setStopUpdateSelection(!1)}),0)}var J=function(e,n){var r,o,c=i()(e,2),a=(c[0],c[1]),l=i()(n,2),s=(l[0],l[1]);return a.top<s.top?-1:a.top===s.top?(null!==(r=a.caretLeft)&&void 0!==r?r:a.left)-(null!==(o=s.caretLeft)&&void 0!==o?o:s.left):1},Z=function(){return Object(h.getFgMobileValue)(x.F,!0)};function Q(){return v.S.isInVC&&(v.S.isMobile?Object(f.getMinaConfig)("spacekit.mobile.ccm.docx.vc_comment_disable_scroll",!1):Object(f.getMinaConfig)("ccm.docx.vc_comment_disable_scroll",!1))}function $(e,n){return S(S({},e),{},{caretLeft:e.leftCaretRect.left,top:e.leftCaretRect.top,height:e.bottom-e.leftCaretRect.top,blockId:n})}},dx_uqnA:function(e,n,r){"use strict";(function(t){r.d(n,"z",(function(){return X}));var e,o,i,c,a,l,s,u,d=r("dx_J4zp"),f=r.n(d),h=r("dx_o0o1"),p=r.n(h),v=r("dx_yXPU"),g=r.n(v),b=r("dx_lSNA"),y=r.n(b),m=r("dx_yG8O"),_=r.n(m),k=r("dx_lwsE"),O=r.n(k),x=r("dx_W8MJ"),E=r.n(x),S=r("dx_Uyc2"),C=r.n(S),I=(r("dx_A1AB"),r("dx_Vvd7")),B=r("dx_QxNg"),T=r("dx_xjz2"),w=r("dx_UtDZ"),R=r("dx_K9Ia"),M=r("dx_gn6w"),j=r("dx_Fimk"),D=r("dx_CwnG"),A=r("dx_x1WV"),P=r("dx_dWtO"),L=r("dx_ppc6"),N=r("dx_D8nn"),F=r("dx_FwAy"),U=r("dx_xI7u"),H=r("dx_qx8A"),V=r.n(H),W=r("dx_DdSJ"),z=r("dx_SMoc"),G=r("dx_QzB0"),K=r("dx_QLXn"),q=0,X=Object(T.s)(G.H)((u=function(){function e(){var n=this;O()(this,e),_()(this,"config",i,this),_()(this,"editorAPI",c,this),_()(this,"selectionAPI",a,this),_()(this,"blockManager",l,this),_()(this,"adapter",s,this),this.id=q++,this.docsMode=W.n.NONE,this.docsModePrefer=W.n.NONE,this.subs=[],this.docsModeChange$=new R.Z,this.docsModePreferChange$=new R.Z,this.handleHistoryStore=function(){n.editable&&!n.editing&&n.handleSwitch(W.n.EDITING,W.T.HISTORY)},this.switchToReading=function(e){return n.handleSwitch(W.n.READING,e)},this.switchToEditing=function(e){return n.handleSwitch(W.n.EDITING,e)},this.handleSwitchListVisibleChange=function(e){e&&Object(j.S)("ccm_doc_header_view_type_setting_view",y()({},"sub_view","view_type_change_panel"))},this.handleEditableChange=function(){n.updateSwitchEntry(),!n.editable&&n.isEditMode&&n.setDocsMode(W.n.READING,!1)},this.handleEditingChange=function(){Object(j.P)(n.editing?"edit":"read")}}return E()(e,[{key:"init",value:function(){var e=g()(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.initData();case 2:this.bindEvent(),this.updateSwitchEntry();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bindEvent",value:function(){N.N.on(U.f,this.handleHistoryStore),w.EventEmitter.on(w.EVENTS.PC.DOCS.DOCS_MODE.SWITCH_TO_READING,this.switchToReading),w.EventEmitter.on(w.EVENTS.PC.DOCS.DOCS_MODE.SWITCH_TO_EDITING,this.switchToEditing),w.EventEmitter.on(w.EVENTS.PC.DOCS.DOCS_MODE.SWITCH_LIST_VISIBLE_CHANGE,this.handleSwitchListVisibleChange),this.subs.push(this.config.change$.subscribe(this.handleEditableChange)),this.subs.push(this.config.change$.subscribe(this.handleEditingChange))}},{key:"unbindEvent",value:function(){N.N.off(U.f,this.handleHistoryStore),w.EventEmitter.off(w.EVENTS.PC.DOCS.DOCS_MODE.SWITCH_TO_READING,this.switchToReading),w.EventEmitter.off(w.EVENTS.PC.DOCS.DOCS_MODE.SWITCH_TO_EDITING,this.switchToEditing),w.EventEmitter.off(w.EVENTS.PC.DOCS.DOCS_MODE.SWITCH_LIST_VISIBLE_CHANGE,this.handleSwitchListVisibleChange),this.subs.forEach((function(e){return e.unsubscribe()}))}},{key:"isDataReady",value:function(){var e=this;return this.editorAPI.modelService.isInitialDataReady()?Promise.resolve(Object(F.S)(this.blockManager)):new Promise((function(n){var r=e.editorAPI.modelService.initialDataReady$.subscribe((function(){r.unsubscribe(),n(Object(F.S)(e.blockManager))}))}))}},{key:"isPermissionReady",value:function(){return Object(w.selectCurrentSuiteRawUserActionList)(V.a.getState())?Promise.resolve():new Promise((function(e){var n=V.a.subscribe((function(){Object(w.selectCurrentSuiteRawUserActionList)(V.a.getState())&&(n(),e())}))}))}},{key:"isConfigReady",value:function(){var e=g()(p.a.mark((function e(){var n,r,o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=new Map).set(W.L.READING_MODE_PREFERENCE,this.id?null:Object(K.X)(W.L.READING_MODE_PREFERENCE)),n.set(W.L.READING_MODE,this.id?null:Object(K.X)(W.L.READING_MODE)),r=[W.L.READING_MODE_PREFERENCE,W.L.READING_MODE],o=[],r.forEach((function(e){var r=n.get(e);r&&r!==W.n.UNKNOWN||o.push(e)})),!o.length){e.next=17;break}return e.prev=7,e.next=10,Object(P.W)({scene:o,token:this.token});case 10:i=e.sent,r.forEach((function(e){n.set(e,Object(K.t)(i[e])?i[e]:W.n.NONE)})),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(7),r.forEach((function(e){n.set(e,W.n.NONE)}));case 17:try{Object(j.S)("ccm_docs_page_view",y()({},"is_memory_view_type",Object(K.t)(n.get(W.L.READING_MODE)).toString()))}catch(c){}return e.abrupt("return",[n.get(W.L.READING_MODE_PREFERENCE),n.get(W.L.READING_MODE)]);case 19:case"end":return e.stop()}}),e,this,[[7,14]])})));return function(){return e.apply(this,arguments)}}()},{key:"initData",value:function(){var e=g()(p.a.mark((function e(){var n,r,o,i,c,a,l,s,u;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.isConfigReady(),this.isDataReady(),this.isPermissionReady()]);case 2:o=e.sent,i=f()(o,2),c=f()(i[0],2),a=c[0],l=c[1],s=i[1],u=Object(K.o)({editable:this.editable,docsMemory:l,docsModePrefer:a,isEmptyDocs:s,scene:W.A.webPC,openFrom:null===(n=(r=w.selectors.share).selectOpenFrom)||void 0===n?void 0:n.call(r,V.a.getState())}),this.setDocsMode(u,!1),this.setDocsModePrefer(a);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){this.unbindEvent()}},{key:"handleSwitch",value:function(e,n){var r,o,i=this;this.setDocsMode(e),Object(P.u)({settings:[{scene:W.L.READING_MODE,setting_value:e}],token:this.token});var c=e!==W.n.EDITING?"change_to_read_view":"change_to_edit_view",a=function(){return Object(j.S)("ccm_doc_content_page_click",y()({click:"chang_doc_view_type",target:"none"},"sub_click",c))};switch(n){case W.T.HEADER:Object(j.S)("ccm_doc_header_view_type_setting_click",{click:c,target:"none"}),a();break;case W.T.TOOLBAR:Object(j.S)("ccm_doc_web_text_bubble_toolbar_click",(r={click:"block_action",target:"none"},y()(r,"action_type","change_to_edit_view"),y()(r,"action_value",{}),y()(r,"object_block_data",this.selectionAPI.getSelection().map((function(e){var n=e.id,r=Object(D.p)(n,i.blockManager);return{object_block_id:Object(w.encryptTea)(r.record_id),object_block_type:r.block_type,object_sub_block_type:r.sub_block_type,block_content_size:r.block_content_size}}))),r)),a();break;case W.T.TOAST:Object(j.S)("ccm_docs_toast_click",(o={},y()(o,"click","change_to_edit_view"),y()(o,"target","none"),y()(o,"sub_view","change_to_above_edit_permission"),o)),a();break;case W.T.HISTORY:Object(j.S)("ccm_docs_history_page_click",y()({click:"chang_doc_view_type",target:"none"},"sub_click","change_to_edit_view")),a()}}},{key:"updateSwitchEntry",value:function(){this.adapter.setSuitHeaderSwitchShow(this.editable),this.editable&&Object(j.S)("ccm_doc_header_view_type_setting_view",y()({},"sub_view","view_type_change_button"))}},{key:"getDocsMode",value:function(){return this.docsMode}},{key:"setDocsMode",value:function(){var e=g()(p.a.mark((function e(n){var r,o=arguments;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(o.length>1&&void 0!==o[1])||o[1],n!==this.docsMode){e.next=3;break}return e.abrupt("return");case 3:return this.docsMode=n,V.a.dispatch(Object(M.N)(this.isEditMode)),this.adapter.setBearDocsMode(this.docsMode),e.next=8,Object(B.E)(0);case 8:this.docsModeChange$.next(n),r&&w.Toast.show({content:t("LarkCCM_DocX_ViewMode_ModeChange_Toast",{},"",this.editing?t("LarkCCM_DocX_ViewMode_SwitchMode_editing"):t("LarkCCM_DocX_ViewMode_SwitchMode_viewing"))});case 10:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"onDocsModeChange",value:function(e){var n=this.docsModeChange$.subscribe(e);return this.subs.push(n),n}},{key:"getDocsModePrefer",value:function(){return this.docsModePrefer}},{key:"setDocsModePrefer",value:function(){var e=g()(p.a.mark((function e(n){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n!==this.docsModePrefer){e.next=2;break}return e.abrupt("return");case 2:return this.docsModePrefer=n,e.next=5,Object(B.E)(0);case 5:this.docsModePreferChange$.next(n);case 6:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"onDocsModePreferChange",value:function(e){var n=this.docsModePreferChange$.subscribe(e);return this.subs.push(n),n}},{key:"token",get:function(){return Object(w.getToken)()}},{key:"editable",get:function(){return this.config.get("editPermission")}},{key:"editing",get:function(){return this.config.get("editable")}},{key:"isEditMode",get:function(){return this.docsMode===W.n.EDITING}}]),e}(),o=u,i=C()(o.prototype,"config",[I.j],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),c=C()(o.prototype,"editorAPI",[I.Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=C()(o.prototype,"selectionAPI",[L.S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),l=C()(o.prototype,"blockManager",[A.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=C()(o.prototype,"adapter",[z.h],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e=o))||e}).call(this,r("dx_E9Eu"))},dx_uqy0:function(e,n,r){},dx_uv4w:function(e,n,r){"use strict";var o=r("dx_p1pN");r.d(n,"v",(function(){return o.v}))},dx_v582:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M4.583 4.95c0-.202.164-.367.367-.367h.642c.202 0 .366.165.366.367v12.1a.367.367 0 01-.366.367H4.95a.367.367 0 01-.367-.367V4.95zM7.792 6.783c0-.202.164-.366.366-.366h2.056c2.46 0 4.453 1.847 4.453 4.125 0 2.03-1.583 3.717-3.667 4.06v1.444a.513.513 0 01-.829.405l-2.775-2.158a.513.513 0 010-.81l2.775-2.16a.513.513 0 01.829.406v1.497c1.311-.275 2.292-1.372 2.292-2.684 0-1.52-1.314-2.75-2.934-2.75h-2.2a.367.367 0 01-.366-.367v-.642zM16.408 4.583a.367.367 0 00-.366.367v12.1c0 .203.164.367.366.367h.642a.367.367 0 00.367-.367V4.95a.367.367 0 00-.367-.367h-.642z",fill:"#646A73"});n.S=function(e){return i.a.createElement("svg",c({width:22,height:22,viewBox:"0 0 22 22",fill:"none"},e),a)}},dx_v7vG:function(e,n,r){"use strict";var o,i=r("dx_lwsE"),c=r.n(i),a=r("dx_W8MJ"),l=r.n(a),s=r("dx_UtDZ"),u=r("dx_eSV8"),d=r("dx_ABiD"),f=r("dx_GPzN");!function(e){e[e.REMOVE_SSR_SUCCESS=0]="REMOVE_SSR_SUCCESS",e[e.RENDER_EDITOR_SUCCESS=1]="RENDER_EDITOR_SUCCESS"}(o||(o={}));var h=function(){function e(){var n=this;c()(this,e),this.extraData=void 0,this.collectRemoveSSRSuccess=function(e){var r=e.current,i=Date.now();n.extraData.isSSRRemoved=1,null!==r&&(n.extraData.removeSSRDuration=i-r),n.collectAllowEditEnd(o.REMOVE_SSR_SUCCESS,i)},this.collectRenderEditorSuccess=function(e){var r;n.extraData.isEditorRendered=1,(null===(r=window.collectParams)||void 0===r?void 0:r.hasSsrRender)||!1||(n.extraData.noSSR=1),n.collectAllowEditEnd(o.RENDER_EDITOR_SUCCESS,e.current||Date.now())},this.init(),s.EventEmitter.on(s.EVENTS.PC.COMMON.PERFORMANCE_STAGE_INIT,this.init)}return l()(e,[{key:"init",value:function(){this.extraData={noSSR:0,isSSRRemoved:0,isEditorRendered:0,removeSSROT:"none",removeSSRRAFDuration:0,removeSSRTimeoutDuration:0,removeSSRDuration:0}}},{key:"collectRemoveSSRRAFDuration",value:function(e,n){this.extraData.removeSSROT=n,this.extraData.removeSSRRAFDuration=e}},{key:"collectRemoveSSRTimeoutDuration",value:function(e){this.extraData.removeSSRTimeoutDuration=e}},{key:"collectRemoveSSRSuccessByNextRender",value:function(e){var n=this;f.S.runInNextRender((function(){return n.collectRemoveSSRSuccess(e)}))}},{key:"collectRenderEditorSuccessByNextRender",value:function(e){var n=this;f.S.runInNextRender((function(){return n.collectRenderEditorSuccess(e)}))}},{key:"collectAllowEditEnd",value:function(e,n){var r,i=this.extraData,c=i.noSSR,a=i.isSSRRemoved,l=i.isEditorRendered,s=i.removeSSRTimeoutDuration,h=i.removeSSRRAFDuration,p=i.removeSSRDuration,v=i.removeSSROT;(c|a)&l&&(f.S.setExtraData({no_ssr:c,collect_allow_edit_from:e,allow_edit_duration:n-f.S.getStartTime(),hide_ssr_until_raf_duration:c?0:h,hide_ssr_perf_duration:e===o.REMOVE_SSR_SUCCESS?s-h:0,remove_ssr_duration:c?0:p,remove_ssr_rot:v}),void 0===d.ET.RENDER_DOCX_ALLOW_EDIT_WITH_SSR_CLEAN&&(console.log("invaild DOCX_RENDER_STAGE case happened",JSON.stringify(d.ET)),Object(u.n)(new Error("invaild DOCX_RENDER_STAGE case happened")),f.S.setExtraData({invaild_docx_render_stage_case:1})),f.S.updateStage(null!==(r=d.ET.RENDER_DOCX_ALLOW_EDIT_WITH_SSR_CLEAN)&&void 0!==r?r:15))}}]),e}();n.S=new h},dx_v8v5:function(e,n,r){"use strict";var o=r("dx_UtDZ");r.d(n,"F",(function(){return o.MsgBox}))},dx_vD7Z:function(e,n,r){"use strict";(function(t){var e=r("dx_lSNA"),o=r.n(e),i=r("dx_UtDZ"),c=r("dx_h6a8"),a=r("dx_zB2q"),l=r.n(a),s=r("dx_C7Cb"),u=r("dx_eSV8"),d=r("dx_QZfp"),f=r("dx_XCzS"),h=r("dx_ldXi"),p=r("dx_B28d"),v=r("dx_gLp6"),g=r("dx_PhLz"),b=r("dx_Tsyy"),y=r("dx_giHy"),m=r("dx_S1St"),_=r("dx_ZeFe"),k=r("dx_IdzY"),O=r("dx_I11I"),x=r("dx_s1qv"),E=r("dx_a7X6"),S=r("dx_fEKD"),C=r("dx_UTG8"),I=r("dx_InLz"),B=r("dx_u6Hh"),T=r("dx_SOoV");function w(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function R(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?w(Object(r),!0).forEach((function(n){o()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var M=[{type:p.B.LINK,match:function(e){var n;return!!(null===(n=e.props)||void 0===n?void 0:n.data)&&"LINK_BLOCK"===e.blockType},format:function(e,n){var r=e.props.data,o=r.url,i=r.title,c=r.summary,a=r.cover_height,l=r.cover_url,s=r.cover_width,u=r.icon;if(void 0===o||void 0===i)throw new Error;var d=n.data;d.type=p.B.BOOKMARK,d.bookmark={url:o,title:i,summary:c,icon:u,cover_height:a,cover_url:l,cover_width:s}}},{type:p.B.USER,match:function(e){var n,r;return!!(null===(n=e.props)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.user)&&"AT_USER_BLOCK"===e.blockType},format:function(e,n){var r=e.props.data.user.id,i=n.data,c=n.context,a=n.payload;if(!r)throw new Error;c.mark||(c.mark={});var l=JSON.stringify(Object(x.generateInlineComponent)(x.INLINE_COMPONENT_TYPE.USER,{uid:r}));i.nodes=[{text:" ",mark:R(o()({},x.INLINE_COMPONENT_MARK,l),c.mark),type:k.B.EMBED}],a.inline=!0,c.textType?i.type=c.textType:i.type=p.B.TEXT}},{type:p.B.IFRAME,match:function(e){var n;return!!(null===(n=e.props)||void 0===n?void 0:n.data)&&"IFRAME_BLOCK"===e.blockType},format:function(e,n){var r=e.props,o=r.data,i=r.size,c=i.width,a=i.originalWidth,l=o.originalText;if(!l)throw new Error;var s=n.data,u=n.payload;s.original_text=l,c&&a&&!isNaN(c)&&!isNaN(a)&&(u.scale=c/a)}},{type:p.B.FILE,text:t("CreationDoc_DocX_Paste_DataCorrupted_toast_LocalFile"),match:function(e){var n,r;return!!(null===(n=e.props)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.fileInfo)&&"FILE_CARD_BLOCK"===e.blockType},format:function(e,n){var r=e.props,i=r.viewType,c=r.data.fileInfo,a=c.driveKey,u=c.name,d=c.size,f=c.type;if(void 0===a)throw new Error;var h=l.a.lookup(f)||"",v=n.context,b=n.node,y=n.data,m=n.payload,_=Object(s.S)(),x={mime_type:h,name:u,size:d,token:a,source_block_id:_,source_version:1,need_copy_resource:!0},E=Object(g.q)(x,!0),S={node:b,context:v,data:E,children:[],payload:{token:a}};if("inline"===i){y.type=v.textType||p.B.TEXT;var C=o()({},O.B,_);y.nodes=[{inlineblock:{id:_,snapshot:E},mark:C,text:" ",type:k.B.PLAINTEXT}],m.hasInlineFile=!0}else Object(B.z)(n,S,i)}},{type:p.B.EQUATION,text:t("CreationDoc_DocX_Paste_DataCorrupted_toast_equation"),match:function(e){return"EQUATION_BLOCK"===e.blockType},format:function(e,n){var r,o,i=(null===e||void 0===e||null===(r=e.props)||void 0===r||null===(o=r.data)||void 0===o?void 0:o.equation)||"\n",c=n.data,a=n.context,l=n.payload;a.mark||(a.mark={});var s=Object(u.I)(8);E.h.initEquationSet.add(s),c.nodes=[{text:" ",mark:R({equation:i,objectID:s},a.mark),type:k.B.EMBED}],l.inline=!0,a.textType?c.type=a.textType:c.type=p.B.TEXT}},{type:p.B.DIAGRAM,text:t("CreationDoc_DocX_Paste_DataCorrupted_toast_FlowChart"),match:function(e){return!!e.props&&"DIAGRAM_BLOCK"===e.blockType},format:function(e,n){var r=e.props.diagramType,o=e.initData;if(void 0===o)throw new Error;var i=n.data,c=JSON.parse(unescape(o));delete c.lastEditTime,i.diagram=R(R({},c),{},{diagramType:r||v.O.FLOWCHART})}},{type:p.B.REMINDER,match:function(e){var n;return!!(null===(n=e.props)||void 0===n?void 0:n.data)&&"REMINDER_BLOCK"===e.blockType},format:function(e,n){var r=e.props.data,o=r.expireTime,c=r.isWholeDay,a=r.shouldNotify,l=r.notifyTime;if(!o||!l)throw new Error;isNaN(Number(l))&&(l=(new Date).getTime());var s=n.data,u=n.context,d=n.payload,f=JSON.stringify(Object(x.generateInlineComponent)(x.INLINE_COMPONENT_TYPE.REMINDER,{is_whole_day:c,expire_time:o,should_notify:a,notify_time:l,create_user_id:i.userHelper.getCurrentUser().get("id")}));s.nodes=[{text:" ",mark:{"inline-component":f},type:k.B.EMBED}],d.inline=!0,u.textType?s.type=u.textType:s.type=p.B.TEXT}},{type:p.B.BITABLE,match:function(e){return!!e.props&&"BITABLE_BLOCK"===e.blockType},format:function(e,n){var r=e.initData;if(void 0===r)throw new Error;n.payload.initData=r}},{type:p.B.ISV,match:function(e){return!!e.props&&"ISV_BLOCK"===e.blockType},format:function(e,n){var r=e.props.data;if(void 0===r)throw new Error;n.payload.schema=r.schema,n.data.app_block_id="",n.data.block_type_id=r.blockTypeId}},{type:p.B.POLL,match:function(e){return!!e.initData&&"POLL_BLOCK"===e.blockType},format:function(e,n){var r=e.initData,o=Object(c.isString)(r)?JSON.parse(unescape(r)):r,i=o.title,a=o.type,l=o.voteOptionMap,u=o.voteOptions,d=o.voteResultVisible,f={},h=u.map((function(){return Object(s.S)()}));h.forEach((function(e,n){var r=l[u[n]].text;f[e]={id:e,text:C.InputPipe.deserializePlainText(r)}}));var v={title:C.InputPipe.deserializePlainText(i),poll_type:"single"===a?_.v.single:_.v.multiple,when_result_visible:"afterPoll"===d?_.j.afterPoll:_.j.beforePoll,option_ids:h,option_map:f,is_anonymous:!0,type:p.B.POLL};n.data=v}},{type:p.B.JIRA_ISSUE,match:function(e){return Object(f.P)()&&e.initData&&"JIRA_ISSUE_BLOCK"===e.blockType},format:function(e,n){var r=e.initData,a=Object(c.isString)(r)?JSON.parse(unescape(r)):r,l=i.store.getState().appState.currentUser.get("id");if(Object(y.q)(a)){var u=R(R({},a),{},{visibleFieldIds:(null===a||void 0===a?void 0:a.issueRecordMap)?Object.keys(a.issueRecordMap):[],invisibleFieldIds:[],creatorId:l}),d=Object(S.b)(u,p.B.JIRA_ISSUE),f=Object(s.S)(),h=n.context,v=n.data;v.type=h.textType||p.B.TEXT,v.nodes=[{inlineblock:{id:f,snapshot:d},mark:o()({},O.B,f),text:" ",type:k.B.PLAINTEXT}]}}},{type:p.B.MINDMAP,match:function(e){return!!e.props&&"MINDNOTE_BLOCK"===e.blockType},format:function(e,n){var r=e.initData;if(void 0===r)throw new Error;n.payload.initData=Object(c.isString)(r)?JSON.parse(unescape(r)):r}},{type:p.B.OKR,match:function(e){return!!e.initData&&"OKR_BLOCK"===e.blockType},format:function(e,n){var r=Object(d.K)(unescape(e.initData));if(!Object(h.B)()||!r||!r.okrInfo){var o="paste_okr_block_unsupport";return i.Toast.destroy(o),i.Toast.error({key:o,type:"error",content:t("CreationDoc_Docs_OKR_CopyToDocXFailed")}),n.data.nodes=[],void(n.data.type=p.B.TEXT)}if("unsupport"===r.okrInfo.version){var c="paste_okr_block_unsupport_version";return i.Toast.destroy(c),i.Toast.error({key:c,type:"error",content:t("LarkCCM_DocX_pasteOKR_failure_oldversion")}),n.data.nodes=[],void(n.data.type=p.B.TEXT)}Object.assign(n,{alive:!0},Object(m.H)(r.okrInfo))}},{type:p.B.WIKI_RECENT,match:function(e){var n;return e.blockType==="".concat(p.B.WIKI_RECENT.toUpperCase(),"_BLOCK")&&(null===(n=e.props)||void 0===n?void 0:n.data)},format:function(e,n){var r=e.props.data,o=r.spaceId,i=r.showNum;n.data={space_id:o,show_num:i,type:p.B.WIKI_RECENT}}},{type:p.B.WIKI_CATALOG,match:function(e){var n;return e.blockType==="".concat(p.B.WIKI_CATALOG.toUpperCase(),"_BLOCK")&&(null===(n=e.props)||void 0===n?void 0:n.data)},format:function(e,n){var r=e.props.data,o=r.spaceId,i=r.wikiToken;n.data={space_id:o,wiki_token:i,type:p.B.WIKI_CATALOG}}},{type:"unsupport",match:function(e){return!0},format:function(e,n){n.data.nodes=[{text:t("CreationDoc_DocX_Display_Content_Unsupported_staytuned"),type:k.B.PLAINTEXT}],n.data.type=p.B.TEXT}}],j={type:p.B.CHAT_CARD,text:t("CreationDoc_DocX_Paste_DataCorrupted_toast_GroupCard"),match:function(e){var n;return!!(null===(n=e.props)||void 0===n?void 0:n.data)&&"CHAT_CARD_BLOCK"===e.blockType},format:function(e,n){var r=e.props.data.chatId,o=n.data;if("none"===r)throw new Error;o.chat_id=r,n.alive=!0}},D={type:p.B.IMAGE,text:t("CreationDoc_DocX_Paste_DataCorrupted_toast_image"),match:function(e){return!(!e.items||0===e.items.length)},format:function(e,n){var r=e.items,o=n.context,i=n.data,c=n.node,a=n.payload,s=o.align||"center";function u(e){return Object(I.u)(e,240)}function d(e){var n=e.uuid,r=e.width,o=e.image_type,i=e.size,c=e.natrualWidth,a=e.natrualHeight,s=e.file_token,d=u(c),f=u(a),h=u(r)/d;return{height:f,width:d,mimeType:o,name:"".concat(n,".").concat(l.a.extension(o)),scale:h,size:i,token:s}}function f(e){var n=c.querySelectorAll("img"),r="";return n.forEach((function(n){var o=n.dataset.src&&new URL(n.dataset.src),i=e.src&&new URL(decodeURIComponent(e.src));(o&&o.pathname)===(i&&i.pathname)&&(r=n.src)})),r}if(1===r.length){var h=d(r[0]);a.src=r[0].file_token?decodeURIComponent(r[0].src):f(r[0]),a.fileToken=r[0].file_token,a.uuid=r[0].uuid,i.type=p.B.IMAGE,i.align=s,i.image=h}else{for(var v,g,y=0,m=0,_=[];y<r.length;){y%b.t===0&&(v=y,g={data:{type:p.B.GRID},children:[],payload:{},context:{},node:c},m=r.slice(v,v+b.t).reduce((function(e,n){return e+u(n.width)}),0),_.push(g));var k=r[y],O=d(k),x={data:{type:p.B.GRID_COLUMN,width_ratio:u(k.width)/m},children:[{data:{image:O,type:p.B.IMAGE,align:s},context:{},payload:{src:k.file_token?decodeURIComponent(k.src):f(k),fileToken:k.file_token},children:[],node:c}],payload:{},context:{},node:c};g.children.push(x),y++}n.children=_}return n}},A={calloutIgnoreIcon:{matches:{nodeType:T.n.ELEMENT,selector:".ignore-dom"},preprocess:function(e){var n;return null===(n=e.node.firstElementChild)||void 0===n?void 0:n.classList.contains("emoji-mart-emoji-native")},enter:function(e){e.context._ignoreChild=!0}},callout:{matches:{nodeType:T.n.ELEMENT,selector:".callout-container"},addEmptyTextIfNoChild:!0,enter:function(e){var n=e.node,r=e.data,o=n.dataset.emojiId;if(o){var i=n.querySelector(".callout-block");if(i){var c=i.style.backgroundColor,a=i.style.borderColor;r.background_color=c,r.border_color=a,r.emoji_id=o,r.type=p.B.CALLOUT,e.alive=!0}}}},docImage:{matches:{nodeType:T.n.ELEMENT,selector:"[data-ace-gallery-json]"},ignoreChild:!0,preprocess:function(e){var n=e.node.getAttribute("data-ace-gallery-json");if(n){try{n=JSON.parse(n)}catch(r){return}return{meta:n,formatter:D}}},enter:function(e,n,r){var o=r.meta,i=r.formatter;e.data.type=i.type,i.format(o,e)}},docCommonBlock:{matches:{nodeType:T.n.ELEMENT,selector:".j-block-container"},ignoreChild:!0,preprocess:function(e){var n=Object(B.Z)(e.node,"data-meta-block-props");if(!n){var r=Object(B.Z)(e.node,"data-clientside-chatcard-props");return r?{meta:r,formatter:j}:void(e.context._ignoreChild=!1)}var o=M.find((function(e){return e.match(n)}));if(o)return{meta:n,formatter:o};e.context._ignoreChild=!1},enter:function(e,n,r){var o=r.meta,i=r.formatter;e.data.type=i.type;try{i.format(o,e)}catch(c){i.text&&(e.data.nodes=[{text:i.text,type:k.B.PLAINTEXT}],e.data.type=p.B.TEXT)}}}};n.S=A}).call(this,r("dx_E9Eu"))},dx_vE74:function(e,n,r){"use strict";function o(e,n){return n.some((function(n){return e.closest(".".concat(n))}))}r.d(n,"Q",(function(){return o}))},dx_vGb7:function(e,n,r){"use strict";r.d(n,"Z",(function(){return w}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_UtDZ"),v=r("dx_k8kI"),g=r("dx_h6a8"),b=r("dx_luPr"),y=r("dx_zEdG"),m=r("dx_Y2Dh"),_=r("dx_WzJv"),k=r("dx_B28d"),O=r("dx_D5D1"),x=r("dx_rldU");function E(e){return x.z.indexOf(e.object_block_type)<0}var S,C=Object(O.A)((function(e,n){if(!(e.length<1)){var r=e.map((function(e){var r=n.getRecord(e),o=r.id,i=r.snapshot.type,c=Object(_.D)(r),a=Object(_.T)(r);return{object_block_id:o?Object(p.encryptTea)(o):"",object_block_type:i,object_sub_block_type:c,is_full_screen:"false",view_type:Object(m.N)(r,n),block_content_size:a}})).filter(E);Object(y.T)("ccm_doc_content_page_view",{record_id:Object(p.getToken)(),block_type:k.B.PAGE},{object_block_data:r})}})),I=Object(O.A)((function(e,n,r){if(!(e.length<1)){var o=e.map((function(e){var n=r.recordManager.getRecord(e),o=n.id,i=n.snapshot.type,c=Object(_.D)(n),a=Object(_.T)(n);return{object_block_id:o?Object(p.encryptTea)(o):"",object_block_type:i,object_sub_block_type:c,block_content_size:a}})).filter(E);Object(y.P)("ccm_doc_content_page_click",{record_id:Object(p.getToken)(),block_type:k.B.PAGE},{click:"close_view",object_block_data:o,sub_click:n})}}));!function(e){e.page_destroy="page_destroy",e.page_spa_switch="page_spa_switch",e.page_invisible="page_invisible",e.page_slide="page_slide"}(S||(S={}));function B(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var T=function(e){s()(r,e);var n=B(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).routeListenerRegistered=!1,e}return a()(r,[{key:"listen",value:function(){this.routeListenerRegistered||(this.listenRouteChange(),this.routeListenerRegistered=!0),this.blockManager&&this.blockManager.addListener(v.rC,this.handleViewportChanged),document.addEventListener("visibilitychange",this.onDocumentVisibilityChange),window.addEventListener("beforeunload",this.onWindowBeforeUnload.bind(this)),this.inActiveTag=!1}},{key:"unlisten",value:function(){this.blockManager&&this.blockManager.removeListener(v.rC,this.handleViewportChanged),document.removeEventListener("visibilitychange",this.onDocumentVisibilityChange),window.removeEventListener("beforeunload",this.onWindowBeforeUnload.bind(this)),this.inActiveTag=!0}},{key:"listenRouteChange",value:function(){var e=this;p.history.listen((function(n,r){e.inActiveTag||(e.sendCloseViewEvent(S.page_spa_switch),e.visibleRecords.clear(),e.isFirstTime=!0,e.inActiveTag=!0)}))}}]),r}(function(){function e(){var n=this;i()(this,e),this.visibleRecords=new Set,this.appearedRecords=new Set,this.disappearedRecords=new Set,this.debouncedSendAppearedEvent=Object(g.debounce)(this.sendAppearedEvent,3e3),this.debouncedSendDisappearedEvent=Object(g.debounce)(this.sendDisappearedEvent,3e3),this.isFirstTime=!0,this.inActiveTag=!1,this.blockManager=void 0,this.handleViewportChanged=function(e){var r=e.enterBlocks,o=e.leaveBlocks;n.appeared(r.map((function(e){return b.R.reportBlockLoadStage(b.F.SHOW,{id:e,time:(new Date).getTime()}),n.blockManager.getRecordByBlockId(e).id}))),n.disappeared(o.map((function(e){return b.R.clearStageInfo(b.F.SHOW,e),n.blockManager.getRecordByBlockId(e).id})))},this.onDocumentVisibilityChange=function(){if("hidden"===document.visibilityState){if(n.inActiveTag)return;n.sendCloseViewEvent(S.page_invisible),n.inActiveTag=!0}else{if(n.inActiveTag=!1,n.visibleRecords.size<1)return;var e=Array.from(n.visibleRecords.values());C(e,n.blockManager)}},this.onWindowBeforeUnload=function(){n.inActiveTag||(n.sendCloseViewEvent(S.page_destroy),n.visibleRecords.clear(),n.inActiveTag=!0)}}return a()(e,[{key:"setBlockManager",value:function(e){this.blockManager=e}},{key:"resetBlockManager",value:function(){this.blockManager=null}},{key:"appeared",value:function(e){var n=this;Array.isArray(e)||(e=[e]),e.forEach((function(e){n.appearedRecords.add(e),n.disappearedRecords.delete(e),n.visibleRecords.add(e)})),this.debouncedSendAppearedEvent()}},{key:"disappeared",value:function(e){var n=this;Array.isArray(e)||(e=[e]),e.forEach((function(e){n.appearedRecords.has(e)||n.disappearedRecords.add(e),n.appearedRecords.delete(e),n.visibleRecords.delete(e)})),this.debouncedSendDisappearedEvent()}},{key:"sendAppearedEvent",value:function(){if(!(this.appearedRecords.size<1)){var e=Array.from(this.appearedRecords.values());C(e,this.blockManager),this.appearedRecords.clear()}}},{key:"sendDisappearedEvent",value:function(){if(this.isFirstTime)return this.disappearedRecords.clear(),void(this.isFirstTime=!1);if(!(this.disappearedRecords.size<1)){var e=Array.from(this.disappearedRecords.values());I(e,S.page_slide,this.blockManager),this.disappearedRecords.clear()}}},{key:"sendCloseViewEvent",value:function(e){if(!(this.visibleRecords.size<1)){var n=Array.from(this.visibleRecords.values());I(n,e,this.blockManager)}}}]),e}()),w=new T},dx_vLvZ:function(e,n,r){"use strict";r.d(n,"o",(function(){return W})),r.d(n,"W",(function(){return z})),r.d(n,"b",(function(){return G})),r.d(n,"P",(function(){return K}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_lSNA"),a=r.n(c),l=r("dx_RIqP"),s=r.n(l),u=r("dx_HeF4"),d=r("dx_o3oO"),f=r("dx_B28d");function h(e){return{rootSelector:d.W,noCommentPanel:!0,isNeedScrollBar:e===f.B.TABLE||e===f.B.BITABLE}}var p,v=r("dx_yzqx"),g=r("dx_r2rw"),b=r("dx_H6o9"),y=r("dx_TKhc"),m=r("dx_s4sk"),_=r("dx_z9zT"),k=r("dx_MGAW"),O=r("dx_mGN1"),x=r("dx_JsDk"),E=r("dx_A5O8"),S=r("dx_S8Sa");function C(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function I(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?C(Object(r),!0).forEach((function(n){a()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var B=[m.y,{}],T=[b.R,{displayMode:f.J.BLOCK}],w=[g.S,{disabled:function(e){return e.displaymode===f.J.INLINE}}],R=[g.S,{isEffectiveInPart:!0}],M=[O.c,{}],j=E.S.checkShouldRegisComment()?[[y.M,{}]]:[],D=[S.S,{}],A=[D].concat(j,[B]),P=[w].concat(s()(A)),L=[R].concat(s()(A)),N=[].concat(s()(A),[T]);function F(e,n){return[_.S,I(I({},n),{},{enableVcOptions:Object(k.G)(e)})]}function U(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[T,F(e,n)].concat(s()(A))}var H=(p={},a()(p,f.B.IMAGE,[M].concat(s()(L))),a()(p,f.B.FILE,[M].concat(s()(P))),a()(p,f.B.CHAT_CARD,[M].concat(s()(P))),a()(p,f.B.SHEET,[M].concat(s()(U(f.u.SHEET)))),a()(p,f.B.BITABLE,[M].concat(s()(U(f.u.BITABLE,{enableRightShadow:!1})))),a()(p,f.B.MINDMAP,[M].concat(s()(N))),a()(p,f.B.TABLE,[D,F(f.u.TABLE,x.R.scrollableOptions)]),p);function V(e,n,r,o){var c=o.overrideProps,a=H[e]||[],l=new Map(void 0===c?[]:c);return a.filter((function(r){var o=i()(r,2),c=o[0];o[1];return!function(e,n,r){var o=!1;switch(e){case u.u.PREVIEW:o=o||r===g.S||r===m.y;case u.u.HISTORY:o=o||r===y.M||r===S.S;break;case u.u.MAIN_MOBILE:o=r===S.S&&[f.B.MINDMAP].includes(n)||r===_.S&&n!==f.B.TABLE;break;case u.u.PRESENTATION_MODE:o=r===S.S}return o}(n,e,c)})).map(function(e,n,r){return function(o){var c=i()(o,2),a=c[0],l=c[1],s={},u={};return a===_.S&&(s=I({},_.S.getDefaultProps({app:e}))),r.has(a)&&(u=r.get(a)),[a,I(I(I(I({},n),s),l),u)]}}(n,r,l))}function W(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=v.Z.isMobile?u.u.MAIN_MOBILE:u.u.MAIN_PC;return V(e,o,n,r)}function z(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return V(e,u.u.HISTORY,n,r)}function G(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return V(e,u.u.PRESENTATION_MODE,n,r)}function K(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=I(I({},r),{},{overrideProps:[].concat(s()(r.overrideProps||[]),[[_.S,h(e)]])});return V(e,u.u.PREVIEW,n,o)}},dx_vOIB:function(e,n,r){"use strict";r.d(n,"q",(function(){return i}));var o=r("dx_BH3T");function i(e){return Object(o.i)(e.type)||!e.parent?0:i(e.parent)+1}},dx_vQix:function(e,n,r){"use strict";r.d(n,"B",(function(){return s})),r.d(n,"N",(function(){return u}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_S1lH"),a=r("dx_B28d");function l(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function s(e,n){return Object(c.N)(function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?l(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({done:!1},e),n)}function u(e,n){var r=n.getBlockModelByBlockIdNotCheck(e);return null!=r&&r.type===a.B.TODO}},dx_vQlG:function(e,n,r){"use strict";r.d(n,"o",(function(){return o})),r.d(n,"v",(function(){return a})),r.d(n,"C",(function(){return l})),r.d(n,"Cl",(function(){return s}));var o,i=r("dx_cDf5"),c=r.n(i);function a(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{var r=localStorage.getItem(e);return null===r?n:r}catch(o){return console.error("get local storage error",o),n}}function l(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{var r=localStorage.getItem(e);return null===(r=r?JSON.parse(r):null)||"object"!==c()(r)?n:r}catch(o){return console.error("get local storage error",o),n}}function s(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{null===n?localStorage.removeItem(e):localStorage.setItem(e,n)}catch(r){console.error("set local storage error",r)}}!function(e){e.SpaceResourceViewType="space_resource_view",e.CalloutSetting="callout_setting"}(o||(o={}))},dx_vW17:function(e,n,r){"use strict";r.d(n,"d",(function(){return o})),r.d(n,"p",(function(){return i})),r.d(n,"q",(function(){return c})),r.d(n,"B",(function(){return a})),r.d(n,"U",(function(){return l}));var o="ccm_doc_oops_page_click",i="copy_successful",c="copy_fail",a="click_pop_up",l="click_create_file"},dx_vWE0:function(e,n,r){"use strict";(function(t){var e,o,i,c,a=r("dx_o0o1"),l=r.n(a),s=r("dx_yXPU"),u=r.n(s),d=r("dx_yG8O"),f=r.n(d),h=r("dx_lwsE"),p=r.n(h),v=r("dx_W8MJ"),g=r.n(v),b=r("dx_PJYZ"),y=r.n(b),m=r("dx_iWIM"),_=r.n(m),k=r("dx_W7W2"),O=r.n(k),x=r("dx_a1gu"),E=r.n(x),S=r("dx_Nsbk"),C=r.n(S),I=r("dx_Uyc2"),B=r.n(I),T=(r("dx_A1AB"),r("dx_UtDZ")),w=r("dx_MoY1"),R=r("dx_NMQJ"),M=r("dx_x1WV"),j=r("dx_f4Wj"),D=r("dx_Np2v"),A=r("dx_f1HX");function P(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=C()(e);if(n){var i=C()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return E()(this,r)}}var L=(c=i=function(e){O()(r,e);var n=P(r);function r(){var e;p()(this,r);for(var i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];return e=n.call.apply(n,[this].concat(c)),f()(e,"blockManager",o,y()(e)),e}return g()(r,[{key:"getText",value:function(){return"[".concat(t("common.chat"),"]")}},{key:"onPasteRecordAfterApply",value:function(){var e=u()(l.a.mark((function e(n){var o,i,c,a,s,u,d,f=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(T.isOnline)()){e.next=2;break}return e.abrupt("return",_()(C()(r.prototype),"onPasteRecordAfterApply",this).call(this,n));case 2:return o=this.snapshot.chat_id,e.prev=3,c=this.editorAPI.config.get("token"),e.next=7,Object(j.W)(o,c);case 7:if(!(a=e.sent.data).RespCode){e.next=13;break}return e.next=11,this.blockManager.applyTransaction("removeChatCardblock",(function(e){Object(w.y)(e,[f])}));case 11:return Object(A.b)({type:"error",content:D.X[a.RespCode]}),e.abrupt("return");case 13:i=a.Token,e.next=28;break;case 16:if(e.prev=16,e.t0=e.catch(3),u=e.t0,console.log("err",u),!(null===(s=u.data)||void 0===s?void 0:s.RespCode)){e.next=26;break}return d=u.data.RespCode,e.next=24,this.blockManager.applyTransaction("removeChatCardblock",(function(e){f.parent&&e.removeChildren(f.parent.record.id,[f.record.id])}));case 24:return Object(A.b)({type:"error",content:D.X[d]}),e.abrupt("return");case 26:return Object(A.b)({type:"error",content:t("common.network_error")}),e.abrupt("return");case 28:return e.next=30,this.blockManager.applyTransaction("replaceChatCardblockChatToken",(function(e){e.replace(f.record.id,["chat_token"],i)}),{undoable:!1});case 30:case"end":return e.stop()}}),e,this,[[3,16]])})));return function(n){return e.apply(this,arguments)}}()}]),r}(R.D),i.type=D.L,e=c,o=B()(e.prototype,"blockManager",[M.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),e);n.S=L}).call(this,r("dx_E9Eu"))},dx_vevK:function(e,n,r){},dx_vfzM:function(e,n,r){"use strict";r.d(n,"X",(function(){return a})),r.d(n,"Q",(function(){return l}));var o=r("dx_U1Ua"),i=r("dx_LJUQ"),c=function(e){return e&&e[o.z]&&e[o.z].jira||i.F},a=function(e){return c(e).syncStatus},l=function(e){return c(e).authStatus}},dx_viBb:function(e,n,r){"use strict";r.d(n,"C",(function(){return o})),r.d(n,"s",(function(){return i})),r.d(n,"M",(function(){return c})),r.d(n,"Z",(function(){return a})),r.d(n,"g",(function(){return l})),r.d(n,"T",(function(){return s})),r.d(n,"N",(function(){return u})),r.d(n,"f",(function(){return d})),r.d(n,"h",(function(){return f}));var o={RETURN:13,LEFT:37,UP:38,RIGHT:39,DOWN:40},i=155,c=8,a="enterItem",l="leaveItem",s="item-arrow",u="docx-menu-wrapper",d=[8,0],f=[!1,!0]},dx_vira:function(e,n,r){"use strict";r.d(n,"o",(function(){return D}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_o0o1"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_QxNg"),v=r("dx_NOtv"),g=r.n(v),b=r("dx_UtDZ"),y=r("dx_h6a8"),m=r("dx_PQBD"),_=r("dx_yzqx"),k=r("dx_SreQ"),O=r("dx_NLUy"),x=new(function(){function e(n,r,o,i){d()(this,e),this.px1=void 0,this.px2=void 0,this.px3=void 0,this.py1=void 0,this.py2=void 0,this.py3=void 0,this.epsilon=void 0,this.px3=3*n,this.px2=3*(o-n)-this.px3,this.px1=1-this.px3-this.px2,this.py3=3*r,this.py2=3*(i-r)-this.py3,this.py1=1-this.py3-this.py2,this.epsilon=1e-7}return h()(e,[{key:"getX",value:function(t){return((this.px1*t+this.px2)*t+this.px3)*t}},{key:"getY",value:function(t){return((this.py1*t+this.py2)*t+this.py3)*t}},{key:"solve",value:function(e){if(0===e||1===e)return this.getY(e);for(var t=e,n=0;n<8;n++){var r=this.getX(t)-e;if(Math.abs(r)<this.epsilon)return this.getY(t);var o=(3*this.px1*t+2*this.px2)*t+this.px3;if(Math.abs(o)<1e-6)break;t-=r/o}return this.getY(t)}}]),e}())(.42,0,.58,1);function E(e){for(var n=e.scroller,r=e.duration,o=e.target,i=n instanceof Window?n.scrollY:n.scrollTop,c=n instanceof Window?n.innerHeight:n.clientHeight,a=0,l=o.clientHeight,s=o;s&&(a+=s.offsetTop,(s=s.offsetParent)!==n););return a>=i&&a+l<=i+c?y.noop:function(e){var n=e.duration,r=e.scrollTop,o=e.scroller;o||(o=window);var i=o instanceof Window?o.scrollY:o.scrollTop;if(r===i)return y.noop;var c=i>r,a=Math.abs(r-i),l=0,s=!1,u=function e(r){if(!s){l||(l=r);var u=Math.max(0,Math.min(1,(r-l)/n));1!==u&&window.requestAnimationFrame(e);var d=x.solve(u)*a,f=i+(c?-d:d);o instanceof Window?o.scrollTo({top:f}):o.scrollTop=f}};return window.requestAnimationFrame(u),function(){s=!0}}({duration:r,scroller:n,scrollTop:a<i?a:a+l-c})}var S=r("dx_B28d"),C=r("dx_QBqw"),I=r("dx_kZ3l"),B=r("dx_B6I0"),T=r("dx_EqZO"),w=r("dx_ij4R"),R=r("dx_zghO"),M=r("dx_D8nn"),j=g()("sophon:viewport"),D=function(){function e(n){var r=this;d()(this,e),this.options=n,this.lastSelectionChangeTrigger=new B.o,this.hasFetchFinished=!1,this.recordChangeSource=null,this.curSelectedBlockId=void 0,this.focusChangeTimer=void 0,this.debouncedClearRecordChangeSource=Object(y.debounce)(this.clearRecordChangeSource.bind(this)),this.adjustViewport=function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.options.selectionAPI.getSelection();e.length>1||!e.length?r.focusChangeTimer&&(window.clearTimeout(r.focusChangeTimer),r.focusChangeTimer=void 0):(r.curSelectedBlockId=e[0].id,!r.focusChangeTimer&&r.recordChangeSource!==p.H.remote&&r.options.blockManager.editable&&(r.focusChangeTimer=window.setTimeout((function(){var e=r.curSelectedBlockId,n=r.options.blockManager;if(n.hasBlockModelByBlockId(e)){var o=n.getBlockViewByBlockIdNotCheck(e);r.recordChangeSource!==p.H.remote&&o&&r._scrollFocusIntoView(o)}r.focusChangeTimer=void 0}))))},this.isBlockInViewport=function(e){return r.options.blockManager.layoutManager.getViewportBlocks().includes(e)},this.scrollToBlock=function(){var e=s()(a.a.mark((function e(n,o,i,c){var l,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s=null===(l=r.options.blockManager.getRecordByBlockId(n))||void 0===l?void 0:l.id)){e.next=7;break}return e.next=4,r.scrollToRecord(s,o,i);case 4:return e.abrupt("return",!0);case 7:return Object(b.collectEvent)("doc_bug_track_dev",{action:"scroll_to_block_fail",info:JSON.stringify({stack:new Error("scroll_to_block_fail").stack||"",callerName:c})}),e.abrupt("return",!1);case 9:case"end":return e.stop()}}),e)})));return function(n,r,o,i){return e.apply(this,arguments)}}(),this.scrollToBlockWithAnimation=function(e){var n,o=!1;return r.scrollToBlock(e,s()(a.a.mark((function i(){var c,l;return a.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!o){i.next=2;break}return i.abrupt("return");case 2:c=r.options.blockManager.getBlockViewByBlockId(e),l=c.hostElement,n=E({scroller:_.S.isMobile?document.scrollingElement:r.options.selectionAPI.options.boundaryAreaContainer,duration:200,target:l});case 4:case"end":return i.stop()}}),i)})))),function(){var e;o=!0,null===(e=n)||void 0===e||e()}},this.handleAllDataReady=function(){r.hasFetchFinished=!0},this.scrollToRecord=function(){var e=s()(a.a.mark((function e(n,o,c){var l,s,u,d,f,h,p,v,g,b,y,_,k,x,E,I,B,R,M;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=r.options,s=l.blockManager,u=l.eventEmitter,d=s.recordManager,f=d.hasRecord(n)&&(null===d||void 0===d?void 0:d.getRecord(n)),h=s.getBlockIdsByRecordId(n),p=f&&(null===f||void 0===f?void 0:f.snapshot.type)===S.B.PENDING,v=!(!h||!h[0]),g=s.editorAPI.getService(w.e,{optional:!0}),!v||p){e.next=11;break}g&&g.setStartId(n),e.next=18;break;case 11:if(!r.hasFetchFinished||v||p){e.next=15;break}return e.abrupt("return",null);case 15:return p?g&&g.setStartId(n):g&&g.setStartId(n,!0),e.next=18,new Promise((function(e){var r=function(r){Object.keys(r.clientvarToWork.block_map).includes(n)&&(i(),e())},o=function(){i(),e()},i=function(){u.off(T.R.CLIENTVAR_SUB_TASK_FINISH,r),u.off(T.R.CLIENTVAR_APPLY_ALL_DONE,o)};u.on(T.R.CLIENTVAR_SUB_TASK_FINISH,r),u.on(T.R.CLIENTVAR_APPLY_ALL_DONE,o)}));case 18:if(h=s.getBlockIdsByRecordId(n),b=h,y=i()(b,1),!(_=y[0])){e.next=34;break}return k=r.options,x=k.fold,E=k.rect,I=k.selectionAPI,u.emit(T.R.CLIENTVAR_TABLE_BLOCK_TRIGGER_HIDE_LOADING,_),B=Object(m.b)(s,_),e.next=26,x.forceShowFoldedBlock(B,s.editable);case 26:if(R=s.getBlockIdsByRecordId(n),M=i()(R,1),!(_=M[0])){e.next=34;break}return e.next=32,s.layoutManager.scrollToSelection(_,o);case 32:return!c&&Object(C.q)(s,_,Object(O.p)(I,E)||E.getBlockRect(_)),e.abrupt("return",_);case 34:return console.warn("scrollToRecord block not found for record",n),e.abrupt("return",null);case 36:case"end":return e.stop()}}),e)})));return function(n,r,o){return e.apply(this,arguments)}}(),this.getBlockIds=function(e){var n=e.parentBlockId,o=void 0===n?r.options.blockManager.rootBlockId:n,c=e.offsets,a=e.maxDepth,l=void 0===a?2:a,s=[],u=i()(c,2),d=u[0],f=u[1],h=r.options,p=h.blockManager,v=h.rect;if(d>f)throw new Error("offsets error");var g=r.binarySearchBlockId(o,(function(e){return r.binarySearchMatcherWithOffset(e,d)}));if(!g)return[];if(s.push(g),d===f)return s;for(var b=p.getBlockModelByBlockId(g).next;b;){var y=b,m=y.id,_=y.depth,k=v.getBlockRect(m).top;if(k>f&&2===_)break;_<=l&&k<f&&s.push(m),b=b.next}return s},this.binarySearchMatcherWithOffset=function(e,n){var o=r.options,i=o.rect,c=o.blockManager,a=i.getBlockRect(e),l=a.top,s=a.bottom;if(l>n){var u=c.getBlockModelByBlockId(e);if(u.previousSibling){var d=u.previousSibling.id;if(i.getBlockRect(d).bottom<n)return 0}return-1}return s<n?1:0},this.handleRecordContentChange=function(e){r.recordChangeSource=e.options.from,r.debouncedClearRecordChangeSource()},this.setup()}return h()(e,[{key:"_scrollFocusIntoView",value:function(e){var n=this;if(this.options.selectionAPI.isSingleTextSelection(this.options.selectionAPI.getSelection()))this.options.blockManager.layoutManager.scrollToSelection(e.id,s()(a.a.mark((function r(){var o,i,c;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.scrollCaretIntoView(e),e.isFocus()||!e.editor.isEditable()){r.next=9;break}if(e.focus(),!Object(k.P)()){r.next=9;break}if(i=null===(o=e.model.getSelection())||void 0===o?void 0:o.toPosition()){r.next=7;break}return r.abrupt("return");case 7:c={id:e.id,type:R.j.TEXT,selection:{start:i.start,end:i.start+i.len}},n.options.selectionAPI.setSelection([c]);case 9:case"end":return r.stop()}}),r)}))));else{var r=this.options.selectionAPI.getContext();r&&["arrowPress","hotkey"].includes(r.source)&&this.scrollToBlockWithAnimation(e.id)}}},{key:"scrollCaretIntoView",value:function(e){var n=e.model.zoneState.getContainer();if(n){var r=this._boundary,o=e.editor,i=e.model,c=i.getSelection();if(c&&c.start.line===c.end.line){var a=Object(I.r)(o.rectModule.getCaretRect(c.start,i.zoneId),o.getRect(i.zoneId));if(a&&(0!==a.left||0!==a.top)){var l=function(e,n){return e.top-n.top<(n.bottom-n.top)/2}(a,r),s=this.options.container;if(!function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.bottom>=n.top-r&&e.top<=n.bottom+r}(a,r,26)){j("not in viewport");var u=function(e,n){if(!e)return null;var r=e,o=0;for(;r!==n&&null!==r;){o+=r.offsetTop;var i=r.offsetParent;if(!(i instanceof HTMLElement))return console.error(i,"is not HTMLElement"),null;r=i}return o}(n,s);if(!u)return;var d=n.getBoundingClientRect(),f=a.top-d.top,h=l?u-r.top:u-r.height+f;s.scrollTop=h}}}}}},{key:"clearRecordChangeSource",value:function(){this.recordChangeSource=null}},{key:"binarySearchBlockId",value:function(e,n){for(var r=this.options.blockManager.getBlockModelByBlockId(e).children,o=0,i=r.length-1;o<=i;){var c=Math.floor(o+(i-o)/2),a=r[c].id,l=n(a);if(0===l)return a;l<0?i=c-1:o=c+1}return null}},{key:"setup",value:function(){var e=this.options,n=e.blockManager,r=e.selectionAPI;n.recordManager.on(p.q.CHANGE,this.handleRecordContentChange),r.onSelectionChange(this.lastSelectionChangeTrigger.handleSelectionChange),this.lastSelectionChangeTrigger.init(this.adjustViewport),M.S.on(M.p.COMMON.ADJUST_VIEWPORT,this.adjustViewport),this.shouldRelyOnLazyRecord?this.options.eventEmitter.on(T.R.CLIENTVAR_APPLY_ALL_DONE,this.handleAllDataReady):this.handleAllDataReady()}},{key:"destroy",value:function(){var e=this.options,n=e.blockManager,r=e.selectionAPI;n.recordManager.off(p.q.CHANGE,this.handleRecordContentChange),r.offSelectionChange(this.lastSelectionChangeTrigger.handleSelectionChange),M.S.off(M.p.COMMON.ADJUST_VIEWPORT,this.adjustViewport),this.lastSelectionChangeTrigger.destroy(),this.debouncedClearRecordChangeSource.cancel(),this.shouldRelyOnLazyRecord&&this.options.eventEmitter.off(T.R.CLIENTVAR_APPLY_ALL_DONE,this.handleAllDataReady),this.focusChangeTimer&&(window.clearTimeout(this.focusChangeTimer),this.focusChangeTimer=void 0)}},{key:"shouldRelyOnLazyRecord",get:function(){return!this.options.isHistory}},{key:"_boundary",get:function(){var e=this.options.container,n=this.options.container.getBoundingClientRect(),r=parseInt(e.style.paddingTop||"0",10),o=parseInt(e.style.paddingBottom||"0",10);return new DOMRect(n.x,n.y+0+r,n.width,n.height-50-r-o)}}]),e}()},dx_vlFf:function(e,n,r){"use strict";r.d(n,"H",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("undo-service")},dx_vlKv:function(e,n,r){"use strict";r.d(n,"w",(function(){return de}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W7W2"),a=r.n(c),l=r("dx_a1gu"),s=r.n(l),u=r("dx_Nsbk"),d=r.n(u),f=r("dx_Vvd7"),h=r("dx_N9dL"),p=r("dx_Z22N"),v=r("dx_B28d"),g=r("dx_fEKD");var b=r("dx_NMQJ");function y(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var m=function(e){a()(r,e);var n=y(r);function r(e){return i()(this,r),n.call(this,e)}return r}(b.D);function _(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}m.type=v.B.GRID;var k=function(e){a()(r,e);var n=_(r);function r(e){return i()(this,r),n.call(this,e)}return r}(b.D);k.type=v.B.GRID_COLUMN;var O,x=r("dx_GzEb"),E=r("dx_W8MJ"),S=r.n(E),C=r("dx_jtB3"),I=function(){function e(){i()(this,e),this.type=v.B.GRID_COLUMN}return S()(e,[{key:"getLayoutNodeConfig",value:function(e,n){return{calculateModel:n&&!n.show?C.j.IGNORE:C.j.VERTICAL,ignoreMarginCollapse:!0}}}]),e}(),B=r("dx_xjz2"),T=r("dx_tt0H"),w=r("dx_JXmB"),R=Object(B.s)(T.U)(O=function e(){i()(this,e),this.blockType=v.B.GRID_COLUMN,this.checkFunc=w.M})||O,M=r("dx_n8nr"),j=r("dx_o0o1"),D=r.n(j),A=r("dx_J4zp"),P=r.n(A),L=r("dx_yXPU"),N=r.n(L),F=r("dx_iWIM"),U=r.n(F),H=r("dx_QxNg"),V=r("dx_TSYQ"),W=r.n(V),z=r("dx_h6a8"),G=r("dx_Neuu"),K=r("dx_cDcd"),q=r.n(K),X=r("dx_bdgK"),Y=r("dx_MoY1"),J=r("dx_yzqx"),Z=r("dx_MGoZ"),Q=r("dx_xFJs"),$=r("dx_NsKf"),ee=r("dx_ZG9w"),te=r("dx_kZ3l"),ne=r("dx_D8nn"),re=r("dx_Tsyy"),oe=r("dx_n3Q4");r("dx_KzX9");function ie(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var ce,ae,le,se=function(e){a()(r,e);var n=ie(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).state={widthRatio:e.animateOnMount?0:e.props.record.snapshot.width_ratio},e.gridTimer=void 0,e.subs=void 0,e.ref=Object(K.createRef)(),e.resizeObserver=void 0,e.shouldNotifyGridToResize=!1,e.shouldNotifyGridToUpdate=!1,e.gridParent=null,e.getLastChildBlock=function(){var n=e.blockManager.getBlockModelByBlockId(e.id),r=Object(z.last)(n.children);if(r)return e.blockManager.getBlockViewByBlockId(null===r||void 0===r?void 0:r.id)},e.findLastEmptyTextualBlock=function(n){var r=e.blockManager.getBlockModelByBlockId(n);if(0!==r.children.length){var o=r.children[r.children.length-1],i=e.blockManager.getBlockViewByBlockId(o.id);return Object(ee.U)(i)&&i.type===v.B.TEXT&&i.model.isEmpty?o.id:void 0}},e.handleClick=function(){var n=N()(D.a.mark((function n(r){var o,i,c,a,l,s,u;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.editable){n.next=2;break}return n.abrupt("return");case 2:if(r.target===e.hostElement){n.next=4;break}return n.abrupt("return");case 4:if(o=e.getLastChildBlock(),(i=null===o||void 0===o?void 0:o.hostElement.getBoundingClientRect().bottom)&&!(r.y<i)){n.next=8;break}return n.abrupt("return");case 8:if(!(c=e.findLastEmptyTextualBlock(e.id))){n.next=12;break}return a=e.blockManager.getBlockViewByBlockId(c),n.abrupt("return",Object(te.Z)(a.model));case 12:return l="",n.next=15,e.blockManager.applyTransaction("insertBlockWhenClickInColumn",(function(n){var r=e.blockManager.getRecordByBlockId(e.id),o=Object(Y.l)(n,r.id,e.record.snapshot.children.length,[Object($.u)({})]),i=P()(o,1);l=i[0]}));case 15:s=e.blockManager.getBlockIdsByRecordId(l)[0],u=e.blockManager.getBlockViewByBlockId(s),Object(ee.U)(u)&&u.focus();case 18:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.handleBlockStructUpdate=function(n){var r=n.model,o=n.action,i=n.options;if(0===o.child.position&&(e.blockManager.layoutManager.didUpdateNode(o.child.id,!0),e.gridParent=r.parent&&e.editorAPI.viewService.getBlockViewByBlockId(r.parent.id)||null,i.isInUndoRedo?e.shouldNotifyGridToUpdate=!0:e.shouldNotifyGridToResize=!0,e.shouldNotifyGridToResize||e.shouldNotifyGridToUpdate)){var c=i.from&&i.from===H.H.remote;setTimeout((function(){var n=e.gridParent.updateCurrentMultiBlockInLine(),r=re.L.includes(o.type)&&!i.isInPaste;!c&&e.shouldNotifyGridToResize&&n&&e.editable&&!r&&e.gridParent.updateGridAndColumnSize(),e.shouldNotifyGridToUpdate=!1,e.shouldNotifyGridToResize=!1}))}},e.handleChange=function(n){e.editable&&n.options.from===H.H.local&&e.checkRemoveSelf()},e.checkRemoveSelf=function(){var n,r=e.model.record,o=e.model.parent.record;!(null===(n=o.snapshot.children)||void 0===n?void 0:n.includes(r.id))||r.snapshot.children.length>0||e.model.applyTransaction("removeSelf",(function(n){var i;n.removeChildren(o.id,[r.id]);var c=(null===(i=o.snapshot.children)||void 0===i?void 0:i.map((function(n){return e.blockManager.getRecord(n)})))||[],a=r.snapshot.width_ratio,l=c.reduce((function(e,n){return e+n.snapshot.width_ratio}),a);c.forEach((function(e){var r=e.snapshot.width_ratio/(l-a);n.replace(e.id,["width_ratio"],r)}))}))},e.handleSizeChange=Object(z.throttle)((function(){e.model.traverseInDepthFirstPreOrder((function(n){var r;null===(r=e.blockManager.getBlockViewByBlockIdNotCheck(n.id))||void 0===r||r.onResize()}))}),300),e}return S()(r,[{key:"setBlockStyle",value:function(){var e=this.blockEl;e&&(this.props.isVertical?(e.style.flexGrow="".concat(100*this.state.widthRatio),e.style.width="unset"):(e.style.flexGrow="0",e.style.flexShrink="0",e.style.width="calc((100% - ".concat(this.gapTotalWidth,"px) * ").concat(this.state.widthRatio,")"))),this.id===ne.X.newGridColumnId&&(ne.X.newGridColumnId=null)}},{key:"blockViewDidMount",value:function(){U()(d()(r.prototype),"blockViewDidMount",this).call(this),this.animateOnMount?this.performAnimation(0,this.props.record.snapshot.width_ratio):this.setBlockStyle();var e=this.editorAPI.modelService;this.subs=[this.model.structUpdate$.subscribe(this.handleBlockStructUpdate),e.change$.subscribe(this.handleChange)],this.blockEl.addEventListener("click",this.handleClick),this.resizeObserver=new X.S(this.handleSizeChange),this.resizeObserver.observe(this.blockEl)}},{key:"blockViewDidUpdate",value:function(e,n){U()(d()(r.prototype),"blockViewDidUpdate",this).call(this,e,n);var o=e.record.snapshot.width_ratio,i=this.props.record.snapshot.width_ratio,c=this.state.widthRatio;o!==i&&i!==c&&(this.props.isVertical?this.setState({widthRatio:i}):this.performAnimation(o,i)),n.widthRatio!==c&&(this.setBlockStyle(),this.blockManager.layoutManager.didUpdateNode(this.id,!0)),e.isVertical!==this.props.isVertical&&this.setBlockStyle()}},{key:"blockViewWillUnmount",value:function(){var e;U()(d()(r.prototype),"blockViewWillUnmount",this).call(this),this.blockEl.removeEventListener("click",this.handleClick),this.handleSizeChange.cancel(),this.resizeObserver.disconnect(),null===(e=this.subs)||void 0===e||e.forEach((function(e){return e.unsubscribe()})),this.gridTimer&&clearTimeout(this.gridTimer)}},{key:"render",value:function(){return q.a.createElement("div",{ref:this.ref,className:"grid-column-block"},this.renderChildren(),this.renderPercent())}},{key:"performAnimation",value:function(e,n){var r=this;Object(oe.k)(!0),Object(G.S)(Object(G.x)({from:e,to:n,duration:250,ease:G.d.cubicBezier(0,0,1,1)})).start({update:function(e){var n=P()(e,1)[0],o=r.blockEl;o&&(o.style.flexGrow="0",o.style.flexShrink="0",o.style.width="calc((100% - ".concat(r.gapTotalWidth,"px) * ").concat(n,")"))},complete:function(){r.setState({widthRatio:n},(function(){r.blockManager.layoutManager.didUpdateNode(r.id,!0)})),Object(oe.k)(!1)}})}},{key:"renderPercent",value:function(){var e=W()("grid-column-percent",{"in-vc":J.S.isInVC});return q.a.createElement("span",{className:e},Math.round(100*this.state.widthRatio),"%")}},{key:"animateOnMount",get:function(){var e=this.model,n=e.children[0],r=(null===n||void 0===n?void 0:n.isTextBlock)&&n.isEmpty&&1===e.children.length;return this.id===ne.X.newGridColumnId&&r}},{key:"isWithBoundary",get:function(){return!0}},{key:"gapTotalWidth",get:function(){var e=this.props.parentId,n=null;return e&&this.blockManager.hasBlockModelByBlockId(e)&&(n=this.blockManager.getBlockModelByBlockId(e)),Object(Q.B)(n)}},{key:"blockEl",get:function(){return this.hostElement||function(e){for(var n=null===e||void 0===e?void 0:e.parentElement;n;){if(n.dataset.blockType===v.B.GRID_COLUMN)return n;n=n.parentElement}return null}(this.ref.current)}}]),r}(Z.l);function ue(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}se.blockForLayoutNodeBuilder=new I;var de=(ce=Object(f.H)({providers:[R,{provide:x.B,useClass:x.B},{provide:I,useClass:I},{provide:p.I,useExisting:x.B},{provide:p.I,useExisting:I},{provide:h.RecordSnapshotCreator,useValue:{type:v.B.GRID,create:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.B.GRID;return Object(g.b)(e,n)}}},{provide:h.RecordSnapshotCreator,useValue:{type:v.B.GRID_COLUMN,create:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.B.GRID_COLUMN;return Object(g.b)(e,n)}}}]}),ce((le=function(e){a()(r,e);var n=ue(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).blocks=[[m,{viewCreator:M.S}],[k,{viewCreator:se,blockDeps:["renderProps.isVertical"]}]],e}return r}(f.y),ae=le))||ae)},dx_vnlt:function(e,n,r){"use strict";r.d(n,"L",(function(){return f})),r.d(n,"M",(function(){return h})),r.d(n,"f",(function(){return p})),r.d(n,"T",(function(){return v})),r.d(n,"J",(function(){return g})),r.d(n,"m",(function(){return b}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_O8UM"),a=r("dx_l8lP"),l=r("dx_Lqhf"),s=r("dx_KgXx"),u=r("dx_dVbY"),d=r("dx_DKNI"),f=function(){return Object(c.P)(l.D.Background).get(a.j.COLOR_YELLOW_LIGHT_BACKGROUND)||"rgba(255, 246, 122, 0.8)"};function h(e){var n,r=(n={},i()(n,d.Z.COLOR,""),i()(n,d.Z.BACKGROUND_COLOR,f()),n);if(e){var o=g(e);Object.values(o).some((function(e){return!!e}))&&(r=o)}return r}function p(e){var n,r=e.filter((function(e){return!e.model.isEmpty})),o=(n={},i()(n,d.Z.COLOR,""),i()(n,d.Z.BACKGROUND_COLOR,""),n);if(!r.length||!r[0])return o;var c=Object(u.H)(r[0]),a=r[0].model.getAttributes(c.start,c.end).toMap(),l=a[d.v],s=a[d.Q];return l&&(o[d.Z.COLOR]=l),s&&(o[d.Z.BACKGROUND_COLOR]=s),o}function v(e){var n,r=e.filter((function(e){return!e.model.isEmpty})),o=(n={},i()(n,d.Z.COLOR,new Set([])),i()(n,d.Z.BACKGROUND_COLOR,new Set([])),n);if(!r.length||!r[0])return o;var c=Object(u.H)(r[0]);return r[0].model.zoneState.getEntities(c).forEach((function(e){var n=e.attributes[d.v],r=e.attributes[d.Q];n&&o[d.Z.COLOR].add(n),r&&o[d.Z.BACKGROUND_COLOR].add(r)})),o}function g(e){var n=function(e){var n,r;return e?e.startsWith("{")?JSON.parse(e):(r={},i()(r,d.Z.COLOR,e),i()(r,d.Z.BACKGROUND_COLOR,""),r):(n={},i()(n,d.Z.COLOR,""),i()(n,d.Z.BACKGROUND_COLOR,""),n)}(window.localStorage.getItem("".concat(e,"_TEXTHIGHLIGHT_COLOR")));return"var(--ccmtoken-doc-highlightcolor-sunflower-soft)"===(null===n||void 0===n?void 0:n.backgroundColor)&&(n.backgroundColor=f()),n}function b(e,n){if(!n)return n;var r=Object(c.P)(e),o=Object(s.v)(r,n);return o&&Object(c.D)(e).get(o)||n}},dx_vo6O:function(e,n,r){"use strict";var o,i,c,a,l,s,u,d,f,h=r("dx_yG8O"),p=r.n(h),v=r("dx_lwsE"),g=r.n(v),b=r("dx_W8MJ"),y=r.n(b),m=r("dx_PJYZ"),_=r.n(m),k=r("dx_W7W2"),O=r.n(k),x=r("dx_a1gu"),E=r.n(x),S=r("dx_Nsbk"),C=r.n(S),I=r("dx_Uyc2"),B=r.n(I),T=(r("dx_A1AB"),r("dx_Vvd7")),w=r("dx_N9dL"),R=r("dx_T4T0"),M=r("dx_Z22N"),j=r("dx_B28d"),D=r("dx_tXxH"),A=r("dx_aJ6H"),P=r("dx_xjz2"),L=r("dx_UtDZ"),N=r("dx_YRGG"),F=Object(P.s)(N.h)(o=function(){function e(){g()(this,e),this.type=j.B.SHEET}return y()(e,[{key:"fetchResource",value:function(){return Object(L.loadDocSheetBridge)()}}]),e}())||o,U=r("dx_OPAz"),H=r("dx_o0o1"),V=r.n(H),W=r("dx_RIqP"),z=r.n(W),G=r("dx_yXPU"),K=r.n(G),q=r("dx_QxNg"),X=r("dx_Xdvu"),Y=r("dx_NpE2"),J=r("dx_D8nn"),Z=r("dx_GLPm"),Q=Object(P.s)(U.H)((l=function(){function e(){var n=this;g()(this,e),this.bridge=void 0,this.sheetToolbar=void 0,this.membersBeforeSetup=void 0,this.initPromise=void 0,this.inited=!1,this.initOptions=void 0,this.shouldEnterTranslateModeAfterInit=!1,p()(this,"context",a,this),this.token="",this.reporter=new Y.W,this.getToolbar=function(){return!n.sheetToolbar&&n.bridge&&(n.sheetToolbar=document.createElement("div"),n.bridge.bridge.setToolbarHost(n.sheetToolbar)),n.sheetToolbar},this.preloadBridge=function(){Object(L.loadDocSheetBridge)()},this.init=function(){var e=K()(V.a.mark((function e(r,o){var i,c,a;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.inited=!1,n.initPromise=void 0,n.token=r,n.initOptions=o,n.sheetToolbar=null,a=(null===o||void 0===o?void 0:o.isHistory)||!1,n.bridge=new L.LoadableSheetBridge({token:r,editor:null,isTemplate:n.isPreview||!1,getOrders:n.getAllSheetIdInOrder,getMountStatus:function(){return!0},isInHistory:a}),e.next=9,Object(L.loadDocSheetBridge)();case 9:return e.next=11,Object(q.E)(0);case 11:""===r||a||n.bridge.fetchClientVars(z()(new Set(n.getAllSheetIdInOrder()))),n.membersBeforeSetup&&n.notifyMembersUpdate(n.membersBeforeSetup),null===(i=(c=n.bridge).setUpdateToolbarFn)||void 0===i||i.call(c,(function(e){J.S.emit(J.p.MOBILE.SHEET.SET_TOOLBAR_DATA,e)})),n.inited=!0,n.shouldEnterTranslateModeAfterInit&&L.store.getState().appState.translate.status.translated&&n.enterTranslateMode(),n.shouldEnterTranslateModeAfterInit=!1;case 17:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),this.resetBridge=K()(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.initPromise=n.init(n.token,n.initOptions),e.next=3,n.initPromise;case 3:case"end":return e.stop()}}),e)}))),this.enterTranslateMode=K()(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.bridge){e.next=3;break}return!n.inited&&L.store.getState().appState.translate.config.enable_auto_translate&&(n.shouldEnterTranslateModeAfterInit=!0),e.abrupt("return");case 3:return n.unmountAllSheet(n.bridge),n.bridge.destroy(),e.next=7,n.resetBridge();case 7:return e.next=9,n.bridge.enterTranslateMode();case 9:case"end":return e.stop()}}),e)}))),this.onChangeTranslateLang=K()(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.bridge){e.next=2;break}return e.abrupt("return");case 2:return n.unmountAllSheet(n.bridge),n.bridge.destroy(),e.next=6,n.resetBridge();case 6:return e.next=8,n.bridge.enterTranslateMode();case 8:case"end":return e.stop()}}),e)}))),this.exitTranslateMode=K()(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.bridge){e.next=2;break}return e.abrupt("return");case 2:return n.unmountAllSheet(n.bridge),n.bridge.destroy(),e.next=6,n.resetBridge();case 6:return e.next=8,n.bridge.exitTranslateMode();case 8:case"end":return e.stop()}}),e)}))),this.getAllSheetIdInOrder=function(){var e=[];return n.blockManager.recordManager.traverse(n.blockManager.rootRecordId,(function(n){if(n.snapshot.type===j.B.SHEET){var r=Object(Z.U)(n.snapshot.token).id;e.push(r||n.id)}return!0})),e},this.notifyMembersUpdate=function(e){var r,o;n.bridge?(n.membersBeforeSetup=null,null===(r=(o=n.bridge).notifyMembersUpdate)||void 0===r||r.call(o,e)):n.membersBeforeSetup=e},this.getBridge=function(){var e=K()(V.a.mark((function e(r,o){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.inited){e.next=4;break}return n.initPromise||(n.initPromise=n.init(r,o)),e.next=4,n.initPromise.catch((function(e){throw n.initPromise=void 0,e}));case 4:return e.abrupt("return",n.bridge);case 5:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),this.getLoadedBridge=function(){return n.bridge},this.destroy=function(){J.S.off(J.p.TRANSLATE.TRANSLATE_EVENT_DONE,n.enterTranslateMode),J.S.off(J.p.TRANSLATE.TRANSLATE_LANGUAGE_CHANGE,n.onChangeTranslateLang),J.S.off(J.p.TRANSLATE.TRANSLATE_EVENT_CLOSE,n.exitTranslateMode),n.sheetToolbar&&(n.sheetToolbar=null,n.bridge.bridge.setToolbarHost(null)),n.inited=!1,n.initPromise=void 0,n.token="",n.initOptions=void 0,n.bridge&&n.bridge.destroy(),n.bridge=null},J.S.on(J.p.TRANSLATE.TRANSLATE_LANGUAGE_CHANGE,this.onChangeTranslateLang),J.S.on(J.p.TRANSLATE.TRANSLATE_EVENT_DONE,this.enterTranslateMode),J.S.on(J.p.TRANSLATE.TRANSLATE_EVENT_CLOSE,this.exitTranslateMode)}return y()(e,[{key:"unmountAllSheet",value:function(){var e=K()(V.a.mark((function e(n){var r,o,i,c,a,l=this;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(r=this.bridge)||void 0===r||null===(o=r.bridge)||void 0===o||null===(i=o.sheetManager)||void 0===i?void 0:i.mountedSheets){e.next=2;break}return e.abrupt("return");case 2:return c=z()(n.bridge.sheetManager.mountedSheets),a=c.map((function(e){return l.bridge.unmountSheet(e)})),e.next=6,Promise.allSettled(a).catch((function(e){return console.error(e)}));case 6:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"config",get:function(){return this.blockManager.editorAPI.config}},{key:"blockManager",get:function(){return this.context.blockManager}},{key:"isPreview",get:function(){return this.config.get("isPreview")}}]),e}(),c=l,a=B()(c.prototype,"context",[X.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),i=c))||i,$=r("dx_CweE");function ee(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=C()(e);if(n){var i=C()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return E()(this,r)}}var te=Object(T.H)({providers:[F,Q,{provide:M.I,useClass:R.V,args:[j.B.SHEET,{isAsync:!0,canLazyIdleRender:!1,defaultHeight:220}]},{provide:w.RecordSnapshotCreator,useValue:{type:j.B.SHEET,create:D.R}}]})((f=function(e){O()(r,e);var n=ee(r);function r(){var e;g()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),p()(e,"depLoader",d,_()(e)),e.blocks=[[A.S,{viewCreator:$.S}]],e}return y()(r,[{key:"destroy",value:function(){this.depLoader.destroy()}}]),r}(T.y),u=f,d=B()(u.prototype,"depLoader",[U.H],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),s=u))||s;n.S=te},dx_vpSr:function(e,n,r){},dx_vqyt:function(e,n,r){"use strict";r.d(n,"S",(function(){return Re}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_YjoZ"),s=r("dx_VAwJ"),u=r("dx_UHze"),d=r("dx_B28d"),f=r("dx_bkVC"),h=r("dx_UTG8"),p=r("dx_HirW");var v=r("dx_RIqP"),g=r.n(v),b=r("dx_e4eN"),y=r("dx_alfx"),m=r("dx_NbrS"),_=r("dx_WXfY"),k=r("dx_gA4Q"),O=r("dx_zghO");var x=r("dx_lSNA"),E=r.n(x),S=r("dx_eSV8"),C=r("dx_a7X6"),I=r("dx_ZG9w"),B=r("dx_kZ3l");function T(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function w(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?T(Object(r),!0).forEach((function(n){E()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):T(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var R=r("dx_n8nr");function M(e){var n=e.data,r=e.parentBlockStruct,o=e.blockManager,i=r.record.id,c=o.getBlockIdsByRecordId(i)[0],a=o.getBlockModelByBlockId(c);R.S.isValidParentType(a.record.snapshot.type,a)||function(e){var n=e.recordIds,r=e.recordMap,o=j(n,r);e.recordIds=o}(n)}function j(e,n){return e.reduce((function(e,r){var o=n[r];if(o.snapshot.type===d.B.GRID){var i=o.snapshot.children.reduce((function(e,r){var o=n[r];return e.push.apply(e,g()(o.snapshot.children)),e}),[]);e.push.apply(e,g()(i))}else o.snapshot.children&&o.snapshot.children.length&&(o.snapshot.children=j(o.snapshot.children,n)),e.push(r);return e}),[])}var D=r("dx_UtDZ"),A=r("dx_C7Cb"),P=r("dx_FHaN");var L=r("dx_cQo6");function N(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function F(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?N(Object(r),!0).forEach((function(n){E()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var U=r("dx_xs2W"),H=r("dx_XCzS"),V=r("dx_h8uR"),W=function(e){if(!Object(H.P)())return!1;var n=e.blockManager,r=e.url,o=function(e){var n;return(null===(n=e.editorAPI.getService(V.b).getAuthStatus())||void 0===n?void 0:n.baseUrl)||""}(n),i=new RegExp("".concat(o));return new RegExp("^(".concat(i.source,"/((").concat(/((browse)|(projects\/[^\s]+\/issues))\//.source,")|(").concat(/[^\s]+\/[^\s]+\?selectedIssue=/.source,"))(").concat(/[A-Z0-9]+-[0-9]+/.source,"))$"),"i").test(r)},z=r("dx_JoJM"),G=r("dx_Y27Y"),K=[G.L.TEXT,G.L.HTML,G.L.DOCX_TEXT,G.L.URI_LIST];var q=r("dx_Urdh"),X=r("dx_vdIl"),Y=r("dx_AMht"),J=r("dx_B8Bh");var Z=r("dx_xIqD");var Q=r("dx_J4zp"),$=r.n(Q),ee=r("dx_h6a8");var te=r("dx_K9KW");function ne(e,n){return"docx/record"===n?e.replace(/\r\n/g,"\n").replace(/\r/g,""):e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")}var re=r("dx_k9kc"),oe=r("dx_Dsxx"),ie=r("dx_rldU");function ce(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return ae(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ae(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function ae(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function le(e){var n=e.editorContext.proxyClipboardData,r=e.data,o=e.isPasteIntoBlock,i=e.blockManager,c=e.selectedBlocks;if(n){var a=function(e,n,r){var o="other",i=e.getData(G.L.DOCX_RECORD)||e.getData(G.L.DOCX_TEXT);if(i){var c;o=r.getRootRecordId()===(null===(c=JSON.parse(i))||void 0===c?void 0:c.rootId)?"within_docs":"cross_docs_docx"}else e.getData("application/x-editor-kit-business-key")&&(o="cross_docs_doc");var a=function(e){var n,r=e.recordIds,o=e.recordMap,i=!1,c=!1,a=!1,l=!1,s=ce(r);try{for(s.s();!(n=s.n()).done;){var u=o[n.value].snapshot;if(u.type.startsWith("heading")&&"auto"===u.seq){i=!0,c=!0;break}}}catch(d){s.e(d)}finally{s.f()}return{includesAutoOrderedHeading:String(i),hasOlHeading:String(c),hasUlHeading:String(a),hasTodoHeading:String(l)}}(n),l=a.includesAutoOrderedHeading,s=a.hasOlHeading,u=a.hasUlHeading,d=a.hasTodoHeading;return{value1:o,value2:l,value3:s,value4:u,value5:d}}(n,r,i);Object(re.Fi)({actionObject:o?ie.u.TEXT:ie.u.BLOCK,source:oe.G.content_page,blockManager:i,actionType:re.F.paste,actionValue:a,blocks:c,click:re.c.hotkey_action},{paste_block_data:se(e)})}}function se(e){var n=e.applyRecordIds,r=e.blockManager,o=n.reduce((function(e,n){var o=r.getRecord(n).snapshot.type;return e[o]?e[o]++:e[o]=1,e}),{});return Object.entries(o).map((function(e){var n=$()(e,2);return{paste_block_type:n[0],paste_block_cnt:n[1]}}))}var ue=r("dx_PQBD"),de=r("dx_bbfH"),fe=r("dx_BEcL"),he=r("dx_QBqw"),pe=r("dx_tsDa");function ve(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return ge(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ge(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function ge(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function be(e){var n=e.selectedBlocks,r=e.data,o=e.blockManager,i=e.op,c=e.createRecord,a=e.editorContext,l=Object(pe.U)(o,n),s=Object(pe.e)(o,n),u=function(e){var n=e.recordIds,r=e.recordMap;return 1===n.length&&r[n[0]].snapshot.type===d.B.TABLE}(r),f=function(e){var n=e.recordIds,r=e.recordMap;return n.every((function(e){return r[e].snapshot.type===d.B.CELL}))}(r);if(l&&!u&&!f){var h=Object(pe.t)(o,n.map((function(e){return e.id}))),p=[];return n.forEach((function(n){var r=o.getBlockModelByBlockId(n.id),i=r.children;if(n.id===h){var c=i[0];e.selectedBlocks=[{id:c.id,type:O.j.BLOCK}],e.parentBlockStruct=r,i=r.children.slice(1)}p.push.apply(p,g()(i.map((function(e){return e.id}))))})),void p.forEach((function(e){var n=o.getBlockModelByBlockId(e);i.removeChildren(n.parent.recordId,[n.recordId])}))}if(s&&(u||f)){var v=Object(ue.i)(o.modelService,n[0].id,d.B.CELL);if(!v)return void console.error("???? why not table????");var b=Object(pe.t)(o,[v.id]);if(!b)return void console.error("why shit no left top cell???");var y=o.getBlockViewByBlockId(b),m=o.getBlockModelByBlockId(b).parent,_=m.record.id,k=m.record.snapshot,x=Object(he.B)(y.cellId,k),S=u?function(e){var n=e.recordIds[0];return e.recordMap[n].snapshot}(r):function(e){var n=e.recordIds,r=Object(he.f)(1),o=Object(he.b0)(n.length),i={columns_id:r,rows_id:o,column_set:E()({},r[0],{column_width:de.ug}),cell_set:n.reduce((function(e,n,i){return e["".concat(o[i]).concat(r[0])]={block_id:n,merge_info:{col_span:1,row_span:1}},e}),{}),type:d.B.TABLE},c=Object(A.S)();return e.recordIds=[c],e.recordMap[c]={snapshot:i,id:c},i}(r),C=k.rows_id.slice(),I=k.columns_id.slice();!function(e){var n=e.tableSnapshot,r=e.copyTableSnapshot,o=e.cellIndex,i=e.rows_id,c=e.op,a=e.tableRecordId,l=e.columns_id,s=function(e,n,r){var o=$()(r,2),i=o[0],c=o[1],a=i+n.rows_id.length,l=c+n.columns_id.length;return[a-e.rows_id.length,l-e.columns_id.length]}(n,r,o),u=$()(s,2),d=u[0],f=u[1];d>0&&i.push.apply(i,g()(ye(c,[a,"rows_id",i.length],d)));f>0&&l.push.apply(l,g()(ye(c,[a,"columns_id",l.length],f)))}({tableSnapshot:k,copyTableSnapshot:S,tableRecordId:_,cellIndex:x,rows_id:C,columns_id:I,op:i});var B=function(e){for(var n=e.copyTableSnapshot,r=e.cellIndex,o=e.rows_id,i=e.columns_id,c=e.tableSnapshot,a=e.op,l=e.tableRecordId,s=e.data,u=e.blockManager,d=e.appliedChildren,f=e.createRecord,h=[],p=0;p<n.rows_id.length;p++)for(var v=function(e){var v,g=r[0]+p,b=r[1]+e,y="".concat(o[g]).concat(i[b]);h.push(y);var m=null===(v=c.cell_set[y])||void 0===v?void 0:v.block_id;m||(m=Object(fe.c)(a,l,y));var _="".concat(n.rows_id[p]).concat(n.columns_id[e]),k=n.cell_set[_];if(!k)return"continue";var O=k.block_id,x=s.recordMap[O],E=x.snapshot.children.map((function(e){return f(e,m)}));a.replaceChildren(m,E),a.replace(l,["cell_set",y,"merge_info"],k.merge_info);var S=u.getBlockIdsByRecordId(m)[0];d[S]={oldRecordIds:x.snapshot.children,newRecordIds:E}},g=0;g<n.columns_id.length;g++)v(g);return h}({copyTableSnapshot:S,cellIndex:x,rows_id:C,columns_id:I,tableSnapshot:k,op:i,tableRecordId:_,data:r,blockManager:o,appliedChildren:{},createRecord:c});!function(e){for(var n=e.rows_id,r=e.columns_id,o=e.op,i=0;i<n.length;i++)for(var c=0;c<r.length;c++){var a="".concat(n[i]).concat(r[c]);if(e.isCellExist(a)){var l=Object(fe.c)(o,e.tableRecordId,a);Object(fe.n)(o,l)}}}({rows_id:C,columns_id:I,tableRecordId:_,isCellExist:function(e){return!k.cell_set[e]&&!B.includes(e)},op:i}),(u||f)&&delete r.recordMap[r.recordIds.shift()],a.selectionAPI.removeAllSelection()}}function ye(e,n,r){var o=$()(n,3),i=o[0],c=o[1],a=o[2];if(!c||!i)return console.error("Invalid params path"),[];var l="rows_id"===c?Object(he.b0)(r):Object(he.f)(r);if(e.insert(i,[c,a],l),"columns_id"===c){var s,u=ve(l);try{for(u.s();!(s=u.n()).done;){var d=s.value;e.insert(i,["column_set",d],{column_width:de.ug})}}catch(f){u.e(f)}finally{u.f()}}return l}var me=r("dx_bfji"),_e=r("dx_wJkD"),ke=r("dx_l6lq");function Oe(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}var xe=[d.B.SHEET,d.B.BITABLE];function Ee(e){var n,r=e.format,o=e.blockManager,i=e.selectedBlocks,c=e.data,a=c.recordIds,l=c.recordMap,s=c.payloadMap;if(r===G.L.HTML&&1===a.length&&Object(pe.e)(o,i)){var u=l[a[0]],f=u.snapshot,h=u.id;if(xe.includes(f.type)){var p=null===(n=s[h])||void 0===n?void 0:n.html;if(p){var v=new me.S,g=document.createElement("div");g.id="block-root",g.appendChild(p);var b=function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Oe(Object(r),!0).forEach((function(n){E()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oe(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}({},_e.S);delete b.bitable,delete b.sheet,delete b.table.preprocess;var y=Object(ke.h)(v.build(v.newPathNode(g),g,b),o),m=y.recordIds,_=y.recordMap,k=y.payloadMap;_[m[0]].snapshot.type===d.B.TABLE&&(a.splice(0,1,m[0]),delete l[h],delete s[h],Object.assign(l,_),Object.assign(s,k))}}}}var Se,Ce,Ie,Be,Te,we=r("dx_C1Ca");Se=we.q.preprocessData,Ce=we.q.beforeBlockDataApply,Ie=we.q.afterBlockIdCreated,Be=we.q.onDataApply,Te=we.q.onDataAccept;var Re=function(){function e(n,r,o){var c=this;i()(this,e),this.blockManager=n,this.data=r,this.hooks=o,this.callHook=function(e,n){var r;null===(r=c[e])||void 0===r||r.call(c,n)},this.iterateTempIdMap=function(e,n,r){e.forEach((function(e){var o=n.get(e);r({tempId:o,newRecordId:e})}))}}return a()(e,[{key:Se,value:function(e){!function(e){var n=e.selectedBlocks,r=e.blockManager,o=n.map((function(o){if(o.type!==O.j.BLOCK)return o;var i=r.getBlockModelByBlockId(o.id).parent;return i?(i.type!==d.B.VIEW||(1===n.length&&(e.parentBlockStruct=i.parent),o.id=i.id),o):o}));e.selectedBlocks=o}(e),function(e){var n=e.data,r=n.recordMap,o=n.recordIds,i=n.payloadMap,c=new Map,a="ROOT";Object(p.H)(o,r,(function(e,n){var r;n||(n=a);var o=null===(r=i[e])||void 0===r?void 0:r.usedToBeQuote,l=c.get(n);if(o){l||(l={result:[],prevBlockIsUseToBeQuote:!1},c.set(n,l));var s=l,u=s.result,d=s.prevBlockIsUseToBeQuote;l.prevBlockIsUseToBeQuote=!0;var f=Object(ee.last)(u);return d&&f?f.push(e):u.push([e]),{stop:!0}}l&&(l.prevBlockIsUseToBeQuote=!1)})),Array.from(c.entries()).forEach((function(e){var n=$()(e,2),i=n[0],c=n[1].result,l=i===a?o:r[i].snapshot.children;c.forEach((function(e){var n=Object(A.S)();r[n]={id:n,snapshot:{children:e,type:d.B.QUOTE_CONTAINER}};var o=l.findIndex((function(n){return n===e[0]}));l.splice(o,e.length,n)}))}))}(e),Ee(e),Object(q.w)(e),function(e){var n=e.data.recordIds[0],r=e.data.recordMap[n];r.snapshot.type===d.B.PAGE&&(r.snapshot.type=d.B.TEXT)}(e),function(e){var n=e.blockManager,r=e.selectedBlocks,o=e.data,i=o.recordIds,c=o.recordMap,a=c[i[0]].snapshot,l=a.text;if(function(e,n){return e.getBlockModelByBlockId(n[0].id).isRoot}(n,r)&&[].concat(g()(d.hI),[d.B.PAGE]).includes(a.type)){var s,u=Object(f.h)(),p=u.from,v=u.pasteTimes;if(p!==d.G.innerCutPaste||v)s=h.InputPipe.deserializePlainText(Object(_.X)(a,n.recordManager));else{var b=Object(y.Z)(l.initialAttributedTexts,l.apool),m={hasRecord:function(e){return!!c[e]},getRecord:function(e){return c[e]}},k="",O=b.get(X.x).ops.map((function(e){var n=Object(_.G)(e,m,!0),r={text:e.insert,mark:{}};n&&(r.text=n);var o=e.attributes;return o&&Object.keys(o).forEach((function(e){e.startsWith("comment-id")&&(r.mark[e]=o[e])})),k+=r.text,r}));s=h.InputPipe.deserialize({alltext:k,size:k.length,nodes:O})}c[i[0]].snapshot.text=s}}(e),Object(te.A)(e),function(e){var n,r=e.selectedBlocks,o=e.blockManager,i=e.data;if(r[0].type!==O.j.BLOCK){var c=i.recordIds,a=i.recordMap,l=i.payloadMap;if(o.getBlockModelByBlockId(r[0].id).type===d.B.CODE){var s=[],u="",f={alltext:u,size:0,nodes:s},h={hasRecord:function(e){return!!a[e]},getRecord:function(e){return a[e]}};Object(p.H)(c,a,(function(e){var n=a[e].snapshot;if(n.text){var r=n.text,o=Object(y.Z)(r.initialAttributedTexts,r.apool).get("0");o.forEach((function(n){var r=(l[e]||{}).level||1,o=new Array(2*(r-1)+1).join(" ");return n.insert=o+(Object(_.G)(n,h,!1,!0)||n.insert),Object(m.R)(n.attributes),u+=n.insert,n})),o.ops.length?o.ops[o.ops.length-1].insert+="\n":o.insert("\n"),u+="\n",s.push.apply(s,g()(o.ops))}else console.error("\u8fc7\u6ee4\u6a21\u5757\u5e94\u8be5\u628a\u975e text block \u7684\u90fd\u8fc7\u6ee4\u6389\u4e86\uff0c\u4e3a\u4ec0\u4e48\u8fd8\u6709\u4e0d\u5e26 text \u7684\u5462")}));var v=null===(n=s[s.length-1])||void 0===n?void 0:n.insert;if(v){s[s.length-1].insert=v.substring(0,v.length-1),f.size=u.length-1,f.alltext=u.substring(0,u.length-1),i.recordIds.splice(0,i.recordIds.length-1);var x=new k.h("0",new b.m({zoneId:"0",ops:f.nodes}));a[c[0]]={id:c[0],snapshot:{text:x.toAttributeText(),type:d.B.TEXT}}}}}}(e),function(e,n){var r=e.data,o=e.format,i=r.recordIds,c=r.recordMap;Object(p.H)(i,c,(function(e){var r=c[e].snapshot;if(r.text){var i=h.InputPipe.serialize(r.text);i.alltext=ne(i.alltext,o),i.nodes.forEach((function(e){if(e.text=ne(e.text,o),e.mark){if(e.mark.link)try{var r=decodeURIComponent(e.mark.link);e.mark.link=Object(U.z)(r,!0)}catch(i){console.error("decode url error",e.mark.link,i)}n.forEach((function(n){delete e.mark[n]}))}})),r.text=h.InputPipe.deserialize(i)}}))}(e,["grammarly-data","abbreviation-data","change_id","__edit_add","__edit_change","__edit_del"]),function(e){var n=e.data,r=n.recordMap,o=n.payloadMap;Object.values(r).forEach((function(e){var n=e.snapshot;Object(I.S)(n)&&Object(I.u)(n.text).forEach((function(e){if(e.source_block_id){var n=Object(p.l)(e);Object(L.Z)(n,r,o)}}))}))}(e),function(e){var n=e.data,r=e.isPasteIntoBlock,o=n.recordIds,i=n.recordMap,c=Object(f.h)(),a=c.from,l=c.pasteTimes,v=Object(u.K)().userId||"";!r&&a===d.G.innerCutPaste&&l<1||Object(p.H)(o,i,(function(e){var n=i[e].snapshot;if(n.text){var r=h.InputPipe.serialize(n.text);r.nodes.forEach((function(e){e.mark||(e.mark={}),e.mark[s.R.KEY]=v})),n.text=h.InputPipe.deserialize(r)}}))}(e),function(e){var n=e.data,r=n.recordIds,o=n.recordMap;Object(p.H)(r,o,(function(e){var n=o[e].snapshot;if(n.text){var r=h.InputPipe.serialize(n.text);r.nodes.forEach((function(e){e.mark||(e.mark={});var n=e.mark;if(void 0!==n[P.O]){var r=JSON.parse(n[P.O]);switch(r.id=Object(A.S)(),r.type){case P.k.REMINDER:r.data.create_user_id=D.userHelper.getCurrentUser().get("id");break;case P.k.FILE:r.data.need_copy_resource=!0;break;case P.k.USER:delete r.data.mention_id}e.mark[P.O]=JSON.stringify(r)}})),n.text=h.InputPipe.deserialize(r)}}))}(e),function(e){var n=e.data,r=n.recordMap,o=n.payloadMap;Object.values(r).forEach((function(e){var n=e.snapshot;Object(I.S)(n)&&Object(I.W)(n).forEach((function(e){var n=r[e];if(n){var i={id:n.id,snapshot:F(F({},n.snapshot),{},{creatorId:D.userHelper.getCurrentUser().get("id")})};Object(L.Z)(i,r,o)}}))}))}(e)}},{key:Ce,value:function(e){!function(e){var n=e.blockManager,r=e.data,o=e.op,i=e.selectedBlocks;if(e.isSelectRoot){var c=r.recordIds,a=r.recordMap[c[0]].snapshot,l=i[0].id,s=n.getBlockViewByBlockId(l),u=i[0].selection,f=u.start,h=u.end-f===s.model.getText().length-1,p=Object(J.K)(a.type);if(h&&(p||a.type.startsWith("heading")||a.type===d.B.QUOTE)){var v=a.children||[],m=a.text;if(Y.S.lineEditable){if(!m)return;var _=s.model,k=_.zoneId,O=_.zoneState,x=Object(y.Z)(m.initialAttributedTexts,m.apool).get("0"),E=new b.m({zoneId:k}).delete(O.totalWidth()-1).concat(x);s.model.apply(E,{extra:{op:o}})}else o.replace(s.record.id,["text"],m);0===v.length?c.shift():(c.shift(),c.unshift.apply(c,g()(v)))}}}(e),M(e),be(e)}},{key:Ie,value:function(e){var n,r;null===(n=this.hooks)||void 0===n||null===(r=n[we.q.afterBlockIdCreated])||void 0===r||r.call(n,e)}},{key:Be,value:function(e){var n,r;null===(n=this.hooks)||void 0===n||null===(r=n.onDataApply)||void 0===r||r.call(n,e),le(e),function(e){var n,r=ce(se(e));try{for(r.s();!(n=r.n()).done;){var o=n.value,i=o.paste_block_type,c=o.paste_block_cnt;[d.B.JIRA_ISSUE,d.B.JIRA_FILTER].includes(i)&&Object(D.collectEvent)("ccm_doc_insert_jira_click",{target:"none",jira_block_type:i,insert_source:"".concat(Object(f.OZ)()?"cut":"copy","_and_paste"),block_num:c})}}catch(a){r.e(a)}finally{r.f()}}(e),function(e){var n=e.format,r=e.blockManager,o=e.applyRecordIds;if(console.log("[link/tryTransformLink] type=",n),K.includes(n)&&1===o.length){var i=o.map((function(e){return r.getBlockIdsByRecordId(e)[0]})),c=r.getBlockViewByBlockId(i[0]);if(Object(I.f)(c)&&![d.B.PAGE,d.B.CODE].includes(c.type)){var a=e.range?e.range:{zoneId:c.model.zoneId,start:0,len:c.model.getText().length},l=e.data,s=l.recordIds,u=l.recordMap[s[0]].snapshot,f=h.InputPipe.getPlainText(u.text);try{var p=Object(U.u)(c,f,[a.start,a.start+a.len]),v=1===p.length&&D.CCMBlockitSDK.isBlockitSchema(f),g=n===G.L.TEXT||n===G.L.URI_LIST,b=1===p.length&&U.x.test(f)&&!v,y=1===p.length&&Object(U.t)(f)&&!v,m=1===p.length&&c.type!==d.B.TASK&&W({url:f,blockManager:r}),_=z.S.create(c,e.editorContext.selectionAPI);p.forEach((function(e){_.push({range:Object(B.j)(c,e.range).toPosition(),value:e.value,source:"paste",toMention:g,toBookmark:b,toIframe:y,toJiraIssue:m,toISVBlock:v})}))}catch(k){console.error("transform link error:",k)}}}}(e),function(e){var n=e.isPasteIntoBlock,r=e.range,o=e.blockManager;e.applyRecordIds.forEach((function(e){var i=o.getBlockModelsByRecordId(e)[0];if(i&&Object(I.i)(i)&&![d.B.PAGE,d.B.CODE].includes(i.type)){var c=i.zoneState;if(n){if(!r)return;var a=Object(B.JI)(c,[r.start,r.start+r.len]);c.getEntities(a).forEach((function(e){var n=e.start,r=e.end,o=e.attributes;if(void 0!==o[C.h.KEY]){var c=Object(S.I)(8);C.h.initEquationSet.add(c),i.setAttributes({start:n,end:r},w(w({},o),{},{objectID:c}),{type:"transformEquationId"})}}))}else c.getEntities([[C.h.KEY]]).forEach((function(e){var n=e.start,r=e.end,o=e.attributes,c=Object(S.I)(8);C.h.initEquationSet.add(c),i.setAttributes({start:n,end:r},w(w({},o),{},{objectID:c}),{type:"transformEquationId"})}))}}))}(e),this.onDataApplyOrAccept(e,"onDataApply","onPasteRecordAfterApply")}},{key:Te,value:function(e){var n,r;!function(e){var n=e.blockManager;e.applyRecordIds.forEach((function(e){var r=n.getBlockModelsByRecordId(e)[0];(null===r||void 0===r?void 0:r.type)===d.B.POLL&&Z.T.updatePollPublish(e)}))}(e),null===(n=this.hooks)||void 0===n||null===(r=n.onDataAccept)||void 0===r||r.call(n,e),this.onDataApplyOrAccept(e,"onDataAccept","onPasteRecordAfterAccepted")}},{key:"onDataApplyOrAccept",value:function(e,n,r){var o=e.recordIdToTempIdMap,i=e.applyRecordIds,c=this.blockManager,a=this.data,s=[];this.iterateTempIdMap(i,o,(function(e){var o=e.tempId,i=e.newRecordId,u=c.getBlockIdsByRecordId(i)[0];(!Object(l.C)()||"onDataAccept"===n)&&c.layoutManager.renderNodeByIdSync(u);var d=c.getBlockModelByBlockIdNotCheck(u);if(d)try{var f;null===(f=d[r])||void 0===f||f.call(d,a.payloadMap[o]||{})}catch(h){console.error("".concat(n," error for block ").concat(u),h)}else s.push(i)})),s.length?console.error("".concat(n,": fail to get instance for ").concat(s.length," of ").concat(i.length," blocks:"),s):console.info("".concat(n,": handled ").concat(i.length," blocks"))}}]),e}()},dx_vrvQ:function(e,n,r){"use strict";var o=r("dx_J4zp"),i=r.n(o),c=r("dx_QILm"),a=r.n(c),l=r("dx_I4IM"),s=r.n(l),u=r("dx_TSYQ"),d=r.n(u),f=r("dx_cDcd"),h=r.n(f),p=r("dx_CqjN");n.S=function(e){var n=e.sharkOffset,r=void 0===n?5:n,o=a()(e,["sharkOffset"]),c=Object(f.useState)(),l=i()(c,2),u=l[0],v=l[1],g=Object(f.useState)(),b=i()(g,2),y=b[0],m=b[1],_=Object(f.useState)(),k=i()(_,2),O=k[0],x=k[1],E=function(e){var n=Object(p.q)(e),r=n.clientX,o=n.clientY;v(r),m(o)},S=function(e){var n=Object(p.q)(e),o=n.clientX,i=n.clientY;(u&&Math.abs(u-o)>r||y&&Math.abs(y-i)>r)&&(x(!0),v(void 0),m(void 0))},C=function(){x(void 0),v(void 0),m(void 0)};return h.a.createElement(s.a,Object.assign({},o,{className:d()(o.className,"ghost-btn",{disabled:O}),onTouchStart:E,onTouchMove:S,onTouchEnd:C,onMouseDown:E,onMouseMove:S,onMouseUp:C}))}},dx_vwWk:function(e,n,r){"use strict";r.d(n,"R",(function(){return l})),r.d(n,"r",(function(){return s}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_C7Cb"),a=r("dx_ukKW");function l(e){var n=document.createElement(e.tagName);e.attrs&&Object.entries(e.attrs).forEach((function(e){var r=i()(e,2),o=r[0],c=r[1];return n.setAttribute(o,c)})),e.recordId&&(n.className="".concat(n.className," old-record-id-").concat(e.recordId));var r=e.text||"";if(e.children){var o="";e.children.forEach((function(e){var n=l(e);o+=n})),r+=o}return"".concat(n.outerHTML.replace(new RegExp("(</".concat(e.tagName,">)$"),"i"),"")+r,"</").concat(e.tagName,">")}function s(e,n,r){var o=e.getBlockIdsByRecordId(n)[0],i=e.getBlockModelByBlockId(o).record.snapshot,l=i.image,s=l.height,u=l.width,d=l.token,f=l.mimeType,h=l.size,p=encodeURIComponent(Object(a.T)(d,n));r||(r=i.image.scale);var v=s*r,g=u*r;return{uuid:Object(c.S)(),height:v,width:g,currHeight:v,currWidth:g,natrualHeight:s,natrualWidth:u,pluginName:"imageUpload",scale:r,src:p,file_token:d,image_type:f,size:h,comments:[]}}},dx_vxMA:function(e,n,r){"use strict";r.d(n,"S",(function(){return u}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_UtDZ"),s=function(){function e(){var n=this;i()(this,e),this.recordIdToFunc=new Map,this.highQueues=[],this.normalQueues=[],this.isRunning=!1,this.timer=void 0,this.curRecordId="",this.curRecordIdFrom="",this.run=function(){n.isRunning||(n.isRunning=!0,n.reconciler())},this.stopRender=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];n.isRunning&&(n.isRunning=!1,n.timer&&clearTimeout(n.timer),n.curRecordIdFrom&&e&&n[n.curRecordIdFrom].unshift(n.curRecordId),n.curRecordId="")}}return a()(e,[{key:"push",value:function(e,n){var r=this,o=e.recordId,i=e.func;this.updateQueus(o,n),this.recordIdToFunc.set(o,i),this.isRunning||setTimeout((function(){r.run()}),100)}},{key:"delete",value:function(e){var n=this.highQueues.findIndex((function(n){return n===e})),r=this.normalQueues.findIndex((function(n){return n===e}));n>-1&&this.highQueues.splice(n,1),r>-1&&this.normalQueues.splice(r,1),this.jumpCurRender(e),console.info("~~ delete ".concat(Object(l.encryptTea)(e)))}},{key:"jumpCurRender",value:function(e){e===this.curRecordId&&(console.info("~~ jumpCurRender ".concat(Object(l.encryptTea)(e))),this.stopRender(!1),this.run())}},{key:"reset",value:function(){this.isRunning=!1}},{key:"reconciler",value:function(){var n=this;this.highQueues.length||this.normalQueues.length?(this.highQueues.length?(this.curRecordId=this.highQueues.shift(),this.curRecordIdFrom="highQueues"):(this.curRecordId=this.normalQueues.shift(),this.curRecordIdFrom="normalQueues"),this.timer=setTimeout((function(){n.render()}),e.INTERVAL)):this.stopRender(!1)}},{key:"render",value:function(){var e=this.recordIdToFunc.get(this.curRecordId);console.info("~~ func ".concat(Object(l.encryptTea)(this.curRecordId)," ").concat(e)),e&&(e(this.curRecordId),this.recordIdToFunc.delete(this.curRecordId)),this.reconciler()}},{key:"updateQueus",value:function(e,n){var r=this.highQueues.findIndex((function(n){return n===e})),o=this.normalQueues.findIndex((function(n){return n===e}));if(n){if(o>-1&&this.normalQueues.splice(o,1),r>-1)return;this.highQueues.push(e)}else{if(r>-1&&this.highQueues.splice(r,1),o>-1)return;this.normalQueues.push(e)}console.info("~~ update ".concat(Object(l.encryptTea)(e)))}}]),e}();s.INTERVAL=200;var u=new s},dx_vxyt:function(e,n,r){"use strict";r.d(n,"n",(function(){return i}));var o=r("dx_SreQ");function i(e){e&&(e.focus(),Object(o.P)()&&e.selection.updateBrowserSelection())}},dx_w0Wf:function(e,n,r){"use strict";r.d(n,"P",(function(){return l}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=function(){function e(){i()(this,e),this.frame=void 0,this.timer=void 0}return a()(e,[{key:"hasRequested",value:function(){return void 0!==this.frame||void 0!==this.timer}},{key:"request",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n||this.cancel(),new Promise((function(n){e.frame=window.requestAnimationFrame((function(){e.frame=void 0,e.timer=window.setTimeout((function(){e.timer=void 0,n()}),r)}))}))}},{key:"cancel",value:function(){void 0!==this.frame&&(window.cancelAnimationFrame(this.frame),this.frame=void 0),void 0!==this.timer&&(window.clearTimeout(this.timer),this.timer=void 0)}}]),e}()},dx_w0wQ:function(e,n,r){"use strict";r.d(n,"q",(function(){return c})),r.d(n,"g",(function(){return a})),r.d(n,"K",(function(){return l})),r.d(n,"I",(function(){return s}));var o=r("dx_UtDZ"),i=r("dx_h6a8");function c(e){return Object(i.isInteger)(e)?"".concat(e,".0"):String(e).replace(/^(\d+\.\d)\d*$/,"$1")}function a(e,n){return e>=n?"".concat(Object(i.round)(e)):c(Object(i.round)(e,1))}function l(e,n){try{return JSON.parse(e)}catch(r){return n||{}}}function s(e){return o.i18nHelper.getLanguage().startsWith("zh")?e.zhText||e.enText:e.enText||e.zhText}},dx_w0wU:function(e,n,r){"use strict";r.d(n,"s",(function(){return c}));var o=r("dx_B28d"),i=r("dx_fEKD");function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.B.DIVIDER;return Object(i.b)(e,n)}},dx_w5wE:function(e,n,r){"use strict";r.d(n,"a",(function(){return o})),r.d(n,"J",(function(){return O})),r.d(n,"H",(function(){return x}));var o,i=r("dx_W7W2"),c=r.n(i),a=r("dx_a1gu"),l=r.n(a),s=r("dx_Nsbk"),u=r.n(s),d=r("dx_o0o1"),f=r.n(d),h=r("dx_yXPU"),p=r.n(h),v=r("dx_lwsE"),g=r.n(v),b=r("dx_W8MJ"),y=r.n(b),m=r("dx_C7Cb"),_=r("dx_KTtu");function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=u()(e);if(n){var i=u()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return l()(this,r)}}!function(e){e[e.comment=0]="comment",e[e.global=1]="global"}(o||(o={}));var O=function(){function e(n,r){g()(this,e),this.selection=n,this.commentModule=r,this.type=_.V.Comment,this.range=void 0,this.commentType=o.comment,this.matchId=void 0,this.matchId=Object(m.S)()}return y()(e,[{key:"scrollIntoView",value:function(){var e=p()(f.a.mark((function e(){var n,r,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.selection,r=n.commentId,o=n.replyId,this.commentModule.jumpToReply(r,o);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isReplaceable",get:function(){return!1}},{key:"rangeId",get:function(){return this.selection.replyId?"".concat(this.selection.commentId,"_").concat(this.selection.replyId):this.selection.commentId}},{key:"matchContent",get:function(){return this.selection}}]),e}(),x=function(e){c()(r,e);var n=k(r);function r(){var e;g()(this,r);for(var i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).commentType=o.global,e}return y()(r,[{key:"scrollIntoView",value:function(){var e=p()(f.a.mark((function e(){var n,r,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.selection,r=n.commentId,o=n.replyId,e.next=3,this.commentModule.scrollToWholeComment(r,o);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(O)},dx_w8Jj:function(e,n,r){"use strict";r.d(n,"i",(function(){return l}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c);function l(){return s.apply(this,arguments)}function s(){return(s=a()(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return e()}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},dx_w9nV:function(e,n,r){},dx_wDsH:function(e,n,r){"use strict";r.d(n,"p",(function(){return c}));var o=r("dx_DbCN");function i(e,n){e instanceof HTMLElement?e.scrollTop=n:e instanceof Document&&e.scrollingElement&&(e.scrollingElement.scrollTop=n)}function c(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],c=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0;try{if(r){var s,u=Object(o.h)(e),d=222,f=444,h=Math.max(Math.abs(u-n)/3,d);null===l||void 0===l||null===(s=l.beforeScroll)||void 0===s||s.call(l),$(e).animate({scrollTop:"".concat(n,"px")},{duration:Math.min(h,f),complete:c,fail:function(){return null===a||void 0===a?void 0:a("scroll animate fail")}})}else{var p;null===l||void 0===l||null===(p=l.beforeScroll)||void 0===p||p.call(l),i(e,n),null===c||void 0===c||c()}}catch(v){null===a||void 0===a||a(v.toString())}}},dx_wGyE:function(e,n,r){"use strict";var o=r("dx_vo6O");r("dx_CweE");n.S=o.S},dx_wH9t:function(e,n,r){"use strict";r.d(n,"J",(function(){return p}));var o=r("dx_J4zp"),i=r.n(o),c=r("dx_QILm"),a=r.n(c),l=r("dx_PcQO"),s=r("dx_cDcd"),u=r.n(s),d=r("dx_yzqx");r("dx_VLtj");function f(e){try{return"true"===localStorage.getItem(e)}catch(n){return!0}}var h=[],p=function(e){var n=e.guideKey,r=e.disabled,o=a()(e,["guideKey","disabled"]),c=Object(s.useState)(0),p=i()(c,2)[1],v=Object(s.useMemo)((function(){return function(){return p((function(e){return e+1}))}}),[]);return Object(s.useEffect)((function(){return h.push(v),function(){var e=h.indexOf(v);~e&&h.splice(e,1)}}),[v]),u.a.createElement(l.Tooltip,Object.assign({disabled:r||d.S.isMobile||f(n),overlayClassName:"task-block-guide-tip",mouseEnterDelay:200,mouseLeaveDelay:200,placement:"bottom"},o,{onVisibleChange:function(e){e?function(e){try{localStorage.setItem(e,"true")}catch(n){}}(n):h.forEach((function(e){return e()}))}}))}},dx_wJkD:function(e,n,r){"use strict";var o=r("dx_RIqP"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_lSNA"),s=r.n(l),u=r("dx_MWo5"),d=r("dx_Wjc8"),f=r("dx_O3ES"),h=r("dx_Siqi"),p=r("dx_UtDZ"),v=r("dx_h6a8"),g=r("dx_yzqx"),b=r("dx_xs2W"),y=r("dx_B28d"),m=r("dx_gLp6"),_=r("dx_Ai6r"),k=r("dx_B8Bh"),O=r("dx_GLPm"),x=r("dx_bbfH"),E=r("dx_QBqw"),S=r("dx_IdzY"),C=r("dx_s1qv"),I=r("dx_HirW"),B=r("dx_U4Wv"),T=r("dx_InLz"),w=r("dx_u6Hh"),R=r("dx_SOoV"),M={list:{matches:{nodeType:R.n.ELEMENT,nodeName:["OL","UL"]},enter:function(e){var n=e.context,r=e.node,o=r.firstElementChild;if(o){var i=Object(w.c)(o);i?(n.textType=i.type,n.level=i.level,n.done=i.isDone):(n.textType="OL"===r.nodeName?y.B.ORDERED:y.B.BULLET,n.level=Number.isInteger(n.level)?n.level+1:1)}},exit:function(e){e.context.done&&(e.data.done=!0),e.children.forEach((function(e){e.context.done&&(e.data.done=!0)}))}}},j=r("dx_WJxF"),D=g.S.isMobile&&g.S.isBytedanceApp,A=new Map;function P(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function L(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?P(Object(r),!0).forEach((function(n){s()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}A.set("color",(function(e,n){var r=Object(j.E)(n);if(r)e.mark.textHighlight=r;else if(e.supportStyle&&!D){var o=Object(j.N)(n,"text");o&&(e.mark.textHighlight=o)}})),A.set("background-color",(function(e,n){var r=Object(j.c)(n);if(r)e.mark.textHighlightBackground=r;else if(e.supportStyle&&!D){var o=Object(j.N)(n,"background");o&&(e.mark.textHighlightBackground=o)}})),A.set("background",(function(e,n){if(e.supportStyle||D){var r=Object(j.N)(n,"background");r&&(e.mark.textHighlightBackground=r)}})),A.set("text-align",(function(e,n){["left","right","center"].includes(n)&&(e.align=n)})),A.set("margin-left",(function(e,n){n.endsWith("em")&&(e.indentLevel=Object(T.u)(n,0))})),A.set("font-weight",(function(e,n){isNaN(Number(n))?n.includes("bold")?e.mark.bold=!0:e.mark.bold=!1:Number(n)<700?e.mark.bold=!1:e.mark.bold=!0})),A.set("text-decoration",(function(e,n){n.includes("line-through")&&(e.mark.strikethrough=!0),n.includes("underline")&&(e.mark.underline=!0)})),A.set("font-style",(function(e,n){n.includes("italic")&&(e.mark.italic=!0)})),A.set("vertical-align",(function(e,n,r){"super"!==n&&"sub"!==n||(r.innerText="(".concat(r.innerText,")"))})),A.set("font-size",(function(e,n){e.textType||Math.round(Object(T.u)(n,12))>=20&&(e.textType=y.B.HEADING1)})),A.set("mso-list",(function(e,n){"Ignore"===n&&(e._ignoreChild=!0)})),A.set("mso-ignore",(function(e,n){"vglayout"===n&&(e.microLayoutIgnore=!0)})),A.set("white-space",(function(e,n){(/^pre/.test(n)||/break-spaces/.test(n))&&(e.isWhiteSpacePre=!0)}));var N=["heading-h1","heading-h2","heading-h3","heading-h4","heading-h5","heading-h6","heading-h7","heading-h8","heading-h9"],F=L(L({styleParse:{matches:{nodeType:R.n.ELEMENT},enter:function(e){var n=e.node,r=e.context;if("callout-block"!==n.className&&n.getAttribute){var o=n.getAttribute("style");if(o){var i={};o.split(";").forEach((function(e){var n=e.split(":");if(n&&2===n.length){var r=a()(n,2),o=r[0],c=r[1];i[o.trim()]=c.trim()}})),A.forEach((function(e,o){var c=i[o];c&&(r.mark||(r.mark={}),e(r,c,n))}))}}}},blockquote:{matches:{nodeType:R.n.ELEMENT,nodeName:["BLOCKQUOTE"]},addEmptyTextIfNoChild:!0,enter:function(e){e.context.usedToBeQuote=!0}},heading:{matches:{nodeType:R.n.ELEMENT,nodeName:["H1","H2","H3","H4","H5","H6","SPAN","DIV","OL","UL"]},enter:function(e){var n=e.node,r=e.context;if(!r.textType||r.textType!==y.B.TODO){var o;if("SPAN"===n.nodeName||"DIV"===n.nodeName||"OL"===n.nodeName||"UL"===n.nodeName)o=0,N.forEach((function(e,r){n.classList.contains(e)&&(o=r+1)}));else{var i=n.nodeName.match&&n.nodeName.match(/^H(\d)$/);o=parseInt(i[1])}if("ordered"===r.textType)r.seq="auto";switch(o>0?r.headingLevel=o:r.headingLevel&&(o=r.headingLevel),o){case 1:r.textType=y.B.HEADING1;break;case 2:r.textType=y.B.HEADING2;break;case 3:r.textType=y.B.HEADING3;break;case 4:r.textType=y.B.HEADING4;break;case 5:r.textType=y.B.HEADING5;break;case 6:r.textType=y.B.HEADING6;break;case 7:r.textType=y.B.HEADING7;break;case 8:r.textType=y.B.HEADING8;break;case 9:r.textType=y.B.HEADING9}}}},img:{matches:{nodeType:R.n.ELEMENT,nodeName:["IMG"]},enter:function(e){var n=e.data,r=e.node,o=e.payload;n.type=y.B.IMAGE;var i=Object(_.s)().image;n.image=i;var c=r.getAttribute("src"),a=r.getAttribute("data-suite");if((c||a)&&(o.src=c,a)){try{var l=Object(B.D)(a).fileToken;o.fileToken=l}catch(f){console.error("decodeInfo fail")}if(r.dataset.width&&r.dataset.height){var s=Object(T.u)(r.dataset.width,240),u=Object(T.u)(r.dataset.height,240);i.width=s,i.height=u}else r.getAttribute("width")&&r.getAttribute("height")&&(i.width=Object(T.u)(r.getAttribute("width"),240),i.height=Object(T.u)(r.getAttribute("height"),240));if("minder"===r.dataset.type&&r.dataset.json)try{var d=JSON.parse(decodeURIComponent(r.dataset.json)).data;i.width=d.ow,i.height=d.oh}catch(h){console.error("mindmap paste image data JSON.parse failed",h)}}}},mindmap:{matches:{nodeType:R.n.ELEMENT,nodeName:["UL"]},preprocess:function(e){var n=e.node,r=e.context;if($(n).hasClass("mm-editor-clipboard"))return r._ignoreChild=!0,{html:n}},enter:function(e,n,r){var o=e.data,i=e.payload,c=r.html;o.type=y.B.MINDMAP,o.token="",i.html=c}}},M),{},{"list-nested":{matches:{nodeType:R.n.ELEMENT,nodeName:["OL","UL","DIV"]},exit:function(e){var n=e.context.textType;n!==y.B.ORDERED&&n!==y.B.BULLET&&n!==y.B.TODO||(e.children=e.children.reduce((function(e,n){var r=e.length,o=e[r-1];return r>0&&o.context.level&&o.context.level<n.context.level?o.children.push(n):e.push(n),e}),[]))}},indent:{matches:{nodeType:R.n.ELEMENT,nodeName:["DIV"]},exit:function(e){var n=e.context,r=e.children,o=n.textType;if(!o||o===y.B.TEXT){var i="indentLevel";e.children=Object(T.j)(r,i,(function(e,n){!((null===n||void 0===n?void 0:n.context[i])>1)||e.context[i]||e.data.type&&e.data.type!==y.B.TEXT||(e.context.indentLevel=1)}))}}},listitem:{matches:{nodeType:R.n.ELEMENT,nodeName:["LI"]},enter:function(e){var n=e.context,r=e.node,o=Object(w.c)(r);if(o&&(n.textType=o.type,n.done=o.isDone),n.textType===y.B.ORDERED){var i=r.dataset.start||r.getAttribute("start"),c=r.dataset.olId,a=void 0===c?"fake":c;void 0!==i&&(n.orderedListNumber=i,n.orderedListId=a)}},exit:function(e){var n=e.children;if(!(n.length<=1)){var r=e.data.type;r!==y.B.ORDERED&&r!==y.B.BULLET&&r!==y.B.TODO||(e.children=n.reduce((function(e,n){if(0===e.length)return e.push(n),e;var r=e[e.length-1];return r.context.level&&n&&n.context.singleline?(n.context.level===r.context.level&&n.data.type&&(n.data.type=Object(k.K)(n.data.type)?y.B.TEXT:n.data.type),r.data.type&&!Object(k.K)(r.data.type)&&(r.data.type=y.B.BULLET),r.children.push(n)):e.push(n),e}),[]))}}},hr:{matches:{nodeName:["HR"]},enter:function(e){e.data.type=y.B.DIVIDER}},inlinecode:{matches:{nodeType:R.n.ELEMENT,nodeName:["CODE"]},enter:function(e){var n=e.context;n.textType!==y.B.CODE&&(n.mark||(n.mark={}),n.mark.inlineCode=!0)}},doclink:{matches:{nodeType:R.n.ELEMENT,nodeName:["SPAN","A"]},enter:function(e){var n;if(Object(p.getMinaConfig)("ccm.docx.lark_cp_enable",!1)){var r=e.data,o=e.context,i=e.node,c=new d.l({dom:i}).parse();if(c){var a=c.url,l=c.title;if(a&&l){var s=Object(h.M)(a,!0)||{},u=s.token,f=s.type,g=s.mentionTypeNum;if(u&&f&&!Object(v.isUndefined)(g)){var b=Object(C.generateInlineComponent)(C.INLINE_COMPONENT_TYPE.DOC,{raw_url:a,title:l,token:u,file_type:g,tenant_id:""});r.nodes=Object(C.generateInlineComponnetNodes)(b,o),r.type=null!==(n=o.textType)&&void 0!==n?n:y.B.TEXT,o._ignoreChild=!0,e.alive=!0}}}}}},atuser:{matches:{nodeType:R.n.ELEMENT,nodeName:["SPAN","A"]},enter:function(e){var n;if(Object(p.getMinaConfig)("ccm.docx.lark_cp_enable",!1)){var r=e.data,o=e.context,i=e.node,c=new f.B({dom:i}).parse();if(c){var a=c.userid;if(a&&"all"!==a){var l=Object(C.generateInlineComponent)(C.INLINE_COMPONENT_TYPE.USER,{uid:a});r.nodes=Object(C.generateInlineComponnetNodes)(l,o),r.type=null!==(n=o.textType)&&void 0!==n?n:y.B.TEXT,o._ignoreChild=!0,e.alive=!0}}}}},"inlinecode-mobile":{matches:{nodeType:R.n.ELEMENT,nodeName:["SPAN"],selector:".inline-code"},enter:function(e){var n=e.context;n.textType!==y.B.CODE&&(n.mark||(n.mark={}),n.mark.inlineCode=!0)}},codeblock:{matches:{nodeType:R.n.ELEMENT,nodeName:["PRE"]},enter:function(e){var n=e.data,r=e.context,o=e.node,i=o.querySelector("code");i?("true"===o.dataset.wrap&&(n.wrap=!0),r.textType=y.B.CODE,n.nodes=[{text:"",type:S.B.PLAINTEXT}],n.language=function(e){var n=[e.match(/language-(\S+)/),e.match(/hljs (\S+)/)].filter((function(e){return!!e}));return n.length&&n[0]?Object(u.h)(decodeURIComponent(n[0][1])):"Plaintext"}("".concat(i.className," ").concat(e.node.className))):e.data.type=y.B.TEXT},exit:function(e){if(e.children.length&&e.context.textType===y.B.CODE){e.data.type=y.B.CODE;var n=e.children.map((function(e){if(e.data.nodes){var n=e.data.nodes[e.data.nodes.length-1];/\n$/.test(n.text)||(n.text="".concat(n.text,"\n"))}return e.data.nodes})).filter((function(e){return void 0!==e})).reduce((function(e,n){return[].concat(i()(e),i()(n))}));e.children=[],e.data.nodes=n}}},plaintext:{matches:{nodeType:R.n.TEXT},preprocess:function(e){return!(e.node.parentElement&&e.node.parentElement.dataset.zeroSpace)},enter:function(e){var n=e.node,r=e.data,o=e.context,i=n.textContent||" ";i=i.replace(/\u00a0/g," ");var c=(i=Object(I.K)(i)).match(/^\[([\s|x])\]\s/);c&&(r.type=y.B.TODO,i=i.slice(4),r.done="x"===c[1]),o.align&&(r.align=o.align),o.seq&&(r.seq=o.seq),r.nodes=o.mark?[{text:i,mark:o.mark,type:S.B.PLAINTEXT}]:[{text:i,type:S.B.PLAINTEXT}]},exit:function(e){var n=e.data,r=e.context;!n.type&&r.textType?n.type=r.textType:n.type=y.B.TEXT}},iframe:{matches:{nodeName:"IFRAME"},enter:function(e){var n=e.data,r=e.node.src;n.original_text=r,n.type=y.B.IFRAME}},break:{matches:{nodeName:"BR"},enter:function(e){e.data.nodes=[{text:"\n",type:S.B.PLAINTEXT}],e.data.type=e.data.type||y.B.TEXT}},link:{matches:{nodeName:"A"},enter:function(e){var n=e.context,r=e.node,o=e.data,i=e.node.getAttribute("href");if(i&&!i.trim().startsWith("javascript:")&&(g.S.isSafari&&i.startsWith("#")&&(i=location.origin+location.pathname+i),Object(b.P)(i,!0,!0)))if(n.mark||(n.mark={}),!o.type&&n.textType&&(o.type=n.textType),Object(w.G)(r)){var c=Object(h.M)(i,!0)||{},a=c.token,l=c.type,u=c.mentionTypeNum;if(!a||!l||Object(v.isUndefined)(u))return;var d=JSON.stringify(Object(C.generateInlineComponent)(C.INLINE_COMPONENT_TYPE.DOC,{file_type:u,token:a,tenant_id:"",raw_url:i,title:r.innerText}));o.nodes=[{text:" ",mark:L(s()({},C.INLINE_COMPONENT_MARK,d),n.mark),type:S.B.EMBED}],n.textType||(o.type=y.B.TEXT),n._ignoreChild=!0,e.alive=!0}else n.mark.link=encodeURIComponent(i),0===r.childNodes.length&&(o.nodes=[{text:"",mark:n.mark,type:S.B.PLAINTEXT}],o.type=o.type||y.B.TEXT)}},emptyInlineMark:{matches:{nodeName:["SPAN"]},enter:function(e){var n=e.node.getAttribute("data-diagram-type");if(n){n=n===m.O.UML?m.O.UML:m.O.FLOWCHART;var r=e.node.getAttribute("data-diagram-record")||"",o=null;try{o=JSON.parse(r)}catch(i){console.log("fail to parse clipboard diagram data",i)}o&&o.data&&(e.data.type=y.B.DIAGRAM,e.data.diagram={data:o.data,diagramType:n})}else;}},bold:{matches:{nodeType:R.n.ELEMENT,nodeName:["STRONG","B"]},enter:function(e){var n,r=e.context,o=e.node;void 0!==(null===(n=r.mark)||void 0===n?void 0:n.bold)&&o.style.fontWeight||(r.mark||(r.mark={}),r.mark.bold=!0)}},italic:{matches:{nodeType:R.n.ELEMENT,nodeName:["I","EM"]},enter:function(e){var n=e.context;n.mark||(n.mark={}),n.mark.italic=!0}},strike:{matches:{nodeType:R.n.ELEMENT,nodeName:["STRIKE","S"]},enter:function(e){var n=e.context;n.mark||(n.mark={}),n.mark.strikethrough=!0}},underline:{matches:{nodeType:R.n.ELEMENT,nodeName:["U"]},enter:function(e){var n=e.context;n.mark||(n.mark={}),n.mark.underline=!0}},emptytext:{matches:{nodeType:R.n.ELEMENT,nodeName:["P","LI","UL","OL","H1","H2","H3","H4","H5","BLOCKQUOTE"]},exit:function(e){var n,r=e.children,o=e.data,i=e.context,c=e.node;0!==r.length||o.nodes&&0!==o.nodes.length?1===r.length&&r[0].data.type===y.B.TEXT&&""===(null===(n=r[0].data.nodes)||void 0===n?void 0:n[0].text)&&(r[0].data.type=i.textType||y.B.TEXT,i.seq&&(r[0].data.seq=i.seq)):(o.nodes=[{text:c.textContent||"",type:S.B.PLAINTEXT}],o.type=i.textType||y.B.TEXT,i.seq&&(o.seq=i.seq))}},emptyLine:{matches:{nodeType:R.n.ELEMENT,nodeName:["P","DIV","SPAN"]},enter:function(e){var n=e.node,r=e.children;"\n"===n.innerHTML&&(r.push({node:n,context:{},data:{nodes:[{text:"",type:S.B.PLAINTEXT}],type:y.B.TEXT},payload:{},children:[]}),"SPAN"===n.tagName&&(e.alive=!0))}},singleline:{matches:{nodeType:R.n.ELEMENT},exit:function(e){var n=e.context,r=e.children,o=e.node,c=o.nodeName;!["P","LI","PRE","H1","H2","H3","H4","H5","H6","BLOCKQUOTE","HR","IMG"].includes(c)&&("DIV"!==c||o.dataset.eleid&&1===o.childElementCount&&"A"===o.children[0].nodeName)||(n.singleline=!0),r.length<=1||(e.children=r.reduce((function(e,n){if(0===e.length)return e.push(n),e;var r=e[e.length-1];if(r.context.singleline||n.context.singleline)e.push(n);else if(Array.isArray(r.data.nodes)&&Array.isArray(n.data.nodes)){var o;(o=r.data.nodes).push.apply(o,i()(n.data.nodes))}else e.push(n);return e}),[]))}},td:{matches:{nodeType:R.n.ELEMENT,nodeName:["TD","TH"]},addEmptyTextIfNoChild:!0,enter:function(e){var n=e.node,r=e.context,o=n.getAttribute("rowspan")||"1",i=n.getAttribute("colspan")||"1";r.width=n.width,r.rowspan=parseInt(o),r.colspan=parseInt(i),r.cells=r.rowspan*r.colspan,e.alive=!0}},tr:{matches:{nodeType:R.n.ELEMENT,nodeName:"TR"},exit:function(e){var n=e.context,r=e.children;r=r.filter((function(e){var n=e.node;return"TD"===n.tagName||"TH"===n.tagName}));var o=[],i=r.reduce((function(e,n){var r=n.context,i=r.cells,c=r.colspan,l=r.rowspan,s=r.width,u=a()(e,3),d=u[0],f=u[1],h=u[2];return o.push(s),[d+i,f+c,Math.max(h,l)]}),[0,0,0]),c=a()(i,3),l=c[0],s=c[1],u=c[2];n.lineCellsNum=l,n.lineColsNum=s,n.lineMaxRowspan=u,n.lineColsWidth=o;var d=L(L({},e),{},{data:{},children:r});e.children=[d]}},sheet:{matches:{nodeType:R.n.ELEMENT,nodeName:["TABLE","BYTE-SHEET-HTML-ORIGIN"]},preprocess:function(e,n){var r=e.node;return!!Object(O.Ut)(r,n)},enter:function(e,n){var r=e.data,o=e.payload,i=e.context,c=e.node;i._ignoreChild=!0;var a=n.querySelectorAll("style"),l=Object(v.map)(a,(function(e){return e.outerHTML}));r.type=y.B.SHEET,r.token="",o.styles=l,o.html=c},exit:function(e){e.alive=!0}},bitable:{matches:{nodeType:R.n.ELEMENT,nodeName:["TABLE"]},preprocess:function(e){var n=e.node,r=e.context,o=n&&n.dataset&&n.dataset.byteBitable;return!!o&&(r._ignoreChild=!0,{initData:o})},enter:function(e,n,r){var o=e.data,i=e.node,c=e.payload,a=r.initData;o.type=y.B.BITABLE,o.token="",c.initData=a,c.html=i},exit:function(e){e.alive=!0}},table:{matches:{nodeName:["TABLE"]},preprocess:function(e,n){var r=e.node;return!Object(O.Ut)(r,n)},enter:function(e){delete e.context.textType},exit:function(e,n){if(e.data.type!==y.B.SHEET){var r=e.node,o=e.context,i=e.children;if(o.microLayoutIgnore){o._ignoreChild=!0;var c=r.textContent;if(!c)return;return e.children=[],void(e.data={nodes:[{text:c.replace(/\n/g,""),type:S.B.PLAINTEXT}],type:y.B.TEXT})}var a=(i=i.filter((function(e){return"TR"===e.node.tagName}))).length,l=i.reduce((function(e,n){var r=n.context.lineColsNum;return Math.max(e,r)}),0);if(0!==i.length){if(0===l)return F.sheet.enter(e,n),void F.sheet.exit(e,n);var s=[],u=r.getElementsByTagName("colgroup");s=u[0]?Array.from(u[0].children).map((function(e){return e.style.width?Object(T.u)(e.style.width,x.ug):Number(e.width)})):i[0].context.lineColsWidth;for(var d=Object(E.f)(l),f=d.reduce((function(e,n,r){return e[n]={column_width:Math.ceil(s[r])||x.ug},e}),{}),h=Object(E.b0)(a),p={},v=function(e,n,r,o,i){if(h[e]&&d[n]){var c="".concat(h[e]).concat(d[n]);p[c]={children:i?i.children:[],merge_info:{row_span:r,col_span:o}}}},g=0;g<a;g++)for(var b=i[g].children,m=0,_=0;_<l;_++)if(!p["".concat(h[g]).concat(d[_])]){var k=b[m++],O=void 0,C=void 0;if(k?(O=k.context.colspan,C=k.context.rowspan):(O=1,C=1),v(g,_,C,O,k),C>1||O>1)for(var I=0;I<C;I++)for(var B=0;B<O;B++)0===I&&0===B||v(g+I,_+B,1,1)}var w={cell_set:p,column_set:f,columns_id:d,rows_id:h,type:y.B.TABLE};Object(T.Z)(w),e.data=w,e.alive=!0,e.children=[]}}}}});n.S=F},dx_wLbm:function(e,n,r){"use strict";r.d(n,"B",(function(){return s}));var o=r("dx_VkAN"),i=r.n(o),c=r("dx_n2nw"),a=r("dx_Dtiu");function l(){var e=i()(["\n  color: var(--icon-n2);\n  font-size: 18px;\n"]);return l=function(){return e},e}var s=r.n(a)()(c.S)(l())},dx_wTwg:function(e,n,r){"use strict";r.d(n,"C",(function(){return c})),r.d(n,"F",(function(){return l}));var o=r("dx_FH1m"),i=r("dx_B28d");function c(e){var n=e.blockManager,r=e.block,c=e.range,a=e.blockEntity;return Object(o.q)(n,r,c,n.createInitModel(i.B.ISV,{app_block_id:a.blockID,block_type_id:a.blockTypeID}))}var a=[function(e){var n=e.match(/block:\/\/([\w-]+)\?from=([\w-]+)&id=([\w-]+)(&scene=cut)*/);if(n)return n[1]},function(e){var n=e.match(new RegExp("(https://www\\.|www\\.)?\\.*/calendar/share\\?token=(\\w+)$"));if(n)return"".concat("sharedtoken","-").concat(n[2])}],l=function(e){for(var n=0;n<a.length;n++){var r=a[n](e);if(r)return r}}},dx_wbyu:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return f}));var e=r("dx_J4zp"),o=r.n(e),i=r("dx_K5vg"),c=r("dx_cDcd"),a=r.n(c),l=r("dx_y5yU"),s=r("dx_luPr"),u=r("dx_B28d"),d=(r("dx_IAkw"),Object(l.r)(i.S));function f(e){var n=e.blockError,r=Object(c.useState)(null),i=o()(r,2),l=i[0],f=i[1];return Object(c.useEffect)((function(){n&&(null!==l&&l===n.id||(f(n.id),s.R.reportBlockLoadError(n)))}),[n]),e&&e.displayMode===u.J.INLINE?a.a.createElement("div",{className:"docx-block-loading-retryable docx-block-loading-inline"},a.a.createElement("div",{className:"inline-mode"},a.a.createElement("span",{className:"docx-block-inline-placeholder"}),a.a.createElement("span",{className:"docx-block-inline-placeholder-expand"}))):a.a.createElement("div",{className:"docx-block-loading-retryable docx-block-loading",style:e.style},a.a.createElement("div",{className:"docx-block-mode",contentEditable:!1},a.a.createElement("div",{className:"docx-retry-content"},a.a.createElement("div",{className:"docx-retry-placeholder-img"},a.a.createElement(d,{style:{maxHeight:"88px",maxWidth:"88px"}})),a.a.createElement("div",{className:"retry-tips"},a.a.createElement("span",{className:"retry-text"},t("CreationDoc_DocX_Block_Load_Fail"),a.a.createElement("button",{type:"button",onClick:e.onClickRetry,className:"retry-btn"},t("CreationDoc_Docs_TwoWayLinks_LoadingError_Toast12")))))))}}).call(this,r("dx_E9Eu"))},dx_wexs:function(e,n,r){"use strict";(function(t){r.d(n,"x",(function(){return s})),r.d(n,"a",(function(){return u})),r.d(n,"g",(function(){return d})),r.d(n,"b",(function(){return f}));var e,o=r("dx_lSNA"),i=r.n(o),c=r("dx_XW5M"),a=r("dx_Fapt"),l=r("dx_u6uu"),s=[l.C.youtube,l.C.gmaps,l.C.tiktok,l.C.vimeo,l.C.instagram,l.C.facebook,l.C.googleDrive,l.C.datastudio,l.C.oneDrive,l.C.imgur,l.C.soundcloud,l.C.slideshare,l.C.speakerdeck,l.C.lark_survey],u=[l.C.youku,l.C.bilibili,l.C.autonavi,l.C.baidumap,l.C.xigua,l.C.modao,l.C.canva,l.C.jcode,l.C.feishu_survey,l.C.jinshuju],d=(e={},i()(e,c.J.Video,t("block.iframe_video")),i()(e,c.J.Design,t("CreationDoc_DocX_Design_Title")),i()(e,c.J.Code,t("CreationDoc_DocX_ProductDevelopment_Title")),i()(e,c.J.Form,t("CreationDoc_DocX_Forums_Title")),i()(e,c.J.ProjectManage,t("CreationDoc_DocX_ProjectManagement_Title")),i()(e,c.J.Map,t("CreationDoc_DocX_Map_Title")),e),f=[{name:l.C.xigua,text:t("block.iframe_xigua"),keywords:a.r[l.C.xigua],groupType:c.J.Video},{name:l.C.tiktok,text:"TikTok",keywords:a.r[l.C.tiktok],groupType:c.J.Video},{name:l.C.youtube,text:t("common.YouTube"),keywords:a.r[l.C.youtube],groupType:c.J.Video},{name:l.C.bilibili,text:t("common.bilibili"),keywords:a.r[l.C.bilibili],groupType:c.J.Video},{name:l.C.youku,text:t("common.youku"),keywords:a.r[l.C.youku],groupType:c.J.Video},{name:l.C.figma,text:t("common.figma"),keywords:a.r[l.C.figma],groupType:c.J.Design},{name:l.C.modao,text:t("common.modao"),keywords:a.r[l.C.modao],groupType:c.J.Design},{name:l.C.canva,text:t("common.canva"),keywords:a.r[l.C.canva],groupType:c.J.Design},{name:l.C.jcode,text:t("LarkCCM_Docx_BlockName_Jcode"),keywords:a.r[l.C.jcode],groupType:c.J.Code},{name:l.C.codepen,text:t("common.codepen"),keywords:a.r[l.C.codepen],groupType:c.J.Code},{name:l.C.feishu_survey,text:t("common.feishu_survey"),keywords:a.r[l.C.feishu_survey],groupType:c.J.Form},{name:l.C.lark_survey,text:t("common.lark_survey"),keywords:a.r[l.C.feishu_survey],groupType:c.J.Form},{name:l.C.jinshuju,text:t("common.jinshuju"),keywords:a.r[l.C.jinshuju],groupType:c.J.Form},{name:l.C.airtable,text:t("common.Airtable"),keywords:a.r[l.C.airtable],groupType:c.J.ProjectManage},{name:l.C.baidumap,keywords:a.r[l.C.baidumap],text:t("block.iframe_map_baidu"),groupType:c.J.Map},{name:l.C.autonavi,text:t("block.iframe_map_autonavi"),keywords:a.r[l.C.autonavi],groupType:c.J.Map},{name:l.C.gmaps,text:t("block.iframe_map_gmaps"),keywords:a.r[l.C.gmaps],groupType:c.J.Map}]}).call(this,r("dx_E9Eu"))},dx_wmJb:function(e,n,r){"use strict";function o(e){return Number.parseFloat(window.getComputedStyle(e).width)}r.d(n,"d",(function(){return o}))},dx_wqNP:function(e,n,r){"use strict";r.d(n,"z",(function(){return S.z})),r.d(n,"R",(function(){return S.R}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_LcNA"),s=r("dx_UtDZ"),u=r("dx_h6a8"),d=r("dx_cDcd"),f=r.n(d),h=r("dx_yzqx"),p=r("dx_zEdG"),v=r("dx_D8nn"),g=r("dx_SkpS"),b=r("dx_ZMwq"),y=r("dx_ey54"),m=r("dx_FHaN"),_=r("dx_HTwv"),k=r("dx_kqrv"),O=r("dx_TSYQ"),x=r.n(O),E=r("dx_JFWd"),S=r("dx_h0h1"),C=(r("dx_V5y6"),function(e){var n=e.data.data,r=n.expire_time,o=n.is_whole_day,i=n.should_notify,c=x()("docx-reminder-inline-component",Object(E.n)(r),{"should-notify":Boolean(i),"embed-text-container":!0}),a=Object(S.R)(r,o);return f.a.createElement("span",{className:c,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseDown:function(e){e.preventDefault()}},a)}),I=function(e){var n=e.data,r=n.data,o=r.expire_time,c=r.is_whole_day,O=r.should_notify,x=r.notify_time,E=r.create_user_id,I=n.id,B=e.model,T=e.editor,w=Object(d.useRef)(null),R=Object(d.useRef)([]),M=Object(d.useRef)(!1),j=Object(d.useCallback)((function(){var e=B.zoneState,n=new Set;return e.getContent().forEach((function(e){var r=Object(_.p)(e);r&&r.type===m.k.USER&&n.add(r.data.uid)})),n.add(E),Array.from(n)}),[T,E]),D=Object(d.useRef)(Object(u.debounce)((function(e){g.Z.showPopover(e)}),100)),A=Object(d.useCallback)(a()(i.a.mark((function e(){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!M.current&&0!==R.current.length){e.next=7;break}return n=j(),r=Object(_.h)(B.record,B.editorAPI.config.get("isHistory")),e.next=5,Object(S.L)(r,n);case 5:R.current=e.sent,M.current=!1;case 7:return e.abrupt("return",R.current);case 8:case"end":return e.stop()}}),e)}))),[R,B,j]),P=Object(d.useMemo)((function(){return{id:I,data:{expire_time:o,is_whole_day:c,should_notify:O,notify_time:x,create_user_id:E}}}),[I,o,c,O,x,E]),L=Object(d.useCallback)(function(){var e=a()(i.a.mark((function e(n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.changes,B.zoneId in r){e.next=3;break}return e.abrupt("return");case 3:M.current=!0;case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[]),N=Object(d.useCallback)((function(){var e=B.editorAPI.viewService.getBlockViewByBlockId(B.id);if(null===e||void 0===e?void 0:e.isTextEditable){A().then((function(){var n=b.E.Intact;return g.Z.showPopover({block:e,reminderInfo:P,reminderRef:w.current,users:R.current,type:n})})).catch((function(e){console.error("[reminder]",e)}));var n=P.data,r=n.is_whole_day,o=n.should_notify;Object(p.T)("ccm_doc_reminder_panel_view",{record_id:B.record.id,block_type:B.type},{is_set_time:!r,is_set_reminder:o}),Object(p.P)("ccm_doc_content_page_click",{record_id:B.record.id,block_type:B.type},{click:"click_inline_component",target:"ccm_doc_reminder_panel_view",inline_type:m.k.REMINDER,object_inline_id:Object(s.encryptTea)(I||"")})}}),[A,P,B]),F=Object(d.useCallback)((function(){g.Z.popoverType!==b.E.Intact&&g.Z.hidePopover(I)}),[I]),U=Object(d.useCallback)((function(){var e=B.editorAPI.viewService.getBlockViewByBlockId(B.id);e&&g.Z.popoverType!==b.E.Intact&&A().then((function(){var n=b.E.Simple;return g.Z.showPopover({block:e,type:n,users:R.current,reminderRef:w.current,reminderInfo:P})})).catch((function(e){console.error("[reminder]",e)}))}),[P,A,B]),H=Object(d.useCallback)((function(e){I===e&&N()}),[N,I]),V=Object(d.useCallback)((function(){var e=B.editorAPI.viewService.getBlockViewByBlockId(B.id);if(e){var n=g.Z.popoverType;n&&n===b.E.Intact&&g.Z.reminderRef===w.current&&g.Z.showPopover({block:e,type:n,users:R.current,reminderRef:w.current,reminderInfo:P})}}),[w,B,P]);return Object(d.useLayoutEffect)((function(){return v.S.on(k.i,H),function(){v.S.off(k.i,H)}}),[H]),Object(d.useEffect)((function(){if(!B.isSSR)return B.blockManager.addListener(y.G,V),window.addEventListener("resize",V),T.on(l.L.CONTENT_CHANGE,L),function(){B.blockManager.removeListener(y.G,V),window.removeEventListener("resize",V),T.off(l.L.CONTENT_CHANGE,L),D.current.cancel()}}),[V,L,T,B,D]),Object(d.useEffect)((function(){if(!h.S.isMobile){var e=B.editorAPI.viewService.getBlockViewByBlockId(B.id);e&&g.Z.updatePopover({block:e,users:R.current,reminderRef:w.current,reminderInfo:P})}}),[n,B]),Object(d.useEffect)((function(){return function(){h.S.isMobile||g.Z.hidePopover(I)}}),[I]),f.a.createElement("span",{ref:w},f.a.createElement(C,Object.assign({},e,{onClick:N,onMouseLeave:F,onMouseEnter:U})))};n.S=I},dx_wvoI:function(e,n,r){"use strict";(function(t){r.d(n,"c",(function(){return T}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_iWIM"),l=r.n(a),s=r("dx_W7W2"),u=r.n(s),d=r("dx_a1gu"),f=r.n(d),h=r("dx_Nsbk"),p=r.n(h),v=r("dx_PcQO"),g=r("dx_TSYQ"),b=r.n(g),y=r("dx_cDcd"),m=r.n(y),_=r("dx_rQGm"),k=r("dx_VmtY"),O=r("dx_fNdX"),x=r("dx_KHvq"),E=r("dx_kZ3l"),S=r("dx_S6dX"),C=r("dx_PCVy"),I=r("dx_LZf0");r("dx_TcWW");function B(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=p()(e);if(n){var i=p()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return f()(this,r)}}var T=function(e){u()(r,e);var n=B(r);function r(){var e;o()(this,r);for(var i=arguments.length,c=new Array(i),a=0;a<i;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).level=void 0,e.headingModifyPanelRef=m.a.createRef(),e.headingIconRef=m.a.createRef(),e.containerRef=m.a.createRef(),e.state={showListModifyPanel:!1,editMode:C.N.Mouse},e.handleTooltipVisibleChange=function(n){n?e.blockManager.addListener(k.N,e.handleEditModeUpdate):e.blockManager.removeListener(k.N,e.handleEditModeUpdate)},e.handleEditModeUpdate=function(n){e.setState({editMode:n})},e.handleClickListStyle=function(){e.state.showListModifyPanel||e.updateVisible(!0),e.isFocus()||Object(E.u)(e.model)},e.getDocxPopupContainer=function(){return document.querySelector("#docx-popup-container")||document.body},e.handleClick=function(n){var r=n.target;r.closest(".heading-modify-menu")||r.closest(".heading-modify-input")||n.target===e.headingIconRef.current||e.updateVisible(!1)},e.updateVisible=function(n){if(n)e.setState({showListModifyPanel:!0}),document.addEventListener("click",e.handleClick);else{var r;e.setState({showListModifyPanel:!1});var o=Object(S.f)();if(!o||"docx-popup-container"===(null===(r=o.startContainer)||void 0===r?void 0:r.id)){var i=e.blockManager.getBlockViewByBlockId(e.id);i.setBlockFocus(!0),i.focus()}document.removeEventListener("click",e.handleClick)}},e}return c()(r,[{key:"blockViewWillUnmount",value:function(){l()(p()(r.prototype),"blockViewWillUnmount",this).call(this),this.blockManager.removeListener(k.N,this.handleEditModeUpdate)}},{key:"renderListModifyPanel",value:function(){var e=this.props,n=e.order,r=e.recursionProps.headingModule;return m.a.createElement(I.S,{blockManager:this.blockManager,headingModule:r,blockId:this.id,recordId:this.record.id,order:n,updateVisible:this.updateVisible})}},{key:"renderOrder",value:function(){var e=this.props,n=e.order,r=e.loading,o=void 0!==r&&r,i=this.props.recursionProps.isHistory,c=this.state.showListModifyPanel,a=!i&&this.editable,l=b()("heading-order",{orderUnedit:!this.editable,hover:c,button:a}),s=m.a.createElement("div",{className:l,contentEditable:!1},n),u=this.state.editMode===C.N.Keyboard,d=m.a.createElement(v.Dropdown,{trigger:"click",placement:"bottomLeft",overlay:this.renderListModifyPanel(),getPopupContainer:this.getDocxPopupContainer,visible:c,ref:this.headingModifyPanelRef,overlayClassName:"list-modify-panel ".concat(_.b3.LAZY_SELECTION_NODE)},m.a.createElement(v.Tooltip,{title:t("doc.list.set_the_number"),placement:"top",mouseEnterDelay:300,disabled:u,onVisibleChange:this.handleTooltipVisibleChange},m.a.createElement(v.Button,{type:"text",size:"large",color:"primary",className:l,onClick:this.handleClickListStyle,ref:this.headingIconRef,contentEditable:!1},n)));return n?o?m.a.createElement("span",{className:"heading-order-loading",contentEditable:!1},"0."):a?d:s:null}},{key:"render",value:function(){var e=this;return m.a.createElement("div",{className:"heading-block",ref:this.containerRef},m.a.createElement("div",{className:b()(["heading","heading-h".concat(this.level),"heading-block-align-".concat(this.snapshot.align)]),onClick:function(n){return Object(O.o)(e.model,e.editor,n)}},this.renderOrder(),m.a.createElement("div",{className:"heading-content"},l()(p()(r.prototype),"render",this).call(this))),this.model.children.length>0?m.a.createElement("div",{style:{paddingLeft:_.X}},this.renderChildren()):null)}}]),r}(x.N)}).call(this,r("dx_E9Eu"))},dx_x0No:function(e,n,r){"use strict";r.d(n,"n",(function(){return u})),r.d(n,"l",(function(){return d}));var o,i=r("dx_J4zp"),c=r.n(i),a=r("dx_cDcd"),l=r("dx_a3US"),s=new(r("dx_D8nn").i);function u(e){s.trigger(o.TABLE_RESIZING,[e])}function d(){var e=Object(a.useState)(!1),n=c()(e,2),r=n[0],i=n[1],u=Object(l.r)((function(e){i(e)}));return Object(a.useEffect)((function(){return s.on(o.TABLE_RESIZING,u),function(){s.off(o.TABLE_RESIZING,u)}}),[u]),r}!function(e){e.TABLE_RESIZING="TABLE_RESIZING"}(o||(o={}))},dx_x1WV:function(e,n,r){"use strict";var o=r("dx_VOUh");r.d(n,"a",(function(){return o.a}))},dx_x1xr:function(e,n,r){"use strict";r.d(n,"B",(function(){return ze}));var o,i,c,a,l,s,u,d=r("dx_yG8O"),f=r.n(d),h=r("dx_lwsE"),p=r.n(h),v=r("dx_W8MJ"),g=r.n(v),b=r("dx_PJYZ"),y=r.n(b),m=r("dx_W7W2"),_=r.n(m),k=r("dx_a1gu"),O=r.n(k),x=r("dx_Nsbk"),E=r.n(x),S=r("dx_Uyc2"),C=r.n(S),I=(r("dx_A1AB"),r("dx_Vvd7")),B=r("dx_N9dL"),T=r("dx_T4T0"),w=r("dx_Z22N"),R=r("dx_B28d"),M=r("dx_r7Ym"),j=r("dx_C5gi"),D=r("dx_xjz2"),A=r("dx_YRGG"),P=r("dx_U9rT"),L=Object(D.s)(A.h)((i=function(){function e(){p()(this,e),this.type=R.B.MINDMAP,f()(this,"manager",c,this)}return g()(e,[{key:"fetchResource",value:function(){var e=this;return new Promise((function(n){e.manager.getDepLoader().getBridge(),n()}))}}]),e}(),c=C()(i.prototype,"manager",[P.i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),o=i))||o,N=r("dx_o0o1"),F=r.n(N),U=r("dx_yXPU"),H=r.n(U),V=r("dx_UtDZ"),W=r("dx_yzqx"),z=r("dx_jBAU"),G=r("dx_Xdvu"),K=r("dx_NpE2"),q=r("dx_zghO"),X=r("dx_D8nn"),Y=V.LoadableMindnoteBridge,J=function(){function e(n){var r=this;p()(this,e),this.bridge=void 0,this.blockManager=void 0,this.scroller=void 0,this.setScroller=function(e){r.scroller=e},this.getScroller=function(){return r.scroller},this.preloadBridge=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n={mentionSource:V.SOURCE_ENUM.DOCX,mentionType:V.NUM_SUITE_TYPE.DOCX,getScrollContainer:r.getScroller,getBlockHeight:function(e){var n,o=r.blockManager.getBlockViewByBlockIdNotCheck(e);return null!==(n=null===o||void 0===o?void 0:o.getHeight())&&void 0!==n?n:404},isBlockInTable:function(e){for(var n=r.blockManager.getBlockModelByBlockId(e),o=n.parent;null!==o;){if(o.record.get(["type"])===R.B.TABLE)return!0;n=o,o=o.parent}return!1},getMentionBoxToken:function(){return r.blockManager.rootRecordId},isTemplate:e,handlerExitFullScreen:function(){(W.S.isMobile||W.S.isIPad)&&X.S.trigger(X.p.MOBILE.MINDNOTE.EMBEDDED_FULLSCREEN_CHANGE,[!1])}};return r.bridge||(r.bridge=new Y(n),r.bridge.loadMindnoteManager()),r.bridge},this.getOrders=function(){var e=[];return r.blockManager.recordManager.traverse(r.blockManager.rootRecordId,(function(n){return n.snapshot.type===R.B.MINDMAP&&e.push(n.id),!0})),e},this.getBridge=function(){return r.bridge?r.bridge:r.preloadBridge()},this.destroy=function(){var e;null===(e=r.bridge)||void 0===e||e.destroy(),r.bridge=null},this.blockManager=n}return g()(e,[{key:"generateMindnoteToken",value:function(){var e=H()(F.a.mark((function e(n,r){var o,i,c,a,l,s=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.length>2&&void 0!==s[2]?s[2]:"",i=this.blockManager.getRecordByBlockId(this.blockManager.rootBlockId).id,c=this.blockManager.getRecordByBlockId(n).id,e.next=5,z.S.createMindmapBlock(i,c,r,o);case 5:if(0===(a=e.sent).code){e.next=8;break}throw new Error("generateMindnoteToken error");case 8:return l=a.data.token,e.abrupt("return",l);case 10:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"cloneMindnoteByToken",value:function(){var e=H()(F.a.mark((function e(n,r,o){var i,c,a;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.blockManager.getRecordByBlockId(this.blockManager.rootBlockId).id,c=this.blockManager.getRecordByBlockId(n).id,e.next=4,z.S.copyMindmapBlock(i,c,r,o);case 4:if(0===(a=e.sent).code){e.next=7;break}throw new Error("generateMindnoteToken error");case 7:return e.abrupt("return",a.data.token);case 8:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()},{key:"generateMindnoteTokenByDefaultData",value:function(){var e=H()(F.a.mark((function e(n){var r,o;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.stringify(this.getInitMindnoteContent()),e.next=3,this.generateMindnoteToken(n,r);case 3:return o=e.sent,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"unmount",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.bridge&&this.bridge.unmount(e,n)}},{key:"getInitMindnoteContent",value:function(){return{nodes:[{id:"1",text:""},{id:"2",text:""},{id:"3",text:""}],theme:"classic",structure:"right",globalLineStyle:"polyline"}}}]),e}(),Z=Object(D.s)(P.i)((l=function(){function e(){p()(this,e),this.mindmapBlockDepLoader=void 0,this.reporter=new K.W,f()(this,"context",s,this)}return g()(e,[{key:"getDepLoader",value:function(e){return this.mindmapBlockDepLoader||(this.mindmapBlockDepLoader=new J(this.blockManager)),e&&!(e instanceof Document)&&this.mindmapBlockDepLoader.setScroller(e),this.mindmapBlockDepLoader}},{key:"triggerComment",value:function(e){this.commentModule.triggerStartNewDocComment({selectedBlocks:[{id:e,type:q.j.BLOCK}],callSource:"Mindmap"})}},{key:"destroy",value:function(){var e;null===(e=this.mindmapBlockDepLoader)||void 0===e||e.destroy()}},{key:"commentModule",get:function(){return this.context.commentModule}},{key:"blockManager",get:function(){return this.context.blockManager}}]),e}(),s=C()(l.prototype,"context",[G.a],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),a=l))||a,Q=r("dx_RIqP"),$=r.n(Q),ee=r("dx_iWIM"),te=r.n(ee),ne=r("dx_h6a8"),re=r("dx_cDcd"),oe=r.n(re),ie=r("dx_faye"),ce=r.n(ie),ae=r("dx_iHWM"),le=r("dx_gK2j"),se=r("dx_MGoZ"),ue=r("dx_R7Rv"),de=r("dx_BaTw"),fe=r("dx_ey54"),he=r("dx_U5UJ"),pe=r("dx_k8kI"),ve=r("dx_aglp"),ge=r.n(ve),be=r("dx_Jwfk"),ye=r("dx_TSYQ"),me=r.n(ye);r("dx_Z7uL");function _e(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=E()(e);if(n){var i=E()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return O()(this,r)}}!function(e){e.LEFT="LEFT",e.RIGHT="RIGHT",e.TOP="TOP",e.BOTTOM="BOTTOM"}(u||(u={}));var ke=function(e){_()(r,e);var n=_e(r);function r(){var e;p()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).draggingInfo=null,e.state={resizing:!1},e.handleMouseMove=function(n){n.preventDefault(),e.draggingInfo&&e.props.onResizeUpdate&&e.props.onResizeUpdate(e.calcDragDiff(e.draggingInfo,n))},e.handleMouseUp=function(n){e.draggingInfo&&e.props.onResizeEnd&&(e.endDarg(),e.props.onResizeEnd(e.calcDragDiff(e.draggingInfo,n)),e.draggingInfo=null)},e}return g()(r,[{key:"startDrag",value:function(){document.body.classList.add("resizable-dragging"),this.draggingInfo&&document.body.classList.add("".concat(this.draggingInfo.cursorType,"-cursor")),this.props.boundary.addEventListener("mouseup",this.handleMouseUp),this.props.boundary.addEventListener("mousemove",this.handleMouseMove),this.setState({resizing:!0})}},{key:"endDarg",value:function(){document.body.classList.remove("resizable-dragging"),this.draggingInfo&&document.body.classList.remove("".concat(this.draggingInfo.cursorType,"-cursor")),this.props.boundary.removeEventListener("mouseup",this.handleMouseUp),this.props.boundary.removeEventListener("mousemove",this.handleMouseMove),this.setState({resizing:!1})}},{key:"handleMouseDown",value:function(e,n){var r=n===u.LEFT||n===u.RIGHT?"col":"row";this.draggingInfo={startX:e.clientX,startY:e.clientY,startFromLeft:n===u.LEFT,startFromRight:n===u.RIGHT,startFromTop:n===u.TOP,startFromBottom:n===u.BOTTOM,cursorType:r},this.startDrag(),this.props.onResizeStart&&this.props.onResizeStart(this.draggingInfo)}},{key:"calcDragDiff",value:function(e,n){return{diffX:(e.startFromLeft?-1:1)*(n.clientX-e.startX),diffY:(e.startFromTop?-1:1)*(n.clientY-e.startY)}}},{key:"render",value:function(){var e=this,n=this.props,r=n.editable,o=n.children,i=n.disableDirection;return oe.a.createElement("div",{className:me()("resizable-container",{resizing:this.state.resizing}),contentEditable:!1},o,!r||W.S.isMobile||W.S.isIPad?null:oe.a.createElement(oe.a.Fragment,null,(null===i||void 0===i?void 0:i.includes(u.LEFT))?null:oe.a.createElement("div",{className:"resizable-draggable resizable-draggable-left",onMouseDown:function(n){return e.handleMouseDown(n,u.LEFT)}}),(null===i||void 0===i?void 0:i.includes(u.RIGHT))?null:oe.a.createElement("div",{className:"resizable-draggable resizable-draggable-right",onMouseDown:function(n){return e.handleMouseDown(n,u.RIGHT)}}),(null===i||void 0===i?void 0:i.includes(u.TOP))?null:oe.a.createElement("div",{className:"resizable-draggable resizable-draggable-top",onMouseDown:function(n){return e.handleMouseDown(n,u.TOP)}}),(null===i||void 0===i?void 0:i.includes(u.BOTTOM))?null:oe.a.createElement("div",{className:"resizable-draggable resizable-draggable-bottom",onMouseDown:function(n){return e.handleMouseDown(n,u.BOTTOM)}})))}}]),r}(oe.a.PureComponent),Oe=ke;function xe(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=E()(e);if(n){var i=E()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return O()(this,r)}}var Ee=function(e){_()(r,e);var n=xe(r);function r(){var e;p()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).didRender=!1,e}return g()(r,[{key:"componentDidMount",value:function(){this.props.renderFinishCb&&this.props.token&&(this.didRender=!0,this.props.renderFinishCb())}},{key:"componentDidUpdate",value:function(){this.props.renderFinishCb&&this.props.token&&!this.didRender&&this.props.renderFinishCb&&(this.didRender=!0,this.props.renderFinishCb())}},{key:"render",value:function(){var e=!W.S.isMobile&&!W.S.isBytedanceApp;return oe.a.createElement(Oe,{onResizeStart:this.props.handleResizeStart,onResizeUpdate:this.props.handleResizeUpdate,onResizeEnd:this.props.handleResizeEnd,boundary:this.props.boundary,editable:this.props.editable,disableDirection:[u.LEFT,u.RIGHT,u.TOP]},oe.a.createElement("div",{className:"mindmap-block-container",ref:this.props.setRef,key:this.props.id,tabIndex:-1,style:{minHeight:e?this.props.height:void 0,height:this.props.height,borderColor:this.props.borderColor},contentEditable:!1}))}}]),r}(oe.a.Component),Se=Ee,Ce=r("dx_lSNA"),Ie=r.n(Ce),Be=r("dx_Y67Y"),Te=r("dx_ad02");function we(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Re(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?we(Object(r),!0).forEach((function(n){Ie()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):we(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var Me,je,De,Ae,Pe,Le=function(){function e(n){var r=this;p()(this,e),this.minder=null,this.minderLayoutSubscription=null,this.mountPoint=null,this.handleMinderSet=function(e){r.minder=e,r.bindEvents(),r.resetMinderCanvas(!0)},this.mountPoint=n}return g()(e,[{key:"bindEvents",value:function(){var e=H()(F.a.mark((function e(){var n=this;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.minder){e.next=2;break}return e.abrupt("return");case 2:this.minderLayoutSubscription=this.minder.getService("ContextEvent").layout$.pipe(Object(Be.D)((function(e){return Re({},e.bounds)})),Object(Te.y)((function(e,n){return e.x===n.x&&e.y===n.y&&e.width===n.width&&e.height===n.height}))).subscribe((function(){(W.S.isMobile||W.S.isIPad)&&W.S.isBytedanceApp&&n.resetMobileMinderCanvas()}));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resetMinderCanvas",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.minder){var r=function(){var n=e.minder.getService("PinchPan");n.notifyViewPortUpdate();var r=W.S.isMobile?be.kO:be.d;n.fitMap({top:r,bottom:r,left:r,right:r},be.u)};W.S.safari&&n?r():requestAnimationFrame(r)}}},{key:"unBindEvents",value:function(){this.minderLayoutSubscription&&this.minderLayoutSubscription.unsubscribe()}},{key:"resetMobileMinderCanvas",value:function(){var e=this;if(this.minder&&this.mountPoint){var n=this.getBlockSize().width,r=be.kO,o=this.minder.getCentralBranchView().bounds,i=Math.min(n-2*r,o.width*be.u)*(o.height/o.width)+2*r;this.mountPoint.style.height="".concat(i,"px"),this.mountPoint.style.minHeight="".concat(i,"px"),requestAnimationFrame((function(){if(e.minder){var n=e.minder.getService("PinchPan");n.notifyViewPortUpdate(),n.fitMap({top:r,bottom:r,left:r,right:r},be.u)}}))}}},{key:"getBlockSize",value:function(){var e,n=null===(e=this.mountPoint)||void 0===e?void 0:e.getBoundingClientRect();return n&&n.width>2*be.kO?n:be.n}}]),e}();r("dx_V2Xs");function Ne(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=E()(e);if(n){var i=E()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return O()(this,r)}}var Fe,Ue,He,Ve,We=(Pe=Ae=function(e){_()(r,e);var n=Ne(r);function r(){var e;p()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).bridge=void 0,f()(e,"scheduler",je,y()(e)),e.mountPoint=null,e.resizeIns=void 0,e.isRendered=!1,e.ignoreMinderClick=!1,e.minderClickTimer=void 0,e.minder=void 0,e.loadingOvertimeSetTimeout=void 0,e.screenShot=void 0,e.scrollManage=void 0,f()(e,"depLoader",De,y()(e)),e.state={isSelected:!1,isClicked:!1,isResizing:!1,height:be.Y,isMindmapLoadingError:!1},e.getTableParent=function(){for(var n=e.blockManager.getBlockModelByBlockId(e.id),r=n.parent;null!==r;){if(r.record.get(["type"])===R.B.TABLE)return r;n=r,r=r.parent}return null},e.handleResizeStart=function(){var n;e.setState({isResizing:!0}),null===(n=e.bridge)||void 0===n||n.updateMindnoteSelectionState(e.id,!1)},e.handleResizeUpdate=function(n){var r,o=null!==(r=e.model.snapshot.height)&&void 0!==r?r:be.Y,i=Math.max(be.k,o+n.diffY);e.setState({height:i},e.notifyHeightUpdate)},e.handleResizeEnd=function(n){var r,o,i=null!==(r=e.model.snapshot.height)&&void 0!==r?r:be.Y,c=Math.max(be.k,i+n.diffY);e.setState({height:c,isResizing:!1},e.notifyHeightUpdate),e.model.applyTransaction("handleImageResizeEnd",(function(n){n.replace(e.record.id,["height"],e.state.height)})),e.resizeIns.resetMinderCanvas(),null===(o=e.bridge)||void 0===o||o.updateMindnoteSelectionState(e.id,!0)},e.notifyHeightUpdate=function(){return e.blockManager.layoutManager.notifyNodeHeightChange(e.id)},e.handleDocumentClick=function(n){if(!W.S.isIPad||!W.S.isLark){var r,o=n.target.closest(".mindmap-block-container"),i=n.target.closest(".embedded-mindnote-toolbar-container");if(o&&o===e.mountPoint){if(!e.state.isClicked)e.setState({isClicked:!0}),null===(r=e.bridge)||void 0===r||r.updateMindnoteSelectionState(e.id,!0)}else if(!i&&e.state.isClicked){var c;e.resizeIns.resetMinderCanvas(),e.setState({isClicked:!1}),null===(c=e.bridge)||void 0===c||c.updateMindnoteSelectionState(e.id,!1)}}},e.handleMinderSelectionChange=function(n){n.size>0?(e.ignoreMinderClick=!0,clearTimeout(e.minderClickTimer),setTimeout((function(){if(e.selectionAPI.getSelection().length>0){e.selectionAPI.setSelection([]);var r=$()(n)[0].id,o=e.minder.getBranchViewById(r);o&&e.minder.getService("TextEditor").editorLifecycle.selectView(o.topicView)}e.ignoreMinderClick=!1,e.blockManager.dispatch(pe.v.ADD,e.id)}))):e.blockManager.dispatch(pe.v.REMOVE,e.id)},e.handleMinderClick=function(n){"stage"===n.type&&!e.ignoreMinderClick&&(e.minderClickTimer=setTimeout((function(){e.selectionAPI.setSelection([{id:e.id,type:q.j.BLOCK}])})))},e.handleMouseEnter=function(){e.setShowBlockEditbar(!1),e.setShowBlockEditbar(!0)},e.onClickToolBarBtnCb=function(){e.state.isClicked||e.selectionAPI.setSelection([{id:e.id,type:q.j.BLOCK}])},e.notifyLoadingPlaceholderClear=function(n){e.blockManager.layoutManager.notifyRenderFinish(e.id),e.props.onBlockReady&&e.props.onBlockReady(),e.setState({isMindmapLoadingError:n})},e.handleSelectionChanged=function(n,r){if(e.config.editable||W.S.isMobile||W.S.isIPad){var o,i=r.some((function(n){return n.id===e.id}));if(!e.state.isClicked&&i!==e.state.isSelected)null===(o=e.bridge)||void 0===o||o.updateMindnoteSelectionState(e.id,i);e.setState({isSelected:i})}},e.setRef=function(n){e.mountPoint=n,e.resizeIns=new Le(e.mountPoint)},e.takeScreenshot=function(){var n=H()(F.a.mark((function n(r){var o,i;return F.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((o=r.status)!==R.v.start){n.next=6;break}return n.next=4,new Promise((function(n){setTimeout(H()(F.a.mark((function r(){var o;return F.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,null===(o=e.bridge)||void 0===o?void 0:o.takeScreenShot(e.id);case 2:e.screenShot=r.sent,n({});case 4:case"end":return r.stop()}}),r)}))),100)}));case 4:n.next=7;break;case 6:o===R.v.end&&(null===(i=e.screenShot)||void 0===i||i.done());case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.onResize=Object(ne.debounce)((function(){e.blockManager.layoutManager.isBlockActive(e.props.blockId)&&(e.state.isResizing||(W.S.isMobile?W.S.isIPad&&W.S.isLark&&e.resizeIns.resetMobileMinderCanvas():(e.config.editable&&(e.setShowBlockEditbar(!1),e.setShowBlockEditbar(!0)),e.resizeIns.resetMinderCanvas())))}),500),e.getViewSnapshot=function(){if(!e.model.snapshot.token||!e.bridge)return Object(de.X5)(ge.a);var n=e.bridge.currentScreenShot(e.id),r=e.mountPoint&&e.mountPoint.querySelector("canvas"),o=r&&r.style.width,i=r&&r.style.height;return Object(de.X5)(n,o,i)},e.onBlockFetchFail=function(){var n,r;null===(n=(r=e.props).updateOuterLoadingComponent)||void 0===n||n.call(r,oe.a.createElement(ue.F,{onClickRetry:function(){e.props.updateOuterLoadingComponent(e.props.loadingComponent),e.scheduler.retryFetchBlock(e.props.blockId)}}))},e.mindmapBlockRetry=function(){Object(V.isOnline)()&&(e.props.updateOuterLoadingComponent(e.props.loadingComponent),e.setState({isMindmapLoadingError:void 0}))},e.handleScroll=function(){e.bridge&&e.bridge.updateMindnotePosition&&e.bridge.updateMindnotePosition(e.id)},e.renderComponent=function(n){var r=e.state.isMindmapLoadingError?{id:e.model.id,type:e.model.type}:void 0;return oe.a.createElement(le.S,{onClickRetry:e.mindmapBlockRetry,loadingError:r,style:{height:220}},oe.a.createElement(Se,{handleResizeStart:e.handleResizeStart,handleResizeUpdate:e.handleResizeUpdate,handleResizeEnd:e.handleResizeEnd,boundary:e.boundary,editable:Boolean(e.config.editable),setRef:e.setRef,id:e.id,height:e.state.height,borderColor:e.borderColor,renderFinishCb:n,token:e.model.snapshot.token}))},e.handleMindMapDidRender=function(){e.setSelected(e.state.isSelected)},e}return g()(r,[{key:"blockViewDidMount",value:function(){var e=H()(F.a.mark((function e(){var n,o,i,c;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:te()(E()(r.prototype),"blockViewDidMount",this).call(this),W.S.mobile||(n=this.getTableParent())&&(i=this.blockManager.getBlockViewByBlockId(n.id),c=i.scrollManage,this.scrollManage=c,!this.props.recursionProps.isHistory&&(null===(o=this.scrollManage)||void 0===o||o.onScroll(this.handleScroll))),X.S.on(he.Q,this.takeScreenshot);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"blockViewDidUpdate",value:function(e,n){var o,i;(te()(E()(r.prototype),"blockViewDidUpdate",this).call(this,e,n),e.syncCursorSelected!==this.props.syncCursorSelected)&&(null===(o=this.bridge)||void 0===o||null===(i=o.updateSyncCursorBorderColor)||void 0===i||i.call(o,this.id,this.borderColor))}},{key:"enterBuffer",value:function(){this.resizeIns&&(this.resizeIns.resetMinderCanvas(),W.S.isMobile&&this.resizeIns.resetMobileMinderCanvas(),this.notifyHeightUpdate())}},{key:"enterViewport",value:function(){var e,n=this;this.minder&&(null===(e=this.minder.getService("PinchPan"))||void 0===e||e.notifyViewPortUpdate(),this.notifyHeightUpdate(),setTimeout((function(){var e;null===(e=n.minder.getCentralBranchView())||void 0===e||e.forceRender()}),100))}},{key:"mountMindnote",value:function(){var e=H()(F.a.mark((function e(){var n,r,o,i,c,a=this,l=arguments;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=l.length>0&&void 0!==l[0]?l[0]:{},r=n.version,e.prev=1,!this.bridge||!this.mountPoint||this.isRendered){e.next=8;break}return this.loadingOvertimeSetTimeout=window.setTimeout((function(){a.notifyLoadingPlaceholderClear(!0),clearTimeout(a.loadingOvertimeSetTimeout)}),2e4),this.depLoader.reporter.report("ccm_docx_loadable_block_component_dev",{extra:["third_party_id:".concat(Object(V.encryptTea)(this.model.snapshot.token)," recordid: ").concat(Object(V.encryptTea)(this.model.record.id),", action: mount mindnote")]},{mergeKey:"extra",delay:5e3}),e.next=7,this.bridge.mountMindnote({host:this.mountPoint,token:this.model.snapshot.token,blockId:this.id,undoDispatcher:null===(o=this.props.recursionProps.undoModule)||void 0===o?void 0:o.getUndoDispatcher(),operator:{triggerComment:function(){a.depLoader.triggerComment(a.id)}},onMinderSet:function(e){a.minder=e,a.minder.getService("Selection").selections$.subscribe(a.handleMinderSelectionChange),a.minder.on("click",a.handleMinderClick),a.resizeIns.handleMinderSet(e),window.dispatchEvent(Object(ae.x)("mindmapBlockDidRender",{detail:{blockId:a.id}}))},version:r,enterFullScreenModeCb:function(){a.selectionAPI.setSelection([])},onClickToolBarBtnCb:this.onClickToolBarBtnCb,getSyncCursorBorderColor:function(){return a.borderColor}});case 7:clearTimeout(this.loadingOvertimeSetTimeout);case 8:this.notifyLoadingPlaceholderClear(!1),this.blockManager.layoutManager.notifyRenderFinish(this.id),this.props.recursionProps.isPresentationMode?(null===(i=this.bridge)||void 0===i||null===(c=i.mindnoteManager)||void 0===c||c.fullscreenEnteredHandler(),this.setShowBlockEditbar(!1)):this.setShowBlockEditbar(!0),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),this.notifyLoadingPlaceholderClear(!0),clearTimeout(this.loadingOvertimeSetTimeout);case 17:case"end":return e.stop()}}),e,this,[[1,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"getIsRenderedPromised",value:function(){var e=H()(F.a.mark((function e(){var n=this;return F.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){!function r(){n.isRendered?e({}):setTimeout((function(){r()}),300)}()})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeight",value:function(){return this.state.height}},{key:"blockViewWillUnmount",value:function(){var e,n,o;te()(E()(r.prototype),"blockViewWillUnmount",this).call(this),document.removeEventListener("click",this.handleDocumentClick),null===(e=this.mountPoint)||void 0===e||e.removeEventListener("mouseenter",this.handleMouseEnter),null===(n=this.minder)||void 0===n||n.off("click",this.handleMinderClick),this.unmount(!1),this.resizeIns.unBindEvents(),this.blockManager.removeListener(fe.G,this.onResize),this.selectionAPI.offSelectionChange(this.handleSelectionChanged),X.S.off(he.Q,this.takeScreenshot),null===(o=this.scrollManage)||void 0===o||o.removeScroll(this.handleScroll)}},{key:"unmount",value:function(e){var n;this.bridge&&(this.bridge.unmount(this.id,e),this.mountPoint&&ce.a.unmountComponentAtNode(this.mountPoint),null===(n=this.minder)||void 0===n||n.getService("Selection").selections$.unsubscribe(this.handleMinderSelectionChange))}},{key:"setSelected",value:function(e){var n;this.blockManager.isUnmount||this.ignoreMinderClick||(null===(n=this.bridge)||void 0===n||n.updateMindnoteSelectionState(this.id,e),this.setState({isSelected:e}))}},{key:"setShowBlockEditbar",value:function(e){var n,r;W.S.isMobile||W.S.isIPad&&W.S.isLark||(e&&!this.props.recursionProps.isPresentationMode?null===(n=this.bridge)||void 0===n||n.setShowBlockEditbar(this.id,!0,!0):null===(r=this.bridge)||void 0===r||r.setShowBlockEditbar(this.id,!1))}},{key:"setHovered",value:function(e){var n,r=this.state,o=r.isSelected,i=r.isClicked;o||i||(null===(n=this.bridge)||void 0===n||n.updateMindnoteSelectionState(this.id,e))}},{key:"render",value:function(){var e=this;return oe.a.createElement(ue.h,{scheduler:this.scheduler,eventEmitter:this.props.recursionProps.eventEmitter,blockId:this.props.blockId,blockType:R.B.MINDMAP,onBlockFetchFail:this.onBlockFetchFail,renderErrorPlaceholder:function(){return null},renderLoadingPlaceholder:this.renderComponent,renderContent:function(n,r){return e.renderComponent(H()(F.a.mark((function n(){var o;return F.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r(),e.bridge=e.depLoader.getDepLoader(e.props.recursionProps.scroller).getBridge(),document.addEventListener("click",e.handleDocumentClick),e.selectionAPI.onSelectionChange(e.handleSelectionChanged),!e.bridge||""===e.model.snapshot.token){n.next=14;break}if(!e.props.recursionProps.isHistory||!e.props.historyBlockVersionData){n.next=11;break}return n.next=8,e.mountMindnote({version:e.props.historyBlockVersionData.toVer});case 8:e.setShowBlockEditbar(!1),n.next=14;break;case 11:return n.next=13,e.mountMindnote();case 13:e.setShowBlockEditbar(!0);case 14:null===(o=e.mountPoint)||void 0===o||o.addEventListener("mouseenter",e.handleMouseEnter),e.model.snapshot.height&&e.setState({height:e.model.snapshot.height}),e.blockManager.addListener(fe.G,e.onResize),e.handleMindMapDidRender(),e.isRendered=!0;case 19:case"end":return n.stop()}}),n)}))))}})}},{key:"isBlockRendered",get:function(){return this.isRendered}},{key:"pageToken",get:function(){return this.config.get("token")}},{key:"borderColor",get:function(){var e=this.props,n=e.syncCursorSelected,r=e.syncCursorBorderColor;return!this.state.isSelected&&n?r:void 0}}],[{key:"selectionTargetFilter",value:function(e){return!e.closest(".mindnote-block-container")}}]),r}(se.l),Ae.type=R.B.MINDMAP,Ae.CLASS_NAME="docx-mindnote-block",Me=Pe,je=C()(Me.prototype,"scheduler",[A.b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),De=C()(Me.prototype,"depLoader",[P.i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Me),ze=We;function Ge(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=E()(e);if(n){var i=E()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return O()(this,r)}}var Ke=Object(I.H)({providers:[L,Z,{provide:w.I,useClass:T.V,args:[R.B.MINDMAP,{isAsync:!0,canLazyIdleRender:!1,defaultHeight:220}]},{provide:B.RecordSnapshotCreator,useValue:{type:R.B.MINDMAP,create:M.s}}]})((Ve=function(e){_()(r,e);var n=Ge(r);function r(){var e;p()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return e=n.call.apply(n,[this].concat(i)),f()(e,"depLoader",He,y()(e)),e.blocks=[[j.S,{viewCreator:ze}]],e}return g()(r,[{key:"destroy",value:function(){this.depLoader.destroy()}}]),r}(I.y),Ue=Ve,He=C()(Ue.prototype,"depLoader",[P.i],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fe=Ue))||Fe,qe=Ke;n.S=qe},dx_x2xb:function(e,n,r){"use strict";var o;r.d(n,"A",(function(){return o})),function(e){e[e.slash=1]="slash",e[e.mentionAt=2]="mentionAt",e[e.mentionBracket=3]="mentionBracket",e[e.mentionBracketCN=4]="mentionBracketCN",e[e.mentionRoundBracket=6]="mentionRoundBracket",e[e.mentionRoundBracketCN=7]="mentionRoundBracketCN"}(o||(o={}))},dx_xCN8:function(e,n,r){"use strict";r.d(n,"Z",(function(){return I}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_W7W2"),d=r.n(u),f=r("dx_a1gu"),h=r.n(f),p=r("dx_Nsbk"),v=r.n(p),g=r("dx_evZo"),b=r("dx_cDcd"),y=r.n(b),m=r("dx_DXiY"),_=r("dx_Lqhf"),k=r("dx_BrJR"),O=(r("dx_lNX7"),r("dx_bPy9")),x=r("dx_R7AN");function E(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function S(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?E(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function C(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=v()(e);if(n){var i=v()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return h()(this,r)}}var I=function(e){d()(r,e);var n=C(r);function r(e){var o;return a()(this,r),(o=n.call(this,S(S({},e),{},{customizedAttributeKey:r.KEY}))).blockManager=void 0,o.blockManager=e.blockManager,o}return s()(r,[{key:"render",value:function(e){var n=e.attributes,r=e.children,o=e.zoneId,i=n[this.attributeKey],c=n[x.X],a=i&&Object(m.r)(_.D.Background,i),l=new Set(["text-highlight-background"]);a&&l.add("text-highlight-background-".concat(a));var s=this.blockManager.getBlockModelByBlockId(Object(O.j)(o));return s&&c&&!Object(k.l)(s)&&l.add("text-highlight-background-inline-code-wrapper"),e.class+=" ".concat(Array.from(l).join(" ")),y.a.createElement(y.a.Fragment,null,r)}}]),r}(g.J);I.KEY="textHighlightBackground"},dx_xFJs:function(e,n,r){"use strict";r.d(n,"t",(function(){return R})),r.d(n,"K",(function(){return j})),r.d(n,"n",(function(){return D})),r.d(n,"h",(function(){return P})),r.d(n,"k",(function(){return H})),r.d(n,"M",(function(){return V})),r.d(n,"c",(function(){return z})),r.d(n,"B",(function(){return G})),r.d(n,"j",(function(){return K})),r.d(n,"T",(function(){return X})),r.d(n,"q",(function(){return Y}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_lSNA"),s=r.n(l),u=r("dx_RIqP"),d=r.n(u),f=r("dx_yXPU"),h=r.n(f),p=r("dx_Vvd7"),v=r("dx_NOtv"),g=r.n(v),b=r("dx_h6a8"),y=r("dx_PQBD"),m=r("dx_MoY1"),_=r("dx_Fimk"),k=r("dx_B28d"),O=r("dx_ZG9w"),x=r("dx_D8nn"),E=r("dx_Mtob"),S=r("dx_Tsyy");function C(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function I(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?C(Object(r),!0).forEach((function(n){s()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var B=[k.B.BITABLE,k.B.OKR],T=g()("getStruct"),w=E.a+2*S.w;function R(e){return M.apply(this,arguments)}function M(){return(M=h()(i.a.mark((function e(n){var r,o,c,l,s,u,d,f,h,v,g,b,y,_,O;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.blockManager,o=n.gridBlockId,c=n.columnIndex,l=n.getNewColumnChildrenBlockIds,s=n.getNewColumnChildrenRecordIds,u=n.transactionName,d=n.beforeCreate,f=n.afterColumnCreate,h=n.afterTransactionAccepted,v=n.afterTransaction,g=n.sizeMap,b=p.V,y=-1,_=[],O=g||[],e.next=7,r.applyTransaction(u||"addGridColumn",(function(e){if(!(b=L({op:e,blockManager:r,gridBlockId:o,columnIndex:c,getNewColumnChildrenBlockIds:l}))){d&&d(e);var n=l&&l(e),i=r.getBlockModelByBlockId(o),u=r.getBlockViewByBlockIdNotCheck(o),h=null===u||void 0===u?void 0:u.currentMultiBlockInLineValue,p=1/(i.children.length+1);if(n){var v=r.getBlockModelByBlockId(n[0]);if(v.type===h){var g,E,C=i.children.map((function(e){return e.children[0]}));C.splice(c,0,v);var I=(null===u||void 0===u||null===(g=u.hostElement)||void 0===g||null===(E=g.parentElement)||void 0===E?void 0:E.clientWidth)||730;O=X(h,I,C)||[]}}if(O&&O.length>2)i.children.forEach((function(n,r){var o=r>=c?r+1:r;e.replace(n.recordId,["width_ratio"],O[o].widthRatio),e.replace(O[o].id,["image","scale"],O[o].scale)}));else{var B=0,T=i.children.filter((function(e){var n=e.record.snapshot.width_ratio,r=n*(1-p);return r>S.R&&(B+=n),r>S.R})),w=1-p/B;T.forEach((function(n){var r=n.record.snapshot.width_ratio*w;e.replace(n.recordId,["width_ratio"],r)}))}var R=r.createInitModel(k.B.GRID_COLUMN,{width_ratio:O&&O.length>2?O[c].widthRatio:p}),M=Object(m.l)(e,i.record.id,c,[R]),j=a()(M,1)[0];y=c,n?(_=U({op:e,blockManager:r,targetBlockRecordId:j,otherBlockIds:n,isRecordFromSamePage:F(r,o,n[0])}),O.length>2&&e.replace(_[0],["image","scale"],O[c].scale)):_=s?s(e,j):[Object(m.s)(e,j,r.createInitModel(k.B.TEXT))],e.replaceChildren(j,_),f&&f(e,j,_);var D=r.getBlockIdsByRecordId(j)[0];x.X.newGridColumnId=D}}),{afterTransactionAccepted:h});case 7:return v&&v(_),y>=0&&(b=r.getBlockModelByBlockId(o).children[y].id,N(r,b)),e.abrupt("return",b);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){var n=e.blockManager,r=e.dragBlockIds,o=e.dropTargetBlockId,i=e.toLeft,c=e.fold,a=n.getBlockModelByBlockId(o),l=n.getBlockViewByBlockId(o).hostElement,s=a.parent,u=s.type,f=r.map((function(e){return n.getBlockModelByBlockId(e)})),h=f.every((function(e){var n;return(null===(n=e.parent)||void 0===n?void 0:n.type)===k.B.GRID_COLUMN})),p=h?f.reduce((function(e,n){var r=n.parent.id;return e[r]||(e[r]=[]),e[r].push(n.id),e}),{}):void 0,v=h?Object.keys(p).length+1:2,g=a.position;f.forEach((function(e){e.parent===a.parent&&e.position<a.position&&(g-=1)}));var b,y=[],_=a.type.includes("heading")&&a.record.snapshot.folded;if(_&&(y=c.findFoldedBlocks(o)),u===k.B.CELL){var O,x=null===(O=l.parentElement)||void 0===O?void 0:O.clientWidth;b=x?x<S.s?S.s:x:S.s}else{var E;b=(null===(E=l.parentElement)||void 0===E?void 0:E.clientWidth)||730}var C=i?[].concat(d()(f),[a]):[a].concat(d()(f)),B=C.map((function(e){return e.type})),T=q(B),w=X(T,b,C);w&&Y(!0);var R=w?{widthRatioMap:w.map((function(e){return e.widthRatio}))}:{};return D(I(I({},R),{},{blockManager:n,parentBlockId:s.id,index:g,columnNum:v,transactionName:"createGridByDrop",focusColumnIndex:i?0:1,beforeCreate:function(e){Object(m.y)(e,[o].concat(d()(y),d()(r)),n),w&&w.forEach((function(n){e.replace(n.id,["image","scale"],n.scale)}))},getColumnChildrenInfo:function(e,c,l){if(i&&c===v-1||!i&&0===c){var s=[];return _&&(s=y.map((function(e){return n.getRecordByBlockId(e).id}))),[a.record.id].concat(d()(s)).map((function(e){return{id:e,isNewCreateChild:!1}}))}var u=n.getBlockModelByBlockId(o),f=h?i?Object.values(p)[c]:Object.values(p)[c-1]:r;return U({op:e,blockManager:n,targetBlockRecordId:l||u.record.id,isRecordFromSamePage:F(n,o,r[0]),otherBlockIds:f}).map((function(e){return{isNewCreateChild:!0,id:e}}))}}))}function D(e){return A.apply(this,arguments)}function A(){return(A=h()(i.a.mark((function e(n){var r,o,c,a,l,s,u,d,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.blockManager,o=n.transactionName,c=n.focusColumnIndex,a=n.afterTransactionAccepted,l=n.afterTransaction,s=n.parentBlockId,u=n.index,e.next=3,r.applyTransaction(o||"createGrid",(function(e){P(I(I({},Object(b.pick)(n,["blockManager","index","parentBlockId","columnNum","beforeCreate","afterColumnCreate","getColumnChildrenInfo","widthRatioMap"])),{},{op:e}))}),{afterTransactionAccepted:a});case 3:return l&&l(),d=r.getBlockModelByBlockId(s).children[u],(f=d.children[c||0])&&N(r,f.id),e.abrupt("return",d.id);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e){var n=e.blockManager,r=e.parentBlockId,o=e.index,i=e.columnNum,c=e.getColumnChildrenInfo,l=e.beforeCreate,s=e.afterColumnCreate,u=e.op,d=e.widthRatioMap;l&&l(u);for(var f=n.createInitModel(k.B.GRID,{children:[]}),h=n.getRecordByBlockId(r).id,p=Object(m.l)(u,h,o,[f]),v=a()(p,1)[0],g=[],b=function(e){var r=n.createInitModel(k.B.GRID_COLUMN,{width_ratio:d?d[e]:1/i}),o=Object(m.s)(u,v,r),a=[];c?c(u,e,o).forEach((function(e){var n=e.isNewCreateChild,r=e.id;a.push(r),n||u.replace(r,["parent_id"],o)})):a=[Object(m.s)(u,o,n.createInitModel(k.B.TEXT))];u.replaceChildren(o,a),s&&s(u,e,o,a),g.push(o)},y=0;y<i;y++)b(y);return u.replaceChildren(v,g),v}function L(e){var n=e.op,r=e.blockManager,o=e.gridBlockId,i=e.columnIndex,c=e.getNewColumnChildrenBlockIds,a=c&&c(n);if(a){var l,s,u=r.getBlockModelByBlockId(a[0]);if((null===u||void 0===u||null===(l=u.parent)||void 0===l||null===(s=l.parent)||void 0===s?void 0:s.id)===o&&u.parent.children.every((function(e){var n=e.id;return a.includes(n)}))){var d=u.parent;if(d.position!==i){var f=d.position<i?i-1:i;Object(m.y)(n,[d.id],r);var h=r.getBlockModelByBlockId(o);Object(m.t)(n,h.record.id,f,[d.record.id])}return d.id}}return p.V}function N(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=e.getBlockModelByBlockId(n),i=o.children[r];if(i){var c=e.getBlockViewByBlockId(i.id);if(Object(O.U)(c)){var a=c.model.getText(),l=a.length;c.model.setSelection({start:l,len:0},!0)}}}function F(e,n,r){var o=e.getBlockModelByBlockId(n),i=e.getBlockModelByBlockId(r);return o.modelService.rootBlockId===i.modelService.rootBlockId}function U(e){var n=e.blockManager,r=e.targetBlockRecordId,o=e.otherBlockIds,i=e.op,c=e.isRecordFromSamePage;return o[0]?o.map((function(e){if(c){var o=n.getBlockModelByBlockId(e);return i.replace(o.record.id,["parent_id"],r),o.record.id}return Object(y.L)({op:i,blockId:e,blockManager:n,recursive:!0,parentRecordId:r})})):[]}function H(e,n){try{for(var r=n.getBlockModelByBlockIdNotCheck(e);r&&r.parent;){if(r.record.snapshot.type===k.B.GRID_COLUMN)return!0;r=r.parent}}catch(o){T("model not found")}return!1}function V(e,n){try{for(var r=n.getBlockModelByBlockId(e);r.parent;){if(r.record.snapshot.type===k.B.GRID_COLUMN)return{gridParent:r.parent.parent,gridBlock:r.parent,gridColumnBlock:r};r=r.parent}}catch(o){T("model not found")}return null}function W(e,n){try{var r=n.getBlockModelByBlockId(e),o=r.record.snapshot.type;if(B.includes(o))return!1;var i=!0;return r.children.forEach((function(e){i&&(i=W(e.id,n))})),i}catch(c){return T("model not found"),!1}}function z(e,n,r){return H(e,r)&&(n=n.filter((function(e){return W(e,r)}))),n}function G(e){var n;return(((null===e||void 0===e||null===(n=e.children)||void 0===n?void 0:n.length)||0)-1)*S.o}function K(e,n,r){var o={},i=e.getBlockModelByBlockId(n),c=i.record.snapshot.width_ratio;if(!Object(b.isNumber)(c))return o;var a=G(i.parent);return r?(o.flexGrow=100*c,o.width="unset"):(o.flexGrow=0,o.flexShrink=0,o.width="calc((100% - ".concat(a,"px) * ").concat(c,")")),o}var q=function(e){return e.every((function(n){return n===e[0]}))?e[0]:null},X=function(e,n,r){return e===k.B.IMAGE?function(e,n){var r=0,o=!1,i=w/e,c=n.reduce((function(e,n){var r=n.record.snapshot.image;return e+r.width/r.height}),0),a=(e-n.length*(2*S.w))/c,l=n.map((function(n){var c=n.record.snapshot.image,l=c.width,s=c.height,u=a/s,d=l*u;d<730&&(u=730/l);var f=(d+2*S.w)/e;return f<i&&(f=i,o=!0),r+=f,{id:n.record.id,scale:u,widthRatio:f}}));return o?l.map((function(e){if(e.widthRatio===i)return e;var n=e.widthRatio/r;return I(I({},e),{},{widthRatio:n})})):l}(n,r):null},Y=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Object(_.N)("ccm_doc_content_page_click",{click:"grid_same_line_multi_pic",is_pic_equal_height:e?"true":"false",target:"none"})}},dx_xI7u:function(e,n,r){"use strict";r.d(n,"I",(function(){return i})),r.d(n,"A",(function(){return c})),r.d(n,"R",(function(){return a})),r.d(n,"v",(function(){return l})),r.d(n,"F",(function(){return s})),r.d(n,"u",(function(){return u})),r.d(n,"Y",(function(){return d})),r.d(n,"x",(function(){return o})),r.d(n,"T",(function(){return h})),r.d(n,"b",(function(){return p})),r.d(n,"FZ",(function(){return v})),r.d(n,"X",(function(){return g})),r.d(n,"a",(function(){return b})),r.d(n,"y",(function(){return y})),r.d(n,"f",(function(){return m}));var o,i=60*(new Date).getTimezoneOffset()*1e3,c=864e5,a={RUNNING:0,SUCCESSES:1,FAILED:2},l="docx-history-content",s=500,u="docx-history-loading",d=1622433600;!function(e){e.UN_KNOW="UN_KNOW",e.NORMAL="NORMAL",e.NO_DATA="NO_DATA",e.OFFLINE="OFFLINE",e.FAILED="FAILED",e.NO_SECRET="NO_SECRET"}(o||(o={}));var f,h={SUCCESS:"SUCCESS",PARTIAL_SUCCESS:"PARTIAL_SUCCESS",FAIL:"FAIL"},p="history-key",v="is-show-undo-history-entry-tip",g="HISTORY_VISIBLE_CHANGE",b=3;!function(e){e.TILED="TILED",e.STACKED="STACKED"}(f||(f={}));var y;!function(e){e.HISTROY_DRAG_PLACEHOLDER="historyDragPlaceholder"}(y||(y={}));var m="HISTORY_RESTORE"},dx_xIqD:function(e,n,r){"use strict";(function(t){r.d(n,"T",(function(){return C}));var e=r("dx_RIqP"),o=r.n(e),i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_J4zp"),u=r.n(s),d=r("dx_lwsE"),f=r.n(d),h=r("dx_W8MJ"),p=r.n(h),v=r("dx_UtDZ"),g=r("dx_h6a8"),b=r("dx_eSV8"),y=r("dx_D8nn"),m=r("dx_WS3J"),_=r("dx_PtCP"),k=r("dx_z2zF"),O=r("dx_IEnx"),x=r("dx_Vioe"),E=r("dx_lnCS"),S=function(){function e(){var n=this;f()(this,e),this.deregisterMsgBox=void 0,this.blockVotesMap=new Map,this.blockListenMap=new Map,this.blockManager=void 0,this.votesUpdateMessageCache=new Map,this.offlineDataStorage=void 0,this.hasInit=!1,this.updatePollPublish=function(e){var r;return Object(v.isOnline)()?Object(E.w)(n.blockManager.getRootRecordId(),e).then((function(r){var o=r.data.poll_info,i=n.blockVotesMap.get(e);return i.isPublish=!0,i.isAnonymous=o.is_anonymous,i.creatorId=o.creator_id,i.pollType=o.poll_type,Object(g.cloneDeep)(i)})).catch((function(){console.error("\u66f4\u65b0\u6295\u7968\u53d1\u5e03\u72b6\u6001\u5931\u8d25")})).finally((function(){n.blockManager.config.get("isPresentationMode")&&y.S.emit(y.p.PRESENTATION.FORCE_UPDATE_PAGINATION)})):(null===(r=n.offlineDataStorage)||void 0===r||r.addRecord(e,m.y,{blockId:e}),v.Toast.info({content:t("CreationDoc_Docs_Poll_AutoPublish_Toast"),duration:5e3,key:"publish-offline"}),Promise.resolve())},this.updatePollVote=function(e,r){var o={},i=n.blockVotesMap.get(e);Object.entries(r).forEach((function(e){var r=u()(e,2),c=r[0],a=r[1].emojiId;o[c]={emoji_id:a},i.currentUser[c]||(i.currentUser[c]={}),i.currentUser[c].emojiId=a;var l=i.optionMap[c];l||(l={offset:0,count:0,votes:[]},i.optionMap[c]=l);var s=n.getCurrentUserId(i);n.updateVote(i,c,s,i.currentUserAvatar,a)}));var c,a=n.blockListenMap.get(e);return null===a||void 0===a||a(Object(g.cloneDeep)(i),!0),Object(v.isOnline)()?(Object(E.YD)(n.blockManager.getRootRecordId(),e,o),i):(null===(c=n.offlineDataStorage)||void 0===c||c.addRecord(e,m.g,{blockId:e,optionMap:o}),void v.Toast.info({content:t("CreationDoc_Docs_Poll_NoInternet_Toast"),duration:5e3,key:"vote-offline"}))},this.getUpdatedVoteData=function(e,r){var o=e.optionMap,i=r.user_count,c=r.user_choice,a=c.user_id,l=c.avatar_url,s=c.option_map;return e.userCount=i,Object.entries(s).forEach((function(r){var i=u()(r,2),c=i[0],s=i[1];o[c]||(o[c]={offset:0,count:0,votes:[]});var d=s.emoji_id;n.updateVote(e,c,a,l,d)})),e},this.handlePublishPollWhenOnline=function(e){Object(E.w)(n.blockManager.getRootRecordId(),e.blockId)},this.handleUpdateVoteWhenOnline=function(e){var r=e.blockId,o=e.optionMap;Object(E.YD)(n.blockManager.getRootRecordId(),r,o)},this.handleMessage=function(e){var r;try{r=JSON.parse(e)}catch(l){return void Object(b.n)(l)}var o=r,i=o.token,c=o.block_id;if(i===n.blockManager.getRootRecordId()){var a;if(!n.blockVotesMap.get(c))return n.votesUpdateMessageCache.has(c)||n.votesUpdateMessageCache.set(c,[]),void(null===(a=n.votesUpdateMessageCache.get(c))||void 0===a||a.push(r));r.operation===k.G.publish?n.handlePublishUpdateMessage(r):!function(e){return e.operation===k.G.vote}(r)?n.handleUserCountUpdateMessage(r):n.handleVoteUpdateMessage(r)}},this.handlePublishUpdateMessage=function(e){var r=e.block_id,o=n.blockVotesMap.get(r);if(!o.isPublish){var i=e.poll_info,c=i.is_anonymous,a=i.is_publish,l=i.creator_id;o.creatorId=l,o.isPublish=a,o.isAnonymous=c;var s=n.blockListenMap.get(r);null===s||void 0===s||s(o,!1)}},this.handleVoteUpdateMessage=function(e){var r=e.block_id,o=e.user_choice.user_id,i=n.blockVotesMap.get(r),c=n.getUpdatedVoteData(i,e),a=n.getCurrentUserId(i)===o,l=n.blockListenMap.get(r);null===l||void 0===l||l(Object(g.cloneDeep)(c),a)},this.handleUserCountUpdateMessage=function(e){var r=e.user_count,o=e.block_id,i=n.blockVotesMap.get(o);i.userCount=r;var c=n.blockListenMap.get(o);null===c||void 0===c||c(Object(g.cloneDeep)(i),!1)},this.updateVote=function(e,r,o,i,c){var a=e.optionMap,l=e.currentUser,s=n.getCurrentUserId(e)===o,u=a[r].votes,d=u.findIndex((function(e){return e.userId===o}));if(s&&(l[r]={emojiId:c}),d<0&&c)u.push({userId:o,avatar:i,emojiId:c}),a[r].count++;else if(c){u[d].emojiId=c}else{if(d<0)return;u.splice(d,1),a[r].count--}}}return p()(e,[{key:"destroy",value:function(){var e,n;null===(e=this.deregisterMsgBox)||void 0===e||e.call(this),this.blockVotesMap.clear(),this.blockListenMap.clear(),null===(n=this.offlineDataStorage)||void 0===n||n.destroy(),this.offlineDataStorage=void 0,this.hasInit=!1}},{key:"getCurrentUserIdByBlockId",value:function(e){var n=this.blockVotesMap.get(e);if(n)return this.getCurrentUserId(n)}},{key:"getCurrentUserId",value:function(e){var n=e.currentUserAnonymousId,r=e.currentUserId;return e.isAnonymous?n:r}},{key:"getCurrentVotes",value:function(e){var n;return Object(g.cloneDeep)(null===(n=this.blockVotesMap.get(e))||void 0===n?void 0:n.currentUser)||{}}},{key:"getCacheData",value:function(e){return Object(g.cloneDeep)(this.blockVotesMap.get(e))}},{key:"onVotesChange",value:function(e,n,r,o){var i=this,a=n.getRootRecordId();this.blockManager=n;var s,u,d=this.hasInit;(d||(this.offlineDataStorage=new O.C(a)),this.blockListenMap.set(e,r),this.blockVotesMap.get(e))||(this.blockVotesMap.set(e,{isPublish:!1,currentUserAnonymousId:"",currentUser:{},creatorId:"",optionMap:{},userCount:0,isAnonymous:!1,pollType:"single",currentUserId:"",currentUserAvatar:""}),null===(s=this.offlineDataStorage)||void 0===s||s.registerBlock({blockId:e,eventType:m.y,cacheType:x.t.ONLY_CACHE_RESULT,handlerWhenOnline:this.handlePublishPollWhenOnline}),null===(u=this.offlineDataStorage)||void 0===u||u.registerBlock({blockId:e,eventType:m.g,cacheType:x.t.ONLY_CACHE_RESULT,handlerWhenOnline:this.handleUpdateVoteWhenOnline,shouldMerge:!0}),this.getBlockVotes(e).then(function(){var n=l()(c.a.mark((function n(o){var l,s,u;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(l=o.cacheVotes,s=o.version,console.log("[POLL]: get block votes success"),d){n.next=7;break}return u=s||0,n.next=6,Object(_.w)(a,i.handleMessage,u);case 6:i.deregisterMsgBox=n.sent;case 7:return i.blockVotesMap.set(e,l),r(Object(g.cloneDeep)(l),!1),n.abrupt("return");case 10:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).catch((function(){console.error("\u62c9\u53d6\u6295\u7968\u4fe1\u606f\u5931\u8d25"),o&&o()})),this.hasInit=!0)}},{key:"getOptionVotesDetail",value:function(){var e=l()(c.a.mark((function e(n){var r,i,a,l,s,u,d,f,h,p,v,g,b;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.blockId,i=n.optionId,a=this.getCacheData(r)){e.next=4;break}return e.abrupt("return");case 4:return l=a.optionMap,s=l[i],e.next=8,Object(E.q)(this.blockManager.getRootRecordId(),r,i,s.offset);case 8:return u=e.sent,d=u.data.data,f=d.offset,h=d.votes,p=void 0===h?[]:h,v=d.count,(g=this.getCacheData(r))||(g=a),b=g.optionMap[i].votes||[],g.optionMap[i]={offset:f,votes:[].concat(o()(b),o()(p.map((function(e){return{userId:e.user_id,avatar:e.avatar_url,emojiId:e.emoji_id}})))),count:v},this.blockVotesMap.set(r,g),e.abrupt("return",g);case 16:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"getBlockVotes",value:function(){var e=l()(c.a.mark((function e(n){var r,o,i,a,l,s,d,f,h,p,v,g,b,y;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(E.Y)(this.blockManager.getRootRecordId(),n);case 2:return r=e.sent,o=r.data,i=o.current_user,a=o.poll_info,l=a.is_anonymous,s=a.is_publish,d=a.poll_type,f=a.creator_id,h=o.option_data,p=o.user_count,v=o.version,g=Object.entries(h).reduce((function(e,n){var r=u()(n,2),o=r[0],i=r[1],c=i.offset,a=i.votes,l=i.count;return e[o]={offset:c,votes:a?a.map((function(e){return{userId:e.user_id,avatar:e.avatar_url,emojiId:e.emoji_id}})):[],count:l},e}),{}),y={currentUser:b={},currentUserAnonymousId:i.anonymous_user_id,isAnonymous:l,isPublish:s,pollType:d,optionMap:g,userCount:p,creatorId:f,currentUserId:i.user_id,currentUserAvatar:i.avatar_url},i&&Object.entries(i.option_map).forEach((function(e){var n=u()(e,2),r=n[0],o=n[1];b[r]={emojiId:o.emoji_id}})),e.abrupt("return",{cacheVotes:y,version:v});case 9:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),e}(),C=new S}).call(this,r("dx_E9Eu"))},dx_xKBv:function(e,n,r){"use strict";var o=r("dx_UtDZ"),i=r("dx_h74D"),c=r("dx_o0o1"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_W7W2"),v=r.n(p),g=r("dx_a1gu"),b=r.n(g),y=r("dx_Nsbk"),m=r.n(y),_=r("dx_cDcd"),k=r.n(_),O=r("dx_J4zp"),x=r.n(O),E=r("dx_lSNA"),S=r.n(E),C=r("dx_QWS3"),I=r("dx_TSYQ"),B=r.n(I),T=r("dx_UHze"),w=r("dx_VmtY"),R=r("dx_D8nn"),M=r("dx_PCVy"),j=r("dx_YR5F"),D=r("dx_kLTg"),A=r("dx_IWRl"),P=r("dx_k8kI");var L=r("dx_xlCA");var N,F=o.UserPopover,U=function(e){var n=e.mentionId,r=e.userId,o=e.currentUserId,i=e.userName,c=e.avatarUrl,a=e.unreadable,l=e.onClick,s=e.showAvatar,u=void 0===s||s,d=e.showPopover,f=void 0===d||d,h=e.renderExternal,p=e.trigger,v=void 0===p?"hover":p,g=e.hideAction,b=e.tabIndex,y=e.blockManager,m=e.recordId,O="at-user-line-".concat(a?"disable":r===o?"self":"other"),E=function(e,n){var r=Object(_.useRef)(null),o=Object(_.useRef)(0),i=Object(_.useCallback)((function(){if(r.current){var c=e.getBlockIdsByRecordId(n),a=x()(c,1)[0];if(a){var l=Object(A.b)(e,a);if(l){var s=e.getRecordByBlockId(l).id,u=r.current.getBoundingClientRect().width;if(u||!(++o.current<=3))return R.N.emit(D.l,{cellId:s,recordId:n,minWidth:u+10|0}),s;e.addListenerOnce(P.w2,i)}}}}),[n,e]);return Object(_.useEffect)((function(){var e=i();return function(){e&&R.N.emit(D.W,{cellId:e,recordId:n})}}),[n,i]),r}(y,m),I=k.a.createElement("span",null,k.a.createElement("a",{href:"javascript:void(0)","data-token":r,"data-mention-id":n,className:B()(O,"at-user-wrap","mention-type_0","at-user-text","mention-token_".concat(r),S()({},"at-user-no-avatar",!u)),ref:E,tabIndex:b},k.a.createElement(C.E,{curUserId:o,userId:r,userName:i,userAvatar:c,userReadable:!a,onClick:l,showAvatar:u,renderExternal:h}))),L=Object(_.useState)(M.N.Mouse),N=x()(L,2),U=N[0],H=N[1],V=Object(_.useCallback)((function(e){e===M.N.Keyboard&&function(){var e,n,r;return!!(null===(e=window.getSelection())||void 0===e||null===(n=e.anchorNode)||void 0===n||null===(r=n.parentElement)||void 0===r?void 0:r.closest(".".concat(j.r)))}()||H(e)}),[]),W=Object(_.useCallback)((function(e){e?(y.addListener(w.N,V),V(R.X.editMode)):y.removeListener(w.N,V)}),[V,y]);return Object(_.useEffect)((function(){return function(){y.removeListener(w.N,V)}}),[V]),e.fromSSR||Object(T.E)()?I:k.a.createElement(F,{prefixCls:B()(j.r,{hidden:!f||U===M.N.Keyboard}),source:"docx-at-user",token:e.userId,name:e.userName,trigger:v,hideAction:g,placement:"rt",align:{offset:[10,0]},usePopover:!0,mouseEnterDelay:300,onVisibleChange:W},I)},H=r("dx_MuBQ"),V=(r("dx_JLMK"),function(e){var n=e.userId,r=e.isShowPermission;return Object(_.useEffect)((function(){return r&&H.S.addUserPermission(n),function(){r&&H.S.removeUserPermission(n)}}),[n]),k.a.createElement(U,e)}),W=r("dx_rQGm"),z=(r("dx_yzqx"),r("dx_zEdG")),G=r("dx_rldU"),K=r("dx_TwmW"),q=r("dx_BBJ7"),X=r("dx_HTwv");r("dx_n4nI");function Y(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}!function(e){e[e.PENDING=0]="PENDING",e[e.SUCCESS=1]="SUCCESS",e[e.FAIL=2]="FAIL"}(N||(N={}));var J=[500,1e3,2e3],Z=function(e){v()(r,e);var n=Y(r);function r(e){var i,c;if(d()(this,r),(i=n.call(this,e)).state={status:N.PENDING,editMode:q.N.Mouse},i.blockManager=void 0,i.mounted=!1,i.retryCount=0,i.timeId=void 0,i.fetchUserInfo=s()(a.a.mark((function e(){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.state.status===N.PENDING){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,n=i.props.fetchUser||L.n.fetch,e.next=6,n(i.realRecordId,i.props.uid);case 6:r=e.sent,i.updateState({status:N.SUCCESS,detail:r}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),i.retryFetchUserInfo();case 13:case"end":return e.stop()}}),e,null,[[2,10]])}))),i.retryFetchUserInfo=function(){i.retryCount>=3?i.updateState({status:N.FAIL}):(i.retryCount++,i.timeId=window.setTimeout(i.fetchUserInfo,J[i.retryCount-1]))},i.handleClick=function(){var e=i.props,n=e.uid,r=e.record,c=e.type;Object(z.P)("ccm_doc_content_page_click",{block_type:c,record_id:r.id},{target:W.o.CCM_DOCS_PAGE_VIEW,click:"click_inline_component",inline_type:G.k.USER,object_inline_id:Object(o.encryptTea)(n)})},i.blockManager=i.props.blockManager,!i.props.fetchUser){var l=(c=i.props.uid,L.n.getCache(c));l&&l.name&&l.avatar_url&&(i.state.detail=l,i.state.status=N.SUCCESS)}return i}return h()(r,[{key:"realRecordId",get:function(){var e=this.props,n=e.isHistory,r=e.record;return Object(X.h)(r,n)}}]),h()(r,[{key:"componentDidMount",value:function(){var e=s()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.mounted=!0,this.fetchUserInfo();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateState",value:function(e){this.mounted&&this.setState(e)}},{key:"componentWillUnmount",value:function(){this.mounted=!1,clearTimeout(this.timeId)}},{key:"render",value:function(){var e,n=this.props,r=n.uid,i=n.mentionId,c=n.userReadable,a=n.suiteShareable,l=n.renderExternal,s=n.isSSR,u=n.showAvatar,d=n.trigger,f=n.hideAction,h=n.tabIndex,p=n.record,v=o.userHelper.getCurrentUser().get("id"),g="boolean"!==typeof u||u,b=this.state.editMode===q.N.Mouse&&!this.props.isTranslated,y=!(this.blockManager.isPreview||Object(K.S)()),m=!1===c&&a&&y;return k.a.createElement(V,{currentUserId:v,userId:r,userName:this.userName,avatarUrl:null===(e=this.state.detail)||void 0===e?void 0:e.avatar_url,fromSSR:s,mentionId:i,unreadable:m,onClick:this.handleClick,showAvatar:g,showPopover:b,renderExternal:l,trigger:d,hideAction:f,isShowPermission:y,tabIndex:h,blockManager:this.blockManager,recordId:p.id})}},{key:"userName",get:function(){var e=this.props.uid;return L.n.getUserShowName(e)}}]),r}(k.a.Component),Q=Object(i.connect)((function(e,n){var r=n.uid,i=Object(o.selectDocUserPermission)(e,r);return{isTranslated:o.selectors.translate.selectTranslateStatus(e).translated,suiteShareable:Object(o.selectCurrentSuiteShareable)(e),userReadable:i&&i.readable}}))(Z);n.S=Q},dx_xPLQ:function(e,n,r){"use strict";r.d(n,"C",(function(){return i})),r.d(n,"G",(function(){return c}));var o=r("dx_A2Ao"),i="task-block-assigneeShareClass";function c(e){var n=e.id,r=e.name,c=e.hostElement;setTimeout((function(){o.S.addTaskMemberMentionNotify({id:n,name:r},(function(){return c.querySelector(".".concat(i," a[data-token='").concat(n,"']"))}))}))}},dx_xQPx:function(e,n,r){"use strict";r.d(n,"s",(function(){return i}));var o=window.localStorage.sophon_fg,i={};try{o&&(i=JSON.parse(o))}catch(c){console.error('localStorage["sophon_fg"] parse error',c)}},dx_xVHQ:function(e,n,r){"use strict";(function(t){r.d(n,"F",(function(){return o}));var e=r("dx_PcQO");function o(){e.toast.info({content:t("CreationDoc_DocX_level_copy_tooMany_failed_cotnent"),key:"over_layer_tips",duration:5e3,newStyle:!1})}}).call(this,r("dx_E9Eu"))},dx_xWRc:function(e,n,r){"use strict";r.d(n,"r",(function(){return u})),r.d(n,"B",(function(){return d})),r.d(n,"D",(function(){return f})),r.d(n,"M",(function(){return h}));var o=r("dx_vdIl"),i=r("dx_Fimk"),c=r("dx_B28d"),a=r("dx_zghO"),l=r("dx_ppc6");function s(e){return e.getService(l.S).getSelection().map((function(n){var r,o,i=e.modelService.getBlockModelByBlockId(n.id);return i?{id:i.id,type:i.type,selType:n.type,selection:n.selection||null,parentId:null===(r=i.parent)||void 0===r?void 0:r.id,parentType:null===(o=i.parent)||void 0===o?void 0:o.type}:null}))}function u(e,n,r){var o=d(e.map((function(e){return e.model})),n,r),i=o.blockList,c=o.noInSelBlockList,a=e[0].model.editorAPI.viewService;return{blockList:i.filter((function(e){return a.hasBlockViewByBlockId(e.id)})).map((function(e){return a.getBlockViewByBlockId(e.id)})),noInSelBlockList:c.filter((function(e){return a.hasBlockViewByBlockId(e.id)})).map((function(e){return a.getBlockViewByBlockId(e.id)}))}}function d(e,n,r){if(!n||!e.length)return{blockList:e,noInSelBlockList:[]};var o=e[0].editorAPI.getService(l.S).getSelection();if(0===o.length)return{blockList:e,noInSelBlockList:[]};for(var i=e.slice(r?0:1),c=i.filter((function(e){return!i.find((function(n){var r;return n.id===(null===(r=e.parent)||void 0===r?void 0:r.id)}))})),s=[],u=function(e){var n=i[e],r=o.find((function(e){return e.id===n.id}));if(r&&r.type===a.j.BLOCK)return"continue";n.children.forEach((function(e){i.find((function(n){return n.id===e.id}))||s.push(e)}))},d=i.length-1;d>=0;d--)u(d);return{blockList:c,noInSelBlockList:s}}function f(e){return e&&e.type===c.B.QUOTE?{parentRecordId:e.parent.recordId,position:e.position+1}:{parentRecordId:e.recordId,position:0}}function h(e,n,r){var c=e.zoneState,a=c.totalWidth();if(n>a-1){var l,u,d,f,h=c.getEntities([]),p=e.snapshot.text.initialAttributedTexts.text;return Object(i.S)("doc_bug_track_dev",{action:"invalid_selection_start",info:JSON.stringify({id:e.id,start:n,record_length:null===(l=p[o.x])||void 0===l?void 0:l.length,editor_content_length:a,view_length:null===(u=c._node)||void 0===u||null===(d=u.textContent)||void 0===d?void 0:d.length,last_entity:encodeURIComponent(null===(f=h[h.length-1])||void 0===f?void 0:f.text),docx_selection:s(r),editor_selection:e.getSelection()})}),a-1}return n}},dx_xYlW:function(e,n,r){},dx_xeoP:function(e,n,r){"use strict";r.d(n,"o",(function(){return l}));var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c);var l=function(){function e(){var n=this;i()(this,e),this.currentRange=void 0,this.editors=new Map,this.selectedEditor=null,this.handleSelectionChange=function(){var e,r,o,i=getSelection(),c=(null===i||void 0===i?void 0:i.rangeCount)?null===i||void 0===i?void 0:i.getRangeAt(0):void 0;if(!c)return n.selectedEditor&&(null===(e=n.editors.get(n.selectedEditor))||void 0===e||e.onBlur()),n.selectedEditor=null,void(n.currentRange=c);if(!n.currentRange||(r=n.currentRange,o=c,!(r.startContainer===o.startContainer&&r.startOffset===o.startOffset&&r.endContainer===o.endContainer&&r.endOffset===o.endOffset||r.startContainer===o.endContainer&&r.startOffset===o.endOffset&&r.endContainer===o.startContainer&&r.endOffset===o.startOffset))){var a,l=n.selectedEditor;if(n.selectedEditor=null,n.editors.forEach((function(e,r){var o=i.anchorNode;r.getContainer().contains(o)&&(e.onSelect(),n.selectedEditor=r)})),l&&l!==n.selectedEditor)null===(a=n.editors.get(l))||void 0===a||a.onBlur()}n.currentRange=c},document.addEventListener("selectionchange",this.handleSelectionChange)}return a()(e,[{key:"register",value:function(e,n){this.editors.set(e,n)}},{key:"unregister",value:function(e){this.editors.delete(e)}},{key:"destroy",value:function(){document.removeEventListener("selectionchange",this.handleSelectionChange),this.editors.clear()}},{key:"getEditor",value:function(e){return this.editors.get(e)}}]),e}()},dx_xk1y:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("g",{clipPath:"url(#icon_file_diagram_flowchart_nor_svg__clip0)",fillRule:"evenodd",clipRule:"evenodd"},i.a.createElement("path",{d:"M0 2a2 2 0 012-2h14a2 2 0 012 2v14a2 2 0 01-2 2H2a2 2 0 01-2-2V2z",fill:"#F80"}),i.a.createElement("path",{d:"M10.045 6.405l1.214-1.202 1.214 1.202-1.214 1.201-1.214-1.201zm-3.295.633h2.158l.248.246 1.214 1.201.889.88.888-.88 1.214-1.201.889-.88-.889-.879-1.214-1.201-.888-.88-.889.88-1.214 1.201-.265.263H6a.5.5 0 00-.5.5V8.678h-2a.5.5 0 00-.5.5v.25a.5.5 0 00.5.5h2v2.391a.5.5 0 00.5.5h2.625v.75a.5.5 0 00.5.5h4.313a.5.5 0 00.5-.5v-2.75a.5.5 0 00-.5-.5H9.125a.5.5 0 00-.5.5v.75H6.75V7.038zm3.125 5.781v-1.25h2.813v1.25H9.874z",fill:"#fff"}));n.S=function(e){return i.a.createElement("svg",c({width:18,height:18,viewBox:"0 0 18 18",fill:"none"},e),a)}},dx_xl9j:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return _}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_glkC"),l=r("dx_PcQO"),s=r("dx_cDcd"),u=r.n(s),d=r("dx_D4DL"),f=r("dx_zEdG"),h=r("dx_CwnG"),p=r("dx_zghO"),v=r("dx_r61a"),g=r("dx_G6GV"),b=r("dx_XlRC"),y="list-modify-input",m=[{formatter:a.H,parser:a.r,checker:function(e){return/^[ivxlcdm]*$/i.test(e)}},{formatter:function(e){return"".concat(e)},parser:function(e){return parseInt(e,10)},checker:function(e){return/^[0-9]*$/.test(e)}},{formatter:a.k,parser:a.X,checker:function(e){return/^[a-zA-Z]*$/.test(e)}}];function _(e){var n=e.blockManager,r=e.blockId,i=e.recordId,a=e.updateVisible,_=e.SelectionAPI,k=Object(s.useMemo)((function(){return Object(b.x)(n,r)}),[n,r]),O=((null===k||void 0===k?void 0:k.level)||1)%3,x=Object(s.useMemo)((function(){return Object(b.A)(n,r,v.b.UP)}),[n,r]),E=Object(s.useRef)((null===k||void 0===k?void 0:k.order)||1),S=Object(s.useCallback)((function(e){E.current=e}),[]),C=Object(s.useCallback)((function(){var e=Object(h.m)(r,n);Object(f.P)("ccm_doc_ordered_set_number_click",e,{click:"click_confirm_edit_number",sub_view:"ordered"})}),[n,r]),I=Object(s.useCallback)(c()(o.a.mark((function e(){var c,l,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===E.current||E.current===(null===k||void 0===k?void 0:k.order)){e.next=5;break}return c=x&&E.current===x.order+1,l=c?"auto":String(E.current),e.next=5,n.applyTransaction("list:modify:update",(function(e){e.replace(i,["seq"],l),Object(g.L)(r,e,n)}));case 5:a(!1),s=n.getBlockModelByBlockId(r).getText().length-1,_.setSelection([{id:r,type:p.j.TEXT,selection:{start:s,end:s}}]),C();case 9:case"end":return e.stop()}}),e)}))),[n,r,null===k||void 0===k?void 0:k.order,C,x]),B=Object(s.useRef)(null);return Object(s.useEffect)((function(){B.current&&B.current.select()}),[]),u.a.createElement("div",{className:"".concat(y)},u.a.createElement("span",{className:"".concat(y,"-titile")},t("doc.list.the_new_number_is")),u.a.createElement(d.S,{defaultValue:null===k||void 0===k?void 0:k.order,min:1,max:v.h,formatter:m[O].formatter,parser:m[O].parser,checker:m[O].checker,onChange:S,onPressEnter:I}),u.a.createElement(l.Button,{className:"".concat(y,"-btn"),type:"primary",onClick:I},t("common.determine")))}}).call(this,r("dx_E9Eu"))},dx_xlCA:function(e,n,r){"use strict";r.d(n,"n",(function(){return k}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_RIqP"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_UtDZ"),v=r("dx_h6a8"),g=r("dx_jBAU"),b=r("dx_EqZO"),y=r("dx_Za4A"),m=r("dx_D8nn"),_="user detail fetch failed",k=function(){function e(){var n=this;d()(this,e),this.clientVar=void 0,this.waitMap=new Map,this.fetchMap=new Map,this.readyMap=new Map,this.uidToRecordIdMap=new Map,this.eventEmitter=new m.i,this.batchFetch=Object(v.debounce)(s()(i.a.mark((function r(){var o,c,l;return i.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if((o=a()(n.waitMap.keys())).length){r.next=3;break}return r.abrupt("return");case 3:return o.forEach((function(e){return O(e,n.waitMap,n.fetchMap)})),c={},l=o.map((function(e){return n.uidToRecordIdMap.get(e)})),Object(y.K)(b.s,{no_user_map:1}),r.prev=7,r.next=10,g.S.fetchUserInfo(l);case 10:c=r.sent.data.user_map,r.next=17;break;case 13:r.prev=13,r.t0=r.catch(7),c=null,console.error("account info fetch error",r.t0);case 17:o.forEach((function(r){var o=n.fetchMap.get(r);if(o){if(!c)return console.warn(_,r),n.fetchMap.delete(r),void o.reject(new Error(_));var i=c[r];if(!i)return n.fetchMap.delete(r),void o.reject(new Error("fetch_success_but_not_data"));n.fetchMap.delete(r),e.setCache(r,i),o.resolve(i)}else console.warn("user detail error:",r)}));case 18:case"end":return r.stop()}}),r,null,[[7,13]])}))),100)}return h()(e,[{key:"fetch",value:function(e,n){console.assert(e),console.assert(n);var r=this._getUserDetailFromAllMap(n);if(r)return r;var o={};return o.result=new Promise((function(e,n){return Object.assign(o,{resolve:e,reject:n})})),this.waitMap.set(n,o),this.uidToRecordIdMap.set(n,e),this.batchFetch(),o.result}},{key:"hasUserInfo",value:function(e){var n=this.readyMap.get(e);if(n){var r=n.name,o=n.en_name;return!!r&&!!o}return!1}},{key:"_getUserDetailFromAllMap",value:function(e){var n,r,o=null;this.hasUserInfo(e)?o=this.readyMap.get(e):o=(null===(n=this.fetchMap.get(e))||void 0===n?void 0:n.result)||(null===(r=this.waitMap.get(e))||void 0===r?void 0:r.result);return o?Promise.resolve(o):null}}],[{key:"fetch",value:function(n,r){return console.assert(n),console.assert(r),e.instance.fetch(n,r)}},{key:"getUserDetailFromAllMap",value:function(n){return e.instance._getUserDetailFromAllMap(n)}},{key:"applyClientVar",value:function(n){var r=n.user_map;if(r)for(var o in r)r[o]&&e.setCache(o,r[o])}},{key:"applyNewChangesExtra",value:function(n){for(var r in n)n[r]&&e.setCache(r,n[r])}},{key:"setCache",value:function(n,r){e.instance.readyMap.set(n,r),e.instance.eventEmitter.emit("change",n,r)}},{key:"getCache",value:function(n){return e.instance.readyMap.get(n)}},{key:"getUserShowName",value:function(n){var r=e.getCache(n);if(r){var o=p.urlHelper.parseQuery(window.location.href).lang||p.i18nHelper.getLanguage()||"en",i=r.name,c=r.en_name;return("en"===o?c:i)||i||c}}},{key:"getUserList",value:function(){return e.instance.readyMap.keys()}},{key:"onChange",value:function(n){e.instance.eventEmitter.on("change",n)}},{key:"offChange",value:function(n){e.instance.eventEmitter.off("change",n)}}]),e}();function O(e,n,r){var o=n.get(e);n.delete(e),r.set(e,o)}k.instance=new k},dx_xlMp:function(e,n,r){"use strict";r.d(n,"o",(function(){return o})),r.d(n,"f",(function(){return E})),r.d(n,"e",(function(){return S}));var o,i=r("dx_o0o1"),c=r.n(i),a=r("dx_yXPU"),l=r.n(a),s=r("dx_lwsE"),u=r.n(s),d=r("dx_W8MJ"),f=r.n(d),h=r("dx_PJYZ"),p=r.n(h),v=r("dx_W7W2"),g=r.n(v),b=r("dx_a1gu"),y=r.n(b),m=r("dx_Nsbk"),_=r.n(m),k=r("dx_Dw4b"),O=r("dx_m0BX");function x(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=_()(e);if(n){var i=_()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return y()(this,r)}}!function(e){e[e.TITLE=0]="TITLE",e[e.AUTHOR=1]="AUTHOR"}(o||(o={}));var E=function(e){g()(r,e);var n=x(r);function r(e){var o;return u()(this,r),(o=n.call(this,e)).index=void 0,o.range=void 0,o.scrollIntoView=function(e,n,r,i){var a=p()(o).blockId,s=n.getBlockViewByBlockId(a),u=n.getRecordByBlockId(a).id;return e.scrollToRecord(u,l()(c.a.mark((function e(){var r,a,l,u,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.getBlockViewByBlockId(n.getRootBlockId()),a=r.hostElement.getBoundingClientRect(),l=Object(O.F)(n)-a.top,!((u=s.hostElement.querySelectorAll(".block-catalog--content-item")).length<o.index)){e.next=6;break}return e.abrupt("return");case 6:d=u[o.index].getBoundingClientRect(),Object(O.E)({startTop:l+d.top,endBottom:l+d.bottom,scrollContainer:i});case 8:case"end":return e.stop()}}),e)}))))},o.index=e.index,o.range=e.range,o}return f()(r,[{key:"isReplaceable",get:function(){return!1}}]),r}(k.S),S=function(e){g()(r,e);var n=x(r);function r(e){var o;return u()(this,r),(o=n.call(this,e)).index=void 0,o.range=void 0,o.blockMatchType=void 0,o.scrollIntoView=function(e,n,r,i){var a=p()(o).blockId,s=n.getBlockViewByBlockId(a),u=n.getRecordByBlockId(a).id;return e.scrollToRecord(u,l()(c.a.mark((function e(){var r,a,l,u,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.getBlockViewByBlockId(n.getRootBlockId()),a=r.hostElement.getBoundingClientRect(),l=Object(O.F)(n)-a.top,!((u=s.hostElement.querySelectorAll(".block-recent--content-item")).length<o.index)){e.next=6;break}return e.abrupt("return");case 6:d=u[o.index].getBoundingClientRect(),Object(O.E)({startTop:l+d.top,endBottom:l+d.bottom,scrollContainer:i});case 8:case"end":return e.stop()}}),e)}))))},o.index=e.index,o.range=e.range,o.blockMatchType=e.blockMatchType,o}return f()(r,[{key:"isReplaceable",get:function(){return!1}}]),r}(k.S)},dx_xm7J:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("g",{fill:"none",fillRule:"evenodd"},i.a.createElement("circle",{fill:"#14C0FF",cx:22,cy:22,r:22}),i.a.createElement("rect",{stroke:"#FFF",strokeWidth:2,x:12,y:14,width:20,height:16,rx:1}),i.a.createElement("path",{d:"M27.663 18.07l-3.605.257.279 4.604 3.605-.258-.279-4.604z",stroke:"#FFF",strokeWidth:2}),i.a.createElement("path",{d:"M15.4 21h4.2c.22 0 .4.18.4.4v1.2a.4.4 0 01-.4.4h-4.2a.4.4 0 01-.4-.4v-1.2c0-.22.18-.4.4-.4zM15.4 25h6.2c.22 0 .4.18.4.4v1.2a.4.4 0 01-.4.4h-6.2a.4.4 0 01-.4-.4v-1.2c0-.22.18-.4.4-.4z",fill:"#FFF"}));n.S=function(e){return i.a.createElement("svg",c({width:44,height:44,viewBox:"0 0 44 44"},e),a)}},dx_xs2W:function(e,n,r){"use strict";r.d(n,"x",(function(){return x})),r.d(n,"M",(function(){return T})),r.d(n,"V",(function(){return R})),r.d(n,"z",(function(){return j})),r.d(n,"t",(function(){return D})),r.d(n,"zp",(function(){return P})),r.d(n,"P",(function(){return L})),r.d(n,"u",(function(){return F})),r.d(n,"T",(function(){return U})),r.d(n,"y",(function(){return H}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_UtDZ"),a=r("dx_h6a8"),l=(r("dx_ADkB"),r("dx_imty")),s=(r("dx_eSV8"),r("dx_J4zp")),u=r.n(s);function d(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!n){var o="\n      \u8bf7\u4f7f\u7528'$helpers/suiteHelper.ts'\u4e2d\u7684getToken\n      \u56e0\u4e3aurl\u5f62\u5f0f\u591a\u6837, \u5982:\n        doc/docXXX\n        wiki/wikXXX\n      \u4f60\u7684\u7ec4\u4ef6\u53ef\u80fd\u9700\u8981docXXX\u800c\u4e0d\u662fwikXXX\n      \u5982\u679c\u4f60\u786e\u8ba4\u9700\u8981\u89e3\u6790\u4f20\u5165url\u7684token, \u8bf7\u4e3aparseOriginUrl\u7b2c\u4e8c\u4e2a\u53c2\u6570\u4f20\u5165true\n    ";console.error(o)}var i=/(?:([A-Za-z]+):\/\/)/,c=/(?:([.\-\w]+))/,a=/(?::(\d+))/,l=/(\/[^?#\s\u2E80-\u9FFF]*)/,s=/(\?[^#\s]*)/,d=/(#[^\s]*)/,h=/([\s\S]*)/,p=function(e){return e.map((function(e){return e.source})).join("?")},v=new RegExp("^".concat(p([i,c,a,l,s,d,h]),"?$")),g="",b="";try{g=decodeURIComponent(e)}catch(L){g=unescape(e)}if(!r){var y=f(g);g=y.urlWithRest,b=y.preText}var m=v.exec(g)||[],_=u()(m,8),k=_[1],O=void 0===k?"":k,x=_[2],E=void 0===x?"":x,S=_[3],C=void 0===S?"":S,I=_[4],B=void 0===I?"":I,T=_[5],w=void 0===T?"":T,R=_[6],M=void 0===R?"":R,j=_[7],D=void 0===j?"":j,A=/(?:\/)?(?:space\/|drive\/)?([a-zA-Z-_]+)?(?:\/([^?#]*))/.exec(B)||[],P={protocol:O,hostname:E,port:C,pathname:B,token:A[2]||"",search:w,hash:M};return r||(P.restText=D,P.preText=b),P}function f(e){var n=e.match(/^((?!https?).|\s)*/);if(n){var r=n[0];return{urlWithRest:e.substring(r.length),preText:r}}return{urlWithRest:e,preText:""}}r("dx_B28d");var h=r("dx_D26z"),p=(r("dx_ZG9w"),r("dx_kZ3l")),v=r("dx_D8nn");var g,b="https?|s?ftp|ftps|nfs",y="%[0-9a-f]{2}",m="\\b([\\/#\\?]([\\-A-Z0-9".concat("","@:_+.~#?&'/=;$,!\\*\\[\\]\\(\\){}^|<>]|(").concat(y,"))*([-A-Z0-9&@#/=~\\(\\)_|]|(").concat(y,"))?)?"),_=new RegExp("((((".concat(b,")://)?(").concat(/localhost(:[0-9]{2,5})?/.source,"))|(((").concat(b,")://)(").concat(/(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}(2[0-4][0-9]|25[0-5]|1[0-9]{2}|[1-9][0-9]|[0-9])(:[0-9]{2,5})?/.source,")))").concat(m),"gi"),k="(([".concat("","]{1,256}\\.){1,50}|([\\-A-Z0-9_+~#@]{1,256}\\.){1,50})"),O="[".concat("","a-z0-9\\-]{2,15}"),x=new RegExp("^s*((".concat("https?","):\\/\\/").concat(k).concat(O,")(:[0-9]{2,5})?").concat(m,"s*$"),"i"),E=new RegExp("(((".concat(b,"):\\/\\/)?(").concat(k,")(").concat(O,"))(:[0-9]{2,5})?").concat(m),"gi"),S=new RegExp("(((".concat(b,"):\\/\\/").concat(k).concat(O,")|(").concat(k,"(").concat("com|cn|tk|de|net|org|uk|info|nl|ru|hk",")))(:[0-9]{2,5})?").concat(m),"gi"),C="[\\w.!#$%&'*+-/=?^_\\`{|}~]{1,2000}@[A-Za-z0-9_.-]+\\.",I=new RegExp("^(?!data:)((mailto:".concat(C).concat(O,")|(").concat(C,"(").concat("com|org|net|int|edu|gov|mil|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gh|gi|gl|gm|gn|gp|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mf|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|site|top|wtf|xxx|xyz|cloud|engineering|help|one",")))\\b"),"gi"),B=new RegExp("".concat(I.source,"|").concat(E.source,"|").concat(_.source),"gi"),T=new RegExp("".concat(I.source,"|").concat(S.source,"|").concat(_.source),"gi"),w=/block:\/\/([\w-]+)\?from=([\w-]+)&id=([\w-]+)/;function R(e){try{return new URL(e,window.location.href)}catch(n){return null}}function M(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new RegExp("^(".concat(b,"|mailto):")).test(e)}function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r="";return r=M(e)?e:A(e)?"mailto:".concat(e):"http://".concat(e),n?encodeURIComponent(r):r}!function(e){e.BLANK="_blank",e.IN_PAGE="in-page",e.FORCE_IN_PAGE="force-in-page",e.TRY_EXPLORE="try-explore"}(g||(g={}));var D=Object(a.memoize)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return T.lastIndex=0,T.test(e)}));function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new RegExp(I).test(e)}function P(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return new RegExp(w).test(e)}function L(e,n,r){var o=n?B:T;r&&(o=new RegExp("^(".concat(o.source,")$"),"gi"));var i=new RegExp(o).exec(e);return!(!i||0!==i.index)}function N(e){var n=new RegExp(T);n.lastIndex=0;for(var r=null,o=[];r=n.exec(e);){var c=r.index,a=r[0],l=j(a);o.push({range:[c,c+a.length],mark:i()({},h.V,l)})}return o}function F(e,n,r){var o=[];return D(n)&&N(n).forEach((function(n){var i=n.range,c=[r[0]+i[0],r[0]+i[1]],a=Object(p.j)(e,c);e.model.zoneState.getEntities(a).every((function(e){return e.attributes[h.P]&&e[h.G]}))||o.push({range:c,value:decodeURIComponent(n.mark[h.V])})})),o}function U(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"_blank",r=window.open(e,n,"noopener=yes,noreferrer=yes");r&&(r.opener=null)}function H(e,n){var r,o,i=e.metaKey,a=e.ctrlKey,s=function(e){return d(e,!0).hash.slice(1)}(n),u=function(e){var n=window.docsLocation||window.location,r=d(e,!0).pathname,o=d(n.href,!0).pathname;return Object(c.isDocUrl)(e)&&r===o}(n)&&!!s;u&&(i||a?U(n):(null===(r=document.activeElement)||void 0===r||null===(o=r.blur)||void 0===o||o.call(r),v.S.emit(l.H.LocateBlockWithRecordId,s)));return u}},dx_xy70:function(e,n,r){"use strict";r.d(n,"i",(function(){return a})),r.d(n,"O",(function(){return l}));var o=r("dx_S5bw"),i=r("dx_VnDw"),c=r("dx_t9fZ"),a=new o.p,l=a.pipe(Object(i.N)((function(e){return e})),Object(c.y)(1))},dx_y0f4:function(e,n,r){},dx_y0o7:function(e,n,r){},dx_y5yU:function(e,n,r){"use strict";r.d(n,"r",(function(){return l}));var o=r("dx_Icqc"),i=r("dx_iJWO"),c=r("dx_cDcd"),a=r.n(c);function l(e,n){return a.a.forwardRef((function(r,c){var l=Object.assign((null===n||void 0===n?void 0:n.size)?{width:n.size,height:n.size}:{},r.style),s=function(){var s=(null===n||void 0===n?void 0:n.theme)||Object(o.getCurrentThemeType)().toLowerCase();return a.a.createElement(i.G,{mode:s},a.a.createElement(e,Object.assign({ref:c},r,{style:l})))};return!o.ThemeContext||(null===n||void 0===n?void 0:n.theme)?s():a.a.createElement(o.ThemeContext.Consumer,null,s)}))}},dx_y62y:function(e,n,r){"use strict";r.d(n,"r",(function(){return i})),r.d(n,"f",(function(){return c}));var o=r("dx_B28d"),i=2,c=[o.B.HEADING1,o.B.HEADING2,o.B.HEADING3,o.B.HEADING4,o.B.HEADING5,o.B.HEADING6,o.B.HEADING7,o.B.HEADING8,o.B.HEADING9]},dx_y7Um:function(e,n,r){},dx_yDa2:function(e,n,r){"use strict";r.d(n,"F",(function(){return M})),r.d(n,"O",(function(){return j}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_o0o1"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_sNGG"),v=r("dx_J4zp"),g=r.n(v),b=r("dx_QxNg"),y=r("dx_h6a8"),m=r("dx_xlCA"),_=r("dx_k8kI"),k=r("dx_KTtu"),O="==== [blockFindService] ====",x=function(){function e(n){var r=this,o=n.triggerFind,i=n.blockManager,c=n.eventEmitter;d()(this,e),this.type=k.k.Block,this.blockManager=void 0,this.keyword=void 0,this.renderBlocks=void 0,this.bufferBlocks=void 0,this.matches=null,this.triggerFind=void 0,this.eventEmitter=void 0,this.handleDateChangeImpl=function(){r.matches=null,r.triggerFind(r.type)},this.handleDataChange=Object(y.debounce)(this.handleDateChangeImpl,300,{leading:!0,maxWait:500}),this.handleViewportChanged=function(e){var n,o=e.viewportBlocks;r.renderBlocks=o,r.bufferBlocks=r.blockManager.layoutManager.getBufferBlocks(),r.matches&&(null===(n=r.matches)||void 0===n?void 0:n.length)>0&&r.triggerFind(r.type)},this.triggerFind=o,this.blockManager=i,this.eventEmitter=c,this.renderBlocks=i.layoutManager.getViewportBlocks(),this.bufferBlocks=i.layoutManager.getBufferBlocks(),m.n.onChange(this.handleDataChange),i.recordManager.on(b.q.CHANGE,this.handleDataChange),this.eventEmitter.on(p.Y.THIRD_PARTY_CONTENT_CHANGE,this.handleDataChange),i.addListener(_.rC,this.handleViewportChanged)}return h()(e,[{key:"destroy",value:function(){var e=this.blockManager;m.n.offChange(this.handleDataChange),e.recordManager.off(b.q.CHANGE,this.handleDataChange),e.removeListener(_.rC,this.handleViewportChanged),this.eventEmitter.off(p.Y.THIRD_PARTY_CONTENT_CHANGE,this.handleDataChange)}},{key:"find",value:function(){var e=s()(a.a.mark((function e(n){var r,o,i,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.blockManager,o=r.rootBlockId,this.matches&&this.keyword===n||(i=r.getBlockModelByBlockId(o),c=i.find(n),this.matches=c,this.keyword=n),e.abrupt("return",this.calculateVisibleMatches(this.matches));case 4:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"replaceAll",value:function(e,n){var r=this,o=n.reduce((function(e,n){return n.isReplaceable?(e[n.blockId]?e[n.blockId].push(n):e[n.blockId]=[n],e):e}),{}),i=Object.entries(o).map((function(n){var o=g()(n,2),i=o[0],c=o[1],a=Number(i),l=r.blockManager.getBlockModelByBlockId(a);return l&&l.replaceAll?l.replaceAll(e,c):Promise.resolve()}));return Promise.all(i)}},{key:"calculateVisibleMatches",value:function(e){var n,r,o=this,i=this.blockManager.rootBlockId,c=e.map((function(e,c){return e.visible=e.blockId===i||o.renderBlocks.indexOf(e.blockId)>-1,!n&&e.visible&&(n=c),r||!n||e.visible||(r=c),e}));if(void 0!==n)for(var a=n,l=Math.max(a-10,0);a>l;){try{var s=c[a];this.bufferBlocks.indexOf(s.blockId)>-1&&(s.visible=!0)}catch(h){console.error(O,"getBlockInstance error:",h)}a--}if(void 0!==r)for(var u=r,d=Math.min(u+10,c.length-1);u<d;){try{var f=c[u];this.bufferBlocks.indexOf(f.blockId)>-1&&(f.visible=!0)}catch(h){console.error(O,"getBlockInstance error:",h)}u++}return c}}]),e}(),E=r("dx_RIqP"),S=r.n(E),C=r("dx_eSV8"),I=r("dx_D8nn"),B=r("dx_w5wE"),T=function(){function e(n){var r=this,o=n.triggerFind,i=n.blockManager,c=n.eventEmitter,a=n.commentModule;d()(this,e),this.type=k.k.Comment,this.blockManager=void 0,this.keyword=void 0,this.renderBlocks=void 0,this.bufferBlocks=void 0,this.triggerFind=void 0,this.eventEmitter=void 0,this.commentModule=void 0,this.commentSDK=void 0,this.matchPromiseResolver=void 0,this.commentMatchList=[],this.globalCommentMatchList=[],this.handleGlobalCommentMatchChange=function(e){r.matchPromiseResolver?r.globalCommentMatchList=e.map((function(e){return new B.H(e,r.commentModule)})):r.triggerFind(r.type)},this.handleMatchChange=function(e){r.matchPromiseResolver?(r.commentMatchList=e.map((function(e){return new B.J(e,r.commentModule)})),r.matchPromiseResolver()):r.triggerFind(r.type)},this.triggerFind=o,this.blockManager=i,this.eventEmitter=c,this.commentModule=a,a.ready((function(){r.commentSDK=a.getInnerCommentModule()})),this.bindEvent("on")}return h()(e,[{key:"bindEvent",value:function(e){I.s[e](p.Y.COMMENT_MATCH_CHANGE,this.handleMatchChange),I.s[e](p.Y.GLOBAL_COMMENT_MATCH_CHANGE,this.handleGlobalCommentMatchChange)}},{key:"find",value:function(){var e=s()(a.a.mark((function e(n){var r,o,i=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(""!==n){e.next=3;break}return this.clearFind(),e.abrupt("return",[]);case 3:if(this.commentSDK){e.next=5;break}return e.abrupt("return",[]);case 5:if(r=this.commentSDK.getPlugin("search")){e.next=8;break}return e.abrupt("return",[]);case 8:return o=new Promise((function(e){i.matchPromiseResolver=e})),r.search(n),e.next=12,Promise.race([o,Object(C.E)(500)]);case 12:return this.matchPromiseResolver=void 0,e.abrupt("return",[].concat(S()(this.commentMatchList),S()(this.globalCommentMatchList)));case 14:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"replaceAll",value:function(){var e=s()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!1);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"clearFind",value:function(){if(this.commentSDK){this.globalCommentMatchList=[],this.commentMatchList=[];var e=this.commentSDK.getPlugin("search");e&&e.clearSearch()}}},{key:"destroy",value:function(){this.bindEvent("off"),this.clearFind()}}]),e}();function w(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function R(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?w(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var M={selected:"rgba(var(--R500-raw), 0.5)",matched:"rgba(var(--Y500-raw), 0.5)"},j=function(){function e(n){var r=this,o=n.blockManager,i=n.eventEmitter,c=n.fold,l=n.viewport,u=n.rect,f=n.scrollContainer,h=n.commentModule;d()(this,e),this.matches={},this.services=[],this.blockManager=void 0,this.eventEmitter=void 0,this.fold=void 0,this.viewport=void 0,this.rect=void 0,this.scrollContainer=void 0,this.serviceCreators=[x],this._onMatchesChangeCb=void 0,this.keyword=void 0,this.selectedIndex=0,this.raf=void 0,this.destroy=function(){Object.values(r.services).forEach((function(e){return e.destroy()})),r.clearHighlight()},this.onMatchesChange=function(e){r._onMatchesChangeCb=e},this.find=function(){var e=s()(a.a.mark((function e(n){var o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.keyword=n,o=r.services.map(function(){var e=s()(a.a.mark((function e(o){var i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.find(n);case 2:i=e.sent,r.setMatches(o.type,i);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),e.next=4,Promise.all(o);case 4:r.handleMatchesChange(),n&&r.fold.forceShowAllFoldedBlock();case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),this.triggerFind=function(){var e=s()(a.a.mark((function e(n){var o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.keyword){e.next=2;break}return e.abrupt("return");case 2:if(o=r.services.find((function(e){return e.type===n}))){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,o.find(r.keyword);case 7:i=e.sent,r.setMatches(o.type,i),r.renderHighlight(),r.handleMatchesChange();case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),this.highlightAt=function(e){void 0!==e&&(r.selectedIndex=e),r.scrollToSelectedMatch().then((function(){r.renderHighlight()}))},this.blockManager=o,this.eventEmitter=i,this.fold=c,this.viewport=l,this.rect=u,this.scrollContainer=f,h&&this.serviceCreators.push(T),this.registerServices({commentModule:h})}return h()(e,[{key:"registerServices",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.serviceCreators.forEach((function(r){var o=new r(R({blockManager:e.blockManager,triggerFind:e.triggerFind,eventEmitter:e.eventEmitter},n));e.services.push(o),e.matches[o.type]=[]}))}},{key:"handleMatchesChange",value:function(){this._onMatchesChangeCb&&this._onMatchesChangeCb(this.orderedMatches),0===this.orderedMatches.length&&this.clearHighlight()}},{key:"setMatches",value:function(e,n){this.matches[e]=n}},{key:"renderHighlight",value:function(){var e=this,n=this.orderedMatches.map((function(n,r){return{match:n,isSelected:e.selectedIndex===r,color:e.selectedIndex===r?M.selected:M.matched}})).filter((function(e){return e.match.visible||e.match.type===k.V.Comment}));window.cancelAnimationFrame(this.raf),this.raf=window.requestAnimationFrame((function(){e.eventEmitter.emit(p.Y.RANGE_CHANGE,n)}))}},{key:"clearHighlight",value:function(){window.cancelAnimationFrame(this.raf),this.eventEmitter.emit(p.Y.RANGE_CHANGE,[])}},{key:"replace",value:function(){var e=s()(a.a.mark((function e(n,r){var o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==r&&(this.selectedIndex=r),!(o=this.selectedMatch).isReplaceable||!o.replaceWith){e.next=5;break}return e.next=5,o.replaceWith(n);case 5:return e.abrupt("return");case 6:case"end":return e.stop()}}),e,this)})));return function(n,r){return e.apply(this,arguments)}}()},{key:"replaceAll",value:function(){var e=s()(a.a.mark((function e(n){var r,o=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.orderedMatches.length<1)){e.next=2;break}return e.abrupt("return");case 2:return r=this.services.map((function(e){return e.replaceAll(n,o.matches[e.type])})),e.next=5,Promise.all(r);case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()},{key:"scrollToSelectedMatch",value:function(){var e=s()(a.a.mark((function e(){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.selectedMatch){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,n.scrollIntoView(this.viewport,this.blockManager,this.rect,this.scrollContainer);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"orderedMatches",get:function(){var e=this;return this.services.reduce((function(n,r){return n.concat(e.matches[r.type]||[])}),[])}},{key:"selectedMatch",get:function(){return this.orderedMatches[this.selectedIndex]}}]),e}()},dx_yDdD:function(e,n,r){},dx_yJE3:function(e,n,r){},dx_yT1x:function(e,n,r){"use strict";(function(t){r.d(n,"v",(function(){return d}));var e=r("dx_QILm"),o=r.n(e),i=r("dx_TSYQ"),c=r.n(i),a=r("dx_cDcd"),l=r.n(a),s=r("dx_Pz0G"),u=(r("dx_Sz6v"),r("dx_B28d")),d=function(e){var n=e.className,r=o()(e,["className"]);return l.a.createElement(s.S,Object.assign({className:c()("refresh-placeholder",n),displayMode:u.J.BLOCK},r),l.a.createElement("p",{className:"refresh-placeholder-tips"},t("CreationDoc_ISV_VersionUpdated_Loading")))}}).call(this,r("dx_E9Eu"))},dx_yU7P:function(e,n,r){"use strict";r.d(n,"r",(function(){return i}));var o=r("dx_cDcd");function i(e){var n=Object(o.useRef)(e);return n.current=e,Object(o.useCallback)((function(){return n.current.apply(n,arguments)}),[])}},dx_yYtq:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M6.667 3.333V2.5c0-.46.373-.833.833-.833h5c.46 0 .834.373.834.833v.833h4.465c.186 0 .254.02.322.056.067.036.12.09.157.157.036.068.056.136.056.321v.599c0 .185-.02.253-.056.32a.378.378 0 01-.157.158c-.068.037-.136.056-.322.056h-1.132v12.5c0 .46-.373.833-.833.833H4.167a.833.833 0 01-.833-.833V5H2.2c-.186 0-.253-.02-.32-.056a.379.379 0 01-.158-.157c-.037-.068-.056-.136-.056-.321v-.599c0-.185.02-.253.056-.32a.379.379 0 01.157-.158c.068-.036.135-.056.321-.056h4.466zM5 5v11.666h10V5H5zm2.917 2.5h.833c.23 0 .417.186.417.417v5.833c0 .23-.187.416-.417.416h-.833a.417.417 0 01-.417-.416V7.917c0-.23.187-.417.417-.417zm3.333 0h.834c.23 0 .416.186.416.417v5.833c0 .23-.186.416-.416.416h-.834a.417.417 0 01-.416-.416V7.917c0-.23.186-.417.416-.417z",fill:"currentColor"});n.S=function(e){return i.a.createElement("svg",c({width:20,height:20,viewBox:"0 0 20 20",fill:"none"},e),a)}},dx_yaFe:function(e,n,r){"use strict";r.d(n,"V",(function(){return i}));var o=r("dx_xjz2"),i=Object(o.S3)("image-data-cache-storage")},dx_yb0T:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("g",{fill:"none",fillRule:"evenodd"},i.a.createElement("path",{d:"M0 0h16v16H0z"}),i.a.createElement("path",{d:"M10.8 3.39H5.2v.576c0 .156-.016.213-.047.27a.318.318 0 01-.132.132c-.057.03-.114.047-.27.047H4.25c-.156 0-.213-.017-.27-.047a.318.318 0 01-.132-.132c-.03-.057-.047-.114-.047-.27V3.39H2.4v10.244h11.2V3.39h-1.4v.576c0 .156-.016.213-.047.27a.318.318 0 01-.132.132c-.057.03-.114.047-.27.047h-.502c-.156 0-.213-.017-.27-.047a.318.318 0 01-.132-.132c-.03-.057-.047-.114-.047-.27V3.39zm1.4-1.366h2.1c.387 0 .7.306.7.683v11.61a.692.692 0 01-.7.683H1.7a.692.692 0 01-.7-.683V2.707c0-.377.313-.683.7-.683h2.1V1.45c0-.156.016-.213.047-.27a.318.318 0 01.132-.132c.057-.03.114-.047.27-.047h.502c.156 0 .213.016.27.047.057.03.102.075.132.132.03.057.047.114.047.27v.575h5.6V1.45c0-.156.016-.213.047-.27a.318.318 0 01.132-.132c.057-.03.114-.047.27-.047h.502c.156 0 .213.016.27.047.057.03.102.075.132.132.03.057.047.114.047.27v.575zm-9.8 4.44h11.2v1.365H2.4V6.463z",fill:"#646a73"}));n.S=function(e){return i.a.createElement("svg",c({width:16,height:16,viewBox:"0 0 16 16"},e),a)}},dx_ygJz:function(e,n,r){"use strict";var o=r("dx_So6W");r.d(n,"G",(function(){return o.S}))},dx_yl1C:function(e,n,r){"use strict";var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W8MJ"),a=r.n(c),l=r("dx_W7W2"),s=r.n(l),u=r("dx_a1gu"),d=r.n(u),f=r("dx_Nsbk"),h=r.n(f),p=r("dx_RIqP"),v=r.n(p),g=r("dx_Vvd7"),b=r("dx_N9dL"),y=r("dx_T4T0"),m=r("dx_Z22N"),_=r("dx_B28d"),k=r("dx_L0LN"),O=r("dx_I8xe"),x=r("dx_UtDZ"),E=r("dx_AAGW"),S=r("dx_AilC"),C=r("dx_NMQJ");function I(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var B=function(e){s()(r,e);var n=I(r);function r(e){return i()(this,r),n.call(this,e)}return a()(r,[{key:"getText",value:function(){return"[OKR]"}},{key:"notify",value:function(){E.S.post("/okrx/api/block/block_notify/",{block_ids:[this.recordId],docx_token:Object(x.getToken)()},{baseURL:Object(S.Y)()})}},{key:"onPasteRecordAfterAccepted",value:function(){this.notify()}}]),r}(C.D);B.type=_.B.OKR;var T=r("dx_lSNA"),w=r.n(T),R=r("dx_KHvq"),M=r("dx_PRjj"),j=r("dx_lROi");function D(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function A(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?D(Object(r),!0).forEach((function(n){w()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function P(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var L=function(e){s()(r,e);var n=P(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"generateTextBlockMatches",value:function(e,n,r){var o={blockManager:this.blockManager,blockId:this.id,key:n};return Object(j.A)(e,n).map((function(e){return new M.v(A(A({},o),{},{range:[e.start+r,e.end+r]}))}))}}]),r}(R.H);function N(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function F(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?N(Object(r),!0).forEach((function(n){w()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function U(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}L.type=_.B.OBJECTIVE;var H=function(e){s()(r,e);var n=U(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"generateTextBlockMatches",value:function(e,n,r){var o={blockManager:this.blockManager,blockId:this.id,key:n};return Object(j.A)(e,n).map((function(e){return new M.v(F(F({},o),{},{range:[e.start+r,e.end+r]}))}))}}]),r}(R.H);function V(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}H.type=_.B.KEY_RESULT;var W=function(e){s()(r,e);var n=V(r);function r(){return i()(this,r),n.apply(this,arguments)}return r}(C.D);W.type=_.B.PROGRESS;var z=r("dx_iWIM"),G=r.n(z),K=r("dx_QxNg"),q=r("dx_FBWK"),X=r("dx_TSYQ"),Y=r.n(X),J=r("dx_h6a8"),Z=r("dx_cDcd"),Q=r.n(Z),$=r("dx_yzqx"),ee=r("dx_SreQ"),te=r("dx_hKul"),ne=r("dx_XfTi"),re=r("dx_amgp"),oe=r("dx_HnEY");function ie(e){return Object(J.clamp)(function(e){var n=e.mode,r=e.percent,o=e.current,i=e.start,c=e.target;return n===re.W.SIMPLE?r:c===i?0:Object(J.round)(100*(o-i)/(c-i))}(e),0,9999)||0}var ce=r("dx_PcQO"),ae=r("dx_p1pd"),le=r("dx_MBBr"),se=(r("dx_lVRe"),function(e){var n=e.status,r=e.onConfirm,o=void 0===r?J.noop:r,i=e.onStatusChange,c=void 0===i?J.noop:i,a=e.onPopoverVisibleChange,l=void 0===a?J.noop:a,s=e.getPopupContainer,u=e.onProgressTagHover,d=void 0===u?J.noop:u,f=Q.a.createElement("div",{className:"".concat("okr-status-editor","__wrapper")},Q.a.createElement(le.S,{value:n,onChange:c}));return Q.a.createElement(ce.Popover,{trigger:"click",onVisibleChange:function(e){l(e),e||o()},content:f,placement:"bottom",getPopupContainer:s},Q.a.createElement("div",null,Q.a.createElement(ae.S,{status:n,className:"editable",onHover:d})))}),ue=r("dx_k7kc"),de=r("dx_Ofv4"),fe=function(e){var n=e.canEdit,r=e.progressRateSetting,o=e.progressRate,i=e.showTooltip,c=e.onProgressRateChange,a=e.onProgressRateSave,l=e.onProgressPopoverShow,s=e.onProgressTagHover,u=o.mode,d=o.percent,f=o.start,h=o.current,p=o.target,v=o.progressStatus,g=ie(o),b=function(e){var n;return(null===(n=e.closest(".okr-block"))||void 0===n?void 0:n.querySelector(".okr-block__popover-container"))||document.body},y=function(e,n){e?a():c(n)},m=function(e){e&&l()},_=function(e){c({progressStatus:e})};return Q.a.createElement(Q.a.Fragment,null,n?r===re.V.STATUS?Q.a.createElement(se,{status:v,onStatusChange:_,onConfirm:function(){return y(!0)},getPopupContainer:b,onPopoverVisibleChange:m,onProgressTagHover:s}):Q.a.createElement(ue.S,{type:2,updateType:1,mode:u,start:f,percent:d,current:h,target:p,progressStatus:v,onStatusChange:_,onSave:y,getPopupContainer:b,onPopoverVisibleChange:m},Q.a.createElement("div",null,Q.a.createElement(de.S,{type:2,progress:g,status:v,editable:!0,onHover:s}))):r===re.V.STATUS?Q.a.createElement(ae.S,{status:v}):Q.a.createElement(de.S,{type:2,progress:g,status:v,editable:!1,showTooltip:i,onHover:s}))},he=r("dx_rjb4"),pe=r("dx_n3mc"),ve=r("dx_JM9i"),ge=r("dx_N25N"),be=r("dx_hoya");r("dx_jl82");function ye(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function me(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?ye(Object(r),!0).forEach((function(n){w()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ye(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function _e(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var ke="key-result-block",Oe=function(e){s()(r,e);var n=_e(r);function r(e){var o;return i()(this,r),(o=n.call(this,e)).state={score:0,progressRate:{start:0,target:100,current:0,percent:0,statusType:re.l.USE_WORST,progressStatus:re.G.UNSET,mode:re.W.SIMPLE},lastVisibleKRRecordId:""},o.handleClick=function(){$.S.isIOS&&Object(ee.P)()&&setTimeout((function(){var e,n;null===(e=document.activeElement)||void 0===e||null===(n=e.blur)||void 0===n||n.call(e)}),0)},o.hasProgressContent=function(){return Object(J.some)(Object(J.map)(o.model.children,(function(e){return o.blockManager.getBlockViewByBlockId(e.id).hasProgressContent()})),Boolean)},o.handleRecordChange=function(e){var n=e.recordOps,r=e.options;if(r.from!==K.H.local||r.isInUndoRedo)for(var i=0;i<n.length;i+=1){var c=n[i],a=c.record,l=a.id,s=a.snapshot;if(l===o.record.id)for(var u=0;u<c.ops.length;u+=1){var d=c.ops[u];d.p.includes("score")&&o.setState({score:Object(J.get)(s,"kr_info.score")}),d.p.includes("progress_rate")&&o.setState({progressRate:Object(q.camelize)(Object(J.get)(s,"kr_info.progress_rate"))})}}},o.handleFeatVisibleChange=function(){o.forceUpdate()},o.handleLastVisibleKRChange=function(e){o.setState({lastVisibleKRRecordId:e})},o._initState(),o}return a()(r,[{key:"editable",get:function(){return!1}}]),a()(r,[{key:"componentDidMount",value:function(){G()(h()(r.prototype),"componentDidMount",this).call(this),this.blockManager.recordManager.on(K.q.CHANGE,this.handleRecordChange),this.eventEmitter.on("".concat(ne.q,"__").concat(this.props.okrBlockId),this.handleFeatVisibleChange),this.eventEmitter.on("".concat(ne.J,"__").concat(this.props.okrBlockId),this.handleLastVisibleKRChange)}},{key:"componentWillUnmount",value:function(){G()(h()(r.prototype),"componentWillUnmount",this).call(this),this.blockManager.recordManager.off(K.q.CHANGE,this.handleRecordChange),this.eventEmitter.off("".concat(ne.q,"__").concat(this.props.okrBlockId),this.handleFeatVisibleChange),this.eventEmitter.off("".concat(ne.J,"__").concat(this.props.okrBlockId),this.handleLastVisibleKRChange)}},{key:"renderKeyResultBlockVersionBatch",value:function(){var e,n,o,i,c=this,a=this.props,l=a.okrBlockId,s=a.objectiveId,u=a.recursionProps,d=a.isLastO,f=this.props.record.snapshot,p=this.getOKRInfo(),v=f.children,g=f.kr_info,b=$.S.isMobile,y=!0,m=null===p||void 0===p||null===(e=p.settings)||void 0===e?void 0:e.enable_score,_=null===p||void 0===p||null===(n=p.settings)||void 0===n?void 0:n.weight_target,k=Object(J.isObject)(null===p||void 0===p?void 0:p.visible_settings),O=(null===p||void 0===p||null===(o=p.visible_settings)||void 0===o?void 0:o.progress_status_visible)&&!b,E=(null===p||void 0===p?void 0:p.visible_settings.score_visible)&&!b,S=null===p||void 0===p?void 0:p.visible_settings.fill_visible,C=null===p||void 0===p||null===(i=p.settings)||void 0===i?void 0:i.progress_rate_setting,I=!b&&u.editPermission&&Object(x.isOnline)()&&(!Object(be.r)()||u.editable),B=g.id,T=g.pos,w=g.confidential,R=g.deadline,M=g.visible,j=g.weight,D=this.state,A=D.score,P=D.progressRate,L=!b&&Object(J.isNumber)(R)&&R>0,N=this.state.lastVisibleKRRecordId===this.record.id,F={value1:"kr"},U={value1:"",value2:g.id,value3:Object(q.encryptTea)(null===p||void 0===p?void 0:p.user_id),value4:null===p||void 0===p?void 0:p.id};return Q.a.createElement("div",{contentEditable:!1,className:Y()(ke,{invisible:!M,hideProgressFill:!S,isLastVisibleKR:d&&N})},Q.a.createElement("div",{className:"".concat(ke,"__content ").concat(b?ge.X:"")},Q.a.createElement(ve.S,{size:"m",type:"KR",theme:"light",order:T,className:"".concat(ke,"__order"),locked:w,showConfidentialTip:y,isMobile:b}),Q.a.createElement("div",{className:"".concat(ke,"__rich-content"),onClick:this.handleClick},G()(h()(r.prototype),"render",this).call(this)),L&&Q.a.createElement(oe.S,{deadline:R,style:{marginLeft:8,marginTop:2}}),k&&O&&Q.a.createElement(pe.S,{style:{marginLeft:8}},Q.a.createElement(fe,{canEdit:I,weightType:_,progressRateSetting:C,progressRate:P,showTooltip:y,onProgressRateChange:function(e){return c.handleProgressRateChange(e)},onProgressRateSave:function(){c.handleProgressRateSave(),Object(te.M)(l,{actionType:"click_okr_edit_progress_rate",actionValue:F,objectBlockExtraValue:U},{blockManager:c.blockManager})},onProgressTagHover:function(){Object(te.M)(l,{actionType:"click_okr_hover_progress_status",actionValue:F,objectBlockExtraValue:U},{blockManager:c.blockManager})},onProgressPopoverShow:function(){Object(te.M)(l,{actionType:"click_okr_click_progress_status",actionValue:F,objectBlockExtraValue:U},{blockManager:c.blockManager})}})),k&&E&&Q.a.createElement(he.S,{canEdit:I,objectiveId:s,showScore:m,keyResultId:B,weightType:_,score:A,weight:j,showTooltip:y,saveScore:function(e){c.handleScoreSave(e),Object(te.M)(l,{actionType:"click_okr_edit_score",actionValue:F,objectBlockExtraValue:U},{blockManager:c.blockManager})},onScoreChange:function(e){return c.handleScoreChange(e)},onInputActive:function(){Object(te.M)(l,{actionType:"click_okr_click_score",actionValue:F,objectBlockExtraValue:U},{blockManager:c.blockManager})},onHoverScore:function(){Object(te.M)(l,{actionType:"click_okr_hover_score",actionValue:F,objectBlockExtraValue:U},{blockManager:c.blockManager})}})),Q.a.createElement("div",{className:"".concat(ke,"__progress")},Object(J.size)(v)>0&&Q.a.createElement(Q.a.Fragment,null,this.renderChildren({okrBlockId:l}))))}},{key:"renderUnsupport",value:function(){var e=this.props.okrBlockId,n=this.props.record.snapshot.children;return Object(J.size)(n)>0?Q.a.createElement(Q.a.Fragment,null,this.renderChildren({okrBlockId:e})):null}},{key:"renderBlock",value:function(){var e=this.props.okrBlockId;return this.blockManager.getBlockModelByBlockId(e).snapshot.okr_info.version===re.x.DOC_SDK_BATCH?this.renderKeyResultBlockVersionBatch():this.renderUnsupport()}},{key:"render",value:function(){return Q.a.createElement(Q.a.Fragment,null,this.renderBlock())}},{key:"_initState",value:function(){var e=this.snapshot.kr_info,n=e.score,r=e.progress_rate,o=this.blockManager.getBlockModelByBlockId(this.props.objectiveBlockId).children.reduceRight((function(e,n){var r;return!e&&(null===(r=n.snapshot.kr_info)||void 0===r?void 0:r.visible)?n.recordId:e}),"");this.state={score:n,progressRate:Object(q.camelize)(r),lastVisibleKRRecordId:o}}},{key:"handleScoreChange",value:function(e){var n=this.getOKRInfo();(null===n||void 0===n?void 0:n.settings.weight_target)===re.k.KR&&this.eventEmitter.emit("".concat(ne.H,"__").concat(this.parentId),{krBlockId:this.props.blockId,score:e})}},{key:"handleScoreSave",value:function(e){var n=this,r=this.getOKRInfo(),o=null===r||void 0===r?void 0:r.settings.weight_target;this.blockManager.applyTransaction("updateKRScore",(function(r){return r.replace(n.record.id,["kr_info","score"],e)})),this.setState({score:e}),o===re.k.KR&&this.eventEmitter.emit("".concat(ne.d,"__").concat(this.parentId),{krBlockId:this.id,score:e})}},{key:"handleProgressRateChange",value:function(e){var n=this.getOKRInfo(),r=null===n||void 0===n?void 0:n.settings.weight_target;this.setState((function(n){return{progressRate:me(me({},n.progressRate),e)}})),r===re.k.KR&&e&&this.eventEmitter.emit("".concat(ne.L,"__").concat(this.parentId),{krBlockId:this.id,progressRate:e})}},{key:"handleProgressRateSave",value:function(){var e=this,n=this.getOKRInfo(),r=null===n||void 0===n?void 0:n.settings.weight_target;this.blockManager.applyTransaction("updateKRProgressRate",(function(n){return n.replace(e.record.id,["kr_info","progress_rate"],Object(q.snakelize)(e.state.progressRate))})),r===re.k.KR&&this.eventEmitter.emit("".concat(ne.S,"__").concat(this.parentId))}},{key:"getOKRInfo",value:function(){var e=this.props.okrBlockId;return this.blockManager.getBlockModelByBlockId(e).snapshot.okr_info}}]),r}(R.N),xe=r("dx_yG8O"),Ee=r.n(xe),Se=r("dx_PJYZ"),Ce=r.n(Se),Ie=r("dx_Uyc2"),Be=r.n(Ie),Te=(r("dx_A1AB"),r("dx_xjz2"));var we,Re,Me,je=r("dx_J4zp"),De=r.n(je),Ae=r("dx_JI81"),Pe=function(e){var n=e.children,r=e.progress,o=e.progressStatus,i=e.statusType,c=e.onChange,a=e.onRealTimeChange,l=e.onPopoverVisibleChange,s=e.getPopupContainer,u=Object(Z.useState)(!1),d=De()(u,2),f=d[0],h=d[1],p=Object(Z.useState)({progressStatus:o,statusType:i}),v=De()(p,2),g=v[0],b=v[1];Object(Z.useEffect)((function(){b({progressStatus:o,statusType:i})}),[o,i]);var y=function(e){b(e),null===a||void 0===a||a(e)};return Q.a.createElement(ce.Popover,{content:Q.a.createElement(Ae.S,Object.assign({},g,{progress:r,onChange:y})),visible:f,trigger:"click",placement:"bottom",onVisibleChange:function(e){!1===e&&(null===c||void 0===c||c(g)),h(e),null===l||void 0===l||l(e)},getPopupContainer:s},n)},Le=function(e){var n=e.source,r=e.displayProgressStatus,o=e.progress,i=void 0===o?0:o,c=e.progressStatus,a=void 0===c?re.G.UNSET:c,l=e.statusType,s=void 0===l?re.l.CUSTOM:l,u=e.onChange,d=e.onConfirm,f=e.onPopoverVisibleChange,h=e.getPopupContainer,p=e.onProgressTagHover,v=void 0===p?J.noop:p;return Q.a.createElement("div",null,Q.a.createElement(Pe,{progress:i,progressStatus:a,statusType:s,onChange:d,onRealTimeChange:u,onPopoverVisibleChange:f,getPopupContainer:h},Q.a.createElement("div",null,Q.a.createElement(de.S,{type:1,source:n,progress:i,status:r,onHover:v}))))},Ne=r("dx_Llxv"),Fe=function(e){var n=e.canEdit,r=e.weightType,o=e.progressRateSetting,i=e.progressRate,c=e.showTooltip,a=e.hasKeyResults,l=e.keyResultStatusList,s=e.onProgressRateChange,u=e.onProgressRateSave,d=e.onProgressPopoverShow,f=e.onProgressTagHover,h=i.mode,p=i.percent,v=i.start,g=i.current,b=i.target,y=i.progressStatus,m=i.statusType,_=ie(i),k=function(e){var n;return(null===(n=e.closest(".okr-block"))||void 0===n?void 0:n.querySelector(".okr-block__popover-container"))||document.body},O=y;m===re.l.USE_WORST&&r===re.k.KR&&(O=Object(J.isUndefined)(Object(J.max)(l))?re.G.UNSET:Object(J.max)(l));var x=function(e){s({progressStatus:e})},E=function(e,n){e?u():s(n)},S=function(e){e&&d()};return Q.a.createElement(Q.a.Fragment,null,n?r===re.k.KR&&a?o===re.V.STATUS?Q.a.createElement(Ne.S,{displayProgressStatus:O,status:y,statusType:m,onChange:s,onConfirm:u,getPopupContainer:k,onProgressTagHover:f,onPopoverVisibleChange:S}):Q.a.createElement(Le,{progress:_,displayProgressStatus:O,progressStatus:y,statusType:m,onChange:s,onConfirm:u,getPopupContainer:k,onProgressTagHover:f,onPopoverVisibleChange:S}):o===re.V.STATUS?Q.a.createElement(se,{status:y,onStatusChange:x,onConfirm:function(){return E(!0)},getPopupContainer:k,onProgressTagHover:f,onPopoverVisibleChange:S}):Q.a.createElement(ue.S,{type:1,updateType:0,mode:h,start:v,percent:p,current:g,target:b,progressStatus:y,onStatusChange:x,onSave:E,getPopupContainer:k,onPopoverVisibleChange:S},Q.a.createElement("div",null,Q.a.createElement(de.S,{type:1,progress:_,status:O,editable:!0,onHover:f}))):o===re.V.STATUS?Q.a.createElement(ae.S,{status:O}):Q.a.createElement(de.S,{type:1,progress:_,status:O,editable:!1,showTooltip:c,onHover:f}))},Ue=r("dx_GtBV"),He=r("dx_Frpz");r("dx_h5SS");function Ve(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function We(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Ve(Object(r),!0).forEach((function(n){w()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ve(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ze(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var Ge,Ke,qe,Xe,Ye="objective-block",Je=(we=Object(Te.S)(),Re=function(e){s()(r,e);var n=ze(r);function r(e){var o;return i()(this,r),o=n.call(this,e),Ee()(o,"syncCursorSelectState",Me,Ce()(o)),o.state={score:0,progressRate:{start:0,target:100,current:0,percent:0,statusType:re.l.USE_WORST,progressStatus:re.G.UNSET,mode:re.W.SIMPLE},krStatusList:[],noKRVisible:!1},o.handleClick=function(){$.S.isIOS&&Object(ee.P)()&&setTimeout((function(){var e,n;null===(e=document.activeElement)||void 0===e||null===(n=e.blur)||void 0===n||n.call(e)}),0)},o.hasProgressContent=function(){return Object(J.some)(Object(J.map)(o.model.children,(function(e){var n;return null===(n=o.blockManager.getBlockViewByBlockIdNotCheck(e.id))||void 0===n?void 0:n.hasProgressContent()})),Boolean)},o.handleRecordChange=function(e){var n=e.recordOps,r=e.options;if(r.from!==K.H.local||r.isInUndoRedo)for(var i=0;i<n.length;i+=1){var c=n[i],a=c.record,l=a.id,s=a.snapshot;if(l===o.record.id)for(var u=0;u<c.ops.length;u+=1){var d=c.ops[u];d.p.includes("score")&&o.setState({score:Object(J.get)(s,"objective_info.score")}),d.p.includes("progress_rate")&&o.setState({progressRate:Object(q.camelize)(Object(J.get)(s,"objective_info.progress_rate"))})}}},o.remoteUpdateObjectiveScore=function(e){o.blockManager.applyTransaction("updateObjectiveScore",(function(n){return n.replace(o.record.id,["objective_info","score"],e)}))},o.localUpdateObjectiveScore=function(e){o.setState({score:e})},o.calcNewObjectiveScore=function(e){var n=e.krBlockId,r=e.score,i=o.snapshot.objective_info;return function(e,n){var r=e.reduce((function(e,n){return{total:e.total+n.weight,score:e.score+n.weight*n.score}}),{total:0,score:0}),o=r.total,i=r.score;return o?10*Math.floor((Math.floor(i)/o+1)/10):10*Math.floor((n+1)/10)}(Object(J.map)(o.model.children,(function(e){var o=e.snapshot.kr_info;return{weight:o.weight,score:e.id===n?r:o.score}})),i.score)},o.handleKRScoreChange=function(e){var n=e.krBlockId,r=e.score,i=o.calcNewObjectiveScore({krBlockId:n,score:r});o.localUpdateObjectiveScore(i)},o.handleKRScoreTransaction=function(e){var n=e.krBlockId,r=e.score,i=o.calcNewObjectiveScore({krBlockId:n,score:r});o.remoteUpdateObjectiveScore(i),o.localUpdateObjectiveScore(i)},o.calcNewProgressPercent=function(e){var n=e.krBlockId,r=e.progressRate,i=o.snapshot.objective_info;return function(e,n){if(Object(J.isEmpty)(e))return n;var r=Object(J.map)(e,(function(e){return{weights:e.weight,progress:ie(e.progressRate)}})),o=1===Object(J.size)(Object(J.uniqWith)(r,J.isEqual)),i=Object(J.map)(r,(function(e){return e.weights})),c=1===Object(J.size)(Object(J.uniq)(i))&&Math.abs(100-i.reduce((function(e,n){return e+n}),0))<.5;return o&&c?r[0].progress:Object(J.round)(Object(J.reduce)(r,(function(e,n){var o=0;return o=c?100/r.length:n.weights,e+n.progress*o/Math.pow(10,2)}),0))}(Object(J.map)(o.model.children,(function(e){var o=e.snapshot.kr_info;return{weight:o.weight,progressRate:Object(q.camelize)(e.id===n?We(We({},o.progress_rate),r):o.progress_rate)}})),i.progress_rate.percent)},o.handleKRProgressRateChange=function(e){var n=e.krBlockId,r=e.progressRate,i=o.calcNewProgressPercent({krBlockId:n,progressRate:r});if(o.setState((function(e){return{progressRate:We(We({},e.progressRate),{},{percent:i})}})),!Object(J.isUndefined)(r.progressStatus)){var c=Object(J.map)(o.model.children,(function(e){var o=e.snapshot.kr_info;return e.id===n?r.progressStatus:o.progress_rate.progress_status}));o.setState({krStatusList:c})}},o.handleKRProgressRateTransaction=function(){o.blockManager.applyTransaction("updateObjectiveProgressRate",(function(e){return e.replace(o.record.id,["objective_info","progress_rate"],Object(q.snakelize)(o.state.progressRate))}))},o.handleFeatVisibleChange=function(){o.forceUpdate()},o.handleLastVisibleKRChange=function(e){e||o.setState({noKRVisible:!0})},o._initState(),o}return a()(r,[{key:"editable",get:function(){return!1}}]),a()(r,[{key:"_initState",value:function(){var e=this.props.record.snapshot.objective_info,n=e.score,r=e.progress_rate,o=Object(J.map)(this.model.children,(function(e){var n=e.snapshot.kr_info,r=null===n||void 0===n?void 0:n.progress_rate.progress_status;return Object(J.isUndefined)(r)?re.G.UNSET:r})),i=Object(J.every)(this.model.children,(function(e){var n=e.snapshot.kr_info;return!(null===n||void 0===n?void 0:n.visible)}));this.state={score:n,progressRate:Object(q.camelize)(r),krStatusList:o,noKRVisible:i}}},{key:"componentDidMount",value:function(){G()(h()(r.prototype),"componentDidMount",this).call(this),this.blockManager.recordManager.on(K.q.CHANGE,this.handleRecordChange),this.eventEmitter.on("".concat(ne.H,"__").concat(this.id),this.handleKRScoreChange),this.eventEmitter.on("".concat(ne.d,"__").concat(this.id),this.handleKRScoreTransaction),this.eventEmitter.on("".concat(ne.L,"__").concat(this.id),this.handleKRProgressRateChange),this.eventEmitter.on("".concat(ne.S,"__").concat(this.id),this.handleKRProgressRateTransaction),this.eventEmitter.on("".concat(ne.q,"__").concat(this.props.okrBlockId),this.handleFeatVisibleChange),this.eventEmitter.on("".concat(ne.J,"__").concat(this.props.okrBlockId),this.handleLastVisibleKRChange)}},{key:"componentWillUnmount",value:function(){G()(h()(r.prototype),"componentWillUnmount",this).call(this),this.blockManager.recordManager.off(K.q.CHANGE,this.handleRecordChange),this.eventEmitter.off("".concat(ne.H,"__").concat(this.id),this.handleKRScoreChange),this.eventEmitter.off("".concat(ne.d,"__").concat(this.id),this.handleKRScoreTransaction),this.eventEmitter.off("".concat(ne.L,"__").concat(this.id),this.handleKRProgressRateChange),this.eventEmitter.off("".concat(ne.S,"__").concat(this.id),this.handleKRProgressRateTransaction),this.eventEmitter.off("".concat(ne.q,"__").concat(this.props.okrBlockId),this.handleFeatVisibleChange),this.eventEmitter.off("".concat(ne.J,"__").concat(this.props.okrBlockId),this.handleLastVisibleKRChange)}},{key:"renderObjectiveBlockVersionBatch",value:function(){var e,n,o,i,c,a,l,s,u=this,d=this.props,f=d.okrBlockId,p=d.recursionProps,v=this.props.record.snapshot,g=this.blockManager.getBlockModelByBlockId(f),b=g.snapshot.okr_info,y=g.children,m=v.objective_info,_=$.S.isMobile,k=!0,O=null===b||void 0===b||null===(e=b.settings)||void 0===e?void 0:e.enable_score_o_without_kr,E=null===b||void 0===b||null===(n=b.settings)||void 0===n?void 0:n.enable_score,S=null===b||void 0===b||null===(o=b.settings)||void 0===o?void 0:o.weight_target,C=null===b||void 0===b||null===(i=b.settings)||void 0===i?void 0:i.progress_rate_setting,I=Object(J.isObject)(b.visible_settings),B=(null===b||void 0===b||null===(c=b.visible_settings)||void 0===c?void 0:c.progress_status_visible)&&!_,T=(null===b||void 0===b?void 0:b.visible_settings.score_visible)&&!_,w=!_&&p.editPermission&&Object(x.isOnline)()&&(!Object(be.r)()||p.editable),R=m.id,M=m.pos,j=m.confidential,D=m.deadline,A=m.weight,P=this.state,L=P.score,N=P.progressRate,F=P.krStatusList,U=!_&&Object(J.isNumber)(D)&&D>0,H=Object(J.size)(y)>0,V=(null===(a=Object(J.last)(y))||void 0===a?void 0:a.id)===this.id,W=null===(l=this.syncCursorSelectState)||void 0===l||null===(s=l.get(f))||void 0===s?void 0:s.borderColor,z={value1:"o"},K={value1:R,value2:"",value3:Object(q.encryptTea)(b.user_id),value4:b.id};return Q.a.createElement("div",{className:Y()("".concat(Ye),{isSingleO:1===y.length&&!H,isLastO:V,noKRVisible:this.state.noKRVisible}),style:{borderColor:W}},Q.a.createElement("div",{className:"".concat(Ye,"__content  ").concat(_?ge.X:""),contentEditable:!1},Q.a.createElement(ve.S,{size:"m",order:M,theme:"primary",type:"O",className:"".concat(Ye,"__order"),locked:j,showConfidentialTip:k,isMobile:_}),Q.a.createElement("div",{className:"".concat(Ye,"__rich-content"),onClick:this.handleClick},G()(h()(r.prototype),"render",this).call(this)),U&&Q.a.createElement(oe.S,{deadline:D,style:{marginLeft:8,marginTop:8}}),I&&B&&Q.a.createElement(pe.S,{style:{marginTop:6,marginLeft:8,textAlign:"initial"}},Q.a.createElement(Fe,{canEdit:w,weightType:S,progressRateSetting:C,progressRate:N,showTooltip:k,hasKeyResults:H,keyResultStatusList:F,onProgressRateChange:function(e){return u.handleProgressRateChange(e)},onProgressRateSave:function(){u.handleProgressRateSave(),Object(te.M)(f,{actionType:"click_okr_edit_progress_rate",actionValue:z,objectBlockExtraValue:K},{blockManager:u.blockManager})},onProgressTagHover:function(){Object(te.M)(f,{actionType:"click_okr_hover_progress_status",actionValue:z,objectBlockExtraValue:K},{blockManager:u.blockManager})},onProgressPopoverShow:function(){Object(te.M)(f,{actionType:"click_okr_click_progress_status",actionValue:z,objectBlockExtraValue:K},{blockManager:u.blockManager})}})),I&&T&&Q.a.createElement(Ue.S,{canEdit:w,canScore:O,showScore:E,weightType:S,score:L,weight:A,showTooltip:k,hasKeyResults:H,objectiveId:R,saveScore:function(e){u.saveScore(e),Object(te.M)(f,{actionType:"click_okr_edit_score",actionValue:z,objectBlockExtraValue:K},{blockManager:u.blockManager})},onInputActive:function(){Object(te.M)(f,{actionType:"click_okr_click_score",actionValue:z,objectBlockExtraValue:K},{blockManager:u.blockManager})},onHoverScore:function(){Object(te.M)(f,{actionType:"click_okr_hover_score",actionValue:z,objectBlockExtraValue:K},{blockManager:u.blockManager})}})),Q.a.createElement("div",{className:Y()("".concat(Ye,"__key-result"))},H&&Q.a.createElement(Q.a.Fragment,null,this.renderChildren({okrBlockId:f,objectiveBlockId:this.id,objectiveId:R,isLastO:V}))))}},{key:"renderUnsupport",value:function(){var e,n=this.props.record.snapshot,r=n.children,o=this.props.okrBlockId,i=this.blockManager.getBlockModelByBlockId(o).children,c=n.objective_info,a=(null===(e=Object(J.last)(i))||void 0===e?void 0:e.id)===this.id;return Object(J.size)(r)>0?Q.a.createElement(Q.a.Fragment,null,this.renderChildren({okrBlockId:o,objectiveBlockId:this.id,objectiveId:c.id,isLastO:a})):null}},{key:"render",value:function(){var e=this.props.okrBlockId;return this.blockManager.getBlockModelByBlockId(e).snapshot.okr_info.version===re.x.DOC_SDK_BATCH?this.renderObjectiveBlockVersionBatch():this.renderUnsupport()}},{key:"handleProgressRateChange",value:function(e){this.setState((function(n){return{progressRate:We(We({},n.progressRate),e)}}))}},{key:"handleProgressRateSave",value:function(){var e=this;this.blockManager.applyTransaction("updateObjectiveProgressRate",(function(n){return n.replace(e.record.id,["objective_info","progress_rate"],Object(q.snakelize)(e.state.progressRate))}))}},{key:"saveScore",value:function(e){this.remoteUpdateObjectiveScore(e),this.localUpdateObjectiveScore(e)}}]),r}(R.N),Me=Be()(Re.prototype,"syncCursorSelectState",[we,He.W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Re),Ze=r("dx_o0o1"),Qe=r.n(Ze),$e=r("dx_yXPU"),et=r.n($e),tt=r("dx_C7C6"),nt=r("dx_xlCA"),rt=r("dx_MGoZ"),ot=r("dx_D4hX"),it=r("dx_z6zX"),ct=r("dx_M4Mk"),at=r("dx_qx8A"),lt=r.n(at);r("dx_Q8xN");function st(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function ut(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?st(Object(r),!0).forEach((function(n){w()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):st(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function dt(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return ft(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ft(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function ft(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function ht(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var pt="okr-block",vt={fill_visible:"progress_text",progress_status_visible:"progress_status",score_visible:"score"},gt=(Ge=Object(Te.S)(),Xe=function(e){s()(r,e);var n=ht(r);function r(e){var o;if(i()(this,r),o=n.call(this,e),Ee()(o,"syncCursorSelectState",qe,Ce()(o)),o.state={isHovered:!1,isSelected:!1,isSyncing:!1,visibilitySetting:[],dataReady:!1},o.notPromptedKey=void 0,o.handleKeydown=function(e){if("Backspace"===e.code){var n=Ce()(o),r=n.selectionAPI,i=n.blockManager,c=r.getSelection().reduce((function(e,n){var r=n.id,o=i.getBlockModelByBlockId(r);return o?[].concat(v()(e),[o.type]):e}),[]);(Object(J.includes)(c,_.B.KEY_RESULT)||Object(J.includes)(c,_.B.OBJECTIVE))&&e.stopPropagation()}},o.handleSyncCursorStateChange=function(){Object(J.map)(o.record.snapshot.children,(function(e){o.blockManager.getBlockViewsByRecordId(e)[0].model.forceUpdate()}))},o.hasProgressContent=function(){return Object(J.some)(Object(J.map)(o.props.record.snapshot.children,(function(e){return o.blockManager.getBlockViewsByRecordId(e)[0].hasProgressContent()})),Boolean)},o.handleSyncEntranceClick=function(){Object(te.M)(o.id,{actionType:"click_okr_progress_sync_button",actionValue:{value1:!o.getNoPromptedState(),value2:!1,value3:""},objectBlockExtraValue:{value1:"",value2:"",value3:Object(x.encryptTea)(o.props.record.snapshot.okr_info.user_id),value4:o.props.record.snapshot.okr_info.id}},{blockManager:o.blockManager})},o.handleSettingEntranceClick=function(){Object(te.M)(o.id,{actionType:"click_okr_show_setting_entrance",objectBlockExtraValue:{value1:"",value2:"",value3:Object(x.encryptTea)(o.props.record.snapshot.okr_info.user_id),value4:o.props.record.snapshot.okr_info.id}},{blockManager:o.blockManager})},o.handleSyncProgressCanceled=function(){Object(te.M)(o.id,{actionType:"click_okr_cancel_progress_sync",objectBlockExtraValue:{value1:"",value2:"",value3:Object(x.encryptTea)(o.snapshot.okr_info.user_id),value4:o.snapshot.okr_info.id}},{blockManager:o.blockManager})},o.handleSyncProgress=function(){var e=et()(Qe.a.mark((function e(n){var r,i,c,a,l;return Qe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!o.state.isSyncing){e.next=2;break}return e.abrupt("return");case 2:return o.setState({isSyncing:!0}),r=o.blockManager.rootRecordId,e.next=6,Object(ot.h)({version:1,block_id:o.record.id,doc_token:r,doc_host:window.location.origin},o.getOKRSequenceNumberMap(),(function(){Object(te.M)(o.id,{actionType:"click_okr_view_success_progress_sync",objectBlockExtraValue:{value1:"",value2:"",value3:Object(x.encryptTea)(o.snapshot.okr_info.user_id),value4:o.snapshot.okr_info.id}},{blockManager:o.blockManager})}));case 6:i=e.sent,c=i.text,a=i.toastType,l=i.syncTime,x.Toast.show({key:"okr-sync-progress",type:a,content:c}),o.setState({isSyncing:!1}),l&&o.blockManager.applyTransaction("updateSyncTime",(function(e){return e.replace(o.record.id,["okr_info","sync_time"],l)})),n&&localStorage.setItem(o.notPromptedKey,"true"),Object(te.M)(o.id,{actionType:"click_okr_confirm_progress_sync",actionValue:{value1:n,value2:!1,value3:""},objectBlockExtraValue:{value1:"",value2:"",value3:Object(x.encryptTea)(o.snapshot.okr_info.user_id),value4:o.snapshot.okr_info.id}},{blockManager:o.blockManager});case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),o.getNoPromptedState=function(){return!!localStorage.getItem(o.notPromptedKey)},o.checkDataReady=function(){return o.model.children.reduce((function(e,n){return e&&n.type===_.B.OBJECTIVE&&n.children.reduce((function(e,n){return e&&n.type===_.B.KEY_RESULT}),!0)}),!0)},o.initOnDataReady=function(){o.setState({visibilitySetting:o.getOKRVisibilitySetting()})},o.handleRecordChange=function(e){!o.state.dataReady&&o.checkDataReady()&&(o.setState({dataReady:!0}),o.initOnDataReady()),e.recordOps.forEach((function(n){var r=n.record.snapshot.type;if(e.options.from===K.H.remote&&n.record.id===o.record.id&&function(){var e,r=new Set,i=dt(n.ops);try{for(i.s();!(e=i.n()).done;){var c=e.value,a=c.p.indexOf("visible_settings");if(a>=0){if(a+1===c.p.length){Object.keys(o.snapshot.okr_info.visible_settings).forEach((function(e){r.add(e)}));break}var l=c.p[a+1];r.add(l)}}}catch(f){i.e(f)}finally{i.f()}var s,u=dt(r);try{for(u.s();!(s=u.n()).done;){var d=s.value;o.handleFeatVisibleChange({path:d,visible:o.snapshot.okr_info.visible_settings[d]})}}catch(f){u.e(f)}finally{u.f()}}(),r===_.B.KEY_RESULT){var i=n.record,c=i.id,a=i.snapshot.kr_info.visible;o.blockManager.getBlockModelsByRecordId(c).find((function(e){var n,r;return(null===(n=e.parent)||void 0===n||null===(r=n.parent)||void 0===r?void 0:r.id)===o.id}))&&o.setState((function(e){var n=Object(J.map)(e.visibilitySetting,(function(e){return e.targetId===c?ut(ut({},e),{},{visible:a}):e})),r=Object(J.find)(v()(n).reverse(),(function(e){return"KR"===e.type&&e.visible}));return o.eventEmitter.emit("".concat(ne.J,"__").concat(o.id),(null===r||void 0===r?void 0:r.targetId)||""),ut(ut({},e),{},{visibilitySetting:n})}))}}))},o.checkDataReady()){o.state.dataReady=!0;var c=o.getOKRVisibilitySetting();o.state.visibilitySetting=c;var a=Object(J.find)(v()(c).reverse(),(function(e){return"KR"===e.type&&e.visible}));o.eventEmitter.emit("".concat(ne.J,"__").concat(o.id),(null===a||void 0===a?void 0:a.targetId)||"")}var l=o.props.record.snapshot.okr_info.user_id,s=nt.n.getCache(l);return s?o.state.okrOwnerInfo={id:l,cn_name:s.name,en_name:s.en_name||s.name,avatar_url:s.avatar_url}:o.fetchOKROwnerInfo(o.props.record.snapshot.okr_info.user_id),o.notPromptedKey="".concat(ne.B,"-").concat(o.props.record.snapshot.okr_info.user_id),o}return a()(r,[{key:"getSelectionLocator",value:function(){return this.hostElement}},{key:"setSelected",value:function(e){this.setState({isSelected:e})}},{key:"setHovered",value:function(e){this.setState({isHovered:e})}},{key:"componentDidMount",value:function(){var e;G()(h()(r.prototype),"componentDidMount",this).call(this),this.blockManager.recordManager.on(K.q.CHANGE,this.handleRecordChange),document.addEventListener("keydown",this.handleKeydown,!0),null===(e=this.syncCursorSelectState)||void 0===e||e.onStateChange(this.id,this.handleSyncCursorStateChange)}},{key:"componentWillUnmount",value:function(){var e;G()(h()(r.prototype),"componentWillUnmount",this).call(this),this.blockManager.recordManager.off(K.q.CHANGE,this.handleRecordChange),document.removeEventListener("keydown",this.handleKeydown,!0),null===(e=this.syncCursorSelectState)||void 0===e||e.offStateChange(this.id,this.handleSyncCursorStateChange)}},{key:"renderUnsupport",value:function(){var e=this.props,n=e.record,r=e.blockId,o=n.snapshot.children;return Q.a.createElement("div",null,Q.a.createElement(ct.S,null),Object(J.size)(o)>0&&Q.a.createElement("div",{style:{display:"none"}},this.renderChildren({okrBlockId:r,childrenBlockIds:o})))}},{key:"renderOKRBlockVersionBatch",value:function(){var e,n,r,o,i,c,a=this,l=this.state,s=l.visibilitySetting,u=l.isSyncing,d=this.props,f=d.record,h=d.blockId,p=f.snapshot,v=p.children,g=p.okr_info,b=g.user_id,y=g.period_name_zh,m=g.period_name_en,_=g.period_display_status,k=g.sync_time,O=g.settings.enable_score,E=g.visible_settings,S=E.fill_visible,C=E.score_visible,I=E.progress_status_visible,B="zh"===x.i18nHelper.getLanguage(),T=lt.a.getState().appState.currentUser.get("id")===b,R=null===(e=this.syncCursorSelectState)||void 0===e||null===(n=e.get(h))||void 0===n?void 0:n.borderColor;return Q.a.createElement("div",{tabIndex:$.S.isIPadSafariBrowser?-1:void 0,className:Y()(pt,(r={},w()(r,"".concat(pt,"--is-hovered"),this.state.isHovered),w()(r,"".concat(pt,"--is-selected"),this.state.isSelected),r)),contentEditable:!1},Q.a.createElement(it.S,{okrOwnerId:b,isOKROwner:T,editable:this.blockManager.editable,userName:B?(null===(o=this.state.okrOwnerInfo)||void 0===o?void 0:o.cn_name)||"":(null===(i=this.state.okrOwnerInfo)||void 0===i?void 0:i.en_name)||"",userAvatar:(null===(c=this.state.okrOwnerInfo)||void 0===c?void 0:c.avatar_url)||"",periodName:B?y:m,periodDisplayStatus:_,isMobile:$.S.isMobile,isSyncing:u,syncTime:k,enableScore:O,progressRateVisible:I,scoreVisible:C,progressVisible:S,okrVisibilitySetting:s,onSyncEntranceClick:this.handleSyncEntranceClick,onSettingEntranceClick:this.handleSettingEntranceClick,onProgressRateVisibleChange:function(e){return a.handleFeatVisibleChange({path:"progress_status_visible",visible:e})},onScoreVisibleChange:function(e){return a.handleFeatVisibleChange({path:"score_visible",visible:e})},onProgressVisibleChange:function(e){return a.handleFeatVisibleChange({path:"fill_visible",visible:e})},onKRVisibleChange:this.handleKRVisbleChange.bind(this),getNoPromptedState:this.getNoPromptedState,getHasProgressState:this.hasProgressContent,onSyncProgressCanceled:this.handleSyncProgressCanceled,onSyncProgress:this.handleSyncProgress}),Object(J.size)(v)>0&&Q.a.createElement("div",{className:"".concat(pt,"__objective-wrapper"),style:{borderColor:R}},this.renderChildren({okrBlockId:h,childrenBlockIds:v})),Q.a.createElement("div",{className:"".concat(pt,"__popover-container"),contentEditable:!1}))}},{key:"renderBlock",value:function(){return this.props.record.snapshot.okr_info.version===re.x.DOC_SDK_BATCH?this.renderOKRBlockVersionBatch():this.renderUnsupport()}},{key:"render",value:function(){return Q.a.createElement(Q.a.Fragment,null,this.renderBlock())}},{key:"handleFeatVisibleChange",value:function(e){var n=this;this.blockManager.applyTransaction("toggleFeatVisible",(function(r){return r.replace(n.record.id,["okr_info","visible_settings",e.path],e.visible)})),this.eventEmitter.emit("".concat(ne.q,"__").concat(this.id)),Object(te.M)(this.id,{actionType:"click_okr_show_setting",actionValue:{value1:vt[e.path],value2:e.visible},objectBlockExtraValue:{value1:"",value2:"",value3:Object(x.encryptTea)(this.snapshot.okr_info.user_id),value4:this.snapshot.okr_info.id}},{blockManager:this.blockManager})}},{key:"handleKRVisbleChange",value:function(e){this.blockManager.applyTransaction("toggleKRVisible",(function(n){return n.replace(e.targetId,["kr_info","visible"],e.visible)})),Object(te.M)(this.id,{actionType:"click_okr_show_setting",actionValue:{value1:"kr",value2:e.visible},objectBlockExtraValue:{value1:e.objectiveId,value2:e.targetId,value3:Object(x.encryptTea)(this.snapshot.okr_info.user_id),value4:this.snapshot.okr_info.id}},{blockManager:this.blockManager})}},{key:"getOKRSequenceNumberMap",value:function(){var e={};return Object(J.forEach)(this.model.children,(function(n){var r=n.snapshot.objective_info,o=r.id,i=r.pos;e[o]="O".concat(i+1),Object(J.forEach)(n.children,(function(n){var r=n.snapshot.kr_info,o=r.id,c=r.pos;e[o]="O".concat(i+1," KR").concat((c||0)+1)}))})),e}},{key:"getOKRVisibilitySetting",value:function(){var e=[];try{Object(J.forEach)(this.model.children,(function(n){if(n.type===_.B.OBJECTIVE){var r=n.snapshot,o=r.objective_info.pos,i=r.text;e.push({type:"O",objectiveId:n.recordId,targetId:n.recordId,canSetVisible:!1,visible:!0,text:i,pos:o}),n.children.forEach((function(r){if(r.type===_.B.KEY_RESULT){var o=r.snapshot,i=o.kr_info,c=i.pos,a=i.visible,l=o.text;e.push({type:"KR",canSetVisible:!1,objectiveId:n.recordId,targetId:r.recordId,text:l,pos:c,visible:a})}}))}}))}catch(n){console.error(n)}return e}},{key:"fetchOKROwnerInfo",value:function(){var e=et()(Qe.a.mark((function e(n){var r,o;return Qe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(tt.t)([n]);case 2:r=e.sent,o=r[n],this.setState({okrOwnerInfo:{id:n,cn_name:o.cn_name,en_name:o.en_name,avatar_url:o.avatar_url}});case 5:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),r}(rt.l),Ke=Xe,qe=Be()(Ke.prototype,"syncCursorSelectState",[Ge,He.W],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ke),bt=r("dx_MoY1"),yt=r("dx_NsKf"),mt=r("dx_ZG9w");function _t(e,n,r){return kt.apply(this,arguments)}function kt(){return(kt=et()(Qe.a.mark((function e(n,r,o){var i,c,a,l;return Qe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.getBlockModelByBlockId(n),c=r.applyTransaction("insertOKRProgressTextChildren",(function(e){Object(bt.l)(e,i.recordId,0,[Object(yt.u)()])})),a=r.getBlockModelByBlockId(i.children[0].id),!o){e.next=8;break}return e.next=6,c;case 6:l=r.getBlockViewByBlockIdNotCheck(a.id),Object(mt.U)(l)&&l.model.setSelection({start:0,len:0});case 8:return e.abrupt("return",a.id);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}r("dx_aNmi");function Ot(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var xt,Et="progress-block",St=function(e){s()(r,e);var n=Ot(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).sub=void 0,e.focusElementRef=Object(Z.createRef)(),e.hasProgressContent=function(){return Object(J.some)(e.model.children,(function(e){return!(e.isTextBlock&&e.isEmpty)}))},e.handleTransaction=function(){var n=et()(Qe.a.mark((function n(r){return Qe.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!r.options.isInPaste&&r.options.from===K.H.local){n.next=2;break}return n.abrupt("return");case 2:e.record.snapshot.children.length||Object(bt.l)(r.op,e.model.recordId,0,[Object(yt.u)()]);case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.handleClick=function(){!e.record.snapshot.children.length&&e.editable&&_t(e.id,e.blockManager,!0)},e}return a()(r,[{key:"componentDidMount",value:function(){G()(h()(r.prototype),"componentDidMount",this).call(this),this.sub=this.editorAPI.modelService.interceptChange$.subscribe(this.handleTransaction)}},{key:"componentWillUnmount",value:function(){var e;null===(e=this.sub)||void 0===e||e.unsubscribe(),G()(h()(r.prototype),"componentWillUnmount",this).call(this)}},{key:"renderProgressBlockVersionBatch",value:function(){var e=this.props.record.snapshot.children;return Q.a.createElement("div",{className:"".concat(Et,"-wrapper"),onClick:this.handleClick},Q.a.createElement("div",null,Object(J.size)(e)>0?this.renderChildren():Q.a.createElement("div",{className:"empty-line-placeholder"})))}},{key:"renderUnsupport",value:function(){var e=this.props.record.snapshot.children;return Q.a.createElement(Q.a.Fragment,null,Object(J.size)(e)>0?this.renderChildren():null)}},{key:"renderBlock",value:function(){var e=this.props.okrBlockId;return this.blockManager.getBlockModelByBlockId(e).snapshot.okr_info.version===re.x.DOC_SDK_BATCH?this.renderProgressBlockVersionBatch():this.renderUnsupport()}},{key:"render",value:function(){return Q.a.createElement("div",{className:Et,contentEditable:Object(ee.P)()&&this.editable,ref:this.focusElementRef},this.renderBlock())}},{key:"focusElement",get:function(){var e;return null===(e=this.focusElementRef)||void 0===e?void 0:e.current}}]),r}(rt.l);function Ct(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=h()(e);if(n){var i=h()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return d()(this,r)}}var It=Object(g.H)({providers:[].concat(v()([_.B.OKR,_.B.OBJECTIVE,_.B.KEY_RESULT,_.B.PROGRESS].map((function(e){return{provide:b.RecordSnapshotCreator,useValue:{type:e,create:O.h}}}))),[{provide:m.I,useClass:y.V,args:[_.B.OKR,{shouldRenderAll:!0}]}])})(xt=function(e){s()(r,e);var n=Ct(r);function r(){return i()(this,r),n.apply(this,arguments)}return a()(r,[{key:"blocks",get:function(){return[[B,{viewCreator:gt,options:this.options.getTextEditorOptions()}],[L,{viewCreator:Je,options:this.options.getTextEditorOptions()}],[H,{viewCreator:Oe,options:this.options.getTextEditorOptions()}],[W,{viewCreator:St}]]}}]),r}(k.h))||xt;n.S=It},dx_yuKo:function(e,n){},dx_yvc8:function(e,n,r){"use strict";var o=r("dx_cDcd"),i=r.n(o);function c(){return c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},c.apply(this,arguments)}var a=i.a.createElement("path",{d:"M3.045 4.61l2.65 3.277a.375.375 0 00.583 0L8.917 4.61A.375.375 0 008.625 4H3.337a.375.375 0 00-.292.61z",fill:"#646A73",fillRule:"evenodd"});n.S=function(e){return i.a.createElement("svg",c({width:12,height:12,viewBox:"0 0 12 12"},e),a)}},dx_yyXO:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return C}));var e=r("dx_RIqP"),o=r.n(e),i=r("dx_lwsE"),c=r.n(i),a=r("dx_W8MJ"),l=r.n(a),s=r("dx_iWIM"),u=r.n(s),d=r("dx_W7W2"),f=r.n(d),h=r("dx_a1gu"),p=r.n(h),v=r("dx_Nsbk"),g=r.n(v),b=r("dx_QxNg"),y=r("dx_UtDZ"),m=r("dx_B28d"),_=r("dx_NMQJ"),k=r("dx_x1WV"),O=r("dx_xlMp"),x=r("dx_lROi"),E=r("dx_JnYQ");function S(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=g()(e);if(n){var i=g()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return p()(this,r)}}var C=function(e){f()(r,e);var n=S(r);function r(){var e;c()(this,r);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(e=n.call.apply(n,[this].concat(i))).isFromLocal=!1,e.matches=[],e.prevKeyword=void 0,e.prevDataUuid=void 0,e}return l()(r,[{key:"find",value:function(e){var n=this,r=this.blockManager.getBlockViewByBlockId(this.id);if(!r)return[];var i=r.catalogListDataUuid;if(!i||!r.catalogListData)return[];if(!this.matches||this.prevKeyword!==e||this.prevDataUuid!==i){var c=[];r.catalogListData.slice(0,E.y).forEach((function(r,o){return Object(x.A)(r.title.length?r.title:Object(y.getWikiCatalogFunctions)().suiteType2UnnamedTitle[r.objType],e).forEach((function(r){var i=r.start,a=r.end;return c.push(new O.f({index:o,blockManager:n.blockManager,blockId:n.id,key:e,range:[i,a]}))}))})),this.matches=c,this.prevKeyword=e,this.prevDataUuid=i}return o()(this.matches)}},{key:"getText",value:function(){return"[".concat(t("CreationDoc_Wiki_SubpageTOC_BlockTitle"),"]")}},{key:"onInit",value:function(e){this.isFromLocal=e.options.from===b.H.local,u()(g()(r.prototype),"onInit",this).call(this,e)}},{key:"blockManager",get:function(){return this.editorAPI.getService(k.a)}}]),r}(_.D);C.type=m.B.WIKI_CATALOG}).call(this,r("dx_E9Eu"))},dx_yz7B:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return k}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_TXb2"),l=r("dx_YOcb"),s=r("dx_ABAR"),u=r("dx_PcQO"),d=r("dx_TSYQ"),f=r.n(d),h=r("dx_cDcd"),p=r.n(h),v=r("dx_zEdG"),g=r("dx_CwnG"),b=r("dx_Pa9M"),y=r("dx_C4C6"),m="heading-modify-menu",_="HEADING-MODIFY-MENU";function k(e){var n=e.blockManager,r=e.headingModule,i=e.blockId,d=e.recordId,k=e.order,O=e.updateCanShowInput,x=e.updateVisible,E=Object(h.useMemo)((function(){return n.getBlockModelByBlockId(i)}),[n,i]),S=Object(h.useMemo)((function(){return E.record.snapshot}),[E]),C=S.seq,I=S.seq_level,B=Object(y.y)(k),T=B.seqNumber,w=B.seqPrefix,R="1."===k||"1"===T&&""===w,M="1"===T,j=Object(h.useMemo)((function(){var e=null===r||void 0===r?void 0:r.hasSameHeading(i,b.R.UP),n=e&&Object(y.W)(r,e,k);return!e||n||(void 0===I||"auto"===I)&&"auto"===C}),[i]),D=[{key:"continue",disabled:j,Icon:a.S,text:t("CreationDoc_Docs_AutoNumberHeadings_Continue")},{key:w?"create":"createOne",disabled:R,Icon:l.S,text:t("CreationDoc_Docs_AutoNumberHeadings_Restart"),subMenu:w?[{key:"createOne",disabled:R,text:t("CreationDoc_Docs_AutoNumberHeadings_StartFrom",{},"","1.")},{key:"createOneChild",disabled:M,text:t("CreationDoc_Docs_AutoNumberHeadings_StartFrom",{},"","".concat(w,"1"))}]:[]},{key:"renumber",disabled:!1,Icon:s.S,text:t("CreationDoc_Docs_AutoNumberHeadings_CustomValue")}],A=Object(h.useCallback)(c()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.applyTransaction("heading:modify:continue",(function(e){e.replace(d,["seq"],"auto"),e.replace(d,["seq_level"],"auto"),null===r||void 0===r||r.renumber(E,!0)}));case 2:x(!1);case 3:case"end":return e.stop()}}),e)}))),[n,i]),P=Object(h.useCallback)(c()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.applyTransaction("heading:modify:createOne",(function(e){e.replace(d,["seq_level"],"1"),e.replace(d,["seq"],"1"),null===r||void 0===r||r.renumber(E,!0)}));case 2:x(!1);case 3:case"end":return e.stop()}}),e)}))),[n,i]),L=Object(h.useCallback)(c()(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.applyTransaction("heading:modify:createOneChild",(function(e){e.replace(d,["seq"],"1"),null===r||void 0===r||r.renumber(E,!1)}));case 2:x(!1);case 3:case"end":return e.stop()}}),e)}))),[n]),N=Object(h.useCallback)((function(){O(!0)}),[]),F=Object(h.useCallback)((function(e){var r={createOne:"current_queue",createOneChild:"parent_queue"},o={continue:"click_continue_number",createOne:"click_create_number",createOneChild:"click_create_number",renumber:"click_edit_number"}[e],c=Object(g.m)(i,n),a={click:o,target:"none",sub_view:"heading"};r[e]&&Object.assign(a,{sub_click:r[e]}),Object(v.P)("ccm_doc_ordered_set_number_click",c,a)}),[n,i]),U=Object(h.useCallback)((function(e){var n=e.key;switch(n){case"continue":A();break;case"createOne":P();break;case"createOneChild":L();break;case"renumber":N()}F(n)}),[A,N,F]);return Object(h.useEffect)((function(){var e=function(e){e.stopPropagation()},n=document.getElementById(_);return null===n||void 0===n||n.addEventListener("mousemove",e),function(){null===n||void 0===n||n.removeEventListener("mousemove",e)}}),[i]),Object(h.useEffect)((function(){var e=Object(g.m)(i,n);Object(v.T)("ccm_doc_ordered_set_number_view",e,{is_support_continue_number:j?"false":"true",is_support_create_number:R?"false":"true",is_support_edit_number:"true",sub_view:"heading"})}),[n,i]),p.a.createElement(u.Menu,{forceSubMenuRender:!0,selectable:!1,className:"".concat(m),onClick:U,id:_},D.map((function(e){var n=e.key,r=e.disabled,o=e.Icon,i=e.text,c=e.subMenu;return c&&0!==c.length?p.a.createElement(u.Menu.SubMenu,{className:"".concat(m,"-submenu"),icon:p.a.createElement(o,{className:"".concat(m,"-icon")}),title:i,key:n,disabled:r},c.map((function(e){var n=e.key,r=e.disabled,o=e.text,i=f()("number-key",{disabled:r}),c=[o],a="createOne"===n?"1.":"".concat(w,"1"),l=o.split(a);return 2===l.length&&(c=[l[0],a,l[1]]),p.a.createElement(u.Menu.Item,{className:"".concat(m,"-children"),key:n,disabled:r},c.map((function(e,n){return 1===n?p.a.createElement("span",{key:n,className:i},e):p.a.createElement("span",{key:n},e)})))}))):p.a.createElement(u.Menu.Item,{className:"".concat(m,"-item"),icon:p.a.createElement(o,{className:"".concat(m,"-icon")}),key:n,disabled:r},i)})))}}).call(this,r("dx_E9Eu"))},dx_yzb3:function(e,n,r){"use strict";var o=r("dx_lSNA"),i=r.n(o),c=r("dx_o0o1"),a=r.n(c),l=r("dx_yXPU"),s=r.n(l),u=r("dx_yG8O"),d=r.n(u),f=r("dx_lwsE"),h=r.n(f),p=r("dx_W8MJ"),v=r.n(p),g=r("dx_PJYZ"),b=r.n(g),y=r("dx_iWIM"),m=r.n(y),_=r("dx_W7W2"),k=r.n(_),O=r("dx_a1gu"),x=r.n(O),E=r("dx_Nsbk"),S=r.n(E),C=r("dx_Uyc2"),I=r.n(C),B=(r("dx_A1AB"),r("dx_QxNg")),T=r("dx_FBWK"),w=r("dx_TSYQ"),R=r.n(w),M=r("dx_UtDZ"),j=r("dx_h6a8"),D=r("dx_cDcd"),A=r.n(D),P=r("dx_C7Cb"),L=r("dx_rQGm"),N=r("dx_yzqx"),F=r("dx_OUFY"),U=r("dx_B28d"),H=r("dx_i5i9S"),V=r("dx_R7Rv"),W=r("dx_YRGG"),z=r("dx_zghO"),G=r("dx_VY1y"),K=r("dx_BaTw"),q=r("dx_D8nn"),X=r("dx_sNGG"),Y=r("dx_ey54"),J=r("dx_U5UJ"),Z=r("dx_AFvt"),Q=r.n(Z),$=r("dx_Wkzy"),ee=r("dx_bWl7"),te=r("dx_Fimk"),ne=r("dx_O1Ou");function re(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function oe(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?re(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var ie,ce=ne.a.DocxBitable;!function(e){e.SCROLL="scroll"}(ie||(ie={}));var ae,le,se,ue,de,fe=i()({},ie.SCROLL,{offsetRatioMap:{}}),he=function(){function e(n,r,o,c,a,l,s){var u=this;h()(this,e),this.vcController=n,this.blockManager=r,this.recordId=o,this.blockId=c,this.getCurrOffsetRatio=a,this.scrollToOffsetRatio=l,this.getCurrScrollWidth=s,this.unregisterModuleFn=void 0,this.reportTimer=void 0,this.replayRetryTime=0,this.replayRetryTimer=void 0,this.lastActionUuid=void 0,this.cachedVcAction=void 0,this.onEnterBuffer=Object(j.debounce)((function(){u.cachedVcAction&&u.replayHandler(u.cachedVcAction)}),100),this.replayHandler=function(e){var n=e.actionType,r=e.data,o=e.uuid,i=e.reason,c=u.recordId,a=u.blockId;if(n===ie.SCROLL){var l,s,d;if(u.reportTimer&&u.lastActionUuid&&(clearTimeout(u.reportTimer),u.vcController.reportReplay(ne.s.IGNORE,u.lastActionUuid,"[".concat(ce,"]: next action is coming"))),u.replayRetryTime>0&&u.replayRetryTimer)clearTimeout(u.replayRetryTimer),u.lastActionUuid&&u.lastActionUuid!==o&&(null===(d=u.vcController)||void 0===d||d.reportReplay(ne.s.IGNORE,u.lastActionUuid,"[".concat(ce,"]: next action come when retrying"))),u.lastActionUuid=void 0;if(!u.getCurrScrollWidth()&&u.replayRetryTime<20)return u.lastActionUuid=o,u.replayRetryTime++,void(u.replayRetryTimer=setTimeout((function(){u.replayHandler({actionType:n,data:r,uuid:o,reason:i})}),500));if(!u.blockManager.layoutManager.isBlockActive(a))return u.cachedVcAction=e,void u.vcController.reportReplay(ne.s.IGNORE,u.cachedVcAction.uuid,"[".concat(ce,"]: not in buffer"));var f=r.offsetRatioMap,h=Math.min(1,(null===(l=f[c])||void 0===l?void 0:l.offsetRatio)||0),p=Date.now();u.replayRetryTime=0,u.replayRetryTimer=void 0,u.cachedVcAction=void 0,u.lastActionUuid=o,u.scrollToOffsetRatio(null===(s=f[c])||void 0===s?void 0:s.viewType,h),u.reportReplay(h,o,p),u.onEnterBuffer.cancel()}},this.sendScrollState=function(e,n){var r,o,c=u.recordId,a=u.vcController,l=(a.getState(ce,ie.SCROLL)||{offsetRatioMap:{}}).offsetRatioMap;if(n=Math.min(1,n||0),(null===(r=l[c])||void 0===r?void 0:r.offsetRatio)!==n||(null===(o=l[c])||void 0===o?void 0:o.viewType)!==e){var s={offsetRatioMap:oe(oe({},l),{},i()({},c,{viewType:e,offsetRatio:n}))};a.sendState(ce,ie.SCROLL,s)}},this.registerModule(o)}return v()(e,[{key:"destroy",value:function(){var e;this.reportTimer&&clearTimeout(this.reportTimer),this.reportTimer=void 0,this.lastActionUuid=void 0,null===(e=this.unregisterModuleFn)||void 0===e||e.call(this)}},{key:"registerModule",value:function(e){this.unregisterModuleFn=this.vcController.register({recordId:e,moduleName:ce,defaultState:fe,retryOnVersionMatched:"fail-only",replayHandler:this.replayHandler})}},{key:"reportReplay",value:function(e,n,r){var o=this,i=this.vcController;this.reportTimer=setTimeout((function(){o.reportTimer=void 0;var c=o.getCurrOffsetRatio();if(Object(j.inRange)(c,e-.02,e+.02))i.reportReplay(ne.s.SUCCESS,n,r);else{var a="[".concat(ce,"]: current offset ratio is not same as action");i.reportReplay(ne.s.FAIL,n,a,r),Object(te.N)("vc_action_apply_dev",{code:1,info:a,action:ce,string_param_1:JSON.stringify(c),string_param_2:JSON.stringify(e)})}}),100)}}]),e}();r("dx_Lw5s");function pe(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function ve(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?pe(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pe(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ge(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=S()(e);if(n){var i=S()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return x()(this,r)}}var be="docx-bitable-block",ye="BITABLE_BLOCK_OVERLAY",me="PREVIEW_BITABLE_BLOCK_OVERLAY",_e=(".".concat(be," .bitable-toolbar-doc"),de=ue=function(e){k()(r,e);var n=ge(r);function r(){var e;h()(this,r);for(var o=arguments.length,c=new Array(o),l=0;l<o;l++)c[l]=arguments[l];return(e=n.call.apply(n,[this].concat(c))).bridge=void 0,d()(e,"scheduler",le,b()(e)),e.mountPoint=null,e._overlayContainer=null,e.editbarPin=!1,e.syncSelectionDom=null,e._overlayClassName=null,e.activatedCommentSet=new Set,e.vcFollowHelper=void 0,e.preViewInfo={viewType:0,scrollLeft:0,scrollWidth:0,clientWidth:0,viewHeight:0},e.canvasInfo={height:"0px",width:"0px"},e.isHovered=!1,e.isNativeScroll=!1,e.isHalfFullScreen=!1,e.isRendered=!1,d()(e,"depLoader",se,b()(e)),e.state={isSelected:!1},e.takeScreenshot=function(){var n=s()(a.a.mark((function n(r){var o,i,c,l,s,u,d,f;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=r.status,c=r.detail,(l=e.getTableId())&&(null===(o=e.bridge)||void 0===o?void 0:o.takeScreenShot)){n.next=4;break}return n.abrupt("return");case 4:if(i!==U.v.start){n.next=10;break}return d=null===(s=null===c||void 0===c?void 0:c.isBlob)||void 0===s||s,n.next=8,null===(u=e.bridge)||void 0===u?void 0:u.takeScreenShot(l,d,!0);case 8:n.next=13;break;case 10:if(i!==U.v.end){n.next=13;break}return n.next=13,null===(f=e.bridge)||void 0===f?void 0:f.takeScreenShot(l,!0,!1);case 13:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),e.handleSelectionChanged=function(n,r){if(e.model.config.editable){var o=r.some((function(n){return n.id===e.id}));e.setState({isSelected:o})}},e.setRef=function(n){e.mountPoint=n},e.onResize=function(n){if(e.token&&!e.model.isDestroyed){var r=e.getHostRect(),o=r.width,i=document.body.clientWidth||o,c=e.getTableId();if(e.props.scrollManage){var a,l=e.isHalfFullScreen?e.halfFullScreenOffsetX/(null!==(a=e.props.zoom)&&void 0!==a?a:1):e.props.scrollManage.getScrollStatus().scrollLeft||0,s=n?Math.min(n,o):o;e.setContentWidth(c,n,l),e.setDocWidth(s,c)}else{if(N.S.isIPad){var u=i-r.left;e.setContentWidth(c,u,0)}else e.setContentWidth(c,i,0);e.setDocWidth(o,c)}}},e.checkAndSetCanvas=function(){if(e.token&&!e.model.isDestroyed){var n=e.mountPoint&&e.mountPoint.querySelector(".embeded-faster-view canvas");if(n&&!(n.height>0&&n.width>0)){var r=e.canvasInfo,o=r.height,i=r.width;parseInt(o)>0&&parseInt(i)>0&&(n.style.height=o,n.style.width=i)}}},e.enterBuffer=function(){var n;if(e.bridge){e.checkAndSetCanvas();var r=e.getTableId();if(r&&e.bridge.enterBuffer){var o,i;e.bridge.enterBuffer(r),e.onResize(e.props.scrollContainerWidth);var c=(null===(o=e.props.scrollManage)||void 0===o?void 0:o.getScrollStatus().scrollLeft)||0;null===(i=e.bridge)||void 0===i||i.setBitableViewScrollPosition(r,null,c)}null===(n=e.vcFollowHelper)||void 0===n||n.onEnterBuffer()}},e.leaveBuffer=function(){if(e.bridge){var n=e.getTableId();n&&e.bridge.leaveBuffer&&e.bridge.leaveBuffer(n);var r=e.mountPoint&&e.mountPoint.querySelector(".embeded-faster-view canvas");r&&(e.canvasInfo.height=r.style.height,e.canvasInfo.width=r.style.width)}},e.enterViewport=function(){if(e.bridge){var n=e.getTableId();n&&e.bridge.syncVirtualScroll([n])}},e.setUpBridgeAndRenderBitable=s()(a.a.mark((function n(){var r,o,c,l,s,u,d,f,h,p,v,g,b,y,m,_,k,O;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(p=e.props.onHistoryResultReady,v=e.getHistoryBlockVersionData(),g=Object(ee.U)(e.token),b=g.token,y=g.id,b&&y){n.next=5;break}return n.abrupt("return");case 5:return e.depLoader.reporter.report("ccm_docx_loadable_block_component_dev",{extra:["third_party_id:".concat(y," recordid: ").concat(Object(M.encryptTea)(e.model.record.id),", action: load bitbale bridge")]},{mergeKey:"extra",delay:5e3}),e.bridge=e.model.loadBridge(),m={id:y,blockId:b,host:e.mountPoint,undoDispatcher:null===(r=e.props.recursionProps.undoModule)||void 0===r?void 0:r.getUndoDispatcher(),viewIndex:"",overlayContainer:e.getOverlayContainer(e.token),isHistoryMode:e.model.config.get("isHistory"),historyBlockVersionData:e.getHistoryBlockVersionData(),onHistoryResultReady:p,operator:{internalSizeChange:e.onInternalSizeChange,editbarPinChange:e.onEditbarPinChange,getBitablePosition:e.getBitablePosition,triggerComment:function(){e.commentModule.triggerStartNewDocComment({selectedBlocks:[{id:e.id,type:z.j.BLOCK}],isThirdPartyComment:!0,callSource:"Bitable"})},onActiveCommentChange:function(){return e.model.activeCommentChange(e.commentModule)},onCommentLoaded:function(){e.commentModule&&e.model.handleCommentLoaded(e.commentModule)},onChanged:e.onTriggerFind,onSwitchNewView:e.onSwitchView,setCommentsFilter:function(n){e.commentModule&&e.model.setCommentsFilter(e.commentModule,n)}},onActive:function(){return null},onHeightDidUpdate:function(){e.blockManager.layoutManager.notifyNodeHeightChange(e.id)}},e.depLoader.reporter.report("ccm_docx_loadable_block_component_dev",{extra:["third_party_id:".concat(y," recordid: ").concat(Object(M.encryptTea)(e.model.record.id),", action: mount bitbale")]},{mergeKey:"extra",delay:5e3}),n.next=11,null===(o=e.bridge)||void 0===o?void 0:o.mountBitableBlock(e.id,m);case 11:if(e.onResize(e.props.scrollContainerWidth),e.props.onBlockReady&&e.props.onBlockReady(),e.blockManager.layoutManager.isBlockActive(e.id)&&e.enterBuffer(),_=null===(c=e.props.recursionProps.rectForFixed)||void 0===c?void 0:c.scrollableBlockList.get(e.props.blockId),(null===(l=e.bridge)||void 0===l?void 0:l.registerScrollContainerRef)&&(null===(s=e.bridge)||void 0===s||s.registerScrollContainerRef(y,_)),null===(u=e.bridge)||void 0===u||null===(d=u.registerViewFlushHandler)||void 0===d||d.call(u,y,e.handleBitableViewFlush),null===(f=e.props.scrollManage)||void 0===f||f.registerSubScroll(e.handleBlockScroll),null===(h=e.props.scrollManage)||void 0===h||h.onScroll(e.handleOnScroll),e.props.zoom&&e.bridge.setZoom(e.props.zoom),e.blockManager.addListener(Y.G,e.resizeHandler),!e.commentModule){n.next=24;break}return n.next=24,e.model.setCommentBatchUpdateListener(e.commentModule,y);case 24:e.blockManager.recordManager.on(B.q.CHANGE,e.handlePositionChange),e.model.config.get("isHistory")&&(O=e.getBitableHistoryUsers(),null===(k=e.bridge)||void 0===k||k.previewHistory({revInfo:i()({},y,{firstRev:null===v||void 0===v?void 0:v.fromVer,lastRev:null===v||void 0===v?void 0:v.toVer})},{isHighlight:Boolean(null===v||void 0===v?void 0:v.isShowDiff),users:O}));case 26:case"end":return n.stop()}}),n)}))),e.onTriggerFind=function(){e.props.recursionProps.eventEmitter.emit(X.Y.THIRD_PARTY_CONTENT_CHANGE)},e.onSwitchView=function(){e.onTriggerFind(),e.calcScrollStateToVc()},e.handlePositionChange=function(){e.bridge&&"function"===typeof e.bridge.onBlockPositionChange&&e.bridge.onBlockPositionChange(),e.onResize(e.props.scrollContainerWidth),e.updateBitableContent()},e.updateBitableContent=function(){requestAnimationFrame((function(){var n,r,o=Object(ee.U)(e.snapshot.token).id;(null===(n=e.bridge)||void 0===n?void 0:n.updateBitableContent)&&(null===(r=e.bridge)||void 0===r||r.updateBitableContent(o))}))},e.handleEditorResize=function(n){setTimeout((function(){n&&n.editorWidth&&e.onResize()}),100)},e.handleOnScroll=function(){var n,r,o,i=e.getTableId(),c=(null===(n=e.props.scrollManage)||void 0===n?void 0:n.getScrollStatus().scrollLeft)||0;e.isHalfFullScreen||q.S.emit(G.Y,{blockId:e.id,offset:c*(null!==(o=e.props.zoom)&&void 0!==o?o:1)});null===(r=e.bridge)||void 0===r||r.setBitableViewScrollPosition(i,null,c),e.calcScrollStateToVc()},e.getCurrOffsetRatio=function(){var n=e.props.scrollManage,r=e.preViewInfo.scrollWidth,o=n?n.getMaxScrollLeft():r-e.actualClientWidth,i=e.actualScrollLeft/o;return void 0===i||!Number.isNaN(i)&&Number.isFinite(i)||(i=0),i},e.calcScrollStateToVc=Object(j.debounce)((function(){if(e.vcFollowHelper){var n=e.getCurrOffsetRatio(),r=e.getBitableViewScrollInfo().viewType;e.vcFollowHelper.sendScrollState(r,n)}}),80),e.onInternalSizeChange=function(n,r,o,i,c){var a=Math.floor(r),l=e.props.scrollManage;if(l&&!e.blockManager.isUnmount){e.handleBlockHalfFullScreen(!!i),e.isNativeScroll=!!c,l.setIsNeedNativeScroll(!!c);var s=e.getTableId();if(i){var u;null===(u=e.bridge)||void 0===u||u.setBitableViewScrollPosition(s,null,e.halfFullScreenOffsetX)}else{var d,f,h=(null===(d=e.props.scrollManage)||void 0===d?void 0:d.getScrollStatus().scrollLeft)||0;null===(f=e.bridge)||void 0===f||f.setBitableViewScrollPosition(s,null,h)}var p=e.getBitableViewScrollInfo(),v=p.scrollPosX,g=p.viewType,b=!1,y=!1;e.preViewInfo.clientWidth!==e.props.scrollContainerWidth&&(e.preViewInfo.clientWidth=e.props.scrollContainerWidth,b=!0),e.preViewInfo.scrollLeft!==v&&(e.preViewInfo.scrollLeft=v,y=!0),e.preViewInfo.scrollWidth!==a&&(e.preViewInfo.scrollWidth=a,b=!0),e.preViewInfo.viewHeight!==o&&(e.props.recursionProps.isPresentationMode&&q.S.emit(q.p.PRESENTATION.FORCE_UPDATE_PAGINATION),e.preViewInfo.viewHeight=o,b=!0);var m,_,k=e.preViewInfo.viewType!==g;if(k&&(e.preViewInfo.viewType=g),(b||k)&&requestAnimationFrame((function(){var n;e.handleBlockScroll(1),e.handleBlockScroll(-1),null===(n=e.props.scrollManage)||void 0===n||n.emitSubViewChange({width:a,viewType:g}),e.updateBitableContent()})),y)null===(m=e.props.scrollManage)||void 0===m||m.emitSubScroll({scrollLeft:v*(null!==(_=e.props.zoom)&&void 0!==_?_:1),scrollWidth:a})}},e.handleBlockHalfFullScreen=function(n){var r,o,i=e.props,c=i.scrollManage,a=i.model;if(c){var l=(null===(r=a.root)||void 0===r?void 0:r.id)===(null===(o=a.parent)||void 0===o?void 0:o.id);q.S.emit(G.j,{blockId:e.id,isHalfFullScreen:!!n&&l}),n!==e.isHalfFullScreen&&(c.setIsNeedPaddingLeft(!n),c.setIsShowScrollBar(!n),e.isHalfFullScreen=!!n)}},e.handleBitableViewFlush=function(){var n=e.getBitableViewScrollInfo(),r=n.scrollPosX,o=n.contentWidth,i=Math.floor(o);e.preViewInfo.scrollLeft!==r&&(e.preViewInfo.scrollLeft=r),e.preViewInfo.scrollWidth!==i&&(e.preViewInfo.scrollWidth=i),e.calcScrollStateToVc()},e.handleBlockScroll=function(n){var r,o,i;if(!e.isNativeScroll){var c,a,l,s,u=e.getTableId(),d=e.getBitableViewScrollInfo(),f=d.scrollPosX,h=d.contentWidth;if("number"===typeof n)null===(c=e.bridge)||void 0===c||c.setBitableViewScrollPosition(u,{diffX:n/(null!==(a=e.props.zoom)&&void 0!==a?a:1)});else null===(l=e.bridge)||void 0===l||l.setBitableViewScrollPosition(u,{x:n.scrollLeft/(null!==(s=e.props.zoom)&&void 0!==s?s:1)});null===(r=e.props.scrollManage)||void 0===r||r.emitSubScroll({scrollLeft:f*(null!==(o=e.props.zoom)&&void 0!==o?o:1),scrollWidth:h*(null!==(i=e.props.zoom)&&void 0!==i?i:1)}),e.calcScrollStateToVc()}},e.getViewSnapshot=function(){var n;if(e.token&&e.bridge){var r,o=e.getTableId(),i=null===(r=e.bridge)||void 0===r?void 0:r.currentScreenShot(o),c=e.mountPoint&&e.mountPoint.querySelector("canvas"),a=c&&c.style.width,l=c&&c.style.height;if(!i)return null;n=Object(K.X5)(i,a,l)}else n=Object(K.X5)(Q.a);return n},e.getScrollStatus=s()(a.a.mark((function n(){var r,o;return a.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.bridge){n.next=2;break}return n.abrupt("return");case 2:if(r=e.getTableId()){n.next=5;break}return n.abrupt("return");case 5:return n.next=7,e.bridge.getScrollStatus(r);case 7:return o=n.sent,n.abrupt("return",o);case 9:case"end":return n.stop()}}),n)}))),e.onEditbarPinChange=function(n){if(n!==e.editbarPin){if(e._overlayContainer){var r=e.initOverlayMount(),o=r.globalOverlayMount,i=r.scrollOverlayMount;n?o&&o.appendChild(e._overlayContainer):i&&i.appendChild(e._overlayContainer)}e.editbarPin=n}},e.getBitablePosition=function(){var n,r,o={};if(!e.mountPoint||e.blockManager.isUnmount||!e.boundary)return o;var i=e.boundary.getBoundingClientRect(),c=null===(n=e._overlayContainer)||void 0===n?void 0:n.querySelector(".bitable-toolbar-doc-wrapper"),a=document.querySelector(".navigation-bar-wrapper .navigation-bar-wrapper")||document.querySelector(".navigation-bar-wrapper"),l=a?a.getBoundingClientRect().bottom:0,s=0,u=0;e.boundary&&(u=Math.max(0,i.top),s=Math.max(l,u));var d=Object(j.get)(c,"offsetHeight",52),f=e.mountPoint.querySelector(".embeded-faster-view canvas"),h=e.getHostRect(),p=e.mountPoint.querySelector(".embeded-faster-dom-wrapper");if(!f||0===f.clientWidth||!h||!p)return o;var v=f.getBoundingClientRect(),g=p.getBoundingClientRect(),b=g.top<s&&v.bottom<=g.height+s,y=v.bottom>110+s,m=b&&y,_=(null===(r=e.props.scrollManage)||void 0===r?void 0:r.getScrollStatus().scrollLeft)||0,k=i.left,O={left:v.left,hostLeft:h.left,scrollLeft:_};if(!N.S.isSafari){if(m)return ve({top:s+d},O);if(b&&!y)return ve({top:v.bottom-d},O)}if(e.editbarPin)return v;var x=e.blockManager.layoutManager.getScroller(),E=x?x instanceof Window?x.scrollY:x.scrollTop:0;return{top:v.top-u+E,left:v.left-k,hostLeft:h.left-k}},e.getBitableHistoryUsers=function(){var n=e.getHistoryBlockVersionData();return Object.keys((null===n||void 0===n?void 0:n.users)||{}).reduce((function(e,r){var o=n.users[r];return e[r]={textColor:null===o||void 0===o?void 0:o.textColor,bgColor:(null===o||void 0===o?void 0:o.backgroundColor)||(null===o||void 0===o?void 0:o.bgColor),labelColor:null===o||void 0===o?void 0:o.labelColor,cn_name:null===o||void 0===o?void 0:o.name,en_name:null===o||void 0===o?void 0:o.name,enName:null===o||void 0===o?void 0:o.name,name:null===o||void 0===o?void 0:o.name},e}),{})},e.handleMouseEnter=function(){e.isHovered=!0},e.handleMouseLeave=function(){e.isHovered=!1},e.scrollToOffsetRatio=function(n){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e.props.scrollManage){var i=e.getTableId();null===(r=e.bridge)||void 0===r||r.setBitableViewScrollPosition(i,{viewType:void 0!==n?n:e.getBitableViewScrollInfo().viewType,ratio:o})}},e.showSyncSelection=function(){var n=e.getBlockWrapper();if(n){var r=document.createElement("div");r.className="bitable-block-sync-selected",r.style.backgroundColor=e.props.syncCursorBgColor,n.appendChild(r),e.syncSelectionDom=r}},e.getBlockWrapper=function(){return e.mountPoint?e.mountPoint.querySelector(".virtual-view-wrapper"):e.hostElement},e.hideSyncCursorSelection=function(){var n;null===(n=e.syncSelectionDom)||void 0===n||n.remove()},e.handleBitableDidRender=function(){var n,r;q.S.on(J.Q,e.takeScreenshot),e.setSelected(e.state.isSelected),e.isRendered=!0,e.selectionAPI.onSelectionChange(e.handleSelectionChanged),null===(n=e.mountPoint)||void 0===n||n.addEventListener("mouseenter",e.handleMouseEnter,!0),null===(r=e.mountPoint)||void 0===r||r.addEventListener("mouseleave",e.handleMouseLeave,!0),e.vcController&&!e.props.scrollManage&&(e.vcFollowHelper=new he(e.vcController,e.blockManager,e.record.id,e.id,e.getCurrOffsetRatio,e.scrollToOffsetRatio,(function(){return e.preViewInfo.scrollWidth})))},e.renderComponent=function(n){return A.a.createElement(ke,{isShowLoading:e.props.isShowLoading,setRef:e.setRef,token:e.token,bridge:e.bridge,setUpBridgeAndRenderBitable:e.setUpBridgeAndRenderBitable,renderFinishCb:n})},e.onBlockFetchFail=function(){var n,r;null===(n=(r=e.props).updateOuterLoadingComponent)||void 0===n||n.call(r,A.a.createElement(V.F,{onClickRetry:function(){e.props.updateOuterLoadingComponent(e.props.loadingComponent),e.scheduler.retryFetchBlock(e.props.blockId)}}))},e}return v()(r,[{key:"getIsHalfFullScreen",value:function(){return this.isHalfFullScreen}},{key:"blockViewDidUpdate",value:function(e,n){var o=this;m()(S()(r.prototype),"blockViewDidUpdate",this).call(this,e,n);var i,c=e.scrollContainerWidth,a=this.props.scrollContainerWidth;(c!==a&&setTimeout((function(){o.onResize(a)}),20),!e.syncCursorSelected&&this.props.syncCursorSelected?this.showSyncSelection():e.syncCursorSelected&&!this.props.syncCursorSelected&&this.hideSyncCursorSelection(),e.zoom!==this.props.zoom&&this.bridge)&&this.bridge.setZoom(null!==(i=this.props.zoom)&&void 0!==i?i:1)}},{key:"blockViewWillUnmount",value:function(){var e,n,o,i;if(m()(S()(r.prototype),"blockViewWillUnmount",this).call(this),this.selectionAPI.offSelectionChange(this.handleSelectionChanged),!this.blockManager.isUnmount){var c=this.getTableId();this.bridge&&(null===(e=this.bridge)||void 0===e||e.delBitableBlock(this.id,c)),null===(n=this.mountPoint)||void 0===n||n.removeEventListener("mouseenter",this.handleMouseEnter,!0),null===(o=this.mountPoint)||void 0===o||o.removeEventListener("mouseleave",this.handleMouseLeave,!0),q.S.off(J.Q,this.takeScreenshot),this.blockManager.removeListener(Y.G,this.resizeHandler),this.blockManager.recordManager.off(B.q.CHANGE,this.handlePositionChange),this.model.reset(),null===(i=this.vcFollowHelper)||void 0===i||i.destroy()}}},{key:"activateComment",value:function(e){var n,r=this.getTableId();if(r)return null===(n=this.bridge)||void 0===n?void 0:n.activateComment(r,e)}},{key:"deactivateComment",value:function(e){var n=Object(ee.U)(this.token).id;if(n)return this.bridge.deactivateComment(n,e)}},{key:"addHoverHighlight",value:function(e){var n=Object(ee.U)(this.token).id;if(n)return this.bridge.addHoverHighlight(n,e)}},{key:"removeHoverHighlight",value:function(e){var n=Object(ee.U)(this.token).id;if(n)return this.bridge.removeHoverHighlight(n,e)}},{key:"addCommentHighlight",value:function(e){this.activatedCommentSet.add(e),m()(S()(r.prototype),"addCommentHighlight",this).call(this,e);var n=Object(ee.U)(this.token).id;this.bridge.updateHighlight(n,2)}},{key:"removeCommentHighlight",value:function(e){if(this.activatedCommentSet.delete(e),!(this.activatedCommentSet.size>0)){m()(S()(r.prototype),"removeCommentHighlight",this).call(this,e);var n=Object(ee.U)(this.token).id;this.bridge.updateHighlight(n,0)}}},{key:"setHovered",value:function(e){if(m()(S()(r.prototype),"setHovered",this).call(this,e),!this.state.isSelected){var n,o=this.getTableId();this.bridge&&(null===(n=this.bridge)||void 0===n||n.updateBitableSelectionState(o,e,{border:{color:Object(T.getThemeColorByToken)("B200"),width:2}}))}this.isHovered=e}},{key:"setSelected",value:function(e){var n=this.getTableId();if(N.S.isMobile&&N.S.isBytedanceApp){var r=e?U.V.FOCUS_ON_BLOCK:U.V.NONE;this.bridge&&this.bridge.updateSelectionState(n,r)}else{var o;this.bridge&&(null===(o=this.bridge)||void 0===o||o.updateBitableSelectionState(n,e))}return this.setState({isSelected:e}),!1}},{key:"onFoldStateChange",value:function(e){if(N.S.isMobile){if(!this.bridge)return;var n=this.getTableId();n&&this.bridge.collapseLineChange&&this.bridge.collapseLineChange(n,e.show)}}},{key:"isContainedInOverlay",value:function(e){var n;return null===(n=this._overlayContainer)||void 0===n?void 0:n.contains(e)}},{key:"setContentWidth",value:function(e,n,r){var o;e&&n&&(n=n&&Math.floor(n),null===(o=this.bridge)||void 0===o||o.setWidth(n,r,e))}},{key:"setDocWidth",value:function(e,n){var r;e&&(null===(r=this.bridge)||void 0===r||r.setDocWidth(e,n))}},{key:"getBitableViewScrollInfo",value:function(){var e,n=this.getTableId();return null===(e=this.bridge)||void 0===e?void 0:e.getBitableViewScrollInfo(n)}},{key:"initOverlayMount",value:function(){return{globalOverlayMount:this.globalOverlayContainer&&this.createOverlayMount(this.globalOverlayContainer),scrollOverlayMount:this.root&&this.createOverlayMount(this.root)}}},{key:"createOverlayMount",value:function(e){var n=e.querySelector(".".concat(this.overlayClassName))||document.createElement("div");return n.className=this.overlayClassName,e.appendChild(n),n}},{key:"getOverlayContainer",value:function(e){var n=this.getOverlayClassName(e),r=this.initOverlayMount().scrollOverlayMount;return r?(this._overlayContainer=r.querySelector(".".concat(n))||void 0,this._overlayContainer||(this._overlayContainer=document.createElement("div"),this._overlayContainer.className=n,r.appendChild(this._overlayContainer)),this._overlayContainer):null}},{key:"getOverlayClassName",value:function(e){return this._overlayClassName=this._overlayClassName||"".concat(this.overlayClassName,"-").concat(e,"-").concat(Object(P.S)()),this._overlayClassName}},{key:"getHistoryBlockVersionData",value:function(){var e=this.model.config.get("isHistory"),n=this.props.historyBlockVersionData;return e?n||{toVer:0,fromVer:0,users:{},isShowDiff:!1}:null}},{key:"highlightHistory",value:function(e){var n=this.getTableId();n&&this.bridge.locateHistory(n,e)}},{key:"clearHighlightHistory",value:function(){var e,n=this.getTableId();if(n){var r=this.getHistoryBlockVersionData();null===(e=this.bridge)||void 0===e||e.previewHistory({revInfo:i()({},n,{lastRev:r.toVer,firstRev:r.fromVer})},{isHighlight:!1,users:{}})}}},{key:"getIsHovered",value:function(){return this.isHovered}},{key:"getIsRenderedPromised",value:function(){var e=s()(a.a.mark((function e(){var n=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){!function r(){n.isRendered?e({}):setTimeout((function(){r()}),300)}()})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getTableId",value:function(){return Object(ee.U)(this.token).id}},{key:"render",value:function(){var e=this;return A.a.createElement(V.h,{blockId:this.props.blockId,blockType:U.B.BITABLE,eventEmitter:this.props.recursionProps.eventEmitter,scheduler:this.scheduler,renderLoadingPlaceholder:this.renderComponent,onBlockFetchFail:this.onBlockFetchFail,renderErrorPlaceholder:function(){return null},renderContent:function(n,r){return e.renderComponent((function(){r(),e.handleBitableDidRender()}))}})}},{key:"overlayClassName",get:function(){return this.props.recursionProps.isPreview&&!this.props.recursionProps.isPresentationMode?me:ye}},{key:"root",get:function(){return this.props.recursionProps.isHistory?document.querySelector(".docx-history-container .docx-history-content"):this.props.recursionProps.isPreview&&!this.props.recursionProps.isPresentationMode?document.querySelector(".page-preview-container .root-block"):document.querySelector(".".concat(L.b3.ROOT))||document.querySelector(".root-block")}},{key:"globalOverlayContainer",get:function(){return document.querySelector(".global-overlay-container")}},{key:"resizeHandler",get:function(){return N.S.isMobile?this.handleEditorResize:this.handlePositionChange}},{key:"halfFullScreenOffsetX",get:function(){var e,n=this.getHostRect(),r=null===(e=this.mountPoint)||void 0===e?void 0:e.querySelector("#bitable-container"),o=(null===r||void 0===r?void 0:r.getBoundingClientRect().left)||0,i=n.left||0;return Math.max(i-o,0)}},{key:"isBlockRendered",get:function(){return this.isRendered}},{key:"contentElement",get:function(){return this.mountPoint}},{key:"mainScrollLeft",get:function(){var e,n=null===(e=this.props.scrollManage)||void 0===e?void 0:e.getScrollModel();return(null===n||void 0===n?void 0:n.mainScrollLeft)||0}},{key:"actualScrollLeft",get:function(){var e,n,r=null===(e=this.props.scrollManage)||void 0===e?void 0:e.getScrollStatus();return((null===r||void 0===r?void 0:r.scrollLeft)||(null===(n=this.scrollContainer)||void 0===n?void 0:n.scrollLeft)||0)+this.preViewInfo.scrollLeft}},{key:"actualClientWidth",get:function(){var e,n,r=null===(e=this.scrollContainer)||void 0===e?void 0:e.querySelector(".".concat(F.z));return(r?r.clientWidth-2:null===(n=this.scrollContainer)||void 0===n?void 0:n.clientWidth)||0}},{key:"scrollContainer",get:function(){var e=this.props.scrollManage;return e?e.getScrollContainer():this.mountPoint}}],[{key:"selectionTargetFilter",value:function(e){return!(e.closest(".embeded-bitable-container.bitable-container")||e.closest(".".concat(ye))||e.closest(".".concat(me)))}}]),r}(H.W),ue.CLASS_NAME=be,ae=de,le=I()(ae.prototype,"scheduler",[W.b],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),se=I()(ae.prototype,"depLoader",[$.x],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae),ke=function(e){k()(r,e);var n=ge(r);function r(){var e;h()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).didRender=!1,e}return v()(r,[{key:"componentDidMount",value:function(){var e=s()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.renderFinishCb){e.next=2;break}return e.abrupt("return");case 2:if(this.props.bridge||""===this.props.token){e.next=7;break}return e.next=5,this.props.setUpBridgeAndRenderBitable();case 5:this.didRender=!0,this.props.renderFinishCb();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=s()(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.renderFinishCb){e.next=2;break}return e.abrupt("return");case 2:this.didRender||!this.props.renderFinishCb||this.props.bridge||""===this.props.token||(this.props.setUpBridgeAndRenderBitable(),this.didRender=!0,this.props.renderFinishCb());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props.isShowLoading,n=R()("bitable-block-container",{"is-mobile":N.S.isMobile});return A.a.createElement("div",{contentEditable:!1,className:n,ref:this.props.setRef,style:{minHeight:e?"160px":""}})}}]),r}(A.a.Component);n.S=_e},dx_z0z2:function(e,n,r){"use strict";r.d(n,"i",(function(){return i})),r.d(n,"g",(function(){return c})),r.d(n,"w",(function(){return a})),r.d(n,"E",(function(){return l})),r.d(n,"H",(function(){return s})),r.d(n,"D",(function(){return u})),r.d(n,"F",(function(){return d})),r.d(n,"f",(function(){return f})),r.d(n,"k",(function(){return h})),r.d(n,"Y",(function(){return p}));var o=r("dx_yNB7"),i="codeBlock:lastLang",c="".concat(o.l,"highlight"),a="hljs-",l="Plain Text",s=20,u=5,d=200,f=5,h={HIGHLIGHT:"highlight",AUTO_IDENTIFY_LANGUAGE:"autoIdentifyLanguage"},p=["bold","strikethrough","italic","underline","textHighlightBackground","textHighlight"]},dx_z2zF:function(e,n,r){"use strict";var o;r.d(n,"G",(function(){return o})),function(e){e.publish="publish",e.vote="vote",e.update_user_count="update_user_count"}(o||(o={}))},dx_z36z:function(e,n,r){"use strict";r.d(n,"S",(function(){return A}));var o=r("dx_o0o1"),i=r.n(o),c=r("dx_yXPU"),a=r.n(c),l=r("dx_lSNA"),s=r.n(l),u=r("dx_lwsE"),d=r.n(u),f=r("dx_W8MJ"),h=r.n(f),p=r("dx_W7W2"),v=r.n(p),g=r("dx_a1gu"),b=r.n(g),y=r("dx_Nsbk"),m=r.n(y),_=r("dx_h6a8"),k=r("dx_C7Cb"),O=r("dx_B28d"),x=r("dx_ZG9w"),E=r("dx_kZ3l"),S=r("dx_zghO"),C=r("dx_FNDK"),I=r("dx_tVvo"),B=r("dx_cQo6"),T=r("dx_n3n9"),w=r("dx_HirW"),R=r("dx_Y27Y");function M(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function j(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?M(Object(r),!0).forEach((function(n){s()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function D(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m()(e);if(n){var i=m()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return b()(this,r)}}var A=function(e){v()(r,e);var n=D(r);function r(){var e;d()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).format=R.L.DOCX_TEXT,e}return h()(r,[{key:"shouldCopy",value:function(e){if(1===e.length&&e[0].type===S.j.TEXT){var n=this.blockManager.getBlockViewByBlockId(e[0].id),r=e[0].selection&&e[0].selection.start===e[0].selection.end;return Object(x.f)(n)&&!r}return!1}},{key:"shouldPaste",value:function(e,n){return!0}},{key:"onCopyBlock",value:function(e){var n=this,r=this.blockManager.getBlockViewByBlockId(e.id);if(e.selection){var o=Object(E.j)(r,[e.selection.start,e.selection.end]),i={},c=[O.B.CODE,O.B.OBJECTIVE,O.B.KEY_RESULT].includes(r.type),a=O.B.TEXT;if(!c&&Object(C.p)([e],this.blockManager)){a=r.type;var l=this.blockManager.getRecordByBlockId(r.id);l&&O.O.includes(a)&&(i.seq=l.snapshot.seq),l&&a===O.B.TODO&&(i.done=l.snapshot.done)}var s=r.model.zoneState.slice(o.start,o.end),u=Object(x.M)(s.toAttributeText(),r.blockManager),d=Object(x.Z)(u),f={};d.forEach((function(e){return Object.assign(f,Object(w.lj)(n.blockManager,e))}));var h=Object(w.I)(u);return j({rootId:this.blockManager.getBlockModelByBlockId(r.id).root.recordId,text:u,type:a,referenceRecordMap:f,extra:h},i)}}},{key:"onCopy",value:function(e,n){return j(j({},Object.values(e)[0]),{},{isCut:n})}},{key:"onDelete",value:function(e){var n=e[0];if(n.selection){var r=this.blockManager.getBlockViewByBlockId(n.id),o=Object(E.j)(r,[n.selection.start,n.selection.end]);r.replaceTextAndUpdateSelection(o,null,o[0])}}},{key:"onPaste",value:function(){var e=a()(i.a.mark((function e(n,r,o){var c,a,l,u,d,f,h,p,v,g,b,y,m;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n[0],e.next=3,this.blockManager.layoutManager.renderNodeById(c.id);case 3:a=JSON.parse(r),l=a.text,u=a.extra,d=a.type,f=a.referenceRecordMap,h=a.seq,p=a.done,v=Object(k.S)(),g={type:d,text:l},!Object(_.isUndefined)(h)&&(g.seq=h),!Object(_.isUndefined)(p)&&(g.done=p),b=[v],y=j(s()({},v,{id:v,snapshot:g}),f),m=j(j({},Object(B.Z6)(y,o)),a.payloadMap||{}),Object(w.A)(u),Object(I.s)(Object.assign({},this.options,{proxyClipboardData:o}),{recordIds:b,recordMap:y,payloadMap:m},this.format);case 14:case"end":return e.stop()}}),e,this)})));return function(n,r,o){return e.apply(this,arguments)}}()}]),r}(T.S)},dx_z3zX:function(e,n,r){"use strict";var o=r("dx_J4zp"),i=r.n(o),c=r("dx_h6a8"),a=r("dx_cDcd"),l=r.n(a),s=r("dx_f6fH"),u=r("dx_rGeQ"),d=r("dx_tX8z"),f=r("dx_Mzjv"),h=r("dx_S6dX");n.S=function(e){var n=e.visible,r=e.target,o=e.mask,p=e.direction,v=e.offset,g=e.reverse,b=e.sticky,y=e.once,m=e.onClose,_=e.zIndex,k=e.className,O=e.boundary,x=e.blockManager,E=e.selectionAPI,S=e.animation,C=e.transition,I=e.children,B=e.hideWhenOverflow,T=e.ignoreTriggerTargetClass,w=e.bubbleForbidden,R=Object(d.l)(r,x,n,O),M=Object(u.S)(O,x,n),j=Object(a.useMemo)((function(){return g?[p,Object(h.c)(p)]:[p]}),[g,p]),D=Object(a.useCallback)((function(e){if(g){var n=e.adaptiveSize,r=e.contentRect,o=e.allowDirections,a=Object(c.isArray)(b)?b:[b,b],l=i()(a,2),s=l[0],u=l[1],d=i()(o,2),h=d[0],p=d[1],v=["left","right"].some((function(e){return h.toLowerCase().startsWith(e)}));return v&&r.width?!s&&r.width>n[h].width&&n[h].width<n[p].width?p:h:!v&&r.height?!u&&r.height>n[h].height&&n[h].height<n[p].height?p:h:f.R.None}return j[0]}),[g,b]);return l.a.createElement(s.S,{visible:n,mask:o,targetRect:R,boundaryRect:M,allowDirections:j,calcDirectionOnce:y,sticky:b,offset:v,className:k,calcDirection:D,blockManager:x,selectionAPI:E,zIndex:_,onClose:m,animation:S,transition:C,hideWhenOverflow:B,ignoreTriggerTargetClass:T,bubbleForbidden:w},I)}},dx_z4Mb:function(e,n,r){"use strict";r.d(n,"Z",(function(){return i}));var o=r("dx_BaZy"),i=r.n(o)()({loader:function(){return Promise.all([r.e("dx_k3k"),r.e("dx_p5p"),r.e("dx_G1G"),r.e("dx_N76")]).then(r.bind(null,"dx_EFxn"))},loading:function(){return null}})},dx_z6zX:function(e,n,r){"use strict";(function(t){var e=r("dx_J4zp"),o=r.n(e),i=r("dx_PcQO"),c=r("dx_UtDZ"),a=r("dx_h6a8"),l=r("dx_cDcd"),s=r.n(l),u=r("dx_amgp"),d=(r("dx_N1aH"),r("dx_pqP2")),f=r("dx_ygJz"),h=c.UserPopover,p="okr-header";n.S=function(e){var n=e.isOKROwner,r=e.editable,v=e.okrOwnerId,g=e.userName,b=e.userAvatar,y=e.periodName,m=e.periodDisplayStatus,_=e.isMobile,k=e.isSyncing,O=e.syncTime,x=e.enableScore,E=e.progressRateVisible,S=e.scoreVisible,C=e.progressVisible,I=e.okrVisibilitySetting,B=e.onSyncProgress,T=e.getNoPromptedState,w=e.getHasProgressState,R=e.onScoreVisibleChange,M=e.onProgressVisibleChange,j=e.onProgressRateVisibleChange,D=e.onKRVisibleChange,A=e.onSyncProgressCanceled,P=void 0===A?a.noop:A,L=e.onSettingEntranceClick,N=void 0===L?a.noop:L,F=e.onSyncEntranceClick,U=void 0===F?a.noop:F,H=Object(l.useState)(!1),V=o()(H,2),W=V[0],z=V[1],G=Object(l.useState)(!1),K=o()(G,2),q=K[0],X=K[1],Y=!Object(a.some)(I,(function(e){return"KR"===e.type&&e.visible})),J=n&&Object(c.getMinaConfig)("okr_block_progress_sync_enable",!1),Z=!S&&!E&&(!C||Y);return s.a.createElement("div",{className:p,contentEditable:!1},s.a.createElement("div",{className:"".concat(p,"__left-content")},s.a.createElement(h,{source:"docx-at-user",token:v,name:g,trigger:"hover",placement:"rt",align:{offset:[10,0]},usePopover:!0,mouseEnterDelay:300},s.a.createElement(i.Avatar,{src:b,size:"small",style:{flexShrink:0}})),s.a.createElement("div",{className:"".concat(p,"__user-name")},g),!_&&s.a.createElement("div",{className:"".concat(p,"__period-name")},y,m===u.U.INVALID&&s.a.createElement("span",{style:{marginLeft:4}},t("CreationDoc_Docs_OKR_InvalidCycle")))),!_&&r&&s.a.createElement("div",{className:"".concat(p,"__right-content"),style:W||q||k?{display:"flex"}:{}},J&&s.a.createElement(d.r,{disabled:Z,enableScore:x,isSyncing:k,syncTime:O,getNoPromptedState:T,getProgressEmptyState:function(){return!S&&!E&&!w()},onSyncPopVisibleChange:z,onSyncProgress:B,onSyncProgressCanceled:P,onTiggerClick:U}),s.a.createElement(f.G,{enableScore:x,progressRateVisible:E,scoreVisible:S,progressVisible:C,okrVisibilitySetting:I,onSettingPopVisibleChange:X,onScoreVisibleChange:R,onProgressVisibleChange:M,onProgressRateVisibleChange:j,onKRVisibleChange:D,onTiggerClick:N})))}}).call(this,r("dx_E9Eu"))},dx_z8d9:function(e,n,r){"use strict";r.d(n,"D",(function(){return o})),r.d(n,"W",(function(){return d}));var o,i=r("dx_lwsE"),c=r.n(i),a=r("dx_W8MJ"),l=r.n(a),s=r("dx_b28D"),u=Object(s.e)("catalogue:move");!function(e){e.LEFT="left",e.RIGHT="right",e.EXPAND_WIDTH="expand_width"}(o||(o={}));var d=function(){function e(n){c()(this,e),this._direction=void 0,this.maxDuration=void 0,this.resolveMoveEnd=void 0,this.maxDuration=n||1e3}return l()(e,[{key:"start",value:function(e,n){var r=this;return new Promise((function(o){if(r._direction)throw new Error("".concat(n,": is moving to ").concat(r._direction,", skip moving to ").concat(e," again"));u("%s: start moving to %s",n,e),r._direction=e,r.resolveMoveEnd=o,window.setTimeout((function(){return r.stop("start.timeout")}),r.maxDuration)}))}},{key:"stop",value:function(e){if(this._direction){u("%s: stop moving to %s",e,this._direction);var n=this._direction;this._direction=void 0,this.resolveMoveEnd({direction:n,caller:e})}}},{key:"isMoving",get:function(){return Boolean(this._direction)}},{key:"isMovingLeft",get:function(){return this._direction===o.LEFT}},{key:"direction",get:function(){return this._direction}}]),e}()},dx_z8zm:function(e,n,r){"use strict";r.d(n,"E",(function(){return i})),r.d(n,"e",(function(){return c})),r.d(n,"u",(function(){return a}));var o=r("dx_hIkB");function i(e){var n,r,i;return null!==(n=null===e||void 0===e||null===(r=e.docx)||void 0===r||null===(i=r.presentationMode)||void 0===i?void 0:i.type)&&void 0!==n?n:o.h.NONE}function c(e){var n,r,i;return null!==(n=null===e||void 0===e||null===(r=e.docx)||void 0===r||null===(i=r.presentationMode)||void 0===i?void 0:i.status)&&void 0!==n?n:o.R.DONE}function a(e){return i(e)!==o.h.NONE}},dx_z9zT:function(e,n,r){"use strict";r.d(n,"S",(function(){return Ne}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_J4zp"),a=r.n(c),l=r("dx_lwsE"),s=r.n(l),u=r("dx_W8MJ"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_TSYQ"),m=r.n(y),_=r("dx_cDcd"),k=r.n(_),O=r("dx_h74D"),x=r("dx_rQGm"),E=r("dx_TfZh"),S=r("dx_a3US"),C=r("dx_z8zm"),I=r("dx_b28D"),B=Object(I.h)("scrollable:use-item-rerender");var T=r("dx_h6a8"),w=Object(I.h)("scrollable:use-sub-scroll"),R=r("dx_L6Lu"),M=r("dx_Vau3"),j=r("dx_hIkB"),D=r("dx_D8nn"),A=r("dx_MlPX"),P=r("dx_ey54"),L=r("dx_k8kI"),N=r("dx_OUFY"),F=r("dx_UtDZ"),U=r("dx_HeF4"),H=r("dx_yzqx"),V=r("dx_E2oU"),W=r("dx_SZT7"),z=r("dx_B28d"),G=r("dx_BH3T");var K=r("dx_QWnh"),q=Object(I.e)("scrollable:helper"),X=Object(I.h)("scrollable:helper");function Y(e,n){var r,o=function(e){for(var n=e.parent,r=0;n&&Object(G.Q)(n.type);)r+=1,n=n.parent;return{nestingLevel:r,indentWidth:r*x.X,relativeToRoot:Boolean(n&&Object(G.iL)(n.type))}}(n),i=o.indentWidth,c=o.relativeToRoot,a=e===U.u.HISTORY,l=(null===(r=n.parent)||void 0===r?void 0:r.type)!==z.B.PAGE;return{isKeepBoundary:!a?!c:l,indentWidth:i}}var J=function(){function e(n,r){var o=this;s()(this,e),this.options=n,this.layout=r,this.getContainerWidth=function(){var e=o.getRootElement(),n=e.getBoundingClientRect().width,r=o.getElementScrollbarWidth(e);return function(e,n){var r=e.rootWidth,o=e.rightPanelWidth,i=e.scrollbarWidth,c=n.leftMargin,a=n.rightMargin,l=r-c-a-o-i;return q("containerWidth=%s(%s-%s-%s-%s-%s)",l,r,c,a,o,i),l}({rootWidth:n,rightPanelWidth:o.getRightPanelWidth(),scrollbarWidth:r},W.H)}}return d()(e,[{key:"getElementScrollbarWidth",value:function(e){return e.offsetWidth-e.clientWidth}},{key:"getWrapperOffset",value:function(){return this.layout?function(e,n,r){var o=r.leftMargin,i=n-e-o,c=Math.round(Math.max(i,0));return q("wrapperOffset=%s=round(max(0, %s-%s-%s))",c,n,e,o),c}(this.getRootBoundaryRect().left,this.layout.editor.getHostRect().left,W.H):0}},{key:"calcLayout",value:function(e,n,r,o,i,c){var a,l,s=i.hostElementZoom,u=i.scrollContainerZoom,d=o*s;if(n)a=d,l=0;else if(e===j.h.PAGINATION){var f=Object(K.R)().width;a=Math.min(d,f),l=this.getWrapperOffset()+r}else a=this.getContainerWidth(),l=this.getWrapperOffset()+r;var h=a/u,p=l/u;return X(c,"calcLayout(isKeepBoundary=%s, presentationModeType=%s, indentWidth=%s): containerWidth=%s(%s/%s), wrapperOffset=%s",n,e,r,h,a,u,p),{scrollContainerWidth:h,scrollWrapperOffset:p}}},{key:"getRootElement",value:function(){return document.querySelector(this.options.rootSelector)}},{key:"getRootBoundaryRect",value:function(){return this.getRootElement().getBoundingClientRect()}},{key:"getRightPanelWidth",value:function(){var e=this.options,n=this.layout,r=e.app,o=e.noCommentPanel;return(r===U.u.HISTORY?function(){return H.Z.isPhoneApp?0:x.u}:function(){if(!n)return 0;var e=n.comment.getHostRectCache();return!o&&Object(V.I)(F.store.getState())&&(null===e||void 0===e?void 0:e.width)||0})()}}]),e}(),Z=Object(I.h)("scrollable:useScrollTo"),Q=Object(I.e)("scrollable:useMouseHover");var $=r("dx_CqjN"),ee=Object(I.e)("scrollable:use-prevent-touch");function te(e){ee("cancelEvent(%s): cancel the event",e.type),e.stopPropagation(),e.preventDefault()}var ne=r("dx_f4fP");function re(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function oe(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?re(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var ie=Object(I.e)("scrollable:use-slider");var ce=function(e){var n,r,o=e.scrollManage,i=e.isNeedScrollBar,c=e.sliderOffset,l=e.sliderWidth,s=e.sliderRef,u=o.scrollModel,d=Object(_.useState)(void 0),f=a()(d,2),h=f[0],p=f[1],v=u.sliderMaxOffset,g=u.isShowScrollbar,b=Boolean(h),y=Object(S.r)((function(e){ie("handlePointerDown(%s), capture pointer and set startPosition(translateX=%s)",e.type,c),e.stopPropagation(),e.preventDefault(),Object($.U)(e);var n=Object(ne.C)(e);p({startSliderOffset:c,startPageX:n.pageX})})),m=Object(S.r)((function(e){if(h){var n=Object(ne.C)(e),r=function(e,n,r){var o=n-e.startPageX;return Object(T.clamp)(e.startSliderOffset+o,0,r)}(h,n.pageX,v),i=u.getScrollRatioBySliderOffset(r);o.scrollByRatio(i,!1,"slidermove"),function(){if(H.Z.isSafari){var e=window.getSelection();(null===e||void 0===e?void 0:e.rangeCount)&&e.empty()}}()}})),k=Object(S.r)((function(e){h&&(ie("handlePointerUp(%s), clear movingInfo",e.type),p(void 0))}));n=s.current,r=i,Object(_.useEffect)((function(){if(n&&r)return n.addEventListener("touchstart",te),function(){n.removeEventListener("touchstart",te)}}),[n,r]);var O=Object(_.useMemo)((function(){return{transform:"translateX(".concat(c,"px)"),width:l,opacity:g?1:0}}),[c,l,g]);return{sliderProps:oe(oe({},W.H.enableSliderDragging?{onPointerDown:y,onPointerMove:m,onPointerUp:k}:{}),{},{style:O}),isMoving:b}};var ae=Object(I.h)("scrollable:use-scrollbar"),le=function(e){var n=e.ctx,r=e.isShowLoading,o=e.scrollContainerWidth,i=e.scrollItemMaxLeft,c=e.hostElement,l=n.options,s=n.scrollManage,u=n.scrollModel,d=n.hookInstance,f=n.logId,h=l.scrollbarToBlock,p=Object(_.useState)(l.isNeedScrollBar),v=a()(p,2),g=v[0],b=v[1],y=Object(_.useRef)(null),O=Object(_.useRef)(null),x=function(e,n){var r=Object(_.useState)(null),o=a()(r,2),i=o[0],c=o[1],l=Object(S.r)((function(e){c(e),Q("setIsMouseHover to %s",e)}));return Object(_.useEffect)((function(){if(!H.Z.isIPad)if(n){if(e){var r=function(){return l(!0)},o=function(){return l(!1)};return e.addEventListener("mouseenter",r),e.addEventListener("mouseleave",o),function(){e.removeEventListener("mouseenter",r),e.removeEventListener("mouseleave",o)}}}else l(null)}),[e,n,l]),i}(c,g&&W.H.showScrollbarOnHover),E=function(e,n){var r=Object(_.useState)(null),o=a()(r,2),i=o[0],c=o[1];return Object(_.useEffect)((function(){if(n){var r=e.hookInstance,o=Object(T.debounce)((function(){return c(!1)}),300),i=function(){c(!0),o()},a=r.onScroll(i),l=r.onSubScroll(i);return function(){o.cancel(),a(),l()}}}),[e,n]),i}(s,g),C=u.sliderWidth,I=u.scrollbarWidth,B=u.sliderOffset;Object(_.useEffect)((function(){return d.onSetIsShowScrollBar(b)}),[d]);var w=ce({scrollManage:s,isNeedScrollBar:g,scrollbarWidth:I,sliderWidth:C,sliderOffset:B,sliderRef:y}),R=!r&&(x||E),M=w.sliderProps.style,j={display:R?void 0:"none",transform:"translateX(".concat(i,"px)"),bottom:W.H.sliderToBottom+W.H.sliderHeight+(h||0)};return ae(f,"isShow=%s(%s||%s), slider(width=%s, opacity=%s, offset=%s), isNeedScrollBar=%s",R,x,E,M.width,M.opacity,B,g),g&&k.a.createElement("div",{contentEditable:!1,style:j,className:"scrollable-scrollbar",ref:O},k.a.createElement("div",{className:"scrollable-scrollbar-padding",style:{height:h||void 0,width:o,transform:"translateX(".concat(-i,"px)")}}),k.a.createElement("div",Object.assign({className:m()("slider",{active:w.isMoving})},w.sliderProps,{ref:y})))};function se(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function ue(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?se(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):se(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var de=function(e){var n=Object(_.useRef)({}),r=function(){var e=Object(_.useRef)();return[e,function(){clearTimeout(e.current)}]}(),o=a()(r,2),i=o[0],c=o[1],l=Object(_.useCallback)((function(e){c(),(e?[n.current[e]]:Object.values(n.current)).forEach((function(e){"function"===typeof e&&e()})),i.current=setTimeout((function(){e?delete n.current[e]:n.current={}}),1e4)}),[]);return Object(_.useEffect)((function(){var r=e.hookInstance.onAfterRender((function(e){var r=e.key,o=e.value;n.current[r]=o,l(r)}));return function(){r()}}),[l]),l},fe=r("dx_NOtv"),he=r.n(fe),pe=r("dx_IwME"),ve=r("dx_S0Si"),ge=r("dx_Wwog"),be=function e(){s()(this,e),this.getMainMaxScrollLeft=Object(ge.S)((function(e,n,r){if(e&&n)return Math.max(0,e-n+r)})),this.getScrollItemMaxLeft=function(e,n){return e?n:0},this.getScrollItemLeft=function(e,n){return e-n},this.getScrollBarPos=function(e){if(!Object(T.isUndefined)(e)){var n=e.scrollLeft,r=e.clientWidth;return{isAtLeft:0===n,isAtRight:e.scrollWidth-(n+r)<1}}}},ye=["enableRightShadow","isNeedPaddingLeft","mainRawScrollLeft","scrollContainerWidth","scrollWrapperOffset","subRawScrollLeft","subScrollWidth","subScrollerLeftOffset","viewType"],me=function(){function e(){s()(this,e),this.scrollContainerWidth=0,this.scrollWrapperOffset=0,this.mainRawScrollLeft=0,this.subRawScrollLeft=0,this.subScrollWidth=void 0,this.subScrollerLeftOffset=0,this.enableRightShadow=void 0,this.isNeedPaddingLeft=void 0,this.viewType=void 0,this.helper=new be}return d()(e,[{key:"getCore",value:function(){return Object(T.pick)(this,[].concat(ye,["scrollRatio","isValidScrollLeft","mainMaxScrollLeft","mainScrollLeft","subMaxScrollLeft","subScrollLeft","totalMaxScrollLeft","totalScrollLeft","scrollbarWidth","maxScrollbarWidth"]))}},{key:"setScrollContainerWidth",value:function(e){this.scrollContainerWidth=e}},{key:"setScrollWrapperOffset",value:function(e){this.scrollWrapperOffset=e}},{key:"setSubScrollerLeftOffset",value:function(e){this.subScrollerLeftOffset=e}},{key:"setMainRawScrollLeft",value:function(e){this.mainRawScrollLeft=e}},{key:"setSubScrollState",value:function(e){this.subRawScrollLeft=e.scrollLeft,this.subScrollWidth=e.scrollWidth}},{key:"setIsNeedPaddingLeft",value:function(e){this.isNeedPaddingLeft=e}},{key:"setEnableRightShadow",value:function(e){this.enableRightShadow=e}},{key:"setViewType",value:function(e){this.viewType=e}},{key:"isModelReady",value:function(){return this.isReady}},{key:"getSubScrollStateByWidth",value:function(e){return{scrollLeft:this.subRawScrollLeft,scrollWidth:e}}},{key:"clampMainScrollLeft",value:function(e){var n=this.mainMaxScrollLeft;return Object(T.isUndefined)(n)?void 0:Object(T.clamp)(e,0,n)}},{key:"clampSubScrollLeft",value:function(e){var n=this.subMaxScrollLeft;return Object(T.isUndefined)(n)?void 0:Object(T.clamp)(e,0,n)}},{key:"clampScrollLeft",value:function(){var e=this.clampMainScrollLeft(this.mainScrollLeft),n=this.clampSubScrollLeft(this.subScrollLeft);return{mainScrollLeft:e,subScrollLeft:n,changed:e!==this.mainScrollLeft||n!==this.subScrollLeft}}},{key:"getMainScrollLeftAfterScroll",value:function(e){var n=this.mainScrollLeft,r=Object(T.isNumber)(e)?n+e:e.scrollLeft;return this.clampMainScrollLeft(r)}},{key:"getScrollLeftByRatio",value:function(e){var n=this.mainMaxScrollLeft,r=this.totalMaxScrollLeft;if(!Object(T.isUndefined)(n)&&!Object(T.isUndefined)(r)){var o=Math.round(r*e),i=Math.min(o,n);return{mainScrollLeft:i,subScrollLeft:o-i}}}},{key:"getScrollLeftByDistance",value:function(e){var n=this.totalScrollLeft,r=this.totalMaxScrollLeft,o=this.mainMaxScrollLeft;if(!(Object(T.isUndefined)(n)||Object(T.isUndefined)(r)||Object(T.isUndefined)(o))){var i=Object(T.clamp)(0,n+e,r),c=Math.min(i,o);return{mainScrollLeft:c,subScrollLeft:i-c}}}},{key:"getScrollRatioBySliderOffset",value:function(e){var n=this.sliderMaxOffset;return n?e/n:0}},{key:"getOffsetToShowRect",value:function(e,n){if(!this.isReady)return 0;var r=this,o=r.scrollContainerWidth,i=r.scrollItemMaxLeft,c=r.totalScrollLeft,a=20-i-(e-c),l=n-c-(o-i-20);return a>0&&l<0?-Math.min(a,Math.abs(l)):l>0&&a<0?Math.min(l,Math.abs(a)):0}},{key:"scrollByDistance",value:function(e){var n=this.getScrollLeftByDistance(e);n&&(this.setMainRawScrollLeft(n.mainScrollLeft),this.subRawScrollLeft=n.subScrollLeft)}},{key:"mainScrollLeft",get:function(){return Object(T.clamp)(this.mainRawScrollLeft,0,this.mainMaxScrollLeft||0)}},{key:"subScrollLeft",get:function(){return Object(T.clamp)(this.subRawScrollLeft,0,this.subMaxScrollLeft||0)}},{key:"mainMaxScrollLeft",get:function(){return this.helper.getMainMaxScrollLeft(this.scrollItemWidth,this.scrollContainerWidth,this.scrollItemMaxLeft)}},{key:"scrollItemMaxLeft",get:function(){return this.helper.getScrollItemMaxLeft(this.isNeedPaddingLeft,this.scrollWrapperOffset)}},{key:"scrollItemLeft",get:function(){return this.helper.getScrollItemLeft(this.scrollItemMaxLeft,this.mainScrollLeft)}},{key:"scrollItemWidth",get:function(){var e=this.subClientWidth,n=this.scrollContainerWidth;return Object(T.isUndefined)(e)?void 0:Math.min(e,n)}},{key:"totalMaxScrollLeft",get:function(){var e=this.subScrollWidth,n=this.scrollbarWidth;return Object(T.isUndefined)(n)||Object(T.isUndefined)(e)?void 0:e-n}},{key:"isScrollable",get:function(){var e=this.totalMaxScrollLeft;return Object(T.isUndefined)(e)?void 0:e>0}},{key:"isReady",get:function(){return Boolean(this.subScrollWidth&&this.scrollContainerWidth)}},{key:"isRightShadowVisible",get:function(){return this.enableRightShadow&&!1===this.isAllScrollToEnd}},{key:"totalScrollLeft",get:function(){var e=this.mainScrollLeft,n=this.subScrollLeft;return Object(T.isUndefined)(n)?void 0:e+n}},{key:"scrollRatio",get:function(){var e=this.totalScrollLeft,n=this.totalMaxScrollLeft;if(!Object(T.isUndefined)(e)&&!Object(T.isUndefined)(n))return n&&e/n}},{key:"maxScrollbarWidth",get:function(){return this.scrollContainerWidth-this.scrollItemMaxLeft}},{key:"scrollbarWidth",get:function(){var e=this.subScrollWidth,n=this.maxScrollbarWidth;return Object(T.isUndefined)(e)?void 0:Math.min(e,n)}},{key:"sliderWidth",get:function(){var e=this.scrollbarWidth,n=this.subScrollWidth;if(!n||!e)return 0;var r=Math.round(e*e/n);return Math.max(r,W.H.sliderMinWidth)}},{key:"sliderMaxOffset",get:function(){var e=this.scrollbarWidth,n=this.sliderWidth;return Object(T.isUndefined)(e)?0:e-n}},{key:"sliderOffset",get:function(){var e=this.sliderMaxOffset,n=this.scrollRatio;return Object(T.isUndefined)(e)||Object(T.isUndefined)(n)?0:Math.round(e*n)}},{key:"isShowScrollbar",get:function(){var e=this.subScrollWidth,n=this.maxScrollbarWidth;return!Object(T.isUndefined)(e)&&e>n}},{key:"isMainScrollToEnd",get:function(){var e=this.mainScrollLeft,n=this.mainMaxScrollLeft;if(!Object(T.isUndefined)(e)&&!Object(T.isUndefined)(n))return n-e<1}},{key:"isAllScrollToEnd",get:function(){var e=this.totalScrollLeft,n=this.totalMaxScrollLeft;if(!Object(T.isUndefined)(e)&&!Object(T.isUndefined)(n))return n-e<1}},{key:"hasMainScroll",get:function(){var e=this.mainScrollLeft;return Object(T.isUndefined)(e)?void 0:e>0}},{key:"subMaxClientWidth",get:function(){var e=this.scrollContainerWidth,n=this.subScrollerLeftOffset;return e?e+n:void 0}},{key:"subClientWidth",get:function(){var e=this.subMaxClientWidth,n=this.subScrollWidth;return Object(T.isUndefined)(e)||Object(T.isUndefined)(n)?void 0:Math.min(e,n)}},{key:"subMaxScrollLeft",get:function(){var e=this.subScrollWidth,n=this.subClientWidth;return Object(T.isUndefined)(e)||Object(T.isUndefined)(n)?void 0:e-n}},{key:"subScrollStatus",get:function(){var e=this.subScrollLeft,n=this.subScrollWidth,r=this.subClientWidth;return Object(T.isUndefined)(n)||Object(T.isUndefined)(r)?void 0:{scrollLeft:e,scrollWidth:n,clientWidth:r}}},{key:"mainScrollStatus",get:function(){var e=this.mainMaxScrollLeft,n=this.mainScrollLeft,r=this.scrollContainerWidth;if(r&&!Object(T.isUndefined)(e))return{scrollLeft:n,scrollWidth:r+e,clientWidth:r}}},{key:"mainScrollbarPosition",get:function(){return this.helper.getScrollBarPos(this.mainScrollStatus)}},{key:"subScrollbarPosition",get:function(){return this.helper.getScrollBarPos(this.subScrollStatus)}},{key:"isValidScrollLeft",get:function(){return this.mainScrollLeft===this.mainRawScrollLeft&&this.subScrollLeft===this.subRawScrollLeft}}]),e}(),_e=r("dx_j92N"),ke=(r("dx_Hc56"),Object(I.h)("scrollable:scrollManage")),Oe=function(){function e(n){var r=this;s()(this,e),this.hookInstance=Object(ve.N)(this),this.utils=void 0,this.containerRef=void 0,this.options=void 0,this.isNeedNativeScroll=!1,this.destroyCallbackList=[],this.lastTouchTurnInfo={touchEventId:void 0,isNeedMainScroll:!1},this.scrollModel=new me,this.vcSyncManager=void 0,this.logId=void 0,this.scrollableContext=void 0,this.init=function(){r.destroyCallbackList=[r.utils.addWheel(r.containerRef.current,r.handleWheel),r.hookInstance.onIsNeedNativeScrollChange((function(e){r.isNeedNativeScroll=e}))]},this.checkIsNeedNativeScroll=function(n){if(r.isNeedNativeScroll)return{nativeScroll:!0,reason:"isNeedNativeScroll"};if(n.shiftKey)return{nativeScroll:!1,reason:"shift"};return e.lockVertical.getValue()||r.utils.checkIfMainlyVertical(n)?{nativeScroll:!0,reason:"verticalScroll"}:!1===r.options.enableNativeSubScroll?{nativeScroll:!1,reason:"enableNativeSubScroll=false"}:{nativeScroll:!r.scrollModel.mainMaxScrollLeft,reason:"checkMainScroll"}},this.handleWheel=function(e){var n=r.options.enableNativeSubScroll;r.hookInstance.setAfterRender({key:"scrollHorizontal",value:T.noop});var o=r.checkIsNeedNativeScroll(e),i=o.nativeScroll,c=o.reason;if(ke(r.logId,"handleWheel(%s), nativeScroll=%s(%s)",e.type,i,c),!0!==i){var a=r.utils.getDeltaX(e);if(0!==a){var l=r.scrollModel,s=l.mainScrollbarPosition,u=l.subScrollbarPosition;if(s&&u){var d=r.utils.checkIfHorizontalLeft(a),f=!d,h=s.isAtLeft,p=s.isAtRight,v=u.isAtLeft,g=u.isAtRight,b=!h&&v&&d||!p&&f,y=!b&&(!v&&d||!g&&f),m=y&&!0===n,_=e.touchEventId,k=r.lastTouchTurnInfo.touchEventId===_,O=!(!_||!k)&&r.lastTouchTurnInfo.isNeedMainScroll;_&&!k&&(r.lastTouchTurnInfo={touchEventId:_,isNeedMainScroll:b});var x=m&&!O;ke(r.logId,"handleWheel(%s), needScroll(main=%s, sub=%s), moveLeft=%s, deltaX=%s, atLeft/atRight(main=%s/%s, sub=%s/%s), nativeSubScroll=%s(enable=%s,raw=%s,lastIsNeedMainScroll=%s)",e.type,b,y,d,a,h,p,v,g,x,n,m,O),x||(b?r.hookInstance.executeScroll(a,"handleWheel"):y&&r.hookInstance.executeSubScroll(a,"handleWheel"),(b||y)&&e.stopPropagation(),e.cancelable&&e.preventDefault())}else ke(r.logId,"skip, not ready")}else ke(r.logId,"skip, no deltaX")}},this.destroy=function(){var e;r.destroyCallbackList.forEach((function(e){return e()})),r.destroyCallbackList=[],r.hookInstance.destroy(),null===(e=r.vcSyncManager)||void 0===e||e.destroy()};var o=n.options,i=n.blockManager,c=n.vcController,a=n.model,l=n.logId,u=o.enableVcOptions;this.utils=new _e.l(o),this.containerRef=n.containerRef,this.options=n.options,this.logId=l,c&&u&&(this.vcSyncManager=new pe.U({scrollManage:this,vcController:c,enableVcOptions:u,blockManager:i,model:a,logId:l})),this.scrollableContext={options:o,blockManager:i,scrollManage:this,hookInstance:this.hookInstance,scrollModel:this.scrollModel,blockId:a.id,recordId:a.recordId,logId:l}}return d()(e,[{key:"getScrollContainer",value:function(){return this.containerRef.current}},{key:"scrollByRatio",value:function(e,n,r){var o=this.scrollModel,i=o.getScrollLeftByRatio(e);if(i){var c=o.scrollRatio,a=o.isScrollable;if(n||c!==e)if(a){var l=i.mainScrollLeft,s=i.subScrollLeft;ke(this.logId,"%s.scrollByRatio: %s, main/sub=%s/%s",r,e,l,s),this.scroll(l,s,r||"scrollByRatio")}else ke(this.logId,"%s.scrollByRatio(%s): skip due to unscrollable",r,e);else ke(this.logId,"%s.scrollByRatio(%s), skip due to the same ratio",r,e)}else ke(this.logId,"scrollByRatio: skip, not ready")}},{key:"scrollByDistance",value:function(e,n){var r=this.scrollModel.getScrollLeftByDistance(e);if(r){var o=r.mainScrollLeft,i=r.subScrollLeft;ke(this.logId,"%s.scrollByDistance: %s, main/sub=%s/%s",n,e,o,i),this.scroll(o,i,n||"scrollByDistance")}else ke(this.logId,"%s.scrollByDistance: skip, not ready",n)}},{key:"resyncScroll",value:function(e){var n=this.scrollModel.clampScrollLeft(),r=n.mainScrollLeft,o=n.subScrollLeft,i=n.changed;if(!Object(T.isUndefined)(r)&&!Object(T.isUndefined)(o)){var c=this.vcSyncManager;if(null===c||void 0===c?void 0:c.canReplay()){var a=c.getLastOffsetRatio();void 0!==a&&this.scrollByRatio(a,!0,"".concat(e,".resyncScroll"))}else{(i||r||o)&&this.scroll(r,o,"".concat(e,".resyncScroll"))}}}},{key:"scroll",value:function(e,n,r){var o=this.hookInstance;ke(this.logId,"%s.scroll: scrollLeft=%s + %s",r,e,n),o.executeScroll({scrollLeft:e},r),o.executeSubScroll({scrollLeft:n},r)}}]),e}();Oe.lockVertical=Object(_e.l9)(!1,200);var xe=he()("useScrollLock"),Ee=0,Se=function(){return Oe.lockVertical.resetValue(!0)},Ce=r("dx_WmT0"),Ie={},Be={zIndex:N.f},Te=[z.B.SHEET],we=r("dx_K3oP"),Re=r("dx_MGAW"),Me=r("dx_YCIe"),je=Object(I.h)("scrollable:use-vc-sync");Object(Re.U)(Me.IK);r("dx_y7Um");function De(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Ae(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?De(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):De(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Pe(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Le=Object(I.h)("scrollable:index"),Ne=function(e){h()(r,e);var n=Pe(r);function r(e){var o;return s()(this,r),(o=n.call(this,e)).layoutHelper=void 0,o.layoutHelper=new J(e,e.layout),o}return d()(r,[{key:"getWrapper",value:function(e){var n=this,r=this.options,o=r.isClipLeft,c=r.app;return function(l){var s,u=n.blockManager,d=n.vcController,f=l.isShowLoading,h=l.recursionProps,p=h.layout,v=h.boundary,g=h.isHistory,b=l.hostElementRef.current,y=l.model,I=y.id,M=y.type,F=y.recordId,U="".concat(M,"=").concat(I," "),V=null===(s=window[x.V])||void 0===s?void 0:s[F],W=Object(_.useState)((null===V||void 0===V?void 0:V.width)||0),G=a()(W,2),K=G[0],q=G[1],X=Object(_.useState)((null===V||void 0===V?void 0:V.margin)||0),J=a()(X,2),Q=J[0],$=J[1],ee=Object(_.useState)(!0),te=a()(ee,2),ne=te[0],re=te[1],oe=Object(_.useRef)(null),ie=Object(_.useRef)(null),ce=Y(c,y),ae=ce.isKeepBoundary,se=ce.indentWidth,fe=function(e){var n=Object(_.useMemo)((function(){return new Oe(e)}),[]);return Object(_.useLayoutEffect)((function(){return n.init(),function(){return n.destroy()}}),[n]),{scrollManage:n}}({containerRef:oe,options:r,blockManager:u,vcController:d,model:y,logId:U}),he=fe.scrollManage,pe=he.hookInstance,ve=he.scrollModel,ge=he.scrollableContext;ve.setScrollContainerWidth(K),ve.setScrollWrapperOffset(Q),ve.setIsNeedPaddingLeft(ne);var be=ve.isAllScrollToEnd,ye=ve.isMainScrollToEnd,me=ve.hasMainScroll,_e=ve.scrollItemLeft,ke=ve.scrollItemMaxLeft,Re=ve.isReady,De=function(e){var n=Object(_.useState)(""),r=a()(n,2),o=r[0],i=r[1];return Object(_.useEffect)((function(){var n=e.hookInstance.onSetWrapperClass((function(e){i(e)}));return function(){n()}}),[e.hookInstance]),o}(he),Pe=Object(O.useSelector)(C.E),Ne=de(he),Fe=Object(S.r)((function(){var e=b.getBoundingClientRect().width;if(e){var r=n.layoutHelper.calcLayout(Pe,ae,se,e,Object(R.M)(l),U);q(r.scrollContainerWidth),$(r.scrollWrapperOffset),Ne()}})),Ue=Object(E.S)(Fe,100,{leading:!0});Object(_.useLayoutEffect)((function(){var e;ae||f||(null===(e=n.options.rectForFixed)||void 0===e||e.pushBlockId(I,oe));return function(){var e;null===(e=n.options.rectForFixed)||void 0===e||e.deleteBlockId(I)}}),[I,ae,f]),function(e){Object(_.useEffect)((function(){return Ee<1&&(e.addEventListener("scroll",Se),xe("add")),Ee++,function(){--Ee<1&&(e.removeEventListener("scroll",Se),xe("remove"))}}),[])}(v),Object(_.useEffect)((function(){Pe!==j.h.NONE&&Ue()}),[Pe,Ue]),Object(_.useEffect)((function(){if(p){Le(U,"debounceCalculate and add listeners for debounceCalculate");var e=function(){p.comment.getHostRectCache(),requestAnimationFrame(Ue)};Ue(),n.blockManager.addListener(P.G,Ue),n.blockManager.addListener(L.r,Ue,I),D.N.addListener(N.o.ON_CATALOGUE_RECT_CHANGE,Ue),D.N.on(A.g.DOC_COMMENT_SHOW_CHANGE,e),window.addEventListener("resize",Ue);var r=[p.catalogue.onLayoutChange(Ue),pe.onGridChange(Ue)];return function(){n.blockManager.removeListener(P.G,Ue),n.blockManager.removeListener(L.r,Ue,I),D.N.removeListener(N.o.ON_CATALOGUE_RECT_CHANGE,Ue),D.N.removeListener(A.g.DOC_COMMENT_SHOW_CHANGE,e),window.removeEventListener("resize",Ue),r.forEach((function(e){return e()}))}}}),[Ue,p,pe,I,U]),Object(_.useEffect)((function(){Le(U,"add listeners");var e=function(){return D.N.emit(N.o.ON_SCROLL,void 0,I)},n=[pe.onSubScroll(e),pe.onScroll((function(){e(),we.f.mainScroll$.next(I)})),pe.onIsNeedPaddingLeft((function(e){re(e),we.f.paddingChange$.next(I)}))];return function(){return n.forEach((function(e){return e()}))}}),[pe,I,M,U]),function(e){var n=e.logId,r=e.hookInstance,o=e.scrollModel,i=Object(_.useState)(void 0),c=a()(i,2),l=c[0],s=c[1],u=Object(_.useState)(void 0),d=a()(u,2)[1],f=Object(S.r)((function(e,r){Object(T.isEqual)(l,e)||(o.setSubScrollState(e),w(n,"%s.updateSubScrollState: %o",r,e),s(e))})),h=Object(S.r)((function(e){o.viewType!==e&&(w(n,"updateViewType: %o",e),o.setViewType(e),d(e))}));Object(_.useEffect)((function(){var e=[r.onSubScroll((function(e){return f(e,"subScroll")})),r.onSubViewChange((function(e){var n=e.width,r=e.viewType;f(o.getSubScrollStateByWidth(n),"subViewChange"),r&&h(r)}))];return function(){e.forEach((function(e){return e()}))}}),[r,f,h,o,n])}(ge),function(e){var n=e.ctx,r=n.scrollManage,o=n.blockManager,i=n.blockId,c=n.logId,l=r.hookInstance,s=r.scrollModel,u=Object(_.useState)(0),d=a()(u,2)[1],f=Object(_.useRef)(),h=Object(S.r)((function(e,n){var r=s.clampMainScrollLeft(e);Object(T.isUndefined)(r)?Z(c,"%s: skip, not ready",n):s.mainScrollLeft!==r&&(s.setMainRawScrollLeft(r),d(r))})),p=Object(S.r)((function(e,n){var r=s.getMainScrollLeftAfterScroll(e);Object(T.isUndefined)(r)||(f.current=n,Z(c,"%s.executeScroll to %s, distance=%o",n,r,e),h(r,"".concat(n,".executeScroll")))}));Object(_.useEffect)((function(){var e=[l.registerScroll(p)],n=function(){return r.resyncScroll("enterbuffer")};return o.addListener(L.r,n,i),function(){f.current=void 0,e.forEach((function(e){return e()})),o.removeListener(L.r,n,i)}}),[i,o,p,r,l,c]),Object(_.useEffect)((function(){var e=s.mainScrollStatus;e&&l.emitScroll(e,f.current)}),[l,s.mainScrollLeft,s]),s.mainScrollLeft}({ctx:ge,isShowLoading:f,isNeedPaddingLeft:ne,scrollItemMaxLeft:ke}),function(e){var n=e.ctx,r=e.itemRef,o=n.scrollModel,i=n.logId,c=o.subScrollWidth,a=Object(E.S)((function(){var e=r.current;if(e){B(i,"hack: set opacity to force render");var n=e.style.opacity;e.style.opacity="0.99",setTimeout((function(){return e.style.opacity=n}))}}),0);Object(_.useEffect)((function(){return a(),function(){return a.cancel()}}),[c,a])}({ctx:ge,itemRef:ie}),function(e){var n=e.ctx,r=n.logId,o=n.scrollManage,i=n.recordId,c=Object(_.useRef)(n),a=o.scrollModel,l=o.vcSyncManager,s=a.isReady,u=a.scrollContainerWidth,d=a.subScrollWidth,f=Object(E.S)((function(e){null===l||void 0===l||l.calcAndSendScrollState(i,e)}),Me.X),h=Object(E.S)((function(e){return null===l||void 0===l?void 0:l.replayLast(e)}),Me.p);Object(_.useEffect)((function(){if(l){var e=c.current,n=e.blockManager,o=e.blockId,i=e.hookInstance,a=function(){return h("handleEnterBuffer")};je(r,"add listeners"),n.addListener(L.r,a,o);var s=[i.onScroll((function(e,n){return f(n)})),i.onSubScroll((function(e,n){return f(n)})),i.onSubViewChange((function(e){return f("subViewChange")}))];return function(){je(r,"remove listeners"),n.removeListener(L.r,a,o),s.forEach((function(e){return e()})),h.cancel()}}}),[f,l,h,r]),Object(_.useEffect)((function(){if(s&&(null===l||void 0===l?void 0:l.canReplay()))return je(r,"replay last due to widthChange(scrollContainerWidth=%s, subScrollWidth=%s)",u,d),h("widthChange"),function(){return h.cancel()}}),[u,d,h,l,s,r]),Object(_.useEffect)((function(){if(l){if(s)return l.init(),function(){return l.destroy()};l.destroy()}}),[s,o,l])}({ctx:ge,vcController:d,model:y});var He=!0!==be,Ve=!ae&&!g&&o,We=function(e){var n=e.scrollManage,r=e.options,o=Object(_.useState)(r.enableRightShadow),i=a()(o,2),c=i[0],l=i[1],s=Object(_.useState)({}),u=a()(s,2),d=u[0],f=u[1],h=n.scrollModel,p=n.hookInstance;h.setEnableRightShadow(c);var v=h.isRightShadowVisible;return Object(_.useEffect)((function(){var e=[p.onShadowStyleChange((function(e){return f((function(n){return Object(T.isEqual)(e,n)?n:e}))})),p.onShadowChange(l)];return function(){return e.forEach((function(e){return e()}))}}),[p]),{renderShadow:Object(_.useMemo)((function(){return k.a.createElement("div",{className:m()("right-shadow shadow",{visible:v}),style:ue({transition:v?"":"left 0.1s"},d)})}),[v,d])}}(ge),ze=We.renderShadow,Ge=le({ctx:ge,isShowLoading:f,scrollContainerWidth:K,scrollItemMaxLeft:ke,hostElement:b});!function(e,n,r){Object(_.useEffect)((function(){if(e&&H.Z.isIPad&&[z.B.SHEET].includes(n)){var o=function(e){r||e.stopPropagation()};return e.addEventListener("pointerdown",o,!0),function(){e.removeEventListener("pointerdown",o,!0)}}}),[e,n,r])}(oe.current,M,ae),Le.enabled&&Le(U,"scrollToEnd(main=%s, all=%s), finalClipLeft=%s, isKeepBoundary=%s, ratio=%s, model=%o",ye,be,Ve,ae,ve.scrollRatio,ve.getCore());var Ke=function(e,n){var r=Object(_.useState)({}),o=a()(r,2),i=o[0],c=o[1];return Object(_.useEffect)((function(){var r=e.current,o=null===r||void 0===r?void 0:r.querySelector(".".concat(N.z)),i=Te.includes(n),a=function(){c(Be)},l=function(e){var r=e.target,i=e.path||e.composedPath&&e.composedPath()||[];if(n===z.B.SHEET){var a=document.querySelector(".block-toolbar__overlay");if(a&&r&&a.contains(r))return}o&&r&&(i.some((function(e){return o===e}))||o.contains(r)||c(Ie))};return o&&i&&(o.addEventListener("click",a),Ce.S.addListener(l)),function(){o&&i&&(o.removeEventListener("click",a),Ce.S.removeListener(l))}}),[e.current]),i}(oe,M);!function(e,n){var r=n.current,o=function(){if(r){var n=r.scrollLeft;n>0&&(r.scrollLeft=0,e.hookInstance.executeScroll(n,"useScrollForInput"))}};Object(_.useEffect)((function(){if(r)return r.addEventListener("scroll",o),function(){r.removeEventListener("scroll",o)}}),[r])}(he,oe);var qe=m()(N.n,i()({"scrollable-mainscroll-end":!0===ye,"scrollable-allscroll-end":!0===be,"scrollable-has-mainscroll":me},De,Boolean(De))),Xe=m()(N.M,i()({"clip-left":Ve,"clip-right":He},N.s,Re)),Ye={scrollContainerWidth:K,scrollManage:pe,scrollItemMaxLeft:ke,isKeepBoundary:ae};return k.a.createElement("div",{style:{width:K,left:-Q},className:qe},k.a.createElement("div",{style:Ae({width:K},Ke),className:Xe,ref:oe},k.a.createElement("div",{className:N.z,style:{left:_e},ref:ie},k.a.createElement(e,Object.assign({},l,Ye))),ze),Ge,k.a.createElement("div",{className:"scrollable-slot",style:{left:_e},contentEditable:!1}))}}}],[{key:"getDefaultProps",value:function(e){var n=e.app;return{enableRightShadow:!0,isNeedScrollBar:!0,isClipLeft:!1,scrollbarToBlock:0,subScrollerLeftOffset:0,enableNativeSubScroll:"auto",ignoreScrollClasses:[],rootSelector:".".concat(x.b3.ROOT),noCommentPanel:!1,app:n}}}]),r}(M.A)},dx_zEdG:function(e,n,r){"use strict";r.d(n,"M",(function(){return f})),r.d(n,"p",(function(){return h})),r.d(n,"T",(function(){return p})),r.d(n,"P",(function(){return v}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_UtDZ"),a=r("dx_h6a8"),l=r("dx_dIhn");function s(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function u(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?s(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function d(e){if(!Object(a.isPlainObject)(e))return e;var n=u({},e);return n.block_id&&(n.block_id=Object(c.encryptTea)(n.block_id)),n.object_block_id&&(n.object_block_id=Object(c.encryptTea)(n.object_block_id)),n}function f(e){return e.block_id=e.record_id,delete e.record_id,e}function h(e){return d(f(e))}var p=function(e,n,r){Object(l.f)((function(){Object(c.collectEvent)(e,Object.assign({},h(n),r))}))},v=function(e,n,r){Object(l.f)((function(){var o=u(u({},r),{},{target:r.target||"none"});Object(c.collectEvent)(e,Object.assign({},h(n),d(o)))}))}},dx_zJC7:function(e,n,r){"use strict";(function(t){r.d(n,"S",(function(){return m}));var e=r("dx_o0o1"),o=r.n(e),i=r("dx_yXPU"),c=r.n(i),a=r("dx_J4zp"),l=r.n(a),s=r("dx_PcQO"),u=r("dx_cDcd"),d=r.n(u),f=r("dx_D4DL"),h=r("dx_PQBD"),p=r("dx_zEdG"),v=r("dx_CwnG"),g=r("dx_C4C6"),b="heading-modify-input",y="HEADING-MODIFY-INPUT";function m(e){var n=e.blockManager,r=e.headingModule,i=e.blockId,a=e.recordId,m=e.order,_=e.updateVisible,k=Object(u.useMemo)((function(){return n.getBlockModelByBlockId(i)}),[n,i]),O=Object(g.y)(m),x=O.seqNumber,E=O.seqPrefix,S=Object(u.useState)(x),C=l()(S,2),I=C[0],B=C[1],T=Object(u.useRef)(x);Object(u.useEffect)((function(){var e=function(e){e.stopPropagation()},n=document.getElementById(y);return null===n||void 0===n||n.addEventListener("mousemove",e),function(){null===n||void 0===n||n.removeEventListener("mousemove",e)}}),[i]);var w=Object(u.useCallback)((function(){var e=Object(v.m)(i,n);Object(p.P)("ccm_doc_ordered_set_number_click",e,{click:"click_confirm_edit_number",sub_view:"heading"})}),[n,i]),R=Object(u.useCallback)(c()(o.a.mark((function e(){var i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=E?"".concat(E).concat(T.current):"".concat(T.current,"."),!T.current||!i||i===m){e.next=4;break}return e.next=4,n.applyTransaction("heading:modify:update",(function(e){e.replace(a,["seq"],T.current);var n=Object(h.V)(k.type),o=null===r||void 0===r?void 0:r.hasParent(k);""===E&&1!==n&&o&&(k.record.get(["seq_level"])?e.replace(a,["seq_level"],"1"):e.insert(a,["seq_level"],"1"));null===r||void 0===r||r.renumber(k,!1)}));case 4:_(!1),w();case 6:case"end":return e.stop()}}),e)}))),[n,i,w]);return d.a.createElement("div",{className:"".concat(b),id:y},d.a.createElement("span",{className:"".concat(b,"-title")},t("CreationDoc_Docs_AutoNumberHeadings_CurrentValue")),d.a.createElement("span",{className:"".concat(b,"-custom-order")},d.a.createElement("span",null,E),d.a.createElement(f.S,{defaultValue:function(){var e=parseInt(I,10);return Number.isNaN(e)?1:e}(),min:1,max:999999999,onChange:function(e){B(e.toString()),T.current=e.toString()},onPressEnter:R,formatter:function(e){return"".concat(e)},parser:function(e){return parseInt(e,10)},checker:function(e){return/^[0-9]*$/.test(e)}})),d.a.createElement(s.Button,{className:"".concat(b,"-btn"),type:"primary",disabled:!I,onClick:R},t("common.determine")))}}).call(this,r("dx_E9Eu"))},dx_zKF3:function(e,n,r){"use strict";var o=r("dx_lwsE"),i=r.n(o),c=r("dx_W7W2"),a=r.n(c),l=r("dx_a1gu"),s=r.n(l),u=r("dx_Nsbk"),d=r.n(u),f=r("dx_Vvd7"),h=r("dx_N9dL"),p=r("dx_B28d"),v=r("dx_fEKD");var g,b,y,m=r("dx_vWE0"),_=r("dx_kGKL");function k(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=d()(e);if(n){var i=d()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return s()(this,r)}}var O=(g=Object(f.H)({providers:[{provide:h.RecordSnapshotCreator,useValue:{type:p.B.CHAT_CARD,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:p.B.CHAT_CARD;return Object(v.b)(e,n)}}}]}),g((y=function(e){a()(r,e);var n=k(r);function r(){var e;i()(this,r);for(var o=arguments.length,c=new Array(o),a=0;a<o;a++)c[a]=arguments[a];return(e=n.call.apply(n,[this].concat(c))).blocks=[[m.S,{viewCreator:_.S}]],e}return r}(f.y),b=y))||b),x=O;n.S=x},dx_zghO:function(e,n,r){"use strict";r.d(n,"i",(function(){return Gt})),r.d(n,"j",(function(){return P.j})),r.d(n,"q",(function(){return P.q}));var o=r("dx_lSNA"),i=r.n(o),c=r("dx_lwsE"),a=r.n(c),l=r("dx_W8MJ"),s=r.n(l),u=r("dx_iWIM"),d=r.n(u),f=r("dx_W7W2"),h=r.n(f),p=r("dx_a1gu"),v=r.n(p),g=r("dx_Nsbk"),b=r.n(g),y=r("dx_Vvd7"),m=r("dx_NOtv"),_=r.n(m),k=r("dx_h6a8"),O=r("dx_yzqx"),x=r("dx_SreQ"),E=r("dx_Fimk"),S=r("dx_k9kc"),C=r("dx_rldU"),I=r("dx_dIhn"),B=r("dx_B28d"),T=r("dx_iw8O"),w=r("dx_D8nn"),R=r("dx_awlV"),M=r("dx_qHDV"),j=r("dx_s04s"),D=r("dx_Jl0O"),A=r("dx_FNDK"),P=r("dx_P58d");function L(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var N,F=function(e){h()(r,e);var n=L(r);function r(e,o,i,c){var l;return a()(this,r),(l=n.call(this,e)).options=e,l.blockManager=o,l.rect=i,l.context=c,l.forward=!0,l}return s()(r,[{key:"elementToModel",value:function(e){var n=Object(T.S)(e);if(!n)throw new Error("blockId not found with element");return{id:n,type:P.j.BLOCK}}},{key:"modelToElement",value:function(e){var n=this.blockManager.getBlockViewByBlockId(e.id);if(!n)throw new Error("block not found: ".concat(e.id));return n.hostElement}},{key:"modelToRect",value:function(e){if(!!!this.blockManager.getRecordByBlockId(e.id))throw new Error("block not found: ".concat(e.id));return Object(D.w)(this.rect.getOriginBlockRect(e.id))}},{key:"isModelEqual",value:function(e,n){return e.id===n.id&&e.type===n.type}},{key:"isModelStrictEqual",value:function(e,n){return Object(k.isEqual)(e,n)}},{key:"includes",value:function(e,n){return this.indexOf(e,n)>-1}},{key:"indexOf",value:function(e,n){for(var r=0;r<e.length;r++)if(this.isModelEqual(e[r],n))return r;return-1}},{key:"isSingleTextSelection",value:function(e){return Object(A.m)(e)}},{key:"isBlockSelection",value:function(e){return Object(A.e)(e)}},{key:"isTextSelectionAcrossBlocks",value:function(e){return Object(A.L)(e)}},{key:"isHybridSelection",value:function(e){return Object(A.X)(e)}},{key:"isCursor",value:function(e){return Object(A.Z)(e)}},{key:"getClonedSelection",value:function(){return this.getSelection().map((function(e){var n=e.id,r=e.type,o=e.selection,i={id:n,type:r};if(o){var c=o.start,a=o.end;i.selection={start:c,end:a}}return i}))}}]),r}(M.W),U=_()("docx:ChainManager"),H=function(){function e(){a()(this,e),this.next=void 0,this.desc=void 0}return s()(e,[{key:"main",value:function(e,n){return!0}},{key:"setNext",value:function(e){this.next=e}},{key:"handle",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;U("handle:".concat(r,":").concat(this.desc));var o=this.main(e,n);return!1!==o&&(this.next?this.next.handle(e,o,r+1):o)}}]),e}(),V=function(){function e(n){a()(this,e),this.chainNodes=[],this.connect(n)}return s()(e,null,[{key:"create",value:function(n){return new e(n)}}]),s()(e,[{key:"connect",value:function(e){this.chainNodes=e.map((function(e){return new e}));for(var n=0;n<this.chainNodes.length;n++){var r=this.chainNodes[n],o=this.chainNodes[n+1];o&&r.setNext(o)}}},{key:"process",value:function(e,n){if(!this.chainNodes.length)throw new Error("no chain node found");return this.chainNodes[0].handle(e,n)}}]),e}(),W=r("dx_lZWw"),z=r("dx_rQGm");function G(e){var n=e.blockManager.layoutManager.getViewportBlocks(),r=document.querySelector(".".concat(z.b3.ROOT)),o=(null===r||void 0===r?void 0:r.getBoundingClientRect())||{top:0,bottom:window.innerHeight},i=n[0],c=e.rect.getOriginBlockRect(i),a=n[n.length-1],l=e.rect.getOriginBlockRect(a);n.forEach((function(n){var r=e.rect.getOriginBlockRect(n);r.top<c.top&&r.top>=o.top&&(i=n,c=r),r.top>l.top&&r.top<=o.bottom&&(a=n,l=r)}));var s=c.top,u=i===a?l.bottom:l.top;return{first:{id:i,y:s},last:{id:a,y:u}}}function K(e,n,r){var o=r.getBlockPath(e);o.push(e);for(var i=null;o.length;){var c=o.pop();if(r.getBlockModelByBlockId(c).type===n){i=c;break}}return i}function q(e,n){return e.debug("[resolveException] %s",n),e.finishReason=n,e.resolveStatus=N.FINISH_EXCEPTION,!1}function X(e,n){return e.debug(n),e.resolveStatus=N.FINISH_IGONORE,!1}function Y(e,n,r,o){return r&&(e.resolveStatus=N.RELATION_SOLVED),Object(k.isEqual)(e.matchedIds,n)||(e.debug("resolveUpdateMatchIds: %s, reason=%s",n,o),e.matchedIds=n),!0}function J(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}!function(e){e[e.DEFAULT=0]="DEFAULT",e[e.RELATION_SOLVED=1]="RELATION_SOLVED",e[e.FINISH_IGONORE=2]="FINISH_IGONORE",e[e.FINISH_EXCEPTION=3]="FINISH_EXCEPTION",e[e.FINISH_SUCCESS=4]="FINISH_SUCCESS",e[e.FINISH_EMPTY=5]="FINISH_EMPTY"}(N||(N={}));var Z=function(e){h()(r,e);var n=J(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).desc="\u8ba1\u7b97target\u5bf9\u5e94\u7684blockId",e}return s()(r,[{key:"main",value:function(e,n){var r=n.x,o=n.y,i=n.target,c=Object(T.S)(i),a=c;if(!(c=c||Object(T.Q)(r,o,!1)))return q(e,"fail to resolve block after round-1 fixing, skip");var l=Boolean(e.targetIds.length),s=e.blockManager.rootBlockId,u=c===s,d=!1;if(u&&Object(W.X)({ancestorId:s,y:o,blockManager:e.blockManager,rect:e.rect})&&(e.debug("\u547d\u4e2d\u6839\u8282\u70b9\u662f\u56e0\u4e3a\u843d\u5728\u95f4\u9699\u4e2d"),d=!0),u&&!d){var f=c;c=this.findClosestBlockIdWhenHitBoundary(e,l),e.debug("fix block: %s => %s",f,c)}if(!c)return q(e,"fail to resolve block after round-2 fixing, skip");var h=e.blockSelection.selectionContext,p=h.endX,v=h.endY;if(!l&&u&&d&&(e.debug("\u4fee\u6b63\u8d77\u59cb\u8282\u70b9\u662f\u6839\u8282\u70b9\u4e14\u843d\u5728\u7f1d\u9699\u4e2d\u7684case"),c=Object(T.Q)(p,v)||c),l&&u&&d)return e.resolveStatus=N.FINISH_IGONORE,!1;var g=function(n){var r=e.blockManager.getBlockModelByBlockId(n).type;return"".concat(r,"-").concat(n)};e.targetIds.push(c);var b=e.targetIds.map(g);return e.debug("resolved block: %s, unfixed=%s, point=(%s,%s), target=%o",b.join("=>"),a&&g(a),r,o,i),{targetIds:e.targetIds}}},{key:"findClosestBlockIdWhenHitBoundary",value:function(e,n){var r=G(e);if(r){var o=e.blockSelection.selectionContext,i=o.beginY,c=o.endY,a=n?c:i,l=Math.abs(a-r.first.y)<Math.abs(r.last.y-a);return e.debug(l?"\u66f4\u63a5\u8fd1\u7b2c\u4e00\u4e2ablock ".concat(r.first.id):"\u66f4\u63a5\u8fd1\u6700\u540e\u4e00\u4e2ablock ".concat(r.last.id)),l?r.first.id:r.last.id}}}]),r}(H),Q=r("dx_pmiW");function ee(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var te=function(e){h()(r,e);var n=ee(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).desc="\u9012\u5f52\u78b0\u649e\u7f29\u5c0f\u8303\u56f4\u4ece\u800c\u627e\u5230\u66f4\u7cbe\u51c6\u7684\u7ed3\u679c",e}return s()(r,[{key:"main",value:function(e,n){var r=n.recursiveId,o=e.blockManager,i=e.blockSelection,c=e.rect,a=i.rectPainter._areaDomRect,l=function(e,n){var r=e.blockManager,o=e.blockSelection,i=e.rect,c=o.rectPainter._areaDomRect,a=r.getBlockModelByBlockId(n).children;if(!a.length)return!0;var l=1,s=Object(D.w)(i.getOriginBlockRect(n)),u=a[0].id,d=Object(D.w)(i.getOriginBlockRect(u)),f=d.y-s.y,h=Math.min(l,d.x-s.x),p=new DOMRect(s.x,s.y,s.width,f),v=new DOMRect(s.x,s.y,h,s.height),g=new DOMRect(s.x-l,s.y,l,s.height),b=Object(Q.L)(c,p,Q.Z.TOUCH),y=Object(Q.L)(c,v,Q.Z.TOUCH)&&Object(Q.L)(c,g,Q.Z.TOUCH);return b||y}(e,r),s=e.blockManager.getBlockModelByBlockId(r).type;if(e.debug("ResolveRecursive: block=%s-%s, isCurrentCoveredSelf=%s",s,r,l),l)return[r];var u=ne(a,o.getBlockModelByBlockId(r).children.filter((function(e){return!!(null===e||void 0===e?void 0:e.id)})),c.getOriginBlockRect.bind(c));return u.length?u.length>1?u.map((function(e){return e.id})):this.main(e,{recursiveId:u[0].id}):[r]}}]),r}(H);function ne(e,n,r){for(var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=0,c=n.length-1;i<=c;){var a=Math.floor(i+(c-i)/2),l=Object(D.w)(r(n[a].id));if(l.top>e.bottom)c=a-1;else{if(!(l.bottom<e.top)){var s=Object(Q.L)(l,e,Q.Z.TOUCH);s&&o.push(n[a]);var u=ne(e,n.slice(i,a),r),d=ne(e,n.slice(a+1,c+1),r);return u.concat(o,d)}i=a+1}}return o}function re(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return oe(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oe(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function oe(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function ie(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var ce=function(e){h()(r,e);var n=ie(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).desc="\u9047\u5230gridBlock\u65f6\u7684\u7279\u6b8a\u5904\u7406",e}return s()(r,[{key:"main",value:function(e){var n=this.scanIds(e,{ids:e.matchedIds});return Y(e,n.ids,!1,"ResolveGrid"),n}},{key:"scanIds",value:function(e,n){var r,o=e.blockManager,i=e.blockSelection,c=e.rect,a=[],l=new Set,s=re(n.ids);try{for(s.s();!(r=s.n()).done;){var u=r.value,d=K(u,B.B.GRID,o),f=i.rectPainter._areaDomRect;if(!d||d&&!Object(Q.L)(f,Object(D.w)(c.getOriginBlockRect(d)),Q.Z.TOUCH))a.push(u);else if(!l.has(d)){l.add(d);var h=this.scanGrid(e,{gridBlockId:d}),p=h.matchedIds,v=h.recursiveId;if(p&&p.length&&(a=a.concat(p)),v){var g=(new te).main(e,{recursiveId:v});a=a.concat(g)}}}}catch(b){s.e(b)}finally{s.f()}return{ids:a}}},{key:"scanGrid",value:function(e,n){var r=n.gridBlockId,o=e.blockManager,i=e.blockSelection,c=e.rect,a=i.rectPainter._areaDomRect;if(o.getBlockModelByBlockId(r).type!==B.B.GRID)throw new Error("ResolveGrid: error options");var l=o.getBlockModelByBlockId(r).children.map((function(e){var n=o.getBlockModelByBlockId(e.id),r=n.children.map((function(e){return{id:e.id,type:e.type,rect:Object(D.w)(c.getOriginBlockRect(e.id))}})),i=r.filter((function(e){return Object(Q.L)(a,e.rect,Q.Z.TOUCH)}));return{id:n.id,matchedChildren:i}})).filter((function(e){return e.matchedChildren.length}));if(0===l.length)return{matchedIds:[]};if(l.length>1)return{matchedIds:Object(k.flatten)(l.map((function(e){return e.matchedChildren.map((function(e){return e.id}))})))};var s=l[0].matchedChildren;return s.length>1?{matchedIds:s.map((function(e){return e.id}))}:s[0].type===B.B.TABLE?{matchedIds:[s[0].id]}:{recursiveId:s[0].id}}}]),r}(H);function ae(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var le=function(e){h()(r,e);var n=ae(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).desc="\u5904\u7406\u8d77\u59cb\u70b9\u5177\u5907\u7956\u5b59\u5173\u7cfb\u65f6\u7684case",e}return s()(r,[{key:"main",value:function(e){if(e.resolveStatus===N.RELATION_SOLVED)return!0;var n=e.targetsRelation,r=e.targetIds;if(!n||!r)throw new Error("The context does not meet expectations");var o=n&&!n.hasRoot&&(n.parent||n.ancestor);if(!o)return!0;var i=e.blockSelection.selectionContext,c=i.beginY,a=i.endY;return Object(W.X)({ancestorId:o,blockManager:e.blockManager,rect:e.rect,y:o===r[0]?c:a})?X(e,"\u5224\u65ad\u547d\u4e2d\u7ed3\u679c\u4e3a\u76f4\u7cfb\u5173\u7cfb\u4e14\u70b9\u843d\u5728\u7f1d\u9699\u4e2d, \u4e0d\u66f4\u65b0\u9009\u533a"):(Y(e,[o],!0,"ResolveRelationAncestor"),Y(e,(new te).main(e,{recursiveId:o}),!0,"ResolveRelationAncestor.recursive"))}}]),r}(H);function se(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var ue=function(e){h()(r,e);var n=se(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).desc="\u5904\u7406\u8d77\u59cb\u70b9\u76f8\u7b49\u65f6\u7684case",e}return s()(r,[{key:"main",value:function(e){return e.resolveStatus===N.RELATION_SOLVED||(!e.targetsRelation||!e.targetsRelation.isEqual||Y(e,e.targetIds.slice(0,1),!0,"ResolveRelationEqual"))}}]),r}(H),de=r("dx_J4zp"),fe=r.n(de);function he(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var pe=function(e){h()(r,e);var n=he(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).desc="\u901a\u8fc7\u8d77\u59cb\u70b9\u548c\u7ed3\u675f\u70b9\u8ba1\u7b97\u5f97\u51fa\u78b0\u649e\u5217\u8868",e}return s()(r,[{key:"main",value:function(e){if(e.resolveStatus===N.RELATION_SOLVED)return!0;var n=e.targetIds,r=e.blockManager,o=function(e){return{id:e,path:r.getBlockPath(e)}};if(2!==n.length)return X(e,"targetIds.length != 2");var i=fe()(n,2),c=i[0],a=i[1],l=o(c),s=o(a),u=Object(W.F)(l,s);if(!u)return q(e,"no common ancestor");var d=r.getBlockModelByBlockId(u),f=Object(W.Y)(d.children,l,s),h=fe()(f,2),p=h[0],v=h[1];return Y(e,-1===p||-1===v?d.children.filter((function(e){return!!(null===e||void 0===e?void 0:e.id)})).map((function(e){return e.id})):d.children.filter((function(e,n){return p<=n&&v>=n&&e&&e.id})).map((function(e){return e.id})),!0,"ResolveRelationNormal, commonAncestor=".concat(d.type,"-").concat(u,"(").concat(c,",").concat(a,")"))}}]),r}(H),ve=r("dx_bbfH"),ge=r("dx_q0q0"),be=r("dx_QBqw"),ye=r("dx_BB1U");function me(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function _e(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?me(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):me(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function ke(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Oe(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Oe(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Oe(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function xe(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Ee=_()("sophon:selection:table"),Se=function(e){h()(r,e);var n=xe(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).desc="\u9047\u5230TableBlock\u65f6\u7684\u7279\u6b8a\u5904\u7406",e}return s()(r,[{key:"main",value:function(e){var n=this.scanIds(e,{ids:e.matchedIds}),r=n.ids,o=n.selectableCompleted;return Y(e,r,!1,"ResolveTable"),o&&(e.selectableCompleted=o),!0}},{key:"scanIds",value:function(e,n){var r,o=e.blockManager,i=e.blockSelection.rectPainter._areaDomRect,c=new Set,a=new Set,l=ke(n.ids);try{for(l.s();!(r=l.n()).done;){var s=r.value,u=K(s,B.B.TABLE,o);u?a.add(u):c.add(s)}}catch(b){l.e(b)}finally{l.f()}if(0!==c.size)return{ids:n.ids};var d,f=[],h=[],p=ke(a);try{for(p.s();!(d=p.n()).done;){var v=d.value,g=Object(D.w)(this.getTableWrapperRect(v,e));Object(Q.L)(i,g,Q.Z.OUTSIDE_TOUCH)&&f.push(v),Object(Q.L)(i,g,Q.Z.TOUCH)&&h.push(v)}}catch(b){p.e(b)}finally{p.f()}return 1!==h.length?{ids:n.ids}:f.length===h.length&&1===f.length?{ids:f}:this.scanTable(e,{id:h[0],originMatchedIds:n.ids})}},{key:"getTableWrapperRect",value:function(e,n){var r,o=n.blockManager,i=n.rect,c=o.getBlockViewByBlockIdNotCheck(e),a=null===c||void 0===c||null===(r=c.hostElement)||void 0===r?void 0:r.querySelector(".".concat(ve.q.TABLE_SCROLLER_CLASS));return a?Object(D.I)(a.getBoundingClientRect()):i.getOriginBlockRect(e)}},{key:"fixRect",value:function(e,n){var r={top:e.top,left:e.left,right:e.right,bottom:e.bottom,height:e.height,x:e.x,y:e.y};return _e(_e({},r),{},n>=0?{x:e.x-n,left:e.left-n,width:e.width+n}:{right:e.right-n,width:e.width-n})}},{key:"scanTable",value:function(e,n){Ee("\u4ec5\u9009\u4e2d table-".concat(n.id));var r=e.blockManager,o=e.blockSelection.rectPainter._areaDomRect,i=r.getBlockModelByBlockId(n.id),c=r.getBlockViewByBlockId(n.id),a=function(){var e=c.tableViewScrollLeft;return c.scrollManage?e+c.scrollManage.getScrollStatus().scrollLeft:e}(),l=function(){var e=ge.S.getTableScrollLeft();return Object(k.isNumber)(e)?a-e:(ge.S.setTableScrollLeft(a),0)}(),s=i.children,u=this.fixRect(o,l),d=s.filter((function(e){var n=r.getBlockViewByBlockIdNotCheck(e.id);return n&&Object(Q.L)(u,n.getHostRect(),Q.Z.TOUCH)}));if(1===d.length)return this.scanCell(e,{id:d[0].id,originMatchedIds:n.originMatchedIds});var f=d.map((function(e){return r.getBlockViewByBlockId(e.id)})),h=i.record.snapshot;return{ids:Object(be.J)(f,ge.S.getLayout(i.id,h),h).map((function(e){return r.getBlockIdsByRecordId(e)})).flat(),selectableCompleted:!0}}},{key:"scanCell",value:function(e,n){Ee("\u4ec5\u9009\u4e2d cell-".concat(n.id));var r=e.blockManager,o=e.blockSelection,i=e.rect,c=o.rectPainter._areaDomRect;if(i.getOriginBlockRect(n.id).bottom-c.bottom<=ye.j)return{ids:[n.id]};var a=r.getBlockModelByBlockId(n.id).children.filter((function(e){return Object(Q.L)(c,Object(D.w)(i.getOriginBlockRect(e.id)),Q.Z.TOUCH)})).map((function(e){return e.id}));if(1===a.length){var l=a[0],s=(new te).main(e,{recursiveId:l});e.debug("ResolveTable.scanCell.recursive: %s => %s",a,s),a=s}return{ids:a}}}]),r}(H);function Ce(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Ie=function(e){h()(r,e);var n=Ce(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).desc="\u5f97\u5230\u7ecf\u8fc7\u4fee\u6b63\u540e\u7684target",e}return s()(r,[{key:"main",value:function(e,n){if(!e.blockManager.editorAPI.modelService.isInitialDataReady())return!1;var r=this.closeToBlock(e,this.closeToBoundary(e,n));if(!r)return!1;var o=r.x,i=r.y,c=document.elementFromPoint(o,i);return Object(k.isEqual)(r,n)||e.debug("ResolveTarget: fix point (%s,%s) => (%s,%s), target=%o",n.x,n.y,o,i,c),c?{x:o,y:i,target:c}:q(e,"ResolveTarget: target not found from fixed point")}},{key:"closeToBoundary",value:function(e,n){var r=n.x,o=n.y,i=e.blockManager,c=i.getRootBlockId(),a=i.getBlockViewByBlockId(c).hostElement,l=document.elementFromPoint(r,o);return a.contains(l)?n:function(e){var n=e.x,r=e.y,o=e.brect,i=e.securitySize,c=o.x+i.left,a=o.x+o.width-i.right,l=document.body.clientWidth-i.right,s=Math.min(a,l),u=o.y+i.top,d=Math.min(o.y+o.height-i.bottom,document.body.clientHeight-i.bottom),f=Object(k.clamp)(n,c,s),h=Object(k.clamp)(r,u,d);return{x:f,y:h}}({x:r,y:o,securitySize:e.blockSelection.options.securitySizeOfBoundary,brect:a.getBoundingClientRect()})}},{key:"closeToBlock",value:function(e,n){document.elementFromPoint(n.x,n.y)||q(e,"closeToBlock: target not found from point fixed by closeToBoundary");var r=G(e);if(!r){var o="closeToBlock: no children in block, finish_empty";return e.debug(o),console.warn(o),e.resolveStatus=N.FINISH_EMPTY,!1}var i=r.first,c=r.last,a=Object(k.clamp)(n.y,i.y,c.y);return{x:n.x,y:a}}}]),r}(H);function Be(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Te=function(e){h()(r,e);var n=Be(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).desc="\u8ba1\u7b97target\u5bf9\u5e94\u7684blockId",e}return s()(r,[{key:"main",value:function(e,n){var r=we({targetIds:n.targetIds,blockManager:e.blockManager});return e.targetsRelation=r,!0}}]),r}(H);function we(e){var n=e.targetIds,r=e.blockManager;if(2!==n.length)throw new Error("params error: targetIds");var o=fe()(n,2),i=o[0],c=o[1],a=r.getRootBlockId(),l={root:a,hasRoot:!1,isBrotherhood:!1,isEqual:!1,isUnknown:!1};n.includes(a)&&(l.hasRoot=!0),i===c&&(l.isEqual=!0);var s=r.getBlockPath(i),u=r.getBlockPath(c),d=s[s.length-1],f=u[u.length-1];return d&&f&&d===f?(l.isBrotherhood=!0,l):d===c?(l.parent=c,l):f===i?(l.parent=i,l):s.includes(c)?(l.ancestor=c,l):u.includes(i)?(l.ancestor=i,l):(l.isUnknown=!0,l)}function Re(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Me=function(e){h()(r,e);var n=Re(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).desc="\u5904\u7406\u4e0d\u53ef\u9009\u4e2d\u7684block",e}return s()(r,[{key:"main",value:function(e){var n=e.blockManager,r=e.blockSelection,o=e.matchedIds,i=Object(A.y)(n,o,r.unSelectableType);return Y(e,i,!1,"ResolveUnSelectable"),e.resolveStatus=N.FINISH_SUCCESS,{ids:i}}}]),r}(H);var je=r("dx_uvPz"),De=r("dx_Ph9x");function Ae(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Pe(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Pe(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Pe(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function Le(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Ne=function(e){h()(r,e);var n=Le(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).currentHeightValue="",e.onBrowserSelectionChange=function(n){var r,o="Range"===(null===(r=getSelection())||void 0===r?void 0:r.type)?"0":"";je.t.isIOS&&e.currentHeightValue!==o&&(e.currentHeightValue=o,e.context.blockManager.allBlockViews.forEach((function(e){if(e.type===B.B.GRID){var n,r,i=Ae((null===(n=e.contentElement)||void 0===n?void 0:n.querySelectorAll(".column-gap"))||[]);try{for(i.s();!(r=i.n()).done;){r.value.style.height=o}}catch(c){i.e(c)}finally{i.f()}}})))},e.onStart=function(e){},e.onStop=function(e){},e}return r}(De.P);function Fe(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Ue(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ue(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Ue(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function He(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Ve=function(e){h()(r,e);var n=He(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).blockIframes=null,e}return s()(r,[{key:"onBeforeStart",value:function(e){}},{key:"onStart",value:function(e){this.blockIframes||(this.blockIframes=new Set);var n,r=Fe(Array.from(document.querySelectorAll(".block iframe")));try{for(r.s();!(n=r.n()).done;){var o=n.value;this.blockIframes.add(o),o.style.pointerEvents="none"}}catch(i){r.e(i)}finally{r.f()}}},{key:"onStop",value:function(e){var n;null===(n=this.blockIframes)||void 0===n||n.forEach((function(e){e.style.pointerEvents=""})),this.blockIframes=null}}]),r}(De.P),We=r("dx_CqjN");function ze(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Ge=["suspension-comment-area","scrollable-container"],Ke=function(e){h()(r,e);var n=ze(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).mouseContext=void 0,e.onStart=function(n){var r=n.event;if(O.S.isIOS&&r&&"touchstart"===r.type){var o=Object(We.q)(r),i=o.clientX,c=o.clientY;e.mouseContext={x:i,y:c}}},e.onStop=function(n){var r=O.S.isIOS&&n.event&&e.checkIsSingleClick(n.event);if(n.continue&&n.instance.selectionContext.singleClick||r){var o;if(Object(We.X)(n.event))return;var i=null===(o=n.event)||void 0===o?void 0:o.target;if(!i)return;var c=e.context.options.getContentContainer(),a=e.context.options.boundaryAreaContainer;if(!a.contains(i))return;if(!c||"function"!==typeof i.contains||!c.parentElement)return;if(i.contains(c.parentElement)&&a.contains(i))e.context.removeAllSelection(),e.context.blur();else if(c.contains(i)&&Ge.find((function(e){return i.classList.contains(e)})))e.context.removeAllSelection();else{var l,s=null===(l=i.closest(".block"))||void 0===l?void 0:l.getAttribute("data-block-type");!(Object(x.P)()&&O.S.isMobile&&O.S.isIOS&&0===e.context.getSelection().length&&s)||B.UB.includes(s)||s===B.B.CELL||s===B.B.FILE&&qe(i)||e.context.blur()}}},e}return s()(r,[{key:"checkIsSingleClick",value:function(e){if(this.mouseContext&&"touchend"===e.type){var n=this.mouseContext,r=n.x,o=n.y,i=Object(We.q)(e),c=i.clientX,a=i.clientY,l=Math.abs(o-a),s=Math.abs(r-c);return l<20&&s<20}return!1}},{key:"onBeforeStart",value:function(e){}}]),r}(De.P);function qe(e){return!!e&&!!e.closest(".embed-inline-block")}var Xe=r("dx_RIqP"),Ye=r.n(Xe);function Je(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Ze(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ze(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Ze(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function Qe(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var $e=function(e){h()(r,e);var n=Qe(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).onStop=function(n){var r=Object(k.cloneDeep)(e.context.getSelection());if(e.context.store.isBlockSelection(r)){var o,i=r.filter((function(n){var r=n.id,o=e.context.blockManager.getRecordByBlockId(r);if(!o)return!1;var i=o.snapshot,c=i.type,a=i.folded;return(e.context.fold.isFolded(r)||a)&&c.includes("heading")})),c=function(e){return r.findIndex((function(n){return n.id===e}))},a=Je(i);try{for(a.s();!(o=a.n()).done;){var l=o.value.id,s=Object(A.y)(e.context.blockManager,e.context.fold.findFoldedBlocks(l),e.context.options.unSelectableType||[]);if(!s.some((function(e){return c(e)>-1}))){var u=c(l),d=s.map((function(e){return{id:e,type:P.j.BLOCK}}));r.splice.apply(r,[u+1,0].concat(Ye()(d)))}}}catch(f){a.e(f)}finally{a.f()}e.context.setSelection(r,{source:P.q.RectArea})}},e}return s()(r,[{key:"onBeforeStart",value:function(e){}},{key:"onStart",value:function(e){}}]),r}(De.P),et=r("dx_N2Hh");function tt(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var nt=function(e){h()(r,e);var n=tt(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i)))._prevSelection=[],e._tmpPrevSelection=[],e._selectionUpdated=void 0,e.onStart=function(n){e._prevSelection=e.context.getSelection(),e._tmpPrevSelection=e._prevSelection,e._selectionUpdated=!1},e.onMove=function(n){if(!e.context.selectionContext.shouldBuildMultiText){var r=e._tmpPrevSelection,o=e.context.store.getTmpSelection(),i=Object(k.differenceWith)(r,o,k.isEqual),c=Object(k.differenceWith)(o,r,k.isEqual);e.renderBlockSelection(o,i,c),e.context.store.stored=o,e.context.store.tmpStored=o,e._tmpPrevSelection=o,e._selectionUpdated=!0}},e.renderBlockSelection=function(n,r,o){e.context.store.isBlockSelection(n)&&e.context.setFocusInHiddenInputDom(!0),r.forEach((function(n){n.type===P.j.BLOCK&&e.context.mainSelectionType.render(n,!1)})),o.forEach((function(n){n.type===P.j.BLOCK&&e.context.mainSelectionType.render(n,!0)}))},e.onStop=function(n){if(e._selectionUpdated){var r=e.context.store.getTmpSelection();e.context.store.stored=e._prevSelection,e.context.setSelection(r,{source:P.q.RectArea}),O.S.isMobile&&O.S.isBytedanceApp&&w.s.emit(w.p.MOBILE.BLOCK_MENU.SHOW_BLOCK_MENU)}e._prevSelection=[],e._tmpPrevSelection=[],e._selectionUpdated=!1},e}return r}(De.P);function rt(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return ot(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ot(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function ot(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function it(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var ct=function(e){h()(r,e);var n=it(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).onBeforeStart=function(n){if(!Object(x.P)()&&n.event&&n.event.shiftKey){var r=Object(T.S)(n.event.target);if(r){var o=e.context.getSelection(),i=e.context.store.isSingleTextSelection(o);(!i||i&&o[0].id!==r)&&n.event.preventDefault()}}},e.onStop=function(n){if(!Object(x.P)()){var r=n.event,o=n.instance;if(r&&o.selectionContext.singleClick&&r.shiftKey){var i=e.context.getSelection()[0];if(i){var c=i.id,a=Object(T.S)(r.target);if(a&&c!==a){var l=e.context.blockManager,s=l.getBlockPath(a).concat([a]),u=l.getBlockPath(c).concat([c]),d=Object(W.F)({id:c,path:u},{id:a,path:s});if(d){n.continue=!1;var f,h,p,v=l.getBlockModelByBlockId(d).children,g=rt(v.entries());try{for(g.s();!(p=g.n()).done;){var b=fe()(p.value,2),y=b[0],m=b[1];(u.includes(m.id)||s.includes(m.id))&&(void 0===f?f=y:void 0===h&&(h=y))}}catch(O){g.e(O)}finally{g.f()}var _=v.filter((function(e,n){return n>=f&&n<=h})).map((function(e){return e.id})),k=Object(j.h)(_,e.context.blockManager);e.context.setSelection(k)}}}}}},e}return s()(r,[{key:"onStart",value:function(e){}}]),r}(De.P),at=r("dx_ZG9w"),lt=r("dx_kZ3l"),st=r("dx_ey54");function ut(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var dt=".text-editor",ft=function(e){h()(r,e);var n=ut(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).onStop=function(n){if(n.continue&&n.instance.selectionContext.singleClick){if(!n.event)return;var r=e.context.options.getContentContainer(),o=n.event.target,i=o;if(1!==o.nodeType&&(i=o.parentElement),!i)return;var c=e.context.blockManager,a=c.getBlockViewByBlockId(c.rootBlockId).hostElement;if(!(i&&r&&r.contains(i)&&i!==a))return;if(i.closest(st.g)||i.closest(".h5-toolbar-wrapper"))return;if(i.closest(dt))return;var l=n.event,s=l.clientX,u=l.clientY,d=pt(s,u);if(!d.length)return;var f=d[0],h=c.getBlockViewByBlockId(f);if(!Object(at.f)(h)||!h.editable)return;var p=h.model.zoneState.getContainer();if(null===p||void 0===p?void 0:p.contains(i))return;if((null===h||void 0===h?void 0:h.type)===B.B.PAGE&&O.S.isAndroid||w.s.trigger(w.p.MOBILE.COMMON.KEYBOARD_BEFORE_TEMP_DOWN,[]),1===d.length&&f===c.rootBlockId&&(ht(f,e.context),n.continue=!1),2===d.length){var v=we({blockManager:e.context.blockManager,targetIds:d});return v.parent===f&&(ht(d[1],e.context),n.continue=!1),void(v.isBrotherhood&&(ht(f,e.context),n.continue=!1))}if(3===d.length){var g=we({blockManager:e.context.blockManager,targetIds:d.slice(0,2)}),b=we({blockManager:e.context.blockManager,targetIds:[f,d[2]]});if(g.parent===f||b.parent===f){var y=vt(u,[d[1],d[2]],e.context);y&&ht(y,e.context),n.continue=!1}}}},e}return s()(r,[{key:"onBeforeStart",value:function(e){}},{key:"onStart",value:function(e){}}]),r}(De.P);function ht(e,n){var r=n.blockManager.getBlockViewByBlockId(e);Object(at.f)(r)&&r.editable&&lt.u(r.model)}function pt(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,i=y.V,c=document.elementFromPoint(e,n);if(!(i=c&&Object(T.S)(c)||y.V))return[];o*=2;for(var a=0,l=n,s=r,u=[i];a<o;){a%2===0?l-=s:(l+=s,s=r*(a+1)/2);var d=[e,l],f=document.elementFromPoint(d[0],d[1]),h=f&&Object(T.S)(f)||"";if(h&&h!==i&&u.push(h),a%2===1&&u.length>1)break;l=n,a++}return Object(k.union)(u)}function vt(e,n,r){var o=fe()(n,2),i=o[0],c=o[1],a=r.blockManager,l=r.rect,s=a.getBlockViewByBlockId(i),u=a.getBlockViewByBlockId(c);if(!s.editable&&!u.editable)return null;if(s.editable&&u.editable){var d=l.getOriginBlockRect(i).top,f=l.getOriginBlockRect(c).top;return Math.abs(e-d)>Math.abs(e-f)?c:i}return s.editable?i:c}function gt(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var bt=function(e){h()(r,e);var n=gt(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).onStop=function(e){ge.S.clear()},e}return s()(r,[{key:"onBeforeStart",value:function(e){}},{key:"onStart",value:function(e){}}]),r}(De.P),yt=r("dx_qHgq");function mt(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var _t=function(e){h()(r,e);var n=mt(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).beginBlockId=y.V,e.onStart=function(n){var r=e.context.selectionContext.beginTarget;e.beginBlockId=Object(T.S)(r)||y.V},e.onMove=function(n){if(!(e.beginBlockId===e.context.blockManager.rootBlockId)){var r=e.context.store.getTmpSelection().filter((function(n){return e.context.blockManager.getBlockModelByBlockId(n.id).type===B.B.CELL}));e.context.selectionContext.intersectSelectedBlocksMap.set(B.B.CELL,r),r.length>0&&e.context.emit(yt.j.browserSelectionChange)}},e.onStop=function(e){},e}return r}(De.P);function kt(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Ot=function(e){h()(r,e);var n=kt(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).onBeforeStart=function(n){e.context.selectionContext.tripleClick=!!n.event&&n.event.detail>=3},e.onStart=function(e){},e.onStop=function(n){e.context.selectionContext.tripleClick=!1},e}return r}(De.P),xt=r("dx_QxNg"),Et=r("dx_b28D"),St=r("dx_FvGq");function Ct(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var It=function(){function e(n){a()(this,e),this.context=n,this.type=void 0,this.onSelectionChange=this.onSelectionChange.bind(this)}return s()(e,[{key:"setup",value:function(){this.context.store.onSelectionChange(this.onSelectionChange)}},{key:"match",value:function(e){return e.type===this.type}},{key:"render",value:function(e,n){}},{key:"filterUnValidSelect",value:function(e,n){var r=e.filter((function(e){return n.hasBlockModelByBlockId(e.id)}));return Object(A.e)(r)?Object(A.E)(Object(A.y)(this.context.blockManager,r.map((function(e){return e.id})),this.context.options.unSelectableType||[])):r}},{key:"onBeforeSet",value:function(e){}},{key:"onSelectionChange",value:function(e,n){}},{key:"destroy",value:function(){this.context.store.offSelectionChange(this.onSelectionChange)}}]),e}(),Bt=function(e){h()(r,e);var n=Ct(r);function r(){return a()(this,r),n.apply(this,arguments)}return s()(r,[{key:"onBeforeSet",value:function(e){}},{key:"filterUnValidSelect",value:function(e){return Object(A.L)(e)?Object(A.hS)(this.context.blockManager,e):e}}]),r}(It);function Tt(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var wt=Object(Et.e)("BlockTypeSelection"),Rt=function(e){h()(r,e);var n=Tt(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).type=P.j.BLOCK,e.unRenderSelectedBlocks=new Map,e.selectedBlocks=new Set,e.pendingDestroyBlocks=new Set,e.handleBlockMount=function(n){var r=n.props.blockId,o=e.context.blockManager,i=e.unRenderSelectedBlocks.get(r);i&&(i.unsubscribe(),o.getBlockViewByBlockId(r).setSelected(!0),e.unRenderSelectedBlocks.delete(r))},e.onBlockModelDestroy=function(n){e.selectedBlocks.has(n.id)&&e.pendingDestroyBlocks.add(n.id)},e.handleTransaction=function(){if(e.pendingDestroyBlocks.size){var n=e.pendingDestroyBlocks;e.pendingDestroyBlocks=new Set;var r=e.context.getSelection();if(r.length)r.length!==(r=r.filter((function(e){var r=e.id;return!n.has(r)}))).length&&e.context.setSelection(r,{source:P.q.Destroy})}},e}return s()(r,[{key:"setup",value:function(){d()(b()(r.prototype),"setup",this).call(this),this.context.store.onSelectionChange(this.onSelectionChange),this.context.blockManager.recordManager.on(xt.q.CHANGE,this.handleTransaction),this.context.blockManager.addListener(St.o,this.onBlockModelDestroy)}},{key:"render",value:function(e,n){wt(".render",e,n);var r=this.context.blockManager,o=e.id;if(r.hasBlockViewByBlockId(o))wt(".render[hasBlockView]"),r.getBlockViewByBlockId(o).setSelected(n);else if(r.getRecordByBlockId(o)&&n){wt(".render[hasBlockRecord]");var i=r.editorAPI.viewService.blockViewMount$.subscribe(this.handleBlockMount);this.unRenderSelectedBlocks.set(o,i)}var c=this.unRenderSelectedBlocks.get(o);!n&&c&&(c.unsubscribe(),this.unRenderSelectedBlocks.delete(o))}},{key:"destroy",value:function(){this.context.blockManager.recordManager.off(xt.q.CHANGE,this.handleTransaction),this.context.blockManager.removeListener(St.o,this.onBlockModelDestroy),d()(b()(r.prototype),"destroy",this).call(this)}},{key:"onSelectionChange",value:function(e,n){var o=this;d()(b()(r.prototype),"onSelectionChange",this).call(this,e,n),wt(".onSelectionChange",e,n),this.selectedBlocks=new Set(n.map((function(e){return e.id})));var i=Object(k.differenceWith)(e,n,k.isEqual),c=Object(k.differenceWith)(n,e,k.isEqual);i.forEach((function(e){e.type===P.j.BLOCK&&o.render(e,!1)})),c.forEach((function(e){e.type===P.j.BLOCK&&o.render(e,!0)})),n.length||(this.context.store.forward=!1)}}]),r}(It),Mt=r("dx_x56x"),jt=r("dx_LcNA");function Dt(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var At=function(e){h()(r,e);var n=Dt(r);function r(){var e;a()(this,r);for(var o=arguments.length,i=new Array(o),c=0;c<o;c++)i[c]=arguments[c];return(e=n.call.apply(n,[this].concat(i))).type=P.j.TEXT,e.onCurrentChange=function(n){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=e.context.getSelection();if(!Object(x.P)())if(r){var i=o.filter((function(r){return!e.context.store.isModelEqual(r,n)}));e.context.setSelection(i,{source:P.q.TextSelection})}else e.context.setSelection([n],{source:P.q.TextSelection})},e}return s()(r,[{key:"removeCurrent",value:function(e){var n=this,r=e.filter((function(e){return n.match(e)})),o=this.context.blockManager;r.forEach((function(e){if(o.hasBlockViewByBlockId(e.id)){var r=o.getBlockViewByBlockIdNotCheck(e.id);null===r||void 0===r||r.removeCurrentSelection()}else n.context.report("reset_text_selection_fail",{reason:"block instance not found"})}))}},{key:"addCurrent",value:function(e){}},{key:"updateBrowserSelection",value:function(e){if(document.hasFocus())if(0!==e.length){if(this.context.store.isSingleTextSelection(e))this.updateInternalEditorSelection(e,!0);else if(this.context.store.isTextSelectionAcrossBlocks(e)){this.updateInternalEditorSelection(e.filter((function(e){return e.type===P.j.TEXT})));var n=this.getBlockBrowserRange(e[0],!0),r=this.getBlockBrowserRange(e[e.length-1]);n&&r&&this.updateDomSelection({startContainer:n.startContainer,startOffset:n.startOffset,endContainer:r.endContainer,endOffset:r.endOffset})}}else O.S.isMobile?this.updateDomSelection({startContainer:null,startOffset:0,endContainer:null,endOffset:0}):this.context.restoreFocus()}},{key:"_setTextBlockFocus",value:function(e,n){if(this.context.blockManager.hasBlockViewByBlockId(e.id)){var r=this.context.blockManager.getBlockViewByBlockIdNotCheck(e.id);null===r||void 0===r||r.setBlockFocus(n)}}},{key:"getTextBlockRange",value:function(e){return Object(A.i)(this.context.blockManager,e,!this.context.store.forward)}},{key:"getBlockBrowserRange",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=e.id,o=e.type,i=this.viewService.getBlockViewByBlockId(r);if(!i||!i.hostElement)return null;if(o===P.j.TEXT){var c=this.getTextBlockRange(e);if(c)return i.editor.selection.toDOMRange(c)}var a=i.getSelectionLocator(n);return{startContainer:a,startOffset:0,endContainer:a,endOffset:1}}},{key:"updateInternalEditorSelection",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.length){var o=e.map((function(e){return n.getTextBlockRange(e)})).filter((function(e){return!!e})),i=this.viewService.getBlockViewByBlockId(e[0].id);if(i&&o.length&&(i.editor.selection.setSelection(o),r)){var c=i.blockManager.layoutManager.isBlockActive(i.id);if(c&&r){var a=i.editor.selection.range,l=i.editor.selection.toDOMRange(a);if(!l)return void i.editor.error({message:"[Selection][updateBrowserSelection] range:".concat(a," _toDOMRange faild"),level:Mt.F.ERROR});try{i.editor.selection._updateDOMSelection(l)}catch(s){i.editor.error({message:"[Selection][updateBrowserSelection] range:".concat(a," _updateDOMSelection occur error"),level:Mt.F.ERROR})}i.editor.call(jt.L.SELECTION_CHANGE_AND_DOM_UPDATE,{selection:a})}i.editor.selection.updateBrowserSelection()}}}},{key:"updateDomSelection",value:function(e){var n=e.startContainer,r=e.startOffset,o=e.endContainer,i=e.endOffset,c=document.getSelection();if(null!==c){if(null===n||null===o)return c.removeAllRanges(),void this.context.removeAllSelection();var a=Object(A.K)(c,0);if(!a||!Object(A.N)(e,a)){var l;if(c.anchorNode!==c.baseNode||c.focusNode!==c.extentNode)if(l=this.context.store.forward?{startContainer:c.baseNode,startOffset:c.baseOffset,endContainer:c.extentNode,endOffset:c.extentOffset}:{startContainer:c.extentNode,startOffset:c.extentOffset,endContainer:c.baseNode,endOffset:c.baseOffset},Object(A.N)(e,l))return;if(c.collapse&&c.extend){n===o&&r===i?c.collapse(n,r):this.context.store.forward?(c.collapse(n,r),c.extend(o,i)):(c.collapse(o,i),c.extend(n,r))}else{var s=document.createRange();s.setStart(n,r),s.setEnd(o,i),c.removeAllRanges(),c.addRange(s)}}}}},{key:"onSelectionChange",value:function(e,n){var o=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(d()(b()(r.prototype),"onSelectionChange",this).call(this,e,n),e.forEach((function(e){e.type===o.type&&-1===n.findIndex((function(n){return e.id===n.id}))&&o._setTextBlockFocus(e,!1)})),n.forEach((function(e){e.type===P.j.TEXT&&o._setTextBlockFocus(e,!0)})),Object(x.P)()&&i)return this.updateBrowserSelection(n)}},{key:"viewService",get:function(){return this.context.blockManager.view}}]),r}(Bt);function Pt(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,o)}return r}function Lt(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Pt(Object(r),!0).forEach((function(n){i()(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pt(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function Nt(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return Ft(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ft(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,a=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,c=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw c}}}}function Ft(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,o=new Array(n);r<n;r++)o[r]=e[r];return o}function Ut(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=b()(e);if(n){var i=b()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return v()(this,r)}}var Ht=_()("docx:selection: BlockSelection"),Vt=[".suspension-comment-area"],Wt=new Set(B.p),zt=[".task-block-text-editor"],Gt=function(e){h()(r,e);var n=Ut(r);function r(e,o,i){var c;return a()(this,r),(c=n.call(this)).options=e,c.focus=o,c.fold=i,c.blockManager=void 0,c.rect=void 0,c.composingService=void 0,c.context=null,c.store=void 0,c.rectPainter=new M.w({selectionAreaClass:c.options.selectionAreaClass,selectionAreaContainer:c.options.selectionAreaContainer}),c.selectionContext=new M.u,c.unSelectableType=void 0,c.extensions=void 0,c.mainSelectionType=void 0,c.extendSelectionTypes=void 0,c.hiddenInputDom=void 0,c.beginBlockId=void 0,c.handleKeydown=function(e){(e.metaKey||e.ctrlKey)&&[R.G.V,R.G.X].includes(e.keyCode)&&c.setHiddenInputDomReadOnly(!1)},c.handleCutOrPasteDone=function(){c.setHiddenInputDomReadOnly(!0)},c.blockManager=e.blockManager,c.rect=e.rect,c.composingService=e.composing,c.store=new F({mode:c.options.mode},c.blockManager,c.rect,c.selectionContext),c.unSelectableType=e.unSelectableType||[],c.initHiddenInputDom(),c.hiddenInputDom.addEventListener("keydown",c.handleKeydown),c.hiddenInputDom.addEventListener("paste",c.handleCutOrPasteDone),c.hiddenInputDom.addEventListener("cut",c.handleCutOrPasteDone),c}return s()(r,[{key:"setup",value:function(){var e=this;d()(b()(r.prototype),"setup",this).call(this),this.extensions=[nt,Ve,ct,ft,Ke,$e,bt,Ot].map((function(n){return new n(e)})),Object(x.P)()&&(this.extensions.push(new _t(this)),this.extensions.push(new et.T(this)),this.extensions.push(new Ne(this))),this.extensions.forEach((function(e){e.setup()})),this.mainSelectionType=new Rt(this),this.mainSelectionType.setup(),this.extendSelectionTypes=[At].map((function(n){return new n(e)})),this.extendSelectionTypes.forEach((function(e){e.setup()})),this.on(M.j.stop,this._onStop)}},{key:"destroy",value:function(){d()(b()(r.prototype),"destroy",this).call(this),this.mainSelectionType.destroy(),this.extendSelectionTypes.forEach((function(e){e.destroy()})),this.extensions.forEach((function(e){e.destroy()})),this.off(M.j.stop,this._onStop),this.hiddenInputDom.removeEventListener("keydown",this.handleKeydown),this.hiddenInputDom.removeEventListener("paste",this.handleCutOrPasteDone),this.hiddenInputDom.removeEventListener("cut",this.handleCutOrPasteDone),this.hiddenInputDom.remove()}},{key:"checkIfNeedCalcSelectablesIfLazy",value:function(){var e=this.selectionContext,n=e.beginTarget,r=e.endTarget;if(e.renderMode===M.H.NORMAL)return!0;var o=n&&r&&Object(T.t)(n,r),i=this.store.getTmpSelection(),c=i.length?i:this.store.getSelection(),a=this.store.isSingleTextSelection(c),l=r&&!this.options.boundaryAreaContainer.contains(r);if(a&&l)return!1;if(a&&o)return!1;if(o&&zt.some((function(e){return $(r).closest(e).length>0})))return!1;var s=Object(T.S)(n)||y.V,u=this.blockManager.hasBlockViewByBlockId(s)&&this.blockManager.getBlockModelByBlockId(s).isRoot,d=Object(T.S)(r),f=d&&this.blockManager.hasBlockViewByBlockId(d);return!(u&&!f)}},{key:"computeRenderModeByStartTarget",value:function(e){return!Object(T.C)(e)&&Object(T.f)(e,this.blockManager)?M.H.NORMAL:M.H.LAZY}},{key:"clearBrowserTextSelection",value:function(){this.setFocusInHiddenInputDom(!0)}},{key:"onTargetNotInBoundray",value:function(){this.removeAllSelection()}},{key:"getClosestLateralContainerBlockId",value:function(e){var n=Object(T.S)(e);if(!n)return null;if(this.blockManager.getBlockModelByBlockId(n).type===B.B.PAGE){var r,o=Nt(Vt);try{for(o.s();!(r=o.n()).done;){var i=r.value;if(e.closest(i))return null}}catch(c){o.e(c)}finally{o.f()}}return this.closestLateralContainer(n)}},{key:"closestLateralContainer",value:function(e){for(var n=this.blockManager.getBlockModelByBlockId(e);n&&!Wt.has(n.type);)n=n.parent;return n?n.id:null}},{key:"serilizeTarget",value:function(e,n,r){var o=this.buildResolveContext();return function(e,n){var r=[Ie,Z];V.create(r).process(e,n)}(o,{x:n,y:r}),this.beginBlockId=o.targetIds[0],e}},{key:"initHiddenInputDom",value:function(){var e=document.createElement("textarea");if(e.className="docx-selection-hidden-textarea",e.readOnly=!0,e.style.position="fixed",e.style.top="0",e.style.left="-100px",e.style.opacity="0",e.style.width="0",e.style.height="100vh",e.innerHTML=" ",document.body.appendChild(e),this.hiddenInputDom=e,/addWaterMark=true/.test(location.search||"")){var n=document.createElement("div");n.className="water-mark-biany",n.style.position="fixed",n.style.top="0",n.style.left="0",n.style.opacity="0",n.style.width="100%",n.style.height="100%",n.style.pointerEvents="none",n.innerHTML="",document.body.appendChild(n)}}},{key:"buildResolveContext",value:function(e){return{blockManager:this.blockManager,blockSelection:this,targetIds:e?[e]:[],matchedIds:[],debug:Ht,resolveStatus:N.DEFAULT,finishReason:"",selectableCompleted:!1,rect:this.rect}}},{key:"idsToSelectables",value:function(e){return e.map((function(e){return{id:e,type:P.j.BLOCK}}))}},{key:"calcSelectables",value:function(){if(this.beginBlockId){var e=this.buildResolveContext(this.beginBlockId),n=this.selectionContext;switch(function(e,n){var r=[Ie,Z,Te,ue,le,pe,ce,Se,Me];V.create(r).process(e,n)}(e,{x:n.endX,y:n.endY}),e.resolveStatus){case N.FINISH_IGONORE:case N.FINISH_EXCEPTION:break;case N.FINISH_EMPTY:this.selectionContext.update({selectables:[]});break;case N.FINISH_SUCCESS:this.selectionContext.update({selectables:this.idsToSelectables(e.matchedIds),selectableCompleted:e.selectableCompleted});break;default:throw new Error("resolve process not finished")}}}},{key:"_onStop",value:function(e){Ht("stop",e),delete this.beginBlockId}},{key:"setFocusInHiddenInputDom",value:function(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.options.disableBlockSelectionAutoFocus){w.S.emit(w.p.COMMON.RESTORE_FOCUS);var r=this.store.getSelection().length,o=null===(e=window.getSelection())||void 0===e?void 0:e.rangeCount;if(r&&!o||n){if(O.S.isFF){var i,c=this.hiddenInputDom.parentElement,a=Array.from(c.childNodes).indexOf(this.hiddenInputDom);return void(null===(i=getSelection())||void 0===i||i.collapse(c,a))}this.hiddenInputDom.focus(),this.hiddenInputDom.select()}}}},{key:"setHiddenInputDomReadOnly",value:function(e){this.hiddenInputDom.readOnly=e}},{key:"getSelection",value:function(){return this.store.getClonedSelection()}},{key:"getIsCurrentTextSelection",value:function(e){var n=this.store.getSelection();return 1===n.length&&n[0].id===e&&this.store.isSingleTextSelection(n)}},{key:"getSelectedBlockIfInSelection",value:function(e){return this.store.getSelection().find((function(n){return n.id===e}))}},{key:"getBlockInNestedSelection",value:function(e){for(var n=[],r=this.blockManager.getBlockModelByBlockIdNotCheck(e);r;)n.push(r.id),r=r.parent?this.blockManager.getBlockModelByBlockIdNotCheck(r.parent.id):void 0;return this.store.getSelection().find((function(e){return n.includes(e.id)}))}},{key:"getTmpSelection",value:function(){return this.store.tmpStored}},{key:"restoreFocus",value:function(){this.setFocusInHiddenInputDom(!0)}},{key:"clearExtendInternalSelection",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];e=e.filter((function(e){return!n.includes(e.id)})),this.extendSelectionTypes.forEach((function(n){n.removeCurrent(e)}))}},{key:"setContext",value:function(e,n){this.context=n}},{key:"blur",value:function(){document.activeElement&&document.activeElement.blur(),this.setHiddenInputDomReadOnly(!0),!O.S.isMobile&&this.setFocusInHiddenInputDom()}},{key:"getContext",value:function(){return this.context}},{key:"getSelectionContext",value:function(){return this.selectionContext}},{key:"setSelection",value:function(e){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{source:P.q.ExternalInvoke,syncBrowser:!0,force:!1},o=r.syncBrowser,i=void 0===o||o,c=r.force,a=void 0!==c&&c,l=Object(k.cloneDeep)(e);l=this.mainSelectionType.filterUnValidSelect(l,this.blockManager),this.extendSelectionTypes.forEach((function(e){l=e.filterUnValidSelect(l)}));var s=this.getSelection();if(Object(k.isEqual)(l,s))a&&this.updateBrowserSelection();else{if(!l.length)return this.clearExtendInternalSelection(s),this.store.transaction((function(){n.setContext(l,r),n.store.stored=[]}),i),void(i&&this.updateBrowserSelection());var u=this.store.isBlockSelection(l);this.mainSelectionType.onBeforeSet(l),this.extendSelectionTypes.forEach((function(e){e.onBeforeSet(l)}));var d=[];u||d.push(l[0].id),this.clearExtendInternalSelection(s,d),this.store.transaction((function(){n.setContext(l,r),n.store.stored=l;var e=Object(k.union)(l.map((function(e){return e.type})));if(n.extendSelectionTypes.some((function(n){var r=n.type===e[0];return r&&n.addCurrent(l[0]),r})),r.source!==P.q.Destroy&&u){var o=[P.q.Backspace,P.q.Redo,P.q.Undo];O.S.isMobile&&o.includes(r.source)&&n.setHiddenInputDomReadOnly(!1),n.setFocusInHiddenInputDom(!0),O.S.isIOS&&n.setHiddenInputDomReadOnly(!0)}}),i),r.source!==P.q.Redo&&r.source!==P.q.Undo||Object(I.f)((function(){Object(S.Fi)({actionObject:u?C.u.BLOCK:C.u.TEXT,source:S.G.content_page,blockManager:n.blockManager,actionType:S.F[r.source.toLowerCase()],blocks:l,click:S.c.hotkey_action})}))}}},{key:"removeAllSelection",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.setSelection([],{source:P.q.ExternalInvoke,syncBrowser:e})}},{key:"updateBrowserSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getSelection();this.extendSelectionTypes.forEach((function(n){n.updateBrowserSelection(e)}))}},{key:"selectAll",value:function(){var e=this.blockManager.rootBlockId,n=this.blockManager.getBlockModelByBlockId(e).children,r=Object(j.h)(n.map((function(e){return e.id})),this.blockManager);this.setSelection(r)}},{key:"report",value:function(e,n){var r=this.getSelection();Object(I.f)((function(){Object(E.N)("sophon_selection_".concat(e),Lt(Lt({},n),{},{currentSelection:JSON.stringify(r)}))}))}},{key:"boundaryAreaContainer",get:function(){return this.options.boundaryAreaContainer||document.body}},{key:"pasteBoundary",get:function(){return this.options.pasteBoundary||document.body}}]),r}(M.y)},dx_zjmc:function(e,n,r){"use strict";var o=r("dx_f5fh"),i=r("dx_yzb3");r.d(n,"D",(function(){return i.S})),n.S=o.S},dx_zpWR:function(e,n){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWUAAABuCAYAAAD/NQLMAAAAAXNSR0IArs4c6QAACnNJREFUeAHt3X9wFOUdx/FvzI3hQkANR6gSCAmQhh8xRCATLfUXgtKi1pE6Q1s7pZ3+GNph+oftODLTcTqjdco/bZ3RGf9QB60VlWKpUy0tlZCQXH5ADMaQCpKEpFY6FlI0ySXQS2+3vasxd7C7z7O3m7v3Mczt7e3zfZ59PZdP9vY2Sc77H5weF24IIIAAAr4QCEQiY1JaUuzqYHr6Blzvw9UdoDgCCCCQBgEjKy9LQz90gQACCCBgUYBQtgjFZggggEA6BAjldCjTBwIIIGBRgFC2CMVmCCCAQDoECOV0KNMHAgggYFGAULYIxWYIIIBAOgQI5XQo0wcCCCBgUSBgcTs2SyHw5sFGmZ4flJpV1Sm2YLVfBI799bh0vN2VGE5+MCjLl1XErqGfJzk5OYn1LPhPIBIZlQP1jXKq/29SeNWVUr2iUsoWzM/IeeNIWeH1NzQ0LG/s+4vs2fu6/DsaVahE03QI9MUuzB8aGpIV1y4z/88pmi2vxubuj38+kI7u6cOhwJmzg/Lojl/J2Nh5ue3WG2XRwlLZF5uzl3bvdVjR3804UlaYn6bmNvMI+ezgv6Tj6DtyXey7Nzd/C4RmzZKK8kWJQZbML5YnnnpW7lh3S2IdC/4S+O3v/iCrV1bJnV9YnxhYZewdziM//6Wc/seHMqcolFifCQscKSvMYn1ji6y5oUY+d/1qqT8UVqhEU68EOru6pWT+XK+6p99LCIyPj8vh9qOxdzbLJ2yZm5srD/1om4RmXTVhfSY80H6kHG59S2pXr8gEm4vuw3s9fZIfO5dsvAUumh2Snb9+Wc6cOSuFhZn3IrkoxBR78mBDOHZe+R1z1IOxdzjB2Bw+9MC2KbYX2TNc412oce5/XvE1k3Y6ENAeX5P68GKF1r0yAjnc2p4VoWwcGRsfEBnhbNzKSkukoalV7vri/99ieTGh9HlxgRvX1MrdG283NxoZiZgBbbwNfuThBzPyQ6OLa/j/2WBwmgwND8tIJCLBadP8P2ANI9R2+iIeyBrG5PsSxifBRzuPyejYmDSGW83/eZdfLoeaWsR4u8VtaggYX/C1NSvFuO/p658ag86yURpBbFxt0XXs3Ul7/sxzu6Sre/L6SRtOsRVajpSzKZCN+W1uOyKVy5bI/Zs3TZjuHb94UoxzlMZz3KaGQO+pfvn7B6fNL/ypMeLsG+XGDevMK2TKF5fJjIICE+DIW2+LcfppaUV5xoEoh3K2BbLxCqg/1Cz33XvXpBfDGvMDv2ZCeZKMf1bUNTRJe0enOaBo7DLGUKhQvr3lq3LlFTP9M0hGMkHghtpV5jvQn+14XGbOKIidyhiVBbFTh1/bfO+E7TLlQc7J3v5xp7/kPlUg/3Drlgk+/JL7CRw8QAABhwLnzn0k0wumS+5l2s68OhyJO82MrHR8pJwqkN0ZKlURQAABkZkzZ2Q8g6NvNwRyxr8u2EEEEPBIwNGRsnEdcjZci+zRnNAtAghksYCjI+Us9mLXEUAAAVcFCGVXeSmOAAII2BMglO15sTUCCCDgqoB5SZyrPVAcAQQQQMCygPlBn9PrlK32wnXKVqX8tx1z5785sTIi5s2Kkv+2MeaN0xf+mxdGhAACWSxAKGfx5LPrCCDgPwFC2X9zwogQQCCLBQjlLJ58dh0BBPwnQCj7b04YEQIIZLEAoZzFk8+uI4CA/wQIZf/NCSNCAIEsFiCUs3jy2XUEEPCfgKNQNv4Ui/E36rghgAACCOgVsBXKH/7zjOx84WV5afdeOXGyR+9IqIYAAgggYO8vj/QPvC/Xx/7672fmFMnHQ0PwIYAAAghoFrD1S+6rq5ab3fPn2DXPAuUQQACB/wnYOn2BGgIIIICAuwKEsru+VEcAAQRsCRDKtrjYGAEEEHBXgFB215fqCCCAgC0BQtkWFxsjgAAC7grYuvoiPpT1a2+KL3KPAAIIIKBRgCNljZiUQgABBFQFCGVVQdojgAACGgUIZY2YlEIAAQRUBQhlVUHaI4AAAhoFCGWNmJRCAAEEVAUIZVVB2iOAAAIaBQhljZiUQgABBFQFCGVVQdojgAACGgUc/fCIk/57+gacNKONDwSYOx9MgoMhMG8O0HzQJG2hXFpS7IPdZQh2BYwvbObOrpr32zNv3s+BkxEY88bpCydytEEAAQRcEiCUXYKlLAIIIOBEgFB2okYbBBBAwCUBQtklWMoigAACTgQIZSdqtEEAAQRcEiCUXYKlLAIIIOBEgFB2okYbBBBAwCUBQtklWMoigAACTgRs/fBI97snpDHcJsFpeVKzqloWli1w0idtEEAAAQRSCFg+Uj7WfVye/81uqapcKtVVlbLrlb1y/MTJFGVZjQACCCDgRMDykfL+A/Vy262fl5XV15r93L7uZqlraJLFi8qc9EsbBBBAAIEkApZDubZmpVSUL0qU6OsfkEDAcvNEOxYQQAABBFILWD59seq6KikomG5WOvFer4SbD8uG9WtTV+YZBBBAAAHbArYPdfcfaJC6+ib5wfe+KXOKQrY7pAECCCCAQGoBy6EcjUbl6Z0vytjYmGz/8TbJy8tLXZVnEEAAAQQcCVgO5X3768xA3vqdbzjqiEYIIIAAApcWsBzK4ZbDcu6jj+XBnzyaqDpv7tXy/e9uSTxmAQEEEEBATcByKD+8/QG1nmiNAAIIIHBJActXX1yyEhsggAACCCgLEMrKhBRAAAEE9AkQyvosqYQAAggoCxDKyoQUQAABBPQJEMr6LKmEAAIIKAsQysqEFEAAAQT0CRDK+iyphAACCCgLEMrKhBRAAAEE9AlY/uER1S57+gZUS9DeIwHmziN4xW6ZN0VAj5qnLZRLS4o92kW6VREwvrCZOxVBb9oyb964q/ZqzBunL1QVaY8AAghoFCCUNWJSCgEEEFAVIJRVBWmPAAIIaBQglDViUgoBBBBQFSCUVQVpjwACCGgUIJQ1YlIKAQQQUBUglFUFaY8AAghoFCCUNWJSCgEEEFAVsPXDI339A9LS2i7nz1+Q6qrlsqRisWr/tEcAAQQQ+ISA5VDu6T0lz7+4W7505x0SCATk1d+/IeOxf0sryj9RjkUEEEAAARUBy6Hc0NQim+7ZKEs++9+j4+HhETnU1Eooq+jTFgEEEPiUgOVQvn/zpkTTCxcuSGdXt8yfNzexjgUEEEAAAXUBy6Ec7+q11/8k+/bXycLSEvn6V74cX809AggggIAGAdtXX2zcsE4e++l2mR0KySt7XtMwBEoggAACCMQFLIfyM8/tkpFIxGyXnx+UtbeskfaOzngd7hFAAAEENAhYDuWzg4NysCGc6LLtcIcUz7068ZgFBBBAAAF1AcvnlI3zxy/s2iNtRzokGo3GAvka2XzfPeojoAICCCCAQELAciiHZhXKtq3fktHRUcnNzTWvVU5UYQEBBBBAQIuA5VCO95aXlxdf5B4BBBBAQLOA5XPKmvulHAIIIIBAEgFCOQkKqxBAAAGvBAhlr+TpFwEEEEgiQCgnQWEVAggg4JUAoeyVPP0igAACSQQI5SQorEIAAQS8EiCUvZKnXwQQQCCJQM7J3v7xJOtZhQACCCDggcB/AIK/8kS2KYi8AAAAAElFTkSuQmCC"},dx_ztHZ:function(e,n,r){"use strict";(function(t){r.d(n,"G",(function(){return y}));var e=r("dx_lwsE"),o=r.n(e),i=r("dx_W8MJ"),c=r.n(i),a=r("dx_W7W2"),l=r.n(a),s=r("dx_a1gu"),u=r.n(s),d=r("dx_Nsbk"),f=r.n(d),h=r("dx_cDcd"),p=r.n(h),v=r("dx_ZRMu"),g=r("dx_MGoZ");r("dx_U1UJ");function b(e){var n=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=f()(e);if(n){var i=f()(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return u()(this,r)}}var y=function(e){l()(r,e);var n=b(r);function r(){return o()(this,r),n.apply(this,arguments)}return c()(r,[{key:"render",value:function(){return p.a.createElement("div",{className:"iframe-placeholder-container"},p.a.createElement("span",{className:"placeholder-thumbnail"},p.a.createElement(v.S,null)),p.a.createElement("div",{className:"placeholder-text"},t("CreationDoc_iframe_thumbnail_placeholder")))}}]),r}(g.l)}).call(this,r("dx_E9Eu"))}}]);
//# sourceMappingURL=//slardar.bytedance.net/api_v2/browser/jserr/get_sourcemap?bid=docs_pc&js_filename=docx_entry.ba7358a1.chunk.js.map