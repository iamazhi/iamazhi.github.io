(window.webpackJsonp=window.webpackJsonp||[]).push([["dx_U5U"],{dx_EWn2:function(e,r,n){"use strict";var a,i,o,s,u,c,l,p,f,d;n.r(r),n.d(r,"BusinessType",(function(){return c})),n.d(r,"ImportEventSource",(function(){return l})),n.d(r,"ImportFormatTypes",(function(){return p})),n.d(r,"JobType",(function(){return a})),n.d(r,"ParseError",(function(){return s})),n.d(r,"RuntimeError",(function(){return u})),n.d(r,"UploadStatus",(function(){return o})),n.d(r,"DirectoryType",(function(){return d})),n.d(r,"isDirectory",(function(){return v})),n.d(r,"isImport",(function(){return y})),n.d(r,"registerDragAndDrop",(function(){return q})),n.d(r,"showOpenDialog",(function(){return P.G})),n.d(r,"SuiteUploader",(function(){return ou})),function(e){e[e.Upload=1]="Upload",e[e.Import=2]="Import"}(a||(a={})),function(e){e[e.File=1]="File",e[e.Directory=2]="Directory"}(i||(i={})),function(e){e[e.Pending=1]="Pending",e[e.Inflight=2]="Inflight",e[e.Success=3]="Success",e[e.Error=4]="Error",e[e.Paused=5]="Paused"}(o||(o={})),function(e){e.FolderEmpty="folder_empty",e.FolderHasFileTooLargeToUpload="folder_has_file_too_large_to_upload",e.FolderAllFilesTooLargeToUpload="folder_all_files_too_large_to_upload",e.FileTooLargeToUpload="file_too_large_to_upload",e.FileNotUploadable="file_not_uploadable",e.FolderHasFileNotImportable="folder_has_file_not_importable",e.FolderAllFilesNotImportable="folder_all_files_not_importable",e.FileTooLargeToImport="file_too_large_to_import",e.FileNotImportable="file_not_importable"}(s||(s={})),function(e){e.SubtaskParentTokenMissing="RT_0001",e.UploadUnexpected="RT_1001",e.UploadChunkRetryTooManyTimes="RT_1002",e.CreateDirectoryUnexpected="RT_2001",e.ImportUnexpected="RT_3001",e.ImportPollTooManyTimes="RT_3002"}(u||(u={})),function(e){e.WIKI="WIKI",e.SPACE="SPACE"}(c||(c={})),function(e){e.Space="1",e.Lark="2",e.Drive="3",e.Wiki="6"}(l||(l={})),function(e){e.md2docx="md2docx",e.other2docx="other2docx",e.all2bitable="all2bitable"}(p||(p={})),function(e){e[e.Folder=0]="Folder",e[e.Docs=2]="Docs",e[e.Sheets=3]="Sheets",e[e.Mindnotes=11]="Mindnotes",e[e.File=12]="File",e[e.Bitable=8]="Bitable"}(f||(f={})),function(e){e.Normal="normal",e.NewSharedFolder="new_shared_folder",e.V3Folder="v3_folder"}(d||(d={}));var h={nearbyDriveAPIAccess:!1,largeFileFastUpload:!1,smallFileDirectUpload:!1,fileSizeChecker:!1,concurrentAndRetryableUpload:!1};function v(e){return e.sourceType===i.Directory}function y(e){return e.jobType===a.Import}var g=n("dx_kV53"),k=Object(g.mo)((function(e){var r=function(e){var r,n=Object.prototype,a=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function c(e,r,n,a){var i=r&&r.prototype instanceof y?r:y,o=Object.create(i.prototype),s=new S(a||[]);return o._invoke=function(e,r,n){var a=p;return function(i,o){if(a===d)throw new Error("Generator is already running");if(a===h){if("throw"===i)throw o;return C()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var u=O(s,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===p)throw a=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=d;var c=l(e,r,n);if("normal"===c.type){if(a=n.done?h:f,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(a=h,n.method="throw",n.arg=c.arg)}}}(e,n,s),o}function l(e,r,n){try{return{type:"normal",arg:e.call(r,n)}}catch(a){return{type:"throw",arg:a}}}e.wrap=c;var p="suspendedStart",f="suspendedYield",d="executing",h="completed",v={};function y(){}function g(){}function k(){}var b={};b[o]=function(){return this};var m=Object.getPrototypeOf,T=m&&m(m(j([])));T&&T!==n&&a.call(T,o)&&(b=T);var I=k.prototype=y.prototype=Object.create(b);function U(e){["next","throw","return"].forEach((function(r){e[r]=function(e){return this._invoke(r,e)}}))}function x(e,r){function n(i,o,s,u){var c=l(e[i],e,o);if("throw"!==c.type){var p=c.arg,f=p.value;return f&&"object"===typeof f&&a.call(f,"__await")?r.resolve(f.__await).then((function(e){n("next",e,s,u)}),(function(e){n("throw",e,s,u)})):r.resolve(f).then((function(e){p.value=e,s(p)}),(function(e){return n("throw",e,s,u)}))}u(c.arg)}var i;this._invoke=function(e,a){function o(){return new r((function(r,i){n(e,a,r,i)}))}return i=i?i.then(o,o):o()}}function O(e,n){var a=e.iterator[n.method];if(a===r){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=r,O(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=l(a,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=r),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function w(e){var r={tryLoc:e[0]};1 in e&&(r.catchLoc=e[1]),2 in e&&(r.finallyLoc=e[2],r.afterLoc=e[3]),this.tryEntries.push(r)}function D(e){var r=e.completion||{};r.type="normal",delete r.arg,e.completion=r}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function j(e){if(e){var n=e[o];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function n(){for(;++i<e.length;)if(a.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=r,n.done=!0,n};return s.next=s}}return{next:C}}function C(){return{value:r,done:!0}}return g.prototype=I.constructor=k,k.constructor=g,k[u]=g.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var r="function"===typeof e&&e.constructor;return!!r&&(r===g||"GeneratorFunction"===(r.displayName||r.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,u in e||(e[u]="GeneratorFunction")),e.prototype=Object.create(I),e},e.awrap=function(e){return{__await:e}},U(x.prototype),x.prototype[s]=function(){return this},e.AsyncIterator=x,e.async=function(r,n,a,i,o){void 0===o&&(o=Promise);var s=new x(c(r,n,a,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},U(I),I[u]="Generator",I[o]=function(){return this},I.toString=function(){return"[object Generator]"},e.keys=function(e){var r=[];for(var n in e)r.push(n);return r.reverse(),function n(){for(;r.length;){var a=r.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},e.values=j,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(D),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=r)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(a,i){return u.type="throw",u.arg=e,n.next=a,i&&(n.method="next",n.arg=r),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],u=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=a.call(s,"catchLoc"),l=a.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&a.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=r&&r<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=r,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),D(n),v}},catch:function(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var i=a.arg;D(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,a){return this.delegate={iterator:j(e),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=r),v}},e}(e.exports);try{regeneratorRuntime=r}catch(n){Function("r","regeneratorRuntime = r")(r)}})),b=k,m=function(e,r){var n=this;if(!(n instanceof m))return new m(e,r);g.eu&&(n=Object(g.eu)(new Error(r),Object(g.X)(n)));var a=[];return Object(g.Q)(e,a.push,a),n.errors=a,void 0!==r&&Object(g.rP)(n,"message",String(r)),n};m.prototype=Object(g.X6)(Error.prototype,{constructor:Object(g.ve)(5,m),name:Object(g.ve)(5,"AggregateError")}),Object(g.KW)({global:!0},{AggregateError:m}),Object(g.KW)({target:"Promise",stat:!0},{allSettled:function(e){var r=this,n=g.W6.f(r),a=n.resolve,i=n.reject,o=Object(g.ms)((function(){var n=Object(g.rs)(r.resolve),i=[],o=0,s=1;Object(g.Q)(e,(function(e){var u=o++,c=!1;i.push(void 0),s++,n.call(r,e).then((function(e){c||(c=!0,i[u]={status:"fulfilled",value:e},--s||a(i))}),(function(e){c||(c=!0,i[u]={status:"rejected",reason:e},--s||a(i))}))})),--s||a(i)}));return o.error&&i(o.value),n.promise}}),Object(g.KW)({target:"Promise",stat:!0},{try:function(e){var r=g.W6.f(this),n=Object(g.ms)(e);return(n.error?r.reject:r.resolve)(n.value),r.promise}});var T="No one promise resolved";Object(g.KW)({target:"Promise",stat:!0},{any:function(e){var r=this,n=g.W6.f(r),a=n.resolve,i=n.reject,o=Object(g.ms)((function(){var n=Object(g.rs)(r.resolve),o=[],s=0,u=1,c=!1;Object(g.Q)(e,(function(e){var l=s++,p=!1;o.push(void 0),u++,n.call(r,e).then((function(e){p||c||(c=!0,a(e))}),(function(e){p||c||(p=!0,o[l]=e,--u||i(new(Object(g.j)("AggregateError"))(o,T)))}))})),--u||i(new(Object(g.j)("AggregateError"))(o,T))}));return o.error&&i(o.value),n.promise}});var I=g.Gw;function U(e,r,n,a,i,o,s){try{var u=e[o](s),c=u.value}catch(l){return void n(l)}u.done?r(c):I.resolve(c).then(a,i)}var x=function(e){return function(){var r=this,n=arguments;return new I((function(a,i){var o=e.apply(r,n);function s(e){U(o,a,i,s,u,"next",e)}function u(e){U(o,a,i,s,u,"throw",e)}s(void 0)}))}},O=function(e,r){var n=[][e];return!n||!Object(g.n)((function(){n.call(null,r||function(){throw 1},1)}))},w=g.c5.indexOf,D=[].indexOf,S=!!D&&1/[1].indexOf(1,-0)<0,j=O("indexOf");Object(g.KW)({target:"Array",proto:!0,forced:S||j},{indexOf:function(e){return S?D.apply(this,arguments)||0:w(this,e,arguments.length>1?arguments[1]:void 0)}});var C=Object(g.q4)("Array").indexOf,E=Array.prototype,A=function(e){var r=e.indexOf;return e===E||e instanceof Array&&r===E.indexOf?C:r},_=A;function q(e,r){var n=r.setDragging,a=r.handleDrop;function i(e){var r;e.preventDefault();var a=e.dataTransfer;a&&(_(a.types)&&_(r=a.types).call(r,"Files")>=0?(e.stopPropagation(),a.dropEffect="copy",a.effectAllowed="copy",n(e,!0)):(a.dropEffect="none",a.effectAllowed="none"))}function o(e){e.preventDefault(),n(e,!1)}function s(e){e.preventDefault(),n(e,!1),function(e){u.apply(this,arguments)}(e)}function u(){return(u=x(b.mark((function e(r){var n,i,o,s;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.dataTransfer){e.next=6;break}if(n=r.dataTransfer,i=n.items,o=n.files,!i||!i[0]||"string"!==i[0].kind){e.next=4;break}return e.abrupt("return");case 4:(s=i||o)&&a({list:s,event:r});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return e.addEventListener("dragenter",i),e.addEventListener("dragover",i),e.addEventListener("dragleave",o),e.addEventListener("drop",s),function(){e.removeEventListener("dragenter",i),e.removeEventListener("dragover",i),e.removeEventListener("dragleave",o),e.removeEventListener("drop",s)}}var P=n("dx_TCfX"),F=n("dx_h6a8"),z=n("dx_O4O8"),R=n.n(z),L=n("dx_vDqi"),M=n.n(L),B=n("dx_Qyje"),N=n.n(B),W=n("dx_jYEY"),K=n.n(W),Y=n("dx_x4xf"),H=n("dx_k8HI"),G=n.n(H),X=function(e,r,n){var a=Object(g.l)(r);a in e?g.Ub.f(e,a,Object(g.ve)(0,n)):e[a]=n},J=Math.max,Q=Math.min,V=9007199254740991,$="Maximum allowed length exceeded";Object(g.KW)({target:"Array",proto:!0,forced:!Object(P.v)("splice")},{splice:function(e,r){var n,a,i,o,s,u,c=Object(g.w)(this),l=Object(g.i)(c.length),p=Object(g.rk)(e,l),f=arguments.length;if(0===f?n=a=0:1===f?(n=0,a=l-p):(n=f-2,a=Q(J(Object(g.CA)(r),0),l-p)),l+n-a>V)throw TypeError($);for(i=Object(P.e)(c,a),o=0;o<a;o++)(s=p+o)in c&&X(i,o,c[s]);if(i.length=a,n<a){for(o=p;o<l-a;o++)u=o+n,(s=o+a)in c?c[u]=c[s]:delete c[u];for(o=l;o>l-a+n;o--)delete c[o-1]}else if(n>a)for(o=l-a;o>p;o--)u=o+n-1,(s=o+a-1)in c?c[u]=c[s]:delete c[u];for(o=0;o<n;o++)c[o+p]=arguments[o+2];return c.length=l-a+n,i}});var Z=Object(g.q4)("Array").splice,ee=Array.prototype,te=function(e){var r=e.splice;return e===ee||e instanceof Array&&r===ee.splice?Z:r},re=P.m.every;Object(g.KW)({target:"Array",proto:!0,forced:O("every")},{every:function(e){return re(this,e,arguments.length>1?arguments[1]:void 0)}});var ne=Object(g.q4)("Array").every,ae=Array.prototype,ie=function(e){var r=e.every;return e===ae||e instanceof Array&&r===ae.every?ne:r},oe=Number.MAX_VALUE;function se(e,r){return ie(r).call(r,(function(r){return!function(e,r){return new RegExp(".+.".concat(r,"$"),"i").test(e)}(e,r)}))}function ue(e,r,n,a){return r>n||Boolean(a&&se(e,a))}function ce(e,r){return"number"===typeof r?r:e===a.Import?20971520:oe}function le(e,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];for(var o=0,s=a;o<s.length;o++){var u=s[o],c=_(u).call(u,e);if(-1!==c)return r&&te(u).call(u,c,1),!0}return!1}Object(g.KW)({target:"Object",stat:!0,forced:!g.e,sham:!g.e},{defineProperty:g.Ub.f});var pe=Object(g.mo)((function(e){var r=g.Y.Object,n=e.exports=function(e,n,a){return r.defineProperty(e,n,a)};r.defineProperty.sham&&(n.sham=!0)})),fe=pe;Object(g.KW)({target:"Object",stat:!0,forced:!g.e,sham:!g.e},{defineProperties:g.v});var de=Object(g.mo)((function(e){var r=g.Y.Object,n=e.exports=function(e,n){return r.defineProperties(e,n)};r.defineProperties.sham&&(n.sham=!0)})),he=de,ve=g.t.concat("length","prototype"),ye={f:Object.getOwnPropertyNames||function(e){return Object(g.q)(e,ve)}},ge={f:Object.getOwnPropertySymbols},ke=Object(g.j)("Reflect","ownKeys")||function(e){var r=ye.f(Object(g.G)(e)),n=ge.f;return n?r.concat(n(e)):r};Object(g.KW)({target:"Object",stat:!0,sham:!g.e},{getOwnPropertyDescriptors:function(e){for(var r,n,a=Object(g.I)(e),i=g.c.f,o=ke(a),s={},u=0;o.length>u;)void 0!==(n=i(a,r=o[u++]))&&X(s,r,n);return s}});var be=g.Y.Object.getOwnPropertyDescriptors,me=P.m.forEach,Te=O("forEach")?function(e){return me(this,e,arguments.length>1?arguments[1]:void 0)}:[].forEach;Object(g.KW)({target:"Array",proto:!0,forced:[].forEach!=Te},{forEach:Te});var Ie=Object(g.q4)("Array").forEach,Ue=Array.prototype,xe={DOMTokenList:!0,NodeList:!0},Oe=function(e){var r=e.forEach;return e===Ue||e instanceof Array&&r===Ue.forEach||xe.hasOwnProperty(Object(g.D)(e))?Ie:r},we=g.c.f,De=Object(g.n)((function(){we(1)})),Se=!g.e||De;Object(g.KW)({target:"Object",stat:!0,forced:Se,sham:!g.e},{getOwnPropertyDescriptor:function(e,r){return we(Object(g.I)(e),r)}});var je=Object(g.mo)((function(e){var r=g.Y.Object,n=e.exports=function(e,n){return r.getOwnPropertyDescriptor(e,n)};r.getOwnPropertyDescriptor.sham&&(n.sham=!0)})),Ce=je,Ee=P.m.filter;Object(g.KW)({target:"Array",proto:!0,forced:!Object(P.v)("filter")},{filter:function(e){return Ee(this,e,arguments.length>1?arguments[1]:void 0)}});var Ae=Object(g.q4)("Array").filter,_e=Array.prototype,qe=function(e){var r=e.filter;return e===_e||e instanceof Array&&r===_e.filter?Ae:r},Pe=ye.f,Fe={}.toString,ze="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Re={f:function(e){return ze&&"[object Window]"==Fe.call(e)?function(e){try{return Pe(e)}catch(r){return ze.slice()}}(e):Pe(Object(g.I)(e))}},Le={f:g.xR},Me=g.Ub.f,Be=function(e){var r=g.Y.Symbol||(g.Y.Symbol={});Object(g.P)(r,e)||Me(r,e,{value:Le.f(e)})},Ne=P.m.forEach,We=Object(g.C)("hidden"),Ke="Symbol",Ye=Object(g.xR)("toPrimitive"),He=g.J.set,Ge=g.J.getterFor(Ke),Xe=Object.prototype,Je=g.L.Symbol,Qe=g.L.JSON,Ve=Qe&&Qe.stringify,$e=g.c.f,Ze=g.Ub.f,et=Re.f,tt=g.IV.f,rt=Object(g.z)("symbols"),nt=Object(g.z)("op-symbols"),at=Object(g.z)("string-to-symbol-registry"),it=Object(g.z)("symbol-to-string-registry"),ot=Object(g.z)("wks"),st=g.L.QObject,ut=!st||!st.prototype||!st.prototype.findChild,ct=g.e&&Object(g.n)((function(){return 7!=Object(g.X6)(Ze({},"a",{get:function(){return Ze(this,"a",{value:7}).a}})).a}))?function(e,r,n){var a=$e(Xe,r);a&&delete Xe[r],Ze(e,r,n),a&&e!==Xe&&Ze(Xe,r,a)}:Ze,lt=function(e,r){var n=rt[e]=Object(g.X6)(Je.prototype);return He(n,{type:Ke,tag:e,description:r}),g.e||(n.description=r),n},pt=g.R&&"symbol"==typeof Je.iterator?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof Je},ft=function(e,r,n){e===Xe&&ft(nt,r,n),Object(g.G)(e);var a=Object(g.l)(r,!0);return Object(g.G)(n),Object(g.P)(rt,a)?(n.enumerable?(Object(g.P)(e,We)&&e[We][a]&&(e[We][a]=!1),n=Object(g.X6)(n,{enumerable:Object(g.ve)(0,!1)})):(Object(g.P)(e,We)||Ze(e,We,Object(g.ve)(1,{})),e[We][a]=!0),ct(e,a,n)):Ze(e,a,n)},dt=function(e,r){Object(g.G)(e);var n=Object(g.I)(r),a=Object(g.y)(n).concat(gt(n));return Ne(a,(function(r){g.e&&!ht.call(n,r)||ft(e,r,n[r])})),e},ht=function(e){var r=Object(g.l)(e,!0),n=tt.call(this,r);return!(this===Xe&&Object(g.P)(rt,r)&&!Object(g.P)(nt,r))&&(!(n||!Object(g.P)(this,r)||!Object(g.P)(rt,r)||Object(g.P)(this,We)&&this[We][r])||n)},vt=function(e,r){var n=Object(g.I)(e),a=Object(g.l)(r,!0);if(n!==Xe||!Object(g.P)(rt,a)||Object(g.P)(nt,a)){var i=$e(n,a);return!i||!Object(g.P)(rt,a)||Object(g.P)(n,We)&&n[We][a]||(i.enumerable=!0),i}},yt=function(e){var r=et(Object(g.I)(e)),n=[];return Ne(r,(function(e){Object(g.P)(rt,e)||Object(g.P)(g.W,e)||n.push(e)})),n},gt=function(e){var r=e===Xe,n=et(r?nt:Object(g.I)(e)),a=[];return Ne(n,(function(e){!Object(g.P)(rt,e)||r&&!Object(g.P)(Xe,e)||a.push(rt[e])})),a};g.R||(Je=function(){if(this instanceof Je)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,r=Object(g.m)(e),n=function(e){this===Xe&&n.call(nt,e),Object(g.P)(this,We)&&Object(g.P)(this[We],r)&&(this[We][r]=!1),ct(this,r,Object(g.ve)(1,e))};return g.e&&ut&&ct(Xe,r,{configurable:!0,set:n}),lt(r,e)},Object(g.K)(Je.prototype,"toString",(function(){return Ge(this).tag})),g.IV.f=ht,g.Ub.f=ft,g.c.f=vt,ye.f=Re.f=yt,ge.f=gt,g.e&&Ze(Je.prototype,"description",{configurable:!0,get:function(){return Ge(this).description}}),Le.f=function(e){return lt(Object(g.xR)(e),e)}),Object(g.KW)({global:!0,wrap:!0,forced:!g.R,sham:!g.R},{Symbol:Je}),Ne(Object(g.y)(ot),(function(e){Be(e)})),Object(g.KW)({target:Ke,stat:!0,forced:!g.R},{for:function(e){var r=String(e);if(Object(g.P)(at,r))return at[r];var n=Je(r);return at[r]=n,it[n]=r,n},keyFor:function(e){if(!pt(e))throw TypeError(e+" is not a symbol");if(Object(g.P)(it,e))return it[e]},useSetter:function(){ut=!0},useSimple:function(){ut=!1}}),Object(g.KW)({target:"Object",stat:!0,forced:!g.R,sham:!g.e},{create:function(e,r){return void 0===r?Object(g.X6)(e):dt(Object(g.X6)(e),r)},defineProperty:ft,defineProperties:dt,getOwnPropertyDescriptor:vt}),Object(g.KW)({target:"Object",stat:!0,forced:!g.R},{getOwnPropertyNames:yt,getOwnPropertySymbols:gt}),Object(g.KW)({target:"Object",stat:!0,forced:Object(g.n)((function(){ge.f(1)}))},{getOwnPropertySymbols:function(e){return ge.f(Object(g.w)(e))}}),Qe&&Object(g.KW)({target:"JSON",stat:!0,forced:!g.R||Object(g.n)((function(){var e=Je();return"[null]"!=Ve([e])||"{}"!=Ve({a:e})||"{}"!=Ve(Object(e))}))},{stringify:function(e){for(var r,n,a=[e],i=1;arguments.length>i;)a.push(arguments[i++]);if(n=r=a[1],(Object(g.U)(r)||void 0!==e)&&!pt(e))return Object(P.Q)(r)||(r=function(e,r){if("function"==typeof n&&(r=n.call(this,e,r)),!pt(r))return r}),a[1]=r,Ve.apply(Qe,a)}}),Je.prototype[Ye]||Object(g.rP)(Je.prototype,Ye,Je.prototype.valueOf),Object(g.p)(Je,Ke),g.W[We]=!0;var kt=g.Y.Object.getOwnPropertySymbols,bt=kt,mt=Object(g.n)((function(){Object(g.y)(1)}));Object(g.KW)({target:"Object",stat:!0,forced:mt},{keys:function(e){return Object(g.y)(Object(g.w)(e))}});var Tt=g.Y.Object.keys,It=Tt,Ut=pe;var xt=function(e,r,n){return r in e?Ut(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e};var Ot=function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")};Be("iterator");var wt=Le.f("iterator"),Dt=Object(g.xR)("isConcatSpreadable"),St=9007199254740991,jt="Maximum allowed index exceeded",Ct=!Object(g.n)((function(){var e=[];return e[Dt]=!1,e.concat()[0]!==e})),Et=Object(P.v)("concat"),At=function(e){if(!Object(g.U)(e))return!1;var r=e[Dt];return void 0!==r?!!r:Object(P.Q)(e)},_t=!Ct||!Et;Object(g.KW)({target:"Array",proto:!0,forced:_t},{concat:function(e){var r,n,a,i,o,s=Object(g.w)(this),u=Object(P.e)(s,0),c=0;for(r=-1,a=arguments.length;r<a;r++)if(At(o=-1===r?s:arguments[r])){if(c+(i=Object(g.i)(o.length))>St)throw TypeError(jt);for(n=0;n<i;n++,c++)n in o&&X(u,c,o[n])}else{if(c>=St)throw TypeError(jt);X(u,c++,o)}return u.length=c,u}}),Be("asyncIterator"),Be("hasInstance"),Be("isConcatSpreadable"),Be("match"),Be("matchAll"),Be("replace"),Be("search"),Be("species"),Be("split"),Be("toPrimitive"),Be("toStringTag"),Be("unscopables"),Object(g.p)(Math,"Math",!0),Object(g.p)(g.L.JSON,"JSON",!0);var qt=g.Y.Symbol;Be("dispose"),Be("observable"),Be("patternMatch"),Be("replaceAll");var Pt=qt,Ft=Object(g.mo)((function(e){function r(e){return r="function"===typeof Pt&&"symbol"===typeof wt?function(e){return typeof e}:function(e){return e&&"function"===typeof Pt&&e.constructor===Pt&&e!==Pt.prototype?"symbol":typeof e},r(e)}function n(a){return"function"===typeof Pt&&"symbol"===r(wt)?e.exports=n=function(e){return r(e)}:e.exports=n=function(e){return e&&"function"===typeof Pt&&e.constructor===Pt&&e!==Pt.prototype?"symbol":r(e)},n(a)}e.exports=n}));var zt=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e};var Rt=function(e,r){return!r||"object"!==Ft(r)&&"function"!==typeof r?zt(e):r},Lt=Object(g.n)((function(){Object(g.X)(1)}));Object(g.KW)({target:"Object",stat:!0,forced:Lt,sham:!g.a},{getPrototypeOf:function(e){return Object(g.X)(Object(g.w)(e))}});var Mt=g.Y.Object.getPrototypeOf;Object(g.KW)({target:"Object",stat:!0},{setPrototypeOf:g.eu});var Bt=g.Y.Object.setPrototypeOf,Nt=Object(g.mo)((function(e){function r(n){return e.exports=r=Bt?Mt:function(e){return e.__proto__||Mt(e)},r(n)}e.exports=r}));Object(g.KW)({target:"Object",stat:!0,sham:!g.e},{create:g.X6});var Wt=g.Y.Object,Kt=function(e,r){return Wt.create(e,r)},Yt=Object(g.mo)((function(e){function r(n,a){return e.exports=r=Bt||function(e,r){return e.__proto__=r,e},r(n,a)}e.exports=r}));var Ht=function(e,r){if("function"!==typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");e.prototype=Kt(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),r&&Yt(e,r)},Gt=function(e){return function(r,n,a,i){Object(g.rs)(n);var o=Object(g.w)(r),s=Object(g.eh)(o),u=Object(g.i)(o.length),c=e?u-1:0,l=e?-1:1;if(a<2)for(;;){if(c in s){i=s[c],c+=l;break}if(c+=l,e?c<0:u<=c)throw TypeError("Reduce of empty array with no initial value")}for(;e?c>=0:u>c;c+=l)c in s&&(i=n(i,s[c],c,o));return i}},Xt={left:Gt(!1),right:Gt(!0)}.left;Object(g.KW)({target:"Array",proto:!0,forced:O("reduce")},{reduce:function(e){return Xt(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}});var Jt=Object(g.q4)("Array").reduce,Qt=Array.prototype,Vt=function(e){var r=e.reduce;return e===Qt||e instanceof Array&&r===Qt.reduce?Jt:r},$t=!Object(g.n)((function(){return Object.isExtensible(Object.preventExtensions({}))})),Zt=Object(g.mo)((function(e){var r=g.Ub.f,n=Object(g.m)("meta"),a=0,i=Object.isExtensible||function(){return!0},o=function(e){r(e,n,{value:{objectID:"O"+ ++a,weakData:{}}})},s=e.exports={REQUIRED:!1,fastKey:function(e,r){if(!Object(g.U)(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!Object(g.P)(e,n)){if(!i(e))return"F";if(!r)return"E";o(e)}return e[n].objectID},getWeakData:function(e,r){if(!Object(g.P)(e,n)){if(!i(e))return!0;if(!r)return!1;o(e)}return e[n].weakData},onFreeze:function(e){return $t&&s.REQUIRED&&i(e)&&!Object(g.P)(e,n)&&o(e),e}};g.W[n]=!0})),er=(Zt.REQUIRED,Zt.fastKey,Zt.getWeakData,Zt.onFreeze,g.Ub.f),tr=P.m.forEach,rr=g.J.set,nr=g.J.getterFor,ar=function(e,r,n,a,i){var o,s=g.L[e],u=s&&s.prototype,c=a?"set":"add",l={};if(g.e&&"function"==typeof s&&(i||u.forEach&&!Object(g.n)((function(){(new s).entries().next()})))){o=r((function(r,n){rr(Object(g.A)(r,o,e),{type:e,collection:new s}),void 0!=n&&Object(g.Q)(n,r[c],r,a)}));var p=nr(e);tr(["add","clear","delete","forEach","get","has","set","keys","values","entries"],(function(e){var r="add"==e||"set"==e;!(e in u)||i&&"clear"==e||Object(g.rP)(o.prototype,e,(function(n,a){var o=p(this).collection;if(!r&&i&&!Object(g.U)(n))return"get"==e&&void 0;var s=o[e](0===n?0:n,a);return r?this:s}))})),i||er(o.prototype,"size",{get:function(){return p(this).collection.size}})}else o=n.getConstructor(r,e,a,c),Zt.REQUIRED=!0;return Object(g.p)(o,e,!1,!0),l[e]=o,Object(g.KW)({global:!0,forced:!0},l),i||n.setStrong(o,e,a),o},ir=g.Ub.f,or=Zt.fastKey,sr=g.J.set,ur=g.J.getterFor,cr={getConstructor:function(e,r,n,a){var i=e((function(e,o){Object(g.A)(e,i,r),sr(e,{type:r,index:Object(g.X6)(null),first:void 0,last:void 0,size:0}),g.e||(e.size=0),void 0!=o&&Object(g.Q)(o,e[a],e,n)})),o=ur(r),s=function(e,r,n){var a,i,s=o(e),c=u(e,r);return c?c.value=n:(s.last=c={index:i=or(r,!0),key:r,value:n,previous:a=s.last,next:void 0,removed:!1},s.first||(s.first=c),a&&(a.next=c),g.e?s.size++:e.size++,"F"!==i&&(s.index[i]=c)),e},u=function(e,r){var n,a=o(e),i=or(r);if("F"!==i)return a.index[i];for(n=a.first;n;n=n.next)if(n.key==r)return n};return Object(g.N)(i.prototype,{clear:function(){for(var e=o(this),r=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete r[n.index],n=n.next;e.first=e.last=void 0,g.e?e.size=0:this.size=0},delete:function(e){var r=this,n=o(r),a=u(r,e);if(a){var i=a.next,s=a.previous;delete n.index[a.index],a.removed=!0,s&&(s.next=i),i&&(i.previous=s),n.first==a&&(n.first=i),n.last==a&&(n.last=s),g.e?n.size--:r.size--}return!!a},forEach:function(e){for(var r,n=o(this),a=Object(g.GC)(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.next:n.first;)for(a(r.value,r.key,this);r&&r.removed;)r=r.previous},has:function(e){return!!u(this,e)}}),Object(g.N)(i.prototype,n?{get:function(e){var r=u(this,e);return r&&r.value},set:function(e,r){return s(this,0===e?0:e,r)}}:{add:function(e){return s(this,e=0===e?0:e,e)}}),g.e&&ir(i.prototype,"size",{get:function(){return o(this).size}}),i},setStrong:function(e,r,n){var a=r+" Iterator",i=ur(r),o=ur(a);Object(g.pY)(e,r,(function(e,r){sr(this,{type:a,target:e,state:i(e),kind:r,last:void 0})}),(function(){for(var e=o(this),r=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==r?{value:n.key,done:!1}:"values"==r?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),Object(g.Ca)(r)}},lr=(ar("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),cr),g.Y.Set),pr=Object(g.q4)("Array").values,fr=Array.prototype,dr={DOMTokenList:!0,NodeList:!0},hr=function(e){var r=e.values;return e===fr||e instanceof Array&&r===fr.values||dr.hasOwnProperty(Object(g.D)(e))?pr:r};Object(g.KW)({target:"Array",stat:!0},{isArray:P.Q});var vr=g.Y.Array.isArray,yr=vr;var gr=function(e){if(yr(e)){for(var r=0,n=new Array(e.length);r<e.length;r++)n[r]=e[r];return n}},kr=function(e){var r,n,a,i,o=Object(g.w)(e),s="function"==typeof this?this:Array,u=arguments.length,c=u>1?arguments[1]:void 0,l=void 0!==c,p=0,f=Object(g.x)(o);if(l&&(c=Object(g.GC)(c,u>2?arguments[2]:void 0,2)),void 0==f||s==Array&&Object(g.Gf)(f))for(n=new s(r=Object(g.i)(o.length));r>p;p++)X(n,p,l?c(o[p],p):o[p]);else for(i=f.call(o),n=new s;!(a=i.next()).done;p++)X(n,p,l?Object(g.r)(i,c,[a.value,p],!0):a.value);return n.length=p,n},br=!Object(g.W7)((function(e){Array.from(e)}));Object(g.KW)({target:"Array",stat:!0,forced:br},{from:kr});var mr=g.Y.Array.from,Tr=mr,Ir=Object(g.xR)("iterator"),Ur=function(e){var r=Object(e);return void 0!==r[Ir]||"@@iterator"in r||g.q8.hasOwnProperty(Object(g.D)(r))};var xr=function(e){if(Ur(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e))return Tr(e)};var Or=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")};var wr=function(e){return gr(e)||xr(e)||Or()},Dr=Object(g.q4)("Array").concat,Sr=Array.prototype,jr=function(e){var r=e.concat;return e===Sr||e instanceof Array&&r===Sr.concat?Dr:r},Cr=vr,Er=P.m.findIndex,Ar="findIndex",_r=!0;Ar in[]&&Array(1).findIndex((function(){_r=!1})),Object(g.KW)({target:"Array",proto:!0,forced:_r},{findIndex:function(e){return Er(this,e,arguments.length>1?arguments[1]:void 0)}});var qr=Object(g.q4)("Array").findIndex,Pr=Array.prototype,Fr=function(e){var r=e.findIndex;return e===Pr||e instanceof Array&&r===Pr.findIndex?qr:r},zr=P.m.find,Rr="find",Lr=!0;Rr in[]&&Array(1).find((function(){Lr=!1})),Object(g.KW)({target:"Array",proto:!0,forced:Lr},{find:function(e){return zr(this,e,arguments.length>1?arguments[1]:void 0)}});var Mr=Object(g.q4)("Array").find,Br=Array.prototype,Nr=function(e){var r=e.find;return e===Br||e instanceof Array&&r===Br.find?Mr:r},Wr=function(e){var r=Object(g.x)(e);if("function"!=typeof r)throw TypeError(String(e)+" is not iterable");return Object(g.G)(r.call(e))},Kr=Wr,Yr=Object(g.xR)("species"),Hr=[].slice,Gr=Math.max;Object(g.KW)({target:"Array",proto:!0,forced:!Object(P.v)("slice")},{slice:function(e,r){var n,a,i,o=Object(g.I)(this),s=Object(g.i)(o.length),u=Object(g.rk)(e,s),c=Object(g.rk)(void 0===r?s:r,s);if(Object(P.Q)(o)&&("function"!=typeof(n=o.constructor)||n!==Array&&!Object(P.Q)(n.prototype)?Object(g.U)(n)&&null===(n=n[Yr])&&(n=void 0):n=void 0,n===Array||void 0===n))return Hr.call(o,u,c);for(a=new(void 0===n?Array:n)(Gr(c-u,0)),i=0;u<c;u++,i++)u in o&&X(a,i,o[u]);return a.length=i,a}});var Xr=Object(g.q4)("Array").slice,Jr=Array.prototype,Qr=function(e){var r=e.slice;return e===Jr||e instanceof Array&&r===Jr.slice?Xr:r},Vr=(ar("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),cr,!0),g.Y.Map);function $r(e,r){for(var n=0;n<r.length;n++){var a=r[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Ut(e,a.key,a)}}var Zr=function(e,r,n){return r&&$r(e.prototype,r),n&&$r(e,n),e},en=A,tn=kt,rn=Tt;var nn=function(e,r){if(null==e)return{};var n,a,i={},o=rn(e);for(a=0;a<o.length;a++)n=o[a],en(r).call(r,n)>=0||(i[n]=e[n]);return i};var an=function(e,r){if(null==e)return{};var n,a,i=nn(e,r);if(tn){var o=tn(e);for(a=0;a<o.length;a++)n=o[a],en(r).call(r,n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i},on="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function sn(e){void 0===e&&(e=20);for(var r="",n=0;n<e;n++){var a=Math.floor(Math.random()*on.length);r+=on[a]}return r}var un=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var r=16*Math.random()|0;return("x"===e?r:3&r|8).toString(16)}))},cn=function e(r){var n=r.id,a=r.sourceType,i=r.name;Ot(this,e),this.id=n||un(),this.sourceType=a,this.name=i},ln=function(e){function r(e){var n,a=e.jobType,i=e.bizPayload,s=an(e,["jobType","bizPayload"]);return Ot(this,r),(n=Rt(this,Nt(r).call(this,s))).status=o.Pending,n.jobType=a,n.bizPayload=i,n}return Ht(r,e),Zr(r,[{key:"canPause",get:function(){return this.status===o.Pending||this.status===o.Inflight}},{key:"canRetry",get:function(){return this.status===o.Paused||this.status===o.Error}}]),r}(cn),pn=function(e){function r(e){var n,o=e.file,u=e.options;Ot(this,r),(n=Rt(this,Nt(r).call(this,{jobType:u.jobType,sourceType:i.File,name:o.name,bizPayload:u.bizPayload})))._uploadedSize=0,n.file=o,n.totalSize=o.size;var c=ce(u.jobType,u.sizeLimit);if(ue(o.name,o.size,c,u.extensions)){var l=o.size>c;n.parseError=u.jobType===a.Import?l?s.FileTooLargeToImport:s.FileNotImportable:l?s.FileTooLargeToUpload:s.FileNotUploadable,n.failedToParseFiles=[o.name],n.failedFiles=[{name:o.name,size:o.size}],n.shouldAbort=!0}return n}return Ht(r,e),Zr(r,[{key:"start",value:function(){this.status=o.Inflight}},{key:"finish",value:function(){this.status=this.error?o.Error:o.Success}},{key:"pause",value:function(e){this.status=o.Paused,this.pausedByOffline=Boolean(e)}},{key:"retry",value:function(){this.status=o.Pending,this.pausedByOffline=!1}},{key:"uploadedSize",set:function(e){this._uploadedSize=Math.min(Math.max(e,0),this.totalSize)},get:function(){return this._uploadedSize}},{key:"progress",get:function(){return 0===this.totalSize?0:Math.round(this.uploadedSize/this.totalSize*100)/100}}]),r}(ln),fn=function(e){function r(e){var n,i=e.file,o=e.options;return Ot(this,r),(n=Rt(this,Nt(r).call(this,{file:i,options:o}))).parentToken=o.parentToken,n.options=o,o.jobType===a.Upload&&(n.fileToken=o.fileToken,n.memberID=o.memberID,n.shouldAddToRecents=o.shouldAddToRecents),n}return Ht(r,e),Zr(r,[{key:"mountPoint",get:function(){return this.jobType===a.Import?void 0:this.options.mountPoint||"explorer"}}]),r}(pn),dn=function(e){function r(e){var n=e.file,a=e.options;return Ot(this,r),Rt(this,Nt(r).call(this,{file:n,options:a}))}return Ht(r,e),r}(pn),hn=mr,vn=Math.min,yn=[].lastIndexOf,gn=!!yn&&1/[1].lastIndexOf(1,-0)<0,kn=O("lastIndexOf"),bn=gn||kn?function(e){if(gn)return yn.apply(this,arguments)||0;var r=Object(g.I)(this),n=Object(g.i)(r.length),a=n-1;for(arguments.length>1&&(a=vn(a,Object(g.CA)(arguments[1]))),a<0&&(a=n+a);a>=0;a--)if(a in r&&r[a]===e)return a||0;return-1}:yn;Object(g.KW)({target:"Array",proto:!0,forced:bn!==[].lastIndexOf},{lastIndexOf:bn});var mn=Object(g.q4)("Array").lastIndexOf,Tn=Array.prototype,In=function(e){var r=e.lastIndexOf;return e===Tn||e instanceof Array&&r===Tn.lastIndexOf?mn:r};function Un(e){return new Promise((function(r){e.file(r)}))}function xn(e){return e.webkitRelativePath}function On(e){return new Promise((function(r,n){var a=new FileReader;a.onload=function(){r(a.result)},a.onerror=function(){n("upload read blob error")},a.readAsArrayBuffer(e)}))}function wn(e,r){var n=It(e);if(bt){var a=bt(e);r&&(a=qe(a).call(a,(function(r){return Ce(e,r).enumerable}))),n.push.apply(n,a)}return n}var Dn=function(e){function r(e){var n,a=e.isRoot,o=e.parentId,s=e.parentToken,u=an(e,["isRoot","parentId","parentToken"]);return Ot(this,r),n=Rt(this,Nt(r).call(this,function(e){for(var r=1;r<arguments.length;r++){var n,a=null!=arguments[r]?arguments[r]:{};if(r%2)Oe(n=wn(Object(a),!0)).call(n,(function(r){xt(e,r,a[r])}));else if(be)he(e,be(a));else{var i;Oe(i=wn(Object(a))).call(i,(function(r){fe(e,r,Ce(a,r))}))}}return e}({},u,{sourceType:i.Directory}))),n.parentId=o,n.parentToken=s,n.isRoot=Boolean(a),n.children=[],n}return Ht(r,e),Zr(r,[{key:"addChild",value:function(e){this.children.push(e)}}]),r}(cn);function Sn(e,r){var n=It(e);if(bt){var a=bt(e);r&&(a=qe(a).call(a,(function(r){return Ce(e,r).enumerable}))),n.push.apply(n,a)}return n}var jn=function(e){function r(e){var n,a=e.file,o=e.jobType,s=e.parentId,u=an(e,["file","jobType","parentId"]);return Ot(this,r),n=Rt(this,Nt(r).call(this,function(e){for(var r=1;r<arguments.length;r++){var n,a=null!=arguments[r]?arguments[r]:{};if(r%2)Oe(n=Sn(Object(a),!0)).call(n,(function(r){xt(e,r,a[r])}));else if(be)he(e,be(a));else{var i;Oe(i=Sn(Object(a))).call(i,(function(r){fe(e,r,Ce(a,r))}))}}return e}({},u,{sourceType:i.File,name:a.name}))),n._uploadedSize=0,n.file=a,n.jobType=o,n.parentId=s,n.totalSize=a.size,n}return Ht(r,e),Zr(r,[{key:"uploadedSize",set:function(e){this._uploadedSize=Math.min(Math.max(e,0),this.totalSize)},get:function(){return this._uploadedSize}}]),r}(cn);function Cn(e,r){var n=It(e);if(bt){var a=bt(e);r&&(a=qe(a).call(a,(function(r){return Ce(e,r).enumerable}))),n.push.apply(n,a)}return n}function En(e){for(var r=1;r<arguments.length;r++){var n,a=null!=arguments[r]?arguments[r]:{};if(r%2)Oe(n=Cn(Object(a),!0)).call(n,(function(r){xt(e,r,a[r])}));else if(be)he(e,be(a));else{var i;Oe(i=Cn(Object(a))).call(i,(function(r){fe(e,r,Ce(a,r))}))}}return e}var An="___root___";function _n(e){return e.substring(0,In(e).call(e,"/"))}function qn(e,r){return Cr(e)?function(e,r){return Pn.apply(this,arguments)}(e,r):function(e,r){return Fn.apply(this,arguments)}(e,r)}function Pn(){return(Pn=x(b.mark((function e(r,n){var i,o,u,c,l,p,f,d,h,v,y,g,k,m,T,I,U,x,O,w,D,S,j,C;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==r.length){e.next=2;break}return e.abrupt("return",{subtasks:[],subtaskMap:{},totalCount:0,totalSize:0,parseError:s.FolderEmpty,shouldAbort:!0});case 2:i={},o=[],u=new Vr,c=[],l=ce(n.jobType,n.sizeLimit),p=Rn(r),f=new Dn({name:p,isRoot:!0,parentId:An,parentToken:n.parentToken}),i[f.id]=f,o.push(f),u.set(p,f),d=!0,h=!1,v=void 0,e.prev=15,y=Kr(r);case 17:if(d=(g=y.next()).done){e.next=48;break}if(k=g.value,m=xn(k),T=_n(m),I=u.get(T)){e.next=44;break}for(U=_n(T),x=[T],O=U;O&&!u.get(O);)x.push(O),O=_n(O);case 27:if(!(x.length>0)){e.next=40;break}if(w=x.pop(),D=u.get(_n(w))){e.next=33;break}return console.error("Unexpected error"),e.abrupt("break",40);case 33:S=new Dn({isRoot:!1,parentId:D.id,name:w.substring(In(w).call(w,"/")+1)}),D.addChild(S.id),i[S.id]=S,o.push(S),u.set(w,S),e.next=27;break;case 40:if(I=u.get(T)){e.next=44;break}return console.error("Unexpected error"),e.abrupt("continue",45);case 44:ue(k.name,k.size,l,n.extensions)?c.push({name:k.name,size:k.size}):(j=new jn({file:k,parentId:I.id,jobType:n.jobType}),i[j.id]=j,o.push(j),I.addChild(j.id));case 45:d=!0,e.next=17;break;case 48:e.next=54;break;case 50:e.prev=50,e.t0=e.catch(15),h=!0,v=e.t0;case 54:e.prev=54,e.prev=55,d||null==y.return||y.return();case 57:if(e.prev=57,!h){e.next=60;break}throw v;case 60:return e.finish(57);case 61:return e.finish(54);case 62:return C=zn(o,n.jobType===a.Import,c),e.abrupt("return",En({subtaskMap:i,subtasks:Object(P.Y)(o).call(o,(function(e){return e.id}))},C));case 64:case"end":return e.stop()}}),e,null,[[15,50,54,62],[55,,57,61]])})))).apply(this,arguments)}function Fn(){return Fn=x(b.mark((function e(r,n){var i,o,u,c,l,p,f,d,h;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i={},o=[],u=[],c=[],l=ce(n.jobType,n.sizeLimit),p=0,f={id:un(),entry:r,parentId:An},d=b.mark((function e(){var r,a,s,d,h,v,y,g;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=f.id,a=f.entry,s=f.parentId,h=new Dn({isRoot:d=s===An,id:r,name:f.entry.name,parentId:s,parentToken:d?n.parentToken:void 0}),i[r]=h,o.push(h),v=a.createReader(),y=function(){return new P.ms((function(e){v.readEntries(function(){var a=x(b.mark((function a(s){var f,d,v,y,g,k,m,T,I;return b.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:f=!0,d=!1,v=void 0,a.prev=3,y=Kr(s);case 5:if(f=(g=y.next()).done){a.next=22;break}if(!(k=g.value).isDirectory){a.next=13;break}m=un(),u.push({id:m,entry:k,parentId:r}),h.addChild(m),a.next=19;break;case 13:if(!k.isFile){a.next=19;break}return a.next=16,Un(k);case 16:T=a.sent,p+=1,ue(T.name,T.size,l,n.extensions)?c.push({name:T.name,size:T.size}):(I=new jn({file:T,parentId:r,jobType:n.jobType}),i[I.id]=I,o.push(I),h.addChild(I.id));case 19:f=!0,a.next=5;break;case 22:a.next=28;break;case 24:a.prev=24,a.t0=a.catch(3),d=!0,v=a.t0;case 28:a.prev=28,a.prev=29,f||null==y.return||y.return();case 31:if(a.prev=31,!d){a.next=34;break}throw v;case 34:return a.finish(31);case 35:return a.finish(28);case 36:e(s.length>0);case 37:case"end":return a.stop()}}),a,null,[[3,24,28,36],[29,,31,35]])})));return function(e){return a.apply(this,arguments)}}())}))},e.next=11,y();case 11:g=e.sent;case 12:if(!g){e.next=18;break}return e.next=15,y();case 15:g=e.sent,e.next=12;break;case 18:f=u.shift();case 19:case"end":return e.stop()}}),e)}));case 8:if(!f){e.next=12;break}return e.delegateYield(d(),"t0",10);case 10:e.next=8;break;case 12:if(0!==p){e.next=14;break}return e.abrupt("return",{subtasks:[],subtaskMap:{},totalCount:0,totalSize:0,parseError:s.FolderEmpty,shouldAbort:!0});case 14:return h=zn(o,n.jobType===a.Import,c),e.abrupt("return",En({subtaskMap:i,subtasks:Object(P.Y)(o).call(o,(function(e){return e.id}))},h));case 16:case"end":return e.stop()}}),e)}))),Fn.apply(this,arguments)}function zn(e,r){var n,a,i,o,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c=qe(e).call(e,(function(e){return e instanceof jn})),l=Vt(c).call(c,(function(e,r){return e+r.totalSize}),0),p=c.length;return 0===p?(n=r?s.FolderAllFilesNotImportable:s.FolderAllFilesTooLargeToUpload,i=Object(P.Y)(u).call(u,(function(e){return e.name})),o=u,a=!0):u.length>0&&(n=r?s.FolderHasFileNotImportable:s.FolderHasFileTooLargeToUpload,i=Object(P.Y)(u).call(u,(function(e){return e.name})),o=u,a=!1),{totalSize:l,totalCount:p,parseError:n,shouldAbort:a,failedToParseFiles:i,failedFiles:o}}function Rn(e){if(Cr(e)){var r=e[0];return r?xn(r).split("/")[0]:""}return e.name}var Ln=function(e){function r(e){var n,a=e.input,o=e.options;Ot(this,r);var s=Rn(a);return(n=Rt(this,Nt(r).call(this,{name:s,jobType:o.jobType,sourceType:i.Directory,bizPayload:o.bizPayload}))).parentToken=o.parentToken,n.input=a,n.options=o,n.initialized=!1,n.directoryType=o.directoryType,n}return Ht(r,e),Zr(r,[{key:"init",value:function(){var e=this;return this.initPromise||(this.initPromise=new P.ms(function(){var r=x(b.mark((function r(n){var a,i,o,s,u,c,l,p;return b.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,qn(e.input,e.options);case 2:a=r.sent,i=a.subtasks,o=a.subtaskMap,s=a.totalCount,u=a.totalSize,c=a.parseError,l=a.failedToParseFiles,p=a.shouldAbort,e.subtaskMap=o,e.subtasks=i,e.pendingList=hn(i),e.progressList=[],e.errorList=[],e.successList=[],e._totalCount=s,e._totalSize=u,e.parseError=c,e.failedToParseFiles=l,e.shouldAbort=p,e.initialized=!0,n();case 23:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())),this.initPromise}},{key:"getNextPendingSubtask",value:function(){if(this.initialized){var e=this.pendingList[0];return this.subtaskMap[e]}}},{key:"getAllPendingFileTasks",value:function(){var e,r=this,n=[];return this.initialized&&this.pendingList?(Oe(e=this.pendingList).call(e,(function(e){var a=r.subtaskMap[e];a.sourceType===i.File&&n.push(a)})),n):n}},{key:"isAllTasksDone",value:function(){if(this.initialized)return this.subtasks.length===this.successList.length+this.errorList.length}},{key:"markSubtaskStart",value:function(e){this.initialized&&(le(e,!0,this.pendingList)?this.progressList.push(e):console.warn("Subtask ".concat(e," not found.")))}},{key:"markSubtaskProgress",value:function(e){if(this.initialized){var r=e.uuid;if(le(r,!1,this.progressList,this.pendingList))switch(e.type){case"upload":case"import-upload":this.subtaskMap[r].uploadedSize=e.data.bytesTransferred;break;case"import-uploaded":this.subtaskMap[r].ticket=e.data.ticket}else console.warn("Subtask ".concat(r," not found."))}}},{key:"markSubtaskSuccess",value:function(e){if(this.initialized){var r=e.uuid;if(le(r,!0,this.progressList,this.pendingList))switch(this.successList.push(r),e.type){case"create-directory":var n=this.subtaskMap[r],a=e.data.token;n.token=a,n.isRoot&&(this.token=a);var i=!0,o=!1,s=void 0;try{for(var u,c=Kr(n.children);!(i=(u=c.next()).done);i=!0){var l=u.value;this.subtaskMap[l].parentToken=a}}catch(f){o=!0,s=f}finally{try{i||null==c.return||c.return()}finally{if(o)throw s}}break;case"upload":this.subtaskMap[r].token=e.data.token;break;case"import":var p=this.subtaskMap[r];p.token=e.data.token,p.suiteType=e.data.suiteType,p.responseData=e.data.responseData}else console.warn("Subtask ".concat(r," not found."))}}},{key:"markSubtaskFailure",value:function(e){if(this.initialized){var r=e.uuid;if(le(r,!0,this.progressList,this.pendingList))this.errorList.push(r),this.subtaskMap[r].error=e.data.errorType;else console.warn("Subtask ".concat(r," not found."))}}},{key:"getSubtask",value:function(e){if(this.initialized)return this.subtaskMap[e]}},{key:"getInProgressSubtasksCoreInfo",value:function(){if(!this.initialized)return[];var e=[],r=!0,n=!1,a=void 0;try{for(var i,o=Kr(this.progressList);!(r=(i=o.next()).done);r=!0){var s=i.value,u=this.subtaskMap[s];u instanceof jn&&e.push({id:u.id,jobType:u.jobType,file:u.file})}}catch(c){n=!0,a=c}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}return e}},{key:"start",value:function(){this.status=o.Inflight}},{key:"finish",value:function(){this.initialized&&(this.status=this.errorList.length?o.Error:o.Success)}},{key:"pause",value:function(e){var r;this.initialized&&((r=this.pendingList).unshift.apply(r,wr(this.progressList)),this.progressList.length=0,this.status=o.Paused,this.pausedByOffline=Boolean(e))}},{key:"retry",value:function(){var e;this.initialized&&((e=this.pendingList).unshift.apply(e,wr(this.errorList)),this.errorList.length=0,this.status=o.Pending,this.pausedByOffline=!1)}},{key:"totalCount",get:function(){return this.initialized?this._totalCount:0}},{key:"uploadedCount",get:function(){if(!this.initialized)return 0;var e=0,r=!0,n=!1,a=void 0;try{for(var i,o=Kr(this.successList);!(r=(i=o.next()).done);r=!0){var s=i.value;this.subtaskMap[s]instanceof jn&&(e+=1)}}catch(u){n=!0,a=u}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}return e}},{key:"totalSize",get:function(){return this.initialized?this._totalSize:0}},{key:"uploadedSize",get:function(){if(!this.initialized)return 0;var e=0,r=!0,n=!1,a=void 0;try{for(var i,o=Kr(this.subtasks);!(r=(i=o.next()).done);r=!0){var s=i.value,u=this.subtaskMap[s];u instanceof jn&&(e+=u.uploadedSize)}}catch(c){n=!0,a=c}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}return e}},{key:"progress",get:function(){if(!this.initialized)return 0;var e=this.progressList[0],r=this.subtaskMap[e];if(!r||r instanceof Dn)return 0;var n=r.uploadedSize,a=r.totalSize;return 0===a?0:Math.round(n/a*100)/100}}]),r}(ln);Object(g.KW)({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var Mn=g.Y.Date.now,Bn=function(){function e(r){var n=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6;Ot(this,e),this.diffSize=0,this.diffTime=0,this.slidingWindow=[],this.pSpeed=0,this.TransferredBytesMap=new Vr,this.calculate=function(){n.write();var e,r=n.slidingWindow.length;if(0===r)e=0;else{for(var a=0,i=0,o=0;o<r;o++)a+=n.slidingWindow[o],n.slidingWindow[o]>0&&(i+=1);e=0===i?0:a/i}n.speed=e},this.onSpeedChanged=r,this.windowSize=a}return Zr(e,[{key:"updateTransferredBytes",value:function(e){var r=e.bytesTransferred||0,n=this.TransferredBytesMap.get(e.key),a=Mn();if(n){var i=r-n.transferredBytes,o=a-n.timeStamp;this.add(Math.max(0,i),o)}this.TransferredBytesMap.set(e.key,{timeStamp:a,transferredBytes:r})}},{key:"clear",value:function(){this.speedTimer&&(clearInterval(this.speedTimer),this.speedTimer=void 0),this.diffSize=0,this.diffTime=0,this.slidingWindow=[],this.speed=0,this.TransferredBytesMap.clear()}},{key:"add",value:function(e,r){this.speedTimer||(this.speedTimer=window.setInterval(this.calculate,1e3)),this.diffSize+=e,this.diffTime+=r}},{key:"write",value:function(){var e=this.diffSize&&this.diffTime?Math.round(this.diffSize/this.diffTime*1e3):0;this.diffSize=0,this.diffTime=0,this.slidingWindow.push(e),this.slidingWindow.length>this.windowSize&&this.slidingWindow.shift()}},{key:"speed",set:function(e){this.pSpeed!==e&&(this.onSpeedChanged(e),this.pSpeed=e)}}]),e}();function Nn(e,r){var n=It(e);if(bt){var a=bt(e);r&&(a=qe(a).call(a,(function(r){return Ce(e,r).enumerable}))),n.push.apply(n,a)}return n}function Wn(e){for(var r=1;r<arguments.length;r++){var n,a=null!=arguments[r]?arguments[r]:{};if(r%2)Oe(n=Nn(Object(a),!0)).call(n,(function(r){xt(e,r,a[r])}));else if(be)he(e,be(a));else{var i;Oe(i=Nn(Object(a))).call(i,(function(r){fe(e,r,Ce(a,r))}))}}return e}function Kn(e){return e instanceof File||e.isFile}function Yn(e,r,n){return Hn.apply(this,arguments)}function Hn(){return(Hn=x(b.mark((function e(r,n,a){var i,o,s,u,c,l,p,f,d,h,v,y,g;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=n&&n.isDirectory,u=qe(i=Object(P.Y)(o=hn(r)).call(o,(function(e){if(e instanceof DataTransferItem){var r=e.webkitGetAsEntry();return r.isFile&&e.getAsFile?e.getAsFile():r}return e}))).call(i,(function(e){return!("drive"===a&&(s||!Kn(e)))})),s&&1===u.length&&""===u[0].webkitRelativePath&&(s=!1),c=[],!s){e.next=13;break}return e.next=7,Jn(u,n);case 7:return l=e.sent,e.next=10,l.init();case 10:c.push(l),e.next=44;break;case 13:p=!0,f=!1,d=void 0,e.prev=16,h=Kr(u);case 18:if(p=(v=h.next()).done){e.next=30;break}return y=v.value,e.next=22,Gn(y,n,a);case 22:if(!((g=e.sent)instanceof Ln)){e.next=26;break}return e.next=26,g.init();case 26:c.push(g);case 27:p=!0,e.next=18;break;case 30:e.next=36;break;case 32:e.prev=32,e.t0=e.catch(16),f=!0,d=e.t0;case 36:e.prev=36,e.prev=37,p||null==h.return||h.return();case 39:if(e.prev=39,!f){e.next=42;break}throw d;case 42:return e.finish(39);case 43:return e.finish(36);case 44:return e.abrupt("return",c);case 45:case"end":return e.stop()}}),e,null,[[16,32,36,44],[37,,39,43]])})))).apply(this,arguments)}function Gn(e,r,n){return Kn(e)?function(e,r,n){return Xn.apply(this,arguments)}(e,r,n):Jn(e,r)}function Xn(){return(Xn=x(b.mark((function e(r,n,a){var i;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r instanceof File)){e.next=4;break}e.t0=r,e.next=7;break;case 4:return e.next=6,Un(r);case 6:e.t0=e.sent;case 7:if(i=e.t0,"drive"!==a){e.next=10;break}return e.abrupt("return",new dn({file:i,options:n}));case 10:return e.abrupt("return",new fn({file:i,options:n}));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Jn(e,r){return Qn.apply(this,arguments)}function Qn(){return(Qn=x(b.mark((function e(r,n){return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Ln({input:r,options:n}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vn(e,r){return Object(P.Y)(e).call(e,(function(e){var n,a;e instanceof Ln&&(n=e.uploadedCount,a=e.totalCount);var i={finishedCount:n,totalCount:a,errorType:e.error,file:e instanceof fn||e instanceof dn?e.file:void 0,uuid:e.id,name:e.name,jobType:e.jobType,status:e.status,progress:e.progress,size:e.totalSize,uploadedSize:e.uploadedSize,bizPayload:e.bizPayload};if("drive"===r){var o=e;return Wn({},i,{appFileId:o.appFileId,extra:o.extra})}var s,u,c,l=e;l instanceof Ln?s=f.Folder:(s=l.suiteType||f.File,u=l.options&&l.options.businessType,c=l.successExtra);var p=Wn({},i,{successExtra:c,fileTypeNum:s,parentToken:l.parentToken,token:l.token,responseData:l.responseData});return u&&(p.businessType=u),p}))}function $n(e,r){var n=It(e);if(bt){var a=bt(e);r&&(a=qe(a).call(a,(function(r){return Ce(e,r).enumerable}))),n.push.apply(n,a)}return n}function Zn(e){for(var r=1;r<arguments.length;r++){var n,a=null!=arguments[r]?arguments[r]:{};if(r%2)Oe(n=$n(Object(a),!0)).call(n,(function(r){xt(e,r,a[r])}));else if(be)he(e,be(a));else{var i;Oe(i=$n(Object(a))).call(i,(function(r){fe(e,r,Ce(a,r))}))}}return e}var ea=function(){function e(r){var n=this;Ot(this,e),this.tasks=[],this.uploadingTasks=new Vr,this.finishingTasks=new Vr,this.directoryTasks=new Vr,this.eventBus=new R.a,this.pausedByOffline=!1,this.filesAddedWhenOffline=!1,this.isOnline=!0,this.onSpeedChanged=function(e){n.fire("speed_changed",{speed:e})},this.onOnline=function(){n.isOnline=!0,n.fire("online"),(n.pausedByOffline||n.filesAddedWhenOffline)&&(n.retryAllPausedByOffline(),n.upload(),n.pausedByOffline=!1,n.filesAddedWhenOffline=!1)},this.onOffline=function(){n.isOnline=!1,n.fire("offline"),n.isUploading&&(n.pausedByOffline=!0,n.doPauseAll(!0))},this.handleUploadStatusChanged=function(e){var r=e.data,a=r.parentUUID,i=r.uuid;switch(e.type){case"uploading":n.handleUploadStatusUploading(e.data);break;case"finishing":n.addTaskData(n.finishingTasks,a||i,i),n.handleUploadStatusFinishing(e.data);break;case"success":n.deleteTaskData(n.finishingTasks,a||i,i),n.handleUploadStatusSuccess(e.data);break;case"error":n.deleteTaskData(n.finishingTasks,a||i,i),n.handleUploadStatusError(e.data)}},this.handleCreateDirectoryStatusChanged=function(e){var r=e.data,a=r.parentUUID,i=r.uuid;switch(e.type){case"retry":n.handleCreateDirectoryStatusRetry(e.data);break;case"success":n.deleteTaskData(n.directoryTasks,a||i,i),n.handleCreateDirectoryStatusSuccess(e.data);break;case"error":n.deleteTaskData(n.directoryTasks,a||i,i),n.handleCreateDirectoryStatusError(e.data)}},this.handleImportStatusChanged=function(e){switch(e.type){case"uploading":n.handleImportStatusUploading(e.data);break;case"converting":n.handleImportStatusConverting(e.data);break;case"success":n.handleImportStatusSuccess(e.data);break;case"error":n.handleImportStatusError(e.data)}},this.handleImportErrorAlert=function(e){var r=e.errorType,i=e.name,o=e.responseData;n.reportRuntimeIncident({errorType:r,responseData:o,jobType:a.Import,files:[{name:i,size:0}]})},this.supported=Boolean(FileList&&File&&Blob&&Qr(Blob.prototype)),this.opts=r||{},this.logger=r.logger,this.docsLogger=r.docsLogger,this.taskController=r.taskController,this.featureFlags=Zn({},h,{},r.featureFlags),this.kickOffLogger(),this.taskController.init({onUploadStatusChanged:this.handleUploadStatusChanged,onCreateDirectoryStatusChanged:this.handleCreateDirectoryStatusChanged,onImportStatusChanged:this.handleImportStatusChanged,onImportErrorAlert:this.handleImportErrorAlert}),this.networkSpeedCalculator=new Bn(this.onSpeedChanged)}return Zr(e,[{key:"loadFile",value:function(){var e=x(b.mark((function e(r,n){var a,i;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r instanceof File){e.next=2;break}throw new Error("Invalid argument: argv[0] is not a File.");case 2:return this.checkLoadFileOpts(n),e.next=5,Yn([r],n,this.opts.uploaderType);case 5:if(a=e.sent,!(i=a[0]).shouldAbort){e.next=9;break}throw new Error("File cannot be loaded with parse error ".concat(i.parseError));case 9:return this.appendTaskQueue(a),this.logTaskAdded(a,r,n),e.abrupt("return",i.id);case 12:case"end":return e.stop()}}),e,this)})));return function(r,n){return e.apply(this,arguments)}}()},{key:"loadFiles",value:function(){var e=x(b.mark((function e(r,n,a){var i;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return");case 2:return this.checkLoadFileOpts(a),e.next=5,Yn(r,a,this.opts.uploaderType);case 5:i=e.sent,this.appendTaskQueue(i),this.logTaskAdded(i,r,a);case 8:case"end":return e.stop()}}),e,this)})));return function(r,n,a){return e.apply(this,arguments)}}()},{key:"on",value:function(e,r){this.eventBus.on(e,r)}},{key:"off",value:function(e,r){this.eventBus.off(e,r)}},{key:"destroy",value:function(){this.eventBus.removeAllListeners(),this.setNetworkCheck(!1),this.cancelAll()}},{key:"setNetworkCheck",value:function(e){e?(window.addEventListener("online",this.onOnline),window.addEventListener("offline",this.onOffline)):(window.removeEventListener("online",this.onOnline),window.removeEventListener("offline",this.onOffline))}},{key:"upload",value:function(){if(this.isOnline)for(var e=this.getOpt("maxSimultaneousUploads"),r=0;r<e;r++)this.uploadNextTask()}},{key:"pauseAll",value:function(){return this.doPauseAll()}},{key:"pause",value:function(e){var r,n=this.uploadingTasks.get(e);if(n){if(n instanceof Ln){var i=n.getInProgressSubtasksCoreInfo(),o=!0,s=!1,u=void 0;try{for(var c,l=Kr(i);!(o=(c=l.next()).done);o=!0){var p=c.value;if(p.jobType===a.Import){var f=p.file;this.taskController.cancelImport({file:f,uuid:p.id})}else this.taskController.cancelUpload(p.id)}}catch(v){s=!0,u=v}finally{try{o||null==l.return||l.return()}finally{if(s)throw u}}}else if(n.jobType===a.Import){var d=n.file;this.taskController.cancelImport({file:d,uuid:n.id})}else this.taskController.cancelUpload(n.id);return n.pause(),this.updateTask(n),this.uploadingTasks.delete(n.id),this.deleteTaskData(this.finishingTasks,e),this.deleteTaskData(this.directoryTasks,e),void this.upload()}var h=Nr(r=this.tasks).call(r,(function(r){return r.id===e}));h&&h.canPause&&(h.pause(),this.updateTask(h))}},{key:"retry",value:function(e){var r,n=Nr(r=this.tasks).call(r,(function(r){return r.id===e}));n&&n.canRetry&&(n.retry(),this.updateTask(n),this.upload())}},{key:"retryAllPaused",value:function(){var e,r=qe(e=this.tasks).call(e,(function(e){return e.status===o.Paused}));this.retryTasks(r)}},{key:"retryAllFailed",value:function(){var e,r=qe(e=this.tasks).call(e,(function(e){return e.status===o.Error}));this.retryTasks(r)}},{key:"cancel",value:function(e){var r,n,a=Fr(r=this.tasks).call(r,(function(r){return r.id===e}));if(-1!==a){this.pause(e);var i=te(n=this.tasks).call(n,a,1);this.fire("tasks_removed",{list:Object(P.Y)(i).call(i,(function(e){return{uuid:e.id}}))})}}},{key:"cancelAll",value:function(){var e;this.doPauseAll(),this.fire("tasks_removed",{list:Object(P.Y)(e=this.tasks).call(e,(function(e){return{uuid:e.id}}))}),this.tasks.length=0}},{key:"getFolderUploadErrorDetail",value:function(e){var r,n=Nr(r=this.tasks).call(r,(function(r){return r.id===e&&r.sourceType===i.Directory}));if(!n)throw new Error("Cannot find directory task with uuid ".concat(e));var a=n.errorList,o=n.subtaskMap;if(!a||!o)return{files:[]};for(var s=[],u=0;u<a.length;u++){var c=o[a[u]];c.sourceType===i.File&&s.push({name:c.name,errorType:c.error,jobType:c.jobType})}return{files:s}}},{key:"kickOffLogger",value:function(){var e=Object(F.get)(this.opts,"envConfigs.teaConfig"),r=Boolean(Object(F.get)(this.opts,"envConfigs.isOnlineEnv"));if(!e)return console.warn("teaConfig not provided, logger not initialized"),this.logger.setIsUnavailable(),void this.docsLogger.setIsUnavailable();var n=e.appID,a=e.suiteAppID,i={userID:e.userID,tenantID:e.tenantID,channelDomain:e.channelDomain,isOnlineEnv:r,instanceName:"drive-sdk"};n?this.logger.kickOff(Zn({},i,{appID:n})):(this.logger.setIsUnavailable(),console.warn("sdk teaConfig incomplete, sdk logger not initialized")),a?this.docsLogger.kickOff(Zn({},i,{appID:a})):(this.docsLogger.setIsUnavailable(),console.warn("suite teaConfig incomplete, suite logger not initialized"))}},{key:"checkLoadFileOpts",value:function(e){if(Object(F.isUndefined)(e.jobType)||this.isSuiteUploader&&Object(F.isUndefined)(e.parentToken))throw new Error("Invalid argument: jobType or parentToken missing.")}},{key:"getOpt",value:function(e){var r=this;if(Cr(e)){var n={};return Oe(e).call(e,(function(e){n[e]=r.getOpt(e)})),n}return Object(F.isUndefined)(this.opts[e])?this.opts.defaults[e]:this.opts[e]}},{key:"fire",value:function(e){for(var r,n,a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];(r=this.eventBus).emit.apply(r,jr(n=[e]).call(n,i))}},{key:"appendTaskQueue",value:function(e){var r,n=this,a=qe(e).call(e,(function(e){return e&&!e.shouldAbort})),i=qe(e).call(e,(function(e){return!e||e.shouldAbort||e.failedToParseFiles||e.parseError}));if((r=this.tasks).push.apply(r,wr(a)),a.length>0&&this.fire("tasks_added",{list:Vn(a,this.opts.uploaderType)}),i.length>0){var o=function(e){return Object(P.Y)(e).call(e,(function(e){return{name:e.name,sourceType:e.sourceType,jobType:e.jobType,parseError:e.parseError,failedToParseFiles:e.failedToParseFiles,failedFiles:e.failedFiles,shouldAbort:e.shouldAbort}}))}(i);this.fire("parse_error",{list:o}),Oe(o).call(o,(function(e){n.logger.collectEvent("dev_upload_parse_error",e)}))}!this.isOnline&&a.length>0&&(this.filesAddedWhenOffline=!0)}},{key:"doPauseAll",value:function(e){var r,n=qe(r=this.tasks).call(r,(function(e){return e.canPause})),a=!0,i=!1,o=void 0;try{for(var s,u=Kr(n);!(a=(s=u.next()).done);a=!0){var c=s.value;this.uploadingTasks.has(c.id)&&(this.uploadingTasks.delete(c.id),this.deleteTaskData(this.finishingTasks,c.id),this.deleteTaskData(this.directoryTasks,c.id)),c.pause(e)}}catch(l){i=!0,o=l}finally{try{a||null==u.return||u.return()}finally{if(i)throw o}}this.updateTasks(n),this.taskController.cancelAllUploads(),this.taskController.cancelAllImports&&this.taskController.cancelAllImports(),this.networkSpeedCalculator&&this.networkSpeedCalculator.clear()}},{key:"retryAllPausedByOffline",value:function(){var e,r=qe(e=this.tasks).call(e,(function(e){return e.status===o.Paused&&!0===e.pausedByOffline}));this.retryTasks(r)}},{key:"retryTasks",value:function(e){var r=!0,n=!1,a=void 0;try{for(var i,o=Kr(e);!(r=(i=o.next()).done);r=!0){i.value.retry()}}catch(s){n=!0,a=s}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}this.updateTasks(e),this.upload()}},{key:"handleUploadStatusUploading",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.bytesTransferred;if(this.updateSpeedCalculator(r,a),n){var i,s=Nr(i=this.tasks).call(i,(function(t){return t.id===n}));if(!s)return void console.error("Cannot find parent task with given parentUUID.");s.markSubtaskProgress({uuid:r,type:"upload",data:{bytesTransferred:a}}),this.updateTask(s)}else{var u,c=Nr(u=this.tasks).call(u,(function(t){return t.id===r}));if(!c)return void console.error("Cannot find task with given uuid.");c.status=o.Inflight,c.uploadedSize=a,this.updateTask(c)}}},{key:"handleUploadStatusFinishing",value:function(e){var r=e.uuid,n=e.parentUUID;if(n&&this.isSuiteUploader){var a,i=Nr(a=this.tasks).call(a,(function(t){return t.id===n}));if(!i)return void console.error("Cannot find parent task with given parentUUID.");this.uploadDirectorySubtask(i)}else{var o;if(!Nr(o=this.tasks).call(o,(function(t){return t.id===r})))return void console.error("Cannot find task with given uuid.");this.uploadNextTask()}}},{key:"handleUploadStatusSuccess",value:function(e){this.isSuiteUploader?this.handleSuiteUploadStatusSuccess(e):this.handleDriveUploadStatusSuccess(e)}},{key:"handleSuiteUploadStatusSuccess",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.token,i=e.dataVersion,o=e.successExtra;if(n){var s,u=Nr(s=this.tasks).call(s,(function(t){return t.id===n}));if(!u)return void console.error("Cannot find parent task with given parentUUID.");u.markSubtaskSuccess({uuid:r,type:"upload",data:{token:a,dataVersion:i}}),this.updateTask(u),this.uploadDirectorySubtask(u)}else{var c,l=Nr(c=this.tasks).call(c,(function(t){return t.id===r}));if(!l)return void console.error("Cannot find task with given uuid.");l.token=a,l.successExtra=o,l.error=void 0,this.finishTask(l)}}},{key:"handleDriveUploadStatusSuccess",value:function(e){var r,n=e.uuid,a=e.appFileId,i=e.extra,o=Nr(r=this.tasks).call(r,(function(t){return t.id===n}));o?(o.appFileId=a,o.extra=i,o.error=void 0,this.finishTask(o)):console.error("Cannot find task with given uuid.")}},{key:"handleUploadStatusError",value:function(e){var r=e.uuid,n=e.parentUUID,i=e.errorType,o=e.reqID,s=e.logID,u={name:"",size:0};if(n){var c,l=Nr(c=this.tasks).call(c,(function(t){return t.id===n}));if(!l)return void console.error("Cannot find parent task with given parentUUID.");var p=l.getSubtask(r);p instanceof jn&&(this.fire("subtask_failed",{reqID:o,logID:s,errorType:i,name:p.name,size:p.totalSize,jobType:p.jobType}),u.size=p.totalSize),l.markSubtaskFailure({uuid:r,type:"upload",data:{errorType:i}}),u.name=p?p.name:"",this.updateTask(l),this.uploadDirectorySubtask(l)}else{var f,d=Nr(f=this.tasks).call(f,(function(t){return t.id===r}));if(!d)return void console.error("Cannot find task with given uuid.");u.name=d.name,u.size=d.totalSize,d.error=i,this.finishTask(d)}this.reportRuntimeIncident({errorType:i,reqID:o,logID:s,jobType:a.Upload,files:[u]})}},{key:"handleCreateDirectoryStatusRetry",value:function(e){}},{key:"handleCreateDirectoryStatusSuccess",value:function(e){var r,n=e.uuid,a=e.parentUUID,i=e.token;if(a){var o=Nr(r=this.tasks).call(r,(function(t){return t.id===a}));o?(o.markSubtaskSuccess({uuid:n,type:"create-directory",data:{token:i}}),this.updateTask(o),this.uploadDirectorySubtask(o)):console.error("Cannot find parent task with given parentUUID.")}}},{key:"handleCreateDirectoryStatusError",value:function(e){var r,n=e.uuid,a=e.parentUUID,i=e.errorType,o=e.reqID,s=e.logID;if(a){var u=Nr(r=this.tasks).call(r,(function(t){return t.id===a}));if(u){var c=u.getSubtask(n);c instanceof Dn&&this.fire("subtask_failed",{reqID:o,logID:s,errorType:i,name:c.name,jobType:u.jobType}),u.markSubtaskFailure({uuid:n,type:"create-directory",data:{errorType:i}}),this.updateTask(u),this.uploadDirectorySubtask(u),this.reportRuntimeIncident({errorType:i,reqID:o,logID:s,jobType:u.jobType,files:[{name:c?c.name:"",size:0}]})}else console.error("Cannot find parent task with given parentUUID.")}}},{key:"handleImportStatusUploading",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.bytesTransferred;if(this.updateSpeedCalculator(r,a),n){var i,o=Nr(i=this.tasks).call(i,(function(t){return t.id===n}));if(!o)return void console.error("Cannot find parent task with given parentUUID.");o.markSubtaskProgress({uuid:r,type:"import-upload",data:{bytesTransferred:a}}),this.updateTask(o)}else{var s,u=Nr(s=this.tasks).call(s,(function(t){return t.id===r}));if(!u)return void console.error("Cannot find task with given uuid.");u.uploadedSize=a,this.updateTask(u)}}},{key:"handleImportStatusConverting",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.ticket;if(n){var i,o=Nr(i=this.tasks).call(i,(function(t){return t.id===n}));if(!o)return void console.error("Cannot find parent task with given parentUUID.");o.markSubtaskProgress({uuid:r,type:"import-uploaded",data:{ticket:a}}),this.updateTask(o)}else{var s,u=Nr(s=this.tasks).call(s,(function(t){return t.id===r}));if(!u)return void console.error("Cannot find task with given uuid.");u.ticket=a,this.updateTask(u)}}},{key:"handleImportStatusSuccess",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.token,i=e.suiteType,o=e.responseData;if(n){var s,u=Nr(s=this.tasks).call(s,(function(t){return t.id===n}));if(!u)return void console.error("Cannot find parent task with given parentUUID.");u.markSubtaskSuccess({uuid:r,type:"import",data:{token:a,suiteType:i,responseData:o}}),this.updateTask(u),this.uploadDirectorySubtask(u)}else{var c,l=Nr(c=this.tasks).call(c,(function(t){return t.id===r}));if(!l)return void console.error("Cannot find task with given uuid.");l.token=a,l.error=void 0,l.suiteType=i,l.responseData=o,this.finishTask(l)}}},{key:"handleImportStatusError",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.errorType,i=e.reqID;if(n){var o,s=Nr(o=this.tasks).call(o,(function(t){return t.id===n}));if(!s)return void console.error("Cannot find parent task with given parentUUID.");var u=s.getSubtask(r);u instanceof jn&&this.fire("subtask_failed",{reqID:i,errorType:a,name:u.name,size:u.totalSize,jobType:u.jobType}),s.markSubtaskFailure({uuid:r,type:"import",data:{errorType:a}}),this.updateTask(s),this.uploadDirectorySubtask(s)}else{var c,l=Nr(c=this.tasks).call(c,(function(t){return t.id===r}));if(!l)return void console.error("Cannot find task with given uuid.");l.error=a,this.finishTask(l)}}},{key:"finishTask",value:function(e){if(e.finish(),this.updateTask(e),this.uploadingTasks.delete(e.id),this.deleteTaskData(this.finishingTasks,e.id),this.uploadNextTask(),"suite"===this.opts.uploaderType&&e.jobType===a.Upload){var r=e.status===o.Success;this.docsLogger.collectDocsFileFinishEvent({isSuccessful:r,mountPoint:Object(F.get)(e,"mountPoint")||"explorer",fileNum:e instanceof Ln?e.uploadedCount:r?1:0})}}},{key:"uploadNextTask",value:function(){var e;if(this.shouldTriggerNextTask()){var r=Nr(e=this.tasks).call(e,(function(e){return e.status===o.Pending}));r?r.sourceType===i.Directory?this.shouldTriggerNextDirectoryTask()&&this.uploadDirectoryTask(r):this.uploadFileTask(r):0===this.uploadingTasks.size&&this.networkSpeedCalculator&&this.networkSpeedCalculator.clear()}}},{key:"uploadDirectoryTask",value:function(e){var r=e.parentToken;Object(F.isUndefined)(r)?console.error("task parentToken missing."):(e.start(),this.updateTask(e),this.uploadingTasks.set(e.id,e),this.uploadDirectorySubtask(e))}},{key:"uploadDirectorySubtask",value:function(e){var r=this.taskController;if(e.status!==o.Paused){var n=e.getNextPendingSubtask();if(n){if(this.shouldTriggerNextSubtask(e,n))if(n instanceof Dn){var i=n.id,s=n.parentToken,c=n.name;if(Object(F.isUndefined)(s))return e.markSubtaskFailure({uuid:i,type:"create-directory",data:{errorType:u.SubtaskParentTokenMissing}}),this.updateTask(e),void this.uploadDirectorySubtask(e);this.addTaskData(this.directoryTasks,e.id,i),r.startCreateDirectory({uuid:i,parentToken:s,name:c,parentUUID:e.id,directoryType:e.directoryType}),e.markSubtaskStart(i)}else{var l=n.id,p=n.parentToken,f=n.file,d=n.jobType;if(Object(F.isUndefined)(p))return e.markSubtaskFailure({uuid:l,type:d===a.Import?"import":"upload",data:{errorType:u.SubtaskParentTokenMissing}}),this.updateTask(e),void this.uploadDirectorySubtask(e);d===a.Import?r.startImport({uuid:l,file:f,parentToken:p,parentUUID:e.id,options:e.options}):r.startUpload({uuid:l,file:f,parentToken:p,parentUUID:e.id,isOnlyOneFileTask:this.isOnlyOneFileTask()}),e.markSubtaskStart(l)}}else e.isAllTasksDone()&&this.finishTask(e)}}},{key:"uploadFileTask",value:function(e){this.isSuiteUploader?this.uploadSuiteFileTask(e):this.uploadDriveFileTask(e)}},{key:"updateUpcomingTaskStatus",value:function(e){e.start(),this.updateTask(e),this.uploadingTasks.set(e.id,e)}},{key:"uploadSuiteFileTask",value:function(e){var r=e.id,n=e.file,i=e.parentToken,o=e.fileToken,s=e.memberID,u=e.shouldAddToRecents,c=e.options;if(Object(F.isUndefined)(i))console.error("task parentToken missing.");else{this.updateUpcomingTaskStatus(e);var l=this.taskController;if(e.jobType===a.Import){var p=c;l.startImport({uuid:r,file:n,parentToken:i,options:p})}else l.startUpload({uuid:r,file:n,parentToken:i,fileToken:o,memberID:s,shouldAddToRecents:u,mountPoint:e.mountPoint,bizExtra:c.bizExtra,bizRouteKey:c.bizRouteKey,isOnlyOneFileTask:this.isOnlyOneFileTask()})}}},{key:"uploadDriveFileTask",value:function(e){var r=e.id,n=e.file;this.updateUpcomingTaskStatus(e),this.taskController.startUpload({uuid:r,file:n,isOnlyOneFileTask:this.isOnlyOneFileTask()})}},{key:"updateSpeedCalculator",value:function(e,r){this.networkSpeedCalculator&&this.networkSpeedCalculator.updateTransferredBytes({key:e,bytesTransferred:r})}},{key:"updateTask",value:function(e){this.updateTasks([e])}},{key:"updateTasks",value:function(e){var r=Vn(e,this.opts.uploaderType);this.fire("tasks_changed",{list:r})}},{key:"reportRuntimeIncident",value:function(e){var r;this.fire("runtime_incident_occurred",Zn({},e,{fileNames:Object(P.Y)(r=e.files).call(r,(function(e){return e.name}))}))}},{key:"getTaskUploadingCount",value:function(e){var r=0;if(e instanceof fn||e instanceof dn){e.totalSize-e.uploadedSize>.001&&r++}else{var n=e.getInProgressSubtasksCoreInfo(),a=!0,i=!1,o=void 0;try{for(var s,u=Kr(n);!(a=(s=u.next()).done);a=!0){var c=s.value,l=e.getSubtask(c.id);l instanceof jn&&l.totalSize-l.uploadedSize>.001&&r++}}catch(p){i=!0,o=p}finally{try{a||null==u.return||u.return()}finally{if(i)throw o}}}return r}},{key:"shouldTriggerNextTask",value:function(){var e=this.uploadingTasks.size,r=!0,n=!1,a=void 0;try{for(var i,o=Kr(hr(s=this.uploadingTasks).call(s));!(r=(i=o.next()).done);r=!0){var s,u=i.value;this.getTaskUploadingCount(u)<=0&&e--}}catch(c){n=!0,a=c}finally{try{r||null==o.return||o.return()}finally{if(n)throw a}}return e<this.getOpt("maxSimultaneousUploads")}},{key:"shouldTriggerNextDirectoryTask",value:function(){return!(!Boolean(this.featureFlags.concurrentAndRetryableUpload)&&this.finishingTasks.size>0)&&this.directoryTasks.size<=0}},{key:"shouldTriggerNextSubtask",value:function(e,r){if(r instanceof Dn)return this.shouldTriggerNextDirectoryTask();var n=this.directoryTasks.get(e.id);return!(n&&n.size>0)&&this.getTaskUploadingCount(e)<this.getOpt("maxSimultaneousUploads")}},{key:"isOnlyOneFileTask",value:function(){var e,r=qe(e=this.tasks).call(e,(function(e){return(e.status===o.Pending||e.status===o.Inflight)&&e.sourceType===i.File}));if(1!==r.length)return!1;var n=r[0],a=this.uploadingTasks.get(n.id),s=this.uploadingTasks.size;return Boolean(!s||1===s&&a)}},{key:"addTaskData",value:function(e,r,n){if(e&&r&&n){var a=e.get(r);a?a.add(n):e.set(r,new lr([n]))}}},{key:"deleteTaskData",value:function(e,r,n){if(e&&r)if(n){var a=e.get(r);a&&(a.delete(n),a.size||e.delete(r))}else e.delete(r)}},{key:"logTaskAdded",value:function(e,r,n){if("suite"===this.opts.uploaderType){var i=Object(F.get)(n,"mountPoint"),o=r instanceof DataTransferItemList?"drag":"click_upload",s=Vt(e).call(e,(function(e,r){return r&&r.jobType===a.Upload?r instanceof Ln?e+r.getAllPendingFileTasks().length:r?e+1:e:e}),0);s&&this.docsLogger.collectDocsFileChooseEvent({addMode:o,fileNum:s,mountPoint:i||"explorer"})}}},{key:"progressInfo",get:function(){var e=0,r=0,n=!0,a=!1,i=void 0;try{for(var o,s=Kr(this.tasks);!(n=(o=s.next()).done);n=!0){var u=o.value;e+=u.uploadedSize,r+=u.totalSize}}catch(c){a=!0,i=c}finally{try{n||null==s.return||s.return()}finally{if(a)throw i}}return{uploadedSize:e,totalSize:r,progress:r>0?e/r:0}}},{key:"progress",get:function(){return this.progressInfo.progress}},{key:"uploadedSize",get:function(){return this.progressInfo.uploadedSize}},{key:"totalSize",get:function(){return this.progressInfo.totalSize}},{key:"isUploading",get:function(){return this.uploadingTasks.size>0}},{key:"isSuiteUploader",get:function(){return"suite"===this.opts.uploaderType}}]),e}(),ta=g.IV.f,ra=function(e){return function(r){for(var n,a=Object(g.I)(r),i=Object(g.y)(a),o=i.length,s=0,u=[];o>s;)n=i[s++],g.e&&!ta.call(a,n)||u.push(e?[n,a[n]]:a[n]);return u}},na={entries:ra(!0),values:ra(!1)}.values;Object(g.KW)({target:"Object",stat:!0},{values:function(e){return na(e)}});var aa=g.Y.Object.values;function ia(e){return Object(F.pickBy)(e,(function(e){return void 0!==e&&null!==e}))}function oa(e){return void 0===e&&(e=1e3),new Promise((function(r){return window.setTimeout(r,e)}))}var sa=g.c5.includes;Object(g.KW)({target:"Array",proto:!0},{includes:function(e){return sa(this,e,arguments.length>1?arguments[1]:void 0)}});var ua=Object(g.q4)("Array").includes,ca=Object(g.xR)("match"),la=function(e){if(function(e){var r;return Object(g.U)(e)&&(void 0!==(r=e[ca])?!!r:"RegExp"==Object(g.YQ)(e))}(e))throw TypeError("The method doesn't accept regular expressions");return e},pa=Object(g.xR)("match"),fa=function(e){var r=/./;try{"/./"[e](r)}catch(n){try{return r[pa]=!1,"/./"[e](r)}catch(a){}}return!1};Object(g.KW)({target:"String",proto:!0,forced:!fa("includes")},{includes:function(e){return!!~String(Object(g.qv)(this)).indexOf(la(e),arguments.length>1?arguments[1]:void 0)}});var da=Object(g.q4)("String").includes,ha=Array.prototype,va=String.prototype,ya=function(e){var r=e.includes;return e===ha||e instanceof Array&&r===ha.includes?ua:"string"===typeof e||e===va||e instanceof String&&r===va.includes?da:r},ga=g.Y.JSON||(g.Y.JSON={stringify:JSON.stringify}),ka=function(e){return ga.stringify.apply(ga,arguments)},ba=ka,ma="".startsWith,Ta=Math.min;Object(g.KW)({target:"String",proto:!0,forced:!fa("startsWith")},{startsWith:function(e){var r=String(Object(g.qv)(this));la(e);var n=Object(g.i)(Ta(arguments.length>1?arguments[1]:void 0,r.length)),a=String(e);return ma?ma.call(r,a,n):r.slice(n,n+a.length)===a}});var Ia=Object(g.q4)("String").startsWith,Ua=String.prototype,xa=function(e){var r=e.startsWith;return"string"===typeof e||e===Ua||e instanceof String&&r===Ua.startsWith?Ia:r},Oa=Object(g.xR)("iterator"),wa=!Object(g.n)((function(){var e=new URL("b?e=1","http://a"),r=e.searchParams;return e.pathname="c%20d",g.Jl&&!e.toJSON||!r.sort||"http://a/c%20d?e=1"!==e.href||"1"!==r.get("e")||"a=1"!==String(new URLSearchParams("?a=1"))||!r[Oa]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://\u0442\u0435\u0441\u0442").host||"#%D0%B1"!==new URL("http://a#\u0431").hash})),Da=Object.assign,Sa=!Da||Object(g.n)((function(){var e={},r={},n=Symbol(),a="abcdefghijklmnopqrst";return e[n]=7,a.split("").forEach((function(e){r[e]=e})),7!=Da({},e)[n]||Object(g.y)(Da({},r)).join("")!=a}))?function(e,r){for(var n=Object(g.w)(e),a=arguments.length,i=1,o=ge.f,s=g.IV.f;a>i;)for(var u,c=Object(g.eh)(arguments[i++]),l=o?Object(g.y)(c).concat(o(c)):Object(g.y)(c),p=l.length,f=0;p>f;)u=l[f++],g.e&&!s.call(c,u)||(n[u]=c[u]);return n}:Da,ja=2147483647,Ca=/[^\0-\u007E]/,Ea=/[.\u3002\uFF0E\uFF61]/g,Aa="Overflow: input needs wider integers to process",_a=Math.floor,qa=String.fromCharCode,Pa=function(e){return e+22+75*(e<26)},Fa=function(e,r,n){var a=0;for(e=n?_a(e/700):e>>1,e+=_a(e/r);e>455;a+=36)e=_a(e/35);return _a(a+36*e/(e+38))},za=function(e){var r=[];e=function(e){for(var r=[],n=0,a=e.length;n<a;){var i=e.charCodeAt(n++);if(i>=55296&&i<=56319&&n<a){var o=e.charCodeAt(n++);56320==(64512&o)?r.push(((1023&i)<<10)+(1023&o)+65536):(r.push(i),n--)}else r.push(i)}return r}(e);var n,a,i=e.length,o=128,s=0,u=72;for(n=0;n<e.length;n++)(a=e[n])<128&&r.push(qa(a));var c=r.length,l=c;for(c&&r.push("-");l<i;){var p=ja;for(n=0;n<e.length;n++)(a=e[n])>=o&&a<p&&(p=a);var f=l+1;if(p-o>_a((ja-s)/f))throw RangeError(Aa);for(s+=(p-o)*f,o=p,n=0;n<e.length;n++){if((a=e[n])<o&&++s>ja)throw RangeError(Aa);if(a==o){for(var d=s,h=36;;h+=36){var t=h<=u?1:h>=u+26?26:h-u;if(d<t)break;var v=d-t,y=36-t;r.push(qa(Pa(t+v%y))),d=_a(v/y)}r.push(qa(Pa(d))),u=Fa(s,f,l==c),s=0,++l}}++s,++o}return r.join("")},Ra=Object(g.xR)("iterator"),La="URLSearchParams",Ma="URLSearchParamsIterator",Ba=g.J.set,Na=g.J.getterFor(La),Wa=g.J.getterFor(Ma),Ka=/\+/g,Ya=Array(4),Ha=function(e){return Ya[e-1]||(Ya[e-1]=RegExp("((?:%[\\da-f]{2}){"+e+"})","gi"))},Ga=function(e){try{return decodeURIComponent(e)}catch(r){return e}},Xa=function(e){var r=e.replace(Ka," "),n=4;try{return decodeURIComponent(r)}catch(a){for(;n;)r=r.replace(Ha(n--),Ga);return r}},Ja=/[!'()~]|%20/g,Qa={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Va=function(e){return Qa[e]},$a=function(e){return encodeURIComponent(e).replace(Ja,Va)},Za=function(e,r){if(r)for(var n,a,i=r.split("&"),o=0;o<i.length;)(n=i[o++]).length&&(a=n.split("="),e.push({key:Xa(a.shift()),value:Xa(a.join("="))}))},ei=function(e){this.entries.length=0,Za(this.entries,e)},ti=function(e,r){if(e<r)throw TypeError("Not enough arguments")},ri=Object(g.f)((function(e,r){Ba(this,{type:Ma,iterator:Wr(Na(e).entries),kind:r})}),"Iterator",(function(){var e=Wa(this),r=e.kind,n=e.iterator.next(),a=n.value;return n.done||(n.value="keys"===r?a.key:"values"===r?a.value:[a.key,a.value]),n})),ni=function(){Object(g.A)(this,ni,La);var e,r,n,a,i,o,s,u=arguments.length>0?arguments[0]:void 0,c=this,l=[];if(Ba(c,{type:La,entries:l,updateURL:function(){},updateSearchParams:ei}),void 0!==u)if(Object(g.U)(u))if("function"===typeof(e=Object(g.x)(u)))for(r=e.call(u);!(n=r.next()).done;){if((i=(a=Wr(Object(g.G)(n.value))).next()).done||(o=a.next()).done||!a.next().done)throw TypeError("Expected sequence with length 2");l.push({key:i.value+"",value:o.value+""})}else for(s in u)Object(g.P)(u,s)&&l.push({key:s,value:u[s]+""});else Za(l,"string"===typeof u?"?"===u.charAt(0)?u.slice(1):u:u+"")},ai=ni.prototype;Object(g.N)(ai,{append:function(e,r){ti(arguments.length,2);var n=Na(this);n.entries.push({key:e+"",value:r+""}),n.updateURL()},delete:function(e){ti(arguments.length,1);for(var r=Na(this),n=r.entries,a=e+"",i=0;i<n.length;)n[i].key===a?n.splice(i,1):i++;r.updateURL()},get:function(e){ti(arguments.length,1);for(var r=Na(this).entries,n=e+"",a=0;a<r.length;a++)if(r[a].key===n)return r[a].value;return null},getAll:function(e){ti(arguments.length,1);for(var r=Na(this).entries,n=e+"",a=[],i=0;i<r.length;i++)r[i].key===n&&a.push(r[i].value);return a},has:function(e){ti(arguments.length,1);for(var r=Na(this).entries,n=e+"",a=0;a<r.length;)if(r[a++].key===n)return!0;return!1},set:function(e,r){ti(arguments.length,1);for(var n,a=Na(this),i=a.entries,o=!1,s=e+"",u=r+"",c=0;c<i.length;c++)(n=i[c]).key===s&&(o?i.splice(c--,1):(o=!0,n.value=u));o||i.push({key:s,value:u}),a.updateURL()},sort:function(){var e,r,n,a=Na(this),i=a.entries,o=i.slice();for(i.length=0,n=0;n<o.length;n++){for(e=o[n],r=0;r<n;r++)if(i[r].key>e.key){i.splice(r,0,e);break}r===n&&i.push(e)}a.updateURL()},forEach:function(e){for(var r,n=Na(this).entries,a=Object(g.GC)(e,arguments.length>1?arguments[1]:void 0,3),i=0;i<n.length;)a((r=n[i++]).value,r.key,this)},keys:function(){return new ri(this,"keys")},values:function(){return new ri(this,"values")},entries:function(){return new ri(this,"entries")}},{enumerable:!0}),Object(g.K)(ai,Ra,ai.entries),Object(g.K)(ai,"toString",(function(){for(var e,r=Na(this).entries,n=[],a=0;a<r.length;)e=r[a++],n.push($a(e.key)+"="+$a(e.value));return n.join("&")}),{enumerable:!0}),Object(g.p)(ni,La),Object(g.KW)({global:!0,forced:!wa},{URLSearchParams:ni});var ii,oi={URLSearchParams:ni,getState:Na},si=g.mC.codeAt,ui=g.L.URL,ci=oi.URLSearchParams,li=oi.getState,pi=g.J.set,fi=g.J.getterFor("URL"),di=Math.floor,hi=Math.pow,vi="Invalid scheme",yi="Invalid host",gi="Invalid port",ki=/[A-Za-z]/,bi=/[\d+\-.A-Za-z]/,mi=/\d/,Ti=/^(0x|0X)/,Ii=/^[0-7]+$/,Ui=/^\d+$/,xi=/^[\dA-Fa-f]+$/,Oi=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,wi=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,Di=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,Si=/[\u0009\u000A\u000D]/g,ji=function(e,r){var n,a,i;if("["==r.charAt(0)){if("]"!=r.charAt(r.length-1))return yi;if(!(n=Ei(r.slice(1,-1))))return yi;e.host=n}else if(Li(e)){if(r=function(e){var r,n,a=[],i=e.toLowerCase().replace(Ea,".").split(".");for(r=0;r<i.length;r++)n=i[r],a.push(Ca.test(n)?"xn--"+za(n):n);return a.join(".")}(r),Oi.test(r))return yi;if(null===(n=Ci(r)))return yi;e.host=n}else{if(wi.test(r))return yi;for(n="",a=kr(r),i=0;i<a.length;i++)n+=zi(a[i],_i);e.host=n}},Ci=function(e){var r,n,a,i,o,s,u,c=e.split(".");if(c.length&&""==c[c.length-1]&&c.pop(),(r=c.length)>4)return e;for(n=[],a=0;a<r;a++){if(""==(i=c[a]))return e;if(o=10,i.length>1&&"0"==i.charAt(0)&&(o=Ti.test(i)?16:8,i=i.slice(8==o?1:2)),""===i)s=0;else{if(!(10==o?Ui:8==o?Ii:xi).test(i))return e;s=parseInt(i,o)}n.push(s)}for(a=0;a<r;a++)if(s=n[a],a==r-1){if(s>=hi(256,5-r))return null}else if(s>255)return null;for(u=n.pop(),a=0;a<n.length;a++)u+=n[a]*hi(256,3-a);return u},Ei=function(e){var r,n,a,i,o,s,u,c=[0,0,0,0,0,0,0,0],l=0,p=null,f=0,d=function(){return e.charAt(f)};if(":"==d()){if(":"!=e.charAt(1))return;f+=2,p=++l}for(;d();){if(8==l)return;if(":"!=d()){for(r=n=0;n<4&&xi.test(d());)r=16*r+parseInt(d(),16),f++,n++;if("."==d()){if(0==n)return;if(f-=n,l>6)return;for(a=0;d();){if(i=null,a>0){if(!("."==d()&&a<4))return;f++}if(!mi.test(d()))return;for(;mi.test(d());){if(o=parseInt(d(),10),null===i)i=o;else{if(0==i)return;i=10*i+o}if(i>255)return;f++}c[l]=256*c[l]+i,2!=++a&&4!=a||l++}if(4!=a)return;break}if(":"==d()){if(f++,!d())return}else if(d())return;c[l++]=r}else{if(null!==p)return;f++,p=++l}}if(null!==p)for(s=l-p,l=7;0!=l&&s>0;)u=c[l],c[l--]=c[p+s-1],c[p+--s]=u;else if(8!=l)return;return c},Ai=function(e){var r,n,a,i;if("number"==typeof e){for(r=[],n=0;n<4;n++)r.unshift(e%256),e=di(e/256);return r.join(".")}if("object"==typeof e){for(r="",a=function(e){for(var r=null,n=1,a=null,i=0,o=0;o<8;o++)0!==e[o]?(i>n&&(r=a,n=i),a=null,i=0):(null===a&&(a=o),++i);return i>n&&(r=a,n=i),r}(e),n=0;n<8;n++)i&&0===e[n]||(i&&(i=!1),a===n?(r+=n?":":"::",i=!0):(r+=e[n].toString(16),n<7&&(r+=":")));return"["+r+"]"}return e},_i={},qi=Sa({},_i,{" ":1,'"':1,"<":1,">":1,"`":1}),Pi=Sa({},qi,{"#":1,"?":1,"{":1,"}":1}),Fi=Sa({},Pi,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),zi=function(e,r){var n=si(e,0);return n>32&&n<127&&!Object(g.P)(r,e)?e:encodeURIComponent(e)},Ri={ftp:21,file:null,gopher:70,http:80,https:443,ws:80,wss:443},Li=function(e){return Object(g.P)(Ri,e.scheme)},Mi=function(e){return""!=e.username||""!=e.password},Bi=function(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme},Ni=function(e,r){var n;return 2==e.length&&ki.test(e.charAt(0))&&(":"==(n=e.charAt(1))||!r&&"|"==n)},Wi=function(e){var r;return e.length>1&&Ni(e.slice(0,2))&&(2==e.length||"/"===(r=e.charAt(2))||"\\"===r||"?"===r||"#"===r)},Ki=function(e){var r=e.path,n=r.length;!n||"file"==e.scheme&&1==n&&Ni(r[0],!0)||r.pop()},Yi=function(e){return"."===e||"%2e"===e.toLowerCase()},Hi={},Gi={},Xi={},Ji={},Qi={},Vi={},$i={},Zi={},eo={},to={},ro={},no={},ao={},io={},oo={},so={},uo={},co={},lo={},po={},fo={},ho=function(e,r,n,a){var i,o,s,u,c,l=n||Hi,p=0,f="",d=!1,h=!1,v=!1;for(n||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,r=r.replace(Di,"")),r=r.replace(Si,""),i=kr(r);p<=i.length;){switch(o=i[p],l){case Hi:if(!o||!ki.test(o)){if(n)return vi;l=Xi;continue}f+=o.toLowerCase(),l=Gi;break;case Gi:if(o&&(bi.test(o)||"+"==o||"-"==o||"."==o))f+=o.toLowerCase();else{if(":"!=o){if(n)return vi;f="",l=Xi,p=0;continue}if(n&&(Li(e)!=Object(g.P)(Ri,f)||"file"==f&&(Mi(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=f,n)return void(Li(e)&&Ri[e.scheme]==e.port&&(e.port=null));f="","file"==e.scheme?l=io:Li(e)&&a&&a.scheme==e.scheme?l=Ji:Li(e)?l=Zi:"/"==i[p+1]?(l=Qi,p++):(e.cannotBeABaseURL=!0,e.path.push(""),l=lo)}break;case Xi:if(!a||a.cannotBeABaseURL&&"#"!=o)return vi;if(a.cannotBeABaseURL&&"#"==o){e.scheme=a.scheme,e.path=a.path.slice(),e.query=a.query,e.fragment="",e.cannotBeABaseURL=!0,l=fo;break}l="file"==a.scheme?io:Vi;continue;case Ji:if("/"!=o||"/"!=i[p+1]){l=Vi;continue}l=eo,p++;break;case Qi:if("/"==o){l=to;break}l=co;continue;case Vi:if(e.scheme=a.scheme,o==ii)e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,e.path=a.path.slice(),e.query=a.query;else if("/"==o||"\\"==o&&Li(e))l=$i;else if("?"==o)e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,e.path=a.path.slice(),e.query="",l=po;else{if("#"!=o){e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,e.path=a.path.slice(),e.path.pop(),l=co;continue}e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,e.path=a.path.slice(),e.query=a.query,e.fragment="",l=fo}break;case $i:if(!Li(e)||"/"!=o&&"\\"!=o){if("/"!=o){e.username=a.username,e.password=a.password,e.host=a.host,e.port=a.port,l=co;continue}l=to}else l=eo;break;case Zi:if(l=eo,"/"!=o||"/"!=f.charAt(p+1))continue;p++;break;case eo:if("/"!=o&&"\\"!=o){l=to;continue}break;case to:if("@"==o){d&&(f="%40"+f),d=!0,s=kr(f);for(var y=0;y<s.length;y++){var k=s[y];if(":"!=k||v){var b=zi(k,Fi);v?e.password+=b:e.username+=b}else v=!0}f=""}else if(o==ii||"/"==o||"?"==o||"#"==o||"\\"==o&&Li(e)){if(d&&""==f)return"Invalid authority";p-=kr(f).length+1,f="",l=ro}else f+=o;break;case ro:case no:if(n&&"file"==e.scheme){l=so;continue}if(":"!=o||h){if(o==ii||"/"==o||"?"==o||"#"==o||"\\"==o&&Li(e)){if(Li(e)&&""==f)return yi;if(n&&""==f&&(Mi(e)||null!==e.port))return;if(u=ji(e,f))return u;if(f="",l=uo,n)return;continue}"["==o?h=!0:"]"==o&&(h=!1),f+=o}else{if(""==f)return yi;if(u=ji(e,f))return u;if(f="",l=ao,n==no)return}break;case ao:if(!mi.test(o)){if(o==ii||"/"==o||"?"==o||"#"==o||"\\"==o&&Li(e)||n){if(""!=f){var m=parseInt(f,10);if(m>65535)return gi;e.port=Li(e)&&m===Ri[e.scheme]?null:m,f=""}if(n)return;l=uo;continue}return gi}f+=o;break;case io:if(e.scheme="file","/"==o||"\\"==o)l=oo;else{if(!a||"file"!=a.scheme){l=co;continue}if(o==ii)e.host=a.host,e.path=a.path.slice(),e.query=a.query;else if("?"==o)e.host=a.host,e.path=a.path.slice(),e.query="",l=po;else{if("#"!=o){Wi(i.slice(p).join(""))||(e.host=a.host,e.path=a.path.slice(),Ki(e)),l=co;continue}e.host=a.host,e.path=a.path.slice(),e.query=a.query,e.fragment="",l=fo}}break;case oo:if("/"==o||"\\"==o){l=so;break}a&&"file"==a.scheme&&!Wi(i.slice(p).join(""))&&(Ni(a.path[0],!0)?e.path.push(a.path[0]):e.host=a.host),l=co;continue;case so:if(o==ii||"/"==o||"\\"==o||"?"==o||"#"==o){if(!n&&Ni(f))l=co;else if(""==f){if(e.host="",n)return;l=uo}else{if(u=ji(e,f))return u;if("localhost"==e.host&&(e.host=""),n)return;f="",l=uo}continue}f+=o;break;case uo:if(Li(e)){if(l=co,"/"!=o&&"\\"!=o)continue}else if(n||"?"!=o)if(n||"#"!=o){if(o!=ii&&(l=co,"/"!=o))continue}else e.fragment="",l=fo;else e.query="",l=po;break;case co:if(o==ii||"/"==o||"\\"==o&&Li(e)||!n&&("?"==o||"#"==o)){if(".."===(c=(c=f).toLowerCase())||"%2e."===c||".%2e"===c||"%2e%2e"===c?(Ki(e),"/"==o||"\\"==o&&Li(e)||e.path.push("")):Yi(f)?"/"==o||"\\"==o&&Li(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&Ni(f)&&(e.host&&(e.host=""),f=f.charAt(0)+":"),e.path.push(f)),f="","file"==e.scheme&&(o==ii||"?"==o||"#"==o))for(;e.path.length>1&&""===e.path[0];)e.path.shift();"?"==o?(e.query="",l=po):"#"==o&&(e.fragment="",l=fo)}else f+=zi(o,Pi);break;case lo:"?"==o?(e.query="",l=po):"#"==o?(e.fragment="",l=fo):o!=ii&&(e.path[0]+=zi(o,_i));break;case po:n||"#"!=o?o!=ii&&("'"==o&&Li(e)?e.query+="%27":e.query+="#"==o?"%23":zi(o,_i)):(e.fragment="",l=fo);break;case fo:o!=ii&&(e.fragment+=zi(o,qi))}p++}},vo=function(e){var r,n,a=Object(g.A)(this,vo,"URL"),i=arguments.length>1?arguments[1]:void 0,o=String(e),s=pi(a,{type:"URL"});if(void 0!==i)if(i instanceof vo)r=fi(i);else if(n=ho(r={},String(i)))throw TypeError(n);if(n=ho(s,o,null,r))throw TypeError(n);var u=s.searchParams=new ci,c=li(u);c.updateSearchParams(s.query),c.updateURL=function(){s.query=String(u)||null},g.e||(a.href=go.call(a),a.origin=ko.call(a),a.protocol=bo.call(a),a.username=mo.call(a),a.password=To.call(a),a.host=Io.call(a),a.hostname=Uo.call(a),a.port=xo.call(a),a.pathname=Oo.call(a),a.search=wo.call(a),a.searchParams=Do.call(a),a.hash=So.call(a))},yo=vo.prototype,go=function(){var e=fi(this),r=e.scheme,n=e.username,a=e.password,i=e.host,o=e.port,s=e.path,u=e.query,c=e.fragment,l=r+":";return null!==i?(l+="//",Mi(e)&&(l+=n+(a?":"+a:"")+"@"),l+=Ai(i),null!==o&&(l+=":"+o)):"file"==r&&(l+="//"),l+=e.cannotBeABaseURL?s[0]:s.length?"/"+s.join("/"):"",null!==u&&(l+="?"+u),null!==c&&(l+="#"+c),l},ko=function(){var e=fi(this),r=e.scheme,n=e.port;if("blob"==r)try{return new URL(r.path[0]).origin}catch(a){return"null"}return"file"!=r&&Li(e)?r+"://"+Ai(e.host)+(null!==n?":"+n:""):"null"},bo=function(){return fi(this).scheme+":"},mo=function(){return fi(this).username},To=function(){return fi(this).password},Io=function(){var e=fi(this),r=e.host,n=e.port;return null===r?"":null===n?Ai(r):Ai(r)+":"+n},Uo=function(){var e=fi(this).host;return null===e?"":Ai(e)},xo=function(){var e=fi(this).port;return null===e?"":String(e)},Oo=function(){var e=fi(this),r=e.path;return e.cannotBeABaseURL?r[0]:r.length?"/"+r.join("/"):""},wo=function(){var e=fi(this).query;return e?"?"+e:""},Do=function(){return fi(this).searchParams},So=function(){var e=fi(this).fragment;return e?"#"+e:""},jo=function(e,r){return{get:e,set:r,configurable:!0,enumerable:!0}};if(g.e&&Object(g.v)(yo,{href:jo(go,(function(e){var r=fi(this),n=String(e),a=ho(r,n);if(a)throw TypeError(a);li(r.searchParams).updateSearchParams(r.query)})),origin:jo(ko),protocol:jo(bo,(function(e){var r=fi(this);ho(r,String(e)+":",Hi)})),username:jo(mo,(function(e){var r=fi(this),n=kr(String(e));if(!Bi(r)){r.username="";for(var a=0;a<n.length;a++)r.username+=zi(n[a],Fi)}})),password:jo(To,(function(e){var r=fi(this),n=kr(String(e));if(!Bi(r)){r.password="";for(var a=0;a<n.length;a++)r.password+=zi(n[a],Fi)}})),host:jo(Io,(function(e){var r=fi(this);r.cannotBeABaseURL||ho(r,String(e),ro)})),hostname:jo(Uo,(function(e){var r=fi(this);r.cannotBeABaseURL||ho(r,String(e),no)})),port:jo(xo,(function(e){var r=fi(this);Bi(r)||(""==(e=String(e))?r.port=null:ho(r,e,ao))})),pathname:jo(Oo,(function(e){var r=fi(this);r.cannotBeABaseURL||(r.path=[],ho(r,e+"",uo))})),search:jo(wo,(function(e){var r=fi(this);""==(e=String(e))?r.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),r.query="",ho(r,e,po)),li(r.searchParams).updateSearchParams(r.query)})),searchParams:jo(Do),hash:jo(So,(function(e){var r=fi(this);""!=(e=String(e))?("#"==e.charAt(0)&&(e=e.slice(1)),r.fragment="",ho(r,e,fo)):r.fragment=null}))}),Object(g.K)(yo,"toJSON",(function(){return go.call(this)}),{enumerable:!0}),Object(g.K)(yo,"toString",(function(){return go.call(this)}),{enumerable:!0}),ui){var Co=ui.createObjectURL,Eo=ui.revokeObjectURL;Co&&Object(g.K)(vo,"createObjectURL",(function(e){return Co.apply(ui,arguments)})),Eo&&Object(g.K)(vo,"revokeObjectURL",(function(e){return Eo.apply(ui,arguments)}))}Object(g.p)(vo,"URL"),Object(g.KW)({global:!0,forced:!wa,sham:!g.e},{URL:vo});var Ao=g.Y.URL,_o=Object(g.mo)((function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var n="";function a(e){return(Array(4).join("0")+parseInt(e,2).toString(16)).slice(-4)}function i(e){if(!e)return"00000000000000000000000000000000";var r=e.split(/\./).map((function(e){return r=e,(Array(8).join("0")+parseInt(r,10).toString(2)).slice(-8);var r})),n=[];return n[0]=a(r[0]+r[1]),n[1]=a(r[2]+r[3]),["0000","0000","0000","0000","0000","ffff",n[0],n[1]].join("")}r.genLogID=function(e){var r=""+Date.now(),a="";return e?(a=i(e),n=a):a=n||(n=i(function(){for(var e=[],r=0;r<4;r++)e.push(Math.floor(256*Math.random()));return e.join(".")}())),"02"+r+a+Math.random().toString(16).slice(-6)}}));Object(g.V)(_o);var qo,Po=_o.genLogID;!function(e){e.INCREASE="increase",e.REDUCE="reduce"}(qo||(qo={}));var Fo=function(){function e(){Ot(this,e),this.sleepTimeoutMap=new Vr,this.retryCountMap=new Vr}return Zr(e,[{key:"getUrlMapKey",value:function(e){var r=e.match(/^https?\:\/\/[^\/?#]*([^?#]*).*$/);return r&&r[1]?r[1]:e}},{key:"getSleepTimeout",value:function(e){return this.sleepTimeoutMap.get(e)}},{key:"getRetryCount",value:function(e){return this.retryCountMap.get(e)}},{key:"handleTooManyRequest",value:function(e){this.addRetryCount(e),this.setSleepTimeout(e,qo.INCREASE)}},{key:"handleNotTooManyRequest",value:function(e){this.clearRetryCount(e),this.setSleepTimeout(e,qo.REDUCE)}},{key:"setSleepTimeout",value:function(e,r){var n=this.sleepTimeoutMap.get(e),a=n||0;r===qo.INCREASE?a=n?Math.min(16e3,2*n):2e3:r===qo.REDUCE&&(a=n&&n>2e3?n/2:0),this.sleepTimeoutMap.set(e,a)}},{key:"clearRetryCount",value:function(e){this.retryCountMap.delete(e)}},{key:"addRetryCount",value:function(e){var r=this.retryCountMap.get(e),n=r?r+1:1;this.retryCountMap.set(e,n)}}]),e}();function zo(e,r){var n=It(e);if(bt){var a=bt(e);r&&(a=qe(a).call(a,(function(r){return Ce(e,r).enumerable}))),n.push.apply(n,a)}return n}function Ro(e){for(var r=1;r<arguments.length;r++){var n,a=null!=arguments[r]?arguments[r]:{};if(r%2)Oe(n=zo(Object(a),!0)).call(n,(function(r){xt(e,r,a[r])}));else if(be)he(e,be(a));else{var i;Oe(i=zo(Object(a))).call(i,(function(r){fe(e,r,Ce(a,r))}))}}return e}Fo.MAX_RETRY_COUNT=20;M.a.CancelToken;function Lo(e){var r=document.cookie.match(new RegExp("(?:^|;)\\s*".concat(e,"=([^;]+)")));return window.decodeURIComponent(r?r[1]:"")}function Mo(e){try{var r=new Ao(e).hostname.split(".")[0];return xa(r).call(r,"internal-")?r:"Unknown"}catch(n){return"Unknown"}}var Bo,No,Wo=function(){function e(r){Ot(this,e),this.nearbyDriveAPIHostLoginRequired=!1,this.timeout=6e5,this.backoffController=new Fo,this.axiosInstance=r.envConfigs.customRequest||M.a.create({}),this.initEnvConfigs(r.envConfigs,r.featureFlags)}return Zr(e,[{key:"post",value:function(e,r,n){return this.internalPost(e,r,n)}},{key:"postUrlEncoded",value:function(e,r,n){return this.internalPost(e,N.a.stringify(r),Ro({},n,{headers:Ro({"Content-Type":"application/x-www-form-urlencoded"},n?n.headers:null)}))}},{key:"postFormData",value:function(e,r,n){return this.internalPost(e,r,Ro({},n,{headers:Ro({"Content-Type":"multipart/form-data"},n?n.headers:null)}))}},{key:"importRequest",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,c,l;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.axiosInstance(Ro({},r,{withCredentials:!0,timeout:this.timeout,ignoreInterceptors:!0,headers:Ro({},r.headers,{"X-CSRFToken":Lo("_csrf_token")||"","X-TT-LOGID":Po()})}));case 3:return n=e.sent,a=n.data,i=n.headers,o=n.request,e.abrupt("return",{data:a,reqID:i["x-request-id"],subdomain:Mo(o.responseURL)});case 8:if(e.prev=8,e.t0=e.catch(0),!M.a.isCancel(e.t0)){e.next=12;break}throw new Error("Cancelled");case 12:if(e.t0.response){e.next=14;break}throw new Error("Network Error");case 14:throw s=e.t0.response,u=s.data,c=s.headers,l=s.request,{data:u,reqID:c["x-request-id"],subdomain:Mo(l.responseURL)};case 16:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(r){return e.apply(this,arguments)}}()},{key:"importPostFormData",value:function(e,r,n){return this.importRequest(Ro({},n,{url:e,data:r,method:"post",headers:Ro({"Content-Type":"multipart/form-data"},n?n.headers:null)}))}},{key:"importGet",value:function(e,r,n){return this.importRequest(Ro({},n,{url:e,params:r,method:"get"}))}},{key:"getXCommand",value:function(e){return e.replace(/(?:^.*\/\/[^\/]+\/)|(?:\/*(?:\?.*)?$)/g,"").replace(/\//g,".")}},{key:"initEnvConfigs",value:function(){var e=x(b.mark((function e(r,n){var a,i,o,s,u,c,l;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Boolean(n&&n.nearbyDriveAPIAccess),i=r.isLocalhost,o=r.teaConfig,!i){e.next=7;break}return this.defaultSpaceAPIOrigin=window.location.origin,this.defaultDriveAPIOrigin=window.location.origin,a&&(this.defaultNearbyDriveAPIOrigin=window.location.origin),e.abrupt("return");case 7:if(s=Object(F.get)(r,"spaceAPIHosts[0]")){e.next=10;break}throw new Error("spaceAPIHosts not provided");case 10:if(this.defaultSpaceAPIOrigin="https://".concat(s),u=Object(F.get)(r,"driveAPIHosts[0]",""),c=Object(F.get)(r,"nearbyDriveAPIHosts[0]",""),!u||a&&!c||Object(F.isEmpty)(o)){e.next=17;break}this.envConfigs=r,e.next=21;break;case 17:return e.next=19,this.fetchEnvConfigs(r);case 19:l=e.sent,this.envConfigs=Ro({},l,{},r);case 21:this.defaultDriveAPIOrigin="https://".concat(Object(F.get)(this.envConfigs,"driveAPIHosts[0]","")),a&&(this.defaultNearbyDriveAPIOrigin="https://".concat(Object(F.get)(this.envConfigs,"nearbyDriveAPIHosts[0]","")));case 23:case"end":return e.stop()}}),e,this)})));return function(r,n){return e.apply(this,arguments)}}()},{key:"fetchEnvConfigs",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,c,l,p,f,d,h,v;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(F.get)(r,"userID"),a=Object(F.get)(r,"tenantID"),n){e.next=4;break}return e.abrupt("return",{});case 4:if(e.prev=4,i="box-upload-env-config",o=sessionStorage.getItem(i)||"{}",s=JSON.parse(o),u=s[n],Object(F.isEmpty)(u)){e.next=11;break}return e.abrupt("return",Ro({},u));case 11:return c="".concat(this.spaceAPIOrigin,"/space/api/infra/domains/all"),e.next=14,this.request({url:c});case 14:l=e.sent,p=l.data,f=Object(F.get)(p,"common"),(h=f.tea)&&!0===h.open&&(d={userID:n,tenantID:a,appID:Object(F.get)(h,"config.appId.drive_sdk"),suiteAppID:Object(F.get)(h,"config.appId.doc"),channelDomain:Object(F.get)(h,"config.channel_domain")}),v={teaConfig:d},s[n]=v;try{sessionStorage.setItem(i,ba(v))}catch(y){console.warn("save env config failed",y)}return e.abrupt("return",v);case 25:return e.prev=25,e.t0=e.catch(4),console.warn("fetch env config failed",e.t0),e.abrupt("return",{});case 29:case"end":return e.stop()}}),e,this,[[4,25]])})));return function(r){return e.apply(this,arguments)}}()},{key:"request",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,c,l,p,f,d,h;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.backoffController.getUrlMapKey(r.url),e.prev=1,!(a=this.backoffController.getSleepTimeout(n))){e.next=6;break}return e.next=6,oa(a);case 6:return e.next=8,this.axiosInstance(Ro({},r,{withCredentials:!0,timeout:this.timeout,ignoreInterceptors:!0,headers:Ro({},r.headers,{"X-Request-Id":sn(32),"X-CSRFToken":Lo("_csrf_token")||"","X-Command":this.getXCommand(r.url||""),"X-TT-LOGID":Po()})}));case 8:if(i=e.sent,o=i.data,s=i.headers,u=i.request,0===o.code){e.next=12;break}throw{response:i};case 12:return this.backoffController.handleNotTooManyRequest(n),e.abrupt("return",{data:o.data,reqID:s["x-request-id"],logID:s["x-tt-logid"],subdomain:Mo(u.responseURL)});case 16:if(e.prev=16,e.t0=e.catch(1),!M.a.isCancel(e.t0)){e.next=20;break}throw new Error("Cancelled");case 20:if(e.t0.response){e.next=22;break}throw new Error("Network Error");case 22:if(!(401===e.t0.response.status&&this.defaultDriveAPIOrigin&&this.shouldUseNearbyDriveAPI&&ya(c=r.url).call(c,this.defaultNearbyDriveAPIOrigin))){e.next=27;break}return this.nearbyDriveAPIHostLoginRequired=!0,r.url=r.url.replace("https://".concat(this.defaultNearbyDriveAPIOrigin),this.defaultDriveAPIOrigin),e.abrupt("return",this.request(r));case 27:if(429!==e.t0.response.status){e.next=33;break}if(!((l=this.backoffController.getRetryCount(n))&&l>=Fo.MAX_RETRY_COUNT)){e.next=31;break}throw e.t0.response.data;case 31:return this.backoffController.handleTooManyRequest(n),e.abrupt("return",this.request(r));case 33:throw this.backoffController.handleNotTooManyRequest(n),p=e.t0.response,f=p.data,d=p.headers,h=p.request,{data:f,reqID:d["x-request-id"],logID:d["x-tt-logid"],subdomain:Mo(h.responseURL)};case 36:case"end":return e.stop()}}),e,this,[[1,16]])})));return function(r){return e.apply(this,arguments)}}()},{key:"internalPost",value:function(e,r,n){return this.request(Ro({},n,{url:e,data:r,method:"post"}))}},{key:"shouldUseNearbyDriveAPI",get:function(){return!this.nearbyDriveAPIHostLoginRequired&&this.defaultNearbyDriveAPIOrigin}},{key:"driveAPIOrigin",get:function(){return this.shouldUseNearbyDriveAPI?this.defaultNearbyDriveAPIOrigin:this.defaultDriveAPIOrigin}},{key:"spaceAPIOrigin",get:function(){return this.defaultSpaceAPIOrigin}}]),e}();!function(e){e.manager="manager",e.member="member",e.visitor="visitor"}(No||(No={}));var Ko=(xt(Bo={},No.manager,1),xt(Bo,No.member,2),xt(Bo,No.visitor,3),Bo),Yo="box/stream/upload/all",Ho="box/upload/prepare",Go="box/upload/prepare/authcode",Xo="box/stream/upload/merge_block",Jo="box/upload/blocks",Qo="box/upload/finish",Vo="explorer/create",$o="explorer/create/folder",Zo="explorer/v2/create/folder",es="parser/uploadfile",ts="parser/wiki_uploadfile",rs="parser/wiki/parse_evernote_from_drive",ns="parser/wiki/getresult",as="import/create",is="import/result",os=aa(Ko),ss=function(){function e(r){Ot(this,e);var n=r.envConfigs,a=r.featureFlags;this.envConfigs=n,this.featureFlags=a||{},this.request=new Wo({envConfigs:n,featureFlags:a})}return Zr(e,[{key:"getURL",value:function(e,r){var n,a=r?this.request.driveAPIOrigin:this.request.spaceAPIOrigin;return jr(n="".concat(a,"/space/api/")).call(n,e,"/")}},{key:"createDirectory",value:function(e){switch(e.directoryType){case d.V3Folder:return this.createV3Folder(e);case d.NewSharedFolder:return this.createNewSharedFolderDirectory(e);case d.Normal:default:return this.createNormalDirectory(e)}}},{key:"createV3Folder",value:function(){var e=x(b.mark((function e(r){var n,a,i,o;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request.postUrlEncoded(this.getURL(Zo),ia({parent_token:r.parentToken,name:r.name,source:0}));case 2:return n=e.sent,a=n.data,i=n.reqID,o=a.node_list[0],e.abrupt("return",{reqID:i,token:o});case 7:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"createNewSharedFolderDirectory",value:function(){var e=x(b.mark((function e(r){var n,a,i;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request.post(this.getURL($o),ia({parent_token:r.parentToken,name:r.name,inherit:os}),{headers:{"Content-Type":"application/json"}});case 2:return n=e.sent,a=n.data,i=n.reqID,e.abrupt("return",{reqID:i,token:a.token});case 6:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"createNormalDirectory",value:function(){var e=x(b.mark((function e(r){var n,a,i;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request.postUrlEncoded(this.getURL(Vo),ia({parent_token:r.parentToken,name:r.name,type:0}));case 2:return n=e.sent,a=n.data,i=n.reqID,e.abrupt("return",{reqID:i,token:a.token});case 6:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"prepareFileByAuthCode",value:function(){var e=x(b.mark((function e(r){var n,a,i,o;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request.post(this.getURL(Go),ia({code:r.authCode,mount_point:r.mountPoint,mount_node_token:r.mountNodeToken}));case 2:return n=e.sent,a=n.data,i=n.reqID,o=n.logID,e.abrupt("return",{reqID:i,logID:o,chunkSize:a.block_size,totalChunks:a.num_blocks,uploadID:a.upload_id,suggestedChunkSize:a.option_block_size||4194304});case 7:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"prepareFile",value:function(){var e=x(b.mark((function e(r){var n,a,i,o;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request.post(this.getURL(Ho),ia({mount_point:r.mountPoint,mount_node_token:r.mountNodeToken,name:r.name,size:r.size,file_token:r.fileToken,extra:r.bizExtra||this.envConfigs.bizExtra,size_checker:Boolean(this.featureFlags.fileSizeChecker)}));case 2:return n=e.sent,a=n.data,i=n.reqID,o=n.logID,e.abrupt("return",{reqID:i,logID:o,chunkSize:a.block_size,totalChunks:a.num_blocks,uploadID:a.upload_id,suggestedChunkSize:a.option_block_size,dedupeSupport:a.dedupe_support});case 7:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"deduplicate",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.uploadId,a=r.blocks,i=r.mountPoint,e.next=3,this.request.post(this.getURL(Jo),{blocks:a,upload_id:n,mount_point:i});case 3:return o=e.sent,s=o.data,u=o.reqID,e.abrupt("return",{reqID:u,blocks:s.needed_upload_blocks});case 7:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"uploadChunk",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,c,l,p,f,d,h,v,y;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.seqList,a=r.checksums,i=r.chunkSize,o=r.uploadID,s=r.sliceData,u=r.onUploadProgress,c=r.cancelToken,l=r.mountPoint,p={"Content-Type":"application/octet-stream","x-seq-list":n.join(),"x-block-list-checksum":a.join(),"x-block-origin-size":i},f={upload_id:o,mount_point:l},e.next=5,this.request.post(this.uploadChunkURL,s,{headers:p,params:f,cancelToken:c,onUploadProgress:u});case 5:return d=e.sent,h=d.data,v=d.reqID,y=d.subdomain,e.abrupt("return",{reqID:v,subdomain:y,successSeqList:h.success_seq_list});case 10:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"finishFile",value:function(){var e=x(b.mark((function e(r){var n,a,i;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request.post(this.getURL(Qo),ia({upload_id:r.uploadID,num_blocks:r.totalChunks,member_id:r.memberID,mount_point:r.mountPoint,push_open_history_record:r.shouldAddToRecents?1:0}));case 2:return n=e.sent,a=n.data,i=n.reqID,e.abrupt("return",{reqID:i,fileToken:a.file_token,version:a.version,dataVersion:a.data_version,successExtra:a.extra});case 6:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"directUpload",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,c,l,p,f,d,h,v,y,g,k;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.name,a=r.size,i=r.file,o=r.mountNodeToken,s=r.mountPoint,u=r.fileToken,c=r.checksum,l=r.shouldAddToRecents,p=r.memberID,f=r.bizRouteKey,d=r.bizExtra,h=r.onUploadProgress,(v=new FormData).append("file",i),e.next=5,this.request.post(this.getURL(Yo),v,{onUploadProgress:h,params:ia({name:n,size:a,checksum:c,mount_node_token:o,mount_point:s,file_token:u,push_open_history_record:l?1:0,member_id:p,"ext[route_key]":f,"ext[extra]":(d||this.envConfigs.bizExtra||{extra:""}).extra,size_checker:Boolean(this.featureFlags.fileSizeChecker)}),headers:{"Content-Type":"multipart/form-data"}});case 5:return y=e.sent,g=y.data,k=y.reqID,e.abrupt("return",{reqID:k,fileToken:g.file_token,version:g.version,dataVersion:g.data_version,successExtra:g.extra});case 9:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"importUpload",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,l,p;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new FormData,a=r.options,i=r.cancelToken,o=r.onUploadProgress,n.append("name",r.name),n.append("type",r.type),n.append("size",String(r.size)),n.append("parent_token",r.parentToken),n.append("file",r.file),n.append("source",this.envConfigs.source||""),a&&a.format&&n.append("format",a.format),s=a&&a.businessType===c.WIKI?ts:es,e.next=12,this.request.importPostFormData(this.getURL(s),n,{cancelToken:i,onUploadProgress:o});case 12:return u=e.sent,l=u.data,p=u.reqID,e.abrupt("return",{reqID:p,code:l.code,ticket:l.ticket});case 16:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"importStatusCheck",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,c;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request.importGet(jr(n="".concat(this.getURL(is))).call(n,r));case 2:return a=e.sent,i=a.data,o=a.reqID,s=i.code,u=i.msg,c=i.data.result,e.abrupt("return",{reqID:o,msg:u,code:s,fileToken:null===c||void 0===c?void 0:c.token,jobStatus:null===c||void 0===c?void 0:c.job_status,extra:null===c||void 0===c?void 0:c.extra,responseData:i});case 7:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"importParseEvernote",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.request.post(this.getURL(rs),{file_token:r.fileToken},{cancelToken:r.cancelToken});case 3:return n=e.sent,a=n.data,i=n.reqID,e.abrupt("return",{reqID:i,ticket:a.ticket});case 9:if(e.prev=9,e.t0=e.catch(0),o=e.t0.data,s=e.t0.reqID,!o){e.next=14;break}return e.abrupt("return",{reqID:s,ticket:o.ticket});case 14:throw e.t0;case 15:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(r){return e.apply(this,arguments)}}()},{key:"importEvernoteStatusCheck",value:function(){var e=x(b.mark((function e(r){var n,a,i;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request.importGet(this.getURL(ns),{ticket:r.ticket,source:this.envConfigs.source});case 2:return n=e.sent,a=n.data,i=n.reqID,e.abrupt("return",{reqID:i,code:a.code,fileToken:Object(F.get)(a,"tokens[0]"),warningCode:a.warningCode,responseData:a});case 6:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"createImportTask",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,c;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request.importPostFormData(this.getURL(as),{file_token:r.file_token,type:r.type,file_extension:r.file_extension,point:r.point,event_source:r.event_source});case 2:return n=e.sent,a=n.reqID,i=n.data,o=i.code,s=i.data,u=void 0===s?{}:s,c=i.msg,e.abrupt("return",{reqID:a,code:o,msg:c,ticket:null===u||void 0===u?void 0:u.ticket,job_timeout:null===u||void 0===u?void 0:u.job_timeout});case 7:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"uploadChunkURL",get:function(){return this.getURL(Xo,!0)}}]),e}();function us(e,r){var n=It(e);if(bt){var a=bt(e);r&&(a=qe(a).call(a,(function(r){return Ce(e,r).enumerable}))),n.push.apply(n,a)}return n}function cs(e){for(var r=1;r<arguments.length;r++){var n,a=null!=arguments[r]?arguments[r]:{};if(r%2)Oe(n=us(Object(a),!0)).call(n,(function(r){xt(e,r,a[r])}));else if(be)he(e,be(a));else{var i;Oe(i=us(Object(a))).call(i,(function(r){fe(e,r,Ce(a,r))}))}}return e}function ls(e){return G()("08a441"+K()(e+"42b91e")).toString()}var ps=function(){function e(r){var n=r.scenario,a=r.driveSDKAppID;Ot(this,e),this.pendingEvents=[],this.isUnavailable=!1,this.driveSDKAppID=a,this.scenario=n}return Zr(e,[{key:"kickOff",value:function(e){var r,n=this,a=e.appID,i=e.channelDomain,o=e.instanceName,s=e.isOnlineEnv,u=e.userID,c=e.tenantID;(this.instanceName=o,this.tenantID=Object(F.isString)(c)?ls(c):c,this.tracker=new Y.Collector(this.instanceName),this.tracker.init({channel_domain:i,app_id:a,log:!1,disable_session:!0,disable_sdk_monitor:!0}),this.tracker.config({_staging_flag:s?0:1,user_unique_id:u?ls(u):"",disable_auto_pv:!0}),this.tracker.start(),this.isUnavailable=!1,this.pendingEvents.length>0)&&(Oe(r=this.pendingEvents).call(r,(function(e){n.collectEvent(e.eventName,e.options)})),this.clearPendingEvents())}},{key:"clearPendingEvents",value:function(){this.pendingEvents=[]}},{key:"setIsUnavailable",value:function(){this.clearPendingEvents(),this.isUnavailable=!0}},{key:"collectEvent",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isUnavailable)if(this.tracker)try{var n=cs({},r,{instance:this.instanceName,tenant_id:this.tenantID,scenario:this.scenario,drive_sdk_app_id:this.driveSDKAppID});this.tracker(e,n)}catch(a){console.error("collect event error",a)}else this.pendingEvents.push({eventName:e,options:r})}},{key:"collectFileSuccessEvent",value:function(e){var r=e.mountType,n=e.size,a=e.duration,i=e.uploadMode,o=a>0?Math.round(n/a*1e3):0;this.collectEvent("dev_upload_file_success",{duration:a,size:n,speed:o,upload_mode:i,mount_type:r})}},{key:"collectFileErrorEvent",value:function(e){var r=e.mountType,n=e.size,a=e.reqID,i=e.logID,o=e.errorType,s=e.errorMsg,u=e.uploadMode;this.collectEvent("dev_upload_file_error",{size:n,upload_mode:u,mount_type:r,request_id:a,log_id:i,error_type:o,error_msg:s})}},{key:"collectChunkSuccessEvent",value:function(e){var r=e.mountType,n=e.offset,a=e.size,i=e.duration,o=e.subdomain,s=e.uploadMode,u=i>0?Math.round(a/i*1e3):0;this.collectEvent("dev_upload_chunk_success",{offset:n,size:a,duration:i,speed:u,subdomain:o,upload_mode:s,mount_type:r})}},{key:"collectChunkErrorEvent",value:function(e){var r=e.mountType,n=e.offset,a=e.size,i=e.reqID,o=e.logID,s=e.subdomain,u=e.errorType,c=e.errorMsg,l=e.uploadMode;this.collectEvent("dev_upload_chunk_error",{offset:n,size:a,subdomain:s,upload_mode:l,mount_type:r,request_id:i,log_id:o,error_type:u,error_msg:c})}},{key:"collectCreateDirectoryErrorEvent",value:function(e){var r=e.reqID,n=e.logID,a=e.errorType,i=e.errorMsg;this.collectEvent("dev_upload_create_directory_error",{request_id:r,log_id:n,error_type:a,error_msg:i})}},{key:"collectDocsFileChooseEvent",value:function(e){var r=e.mountPoint,n=e.fileNum,a=e.addMode;this.collectEvent("ccm_space_file_choose_click",{mount_point:r,file_num:n,add_mode:a})}},{key:"collectDocsFileFinishEvent",value:function(e){var r=e.mountPoint,n=e.isSuccessful,a=e.fileNum;this.collectEvent("ccm_drive_upload_finish_view",{mount_point:r,is_successful:n?"true":"false",file_num:a})}}]),e}(),fs="Create directory task not found";var ds=function(){function e(r){var n=r.requestService,a=r.onStatusChanged,i=r.logger;Ot(this,e),this.createDirectoryTaskMap=new Vr,this.requestService=n,this.onStatusChanged=a,this.logger=i}return Zr(e,[{key:"startCreateDirectory",value:function(e){var r,n=e.uuid,a=e.parentUUID,i=e.parentToken,o=e.name,s=e.directoryType,u=this.createDirectoryTaskMap.get(n);if(u){if("pending"!==(r=u.status)&&"paused"!==r&&"error"!==r&&"success"!==r)return void console.warn("Cannot start a task that is already in progress.");"success"===u.status&&u.token?this.onCreateDirectorySuccess({uuid:n,parentUUID:u.parentUUID,token:u.token}):this.doCreateDirectory(n)}else this.createDirectoryTaskMap.set(n,{uuid:n,parentUUID:a,parentToken:i,name:o,directoryType:s,status:"pending"}),this.doCreateDirectory(n)}},{key:"cancelCreateDirectory",value:function(e){var r,n=this.createDirectoryTaskMap.get(e);n?"pending"!==(r=n.status)&&"creating"!==r&&"retrying"!==r||(n.status="paused"):console.warn(fs)}},{key:"doCreateDirectory",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,c,l,p,f,d,h,v;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.createDirectoryTaskMap.get(r)){e.next=4;break}return console.warn(fs),e.abrupt("return");case 4:return a=n.parentUUID,i=n.parentToken,o=n.name,s=n.retryCount,c=n.directoryType,n.status=s?"creating":"retrying",e.prev=6,e.next=9,this.requestService.createDirectory({name:o,parentToken:i,directoryType:c});case 9:l=e.sent,p=l.token,n.token=p,n.status="success",this.onCreateDirectorySuccess({uuid:r,parentUUID:a,token:p}),e.next=37;break;case 16:if(e.prev=16,e.t0=e.catch(6),e.t0){e.next=22;break}return n.status="error",this.onCreateDirectoryError({uuid:r,parentUUID:a,reqID:"",logID:"",errorType:u.CreateDirectoryUnexpected}),e.abrupt("return");case 22:if(f=e.t0.reqID||"",d=e.t0.logID||"",h=e.t0.data?e.t0.data.code:e.t0.message,this.logger.collectCreateDirectoryErrorEvent({errorType:h,reqID:f,logID:d}),!(s&&s>=3)){e.next=31;break}n.status="error",this.onCreateDirectoryError({uuid:r,parentUUID:a,reqID:f,logID:d,errorType:h}),e.next=37;break;case 31:return e.next=33,oa(1e3);case 33:v=s?s+1:1,n.retryCount=v,this.onCreateDirectoryRetry({uuid:r,parentUUID:a,reqID:f,logID:d,errorType:h,retry:v}),this.doCreateDirectory(r);case 37:case"end":return e.stop()}}),e,this,[[6,16]])})));return function(r){return e.apply(this,arguments)}}()},{key:"onCreateDirectoryRetry",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.retry,i=e.reqID,o=e.logID,s=e.errorType;this.onStatusChanged({type:"retry",data:{uuid:r,parentUUID:n,retry:a,reqID:i,logID:o,errorType:s}})}},{key:"onCreateDirectorySuccess",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.token;this.onStatusChanged({type:"success",data:{uuid:r,parentUUID:n,token:a}})}},{key:"onCreateDirectoryError",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.reqID,i=e.logID,o=e.errorType;this.onStatusChanged({type:"error",data:{uuid:r,parentUUID:n,reqID:a,logID:i,errorType:o}})}}]),e}(),hs=[].slice,vs={},ys=function(e,r,n){if(!(r in vs)){for(var a=[],i=0;i<r;i++)a[i]="a["+i+"]";vs[r]=Function("C,a","return new C("+a.join(",")+")")}return vs[r](e,n)},gs=Function.bind||function(e){var r=Object(g.rs)(this),n=hs.call(arguments,1),a=function(){var i=n.concat(hs.call(arguments));return this instanceof a?ys(r,i.length,i):r.apply(e,i)};return Object(g.U)(r.prototype)&&(a.prototype=r.prototype),a};Object(g.KW)({target:"Function",proto:!0},{bind:gs});var ks=Object(g.q4)("Function").bind,bs=Function.prototype,ms=function(e){var r=e.bind;return e===bs||e instanceof Function&&r===bs.bind?ks:r};function Ts(e){var r=String(e).split(".").pop();return r&&r!==e?r.toLowerCase():""}var Is=function(e){if(yr(e))return e};var Us=function(e,r){if(Ur(Object(e))||"[object Arguments]"===Object.prototype.toString.call(e)){var n=[],a=!0,i=!1,o=void 0;try{for(var s,u=Kr(e);!(a=(s=u.next()).done)&&(n.push(s.value),!r||n.length!==r);a=!0);}catch(c){i=!0,o=c}finally{try{a||null==u.return||u.return()}finally{if(i)throw o}}return n}};var xs=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")};var Os=function(e,r){return Is(e)||Us(e,r)||xs()},ws=[].slice,Ds=/MSIE .\./.test(g.u),Ss=function(e){return function(r,n){var a=arguments.length>2,i=a?ws.call(arguments,2):void 0;return e(a?function(){("function"==typeof r?r:Function(r)).apply(this,i)}:r,n)}};Object(g.KW)({global:!0,bind:!0,forced:Ds},{setTimeout:Ss(g.L.setTimeout),setInterval:Ss(g.L.setInterval)});var js=g.Y.setTimeout;Object(g.KW)({target:"Object",stat:!0,forced:Object.assign!==Sa},{assign:Sa});var Cs=g.Y.Object.assign;function Es(e){return function(e){e="string"===typeof e?function(e){for(var r=new Uint8Array(e.length),n=0,a=e.length;n<a;n++)r[n]=255&e.charCodeAt(n);return r}(e):e;var r=new Uint32Array([1,0,e.length,0,0,65521,5552,0]),n=r[0],a=r[1],i=r[2],o=r[3],s=r[4],u=r[5],c=r[6];for(;i>0;){i-=s=i>c?c:i;do{a+=n+=e[o++]}while(--s);n%=u,a%=u}return(a<<16|n)>>>0}(new Uint8Array(e)).toString()}function As(e){for(var r=new Uint8Array(e),n="",a=0,i=r.byteLength;a<i;a++)n+=String.fromCharCode(r[a]);return btoa(n)}var _s,qs=128,Ps=4194304;function Fs(e,r){var n=It(e);if(bt){var a=bt(e);r&&(a=qe(a).call(a,(function(r){return Ce(e,r).enumerable}))),n.push.apply(n,a)}return n}!function(e){e[e.DIRECT=1]="DIRECT",e[e.FAST=2]="FAST",e[e.CHUNK=3]="CHUNK"}(_s||(_s={}));var zs="Upload task not found";function Rs(e){return"pending"===e||"uploading"===e||"finishing"===e}function Ls(e){var r=e.file,n=e.prepareResult,a=e.chunkOffset,i=e.actualTotalChunks,o=e.deduplicatedBlocks,s=0===r.size||!Object(F.isUndefined)(o)&&(0===o.length||!Nr(o).call(o,(function(e){return"success"!==e.status}))),u=!Object(F.isUndefined)(a)&&!Object(F.isUndefined)(i)&&a>=i;return n&&(s||u)}var Ms=function(){function e(r){var n=r.logger,a=r.featureFlags;Ot(this,e),this.pendingFinishList=[],this.processFinishList=[],this.logger=n,this.featureFlags=function(e){for(var r=1;r<arguments.length;r++){var n,a=null!=arguments[r]?arguments[r]:{};if(r%2)Oe(n=Fs(Object(a),!0)).call(n,(function(r){xt(e,r,a[r])}));else if(be)he(e,be(a));else{var i;Oe(i=Fs(Object(a))).call(i,(function(r){fe(e,r,Ce(a,r))}))}}return e}({},h,{},a),this.fastUploadEnabled=Boolean(this.featureFlags.largeFileFastUpload)&&this.fastUploadSupported,this.directUploadEnabled=Boolean(this.featureFlags.smallFileDirectUpload),this.finishRetryAndConcurrent=Boolean(this.featureFlags.concurrentAndRetryableUpload)}return Zr(e,[{key:"useDirectUpload",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.directUploadEnabled&&e<=Ps&&r}},{key:"startUpload",value:function(e){var r,n=e.uuid,a=e.parentUUID,i=e.isOnlyOneFileTask,o=this.getUploadTaskMap().get(n);if(o){if("pending"!==(r=o.status)&&"paused"!==r&&"error"!==r&&"success"!==r)return void console.warn("Cannot start a task that is already in progress.");"paused"===o.status&&(o.status="pending");var s=o.prepareResult,u=o.finishResult;"success"===o.status&&u?this.onUploadSuccess({uuid:n,parentUUID:a}):Ls(o)?this.finishFileTask(n):this.useDirectUpload(o.file.size,i)?this.directUploadTask(o):s?o.uploadMode===_s.FAST?this.deduplicateAndUploadBlocks(o,o.deduplicatedBlockIndex):this.uploadChunkOfUploadTask(n):this.prepareUploadTask(n)}else this.setNewTask(e),this.startUpload(e)}},{key:"cancelUpload",value:function(e){var r=this.getUploadTaskMap().get(e);if(r){if(Rs(r.status)){r.status="paused",this.markDuration(r);var n=r.cancelUploadSource;n&&(n.cancel(),r.cancelUploadSource=void 0)}}else console.warn(zs)}},{key:"cancelAllUploads",value:function(){var e,r=this;Oe(e=this.getUploadTaskMap()).call(e,(function(e,n){Rs(e.status)&&r.cancelUpload(n)}))}},{key:"prepareUploadTask",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,c,l,p;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getUploadTaskMap().get(r)){e.next=4;break}return console.warn(zs),e.abrupt("return");case 4:return this.triggerUploadStart({task:n}),e.prev=5,e.next=8,this.prepareFile(n);case 8:a=e.sent,n.prepareResult=a,i=a.chunkSize,o=a.suggestedChunkSize,s=a.totalChunks,c=a.dedupeSupport,l=o/i,this.fastUploadEnabled&&c&&s?(n.uploadMode=_s.FAST,n.chunkOffset=0,n.chunkRetryCount=0,n.finishRetryCount=0,n.actualTotalChunks=Math.ceil(s/l),n.deduplicatedBlocks=Object(P.Y)(p=hn({length:s})).call(p,(function(e,r){return{seq:r,checksum:"",hash:"",size:-1,status:"pending"}})),n.deduplicatedBlockIndex=0,n.deduplicatedBlockCount=Math.ceil(s/qs),"paused"!==n.status&&this.deduplicateAndUploadBlocks(n)):(n.uploadMode=_s.CHUNK,n.actualTotalChunks=Math.ceil(s/l),n.chunkOffset=0,n.chunkRetryCount=0,n.finishRetryCount=0,Ls(n)?this.finishFileTask(r):"paused"!==n.status&&this.uploadChunkOfUploadTask(r)),e.next=21;break;case 15:if(e.prev=15,e.t0=e.catch(5),e.t0){e.next=20;break}return this.triggerUploadError({task:n,reqID:"",logID:"",errorType:u.UploadUnexpected}),e.abrupt("return");case 20:this.triggerUploadError({task:n,reqID:e.t0.reqID||"",logID:e.t0.logID||"",errorType:e.t0.data?e.t0.data.code||e.t0.data:e.t0.message});case 21:case"end":return e.stop()}}),e,this,[[5,15]])})));return function(r){return e.apply(this,arguments)}}()},{key:"deduplicateAndUploadBlocks",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,c,l,p,f,d,h,v=arguments;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=v.length>1&&void 0!==v[1]?v[1]:0,a=r.prepareResult,i=a.totalChunks,r.deduplicatedBlockCount&&void 0!==r.deduplicatedBlockIndex){e.next=5;break}return e.abrupt("return");case 5:if(!(n>=r.deduplicatedBlockCount)){e.next=7;break}return e.abrupt("return");case 7:return o=n*qs,s=Math.min(i,(n+1)*qs),u=s-o,this.triggerUploadedDeduplicateChunks(r),e.next=13,this.deduplicate(r,o,s);case 13:if(c=e.sent,Cr(c))for(l=function(e){var n=Nr(c).call(c,(function(r){return r.seq===e})),a=r.deduplicatedBlocks[e];n?Cs(a,n,{status:"inflight"}):a.status="success"},p=o;p<s;p++)l(p);else for(f=o;f<s;f++)r.deduplicatedBlocks[f].status="inflight";if(r.deduplicatedBlockIndex=n,this.triggerUploadedDeduplicateChunks(r),Cr(c)&&c.length===u){if(n<r.deduplicatedBlockCount-1)for(d=(n+1)*qs;d<i;d++)"pending"===(h=r.deduplicatedBlocks[d]).status&&(h.status="inflight");this.uploadDeduplicatedChunks(r)}else this.uploadDeduplicatedChunks(r),"paused"!==r.status&&this.deduplicateAndUploadBlocks(r,n+1);case 18:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"triggerUploadedDeduplicateChunks",value:function(e){for(var r=e.file,n=e.uuid,a=e.parentUUID,i=e.prepareResult,o=e.deduplicatedBlocks,s=i.totalChunks,u=i.chunkSize,c=0,l=0;l<s;l++){"success"===o[l].status&&(c+=u)}c=Math.min(r.size,c),"paused"!==e.status&&this.onUploadUploading({uuid:n,parentUUID:a,bytesTransferred:c,bytesTotal:r.size})}},{key:"uploadDeduplicatedChunks",value:function(e){var r=e.uuid,n=e.deduplicatedBlocks,a=Nr(n).call(n,(function(e){return"inflight"===e.status})),i=Nr(n).call(n,(function(e){return"uploading"===e.status}));Ls(e)?this.finishFileTask(r):"paused"!==e.status&&a&&!i&&this.uploadChunkOfUploadTask(r)}},{key:"uploadChunkOfUploadTask",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,c,l,p,f,d,h,v,y,g,k,m,T,I,U,x,O,w,D,S,j,C,E,A,_,q=this;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getUploadTaskMap().get(r)){e.next=4;break}return console.warn(zs),e.abrupt("return");case 4:if(a=this.getMountType(n),i=n.file,o=n.parentUUID,s=n.prepareResult,c=n.chunkOffset,l=n.chunkRetryCount,p=n.actualTotalChunks,f=n.deduplicatedBlocks,d=n.uploadMode,s&&!Object(F.isUndefined)(c)&&!Object(F.isUndefined)(p)&&!Object(F.isUndefined)(l)){e.next=9;break}return console.error("Upload chunk for unprepared task is illegal."),e.abrupt("return");case 9:if(h=d===_s.FAST,v=0,y=[],e.prev=12,!h){e.next=21;break}return e.next=16,this.fastUpload(n);case 16:if(g=e.sent){e.next=19;break}return e.abrupt("return");case 19:e.next=24;break;case 21:return e.next=23,this.normalUpload(n);case 23:g=e.sent;case 24:return this.triggerUploadStart({task:n}),k=Mn(),T=(m=g).startByte,I=m.endByte,U=m.size,x=m.checksums,O=m.seqList,w=m.sliceData,D=s.uploadID,S=s.chunkSize,v=U,y=O,this.onUploadUploading({uuid:r,parentUUID:o,bytesTransferred:T,bytesTotal:i.size}),j=M.a.CancelToken.source(),n.cancelUploadSource=j,e.next=35,this.uploadChunk(n,{size:U,checksums:x,seqList:O,uploadID:D,chunkSize:S,sliceData:w,offset:c||0,onUploadProgress:function(e){var n=T+e.loaded;q.onUploadUploading({uuid:r,parentUUID:o,bytesTransferred:n,bytesTotal:i.size})},cancelToken:j.token});case 35:if((C=e.sent).successSeqList&&Object(F.isEqual)(C.successSeqList,O)){e.next=38;break}throw C;case 38:this.onUploadUploading({uuid:r,parentUUID:o,bytesTransferred:I,bytesTotal:i.size}),this.logger.collectChunkSuccessEvent({uploadMode:d,mountType:this.getMountType(n),offset:c||0,size:v,duration:Mn()-k,subdomain:C.subdomain}),h&&Oe(E=O||[]).call(E,(function(e){var r,n=Nr(r=f||[]).call(r,(function(r){return r.seq===e}));n&&(n.status="success")})),n.chunkOffset=c+1,n.chunkRetryCount=0,n.currentSuccessSeqList=[],Ls(n)?this.finishFileTask(r):this.uploadChunkOfUploadTask(r),e.next=59;break;case 47:if(e.prev=47,e.t0=e.catch(12),console.error(e.t0),h&&Oe(A=y||[]).call(A,(function(e){var r,n=Nr(r=f||[]).call(r,(function(r){return r.seq===e}));n&&(n.status="inflight")})),e.t0){e.next=54;break}return this.triggerUploadError({task:n,reqID:"",logID:"",errorType:u.UploadUnexpected}),e.abrupt("return");case 54:if("Cancelled"!==e.t0.message){e.next=56;break}return e.abrupt("return");case 56:_=e.t0.successSeqList?"PartialFailure":e.t0.message?e.t0.message:Object(F.get)(e.t0,"data.code","Unknown"),this.logger.collectChunkErrorEvent({errorType:_,mountType:a,uploadMode:d,offset:c,size:v,reqID:e.t0.reqID||"",logID:e.t0.logID||"",subdomain:e.t0.subdomain||"Unknown"}),l<3?(n.chunkRetryCount=l+1,n.currentSuccessSeqList=e.t0.data&&e.t0.data.success_seq_list||e.t0.successSeqList,this.uploadChunkOfUploadTask(r)):this.triggerUploadError({task:n,reqID:e.t0.reqID||"",logID:e.t0.logID||"",errorType:u.UploadChunkRetryTooManyTimes});case 59:return e.prev=59,n.cancelUploadSource=void 0,e.finish(59);case 62:case"end":return e.stop()}}),e,this,[[12,47,59,62]])})));return function(r){return e.apply(this,arguments)}}()},{key:"fastUpload",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,c,l,p,f,d,h,v,y,g,k,m,T,I,U,x,O;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=r.file,a=r.prepareResult,i=r.deduplicatedBlocks,o=r.currentSuccessSeqList,s=a.totalChunks,u=a.suggestedChunkSize,c=a.chunkSize,l=u/c,p=[],f=0,d=0;d<l&&f<s;f++)"inflight"===(h=i[f]).status&&(o&&o.length&&ya(o).call(o,h.seq)||p.push(h),h.status="uploading",d++);if(p.length){e.next=7;break}return e.abrupt("return",null);case 7:v=p[0].seq*c,y=Math.min(n.size,(p[p.length-1].seq+1)*c),g=0,k=Object(P.Y)(p).call(p,(function(e){var r=e.seq*c,a=Math.min(n.size,(e.seq+1)*c);return g+=a-r,Qr(n).call(n,r,a)})),m=[],T=0;case 13:if(!(T<k.length)){e.next=26;break}if(!(I=p[T]).checksum){e.next=19;break}m.push(I.checksum),e.next=23;break;case 19:return e.next=21,On(k[T]);case 21:U=e.sent,m.push(Es(U));case 23:T++,e.next=13;break;case 26:return x=new Blob(k),O=Object(P.Y)(p).call(p,(function(e){return e.seq})),e.abrupt("return",{startByte:v,endByte:y,size:g,checksums:m,seqList:O,sliceData:x});case 29:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},{key:"normalUpload",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,c,l,p,f,d,h,v,y,g,k,m;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.file,a=r.prepareResult,i=r.chunkOffset,o=r.currentSuccessSeqList,s=a.suggestedChunkSize,u=a.chunkSize,c=i*(s/u),l=Math.min(n.size,(i+1)*s)-i*s,p=Math.ceil(l/u),f=[],d=c;case 8:if(!(d<c+p)){e.next=15;break}if(null===o||void 0===o||!ya(o).call(o,d)){e.next=11;break}return e.abrupt("continue",12);case 11:f.push(d);case 12:d++,e.next=8;break;case 15:return h=f[0]*u,v=Math.min(n.size,(f[f.length-1]+1)*u),y=f.length*u,e.next=20,this.getPendingSliceData(n,f,u,v);case 20:return g=e.sent,k=g.sliceData,m=g.checksums,e.abrupt("return",{startByte:h,endByte:v,size:y,checksums:m,seqList:f,sliceData:k});case 24:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"finishFileTask",value:function(){var e=x(b.mark((function e(r){var n,a;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getUploadTaskMap().get(r)){e.next=4;break}return console.warn(zs),e.abrupt("return");case 4:if(n.prepareResult){e.next=7;break}return e.abrupt("return");case 7:if(!le(r,!1,this.processFinishList)&&"paused"!==n.status){e.next=9;break}return e.abrupt("return");case 9:if(!(this.processFinishList.length>=this.maxConcurrentFinishingTasks)||le(r,!1,this.pendingFinishList)){e.next=13;break}return this.triggerUploadFinishing({task:n}),this.pendingFinishList.push(r),e.abrupt("return");case 13:return this.triggerUploadFinishing({task:n}),e.prev=14,this.processFinishList.push(r),e.next=18,this.finishFile(n);case 18:a=e.sent,n.finishResult=a,this.triggerUploadSuccess({task:n}),e.next=31;break;case 23:if(e.prev=23,e.t0=e.catch(14),this.retryFinishFailedTask(r)){e.next=31;break}if(e.t0){e.next=30;break}return this.triggerUploadError({task:n,reqID:"",logID:"",errorType:u.UploadUnexpected}),e.abrupt("return");case 30:this.triggerUploadError({task:n,reqID:e.t0.reqID||"",logID:e.t0.logID||"",errorType:e.t0.data?e.t0.data.code:e.t0.message});case 31:return e.prev=31,le(r,!0,this.processFinishList),this.finishNextFileTask(),e.finish(31);case 35:case"end":return e.stop()}}),e,this,[[14,23,31,35]])})));return function(r){return e.apply(this,arguments)}}()},{key:"retryFinishFailedTask",value:function(e){var r=this;if(!this.finishRetryAndConcurrent)return!1;var n=this.getUploadTaskMap().get(e);return!(!n||Object(F.isUndefined)(n.finishRetryCount))&&(n.finishRetryCount<3&&(js((function(){n.finishRetryCount=n.finishRetryCount+1,r.pendingFinishList.push(e),r.finishNextFileTask()}),400*n.finishRetryCount),!0))}},{key:"finishNextFileTask",value:function(){for(var e="";this.pendingFinishList.length;){var r=this.pendingFinishList.shift(),n=this.getUploadTaskMap().get(r);if(n&&"paused"!==n.status){e=r;break}}e&&this.finishFileTask(e)}},{key:"directUploadTask",value:function(){var e=x(b.mark((function e(r){var n;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r.uploadMode=_s.DIRECT,this.triggerUploadStart({task:r}),this.onUploadUploading({uuid:r.uuid,parentUUID:r.parentUUID,bytesTransferred:0,bytesTotal:r.file.size}),e.next=6,this.directUpload(r);case 6:n=e.sent,r.finishResult=n,this.onUploadUploading({uuid:r.uuid,parentUUID:r.parentUUID,bytesTransferred:r.file.size,bytesTotal:r.file.size}),this.triggerUploadSuccess({task:r}),e.next=19;break;case 12:if(e.prev=12,e.t0=e.catch(0),console.error("directUploadTask",e.t0),e.t0){e.next=18;break}return this.triggerUploadError({task:r,reqID:"",logID:"",errorType:u.UploadUnexpected}),e.abrupt("return");case 18:this.triggerUploadError({task:r,reqID:e.t0.reqID||"",logID:e.t0.logID||"",errorType:e.t0.data?e.t0.data.code:e.t0.message});case 19:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(r){return e.apply(this,arguments)}}()},{key:"getPendingSliceData",value:function(){var e=x(b.mark((function e(r,n,a,i){var o,s,u,c,l,p,f;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.getByteRanges(n,a,i),s=Object(P.Y)(o).call(o,(function(e){var n=Os(e,2),a=n[0],i=n[1];return Qr(r).call(r,a,i)})),e.next=4,P.ms.all(Object(P.Y)(s).call(s,On));case 4:return u=e.sent,e.next=7,P.ms.all(Object(P.Y)(u).call(u,Es));case 7:if(c=e.sent,1!==s.length){e.next=10;break}return e.abrupt("return",{checksums:c,sliceData:s[0]});case 10:for(l=[],p=0;p<o.length;p++)l.push(Qr(r).call(r,o[p][0],o[p][1]));return f=new Blob(l),e.abrupt("return",{checksums:c,sliceData:f});case 14:case"end":return e.stop()}}),e,this)})));return function(r,n,a,i){return e.apply(this,arguments)}}()},{key:"getByteRanges",value:function(e,r,n){return Object(P.Y)(e).call(e,(function(e){return[e*r,Math.min(n,(e+1)*r)]}))}},{key:"markDuration",value:function(e){var r=e.startTime,n=e.duration;if(r){var a=Mn()-r;e.startTime=void 0,e.duration=(n||0)+a}}},{key:"triggerUploadStart",value:function(e){var r=e.task;r.startTime||(r.startTime=Mn()),r.status="uploading"}},{key:"triggerUploadFinishing",value:function(e){var r=this,n=e.task,a=n.uuid,i=n.parentUUID;n.startTime||(n.startTime=Mn()),n.status="finishing",P.ms.resolve().then((function(){return r.onUploadFinishing({uuid:a,parentUUID:i})}))}},{key:"triggerUploadSuccess",value:function(e){var r=e.task,n=r.uuid,a=r.parentUUID,i=r.file,o=this.getMountType(r);r.status="success",this.markDuration(r),this.onUploadSuccess({uuid:n,parentUUID:a}),r.duration?this.logger.collectFileSuccessEvent({mountType:o,size:i.size,duration:r.duration,uploadMode:r.uploadMode}):console.warn("Duration data is unavailable.")}},{key:"triggerUploadError",value:function(e){var r=e.task,n=e.errorType,a=e.reqID,i=e.logID,o=r.uuid,s=r.parentUUID,u=r.file,c=this.getMountType(r);r.status="error",this.markDuration(r),this.onUploadError({uuid:o,parentUUID:s,reqID:a,errorType:n,logID:i}),this.logger.collectFileErrorEvent({errorType:n,reqID:a,logID:i,mountType:c,size:u.size,uploadMode:r.uploadMode})}},{key:"fastUploadSupported",get:function(){return Boolean(window.crypto&&window.crypto.subtle)}},{key:"maxConcurrentFinishingTasks",get:function(){return this.finishRetryAndConcurrent?3:1}}]),e}();function Bs(e,r){var n=It(e);if(bt){var a=bt(e);r&&(a=qe(a).call(a,(function(r){return Ce(e,r).enumerable}))),n.push.apply(n,a)}return n}function Ns(e){for(var r=1;r<arguments.length;r++){var n,a=null!=arguments[r]?arguments[r]:{};if(r%2)Oe(n=Bs(Object(a),!0)).call(n,(function(r){xt(e,r,a[r])}));else if(be)he(e,be(a));else{var i;Oe(i=Bs(Object(a))).call(i,(function(r){fe(e,r,Ce(a,r))}))}}return e}var Ws=function(e){function r(e){var n,a=e.requestService,i=e.onStatusChanged,o=e.logger,s=e.featureFlags,u=e.getUploadAuthCode;return Ot(this,r),(n=Rt(this,Nt(r).call(this,{logger:o,featureFlags:s}))).uploadTaskMap=new Vr,n.calculateBlocks=function(){var e=x(b.mark((function e(r,n,a,i){var o,s,u,c,l;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=[],s=Mn(),u=function(e){var n=new P.ms((function(n,a){var o=Qr(r).call(r,e*i,Math.min(r.size,(e+1)*i)),s=new FileReader;s.onload=function(){return n(s.result)},s.onerror=function(){return a("upload read blob error")},s.readAsArrayBuffer(o)})).then((function(r){return(n=r,crypto.subtle.digest("SHA-256",n).then(As)).then((function(n){return{hash:n,seq:e,size:r.byteLength,checksum:Es(r)}}));var n}));o.push(n)},c=n;c<a;c++)u(c);return e.next=6,P.ms.all(o);case 6:return l=e.sent,e.abrupt("return",{blocks:l,calculateTime:Mn()-s});case 8:case"end":return e.stop()}}),e)})));return function(r,n,a,i){return e.apply(this,arguments)}}(),n.requestService=a,n.onStatusChanged=i,n.getUploadAuthCode=u,n}return Ht(r,e),Zr(r,[{key:"getMountType",value:function(e){return e.mountPoint||""}},{key:"getUploadTaskMap",value:function(){return this.uploadTaskMap}},{key:"onUploadUploading",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.bytesTransferred,i=e.bytesTotal,o=0===i?1:a/i;this.onStatusChanged({type:"uploading",data:{uuid:r,parentUUID:n,bytesTransferred:a,bytesTotal:i,progress:o}})}},{key:"onUploadFinishing",value:function(e){var r=e.uuid,n=e.parentUUID;this.onStatusChanged({type:"finishing",data:{uuid:r,parentUUID:n}})}},{key:"onUploadSuccess",value:function(e){var r=e.uuid,n=e.parentUUID,a=this.uploadTaskMap.get(r);if(a){var i=a.finishResult;if(i){var o=i.fileToken,s=i.dataVersion,u=i.successExtra;this.onStatusChanged({type:"success",data:{uuid:r,parentUUID:n,dataVersion:s,successExtra:u,token:o}})}}}},{key:"onUploadError",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.errorType,i=e.reqID,o=e.logID;this.onStatusChanged({type:"error",data:{uuid:r,parentUUID:n,errorType:a,reqID:i,logID:o}})}},{key:"setNewTask",value:function(e){this.uploadTaskMap.set(e.uuid,Ns({},e,{status:"pending"}))}},{key:"prepareFileByAuthCode",value:function(){var e=x(b.mark((function e(r){var n,a,i,o;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.parentToken,a=r.mountPoint,e.next=3,this.getUploadAuthCode(r.uuid);case 3:return i=e.sent,o={authCode:i,mountPoint:a,mountNodeToken:n},e.abrupt("return",this.requestService.prepareFileByAuthCode(o));case 6:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"prepareFile",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.getUploadAuthCode){e.next=2;break}return e.abrupt("return",this.prepareFileByAuthCode(r));case 2:return n=r.file,a=r.parentToken,i=r.mountPoint,o=r.fileToken,s=r.bizExtra,u={fileToken:o,bizExtra:s,name:n.name,size:n.size,mountNodeToken:a,mountPoint:i||"explorer"},e.abrupt("return",this.requestService.prepareFile(u));case 5:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"uploadChunk",value:function(){var e=x(b.mark((function e(r,n){var a;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.mountPoint,e.abrupt("return",this.requestService.uploadChunk(Ns({},n,{mountPoint:a})));case 2:case"end":return e.stop()}}),e,this)})));return function(r,n){return e.apply(this,arguments)}}()},{key:"deduplicate",value:function(){var e=x(b.mark((function e(r,n,a){var i,o,s,u,c,l,p,f,d,h,v,y;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.prepareResult,o=i.uploadID,s=i.chunkSize,u=i.totalChunks,c=r.mountPoint,l=Mn(),e.prev=3,p=r.file,e.next=7,this.calculateBlocks(p,n,a,s);case 7:return f=e.sent,d=f.blocks,h=f.calculateTime,e.next=12,this.requestService.deduplicate({blocks:d,mountPoint:c,uploadId:o});case 12:return v=e.sent,y=v.blocks,this.logger.collectEvent("dev_upload_deduplicate",{uploadID:o,blockSize:s,blockCount:u,blockStart:n,blockEnd:a,deduplicateBlockCount:y.length,calculateBlockTime:h,totalTime:Mn()-l,result:"success"}),e.abrupt("return",y);case 18:return e.prev=18,e.t0=e.catch(3),console.error("deduplicate error: ",e.t0),this.logger.collectEvent("dev_upload_deduplicate",{uploadID:o,blockSize:s,blockCount:u,blockStart:n,blockEnd:a,totalTime:Mn()-l,result:"error",errorMsg:e.t0.toString()}),e.abrupt("return",null);case 23:case"end":return e.stop()}}),e,this,[[3,18]])})));return function(r,n,a){return e.apply(this,arguments)}}()},{key:"finishFile",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,c;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.prepareResult,a=r.memberID,i=r.shouldAddToRecents,o=r.mountPoint,s=n.totalChunks,u=n.uploadID,c={uploadID:u,totalChunks:s,memberID:a,shouldAddToRecents:i,mountPoint:o},e.abrupt("return",this.requestService.finishFile(c));case 4:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"directUpload",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,c,l,p,f,d,h,v=this;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.file,a=r.parentToken,i=r.mountPoint,o=r.fileToken,s=r.shouldAddToRecents,u=r.memberID,c=r.bizExtra,l=r.bizRouteKey,p=r.uuid,f=r.parentUUID,e.next=3,new P.ms((function(e,r){var a=new FileReader;a.onload=function(){return e(a.result)},a.onerror=function(){return r("upload read blob error")},a.readAsArrayBuffer(n)})).then(Es);case 3:return d=e.sent,h={file:n,fileToken:o,checksum:d,shouldAddToRecents:s,memberID:u,bizRouteKey:l,bizExtra:c,name:n.name,size:n.size,mountNodeToken:a,mountPoint:i||"explorer",onUploadProgress:function(e){var r=0===n.size?1:e.loaded/e.total;v.onStatusChanged({type:"uploading",data:{uuid:p,parentUUID:f,progress:r,bytesTransferred:e.loaded,bytesTotal:e.total}})}},e.abrupt("return",this.requestService.directUpload(h));case 6:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()}]),r}(Ms);function Ks(e,r){var n=It(e);if(bt){var a=bt(e);r&&(a=qe(a).call(a,(function(r){return Ce(e,r).enumerable}))),n.push.apply(n,a)}return n}var Ys="Import task not found",Hs=0;function Gs(e,r){switch(Ts(e)){case"doc":case"docx":case"md":case"markdown":case"mark":case"txt":return f.Docs;case"xls":case"xlsx":case"csv":return r&&ya(r).call(r,"bitable")?f.Bitable:f.Sheets;case"xmind":case"mm":case"opml":return f.Mindnotes;default:return}}function Xs(e,r){switch(Ts(e)){case"md":case"markdown":case"mark":case"txt":return r&&ya(r).call(r,p.md2docx)?"docx":"doc";case"xls":return"sheet";case"csv":case"xlsx":return r&&ya(r).call(r,p.all2bitable)?"bitable":"sheet";case"doc":case"docx":return r&&ya(r).call(r,p.other2docx)?"docx":"doc";case"xmind":case"mm":case"opml":return"mindnote";default:return"doc"}}function Js(e){return"pending"===e||"uploading"===e||"converting"===e}var Qs=function(){function e(r){var n,a=r.requestService,i=r.onStatusChanged,o=r.onErrorAlert,s=r.featureFlags,u=r.getUploadAuthCode,c=r.logger;Ot(this,e),this.importTaskMap=new Vr,this.requestService=a,this.onStatusChanged=i,this.onErrorAlert=o,this.uploadController=new Ws({featureFlags:s,logger:c,getUploadAuthCode:u,requestService:this.requestService,onStatusChanged:ms(n=this.onUploadStatusChanged).call(n,this)})}return Zr(e,[{key:"startImport",value:function(e){var r,n=e.uuid,a=e.parentUUID,i=e.file,o=e.parentToken,s=e.options,u=this.importTaskMap.get(n);if(u){if("pending"!==(r=u.status)&&"paused"!==r&&"error"!==r&&"success"!==r)return void console.warn("Cannot start a task that is already in progress.");var c=u.ticket,l=u.token,p=u.suiteType,f=u.responseData;"success"===u.status&&p&&l?this.onImportSuccess({uuid:n,parentUUID:a,token:l,suiteType:p,responseData:f}):c&&"error"!==u.status?this.pollImportTaskTicketStatus(n,null===s||void 0===s?void 0:s.format):this.uploadImportTask(n)}else this.importTaskMap.set(n,{uuid:n,parentUUID:a,parentToken:o,file:i,options:s,status:"pending"}),this.uploadImportTask(n)}},{key:"createImportTask",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u,l,p,f,d,h,v,y,g;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.uuid,i=r.token,o=this.importTaskMap.get(a)){e.next=4;break}return e.abrupt("return",console.warn(Ys));case 4:if(i){e.next=6;break}return e.abrupt("return");case 6:return s=o.options,u=o.file,l=o.parentToken,p=Xs(null===u||void 0===u?void 0:u.name,null===s||void 0===s?void 0:s.format),f=Ts(null===o||void 0===o||null===(n=o.file)||void 0===n?void 0:n.name),e.prev=9,e.next=12,this.requestService.createImportTask({type:p,file_extension:f,file_token:i,point:{mount_type:(null===s||void 0===s?void 0:s.businessType)===c.WIKI?2:1,mount_key:l},event_source:s.eventSource});case 12:d=e.sent,h=d.code,v=d.ticket,y=d.job_timeout,g=d.reqID,0===h?(Hs=y,o.ticket=v,this.pollImportTaskTicketStatus(a,null===s||void 0===s?void 0:s.format)):(this.onImportError({uuid:a,parentUUID:o.parentUUID,errorType:h,reqID:g||""}),this.onErrorAlert({uuid:a,name:null===u||void 0===u?void 0:u.name,errorType:h})),e.next=25;break;case 20:return e.prev=20,e.t0=e.catch(9),this.onImportError({uuid:a,parentUUID:o.parentUUID,errorType:e.t0.data.code,reqID:e.t0.reqID||""}),this.onErrorAlert({uuid:a,name:null===u||void 0===u?void 0:u.name,errorType:e.t0.data.code}),e.abrupt("return");case 25:case"end":return e.stop()}}),e,this,[[9,20]])})));return function(r){return e.apply(this,arguments)}}()},{key:"uploadImportTask",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,u;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.importTaskMap.get(r)){e.next=4;break}return console.warn(Ys),e.abrupt("return");case 4:a=n.parentUUID,i=n.file,o=n.parentToken,s=n.options,u=i.size,n.status="uploading",this.onImportUploading({uuid:r,parentUUID:a,bytesTransferred:(null===n||void 0===n?void 0:n.uploadedSize)||0,bytesTotal:u}),this.uploadController.startUpload({uuid:r,file:i,parentUUID:a,parentToken:o,mountPoint:"ccm_import",bizExtra:{extra:ba({obj_type:Xs(null===i||void 0===i?void 0:i.name,null===s||void 0===s?void 0:s.format),file_extension:Ts(null===i||void 0===i?void 0:i.name)})}});case 9:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"cancelImport",value:function(e){var r=this.importTaskMap.get(e);if(r){if(Js(r.status)){r.status="paused";var n=r.cancelUploadSource,a=r.pollTicketStatusTimer;n&&(n.cancel(),r.cancelUploadSource=void 0),a&&(window.clearTimeout(a),r.pollTicketStatusTimer=void 0)}}else console.warn(Ys)}},{key:"cancelAllImports",value:function(){var e,r=this;Oe(e=this.importTaskMap).call(e,(function(e,n){Js(e.status)&&r.cancelImport(n)}))}},{key:"pollImportTaskTicketStatus",value:function(){var e=x(b.mark((function e(r,n){var a,i,o,s,c,l,p,f,d,h,v,y,g,k,m,T,I,U,x=this;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.importTaskMap.get(r)){e.next=4;break}return console.warn(Ys),e.abrupt("return");case 4:if(i=a.parentUUID,o=a.ticket,s=a.pollTicketStatusCount,o){e.next=7;break}return e.abrupt("return");case 7:return e.prev=7,a.status="converting",this.onImportConverting({uuid:r,parentUUID:i,ticket:o}),e.next=12,this.requestService.importStatusCheck(o);case 12:c=e.sent,l=c.code,p=c.fileToken,f=c.extra,d=c.jobStatus,h=c.reqID,v=c.responseData,0===l?(g=null===(y=a.file)||void 0===y?void 0:y.name,k=Gs(g,n),0===d&&p&&k?(a.token=p,a.suiteType=k,a.responseData=v,a.status="success",this.onImportSuccess({uuid:r,parentUUID:i,token:p,suiteType:k,responseData:v}),Object(F.isEmpty)(f)||("EXTRA",this.onErrorAlert({uuid:r,name:g,errorType:"EXTRA",responseData:v}))):d>=3?(m=d,a.status="error",this.onImportError({uuid:r,parentUUID:i,errorType:m,reqID:h}),this.onErrorAlert({uuid:r,parentUUID:i,name:g,errorType:m,responseData:v})):(a.pollTicketStatusCount=s?s+1:1,3*(a.pollTicketStatusCount-1)+1>Hs?(a.status="error",this.onImportError({uuid:r,parentUUID:i,reqID:h,errorType:u.ImportPollTooManyTimes})):a.pollTicketStatusTimer=window.setTimeout((function(){x.pollImportTaskTicketStatus(r,n)}),1===a.pollTicketStatusCount?1e3:3e3))):(I=l,a.status="error",this.onImportError({uuid:r,parentUUID:i,errorType:I,reqID:h}),this.onErrorAlert({uuid:r,parentUUID:i,errorType:I,responseData:v,name:null===(T=a.file)||void 0===T?void 0:T.name})),e.next=31;break;case 22:if(e.prev=22,e.t0=e.catch(7),e.t0){e.next=28;break}return a.status="error",this.onImportError({uuid:r,parentUUID:i,reqID:"",errorType:u.ImportUnexpected}),e.abrupt("return");case 28:a.status="error",this.onImportError({uuid:r,parentUUID:i,errorType:e.t0.data?e.t0.data.code:e.t0.message,reqID:e.t0.reqID||""}),this.onErrorAlert({uuid:r,parentUUID:i,errorType:e.t0.data?e.t0.data.code:e.t0.message,name:null===a||void 0===a||null===(U=a.file)||void 0===U?void 0:U.name});case 31:case"end":return e.stop()}}),e,this,[[7,22]])})));return function(r,n){return e.apply(this,arguments)}}()},{key:"onUploadStatusChanged",value:function(e){var r=e.type,n=e.data,a=n.uuid,i=this.importTaskMap.get(a);if(i){if("error"===r)return i.status="error",void this.onImportError(function(e){for(var r=1;r<arguments.length;r++){var n,a=null!=arguments[r]?arguments[r]:{};if(r%2)Oe(n=Ks(Object(a),!0)).call(n,(function(r){xt(e,r,a[r])}));else if(be)he(e,be(a));else{var i;Oe(i=Ks(Object(a))).call(i,(function(r){fe(e,r,Ce(a,r))}))}}return e}({},n,{errorType:"upload".concat(n.errorType)}));"uploading"===r&&(i.status="uploading",i.uploadedSize=null===n||void 0===n?void 0:n.bytesTransferred,this.onImportUploading(n)),"success"===r&&(i.status="success",this.createImportTask(n))}else console.warn(Ys)}},{key:"onImportUploading",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.bytesTransferred,i=e.bytesTotal,o=0===i?1:a/i;this.onStatusChanged({type:"uploading",data:{uuid:r,parentUUID:n,bytesTransferred:a,bytesTotal:i,progress:o}})}},{key:"onImportConverting",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.ticket;this.onStatusChanged({type:"converting",data:{uuid:r,parentUUID:n,ticket:a}})}},{key:"onImportSuccess",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.token,i=e.suiteType,o=e.responseData;this.onStatusChanged({type:"success",data:{uuid:r,parentUUID:n,token:a,suiteType:i,responseData:o}})}},{key:"onImportError",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.errorType,i=e.reqID;this.onStatusChanged({type:"error",data:{uuid:r,parentUUID:n,errorType:a,reqID:i}})}}]),e}(),Vs="Import task not found",$s="enex";function Zs(e,r){var n;return jr(n="".concat(r?"WARNING-":"ERROR-")).call(n,e)}function eu(e){return"pending"===e||"uploading"===e||"converting"===e}function tu(e){if(Ts(e)===$s)return f.Docs}var ru=function(){function e(r){var n,a=r.logger,i=r.requestService,o=r.onStatusChanged,s=r.onErrorAlert;Ot(this,e),this.importTaskMap=new Vr,this.requestService=i,this.onStatusChanged=o,this.onErrorAlert=s,this.uploaderController=new Ws({logger:a,requestService:this.requestService,onStatusChanged:ms(n=this.onUploadStatusChanged).call(n,this)})}return Zr(e,[{key:"startImport",value:function(e){var r,n=e.uuid,a=e.parentUUID,i=e.file,o=e.parentToken,s=this.importTaskMap.get(n);if(s){if("pending"!==(r=s.status)&&"paused"!==r&&"error"!==r&&"success"!==r)return void console.warn("Cannot start a task that is already in progress.");var u=s.ticket,c=s.token,l=s.suiteType;"success"===s.status&&l&&c?this.onImportEnexSuccess({uuid:n,parentUUID:a,token:c,suiteType:l}):u?this.pollImportTaskTicketStatus(n):this.uploadImportTask(n)}else this.importTaskMap.set(n,{uuid:n,parentUUID:a,file:i,parentToken:o,status:"pending"}),this.uploadImportTask(n)}},{key:"cancelImport",value:function(e){var r=this.importTaskMap.get(e);if(r){if(eu(r.status)){"pending"!==r.status&&"uploading"!==r.status||this.uploaderController.cancelUpload(r.uuid),r.status="paused";var n=r.cancelUploadSource,a=r.pollTicketStatusTimer;n&&(n.cancel(),r.cancelUploadSource=void 0),a&&(window.clearTimeout(a),r.pollTicketStatusTimer=void 0)}}else console.warn(Vs)}},{key:"cancelAllImports",value:function(){var e,r=this;Oe(e=this.importTaskMap).call(e,(function(e,n){eu(e.status)&&r.cancelImport(n)}))}},{key:"uploadImportTask",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.importTaskMap.get(r)){e.next=4;break}return console.warn(Vs),e.abrupt("return");case 4:a=n.parentUUID,i=n.file,o=n.parentToken,s=i.size,n.status="uploading",this.onImportEnexUploading({uuid:r,parentUUID:a,bytesTransferred:0,bytesTotal:s}),this.uploaderController.startUpload({uuid:r,file:i,parentUUID:a,parentToken:o});case 9:case"end":return e.stop()}}),e,this)})));return function(r){return e.apply(this,arguments)}}()},{key:"parseFileTask",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,c,l,p;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.uuid,a=r.token,i=this.importTaskMap.get(n)){e.next=5;break}return console.warn(Vs),e.abrupt("return");case 5:if(a){e.next=7;break}return e.abrupt("return");case 7:if("paused"!==i.status){e.next=9;break}return e.abrupt("return");case 9:return o=M.a.CancelToken.source(),i.cancelUploadSource=o,i.status="converting",e.prev=12,e.next=15,this.requestService.importParseEvernote({fileToken:a,cancelToken:o.token});case 15:if(s=e.sent,c=s.ticket,l=s.reqID,c){e.next=23;break}return p=Zs(),i.status="error",this.onImportEnexError({uuid:n,errorType:p,reqID:l,parentUUID:""}),e.abrupt("return");case 23:i.ticket=c,this.pollImportTaskTicketStatus(n),e.next=35;break;case 27:if(e.prev=27,e.t0=e.catch(12),e.t0){e.next=33;break}return i.status="error",this.onImportEnexError({uuid:n,reqID:"",errorType:u.ImportUnexpected}),e.abrupt("return");case 33:i.status="error",this.onImportEnexError({uuid:n,reqID:e.t0.reqID||"",errorType:e.t0.data?e.t0.data.code:e.t0.message});case 35:return e.prev=35,i.cancelUploadSource=void 0,e.finish(35);case 38:case"end":return e.stop()}}),e,this,[[12,27,35,38]])})));return function(r){return e.apply(this,arguments)}}()},{key:"pollImportTaskTicketStatus",value:function(){var e=x(b.mark((function e(r){var n,a,i,o,s,c,l,p,f,d,h,v,y,g,k,m=this;return b.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.importTaskMap.get(r)){e.next=4;break}return console.warn(Vs),e.abrupt("return");case 4:if(a=n.parentUUID,i=n.file,o=n.ticket,s=n.pollTicketStatusCount,o){e.next=7;break}return e.abrupt("return");case 7:return e.prev=7,n.status="converting",this.onImportEnexConverting({uuid:r,parentUUID:a,ticket:o}),e.next=12,this.requestService.importEvernoteStatusCheck({ticket:o});case 12:if(c=e.sent,l=c.code,p=c.fileToken,f=c.warningCode,d=c.reqID,h=c.responseData,void 0===l){e.next=23;break}return v=i.name,y=tu(v),0===l&&p&&y?(n.token=p,n.suiteType=y,n.status="success",this.onImportEnexSuccess({uuid:r,parentUUID:a,token:p,suiteType:y}),!f&&Object(F.isEmpty)(h.warningExtra)||(g=Zs(f,!0),this.onErrorAlert({uuid:r,name:v,errorType:g,responseData:h}))):(k=Zs(l),n.status="error",this.onImportEnexError({uuid:r,parentUUID:a,errorType:k,reqID:d}),this.onErrorAlert({uuid:r,parentUUID:a,name:v,errorType:k,responseData:h})),e.abrupt("return");case 23:n.pollTicketStatusCount=s?s+1:1,n.pollTicketStatusCount<66?n.pollTicketStatusTimer=window.setTimeout((function(){m.pollImportTaskTicketStatus(r)}),3e3):(n.status="error",this.onImportEnexError({uuid:r,parentUUID:a,reqID:d,errorType:Zs(u.ImportPollTooManyTimes)})),e.next=35;break;case 27:if(e.prev=27,e.t0=e.catch(7),e.t0){e.next=33;break}return n.status="error",this.onImportEnexError({uuid:r,parentUUID:a,reqID:"",errorType:u.ImportUnexpected}),e.abrupt("return");case 33:n.status="error",this.onImportEnexError({uuid:r,parentUUID:a,errorType:e.t0.data?Zs(e.t0.data.code):e.t0.message,reqID:e.t0.reqID||""});case 35:case"end":return e.stop()}}),e,this,[[7,27]])})));return function(r){return e.apply(this,arguments)}}()},{key:"onUploadStatusChanged",value:function(e){var r=e.type,n=e.data;"success"!==r?"uploading"!==r?"error"!==r||this.onImportEnexError(n):this.onImportEnexUploading(n):this.parseFileTask(n)}},{key:"onImportEnexUploading",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.bytesTransferred,i=e.bytesTotal,o=0===i?1:a/i;this.onStatusChanged({type:"uploading",data:{uuid:r,parentUUID:n,bytesTransferred:a,bytesTotal:i,progress:o}})}},{key:"onImportEnexConverting",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.ticket;this.onStatusChanged({type:"converting",data:{uuid:r,parentUUID:n,ticket:a}})}},{key:"onImportEnexSuccess",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.token,i=e.suiteType;this.onStatusChanged({type:"success",data:{uuid:r,parentUUID:n,token:a,suiteType:i}})}},{key:"onImportEnexError",value:function(e){var r=e.uuid,n=e.parentUUID,a=e.errorType,i=e.reqID;this.onStatusChanged({type:"error",data:{uuid:r,parentUUID:n,errorType:a,reqID:i}})}}]),e}(),nu=function(){function e(r){var n=r.requestService,a=r.logger,i=r.featureFlags,o=r.getUploadAuthCode;Ot(this,e),this.requestService=n,this.logger=a,this.featureFlags=i,this.getUploadAuthCode=o}return Zr(e,[{key:"init",value:function(e){var r=e.onUploadStatusChanged,n=e.onCreateDirectoryStatusChanged,a=e.onImportStatusChanged,i=e.onImportErrorAlert,o=this.requestService;this.uploadController=new Ws({featureFlags:this.featureFlags,logger:this.logger,requestService:o,onStatusChanged:r,getUploadAuthCode:this.getUploadAuthCode}),this.importController=new Qs({logger:this.logger,requestService:o,onStatusChanged:a,onErrorAlert:i,getUploadAuthCode:this.getUploadAuthCode}),this.importEnexController=new ru({logger:this.logger,requestService:o,onStatusChanged:a,onErrorAlert:i}),this.createDirectoryController=new ds({logger:this.logger,requestService:o,onStatusChanged:n})}},{key:"startUpload",value:function(e){this.uploadController&&this.uploadController.startUpload(e)}},{key:"cancelUpload",value:function(e){this.uploadController&&this.uploadController.cancelUpload(e)}},{key:"cancelAllUploads",value:function(){this.uploadController&&this.uploadController.cancelAllUploads()}},{key:"startCreateDirectory",value:function(e){this.createDirectoryController&&this.createDirectoryController.startCreateDirectory(e)}},{key:"cancelCreateDirectory",value:function(e){this.createDirectoryController&&this.createDirectoryController.cancelCreateDirectory(e)}},{key:"startImport",value:function(e){if(Ts(e.file.name)===$s)this.importEnexController&&this.importEnexController.startImport(e);else this.importController&&this.importController.startImport(e)}},{key:"cancelImport",value:function(e){var r=e.uuid;if(Ts(e.file.name)===$s)this.importEnexController&&this.importEnexController.cancelImport(r);else this.importController&&this.importController.cancelImport(r)}},{key:"cancelAllImports",value:function(){this.importController&&this.importController.cancelAllImports(),this.importEnexController&&this.importEnexController.cancelAllImports()}}]),e}();function au(e,r){var n=It(e);if(bt){var a=bt(e);r&&(a=qe(a).call(a,(function(r){return Ce(e,r).enumerable}))),n.push.apply(n,a)}return n}function iu(e){for(var r=1;r<arguments.length;r++){var n,a=null!=arguments[r]?arguments[r]:{};if(r%2)Oe(n=au(Object(a),!0)).call(n,(function(r){xt(e,r,a[r])}));else if(be)he(e,be(a));else{var i;Oe(i=au(Object(a))).call(i,(function(r){fe(e,r,Ce(a,r))}))}}return e}var ou=function(e){function r(e){Ot(this,r);var n=new ss({envConfigs:e.envConfigs,featureFlags:e.featureFlags}),a={envConfigs:{spaceAPIHosts:[],source:""},featureFlags:iu({},h),maxSimultaneousUploads:1},i=new ps({scenario:"suite"}),o=new ps({scenario:"suite"}),s=new nu({requestService:n,logger:i,featureFlags:iu({},h,{},e.featureFlags),getUploadAuthCode:e.getUploadAuthCode});return Rt(this,Nt(r).call(this,iu({defaults:a},e,{logger:i,docsLogger:o,taskController:s,uploaderType:"suite"})))}return Ht(r,e),r}(ea)},dx_jYEY:function(e,r,n){var a;!function(i){"use strict";function o(e,r){var n=(65535&e)+(65535&r);return(e>>16)+(r>>16)+(n>>16)<<16|65535&n}function s(e,r,n,a,i,t){return o((s=o(o(r,e),o(a,t)))<<(u=i)|s>>>32-u,n);var s,u}function u(e,r,n,a,i,o,t){return s(r&n|~r&a,e,r,i,o,t)}function c(e,r,n,a,i,o,t){return s(r&a|n&~a,e,r,i,o,t)}function l(e,r,n,a,i,o,t){return s(r^n^a,e,r,i,o,t)}function p(e,r,n,a,i,o,t){return s(n^(r|~a),e,r,i,o,t)}function f(e,r){var n,a,i,s,f;e[r>>5]|=128<<r%32,e[14+(r+64>>>9<<4)]=r;var d=1732584193,h=-271733879,v=-1732584194,y=271733878;for(n=0;n<e.length;n+=16)a=d,i=h,s=v,f=y,d=u(d,h,v,y,e[n],7,-680876936),y=u(y,d,h,v,e[n+1],12,-389564586),v=u(v,y,d,h,e[n+2],17,606105819),h=u(h,v,y,d,e[n+3],22,-1044525330),d=u(d,h,v,y,e[n+4],7,-176418897),y=u(y,d,h,v,e[n+5],12,1200080426),v=u(v,y,d,h,e[n+6],17,-1473231341),h=u(h,v,y,d,e[n+7],22,-45705983),d=u(d,h,v,y,e[n+8],7,1770035416),y=u(y,d,h,v,e[n+9],12,-1958414417),v=u(v,y,d,h,e[n+10],17,-42063),h=u(h,v,y,d,e[n+11],22,-1990404162),d=u(d,h,v,y,e[n+12],7,1804603682),y=u(y,d,h,v,e[n+13],12,-40341101),v=u(v,y,d,h,e[n+14],17,-1502002290),d=c(d,h=u(h,v,y,d,e[n+15],22,1236535329),v,y,e[n+1],5,-165796510),y=c(y,d,h,v,e[n+6],9,-1069501632),v=c(v,y,d,h,e[n+11],14,643717713),h=c(h,v,y,d,e[n],20,-373897302),d=c(d,h,v,y,e[n+5],5,-701558691),y=c(y,d,h,v,e[n+10],9,38016083),v=c(v,y,d,h,e[n+15],14,-660478335),h=c(h,v,y,d,e[n+4],20,-405537848),d=c(d,h,v,y,e[n+9],5,568446438),y=c(y,d,h,v,e[n+14],9,-1019803690),v=c(v,y,d,h,e[n+3],14,-187363961),h=c(h,v,y,d,e[n+8],20,1163531501),d=c(d,h,v,y,e[n+13],5,-1444681467),y=c(y,d,h,v,e[n+2],9,-51403784),v=c(v,y,d,h,e[n+7],14,1735328473),d=l(d,h=c(h,v,y,d,e[n+12],20,-1926607734),v,y,e[n+5],4,-378558),y=l(y,d,h,v,e[n+8],11,-2022574463),v=l(v,y,d,h,e[n+11],16,1839030562),h=l(h,v,y,d,e[n+14],23,-35309556),d=l(d,h,v,y,e[n+1],4,-1530992060),y=l(y,d,h,v,e[n+4],11,1272893353),v=l(v,y,d,h,e[n+7],16,-155497632),h=l(h,v,y,d,e[n+10],23,-1094730640),d=l(d,h,v,y,e[n+13],4,681279174),y=l(y,d,h,v,e[n],11,-358537222),v=l(v,y,d,h,e[n+3],16,-722521979),h=l(h,v,y,d,e[n+6],23,76029189),d=l(d,h,v,y,e[n+9],4,-640364487),y=l(y,d,h,v,e[n+12],11,-421815835),v=l(v,y,d,h,e[n+15],16,530742520),d=p(d,h=l(h,v,y,d,e[n+2],23,-995338651),v,y,e[n],6,-198630844),y=p(y,d,h,v,e[n+7],10,1126891415),v=p(v,y,d,h,e[n+14],15,-1416354905),h=p(h,v,y,d,e[n+5],21,-57434055),d=p(d,h,v,y,e[n+12],6,1700485571),y=p(y,d,h,v,e[n+3],10,-1894986606),v=p(v,y,d,h,e[n+10],15,-1051523),h=p(h,v,y,d,e[n+1],21,-2054922799),d=p(d,h,v,y,e[n+8],6,1873313359),y=p(y,d,h,v,e[n+15],10,-30611744),v=p(v,y,d,h,e[n+6],15,-1560198380),h=p(h,v,y,d,e[n+13],21,1309151649),d=p(d,h,v,y,e[n+4],6,-145523070),y=p(y,d,h,v,e[n+11],10,-1120210379),v=p(v,y,d,h,e[n+2],15,718787259),h=p(h,v,y,d,e[n+9],21,-343485551),d=o(d,a),h=o(h,i),v=o(v,s),y=o(y,f);return[d,h,v,y]}function d(e){var r,n="",a=32*e.length;for(r=0;r<a;r+=8)n+=String.fromCharCode(e[r>>5]>>>r%32&255);return n}function h(e){var r,n=[];for(n[(e.length>>2)-1]=void 0,r=0;r<n.length;r+=1)n[r]=0;var a=8*e.length;for(r=0;r<a;r+=8)n[r>>5]|=(255&e.charCodeAt(r/8))<<r%32;return n}function v(e){var r,n,a="0123456789abcdef",i="";for(n=0;n<e.length;n+=1)r=e.charCodeAt(n),i+=a.charAt(r>>>4&15)+a.charAt(15&r);return i}function y(e){return unescape(encodeURIComponent(e))}function g(e){return function(e){return d(f(h(e),8*e.length))}(y(e))}function k(e,r){return function(e,r){var n,a,i=h(e),o=[],s=[];for(o[15]=s[15]=void 0,i.length>16&&(i=f(i,8*e.length)),n=0;n<16;n+=1)o[n]=909522486^i[n],s[n]=1549556828^i[n];return a=f(o.concat(h(r)),512+8*r.length),d(f(s.concat(a),640))}(y(e),y(r))}function b(e,r,n){return r?n?k(r,e):v(k(r,e)):n?g(e):v(g(e))}void 0===(a=function(){return b}.call(r,n,r,e))||(e.exports=a)}()},dx_k8HI:function(e,r,n){!function(r,a){var i;e.exports=(i=n("dx_oop9"),function(){var e=i,r=e.lib,n=r.WordArray,a=r.Hasher,o=e.algo,s=[],u=o.SHA1=a.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,r){for(var n=this._hash.words,a=n[0],i=n[1],o=n[2],u=n[3],c=n[4],l=0;l<80;l++){if(l<16)s[l]=0|e[r+l];else{var p=s[l-3]^s[l-8]^s[l-14]^s[l-16];s[l]=p<<1|p>>>31}var t=(a<<5|a>>>27)+c+s[l];t+=l<20?1518500249+(i&o|~i&u):l<40?1859775393+(i^o^u):l<60?(i&o|i&u|o&u)-1894007588:(i^o^u)-899497514,c=u,u=o,o=i<<30|i>>>2,i=a,a=t}n[0]=n[0]+a|0,n[1]=n[1]+i|0,n[2]=n[2]+o|0,n[3]=n[3]+u|0,n[4]=n[4]+c|0},_doFinalize:function(){var e=this._data,r=e.words,n=8*this._nDataBytes,a=8*e.sigBytes;return r[a>>>5]|=128<<24-a%32,r[14+(a+64>>>9<<4)]=Math.floor(n/4294967296),r[15+(a+64>>>9<<4)]=n,e.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});e.SHA1=a._createHelper(u),e.HmacSHA1=a._createHmacHelper(u)}(),i.SHA1)}()},dx_oop9:function(e,r,n){e.exports=function(){var e=e||function(e,r){var n=Object.create||function(){function e(){}return function(r){var n;return e.prototype=r,n=new e,e.prototype=null,n}}(),a={},i=a.lib={},o=i.Base={extend:function(e){var r=n(this);return e&&r.mixIn(e),r.hasOwnProperty("init")&&this.init!==r.init||(r.init=function(){r.$super.init.apply(this,arguments)}),r.init.prototype=r,r.$super=this,r},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var r in e)e.hasOwnProperty(r)&&(this[r]=e[r]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=i.WordArray=o.extend({init:function(e,n){e=this.words=e||[],this.sigBytes=n!=r?n:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var r=this.words,n=e.words,a=this.sigBytes,i=e.sigBytes;if(this.clamp(),a%4)for(var o=0;o<i;o++){var s=n[o>>>2]>>>24-o%4*8&255;r[a+o>>>2]|=s<<24-(a+o)%4*8}else for(o=0;o<i;o+=4)r[a+o>>>2]=n[o>>>2];return this.sigBytes+=i,this},clamp:function(){var r=this.words,n=this.sigBytes;r[n>>>2]&=4294967295<<32-n%4*8,r.length=e.ceil(n/4)},clone:function(){var e=o.clone.call(this);return e.words=this.words.slice(0),e},random:function(r){for(var n,a=[],i=function(r){r=r;var n=987654321,a=4294967295;return function(){var i=((n=36969*(65535&n)+(n>>16)&a)<<16)+(r=18e3*(65535&r)+(r>>16)&a)&a;return i/=4294967296,(i+=.5)*(e.random()>.5?1:-1)}},o=0;o<r;o+=4){var u=i(4294967296*(n||e.random()));n=987654071*u(),a.push(4294967296*u()|0)}return new s.init(a,r)}}),u=a.enc={},c=u.Hex={stringify:function(e){for(var r=e.words,n=e.sigBytes,a=[],i=0;i<n;i++){var o=r[i>>>2]>>>24-i%4*8&255;a.push((o>>>4).toString(16)),a.push((15&o).toString(16))}return a.join("")},parse:function(e){for(var r=e.length,n=[],a=0;a<r;a+=2)n[a>>>3]|=parseInt(e.substr(a,2),16)<<24-a%8*4;return new s.init(n,r/2)}},l=u.Latin1={stringify:function(e){for(var r=e.words,n=e.sigBytes,a=[],i=0;i<n;i++){var o=r[i>>>2]>>>24-i%4*8&255;a.push(String.fromCharCode(o))}return a.join("")},parse:function(e){for(var r=e.length,n=[],a=0;a<r;a++)n[a>>>2]|=(255&e.charCodeAt(a))<<24-a%4*8;return new s.init(n,r)}},p=u.Utf8={stringify:function(e){try{return decodeURIComponent(escape(l.stringify(e)))}catch(r){throw new Error("Malformed UTF-8 data")}},parse:function(e){return l.parse(unescape(encodeURIComponent(e)))}},f=i.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(r){var n=this._data,a=n.words,i=n.sigBytes,o=this.blockSize,u=i/(4*o),c=(u=r?e.ceil(u):e.max((0|u)-this._minBufferSize,0))*o,l=e.min(4*c,i);if(c){for(var p=0;p<c;p+=o)this._doProcessBlock(a,p);var f=a.splice(0,c);n.sigBytes-=l}return new s.init(f,l)},clone:function(){var e=o.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),d=(i.Hasher=f.extend({cfg:o.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(r,n){return new e.init(n).finalize(r)}},_createHmacHelper:function(e){return function(r,n){return new d.HMAC.init(e,n).finalize(r)}}}),a.algo={});return a}(Math);return e}()}}]);
//# sourceMappingURL=//slardar.bytedance.net/api_v2/browser/jserr/get_sourcemap?bid=docs_pc&js_filename=vendors-docx-drive-upload-sdk.f34e9d9d.chunk.js.map